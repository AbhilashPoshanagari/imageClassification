(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{"+8Ar":function(t,e,n){"use strict";var r=n("+aGp"),i=/^ms-/;t.exports=function(t){return r(t).replace(i,"-ms-")}},"+aGp":function(t,e,n){"use strict";var r=/([A-Z])/g;t.exports=function(t){return t.replace(r,"-$1").toLowerCase()}},"/TIM":function(t,e,n){"use strict";n.r(e),n.d(e,"create",(function(){return vt})),n.d(e,"creator",(function(){return u})),n.d(e,"local",(function(){return wt})),n.d(e,"matcher",(function(){return g})),n.d(e,"mouse",(function(){return kt})),n.d(e,"namespace",(function(){return o})),n.d(e,"namespaces",(function(){return i})),n.d(e,"clientPoint",(function(){return Ct})),n.d(e,"select",(function(){return yt})),n.d(e,"selectAll",(function(){return St})),n.d(e,"selection",(function(){return gt})),n.d(e,"selector",(function(){return c})),n.d(e,"selectorAll",(function(){return d})),n.d(e,"style",(function(){return R})),n.d(e,"touch",(function(){return Et})),n.d(e,"touches",(function(){return Ot})),n.d(e,"window",(function(){return A})),n.d(e,"event",(function(){return rt})),n.d(e,"customEvent",(function(){return lt}));var r="http://www.w3.org/1999/xhtml",i={svg:"http://www.w3.org/2000/svg",xhtml:r,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"},o=function(t){var e=t+="",n=e.indexOf(":");return n>=0&&"xmlns"!==(e=t.slice(0,n))&&(t=t.slice(n+1)),i.hasOwnProperty(e)?{space:i[e],local:t}:t};function a(t){return function(){var e=this.ownerDocument,n=this.namespaceURI;return n===r&&e.documentElement.namespaceURI===r?e.createElement(t):e.createElementNS(n,t)}}function s(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}var u=function(t){var e=o(t);return(e.local?s:a)(e)};function l(){}var c=function(t){return null==t?l:function(){return this.querySelector(t)}};function h(){return[]}var d=function(t){return null==t?h:function(){return this.querySelectorAll(t)}},f=function(t){return function(){return this.matches(t)}};if("undefined"!=typeof document){var p=document.documentElement;if(!p.matches){var m=p.webkitMatchesSelector||p.msMatchesSelector||p.mozMatchesSelector||p.oMatchesSelector;f=function(t){return function(){return m.call(this,t)}}}}var g=f,y=function(t){return new Array(t.length)};function v(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}function b(t,e,n,r,i,o){for(var a,s=0,u=e.length,l=o.length;s<l;++s)(a=e[s])?(a.__data__=o[s],r[s]=a):n[s]=new v(t,o[s]);for(;s<u;++s)(a=e[s])&&(i[s]=a)}function w(t,e,n,r,i,o,a){var s,u,l,c={},h=e.length,d=o.length,f=new Array(h);for(s=0;s<h;++s)(u=e[s])&&(f[s]=l="$"+a.call(u,u.__data__,s,e),l in c?i[s]=u:c[l]=u);for(s=0;s<d;++s)(u=c[l="$"+a.call(t,o[s],s,o)])?(r[s]=u,u.__data__=o[s],c[l]=null):n[s]=new v(t,o[s]);for(s=0;s<h;++s)(u=e[s])&&c[f[s]]===u&&(i[s]=u)}function x(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function _(t){return function(){this.removeAttribute(t)}}function C(t){return function(){this.removeAttributeNS(t.space,t.local)}}function k(t,e){return function(){this.setAttribute(t,e)}}function S(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function E(t,e){return function(){var n=e.apply(this,arguments);null==n?this.removeAttribute(t):this.setAttribute(t,n)}}function O(t,e){return function(){var n=e.apply(this,arguments);null==n?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,n)}}v.prototype={constructor:v,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};var A=function(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView};function N(t){return function(){this.style.removeProperty(t)}}function T(t,e,n){return function(){this.style.setProperty(t,e,n)}}function D(t,e,n){return function(){var r=e.apply(this,arguments);null==r?this.style.removeProperty(t):this.style.setProperty(t,r,n)}}function R(t,e){return t.style.getPropertyValue(e)||A(t).getComputedStyle(t,null).getPropertyValue(e)}function I(t){return function(){delete this[t]}}function M(t,e){return function(){this[t]=e}}function F(t,e){return function(){var n=e.apply(this,arguments);null==n?delete this[t]:this[t]=n}}function P(t){return t.trim().split(/^|\s+/)}function j(t){return t.classList||new z(t)}function z(t){this._node=t,this._names=P(t.getAttribute("class")||"")}function L(t,e){for(var n=j(t),r=-1,i=e.length;++r<i;)n.add(e[r])}function B(t,e){for(var n=j(t),r=-1,i=e.length;++r<i;)n.remove(e[r])}function U(t){return function(){L(this,t)}}function $(t){return function(){B(this,t)}}function V(t,e){return function(){(e.apply(this,arguments)?L:B)(this,t)}}function W(){this.textContent=""}function q(t){return function(){this.textContent=t}}function H(t){return function(){var e=t.apply(this,arguments);this.textContent=null==e?"":e}}function G(){this.innerHTML=""}function X(t){return function(){this.innerHTML=t}}function K(t){return function(){var e=t.apply(this,arguments);this.innerHTML=null==e?"":e}}function Y(){this.nextSibling&&this.parentNode.appendChild(this)}function Z(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function Q(){return null}function J(){var t=this.parentNode;t&&t.removeChild(this)}function tt(){return this.parentNode.insertBefore(this.cloneNode(!1),this.nextSibling)}function et(){return this.parentNode.insertBefore(this.cloneNode(!0),this.nextSibling)}z.prototype={add:function(t){this._names.indexOf(t)<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};var nt={},rt=null;function it(t,e,n){return t=ot(t,e,n),function(e){var n=e.relatedTarget;n&&(n===this||8&n.compareDocumentPosition(this))||t.call(this,e)}}function ot(t,e,n){return function(r){var i=rt;rt=r;try{t.call(this,this.__data__,e,n)}finally{rt=i}}}function at(t){return t.trim().split(/^|\s+/).map((function(t){var e="",n=t.indexOf(".");return n>=0&&(e=t.slice(n+1),t=t.slice(0,n)),{type:t,name:e}}))}function st(t){return function(){var e=this.__on;if(e){for(var n,r=0,i=-1,o=e.length;r<o;++r)n=e[r],t.type&&n.type!==t.type||n.name!==t.name?e[++i]=n:this.removeEventListener(n.type,n.listener,n.capture);++i?e.length=i:delete this.__on}}}function ut(t,e,n){var r=nt.hasOwnProperty(t.type)?it:ot;return function(i,o,a){var s,u=this.__on,l=r(e,o,a);if(u)for(var c=0,h=u.length;c<h;++c)if((s=u[c]).type===t.type&&s.name===t.name)return this.removeEventListener(s.type,s.listener,s.capture),this.addEventListener(s.type,s.listener=l,s.capture=n),void(s.value=e);this.addEventListener(t.type,l,n),s={type:t.type,name:t.name,value:e,listener:l,capture:n},u?u.push(s):this.__on=[s]}}function lt(t,e,n,r){var i=rt;t.sourceEvent=rt,rt=t;try{return e.apply(n,r)}finally{rt=i}}function ct(t,e,n){var r=A(t),i=r.CustomEvent;"function"==typeof i?i=new i(e,n):(i=r.document.createEvent("Event"),n?(i.initEvent(e,n.bubbles,n.cancelable),i.detail=n.detail):i.initEvent(e,!1,!1)),t.dispatchEvent(i)}function ht(t,e){return function(){return ct(this,t,e)}}function dt(t,e){return function(){return ct(this,t,e.apply(this,arguments))}}"undefined"!=typeof document&&("onmouseenter"in document.documentElement||(nt={mouseenter:"mouseover",mouseleave:"mouseout"}));var ft=[null];function pt(t,e){this._groups=t,this._parents=e}function mt(){return new pt([[document.documentElement]],ft)}pt.prototype=mt.prototype={constructor:pt,select:function(t){"function"!=typeof t&&(t=c(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var o,a,s=e[i],u=s.length,l=r[i]=new Array(u),h=0;h<u;++h)(o=s[h])&&(a=t.call(o,o.__data__,h,s))&&("__data__"in o&&(a.__data__=o.__data__),l[h]=a);return new pt(r,this._parents)},selectAll:function(t){"function"!=typeof t&&(t=d(t));for(var e=this._groups,n=e.length,r=[],i=[],o=0;o<n;++o)for(var a,s=e[o],u=s.length,l=0;l<u;++l)(a=s[l])&&(r.push(t.call(a,a.__data__,l,s)),i.push(a));return new pt(r,i)},filter:function(t){"function"!=typeof t&&(t=g(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var o,a=e[i],s=a.length,u=r[i]=[],l=0;l<s;++l)(o=a[l])&&t.call(o,o.__data__,l,a)&&u.push(o);return new pt(r,this._parents)},data:function(t,e){if(!t)return p=new Array(this.size()),c=-1,this.each((function(t){p[++c]=t})),p;var n,r=e?w:b,i=this._parents,o=this._groups;"function"!=typeof t&&(n=t,t=function(){return n});for(var a=o.length,s=new Array(a),u=new Array(a),l=new Array(a),c=0;c<a;++c){var h=i[c],d=o[c],f=d.length,p=t.call(h,h&&h.__data__,c,i),m=p.length,g=u[c]=new Array(m),y=s[c]=new Array(m);r(h,d,g,y,l[c]=new Array(f),p,e);for(var v,x,_=0,C=0;_<m;++_)if(v=g[_]){for(_>=C&&(C=_+1);!(x=y[C])&&++C<m;);v._next=x||null}}return(s=new pt(s,i))._enter=u,s._exit=l,s},enter:function(){return new pt(this._enter||this._groups.map(y),this._parents)},exit:function(){return new pt(this._exit||this._groups.map(y),this._parents)},merge:function(t){for(var e=this._groups,n=t._groups,r=e.length,i=Math.min(r,n.length),o=new Array(r),a=0;a<i;++a)for(var s,u=e[a],l=n[a],c=u.length,h=o[a]=new Array(c),d=0;d<c;++d)(s=u[d]||l[d])&&(h[d]=s);for(;a<r;++a)o[a]=e[a];return new pt(o,this._parents)},order:function(){for(var t=this._groups,e=-1,n=t.length;++e<n;)for(var r,i=t[e],o=i.length-1,a=i[o];--o>=0;)(r=i[o])&&(a&&a!==r.nextSibling&&a.parentNode.insertBefore(r,a),a=r);return this},sort:function(t){function e(e,n){return e&&n?t(e.__data__,n.__data__):!e-!n}t||(t=x);for(var n=this._groups,r=n.length,i=new Array(r),o=0;o<r;++o){for(var a,s=n[o],u=s.length,l=i[o]=new Array(u),c=0;c<u;++c)(a=s[c])&&(l[c]=a);l.sort(e)}return new pt(i,this._parents).order()},call:function(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this},nodes:function(){var t=new Array(this.size()),e=-1;return this.each((function(){t[++e]=this})),t},node:function(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r=t[e],i=0,o=r.length;i<o;++i){var a=r[i];if(a)return a}return null},size:function(){var t=0;return this.each((function(){++t})),t},empty:function(){return!this.node()},each:function(t){for(var e=this._groups,n=0,r=e.length;n<r;++n)for(var i,o=e[n],a=0,s=o.length;a<s;++a)(i=o[a])&&t.call(i,i.__data__,a,o);return this},attr:function(t,e){var n=o(t);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((null==e?n.local?C:_:"function"==typeof e?n.local?O:E:n.local?S:k)(n,e))},style:function(t,e,n){return arguments.length>1?this.each((null==e?N:"function"==typeof e?D:T)(t,e,null==n?"":n)):R(this.node(),t)},property:function(t,e){return arguments.length>1?this.each((null==e?I:"function"==typeof e?F:M)(t,e)):this.node()[t]},classed:function(t,e){var n=P(t+"");if(arguments.length<2){for(var r=j(this.node()),i=-1,o=n.length;++i<o;)if(!r.contains(n[i]))return!1;return!0}return this.each(("function"==typeof e?V:e?U:$)(n,e))},text:function(t){return arguments.length?this.each(null==t?W:("function"==typeof t?H:q)(t)):this.node().textContent},html:function(t){return arguments.length?this.each(null==t?G:("function"==typeof t?K:X)(t)):this.node().innerHTML},raise:function(){return this.each(Y)},lower:function(){return this.each(Z)},append:function(t){var e="function"==typeof t?t:u(t);return this.select((function(){return this.appendChild(e.apply(this,arguments))}))},insert:function(t,e){var n="function"==typeof t?t:u(t),r=null==e?Q:"function"==typeof e?e:c(e);return this.select((function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)}))},remove:function(){return this.each(J)},clone:function(t){return this.select(t?et:tt)},datum:function(t){return arguments.length?this.property("__data__",t):this.node().__data__},on:function(t,e,n){var r,i,o=at(t+""),a=o.length;if(!(arguments.length<2)){for(s=e?ut:st,null==n&&(n=!1),r=0;r<a;++r)this.each(s(o[r],e,n));return this}var s=this.node().__on;if(s)for(var u,l=0,c=s.length;l<c;++l)for(r=0,u=s[l];r<a;++r)if((i=o[r]).type===u.type&&i.name===u.name)return u.value},dispatch:function(t,e){return this.each(("function"==typeof e?dt:ht)(t,e))}};var gt=mt,yt=function(t){return"string"==typeof t?new pt([[document.querySelector(t)]],[document.documentElement]):new pt([[t]],ft)},vt=function(t){return yt(u(t).call(document.documentElement))},bt=0;function wt(){return new xt}function xt(){this._="@"+(++bt).toString(36)}xt.prototype=wt.prototype={constructor:xt,get:function(t){for(var e=this._;!(e in t);)if(!(t=t.parentNode))return;return t[e]},set:function(t,e){return t[this._]=e},remove:function(t){return this._ in t&&delete t[this._]},toString:function(){return this._}};var _t=function(){for(var t,e=rt;t=e.sourceEvent;)e=t;return e},Ct=function(t,e){var n=t.ownerSVGElement||t;if(n.createSVGPoint){var r=n.createSVGPoint();return r.x=e.clientX,r.y=e.clientY,[(r=r.matrixTransform(t.getScreenCTM().inverse())).x,r.y]}var i=t.getBoundingClientRect();return[e.clientX-i.left-t.clientLeft,e.clientY-i.top-t.clientTop]},kt=function(t){var e=_t();return e.changedTouches&&(e=e.changedTouches[0]),Ct(t,e)},St=function(t){return"string"==typeof t?new pt([document.querySelectorAll(t)],[document.documentElement]):new pt([null==t?[]:t],ft)},Et=function(t,e,n){arguments.length<3&&(n=e,e=_t().changedTouches);for(var r,i=0,o=e?e.length:0;i<o;++i)if((r=e[i]).identifier===n)return Ct(t,r);return null},Ot=function(t,e){null==e&&(e=_t().touches);for(var n=0,r=e?e.length:0,i=new Array(r);n<r;++n)i[n]=Ct(t,e[n]);return i}},"/kWe":function(t,e){t.exports={SEMVER_SPEC_VERSION:"2.0.0",MAX_LENGTH:256,MAX_SAFE_INTEGER:Number.MAX_SAFE_INTEGER||9007199254740991,MAX_SAFE_COMPONENT_LENGTH:16}},0:function(t,e,n){t.exports=n("zUnb")},"0eLh":function(t,e,n){const r=n("3wIk"),i=n("vwDW"),{ANY:o}=i,a=n("ex/Z"),s=n("MpxT"),u=n("7sNm"),l=n("JCZO"),c=n("bdwG"),h=n("Dknc");t.exports=(t,e,n,d)=>{let f,p,m,g,y;switch(t=new r(t,d),e=new a(e,d),n){case">":f=u,p=c,m=l,g=">",y=">=";break;case"<":f=l,p=h,m=u,g="<",y="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(s(t,e,d))return!1;for(let r=0;r<e.set.length;++r){let n=null,a=null;if(e.set[r].forEach(t=>{t.semver===o&&(t=new i(">=0.0.0")),n=n||t,a=a||t,f(t.semver,n.semver,d)?n=t:m(t.semver,a.semver,d)&&(a=t)}),n.operator===g||n.operator===y)return!1;if((!a.operator||a.operator===g)&&p(t,a.semver))return!1;if(a.operator===y&&m(t,a.semver))return!1}return!0}},"0mDd":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(n("bniK"));function i(t){return t&&t.__esModule?t:{default:t}}i(n("2mcs"));var o=r.default.isUnitlessNumber;e.default=function(t,e,n){return null==e||"boolean"==typeof e||""===e?"":isNaN(e)||0===e||o.hasOwnProperty(t)&&o[t]?""+e:("string"==typeof e&&(e=e.trim()),e+"px")}},1:function(t,e){},"18Y9":function(t,e,n){const r=n("ex/Z");t.exports=(t,e,n)=>(t=new r(t,n),e=new r(e,n),t.intersects(e))},2:function(t,e){},"27OZ":function(t,e,n){const r=n("iEBQ");t.exports=(t,e)=>t.sort((t,n)=>r(n,t,e))},"2KGH":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e){if("string"==typeof e&&!(0,i.default)(e)&&e.indexOf("image-set(")>-1)return o.map((function(t){return e.replace(/image-set\(/g,t+"image-set(")}))};var r,i=(r=n("sUt/"))&&r.__esModule?r:{default:r},o=["-webkit-",""];t.exports=e.default},"2mcs":function(t,e,n){"use strict";var r=n("ohE5");t.exports=r},"2tTC":function(t,e,n){"use strict";var r=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(e){o(e)}}function s(t){try{u(r.throw(t))}catch(e){o(e)}}function u(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(a,s)}u((r=r.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0});const i=n("h1ZQ"),o=n("jke5"),a=n("QUk2");e.valuesDistribution=function(t,e){return r(this,void 0,void 0,(function*(){const n=o.getDrawArea(t),r=yield a.tensorStats(e),s=yield e.data();i.histogram(n,s,{height:150,stats:r})}))}},"2wtF":function(t,e,n){const r=n("0eLh");t.exports=(t,e,n)=>r(t,e,"<",n)},3:function(t,e){},"3cPs":function(t,e,n){const r=n("IsDc");t.exports={re:r.re,src:r.src,tokens:r.t,SEMVER_SPEC_VERSION:n("/kWe").SEMVER_SPEC_VERSION,SemVer:n("3wIk"),compareIdentifiers:n("KHQI").compareIdentifiers,rcompareIdentifiers:n("KHQI").rcompareIdentifiers,parse:n("Ybu3"),valid:n("gqzR"),clean:n("oBeb"),inc:n("eQf7"),diff:n("Yn5A"),major:n("Br5v"),minor:n("YJ14"),patch:n("LJ9E"),prerelease:n("O9TA"),compare:n("8GxW"),rcompare:n("oh0K"),compareLoose:n("8YLp"),compareBuild:n("iEBQ"),sort:n("lYj8"),rsort:n("27OZ"),gt:n("7sNm"),lt:n("JCZO"),eq:n("xfvg"),neq:n("dtu/"),gte:n("Dknc"),lte:n("bdwG"),cmp:n("VMJL"),coerce:n("eXNJ"),Comparator:n("vwDW"),Range:n("ex/Z"),satisfies:n("MpxT"),toComparators:n("j0pM"),maxSatisfying:n("d43V"),minSatisfying:n("ygsx"),minVersion:n("lkeM"),validRange:n("zv5s"),outside:n("0eLh"),gtr:n("VmpX"),ltr:n("2wtF"),intersects:n("18Y9"),simplifyRange:n("v6YA"),subset:n("I9dd")}},"3iBx":function(t){t.exports=JSON.parse('{"name":"vega-tooltip","version":"0.23.2","description":"A tooltip plugin for Vega-Lite and Vega visualizations.","main":"build/vega-tooltip.js","module":"build/src/index.js","unpkg":"build/vega-tooltip.min.js","jsdelivr":"build/vega-tooltip.min.js","typings":"build/src/index.d.ts","repository":{"type":"git","url":"https://github.com/vega/vega-tooltip.git"},"keywords":["vega-lite","vega","tooltip"],"author":{"name":"UW Interactive Data Lab","url":"https://idl.cs.washington.edu"},"collaborators":["Dominik Moritz","Sira Horradarn","Zening Qu","Kanit Wongsuphasawat","Yuri Astrakhan","Jeffrey Heer"],"license":"BSD-3-Clause","bugs":{"url":"https://github.com/vega/vega-tooltip/issues"},"homepage":"https://github.com/vega/vega-tooltip#readme","scripts":{"prepare":"beemo create-config --silent","tsc:src":"tsc -b tsconfig.src.json","build":"yarn tsc:src && rollup -c","clean":"rm -rf build examples/data && rm -f src/style.ts","copy:data":"rsync -r node_modules/vega-datasets/data/* examples/data","copy:build":"rsync -r build/* examples/build","deploy:gh":"yarn build && yarn copy:build && gh-pages -d examples && yarn clean","prettierbase":"beemo prettier \'examples/*.{html,scss,css}\'","eslintbase":"beemo eslint .","format":"yarn eslintbase --fix && yarn prettierbase --write","lint":"yarn eslintbase && yarn prettierbase --check","postbuild":"terser build/vega-tooltip.js -c -m -o build/vega-tooltip.min.js","prebuild":"mkdir -p build && yarn copy:data && ./build-style.sh","prepublishOnly":"yarn clean && yarn build","preversion":"yarn lint","start":"yarn build && concurrently --kill-others -n Server,Typescript,Rollup \'browser-sync start -s -f build examples --serveStatic examples\' \'yarn tsc:src -w\' \'rollup -c -w\'","pretest":"./build-style.sh","test":"jest"},"devDependencies":{"@rollup/plugin-commonjs":"13.0.0","@rollup/plugin-json":"^4.1.0","@rollup/plugin-node-resolve":"^8.1.0","@types/jest":"^26.0.4","browser-sync":"^2.26.7","codecov":"^3.7.0","concurrently":"^5.2.0","gh-pages":"^3.1.0","jest":"^26.1.0","node-sass":"^4.14.1","path":"^0.12.7","rollup":"^2.21.0","terser":"^4.8.0","ts-jest":"^26.1.1","typescript":"^3.9.6","vega-datasets":"^2.1.0","vega-lite-dev-config":"^0.11.8","vega-typings":"^0.18.0"},"dependencies":{"vega-util":"^1.14.1"},"beemo":{"module":"vega-lite-dev-config","drivers":["prettier","eslint"]},"jest":{"testURL":"http://localhost/","transform":{"^.+\\\\.tsx?$":"ts-jest"},"testRegex":"(/__tests__/.*|(\\\\.|/)(test|spec))\\\\.(jsx?|tsx?)$","moduleFileExtensions":["ts","tsx","js","jsx","json","node"],"testPathIgnorePatterns":["node_modules","<rootDir>/build","src"]}}')},"3wIk":function(t,e,n){const r=n("DXxi"),{MAX_LENGTH:i,MAX_SAFE_INTEGER:o}=n("/kWe"),{re:a,t:s}=n("IsDc"),{compareIdentifiers:u}=n("KHQI");class l{constructor(t,e){if(e&&"object"==typeof e||(e={loose:!!e,includePrerelease:!1}),t instanceof l){if(t.loose===!!e.loose&&t.includePrerelease===!!e.includePrerelease)return t;t=t.version}else if("string"!=typeof t)throw new TypeError("Invalid Version: "+t);if(t.length>i)throw new TypeError(`version is longer than ${i} characters`);r("SemVer",t,e),this.options=e,this.loose=!!e.loose,this.includePrerelease=!!e.includePrerelease;const n=t.trim().match(e.loose?a[s.LOOSE]:a[s.FULL]);if(!n)throw new TypeError("Invalid Version: "+t);if(this.raw=t,this.major=+n[1],this.minor=+n[2],this.patch=+n[3],this.major>o||this.major<0)throw new TypeError("Invalid major version");if(this.minor>o||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>o||this.patch<0)throw new TypeError("Invalid patch version");this.prerelease=n[4]?n[4].split(".").map(t=>{if(/^[0-9]+$/.test(t)){const e=+t;if(e>=0&&e<o)return e}return t}):[],this.build=n[5]?n[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+="-"+this.prerelease.join(".")),this.version}toString(){return this.version}compare(t){if(r("SemVer.compare",this.version,this.options,t),!(t instanceof l)){if("string"==typeof t&&t===this.version)return 0;t=new l(t,this.options)}return t.version===this.version?0:this.compareMain(t)||this.comparePre(t)}compareMain(t){return t instanceof l||(t=new l(t,this.options)),u(this.major,t.major)||u(this.minor,t.minor)||u(this.patch,t.patch)}comparePre(t){if(t instanceof l||(t=new l(t,this.options)),this.prerelease.length&&!t.prerelease.length)return-1;if(!this.prerelease.length&&t.prerelease.length)return 1;if(!this.prerelease.length&&!t.prerelease.length)return 0;let e=0;do{const n=this.prerelease[e],i=t.prerelease[e];if(r("prerelease compare",e,n,i),void 0===n&&void 0===i)return 0;if(void 0===i)return 1;if(void 0===n)return-1;if(n!==i)return u(n,i)}while(++e)}compareBuild(t){t instanceof l||(t=new l(t,this.options));let e=0;do{const n=this.build[e],i=t.build[e];if(r("prerelease compare",e,n,i),void 0===n&&void 0===i)return 0;if(void 0===i)return 1;if(void 0===n)return-1;if(n!==i)return u(n,i)}while(++e)}inc(t,e){switch(t){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",e);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",e);break;case"prepatch":this.prerelease.length=0,this.inc("patch",e),this.inc("pre",e);break;case"prerelease":0===this.prerelease.length&&this.inc("patch",e),this.inc("pre",e);break;case"major":0===this.minor&&0===this.patch&&0!==this.prerelease.length||this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":0===this.patch&&0!==this.prerelease.length||this.minor++,this.patch=0,this.prerelease=[];break;case"patch":0===this.prerelease.length&&this.patch++,this.prerelease=[];break;case"pre":if(0===this.prerelease.length)this.prerelease=[0];else{let t=this.prerelease.length;for(;--t>=0;)"number"==typeof this.prerelease[t]&&(this.prerelease[t]++,t=-2);-1===t&&this.prerelease.push(0)}e&&(this.prerelease[0]===e?isNaN(this.prerelease[1])&&(this.prerelease=[e,0]):this.prerelease=[e,0]);break;default:throw new Error("invalid increment argument: "+t)}return this.format(),this.raw=this.version,this}}t.exports=l},"3zff":function(t,e,n){"use strict";var r=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(e){o(e)}}function s(t){try{u(r.throw(t))}catch(e){o(e)}}function u(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(a,s)}u((r=r.apply(t,e||[])).next())}))},i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const o=i(n("etOl")),a=n("Ewl0"),s=n("jke5");e.confusionMatrix=function(t,e,n={}){return r(this,void 0,void 0,(function*(){const r=Object.assign({},u,n),i=s.getDrawArea(t),l=[],c=e.values,h=e.tickLabels||[],d=0===h.length;let f=!0;for(let t=0;t<c.length;t++){const e=d?"Class "+t:h[t];d&&h.push(e);for(let n=0;n<c[t].length;n++){const i=d?"Class "+n:h[n],o=c[t][n];t!==n||r.shadeDiagonal?(l.push({label:e,prediction:i,count:o,scaleCount:o}),0!==o&&(f=!1)):l.push({label:e,prediction:i,count:o,noFill:!0})}}if(!r.shadeDiagonal&&f)for(const t of l)!0===t.noFill&&(t.noFill=!1,t.scaleCount=t.count);const p={width:r.width||a.getDefaultWidth(i),height:r.height||a.getDefaultHeight(i),padding:0,autosize:{type:"fit",contains:"padding",resize:!0},config:{axis:{labelFontSize:r.fontSize,titleFontSize:r.fontSize},text:{fontSize:r.fontSize},legend:{labelFontSize:r.fontSize,titleFontSize:r.fontSize}},data:{values:l},encoding:{x:{field:"prediction",type:"ordinal",title:r.xLabel||"prediction",scale:{domain:h}},y:{field:"label",type:"ordinal",title:r.yLabel||"label",scale:{domain:h}}},layer:[{transform:[{filter:"datum.noFill != true"}],mark:{type:"rect"},encoding:{color:{field:"scaleCount",type:"quantitative",scale:{range:r.colorMap}},tooltip:[{field:"label",type:"nominal"},{field:"prediction",type:"nominal"},{field:"count",type:"quantitative"}]}}]};!1===r.shadeDiagonal&&p.layer.push({transform:[{filter:"datum.noFill == true"}],mark:{type:"rect",fill:"white"},encoding:{tooltip:[{field:"label",type:"nominal"},{field:"prediction",type:"nominal"},{field:"count",type:"quantitative"}]}}),r.showTextOverlay&&p.layer.push({mark:{type:"text",baseline:"middle"},encoding:{text:{field:"count",type:"nominal"}}}),p.layer[0].encoding.color.scale.range="string"==typeof r.colorMap?{scheme:r.colorMap}:r.colorMap,yield o.default(i,p,{actions:!1,mode:"vega-lite",defaultStyle:!1})}))};const u={xLabel:null,yLabel:null,xType:"nominal",yType:"nominal",shadeDiagonal:!0,fontSize:12,showTextOverlay:!0,height:400,colorMap:["#f7fbff","#4292c6"]}},4:function(t,e){},"4PpC":function(t,e,n){"use strict";var r=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(e){o(e)}}function s(t){try{u(r.throw(t))}catch(e){o(e)}}function u(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(a,s)}u((r=r.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0});const i=n("zhpP"),o=n("jke5"),a=n("Ewl0");function s(t,e,n,s={}){return r(this,void 0,void 0,(function*(){const r=o.getDrawArea(t),c={};for(const t of n)if(/val_/.test(t)){const r=t.replace("val_","");u(c,r);const i=l(e,t,n.indexOf(t));c[r].series.push(t),c[r].values.push(i)}else{const r=l(e,t,n.indexOf(t));u(c,t),c[t].series.push(t),c[t].values.push(r)}const h=Object.keys(c),d=Object.assign({},{xLabel:"Iteration",yLabel:"Value"},s),f=[];for(const t of h){const e=a.subSurface(r,t),n=c[t].series,o=c[t].values;n.every(t=>Boolean(t.match("acc")))&&(d.zoomToFitAccuracy?d.zoomToFit=!0:(d.yAxisDomain=[0,1],delete d.zoomToFit));const s=i.linechart(e,{values:o,series:n},d);f.push(s)}yield Promise.all(f)}))}function u(t,e){null==t[e]&&(t[e]={series:[],values:[]})}function l(t,e,n){if(Array.isArray(t)){const r=Array.isArray(t[0])?t[n]:t,i=[];for(let t=0;t<r.length;t++)i.push({x:t,y:r[t][e]});return i}return t.history[e].map((t,e)=>({x:e,y:t}))}function c(t,e,n){return null==t[e]&&(t[e]={}),null==t[e][n]&&(t[e][n]=[]),t[e][n]}e.history=s,e.fitCallbacks=function(t,e,n={}){const i={},u=n.callbacks||["onEpochEnd","onBatchEnd"],l=o.getDrawArea(t),h=Object.assign({},n);delete h.callbacks;const d={};return u.forEach(t=>{d[t]=function(t){return(n,u)=>r(this,void 0,void 0,(function*(){/batch/i.test(t)?h.xLabel="Batch":/epoch/i.test(t)&&(h.xLabel="Epoch");const n=[],r=[];for(const o of e)if(null!=u[o]){r.push(o);const e=c(i,t,o);e.push({[o]:u[o]}),n.push(e)}s(a.subSurface(l,t,{title:t}),n,r,h),yield o.nextFrame()}))}(t)}),d}},5:function(t,e){},6:function(t,e){},"6fql":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e){if("string"==typeof e&&!(0,i.default)(e)&&a.test(e))return o.map((function(t){return t+e}))};var r,i=(r=n("sUt/"))&&r.__esModule?r:{default:r},o=["-webkit-","-moz-",""],a=/linear-gradient|radial-gradient|repeating-linear-gradient|repeating-radial-gradient/;t.exports=e.default},"77Dq":function(t,e,n){t.exports=n("fl4C")},"7ZGM":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e){if("string"==typeof e&&!(0,i.default)(e)&&e.indexOf("filter(")>-1)return o.map((function(t){return e.replace(/filter\(/g,t+"filter(")}))};var r,i=(r=n("sUt/"))&&r.__esModule?r:{default:r},o=["-webkit-",""];t.exports=e.default},"7sNm":function(t,e,n){const r=n("8GxW");t.exports=(t,e,n)=>r(t,e,n)>0},"8GxW":function(t,e,n){const r=n("3wIk");t.exports=(t,e,n)=>new r(t,n).compare(new r(e,n))},"8WEG":function(t){t.exports=JSON.parse('{"a":"5.13.0"}')},"8YLp":function(t,e,n){const r=n("8GxW");t.exports=(t,e)=>r(t,e,!0)},"9eqh":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e){if("display"===t&&r.hasOwnProperty(e))return r[e]};var r={flex:["-webkit-box","-moz-box","-ms-flexbox","-webkit-flex","flex"],"inline-flex":["-webkit-inline-box","-moz-inline-box","-ms-inline-flexbox","-webkit-inline-flex","inline-flex"]};t.exports=e.default},"9x6x":function(t,e,n){"use strict";t.exports=function(t,e){e||(e={}),"function"==typeof e&&(e={cmp:e});var n,r="boolean"==typeof e.cycles&&e.cycles,i=e.cmp&&(n=e.cmp,function(t){return function(e,r){return n({key:e,value:t[e]},{key:r,value:t[r]})}}),o=[];return function t(e){if(e&&e.toJSON&&"function"==typeof e.toJSON&&(e=e.toJSON()),void 0!==e){if("number"==typeof e)return isFinite(e)?""+e:"null";if("object"!=typeof e)return JSON.stringify(e);var n,a;if(Array.isArray(e)){for(a="[",n=0;n<e.length;n++)n&&(a+=","),a+=t(e[n])||"null";return a+"]"}if(null===e)return"null";if(-1!==o.indexOf(e)){if(r)return JSON.stringify("__cycle__");throw new TypeError("Converting circular structure to JSON")}var s=o.push(e)-1,u=Object.keys(e).sort(i&&i(e));for(a="",n=0;n<u.length;n++){var l=u[n],c=t(e[l]);c&&(a&&(a+=","),a+=JSON.stringify(l)+":"+c)}return o.splice(s,1),"{"+a+"}"}}(t)}},A8aI:function(t,e,n){"use strict";function r(t,e){return t.charCodeAt(e++)+(t.charCodeAt(e++)<<8)+(t.charCodeAt(e++)<<16)+(t.charCodeAt(e)<<24)}function i(t,e){return t.charCodeAt(e++)+(t.charCodeAt(e++)<<8)}function o(t,e){return(65535&(t|=0))*(e|=0)+(((t>>>16)*e&65535)<<16)|0}Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e){for(var n=1540483477,a=e^t.length,s=t.length,u=0;s>=4;){var l=r(t,u);l=o(l,n),l=o(l^=l>>>24,n),a=o(a,n),a^=l,u+=4,s-=4}switch(s){case 3:a^=i(t,u),a=o(a^=t.charCodeAt(u+2)<<16,n);break;case 2:a=o(a^=i(t,u),n);break;case 1:a=o(a^=t.charCodeAt(u),n)}return a=o(a^=a>>>13,n),(a^=a>>>15)>>>0}},Ad6o:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.compose=e.merge=e.$=e.style=e.presets=e.keyframes=e.fontFace=e.insertGlobal=e.insertRule=e.plugins=e.styleSheet=void 0,e.speedy=function(t){return h.speedy(t)},e.simulations=function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];p=!!t},e.simulate=function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];return(e=(0,a.default)(e))?p?e.reduce((function(t,e){return t["data-simulate-"+v(e)]="",t}),{}):(m||(console.warn("can't simulate without once calling simulations(true)"),m=!0),g||(console.warn("don't use simulation outside dev"),g=!0),{}):{}},e.cssLabels=function(t){y=!!t},e.isLikeRule=w,e.idFor=x,e.css=U,e.rehydrate=function(t){(0,r.default)(A,t.reduce((function(t,e){return t[e]=!0,t}),{}))},e.flush=function(){A=h.inserted={},N=h.registered={},D={},h.flush(),h.inject()},e.select=V,e.parent=function(t){for(var e=arguments.length,n=Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return U(c({},t+" &",n))},e.media=function(t){for(var e=arguments.length,n=Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return U(c({},"@media "+t,n))},e.pseudo=W,e.active=function(t){return W(":active",t)},e.any=function(t){return W(":any",t)},e.checked=function(t){return W(":checked",t)},e.disabled=function(t){return W(":disabled",t)},e.empty=function(t){return W(":empty",t)},e.enabled=function(t){return W(":enabled",t)},e._default=function(t){return W(":default",t)},e.first=function(t){return W(":first",t)},e.firstChild=function(t){return W(":first-child",t)},e.firstOfType=function(t){return W(":first-of-type",t)},e.fullscreen=function(t){return W(":fullscreen",t)},e.focus=function(t){return W(":focus",t)},e.hover=function(t){return W(":hover",t)},e.indeterminate=function(t){return W(":indeterminate",t)},e.inRange=function(t){return W(":in-range",t)},e.invalid=function(t){return W(":invalid",t)},e.lastChild=function(t){return W(":last-child",t)},e.lastOfType=function(t){return W(":last-of-type",t)},e.left=function(t){return W(":left",t)},e.link=function(t){return W(":link",t)},e.onlyChild=function(t){return W(":only-child",t)},e.onlyOfType=function(t){return W(":only-of-type",t)},e.optional=function(t){return W(":optional",t)},e.outOfRange=function(t){return W(":out-of-range",t)},e.readOnly=function(t){return W(":read-only",t)},e.readWrite=function(t){return W(":read-write",t)},e.required=function(t){return W(":required",t)},e.right=function(t){return W(":right",t)},e.root=function(t){return W(":root",t)},e.scope=function(t){return W(":scope",t)},e.target=function(t){return W(":target",t)},e.valid=function(t){return W(":valid",t)},e.visited=function(t){return W(":visited",t)},e.dir=function(t,e){return W(":dir("+t+")",e)},e.lang=function(t,e){return W(":lang("+t+")",e)},e.not=function(t,e){var n=t.split(",").map((function(t){return t.trim()})).map((function(t){return":not("+t+")"}));return 1===n.length?W(":not("+t+")",e):V(n.join(""),e)},e.nthChild=function(t,e){return W(":nth-child("+t+")",e)},e.nthLastChild=function(t,e){return W(":nth-last-child("+t+")",e)},e.nthLastOfType=function(t,e){return W(":nth-last-of-type("+t+")",e)},e.nthOfType=function(t,e){return W(":nth-of-type("+t+")",e)},e.after=function(t){return W("::after",t)},e.before=function(t){return W("::before",t)},e.firstLetter=function(t){return W("::first-letter",t)},e.firstLine=function(t){return W("::first-line",t)},e.selection=function(t){return W("::selection",t)},e.backdrop=function(t){return W("::backdrop",t)},e.placeholder=function(t){return U({"::placeholder":t})},e.cssFor=function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];return(e=(0,a.default)(e))?e.map((function(t){var e={label:[]};return F(e,{src:t}),O(b(e),E(e)).join("")})).join(""):""},e.attribsFor=function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];var r=(e=(0,a.default)(e))?e.map((function(t){x(t);var e=Object.keys(t)[0];return e+'="'+(t[e]||"")+'"'})).join(" "):"";return r};var r=l(n("MgzW")),i=n("SDpH"),o=n("msJK"),a=l(n("tduB")),s=n("v20e"),u=l(n("A8aI"));function l(t){return t&&t.__esModule?t:{default:t}}function c(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var h=e.styleSheet=new i.StyleSheet;h.inject();var d=e.plugins=h.plugins=new s.PluginSet([s.prefixes,s.contentWrap,s.fallbacks]);d.media=new s.PluginSet,d.fontFace=new s.PluginSet,d.keyframes=new s.PluginSet([s.prefixes,s.fallbacks]);var f="undefined"!=typeof window,p=!1,m=!1,g=!1,y=!1;function v(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return t.toLowerCase().replace(/[^a-z0-9]/g,e)}function b(t){var e=JSON.stringify(t);return(0,u.default)(e).toString(36)}function w(t){var e=Object.keys(t).filter((function(t){return"toString"!==t}));return 1===e.length&&!!/data\-css\-([a-zA-Z0-9\-_]+)/.exec(e[0])}function x(t){var e=Object.keys(t).filter((function(t){return"toString"!==t}));if(1!==e.length)throw new Error("not a rule");var n=/data\-css\-([a-zA-Z0-9\-_]+)/.exec(e[0]);if(!n)throw new Error("not a rule");return n[1]}var _=/[(),]|"(?:\\.|[^"\n])*"|'(?:\\.|[^'\n])*'|\/\*[\s\S]*?\*\//g;function C(t){if(-1===t.indexOf(","))return[t];for(var e,n=[],r=[],i=0;e=_.exec(t);)switch(e[0]){case"(":i++;break;case")":i--;break;case",":if(i)break;n.push(e.index)}for(e=n.length;e--;)r.unshift(t.slice(n[e]+1)),t=t.slice(0,n[e]);return r.unshift(t),r}function k(t,e){if(!t)return e.replace(/\&/g,"");if(!e)return".css-"+t+",[data-css-"+t+"]";var n=C(e).map((function(e){return e.indexOf("&")>=0?[e.replace(/\&/gm,".css-"+t),e.replace(/\&/gm,"[data-css-"+t+"]")].join(","):".css-"+t+e+",[data-css-"+t+"]"+e})).join(",");return p&&/^\&\:/.exec(e)&&!/\s/.exec(e)&&(n+=",.css-"+t+"[data-simulate-"+v(e)+"],[data-css-"+t+"][data-simulate-"+v(e)+"]"),n}function S(t){var e=d.transform({selector:t.selector,style:t.style});return e.selector+"{"+(0,o.createMarkupForStyles)(e.style)+"}"}function E(t){var e=void 0,n=void 0,r=void 0,i=void 0;return Object.keys(t).forEach((function(o){o.indexOf("&")>=0?(n=n||{})[o]=t[o]:0===o.indexOf("@media")?(r=r||{})[o]=E(t[o]):0===o.indexOf("@supports")?(i=i||{})[o]=E(t[o]):"label"===o?t.label.length>0&&((e=e||{}).label=y?t.label.join("."):""):(e=e||{})[o]=t[o]})),{plain:e,selects:n,medias:r,supports:i}}function O(t,e){var n=[],r=e.plain,i=e.selects,o=e.medias,a=e.supports;return r&&n.push(S({style:r,selector:k(t)})),i&&Object.keys(i).forEach((function(e){return n.push(S({style:i[e],selector:k(t,e)}))})),o&&Object.keys(o).forEach((function(e){return n.push(e+"{"+O(t,o[e]).join("")+"}")})),a&&Object.keys(a).forEach((function(e){return n.push(e+"{"+O(t,a[e]).join("")+"}")})),n}var A=h.inserted={},N=h.registered={};function T(t){N[t.id]||(N[t.id]=t)}var D={};function R(t,e){var n=C(t).map((function(t){return t.indexOf("&")>=0?t:"&"+t}));return C(e).map((function(t){return t.indexOf("&")>=0?t:"&"+t})).reduce((function(t,e){return t.concat(n.map((function(t){return e.replace(/\&/g,t)})))}),[]).join(",")}function I(t,e){return t?"@supports "+t.substring(9)+" and "+e.substring(9):e}var M={"::placeholder":["::-webkit-input-placeholder","::-moz-placeholder","::-ms-input-placeholder"],":fullscreen":[":-webkit-full-screen",":-moz-full-screen",":-ms-fullscreen"]};function F(t,e){var n=e.selector,r=void 0===n?"":n,i=e.mq,o=void 0===i?"":i,s=e.supp,u=void 0===s?"":s,l=e.src,c=void 0===l?{}:l;Array.isArray(c)||(c=[c]),(c=function t(e){for(var n=[],r=0;r<e.length;r++)n=Array.isArray(e[r])?n.concat(t(e[r])):n.concat(e[r]);return n}(c)).forEach((function(e){if(w(e)){var n=function(t){if(w(t)){var e=N[x(t)];if(null==e)throw new Error("[glamor] an unexpected rule cache miss occurred. This is probably a sign of multiple glamor instances in your app. See https://github.com/threepointone/glamor/issues/79");return e}return t}(e);if("css"!==n.type)throw new Error("cannot merge this rule");e=n.style}(e=(0,a.default)(e))&&e.composes&&F(t,{selector:r,mq:o,supp:u,src:e.composes}),Object.keys(e||{}).forEach((function(n){if(function(t){for(var e=[":",".","[",">"," "],n=!1,r=t.charAt(0),i=0;i<e.length;i++)if(r===e[i]){n=!0;break}return n||t.indexOf("&")>=0}(n))M[n]&&M[n].forEach((function(i){return F(t,{selector:R(r,i),mq:o,supp:u,src:e[n]})})),F(t,{selector:R(r,n),mq:o,supp:u,src:e[n]});else if(function(t){return 0===t.indexOf("@media")}(n))F(t,{selector:r,mq:(a=o,s=n,a?"@media "+a.substring(6)+" and "+s.substring(6):s),supp:u,src:e[n]});else if(function(t){return 0===t.indexOf("@supports")}(n))F(t,{selector:r,mq:o,supp:I(u,n),src:e[n]});else if("composes"===n);else{var i=t;u&&(i[u]=i[u]||{},i=i[u]),o&&(i[o]=i[o]||{},i=i[o]),r&&(i[r]=i[r]||{},i=i[r]),"label"===n?y&&(t.label=t.label.concat(e.label)):i[n]=e[n]}var a,s}))}))}function P(t){var e={label:[]};return F(e,{src:t}),function(t){if(T(t),function(t){if(!A[t.id]){A[t.id]=!0;var e=E(t.style),n=O(t.id,e);A[t.id]=!!f||n,n.forEach((function(t){return h.insert(t)}))}}(t),D[t.id])return D[t.id];var e=c({},"data-css-"+t.id,y&&t.label||"");return Object.defineProperty(e,"toString",{enumerable:!1,value:function(){return"css-"+t.id}}),D[t.id]=e,e}({id:b(e),style:e,label:y?e.label.join("."):"",type:"css"})}var j,z=function(){var t={};return Object.defineProperty(t,"toString",{enumerable:!1,value:function(){return"css-nil"}}),t}(),L="undefined"!=typeof WeakMap?[z,new WeakMap,new WeakMap,new WeakMap]:[z],B="undefined"!=typeof WeakMap?(j=P,function(t){if(L[t.length]){for(var e=L[t.length],n=0;n<t.length-1;)e.has(t[n])||e.set(t[n],new WeakMap),e=e.get(t[n]),n++;if(e.has(t[t.length-1])){var r=e.get(t[n]);if(N[r.toString().substring(4)])return r}}var i=j(t);if(L[t.length]){for(var o=0,a=L[t.length];o<t.length-1;)a=a.get(t[o]),o++;try{a.set(t[o],i)}catch(s){}}return i}):P;function U(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];if(e[0]&&e[0].length&&e[0].raw)throw new Error("you forgot to include glamor/babel in your babel plugins.");return(e=(0,a.default)(e))?B(e):z}e.insertRule=U.insert=function(t){var e={id:b(t),css:t,type:"raw"};T(e),A[e.id]||(h.insert(e.css),A[e.id]=!!f||[e.css])},e.insertGlobal=U.global=function(t,e){if(e=(0,a.default)(e))return U.insert(S({selector:t,style:e}))},U.keyframes=function(t,e){e||(e=t,t="animation");var n={id:b({name:t,kfs:e=(0,a.default)(e)||{}}),type:"keyframes",name:t,keyframes:e};return T(n),function(t){if(!A[t.id]){var e=Object.keys(t.keyframes).map((function(e){var n=d.keyframes.transform({id:t.id,name:e,style:t.keyframes[e]});return n.name+"{"+(0,o.createMarkupForStyles)(n.style)+"}"})).join(""),n=["-webkit-","-moz-","-o-",""].map((function(n){return"@"+n+"keyframes "+t.name+"_"+t.id+"{"+e+"}"}));n.forEach((function(t){return h.insert(t)})),A[t.id]=!!f||n}}(n),t+"_"+n.id},e.fontFace=U.fontFace=function(t){var e={id:b(t=(0,a.default)(t)),type:"font-face",font:t};return T(e),function(t){if(!A[t.id]){var e="@font-face{"+(0,o.createMarkupForStyles)(t.font)+"}";h.insert(e),A[t.id]=!!f||[e]}}(e),t.fontFamily},e.keyframes=U.keyframes,e.presets={mobile:"(min-width: 400px)",Mobile:"@media (min-width: 400px)",phablet:"(min-width: 550px)",Phablet:"@media (min-width: 550px)",tablet:"(min-width: 750px)",Tablet:"@media (min-width: 750px)",desktop:"(min-width: 1000px)",Desktop:"@media (min-width: 1000px)",hd:"(min-width: 1200px)",Hd:"@media (min-width: 1200px)"};var $=e.style=U;function V(t){for(var e=arguments.length,n=Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return t?U(c({},t,n)):$(n)}function W(t){for(var e=arguments.length,n=Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return U(c({},t,n))}e.$=V,e.merge=U,e.compose=U},Br5v:function(t,e,n){const r=n("3wIk");t.exports=(t,e)=>new r(t,e).major},C1Pg:function(t,e,n){"use strict";n.r(e),n.d(e,"AdadeltaOptimizer",(function(){return i.AdadeltaOptimizer})),n.d(e,"AdagradOptimizer",(function(){return i.AdagradOptimizer})),n.d(e,"AdamOptimizer",(function(){return i.AdamOptimizer})),n.d(e,"AdamaxOptimizer",(function(){return i.AdamaxOptimizer})),n.d(e,"DataStorage",(function(){return i.DataStorage})),n.d(e,"ENV",(function(){return i.ENV})),n.d(e,"Environment",(function(){return i.Environment})),n.d(e,"KernelBackend",(function(){return i.KernelBackend})),n.d(e,"MomentumOptimizer",(function(){return i.MomentumOptimizer})),n.d(e,"Optimizer",(function(){return i.Optimizer})),n.d(e,"RMSPropOptimizer",(function(){return i.RMSPropOptimizer})),n.d(e,"Rank",(function(){return i.Rank})),n.d(e,"Reduction",(function(){return i.Reduction})),n.d(e,"SGDOptimizer",(function(){return i.SGDOptimizer})),n.d(e,"Tensor",(function(){return i.Tensor})),n.d(e,"TensorBuffer",(function(){return i.TensorBuffer})),n.d(e,"Variable",(function(){return i.Variable})),n.d(e,"abs",(function(){return i.abs})),n.d(e,"acos",(function(){return i.acos})),n.d(e,"acosh",(function(){return i.acosh})),n.d(e,"add",(function(){return i.add})),n.d(e,"addN",(function(){return i.addN})),n.d(e,"addStrict",(function(){return i.addStrict})),n.d(e,"all",(function(){return i.all})),n.d(e,"any",(function(){return i.any})),n.d(e,"argMax",(function(){return i.argMax})),n.d(e,"argMin",(function(){return i.argMin})),n.d(e,"asin",(function(){return i.asin})),n.d(e,"asinh",(function(){return i.asinh})),n.d(e,"atan",(function(){return i.atan})),n.d(e,"atan2",(function(){return i.atan2})),n.d(e,"atanh",(function(){return i.atanh})),n.d(e,"avgPool",(function(){return i.avgPool})),n.d(e,"avgPool3d",(function(){return i.avgPool3d})),n.d(e,"backend",(function(){return i.backend})),n.d(e,"backend_util",(function(){return i.backend_util})),n.d(e,"basicLSTMCell",(function(){return i.basicLSTMCell})),n.d(e,"batchNorm",(function(){return i.batchNorm})),n.d(e,"batchNorm2d",(function(){return i.batchNorm2d})),n.d(e,"batchNorm3d",(function(){return i.batchNorm3d})),n.d(e,"batchNorm4d",(function(){return i.batchNorm4d})),n.d(e,"batchNormalization",(function(){return i.batchNormalization})),n.d(e,"batchNormalization2d",(function(){return i.batchNormalization2d})),n.d(e,"batchNormalization3d",(function(){return i.batchNormalization3d})),n.d(e,"batchNormalization4d",(function(){return i.batchNormalization4d})),n.d(e,"batchToSpaceND",(function(){return i.batchToSpaceND})),n.d(e,"booleanMaskAsync",(function(){return i.booleanMaskAsync})),n.d(e,"browser",(function(){return i.browser})),n.d(e,"buffer",(function(){return i.buffer})),n.d(e,"cast",(function(){return i.cast})),n.d(e,"ceil",(function(){return i.ceil})),n.d(e,"clipByValue",(function(){return i.clipByValue})),n.d(e,"clone",(function(){return i.clone})),n.d(e,"complex",(function(){return i.complex})),n.d(e,"concat",(function(){return i.concat})),n.d(e,"concat1d",(function(){return i.concat1d})),n.d(e,"concat2d",(function(){return i.concat2d})),n.d(e,"concat3d",(function(){return i.concat3d})),n.d(e,"concat4d",(function(){return i.concat4d})),n.d(e,"conv1d",(function(){return i.conv1d})),n.d(e,"conv2d",(function(){return i.conv2d})),n.d(e,"conv2dTranspose",(function(){return i.conv2dTranspose})),n.d(e,"conv3d",(function(){return i.conv3d})),n.d(e,"conv3dTranspose",(function(){return i.conv3dTranspose})),n.d(e,"cos",(function(){return i.cos})),n.d(e,"cosh",(function(){return i.cosh})),n.d(e,"cumsum",(function(){return i.cumsum})),n.d(e,"customGrad",(function(){return i.customGrad})),n.d(e,"deprecationWarn",(function(){return i.deprecationWarn})),n.d(e,"depthToSpace",(function(){return i.depthToSpace})),n.d(e,"depthwiseConv2d",(function(){return i.depthwiseConv2d})),n.d(e,"diag",(function(){return i.diag})),n.d(e,"disableDeprecationWarnings",(function(){return i.disableDeprecationWarnings})),n.d(e,"dispose",(function(){return i.dispose})),n.d(e,"disposeVariables",(function(){return i.disposeVariables})),n.d(e,"div",(function(){return i.div})),n.d(e,"divStrict",(function(){return i.divStrict})),n.d(e,"dot",(function(){return i.dot})),n.d(e,"dropout",(function(){return i.dropout})),n.d(e,"elu",(function(){return i.elu})),n.d(e,"enableDebugMode",(function(){return i.enableDebugMode})),n.d(e,"enableProdMode",(function(){return i.enableProdMode})),n.d(e,"engine",(function(){return i.engine})),n.d(e,"env",(function(){return i.env})),n.d(e,"equal",(function(){return i.equal})),n.d(e,"equalStrict",(function(){return i.equalStrict})),n.d(e,"erf",(function(){return i.erf})),n.d(e,"exp",(function(){return i.exp})),n.d(e,"expandDims",(function(){return i.expandDims})),n.d(e,"expm1",(function(){return i.expm1})),n.d(e,"eye",(function(){return i.eye})),n.d(e,"fft",(function(){return i.fft})),n.d(e,"fill",(function(){return i.fill})),n.d(e,"findBackend",(function(){return i.findBackend})),n.d(e,"findBackendFactory",(function(){return i.findBackendFactory})),n.d(e,"floor",(function(){return i.floor})),n.d(e,"floorDiv",(function(){return i.floorDiv})),n.d(e,"frame",(function(){return i.frame})),n.d(e,"fused",(function(){return i.fused})),n.d(e,"gather",(function(){return i.gather})),n.d(e,"gatherND",(function(){return i.gatherND})),n.d(e,"getBackend",(function(){return i.getBackend})),n.d(e,"grad",(function(){return i.grad})),n.d(e,"grads",(function(){return i.grads})),n.d(e,"greater",(function(){return i.greater})),n.d(e,"greaterEqual",(function(){return i.greaterEqual})),n.d(e,"greaterEqualStrict",(function(){return i.greaterEqualStrict})),n.d(e,"greaterStrict",(function(){return i.greaterStrict})),n.d(e,"hammingWindow",(function(){return i.hammingWindow})),n.d(e,"hannWindow",(function(){return i.hannWindow})),n.d(e,"ifft",(function(){return i.ifft})),n.d(e,"imag",(function(){return i.imag})),n.d(e,"image",(function(){return i.image})),n.d(e,"inTopKAsync",(function(){return i.inTopKAsync})),n.d(e,"io",(function(){return i.io})),n.d(e,"irfft",(function(){return i.irfft})),n.d(e,"isFinite",(function(){return i.isFinite})),n.d(e,"isInf",(function(){return i.isInf})),n.d(e,"isNaN",(function(){return i.isNaN})),n.d(e,"keep",(function(){return i.keep})),n.d(e,"leakyRelu",(function(){return i.leakyRelu})),n.d(e,"less",(function(){return i.less})),n.d(e,"lessEqual",(function(){return i.lessEqual})),n.d(e,"lessEqualStrict",(function(){return i.lessEqualStrict})),n.d(e,"lessStrict",(function(){return i.lessStrict})),n.d(e,"linalg",(function(){return i.linalg})),n.d(e,"linspace",(function(){return i.linspace})),n.d(e,"localResponseNormalization",(function(){return i.localResponseNormalization})),n.d(e,"log",(function(){return i.log})),n.d(e,"log1p",(function(){return i.log1p})),n.d(e,"logSigmoid",(function(){return i.logSigmoid})),n.d(e,"logSoftmax",(function(){return i.logSoftmax})),n.d(e,"logSumExp",(function(){return i.logSumExp})),n.d(e,"logicalAnd",(function(){return i.logicalAnd})),n.d(e,"logicalNot",(function(){return i.logicalNot})),n.d(e,"logicalOr",(function(){return i.logicalOr})),n.d(e,"logicalXor",(function(){return i.logicalXor})),n.d(e,"losses",(function(){return i.losses})),n.d(e,"matMul",(function(){return i.matMul})),n.d(e,"math",(function(){return i.math})),n.d(e,"max",(function(){return i.max})),n.d(e,"maxPool",(function(){return i.maxPool})),n.d(e,"maxPool3d",(function(){return i.maxPool3d})),n.d(e,"maximum",(function(){return i.maximum})),n.d(e,"maximumStrict",(function(){return i.maximumStrict})),n.d(e,"mean",(function(){return i.mean})),n.d(e,"memory",(function(){return i.memory})),n.d(e,"min",(function(){return i.min})),n.d(e,"minimum",(function(){return i.minimum})),n.d(e,"minimumStrict",(function(){return i.minimumStrict})),n.d(e,"mod",(function(){return i.mod})),n.d(e,"modStrict",(function(){return i.modStrict})),n.d(e,"moments",(function(){return i.moments})),n.d(e,"movingAverage",(function(){return i.movingAverage})),n.d(e,"mul",(function(){return i.mul})),n.d(e,"mulStrict",(function(){return i.mulStrict})),n.d(e,"multiRNNCell",(function(){return i.multiRNNCell})),n.d(e,"multinomial",(function(){return i.multinomial})),n.d(e,"neg",(function(){return i.neg})),n.d(e,"nextFrame",(function(){return i.nextFrame})),n.d(e,"norm",(function(){return i.norm})),n.d(e,"notEqual",(function(){return i.notEqual})),n.d(e,"notEqualStrict",(function(){return i.notEqualStrict})),n.d(e,"oneHot",(function(){return i.oneHot})),n.d(e,"ones",(function(){return i.ones})),n.d(e,"onesLike",(function(){return i.onesLike})),n.d(e,"op",(function(){return i.op})),n.d(e,"outerProduct",(function(){return i.outerProduct})),n.d(e,"pad",(function(){return i.pad})),n.d(e,"pad1d",(function(){return i.pad1d})),n.d(e,"pad2d",(function(){return i.pad2d})),n.d(e,"pad3d",(function(){return i.pad3d})),n.d(e,"pad4d",(function(){return i.pad4d})),n.d(e,"pool",(function(){return i.pool})),n.d(e,"pow",(function(){return i.pow})),n.d(e,"powStrict",(function(){return i.powStrict})),n.d(e,"prelu",(function(){return i.prelu})),n.d(e,"print",(function(){return i.print})),n.d(e,"prod",(function(){return i.prod})),n.d(e,"profile",(function(){return i.profile})),n.d(e,"rand",(function(){return i.rand})),n.d(e,"randomGamma",(function(){return i.randomGamma})),n.d(e,"randomNormal",(function(){return i.randomNormal})),n.d(e,"randomUniform",(function(){return i.randomUniform})),n.d(e,"range",(function(){return i.range})),n.d(e,"ready",(function(){return i.ready})),n.d(e,"real",(function(){return i.real})),n.d(e,"reciprocal",(function(){return i.reciprocal})),n.d(e,"registerBackend",(function(){return i.registerBackend})),n.d(e,"relu",(function(){return i.relu})),n.d(e,"relu6",(function(){return i.relu6})),n.d(e,"removeBackend",(function(){return i.removeBackend})),n.d(e,"reshape",(function(){return i.reshape})),n.d(e,"reverse",(function(){return i.reverse})),n.d(e,"reverse1d",(function(){return i.reverse1d})),n.d(e,"reverse2d",(function(){return i.reverse2d})),n.d(e,"reverse3d",(function(){return i.reverse3d})),n.d(e,"reverse4d",(function(){return i.reverse4d})),n.d(e,"rfft",(function(){return i.rfft})),n.d(e,"round",(function(){return i.round})),n.d(e,"rsqrt",(function(){return i.rsqrt})),n.d(e,"scalar",(function(){return i.scalar})),n.d(e,"scatterND",(function(){return i.scatterND})),n.d(e,"selu",(function(){return i.selu})),n.d(e,"separableConv2d",(function(){return i.separableConv2d})),n.d(e,"serialization",(function(){return i.serialization})),n.d(e,"setBackend",(function(){return i.setBackend})),n.d(e,"setPlatform",(function(){return i.setPlatform})),n.d(e,"setdiff1dAsync",(function(){return i.setdiff1dAsync})),n.d(e,"sigmoid",(function(){return i.sigmoid})),n.d(e,"sign",(function(){return i.sign})),n.d(e,"signal",(function(){return i.signal})),n.d(e,"sin",(function(){return i.sin})),n.d(e,"sinh",(function(){return i.sinh})),n.d(e,"slice",(function(){return i.slice})),n.d(e,"slice1d",(function(){return i.slice1d})),n.d(e,"slice2d",(function(){return i.slice2d})),n.d(e,"slice3d",(function(){return i.slice3d})),n.d(e,"slice4d",(function(){return i.slice4d})),n.d(e,"softmax",(function(){return i.softmax})),n.d(e,"softplus",(function(){return i.softplus})),n.d(e,"spaceToBatchND",(function(){return i.spaceToBatchND})),n.d(e,"sparseToDense",(function(){return i.sparseToDense})),n.d(e,"spectral",(function(){return i.spectral})),n.d(e,"split",(function(){return i.split})),n.d(e,"sqrt",(function(){return i.sqrt})),n.d(e,"square",(function(){return i.square})),n.d(e,"squaredDifference",(function(){return i.squaredDifference})),n.d(e,"squaredDifferenceStrict",(function(){return i.squaredDifferenceStrict})),n.d(e,"squeeze",(function(){return i.squeeze})),n.d(e,"stack",(function(){return i.stack})),n.d(e,"step",(function(){return i.step})),n.d(e,"stft",(function(){return i.stft})),n.d(e,"stridedSlice",(function(){return i.stridedSlice})),n.d(e,"sub",(function(){return i.sub})),n.d(e,"subStrict",(function(){return i.subStrict})),n.d(e,"sum",(function(){return i.sum})),n.d(e,"tan",(function(){return i.tan})),n.d(e,"tanh",(function(){return i.tanh})),n.d(e,"tensor",(function(){return i.tensor})),n.d(e,"tensor1d",(function(){return i.tensor1d})),n.d(e,"tensor2d",(function(){return i.tensor2d})),n.d(e,"tensor3d",(function(){return i.tensor3d})),n.d(e,"tensor4d",(function(){return i.tensor4d})),n.d(e,"tensor5d",(function(){return i.tensor5d})),n.d(e,"tensor6d",(function(){return i.tensor6d})),n.d(e,"tensor_util",(function(){return i.tensor_util})),n.d(e,"test_util",(function(){return i.test_util})),n.d(e,"tidy",(function(){return i.tidy})),n.d(e,"tile",(function(){return i.tile})),n.d(e,"time",(function(){return i.time})),n.d(e,"topk",(function(){return i.topk})),n.d(e,"train",(function(){return i.train})),n.d(e,"transpose",(function(){return i.transpose})),n.d(e,"truncatedNormal",(function(){return i.truncatedNormal})),n.d(e,"unsortedSegmentSum",(function(){return i.unsortedSegmentSum})),n.d(e,"unstack",(function(){return i.unstack})),n.d(e,"util",(function(){return i.util})),n.d(e,"valueAndGrad",(function(){return i.valueAndGrad})),n.d(e,"valueAndGrads",(function(){return i.valueAndGrads})),n.d(e,"variable",(function(){return i.variable})),n.d(e,"variableGrads",(function(){return i.variableGrads})),n.d(e,"version_core",(function(){return i.version_core})),n.d(e,"webgl",(function(){return i.webgl})),n.d(e,"where",(function(){return i.where})),n.d(e,"whereAsync",(function(){return i.whereAsync})),n.d(e,"zeros",(function(){return i.zeros})),n.d(e,"zerosLike",(function(){return i.zerosLike})),n.d(e,"constraints",(function(){return W})),n.d(e,"initializers",(function(){return Kt})),n.d(e,"layers",(function(){return Li})),n.d(e,"metrics",(function(){return Bi})),n.d(e,"models",(function(){return Ui})),n.d(e,"regularizers",(function(){return $i})),n.d(e,"CallbackList",(function(){return xe})),n.d(e,"CustomCallback",(function(){return ke})),n.d(e,"History",(function(){return Ce})),n.d(e,"Callback",(function(){return Vi})),n.d(e,"callbacks",(function(){return Gi})),n.d(e,"EarlyStopping",(function(){return Hi})),n.d(e,"InputSpec",(function(){return ce})),n.d(e,"SymbolicTensor",(function(){return he})),n.d(e,"LayersModel",(function(){return Tn})),n.d(e,"input",(function(){return Pn})),n.d(e,"loadLayersModel",(function(){return Fn})),n.d(e,"model",(function(){return In})),n.d(e,"registerCallbackConstructor",(function(){return jn})),n.d(e,"sequential",(function(){return Mn})),n.d(e,"RNN",(function(){return bi})),n.d(e,"Sequential",(function(){return Rn})),n.d(e,"LayerVariable",(function(){return oe})),n.d(e,"version_layers",(function(){return en})),n.d(e,"GraphModel",(function(){return Xi.a})),n.d(e,"loadGraphModel",(function(){return Xi.c})),n.d(e,"deregisterOp",(function(){return Xi.b})),n.d(e,"registerOp",(function(){return Xi.d})),n.d(e,"version_converter",(function(){return Xi.e})),n.d(e,"data",(function(){return r})),n.d(e,"version",(function(){return wa}));var r={};n.r(r),n.d(r,"array",(function(){return $o})),n.d(r,"Dataset",(function(){return Bo})),n.d(r,"zip",(function(){return Vo})),n.d(r,"CSVDataset",(function(){return Qo})),n.d(r,"TextLineDataset",(function(){return Ho})),n.d(r,"csv",(function(){return pa})),n.d(r,"func",(function(){return ma})),n.d(r,"generator",(function(){return ga})),n.d(r,"microphone",(function(){return va})),n.d(r,"webcam",(function(){return ya})),n.d(r,"FileDataSource",(function(){return da})),n.d(r,"URLDataSource",(function(){return fa})),n.d(r,"version_data",(function(){return ba}));var i=n("Re/O"),o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function a(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var s,u=function(){return(u=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};function l(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(a,s)}u((r=r.apply(t,e||[])).next())}))}function c(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}function h(){return null==s&&(s=Object(i.backend)().epsilon()),s}var d=function(t){function e(n){var r=t.call(this,n)||this;return Object.setPrototypeOf(r,e.prototype),r}return a(e,t),e}(Error),f=function(t){function e(n){var r=t.call(this,n)||this;return Object.setPrototypeOf(r,e.prototype),r}return a(e,t),e}(Error),p=function(t){function e(n){var r=t.call(this,n)||this;return Object.setPrototypeOf(r,e.prototype),r}return a(e,t),e}(Error),m=function(t){function e(n){var r=t.call(this,n)||this;return Object.setPrototypeOf(r,e.prototype),r}return a(e,t),e}(Error),g=function(t){function e(n){var r=t.call(this,n)||this;return Object.setPrototypeOf(r,e.prototype),r}return a(e,t),e}(Error);function y(t,e){if(Array.isArray(t)){for(var n=[],r=0;r<e;r++)n=n.concat(t);return n}return(n=new Array(e)).fill(t),n}function v(t,e){if(!t)throw new g(e)}function b(t,e){for(var n=0,r=0,i=t;r<i.length;r++)i[r]===e&&n++;return n}function w(t){return 1===t.length?t[0]:t}function x(t){return Array.isArray(t)?t:[t]}function _(t){var e=t.replace(/(.)([A-Z][a-z0-9]+)/g,"$1_$2").replace(/([a-z])([A-Z])/g,"$1_$2").toLowerCase();return"_"!==e[0]?e:"private"+e}function C(t){return t.length<=1||-1===t.indexOf("_")?t:t.replace(/[_]+(\w|$)/g,(function(t,e){return e.toUpperCase()}))}!function(t){a((function e(n){var r=t.call(this,n)||this;return Object.setPrototypeOf(r,e.prototype),r}),t)}(Error);var k={};function S(t){if(null==t)return null;var e={};return e.className=t.getClassName(),e.config=t.getConfig(),e}function E(t,e,n,r,i){var o,a,s;if(void 0===e&&(e={}),void 0===n&&(n={}),void 0===r&&(r="object"),void 0===i&&(i=!1),"string"==typeof t){var l=void 0;if(t in n)l=n[t];else if(t in k)l=k[t];else if(null==(l=e[t]))throw new p("Unknown "+r+": "+t+". This may be due to one of the following reasons:\n1. The "+r+" is defined in Python, in which case it needs to be ported to TensorFlow.js or your JavaScript code.\n2. The custom "+r+" is defined in JavaScript, but is not registered properly with tf.serialization.registerClass().");return l}var c=t;if(null==c.className||null==c.config)throw new p(r+": Improper config format: "+JSON.stringify(c)+".\n'className' and 'config' must set.");var h=c.className,d=void 0,f=void 0;if(h in n?(d=(o=n[h])[0],f=o[1]):h in k?(d=(a=k.className)[0],f=a[1]):h in e&&(d=(s=e[h])[0],f=s[1]),null==d)throw new p("Unknown "+r+": "+h+". This may be due to one of the following reasons:\n1. The "+r+" is defined in Python, in which case it needs to be ported to TensorFlow.js or your JavaScript code.\n2. The custom "+r+" is defined in JavaScript, but is not registered properly with tf.serialization.registerClass().");if(null!=f){for(var m={},g=0,y=Object.keys(k);g<y.length;g++)m[C=y[g]]=k[C];for(var v=0,b=Object.keys(n);v<b.length;v++)m[C=b[v]]=n[C];c.config.customObjects=m;for(var w=u({},k),x=0,_=Object.keys(n);x<_.length;x++){var C=_[x];k[C]=n[C]}!function t(e){if(null!=e&&"object"==typeof e)if(Array.isArray(e))e.forEach((function(e){return t(e)}));else for(var n=0,r=Object.keys(e);n<r.length;n++){var i=r[n],o=e[i];null!=o&&"object"==typeof o&&(Array.isArray(o)||"ndarray"!==o.type||"number"!=typeof o.value?t(o):e[i]=o.value)}}(c.config);var S=f(d,c.config,n,i);return k=u({},w),S}w=u({},k);for(var E=0,O=Object.keys(n);E<O.length;E++)k[C=O[E]]=n[C];return S=new d(c.config),k=u({},w),S}function O(t,e){return-1*function(t,e){return t<e?-1:t>e?1:0}(t,e)}function A(t){if(null==t)return t;for(var e=[],n=0,r=t;n<r.length;n++){var i=r[n];-1===e.indexOf(i)&&e.push(i)}return e}function N(t){if(null==t)throw new p("Invalid value in obj: "+JSON.stringify(t));for(var e in t)if(t.hasOwnProperty(e))return!1;return!0}function T(t,e,n){if(null!=n&&t.indexOf(n)<0)throw new p(n+" is not a valid "+e+".  Valid values are "+t+" or null/undefined.")}function D(t,e,n,r){return void 0===n&&(n=0),void 0===r&&(r=1/0),v(n>=0),v(r>=n),Array.isArray(t)&&t.length>=n&&t.length<=r&&t.every((function(t){return typeof t===e}))}function R(t,e){Array.isArray(t)?(i.util.assert(t.length>0,(function(){return e+" is unexpectedly an empty array."})),t.forEach((function(t,n){return R(t,"element "+(n+1)+" of "+e)}))):i.util.assert(Number.isInteger(t)&&t>0,(function(){return"Expected "+e+" to be a positive integer, but got "+function t(e){return null===e?"null":Array.isArray(e)?"["+e.map((function(e){return t(e)})).join(",")+"]":"string"==typeof e?'"'+e+'"':""+e}(t)+"."}))}function I(t){return"relu"===t?"relu":"linear"===t?"linear":"elu"===t?"elu":null}function M(t,e){return Object(i.tidy)((function(){return Object(i.sqrt)(Object(i.sum)(Object(i.mulStrict)(t,t),e,!0))}))}var F=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return a(e,t),e.prototype.getConfig=function(){return{}},e}(i.serialization.Serializable),P=function(t){function e(e){var n=t.call(this)||this;return n.defaultMaxValue=2,n.defaultAxis=0,n.maxValue=null!=e.maxValue?e.maxValue:n.defaultMaxValue,n.axis=null!=e.axis?e.axis:n.defaultAxis,n}return a(e,t),e.prototype.apply=function(t){var e=this;return Object(i.tidy)((function(){var n=M(t,e.axis),r=Object(i.clipByValue)(n,0,e.maxValue);return Object(i.mul)(t,Object(i.div)(r,Object(i.add)(h(),n)))}))},e.prototype.getConfig=function(){return{maxValue:this.maxValue,axis:this.axis}},e.className="MaxNorm",e}(F);i.serialization.registerClass(P);var j=function(t){function e(e){var n=t.call(this)||this;return n.defaultAxis=0,n.axis=null!=e.axis?e.axis:n.defaultAxis,n}return a(e,t),e.prototype.apply=function(t){var e=this;return Object(i.tidy)((function(){return Object(i.div)(t,Object(i.add)(h(),M(t,e.axis)))}))},e.prototype.getConfig=function(){return{axis:this.axis}},e.className="UnitNorm",e}(F);i.serialization.registerClass(j);var z=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return a(e,t),e.prototype.apply=function(t){return Object(i.relu)(t)},e.className="NonNeg",e}(F);i.serialization.registerClass(z);var L=function(t){function e(e){var n=t.call(this)||this;return n.defaultMinValue=0,n.defaultMaxValue=1,n.defaultRate=1,n.defaultAxis=0,n.minValue=null!=e.minValue?e.minValue:n.defaultMinValue,n.maxValue=null!=e.maxValue?e.maxValue:n.defaultMaxValue,n.rate=null!=e.rate?e.rate:n.defaultRate,n.axis=null!=e.axis?e.axis:n.defaultAxis,n}return a(e,t),e.prototype.apply=function(t){var e=this;return Object(i.tidy)((function(){var n=M(t,e.axis),r=Object(i.add)(Object(i.mul)(e.rate,Object(i.clipByValue)(n,e.minValue,e.maxValue)),Object(i.mul)(1-e.rate,n));return Object(i.mul)(t,Object(i.div)(r,Object(i.add)(h(),n)))}))},e.prototype.getConfig=function(){return{minValue:this.minValue,maxValue:this.maxValue,rate:this.rate,axis:this.axis}},e.className="MinMaxNorm",e}(F);i.serialization.registerClass(L);var B={maxNorm:"MaxNorm",minMaxNorm:"MinMaxNorm",nonNeg:"NonNeg",unitNorm:"UnitNorm"};function U(t){return S(t)}function $(t,e){return void 0===e&&(e={}),E(t,i.serialization.SerializationMap.getMap().classNameMap,e,"constraint")}function V(t){return null==t?null:"string"==typeof t?$({className:t in B?B[t]:t,config:{}}):t instanceof F?t:$(t)}var W=Object.freeze({maxNorm:function(t){return new P(t)},unitNorm:function(t){return new j(t)},nonNeg:function(){return new z},minMaxNorm:function(t){return new L(t)}}),q=["channelsFirst","channelsLast"],H=["valid","same","causal"],G=["max","avg"],X=["sum","mul","concat","ave"],K=new Map;function Y(t){T(q,"DataFormat",t)}function Z(t){T(H,"PaddingMode",t)}function Q(t){T(G,"PoolMode",t)}var J=[];function tt(t,e){J.push(t);try{var n=e();return J.pop(),n}catch(t){throw J.pop(),t}}function et(t){if(!it(t))throw new Error("Not a valid tensor name: '"+t+"'");return(0===J.length?"":J.join("/")+"/")+t}function nt(t){if(!it(t))throw new Error("Not a valid tensor name: '"+t+"'");K.has(t)||K.set(t,0);var e=K.get(t);if(K.set(t,K.get(t)+1),e>0){var n=t+"_"+e;return K.set(n,1),n}return t}var rt=new RegExp(/^[A-Za-z0-9][-A-Za-z0-9\._\/]*$/);function it(t){return!!t.match(rt)}function ot(t){return t===parseInt(t.toString(),10)}function at(t,e,n){null==e&&(e=0),null==n&&(n=t.length);for(var r=1,i=e;i<n;++i)r*=t[i];return r}function st(t){return t=Array.isArray(t)?new Float32Array(t):t,Object(i.tensor1d)(t)}function ut(t){return Object(i.min)(st(t)).dataSync()[0]}function lt(t){return Object(i.max)(st(t)).dataSync()[0]}function ct(t,e){if(e<t)throw new p("end ("+e+") < begin ("+t+") is forbidden.");for(var n=[],r=t;r<e;++r)n.push(r);return n}function ht(t,e){return t.asType(e)}function dt(t,e){void 0===e&&(e=-1);var n=t.shape.slice();return e<0&&(e=n.length+e+1),n.splice(e,0,1),t.reshape(n)}function ft(t,e,n){return Object(i.tidy)((function(){switch(t.rank){case 1:return Object(i.slice1d)(t,e,n);case 2:return Object(i.slice2d)(t,[e,0],[n,t.shape[1]]);case 3:return Object(i.slice3d)(t,[e,0,0],[n,t.shape[1],t.shape[2]]);case 4:return Object(i.slice4d)(t,[e,0,0,0],[n,t.shape[1],t.shape[2],t.shape[3]]);default:throw new p("sliceAlongFirstAxis() received an unsupported tensor rank: "+t.rank)}}))}function pt(t,e,n){return Object(i.tidy)((function(){switch(t.rank){case 1:return Object(i.slice1d)(t,e,n);case 2:return Object(i.slice2d)(t,[0,e],[t.shape[0],n]);case 3:return Object(i.slice3d)(t,[0,0,e],[t.shape[0],t.shape[1],n]);case 4:return Object(i.slice4d)(t,[0,0,0,e],[t.shape[0],t.shape[1],t.shape[2],n]);default:throw new p("sliceAlongLastAxis() received an unsupported tensor rank: "+t.rank)}}))}function mt(t,e,n,r){return Object(i.tidy)((function(){switch(t.rank){case 1:return Object(i.slice1d)(t,e,n);case 2:switch(r){case 1:return ft(t,e,n);case 2:return pt(t,e,n);default:throw new p("The axis is not within the rank of the tensor "+r)}case 3:switch(r){case 1:return ft(t,e,n);case 2:return Object(i.slice3d)(t,[0,e,0],[t.shape[0],n,t.shape[2]]);case 3:return pt(t,e,n);default:throw new p("The axis is not within the rank of the tensor "+r)}case 4:switch(r){case 1:return ft(t,e,n);case 2:return Object(i.slice4d)(t,[0,e,0,0],[t.shape[0],n,t.shape[2],t.shape[3]]);case 3:return Object(i.slice4d)(t,[0,0,e,0],[t.shape[0],t.shape[1],n,t.shape[3]]);case 4:return pt(t,e,n);default:throw new p("The axis is not within the rank of the tensor "+r)}default:throw new p("sliceAlongLastAxis() received an unsupported tensor rank: "+t.rank)}}))}function gt(t,e){var n;return void 0===e&&(e=-1),e<0&&(e=0!==(n=t[0].rank)?n:0),e===t[0].rank&&(e=-1),Object(i.concat)(t,e)}function yt(t,e){switch(t.rank){case 1:return Object(i.concat1d)([t,e]);case 2:return Object(i.concat2d)([t,e],0);case 3:return Object(i.concat3d)([t,e],0);case 4:return Object(i.concat4d)([t,e],0);default:throw new p("concatAlongFirstAxis() received an unsupported tensor rank: "+t.rank)}}function vt(t,e){if(Array.isArray(e)||(e=[e]),t.rank!==e.length)throw new p("The length of input n ("+e.length+") does not match the number of dimensions in input x ("+t.rank+")");return Object(i.tile)(t,e)}function bt(t,e,n,r,o){return void 0===e&&(e=0),void 0===n&&(n=1),Object(i.randomNormal)(t,e,n,r,o)}function wt(t,e,n,r){if(t.rank<2||e.rank<2)throw new m("dot requires both inputs to be rank >= 2 but got x shape = "+t.shape+" and y shape = "+e.shape);if(e.rank>=3&&t.shape.slice(-1)[0]!==(h=e.shape.slice(-2)[0]))throw new m("If rank y >= 3, then the second last dim of y must equal the last dim of x but got x shape = "+t.shape+" and  y shape = "+e.shape);if(2===t.rank&&2===e.rank){var o=!1,a=!1;return i.fused.matMul({a:t,b:e,transposeA:o,transposeB:a,bias:r?Ct(t.rank,r,"channelsLast"):null,activation:n})}var s=t.shape.slice(),u=s.pop();t=t.reshape([-1,u]);var l=e.shape.slice(),c=l.pop(),h=l.pop(),d=l.concat([c]),f=Array.from({length:e.rank},(function(t,n){return 0===n?e.rank-2:n<=e.rank-2?n-1:n}));e=e.transpose(f).reshape([h,-1]);var p=s.concat(d);return i.fused.matMul({a:t,b:e,transposeA:o=!1,transposeB:a=!1,bias:r?Ct(t.rank,r,"channelsLast"):null,activation:n}).reshape(p)}function xt(t,e,n){return Object(i.tidy)((function(){return e=Array.isArray(e)?Object(i.tensor1d)(e,"int32"):e.toInt(),Object(i.gather)(t,e,n)}))}function _t(t){return Object(i.mulStrict)(t,t)}function Ct(t,e,n){var r=e.shape;if(1!==e.rank&&e.rank!==t)throw new p("Unexpected bias dimensions: "+e.rank+"; expected it to be 1 or "+t);if(5===t){if("channelsFirst"===n)return e.reshape(1===r.length?[1,r[0],1,1,1]:[1,r[3],r[0],r[1],r[2]]);if("channelsLast"===n)return e.reshape(1===r.length?[1,1,1,1,r[0]]:[1].concat(r))}else if(4===t){if("channelsFirst"===n)return e.reshape(1===r.length?[1,r[0],1,1]:[1,r[2],r[0],r[1]]);if("channelsLast"===n)return e.reshape(1===r.length?[1,1,1,r[0]]:[1].concat(r))}else if(3===t){if("channelsFirst"===n)return e.reshape(1===r.length?[1,r[0],1]:[1,r[1],r[0]]);if("channelsLast"===n)return e.reshape(1===r.length?[1,1,r[0]]:[1].concat(r))}else if(t<3)return e;throw new p("Unsupported input rank by biasAdd: "+e.rank)}function kt(t,e,n){return Object(i.tidy)((function(){return null==n&&(n="channelsLast"),Y(n),t.add(Ct(t.rank,e,n))}))}function St(t,e,n,r){return Object(i.tidy)((function(){return Object(i.dropout)(t,e,n,r)}))}function Et(t,e,n){return void 0===n&&(n=!1),n?t():e()}var Ot=["fanIn","fanOut","fanAvg"],At=["normal","uniform","truncatedNormal"],Nt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return a(e,t),e.prototype.fromConfigUsesCustomObjects=function(){return!1},e.prototype.getConfig=function(){return{}},e}(i.serialization.Serializable),Tt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return a(e,t),e.prototype.apply=function(t,e){return Object(i.zeros)(t,e)},e.className="Zeros",e}(Nt);i.serialization.registerClass(Tt);var Dt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return a(e,t),e.prototype.apply=function(t,e){return Object(i.ones)(t,e)},e.className="Ones",e}(Nt);i.serialization.registerClass(Dt);var Rt=function(t){function e(e){var n=t.call(this)||this;if("object"!=typeof e)throw new p("Expected argument of type ConstantConfig but got "+e);if(void 0===e.value)throw new p("config must have value set but got "+e);return n.value=e.value,n}return a(e,t),e.prototype.apply=function(t,e){var n=this;return Object(i.tidy)((function(){return Object(i.mul)(Object(i.scalar)(n.value),Object(i.ones)(t,e))}))},e.prototype.getConfig=function(){return{value:this.value}},e.className="Constant",e}(Nt);i.serialization.registerClass(Rt);var It=function(t){function e(e){var n=t.call(this)||this;return n.DEFAULT_MINVAL=-.05,n.DEFAULT_MAXVAL=.05,n.minval=e.minval||n.DEFAULT_MINVAL,n.maxval=e.maxval||n.DEFAULT_MAXVAL,n.seed=e.seed,n}return a(e,t),e.prototype.apply=function(t,e){return Object(i.randomUniform)(t,this.minval,this.maxval,e)},e.prototype.getConfig=function(){return{minval:this.minval,maxval:this.maxval,seed:this.seed}},e.className="RandomUniform",e}(Nt);i.serialization.registerClass(It);var Mt=function(t){function e(e){var n=t.call(this)||this;return n.DEFAULT_MEAN=0,n.DEFAULT_STDDEV=.05,n.mean=e.mean||n.DEFAULT_MEAN,n.stddev=e.stddev||n.DEFAULT_STDDEV,n.seed=e.seed,n}return a(e,t),e.prototype.apply=function(t,e){if("float32"!==(e=e||"float32")&&"int32"!==e)throw new m("randomNormal does not support dType "+e+".");return bt(t,this.mean,this.stddev,e,this.seed)},e.prototype.getConfig=function(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}},e.className="RandomNormal",e}(Nt);i.serialization.registerClass(Mt);var Ft=function(t){function e(e){var n=t.call(this)||this;return n.DEFAULT_MEAN=0,n.DEFAULT_STDDEV=.05,n.mean=e.mean||n.DEFAULT_MEAN,n.stddev=e.stddev||n.DEFAULT_STDDEV,n.seed=e.seed,n}return a(e,t),e.prototype.apply=function(t,e){if("float32"!==(e=e||"float32")&&"int32"!==e)throw new m("truncatedNormal does not support dType "+e+".");return Object(i.truncatedNormal)(t,this.mean,this.stddev,e,this.seed)},e.prototype.getConfig=function(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}},e.className="TruncatedNormal",e}(Nt);i.serialization.registerClass(Ft);var Pt=function(t){function e(e){var n=t.call(this)||this;return n.gain=null!=e.gain?e.gain:1,n}return a(e,t),e.prototype.apply=function(t,e){var n=this;return Object(i.tidy)((function(){if(2!==t.length||t[0]!==t[1])throw new p("Identity matrix initializer can only be used for 2D square matrices.");return Object(i.mul)(n.gain,Object(i.eye)(t[0]))}))},e.prototype.getConfig=function(){return{gain:this.gain}},e.className="Identity",e}(Nt);i.serialization.registerClass(Pt);var jt=function(t){function e(e){var n=t.call(this)||this;if(e.scale<0)throw new p("scale must be a positive float. Got: "+e.scale);return n.scale=null==e.scale?1:e.scale,n.mode=null==e.mode?"fanIn":e.mode,function(t){T(Ot,"FanMode",t)}(n.mode),n.distribution=null==e.distribution?"normal":e.distribution,function(t){T(At,"Distribution",t)}(n.distribution),n.seed=e.seed,n}return a(e,t),e.prototype.apply=function(t,e){var n=function(t,e){var n,r;if(void 0===e&&(e="channelsLast"),Y(e),2===t.length)n=t[0],r=t[1];else if(-1!==[3,4,5].indexOf(t.length))if("channelsFirst"===e){var i=at(t,2);n=t[1]*i,r=t[0]*i}else"channelsLast"===e&&(i=at(t,0,t.length-2),n=t[t.length-2]*i,r=t[t.length-1]*i);else{var o=at(t);n=Math.sqrt(o),r=Math.sqrt(o)}return[n,r]}(t),r=n[0],o=n[1],a=this.scale;if(a/="fanIn"===this.mode?Math.max(1,r):"fanOut"===this.mode?Math.max(1,o):Math.max(1,(r+o)/2),"normal"===this.distribution){var s=Math.sqrt(a);if("float32"!==(e=e||"float32")&&"int32"!==e)throw new m(this.getClassName()+" does not support dType "+e+".");return Object(i.truncatedNormal)(t,0,s,e,this.seed)}var u=Math.sqrt(3*a);return Object(i.randomUniform)(t,-u,u,e)},e.prototype.getConfig=function(){return{scale:this.scale,mode:this.mode,distribution:this.distribution,seed:this.seed}},e.className="VarianceScaling",e}(Nt);i.serialization.registerClass(jt);var zt=function(t){function e(e){return t.call(this,{scale:1,mode:"fanAvg",distribution:"uniform",seed:null==e?null:e.seed})||this}return a(e,t),e.prototype.getClassName=function(){return jt.className},e.className="GlorotUniform",e}(jt);i.serialization.registerClass(zt);var Lt=function(t){function e(e){return t.call(this,{scale:1,mode:"fanAvg",distribution:"normal",seed:null==e?null:e.seed})||this}return a(e,t),e.prototype.getClassName=function(){return jt.className},e.className="GlorotNormal",e}(jt);i.serialization.registerClass(Lt);var Bt=function(t){function e(e){return t.call(this,{scale:2,mode:"fanIn",distribution:"normal",seed:null==e?null:e.seed})||this}return a(e,t),e.prototype.getClassName=function(){return jt.className},e.className="HeNormal",e}(jt);i.serialization.registerClass(Bt);var Ut=function(t){function e(e){return t.call(this,{scale:2,mode:"fanIn",distribution:"uniform",seed:null==e?null:e.seed})||this}return a(e,t),e.prototype.getClassName=function(){return jt.className},e.className="HeUniform",e}(jt);i.serialization.registerClass(Ut);var $t=function(t){function e(e){return t.call(this,{scale:1,mode:"fanIn",distribution:"normal",seed:null==e?null:e.seed})||this}return a(e,t),e.prototype.getClassName=function(){return jt.className},e.className="LeCunNormal",e}(jt);i.serialization.registerClass($t);var Vt=function(t){function e(e){return t.call(this,{scale:1,mode:"fanIn",distribution:"uniform",seed:null==e?null:e.seed})||this}return a(e,t),e.prototype.getClassName=function(){return jt.className},e.className="LeCunNormal",e}(jt);i.serialization.registerClass(Vt);var Wt=function(t){function e(e){var n=t.call(this)||this;if(n.DEFAULT_GAIN=1,n.gain=null==e.gain?n.DEFAULT_GAIN:e.gain,n.seed=e.seed,null!=n.seed)throw new m("Random seed is not implemented for Orthogonal Initializer yet.");return n}return a(e,t),e.prototype.apply=function(t,e){var n=this;return Object(i.tidy)((function(){if(2!==t.length)throw new m("The Orthogonal Initializer does not support non-2D shapes yet.");t[0]*t[1]>2e3&&console.warn("Orthogonal initializer is being called on a matrix with more than 2000 ("+t[0]*t[1]+") elements: Slowness may result.");var e=bt(t[0]>t[1]?[t[1],t[0]]:t,0,1,"float32"),r=i.linalg.gramSchmidt(e);return t[0]>t[1]&&(r=r.transpose()),Object(i.mul)(n.gain,r)}))},e.prototype.getConfig=function(){return{gain:this.gain,seed:this.seed}},e.className="Orthogonal",e}(Nt);i.serialization.registerClass(Wt);var qt={constant:"Constant",glorotNormal:"GlorotNormal",glorotUniform:"GlorotUniform",heNormal:"HeNormal",heUniform:"HeUniform",identity:"Identity",leCunNormal:"LeCunNormal",leCunUniform:"LeCunUniform",ones:"Ones",orthogonal:"Orthogonal",randomNormal:"RandomNormal",randomUniform:"RandomUniform",truncatedNormal:"TruncatedNormal",varianceScaling:"VarianceScaling",zeros:"Zeros"};function Ht(t,e){return void 0===e&&(e={}),E(t,i.serialization.SerializationMap.getMap().classNameMap,e,"initializer")}function Gt(t){return S(t)}function Xt(t){if("string"==typeof t){var e=t in qt?qt[t]:t;if("GlorotNormal"===e)return new Lt;if("GlorotUniform"===e)return new zt;if("HeNormal"===e)return new Bt;if("HeUniform"===e)return new Ut;if("LeCunNormal"===e)return new $t;if("LeCunUniform"===e)return new Vt;var n={};return n.className=e,n.config={},Ht(n)}return t instanceof Nt?t:Ht(t)}var Kt=Object.freeze({zeros:function(){return new Tt},ones:function(){return new Dt},constant:function(t){return new Rt(t)},randomUniform:function(t){return new It(t)},randomNormal:function(t){return new Mt(t)},truncatedNormal:function(t){return new Ft(t)},identity:function(t){return new Pt(t)},varianceScaling:function(t){return new jt(t)},glorotUniform:function(t){return new zt(t)},glorotNormal:function(t){return new Lt(t)},heNormal:function(t){return new Bt(t)},heUniform:function(t){return new Ut(t)},leCunNormal:function(t){return new $t(t)},leCunUniform:function(t){return new Vt(t)},orthogonal:function(t){return new Wt(t)}}),Yt=0;function Zt(){return Yt++}var Qt={};function Jt(t){return void 0===t&&(t=""),t in Qt||(Qt[t]=0),Qt[t]+=1,t+Qt[t].toString()}function te(t){return Array.isArray(t)&&Array.isArray(t[0])}function ee(t){return 0===t.length?[]:Array.isArray(t[0])?t:[t]}function ne(t){var e;if(Array.isArray(t)){if(1!==t.length)throw new p("Expected Tensor length to be 1; got "+t.length);e=t[0]}else e=t;return e}function re(t){if(Array.isArray(t)&&Array.isArray(t[0])){if(1===t.length)return(t=t)[0];throw new p("Expected exactly 1 Shape; got "+t.length)}return t}function ie(t){for(var e=0,n=0,r=t;n<r.length;n++){var i=r[n];e+=0===i.shape.length?1:i.shape.reduce((function(t,e){return t*e}))}return e}var oe=function(){function t(t,e,n,r,o){void 0===e&&(e="float32"),void 0===n&&(n="Variable"),void 0===r&&(r=!0),void 0===o&&(o=null),this.dtype=null==e?"float32":e,this.shape=t.shape,this.id=Zt(),this.originalName=et(n=null==n?"Variable":n),this.name=nt(this.originalName),this.trainable_=r,this.constraint=o,this.val=Object(i.variable)(t,this.trainable_,this.name,this.dtype)}return t.prototype.read=function(){return this.assertNotDisposed(),this.val},t.prototype.write=function(t){return this.assertNotDisposed(),function(t,e){if(t.shape.toString()!==e.shape.toString())throw new Error("Shape mismatch: "+JSON.stringify(t.shape)+" vs. "+JSON.stringify(e.shape))}(this.val,t),this.val.id!==t.id&&(this.val.assign(t),null!=this.constraint&&this.val.assign(this.constraint.apply(this.val))),this},t.prototype.dispose=function(){this.assertNotDisposed(),this.val.dispose()},t.prototype.assertNotDisposed=function(){if(this.val.isDisposed)throw new Error("LayersVariable "+this.name+" is already disposed.")},Object.defineProperty(t.prototype,"trainable",{get:function(){return this.trainable_},set:function(t){this.trainable_=t,this.val.trainable=t},enumerable:!0,configurable:!0}),t}();function ae(t){return t.map((function(t){return t.read()}))}function se(t){t.forEach((function(t){t[0].write(t[1])}))}var ue,le,ce=function(t){this.dtype=t.dtype,this.shape=t.shape,this.ndim=null!=t.shape?t.shape.length:t.ndim,this.maxNDim=t.maxNDim,this.minNDim=t.minNDim,this.axes=t.axes||{}},he=function(t,e,n,r,i,o,a){this.dtype=t,this.shape=e,this.sourceLayer=n,this.inputs=r,this.callArgs=i,this.outputTensorIndex=a,this.id=Zt(),null!=o&&(this.originalName=et(o),this.name=nt(this.originalName)),this.rank=e.length},de=0,fe=function(){function t(t,e){this.callArgs=e,this.id=de++,this.outboundLayer=t.outboundLayer,this.inboundLayers=t.inboundLayers,this.nodeIndices=t.nodeIndices,this.tensorIndices=t.tensorIndices,this.inputTensors=t.inputTensors,this.outputTensors=t.outputTensors,this.inputMasks=t.inputMasks,this.outputMasks=t.outputMasks,this.inputShapes=t.inputShapes,this.outputShapes=t.outputShapes;for(var n=0,r=t.inboundLayers;n<r.length;n++){var i=r[n];null!=i&&i.outboundNodes.push(this)}t.outboundLayer.inboundNodes.push(this)}return t.prototype.getConfig=function(){for(var t=[],e=0,n=this.inboundLayers;e<n.length;e++){var r=n[e];t.push(null!=r?r.name:null)}return{outboundLayer:this.outboundLayer?this.outboundLayer.name:null,inboundLayers:t,nodeIndices:this.nodeIndices,tensorIndices:this.tensorIndices}},t}(),pe=0,me=function(t){function e(e){var n=t.call(this)||this;n._callHook=null,n._addedWeightNames=[],n._stateful=!1,n.id=pe++,n.activityRegularizer=null,n.inputSpec=null,n.supportsMasking=!1,n._trainableWeights=[],n._nonTrainableWeights=[],n._losses=[],n._updates=[],n._built=!1,n.inboundNodes=[],n.outboundNodes=[];var r=e.name;if(!r){var i=n.getClassName();r=_(i)+"_"+Jt(i)}if(n.name=r,n.trainable_=null==e.trainable||e.trainable,null!=e.inputShape||null!=e.batchInputShape){var o=void 0;if(null!=e.batchInputShape)o=e.batchInputShape;else if(null!=e.inputShape){var a=null;null!=e.batchSize&&(a=e.batchSize),o=[a].concat(e.inputShape)}n.batchInputShape=o;var s=e.dtype;null==s&&(s=e.inputDType),null==s&&(s="float32"),n.dtype=s}return n.initialWeights=null!=e.weights?e.weights:null,n._refCount=null,n.fastWeightInitDuringBuild=!1,n}return a(e,t),e.nodeKey=function(t,e){return t.name+"_ib-"+e.toString()},e.prototype.getNodeAtIndex=function(t,e){if(0===this.inboundNodes.length)throw new f("The layer has never been called and thus has no defined "+e+".");if(this.inboundNodes.length<=t)throw new p("Asked to get "+e+" at node "+t+", but the layer has only "+this.inboundNodes.length+" inbound nodes.");return this.inboundNodes[t]},e.prototype.getInputAt=function(t){return w(this.getNodeAtIndex(t,"input").inputTensors)},e.prototype.getOutputAt=function(t){return w(this.getNodeAtIndex(t,"output").outputTensors)},Object.defineProperty(e.prototype,"input",{get:function(){if(this.inboundNodes.length>1)throw new d("Layer "+this.name+' has multiple inbound nodes, hence the notion of "layer input" is ill-defined. Use `getInputAt(nodeIndex)` instead.');if(0===this.inboundNodes.length)throw new d("Layer "+this.name+" is not connected, no input to return.");return w(this.getNodeAtIndex(0,"input").inputTensors)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"output",{get:function(){if(0===this.inboundNodes.length)throw new d("Layer "+this.name+" has no inbound nodes.");if(this.inboundNodes.length>1)throw new d("Layer "+this.name+' has multiple inbound nodes, hence the notion of "layer output" is ill-defined. Use `getOutputAt(nodeIndex)` instead.');return w(this.getNodeAtIndex(0,"output").outputTensors)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"losses",{get:function(){return this._losses},enumerable:!0,configurable:!0}),e.prototype.calculateLosses=function(){return this.losses.map((function(t){return t()}))},Object.defineProperty(e.prototype,"updates",{get:function(){return this._updates},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"built",{get:function(){return this._built},set:function(t){this._built=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"trainable",{get:function(){return this.trainable_},set:function(t){this._trainableWeights.forEach((function(e){return e.trainable=t})),this.trainable_=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"trainableWeights",{get:function(){return this.trainable_?this._trainableWeights.filter((function(t){return t.trainable})):[]},set:function(t){this._trainableWeights=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"nonTrainableWeights",{get:function(){return this.trainable?this._trainableWeights.filter((function(t){return!t.trainable})).concat(this._nonTrainableWeights):this._trainableWeights.concat(this._nonTrainableWeights)},set:function(t){this._nonTrainableWeights=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"weights",{get:function(){return this.trainableWeights.concat(this.nonTrainableWeights)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"stateful",{get:function(){return this._stateful},enumerable:!0,configurable:!0}),e.prototype.resetStates=function(){if(!this.stateful)throw new Error("Cannot call the resetStates() method of a non-stateful Layer object.")},e.prototype.assertInputCompatibility=function(t){if(t=x(t),null!=this.inputSpec&&0!==this.inputSpec.length){var e=x(this.inputSpec);if(t.length!==e.length)throw new p("Layer "+this.name+" expects "+e.length+" inputs, but it received "+t.length+" input tensors. Input received: "+t);for(var n=0;n<t.length;n++){var r=t[n],i=e[n];if(null!=i){var o=r.rank;if(null!=i.ndim&&o!==i.ndim)throw new p("Input "+n+" is incompatible with layer "+this.name+": expected ndim="+i.ndim+", found ndim="+o);if(null!=i.maxNDim&&o>i.maxNDim)throw new p("Input "+n+" is incompatible with layer "+this.name+": expected max_ndim="+i.maxNDim+", found ndim="+o);if(null!=i.minNDim&&o<i.minNDim)throw new p("Input "+n+" is incompatible with layer "+this.name+": expected min_ndim="+i.minNDim+", found ndim="+o+".");if(null!=i.dtype&&r.dtype!==i.dtype)throw new p("Input "+n+" is incompatible with layer "+this.name+" : expected dtype="+i.dtype+", found dtype="+r.dtype+".");if(i.axes){var a=r.shape;for(var s in i.axes){var u=Number(s),l=i.axes[s];if(null!=l&&-1===[l,null].indexOf(u>=0?a[u]:a[a.length+u]))throw new p("Input "+n+" is incompatible with layer "+this.name+": expected axis "+u+" of input shape to have value "+l+" but got shape "+a+".")}}if(null!=i.shape)for(var c=0;c<i.shape.length;++c){var h=i.shape[c],d=r.shape[c];if(null!=h&&null!=d&&h!==d)throw new p("Input "+n+" is incompatible with layer "+this.name+": expected shape="+i.shape+", found shape="+r.shape+".")}}}}},e.prototype.call=function(t,e){return t},e.prototype.invokeCallHook=function(t,e){null!=this._callHook&&this._callHook(t,e)},e.prototype.setCallHook=function(t){this._callHook=t},e.prototype.clearCallHook=function(){this._callHook=null},e.prototype.apply=function(t,e){var n=this;e=e||{},this.assertNotDisposed();for(var r=x(t),i=!0,o=0,a=r;o<a.length;o++)if(!(a[o]instanceof he)){i=!1;break}for(var s=!0,u=0,l=r;u<l.length;u++)if(l[u]instanceof he){s=!1;break}if(i===s)throw new p("Arguments to apply() must be all SymbolicTensors or all Tensors");return tt(this.name,(function(){if(!n.built){n.assertInputCompatibility(t);for(var i=[],o=0,a=x(t);o<a.length;o++)i.push(a[o].shape);n.build(w(i)),n.built=!0,n.initialWeights&&n.setWeights(n.initialWeights),null===n._refCount&&s&&(n._refCount=1)}if(n.assertInputCompatibility(t),s){for(var u=[],l=0,c=x(p=n.call(t,e));l<c.length;l++){var h=c[l];-1!==r.indexOf(h)&&(h=h.clone()),u.push(h)}if(p=w(u),null!=n.activityRegularizer)throw new m("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return p}var d=function(t){for(var e=[],n=0,r=t=x(t);n<r.length;n++)e.push(r[n].shape);return w(e)}(t),f=n.computeOutputShape(d),p=void 0,g="float32";if(n.warnOnIncompatibleInputShape(Array.isArray(t)?d[0]:d),p=null!=f&&f.length>0&&Array.isArray(f[0])?f.map((function(r,i){return new he(g,r,n,x(t),e,n.name,i)})):new he(g,f,n,x(t),e,n.name),n.addInboundNode(t,p,null,null,d,f,e),n._refCount++,null!=n.activityRegularizer)throw new m("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return p}))},e.prototype.warnOnIncompatibleInputShape=function(t){if(null!=this.batchInputShape)if(t.length!==this.batchInputShape.length)console.warn("The rank of the input tensor provided (shape: "+JSON.stringify(t)+") does not match that of the batchInputShape ("+JSON.stringify(this.batchInputShape)+") of the layer "+this.name);else{var e=!1;this.batchInputShape.forEach((function(n,r){null!=n&&null!=t[r]&&t[r]!==n&&(e=!0)})),e&&console.warn("The shape of the input tensor ("+JSON.stringify(t)+") does not match the expectation of layer "+this.name+": "+JSON.stringify(this.batchInputShape))}},Object.defineProperty(e.prototype,"outputShape",{get:function(){if(null==this.inboundNodes||0===this.inboundNodes.length)throw new d("The layer "+this.name+" has never been called and thus has no defined output shape.");for(var t=[],e=0,n=this.inboundNodes;e<n.length;e++){var r=JSON.stringify(n[e].outputShapes);-1===t.indexOf(r)&&t.push(r)}if(1===t.length){var i=this.inboundNodes[0].outputShapes;return Array.isArray(i)&&Array.isArray(i[0])&&1===i.length?i[0]:i}throw new d("The layer "+this.name+' has multiple inbound nodes with different output shapes. Hence the notion of "outut shape" is ill-defined for the layer.')},enumerable:!0,configurable:!0}),e.prototype.countParams=function(){if(!this.built)throw new f("You tried to call countParams() on "+this.name+", but the layer is not built yet. Build it first by calling build(batchInputShape).");return ie(this.weights)},e.prototype.build=function(t){this.built=!0},e.prototype.getWeights=function(t){return void 0===t&&(t=!1),ae(t?this.trainableWeights:this.weights)},e.prototype.setWeights=function(t){var e=this;Object(i.tidy)((function(){var n=e.weights;if(n.length!==t.length)throw new p('You called setWeights(weights) on layer "'+e.name+'" with a weight list of length '+t.length+", but the layer was expecting "+n.length+" weights. Provided weights: "+t+"...");if(0!==n.length){for(var r=[],o=ae(n),a=0;a<o.length;++a){var s=o[a],u=n[a],l=t[a];if(!i.util.arraysEqual(s.shape,l.shape))throw new p("Layer weight shape "+s.shape+" not compatible with provided weight shape "+l.shape);r.push([u,l])}se(r)}}))},e.prototype.addWeight=function(t,e,n,r,i,o,a){if(-1!==this._addedWeightNames.indexOf(t))throw new p("Duplicate weight name "+t+" for layer "+this.name);this._addedWeightNames.push(t),null==n&&(n="float32"),this.fastWeightInitDuringBuild&&(r=Xt("zeros"));var s=r.apply(e,n),u=new oe(s,n,t,o,a);return s.dispose(),null!=i&&this.addLoss((function(){return i.apply(u.read())})),null==o&&(o=!0),o?this._trainableWeights.push(u):this._nonTrainableWeights.push(u),u},e.prototype.setFastWeightInitDuringBuild=function(t){this.fastWeightInitDuringBuild=t},e.prototype.addLoss=function(t){var e;null==t||Array.isArray(t)&&0===t.length||(t=x(t),null!=this._losses&&(e=this.losses).push.apply(e,t))},e.prototype.computeOutputShape=function(t){return t},e.prototype.computeMask=function(t,e){var n=this;if(!this.supportsMasking){if(null!=e){if(!Array.isArray(e))throw new TypeError("Layer "+this.name+" does not support masking, but was passed an inputMask.");e.forEach((function(t){if(null!=t)throw new TypeError("Layer "+n.name+" does not support masking, but was passed an inputMask.")}))}return null}return e},e.prototype.addInboundNode=function(t,e,n,r,i,o,a){void 0===a&&(a=null);var s=x(t);e=x(e),n=x(n),r=x(r),i=ee(i),o=ee(o);for(var u=[],l=[],c=[],h=0,d=s;h<d.length;h++){var f=d[h];u.push(f.sourceLayer),l.push(f.nodeIndex),c.push(f.tensorIndex)}new fe({outboundLayer:this,inboundLayers:u,nodeIndices:l,tensorIndices:c,inputTensors:s,outputTensors:e,inputMasks:n,outputMasks:r,inputShapes:i,outputShapes:o},a);for(var p=0;p<e.length;p++)e[p].sourceLayer=this,e[p].nodeIndex=this.inboundNodes.length-1,e[p].tensorIndex=p},e.prototype.getConfig=function(){var t={name:this.name,trainable:this.trainable};return null!=this.batchInputShape&&(t.batchInputShape=this.batchInputShape),null!=this.dtype&&(t.dtype=this.dtype),t},e.prototype.disposeWeights=function(){return this.weights.forEach((function(t){return t.dispose()})),this.weights.length},e.prototype.assertNotDisposed=function(){if(0===this._refCount)throw new Error("Layer '"+this.name+"' is already disposed.")},e.prototype.dispose=function(){if(!this.built)throw new Error("Cannot dispose Layer "+this.name+" because it has not been built yet.");if(null===this._refCount)throw new Error("Cannot dispose Layer "+this.name+" because it has not been used yet.");this.assertNotDisposed();var t=0;return 0==--this._refCount&&(t=this.disposeWeights()),{refCountAfterDispose:this._refCount,numDisposedVariables:t}},e}(i.serialization.Serializable),ge=function(t){function e(e){var n=t.call(this,{dtype:e.dtype,name:null!=e.name?e.name:Jt("input").toString()})||this;if(null==e.batchSize&&(e.batchSize=null),null==e.sparse&&(e.sparse=!1),n.trainable=!1,n.built=!0,n.sparse=e.sparse,null!=e.inputShape&&null!=e.batchInputShape)throw new p("Only provide the inputShape OR batchInputShape argument to inputLayer, not both at the same time.");var r=e.batchInputShape;if(null==r){if(null==e.inputShape)throw new p("An InputLayer should be passed either a `batchInputShape` or an `inputShape`.");r=[e.batchSize].concat(e.inputShape)}else if(null!=e.batchSize)throw new p("Cannot specify batchSize if batchInputShape is specified when creating an InputLayer.");var i=e.dtype||"float32";n.batchInputShape=r,n.dtype=i,n.inputSpec=[{shape:r}];var o=new he(n.dtype,n.batchInputShape,n,[],{},n.name);return o.nodeIndex=0,o.tensorIndex=0,new fe({outboundLayer:n,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:[o],outputTensors:[o],inputMasks:[null],outputMasks:[null],inputShapes:[r],outputShapes:[r]}),n}return a(e,t),e.prototype.apply=function(t,e){throw new p("Cannot pass any input to an InputLayer's apply() method. InputLayer name: "+this.name)},e.prototype.dispose=function(){return{refCountAfterDispose:this._refCount,numDisposedVariables:0}},e.prototype.getConfig=function(){return{batchInputShape:this.batchInputShape,dtype:this.dtype,sparse:this.sparse,name:this.name}},e.className="InputLayer",e}(me);function ye(t){if(null==t.batchShape&&null==t.shape)throw new Error("Please provide to Input either a `shape` or a `batchShape` argument. Note that `shape` does not include the batch dimension.");if(null!=t.batchShape&&null!=t.shape)throw new p("Please provide either a `shape` or `batchShape` argument to Input, but not both.");var e=t.batchShape;null!=t.shape&&null==e&&(e=[null].concat(t.shape));var n=t.dtype;return null==n&&(n="float32"),new ge({batchInputShape:e,name:t.name,dtype:n,sparse:t.sparse}).inboundNodes[0].outputTensors[0]}function ve(t){return l(this,void 0,void 0,(function(){var e,n,r,o,a,s,u,l;return c(this,(function(c){switch(c.label){case 0:if(null==t)return[2];for(o in e=[],n=[],r=[],t)"number"!=typeof(a=t[o])&&(e.push((s=a).data()),n.push(o),r.push(s));return e.length>0?[4,Promise.all(e)]:[3,2];case 1:for(u=c.sent(),l=0;l<u.length;++l)t[n[l]]=u[l][0];Object(i.dispose)(r),c.label=2;case 2:return[2]}}))}))}function be(t){if(null!=t)for(var e in t){var n=t[e];"number"!=typeof n&&n.dispose()}}i.serialization.registerClass(ge),(le=ue||(ue={}))[le.SILENT=0]="SILENT",le[le.VERBOSE=1]="VERBOSE";var we=function(){function t(){this.validationData=null}return t.prototype.setParams=function(t){this.params=t},t.prototype.onEpochBegin=function(t,e){return l(this,void 0,void 0,(function(){return c(this,(function(t){return[2]}))}))},t.prototype.onEpochEnd=function(t,e){return l(this,void 0,void 0,(function(){return c(this,(function(t){return[2]}))}))},t.prototype.onBatchBegin=function(t,e){return l(this,void 0,void 0,(function(){return c(this,(function(t){return[2]}))}))},t.prototype.onBatchEnd=function(t,e){return l(this,void 0,void 0,(function(){return c(this,(function(t){return[2]}))}))},t.prototype.onTrainBegin=function(t){return l(this,void 0,void 0,(function(){return c(this,(function(t){return[2]}))}))},t.prototype.onTrainEnd=function(t){return l(this,void 0,void 0,(function(){return c(this,(function(t){return[2]}))}))},t.prototype.setModel=function(t){},t}(),xe=function(){function t(t,e){void 0===e&&(e=10),null==t&&(t=[]),this.callbacks=t,this.queueLength=e}return t.prototype.append=function(t){this.callbacks.push(t)},t.prototype.setParams=function(t){for(var e=0,n=this.callbacks;e<n.length;e++)n[e].setParams(t)},t.prototype.setModel=function(t){for(var e=0,n=this.callbacks;e<n.length;e++)n[e].setModel(t)},t.prototype.onEpochBegin=function(t,e){return l(this,void 0,void 0,(function(){var n,r;return c(this,(function(i){switch(i.label){case 0:null==e&&(e={}),n=0,r=this.callbacks,i.label=1;case 1:return n<r.length?[4,r[n].onEpochBegin(t,e)]:[3,4];case 2:i.sent(),i.label=3;case 3:return n++,[3,1];case 4:return[2]}}))}))},t.prototype.onEpochEnd=function(t,e){return l(this,void 0,void 0,(function(){var n,r;return c(this,(function(i){switch(i.label){case 0:null==e&&(e={}),n=0,r=this.callbacks,i.label=1;case 1:return n<r.length?[4,r[n].onEpochEnd(t,e)]:[3,4];case 2:i.sent(),i.label=3;case 3:return n++,[3,1];case 4:return[2]}}))}))},t.prototype.onBatchBegin=function(t,e){return l(this,void 0,void 0,(function(){var n,r;return c(this,(function(i){switch(i.label){case 0:null==e&&(e={}),n=0,r=this.callbacks,i.label=1;case 1:return n<r.length?[4,r[n].onBatchBegin(t,e)]:[3,4];case 2:i.sent(),i.label=3;case 3:return n++,[3,1];case 4:return[2]}}))}))},t.prototype.onBatchEnd=function(t,e){return l(this,void 0,void 0,(function(){var n,r;return c(this,(function(i){switch(i.label){case 0:null==e&&(e={}),n=0,r=this.callbacks,i.label=1;case 1:return n<r.length?[4,r[n].onBatchEnd(t,e)]:[3,4];case 2:i.sent(),i.label=3;case 3:return n++,[3,1];case 4:return[2]}}))}))},t.prototype.onTrainBegin=function(t){return l(this,void 0,void 0,(function(){var e,n;return c(this,(function(r){switch(r.label){case 0:null==t&&(t={}),e=0,n=this.callbacks,r.label=1;case 1:return e<n.length?[4,n[e].onTrainBegin(t)]:[3,4];case 2:r.sent(),r.label=3;case 3:return e++,[3,1];case 4:return[2]}}))}))},t.prototype.onTrainEnd=function(t){return l(this,void 0,void 0,(function(){var e,n;return c(this,(function(r){switch(r.label){case 0:null==t&&(t={}),e=0,n=this.callbacks,r.label=1;case 1:return e<n.length?[4,n[e].onTrainEnd(t)]:[3,4];case 2:r.sent(),r.label=3;case 3:return e++,[3,1];case 4:return[2]}}))}))},t}(),_e=function(t){function e(){return t.call(this)||this}return a(e,t),e.prototype.onEpochBegin=function(t){return l(this,void 0,void 0,(function(){return c(this,(function(t){return this.seen=0,this.totals={},[2]}))}))},e.prototype.onBatchEnd=function(t,e){return l(this,void 0,void 0,(function(){var t,n,r,o,a=this;return c(this,(function(s){for(o in null==e&&(e={}),this.seen+=t=null==e.size?0:e.size,n=function(n){var o=e[n];if("number"==typeof o)r.totals.hasOwnProperty(n)||(r.totals[n]=0),r.totals[n]=r.totals[n]+o*t;else{var s=void 0;n in r.totals?s=r.totals[n]:r.totals[n]=0;var u=Object(i.tidy)((function(){return Object(i.add)(a.totals[n],Object(i.mul)(o,t))}));r.totals[n]=u,null!=s&&s.dispose()}},r=this,e)n(o);return[2]}))}))},e.prototype.onEpochEnd=function(t,e){return l(this,void 0,void 0,(function(){var t,n,r,o,a=this;return c(this,(function(s){if(null!=e)for(t=function(t){if(null==n.totals[t])return"continue";"number"==typeof n.totals[t]?e[t]=n.totals[t]/n.seen:Object(i.tidy)((function(){var n=Object(i.mul)(Object(i.div)(1,a.seen),a.totals[t]);e[t]=n,a.totals[t].dispose(),Object(i.keep)(e[t])}))},n=this,r=0,o=this.params.metrics;r<o.length;r++)t(o[r]);return[2]}))}))},e}(we),Ce=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return a(e,t),e.prototype.onTrainBegin=function(t){return l(this,void 0,void 0,(function(){return c(this,(function(t){return this.epoch=[],this.history={},[2]}))}))},e.prototype.onEpochEnd=function(t,e){return l(this,void 0,void 0,(function(){var n;return c(this,(function(r){for(n in null==e&&(e={}),this.epoch.push(t),e)null==this.history[n]&&(this.history[n]=[]),this.history[n].push(e[n]);return[2]}))}))},e.prototype.syncData=function(){return l(this,void 0,void 0,(function(){var t,e,n,r,i,o,a,s;return c(this,(function(u){switch(u.label){case 0:for(r in t=[],e=[],n=[],this.history)for(i=this.history[r],o=0;o<i.length;++o)"number"!=typeof i[o]&&(t.push(i[o].data()),e.push(r),n.push(o));return[4,Promise.all(t)];case 1:for(a=u.sent(),s=0;s<a.length;++s)this.history[e[s]][n[s]].dispose(),this.history[e[s]][n[s]]=a[s][0];return[2]}}))}))},e}(we),ke=function(t){function e(e,n){var r=t.call(this)||this;if(r.currentEpoch=0,r.yieldEvery=n||"auto","auto"===r.yieldEvery&&(r.yieldEvery=125),"never"===r.yieldEvery&&null!=e.onYield)throw new Error("yieldEvery is `never` but you provided an `onYield` callback. Either change `yieldEvery` or remove the callback");return i.util.isNumber(r.yieldEvery)&&(r.maybeWait=function(t,e){var n,r=i.util.now();return function(){for(var o=[],a=0;a<arguments.length;a++)o[a]=arguments[a];var s=i.util.now();return s-r<e?n:(r=s,n=t.apply(void 0,o))}}(r.maybeWait.bind(r),r.yieldEvery)),r.trainBegin=e.onTrainBegin,r.trainEnd=e.onTrainEnd,r.epochBegin=e.onEpochBegin,r.epochEnd=e.onEpochEnd,r.batchBegin=e.onBatchBegin,r.batchEnd=e.onBatchEnd,r.yield=e.onYield,r}return a(e,t),e.prototype.maybeWait=function(t,e,n){return l(this,void 0,void 0,(function(){var r;return c(this,(function(o){switch(o.label){case 0:return r=[],null==this.yield?[3,2]:[4,ve(n)];case 1:o.sent(),r.push(this.yield(t,e,n)),o.label=2;case 2:return r.push(Object(i.nextFrame)()),[4,Promise.all(r)];case 3:return o.sent(),[2]}}))}))},e.prototype.onEpochBegin=function(t,e){return l(this,void 0,void 0,(function(){return c(this,(function(n){switch(n.label){case 0:return this.currentEpoch=t,null==this.epochBegin?[3,3]:[4,ve(e)];case 1:return n.sent(),[4,this.epochBegin(t,e)];case 2:n.sent(),n.label=3;case 3:return[2]}}))}))},e.prototype.onEpochEnd=function(t,e){return l(this,void 0,void 0,(function(){var n;return c(this,(function(r){switch(r.label){case 0:return n=[],null==this.epochEnd?[3,2]:[4,ve(e)];case 1:r.sent(),n.push(this.epochEnd(t,e)),r.label=2;case 2:return"epoch"===this.yieldEvery&&n.push(Object(i.nextFrame)()),[4,Promise.all(n)];case 3:return r.sent(),[2]}}))}))},e.prototype.onBatchBegin=function(t,e){return l(this,void 0,void 0,(function(){return c(this,(function(n){switch(n.label){case 0:return null==this.batchBegin?[3,3]:[4,ve(e)];case 1:return n.sent(),[4,this.batchBegin(t,e)];case 2:n.sent(),n.label=3;case 3:return[2]}}))}))},e.prototype.onBatchEnd=function(t,e){return l(this,void 0,void 0,(function(){var n;return c(this,(function(r){switch(r.label){case 0:return n=[],null==this.batchEnd?[3,2]:[4,ve(e)];case 1:r.sent(),n.push(this.batchEnd(t,e)),r.label=2;case 2:return"batch"===this.yieldEvery?n.push(Object(i.nextFrame)()):i.util.isNumber(this.yieldEvery)&&n.push(this.maybeWait(this.currentEpoch,t,e)),[4,Promise.all(n)];case 3:return r.sent(),[2]}}))}))},e.prototype.onTrainBegin=function(t){return l(this,void 0,void 0,(function(){return c(this,(function(e){switch(e.label){case 0:return null==this.trainBegin?[3,3]:[4,ve(t)];case 1:return e.sent(),[4,this.trainBegin(t)];case 2:e.sent(),e.label=3;case 3:return[2]}}))}))},e.prototype.onTrainEnd=function(t){return l(this,void 0,void 0,(function(){return c(this,(function(e){switch(e.label){case 0:return null==this.trainEnd?[3,3]:[4,ve(t)];case 1:return e.sent(),[4,this.trainEnd(t)];case 2:e.sent(),e.label=3;case 3:return[2]}}))}))},e}(we);function Se(t,e){return null==t&&(t={}),t instanceof we?[t]:Array.isArray(t)&&t[0]instanceof we?t:x(t).map((function(t){return new ke(t,e)}))}var Ee=function(){function t(){}return t.registerCallbackConstructor=function(e,n){i.util.assert(e>=0&&Number.isInteger(e),(function(){return"Verbosity level is expected to be an integer >= 0, but got "+e})),t.checkForDuplicate(n),null==t.constructors[e]&&(t.constructors[e]=[]),t.constructors[e].push(n)},t.checkForDuplicate=function(e){for(var n in t.constructors)t.constructors[+n].forEach((function(t){if(t===e)throw new p("Duplicate callback constructor.")}))},t.clear=function(){t.constructors={}},t.createCallbacks=function(e){var n=[];for(var r in t.constructors){var i=+r;e>=i&&n.push.apply(n,t.constructors[i])}return n.map((function(t){return new t}))},t.constructors={},t}();function Oe(t,e,n,r,i,o,a,s,u){var l=new Ce,c=[new _e].concat(Ee.createCallbacks(e));null!=t&&c.push.apply(c,t),c.push(l);var h=new xe(c);return h.setParams({epochs:n,initialEpoch:r,samples:i,steps:o,batchSize:a,verbose:e,doValidation:s,metrics:u}),{callbackList:h,history:l}}function Ae(t,e,n){return void 0===e&&(e={}),void 0===n&&(n=!1),E(t,i.serialization.SerializationMap.getMap().classNameMap,e,"layer",n)}function Ne(t,e){return Object(i.tidy)((function(){"float32"!==t.dtype&&(t=t.asType("float32"));var n=Object(i.sum)(_t(t),e,!0),r=Object(i.fill)(n.shape,h()),o=Object(i.sqrt)(Object(i.maximum)(n,r));return Object(i.div)(t,o)}))}function Te(t,e){return Object(i.tidy)((function(){return Object(i.mean)(_t(Object(i.sub)(e,t)),-1)}))}function De(t,e){return Object(i.tidy)((function(){return Object(i.mean)(Object(i.abs)(Object(i.sub)(e,t)),-1)}))}function Re(t,e){return Object(i.tidy)((function(){var n=Object(i.sub)(t,e),r=Object(i.clipByValue)(Object(i.abs)(t),h(),Number.MAX_VALUE),o=Object(i.abs)(Object(i.div)(n,r));return Object(i.mul)(100,Object(i.mean)(o,-1))}))}function Ie(t,e,n){return void 0===n&&(n=!1),Object(i.tidy)((function(){if(n)e=Object(i.softmax)(e);else{var r=Object(i.sum)(e,e.shape.length-1,!0);e=Object(i.div)(e,r)}return e=Object(i.clipByValue)(e,h(),1-h()),Object(i.neg)(Object(i.sum)(Object(i.mul)(t.toFloat(),Object(i.log)(e)),e.shape.length-1))}))}function Me(t,e){return Object(i.tidy)((function(){var n=Object(i.floor)(function(t){var e=[at(t.shape)];return t.reshape(e)}(t)).toInt(),r=(e=Object(i.clipByValue)(e,h(),1-h())).shape;return Ie(Object(i.oneHot)(n,r[r.length-1]).reshape(r),e,!1)}))}function Fe(t,e){return Object(i.tidy)((function(){var n;return n=Object(i.clipByValue)(e,h(),1-h()),n=Object(i.log)(Object(i.div)(n,Object(i.sub)(1,n))),Object(i.mean)(function(t,e){if(!i.util.arraysEqual(t.shape,e.shape))throw new p("logits and labels must have the same shape, but got shapes "+JSON.stringify(t.shape)+" and "+JSON.stringify(e.shape));return Object(i.tidy)((function(){var n=e.relu(),r=e.abs().neg();return n.sub(e.mul(t)).add(r.exp().log1p())}))}(t,n),-1)}))}function Pe(t,e){return Object(i.tidy)((function(){var n=Ne(t,-1),r=Ne(e,-1),o=Object(i.mul)(n,r);return Object(i.neg)(Object(i.sum)(o,-1))}))}var je={meanSquaredError:Te,meanAbsoluteError:De,meanAbsolutePercentageError:Re,meanSquaredLogarithmicError:function(t,e){return Object(i.tidy)((function(){var n=Object(i.clipByValue)(e,h(),Number.MAX_VALUE),r=Object(i.log)(Object(i.add)(1,n)),o=Object(i.clipByValue)(t,h(),Number.MAX_VALUE),a=Object(i.log)(Object(i.add)(1,o));return Object(i.mean)(_t(Object(i.sub)(r,a)),-1)}))},squaredHinge:function(t,e){return Object(i.tidy)((function(){var n=Object(i.maximum)(0,Object(i.sub)(1,Object(i.mul)(t,e)));return Object(i.mean)(_t(n),-1)}))},hinge:function(t,e){return Object(i.tidy)((function(){var n=Object(i.maximum)(0,Object(i.sub)(1,Object(i.mul)(t,e)));return Object(i.mean)(n,-1)}))},categoricalHinge:function(t,e){return Object(i.tidy)((function(){var n=Object(i.sum)(Object(i.mul)(t,e),-1),r=Object(i.max)(Object(i.mul)(Object(i.sub)(1,t),e),-1);return Object(i.maximum)(0,Object(i.add)(1,Object(i.sub)(r,n)))}))},logcosh:function(t,e){return Object(i.tidy)((function(){var n=Math.log(2),r=Object(i.sub)(e,t),o=Object(i.sub)(Object(i.add)(r,Object(i.softplus)(Object(i.mul)(-2,r))),n);return Object(i.mean)(o,-1)}))},categoricalCrossentropy:Ie,sparseCategoricalCrossentropy:Me,binaryCrossentropy:Fe,kullbackLeiblerDivergence:function(t,e){return Object(i.tidy)((function(){var n=Object(i.clipByValue)(t,h(),1),r=Object(i.clipByValue)(e,h(),1);return Object(i.sum)(Object(i.mul)(t,Object(i.log)(Object(i.div)(n,r))),-1)}))},poisson:function(t,e){return Object(i.tidy)((function(){var n=Object(i.log)(Object(i.add)(h(),e));return Object(i.mean)(Object(i.sub)(e,Object(i.mul)(t,n)),-1)}))},cosineProximity:Pe};function ze(t){if("string"==typeof t){if(t in je)return je[t];var e="Unknown loss "+t;throw t.toLowerCase().includes("softmaxcrossentropy")&&(e="Unknown loss "+t+'. Use "categoricalCrossentropy" as the string name for tf.losses.softmaxCrossEntropy'),new p(e)}return t}function Le(t,e){return Object(i.tidy)((function(){var n=Object(i.mul)(.5,Object(i.onesLike)(e)),r=ht(Object(i.greater)(e,n),t.dtype);return Object(i.mean)(Object(i.equal)(t,r),-1)}))}function Be(t,e){return Object(i.tidy)((function(){return ht(Object(i.equal)(Object(i.argMax)(t,-1),Object(i.argMax)(e,-1)),"float32")}))}function Ue(t,e){return Object(i.tidy)((function(){return Object(i.logicalAnd)(t.equal(1),e.equal(1)).sum().cast("float32")}))}function $e(t,e){return Object(i.tidy)((function(){var n=Ue(t,e),r=function(t,e){return Object(i.tidy)((function(){return Object(i.logicalAnd)(t.equal(0),e.equal(1)).sum().cast("float32")}))}(t,e),o=n.add(r);return Object(i.where)(Object(i.greater)(o,0),n.div(o),0).cast("float32")}))}function Ve(t,e){return Fe(t,e)}function We(t,e){return t.rank===e.rank&&(t=t.squeeze([t.rank-1])),(e=e.argMax(-1)).dtype!==t.dtype&&(e=e.asType(t.dtype)),Object(i.equal)(t,e).asType("float32")}var qe=Ie,He=Me,Ge={binaryAccuracy:Le,categoricalAccuracy:Be,precision:$e,categoricalCrossentropy:qe,sparseCategoricalCrossentropy:He,mse:Te,MSE:Te,mae:De,MAE:De,mape:Re,MAPE:Re,cosine:Pe};function Xe(t){if(v(null!==t,"Unknown LossOrMetricFn "+t),"string"==typeof t)return t;for(var e=void 0,n=0,r=Object.keys(je);n<r.length;n++){var i=r[n];if(je[i]===t){e=i;break}}if(void 0!==e)return e;for(var o=0,a=Object.keys(Ge);o<a.length;o++)if(Ge[i=a[o]]===t){e=i;break}return void 0!==e?e:t.name}function Ke(t,e,n){if(void 0===n&&(n=!1),null==t||"object"!=typeof t||Object.getPrototypeOf(t)!==Object.prototype||!function t(e){if(null===e)return!0;if("object"==typeof e){if(Object.getPrototypeOf(e)===Object.prototype){for(var n=0,r=Object.keys(e);n<r.length;n++){var i=r[n];if("string"!=typeof i)return!1;if(!t(e[i]))return!1}return!0}if(Array.isArray(e)){for(var o=0,a=e;o<a.length;o++)if(!t(a[o]))return!1;return!0}return!1}var s=typeof e;return"string"===s||"number"===s||"boolean"===s}(t))throw new Error("User-defined metadata is expected to be a JSON object, but is not.");if(n){var r=JSON.stringify(t);r.length>1048576&&console.warn('User-defined metadata of model "'+e+'" is too large in size (length='+r.length+" when serialized). It is not recommended to store such large objects in user-defined metadata. Please make sure its serialized length is <= 1048576.")}}function Ye(t,e,n){void 0===n&&(n=console.log);for(var r="",i=0;i<t.length;++i)i>0&&(r=r.slice(0,r.length-1)+" "),r=(r+=t[i]).slice(0,e[i]),r+=" ".repeat(e[i]-r.length);n(r)}function Ze(t,e,n){var r;try{r=JSON.stringify(t.outputShape)}catch(t){r="multiple"}Ye([t.name+" ("+t.getClassName()+")",r,t.countParams().toString()],e,n)}function Qe(t,e,n,r){var i;try{i=JSON.stringify(t.outputShape)}catch(t){i="multiple"}for(var o=[],a=0,s=t.inboundNodes;a<s.length;a++){var u=s[a];if(!(null!=n&&n.length>0&&-1===n.indexOf(u)))for(var l=0;l<u.inboundLayers.length;++l)o.push(u.inboundLayers[l].name+"["+u.nodeIndices[l]+"]["+u.tensorIndices[l]+"]")}var c=t.name,h=t.getClassName(),d=0===o.length?"":o[0];for(Ye([c+" ("+h+")",i,t.countParams().toString(),d],e,r),l=1;l<o.length;++l)Ye(["","","",o[l]],e,r)}function Je(t,e,n){return("inboundNodes"===t||"outputLayers"===t||"inputLayers"===t)&&0===e&&"string"==typeof n}function tn(t,e){if(null===t)return null;if("string"==typeof t)return C(t);if("number"==typeof t||"boolean"==typeof t)return t;if(t instanceof Array){for(var n=[],r=t.length,i=0;i<r;++i){var o=t[i];Je(e,i,o)?n.push(o):n.push(tn(o,e))}return n}for(var a={},s=0,u=Object.keys(t);s<u.length;s++){var l=u[s],c=t[l];if("name"===l&&"string"==typeof c)a[l]=c;else{var h=C(l);a[h]=tn(c,h)}}return a}var en="1.2.11",nn=function(){function t(e){if(this.id2Value={},this.id2Mask={},this.name2Id={},e instanceof t)for(var n in e.id2Value)this.id2Value[n]=e.id2Value[n],n in e.id2Mask&&(this.id2Mask[n]=e.id2Mask[n]);else{if(null==e)return;for(var r=0,i=e;r<i.length;r++){var o=i[r];this.add(o.key,o.value)}}}return t.prototype.add=function(t,e,n){if(null!=this.id2Value[t.id])throw new p("Duplicate key: name="+t.name+", id="+t.id);return this.id2Value[t.id]=function(t,e){if(null==t.dtype||t.dtype===e.dtype)return e;try{return Object(i.cast)(e,t.dtype)}catch(n){throw new p("The dtype of the feed ("+e.dtype+") can not be cast to the dtype of the key '"+t.name+"' ("+t.dtype+").")}}(t,e),this.name2Id[t.name]=t.id,null!=n&&(this.id2Mask[t.id]=n),this},t.prototype.addFeed=function(t){this.add(t.key,t.value)},t.prototype.hasKey=function(t){return null!=this.id2Value[t.id]},t.prototype.names=function(){return Object.keys(this.name2Id)},t.prototype.getValue=function(t){if(t instanceof he){if(null==this.id2Value[t.id])throw new p("Nonexistent key: "+t.name);return this.id2Value[t.id]}var e=this.name2Id[t];if(null==e)throw new p("Feed dict has no SymbolicTensor name: "+t);return this.id2Value[e]},t.prototype.getMask=function(t){if(t instanceof he){if(null==this.id2Value[t.id])throw new p("Nonexistent key: "+t.name);return this.id2Mask[t.id]}var e=this.name2Id[t];if(null==e)throw new p("Feed dict has no SymbolicTensor name: "+t);return this.id2Mask[e]},t.prototype.disposeMasks=function(){null!=this.id2Mask&&Object(i.dispose)(this.id2Mask)},t}(),rn={},on={};function an(t,e,n,r){for(var o=null!=n&&n.training,a=Array.isArray(t),s=a?t:[t],u=s.map((function(t){return t.name})),l=[],c=e.names(),h=0,d=u;h<d.length;h++){var f=d[h];-1!==c.indexOf(f)?l.push(e.getValue(f)):l.push(null)}null!=r&&(r.maxNumTensors=-1/0,r.minNumTensors=1/0);var p,m,g=u.join(",")+"|"+e.names().join(",");if(null==rn[g]){var y=function(t,e){i.util.assert(null!=t&&t.length>0,(function(){return"Expected at least one fetch, got none"}));var n=[],r={};if(1===t.length){var o=un(t[0],e);n=o.sorted,r=o.recipientMap}else for(var a=new Set,s=0,u=t;s<u.length;s++){for(var l=un(u[s],e),c=l.recipientMap,h=0,d=l.sorted;h<d.length;h++){var f=d[h];a.has(f.name)||(n.push(f),a.add(f.name))}var p=function(t){null==r[t]&&(r[t]=new Set),c[t].forEach((function(e){return r[t].add(e)}))};for(var m in c)p(m)}return{sorted:n,recipientCounts:sn(r)}}(s,e);m=y.recipientCounts,rn[g]=p=y.sorted,on[g]=m}p=rn[g],m={},o||Object.assign(m,on[g]);for(var v=new nn(e),b=0;b<p.length;++b){if(null!=r){var w=Object(i.memory)().numTensors;w>r.maxNumTensors&&(r.maxNumTensors=w),w<r.minNumTensors&&(r.minNumTensors=w)}var _=p[b],C=_.sourceLayer;if(!(C instanceof ge)){for(var k=[],S=[],E=[],O=!1,A=0,N=_.inputs;A<N.length;A++){var T=N[A],D=v.getValue(T),R=v.getMask(T);k.push(D),S.push(R),null!=R&&(O=!0),o||(m[T.name]--,0!==m[T.name]||e.hasKey(T)||-1!==u.indexOf(T.name)||D.isDisposed||!0===T.sourceLayer.stateful||E.push(D))}O&&((n=n||{}).mask=S[0]);var I=x(C.apply(k,n)),M=null;C.supportsMasking&&(M=C.computeMask(k,S));for(var F=ln(_),P=Array.isArray(F)?F:[F],j=0;j<P.length;++j){v.hasKey(P[j])||v.add(P[j],I[j],Array.isArray(M)?M[0]:M);var z=u.indexOf(P[j].name);-1!==z&&(l[z]=I[j])}o||Object(i.dispose)(E)}}return v.disposeMasks(),a?l:l[0]}function sn(t){var e={};for(var n in t)e[n]=t[n].size;return e}function un(t,e){for(var n=new Set,r=[],i={},o=0,a=e.names();o<a.length;o++)n.add(a[o]);var s=[],u=[];for(s.push(t);s.length>0;){var l=s[s.length-1];if(n.has(l.name))s.pop();else{var c=u[u.length-1]===s.length-1;if(0===l.inputs.length||c)s.pop(),r.push(l),n.add(l.name),c&&u.pop();else{u.push(s.length-1);for(var h=0,d=l.inputs;h<d.length;h++){var f=d[h];null==i[f.name]&&(i[f.name]=new Set),i[f.name].add(l.name),n.has(f.name)||s.push(f)}}}}return{sorted:r,recipientMap:i}}function ln(t){var e;if(1===t.sourceLayer.inboundNodes.length)e=t.sourceLayer.output;else{for(var n=null,r=0;r<t.sourceLayer.inboundNodes.length;++r)for(var i=0,o=t.sourceLayer.inboundNodes[r].outputTensors;i<o.length;i++)if(o[i].id===t.id){n=r;break}e=t.sourceLayer.getOutputAt(n)}return e}function cn(t,e){return function(t,e,n){var r=e.length;if(null==t||Array.isArray(t)&&0===t.length)return e.map((function(t){return null}));if(1===r)return Array.isArray(t)&&1===t.length?t:"object"==typeof t&&e[0]in t?[t[e[0]]]:[t];if(Array.isArray(t)){if(t.length!==r)throw new Error("Provided "+n+" is an array of "+t.length+" element(s), but the model has "+r+" outputs. Make sure a set of weights is provided for each model output.");return t}if("object"==typeof t&&Object.keys(t).length>0&&"object"==typeof t[Object.keys(t)[0]]){var i=[];return e.forEach((function(e){i.push(e in t?t[e]:null)})),i}throw new Error("The model has multiple ("+r+") outputs, so "+n+" must be either an array with "+r+" elements or an object with "+e+" keys. Provided "+n+" not understood: "+JSON.stringify(t))}(t,e,"classWeight")}function hn(t,e,n,r){return l(this,void 0,void 0,(function(){var o,a,s,u,l;return c(this,(function(c){switch(c.label){case 0:if(null!=e||null!=r)throw new Error("Support sampleWeight is not implemented yet");return null==n?[3,2]:(o=Object(i.tidy)((function(){if(1===t.shape.length)return t.clone();if(2===t.shape.length){if(t.shape[1]>1)return t.argMax(1);if(1===t.shape[1])return t.reshape([t.shape[0]]);throw new Error("Encountered unexpected last-dimension size ("+t.shape[1]+") during handling of class weights. The size is expected to be >= 1.")}throw new Error("Unexpected rank of target (y) tensor ("+t.rank+") during handling of class weights. The rank is expected to be 1 or 2.")})),u=(s=Array).from,[4,o.data()]);case 1:return a=u.apply(s,[c.sent()]),Object(i.dispose)(o),l=[],a.forEach((function(t){if(null==n[t])throw new Error("classWeight must contain all classes in the training data. The class "+t+" exists in the data but not in classWeight");l.push(n[t])})),[2,Object(i.tensor1d)(l,"float32")];case 2:return[2,null]}}))}))}function dn(t,e){return Object(i.mul)(t,e)}function fn(t,e){var n,r;r=e.ys,i.util.assert(null!=(n=e.xs)&&null!=r,(function(){return"A Dataset iterator for fitDataset() is expected to generate objects of the form `{xs: xVal, ys: yVal}`, where the two values may be `tf.Tensor`, an array of Tensors, or a map of string to Tensor.  The provided Dataset instead generates "+e}));var o=pn("input",t.inputNames,n),a=pn("output",t.outputNames,r),s=o[0].shape[0];i.util.assert(o.length===t.inputs.length,(function(){return"LayersModel has "+t.inputs.length+" inputs, but the dataset provides "+o.length+" inputs.  (Expected input keys: "+JSON.stringify(t.inputNames)+")"})),i.util.assert(a.length===t.outputs.length,(function(){return"LayersModel has "+t.outputs.length+" outputs, but the dataset provides "+a.length+" outputs.  (Expected output keys: "+JSON.stringify(t.outputNames)+")"}));var u=function(e){i.util.assert(o[e].shape[0]===s,(function(){return"Batch size mismatch: input "+t.inputNames[e]+" has "+o[e].shape[0]+"; expected  "+s+" based on input "+t.inputNames[0]+"."}))};for(var l in o)u(l);var c=function(e){i.util.assert(a[e].shape[0]===s,(function(){return"Batch size mismatch: output "+t.outputNames[e]+" has "+a[e].shape[0]+"; expected  "+s+" based on input "+t.inputNames[0]+"."}))};for(var h in a)c(h);return{xs:o,ys:a}}function pn(t,e,n){if(n instanceof i.Tensor)return[n];if(Array.isArray(n))return i.util.assert(n.length===e.length,(function(){return"Received an array of "+n.length+" Tensors, but expected "+e.length+" to match the "+t+" keys "+e+"."})),n;for(var r=[],o=0,a=e;o<a.length;o++){var s=a[o];if(null==n[s])throw new p("The feature data generated by the dataset lacks the required "+t+" key '"+s+"'.");r.push(n[s])}return r}function mn(t,e,n){return l(this,void 0,void 0,(function(){var r,o,a,s,u,l,h,d,f,p,g,y,v,b,w,_,C,k,S,E,O,A,N,T,D,R,I,M,F,P,j,z;return c(this,(function(c){switch(c.label){case 0:if(r=null!=n.batchesPerEpoch,i.util.assert(null!=t.optimizer,(function(){return"You must compile a model before training/testing. Use LayersModel.compile(modelCompileConfig)."})),i.util.assert(null!=n,(function(){return"For fitDataset(), the 2nd argument (config) is required, but it is not provided in this call."})),i.util.assert(null!=n.epochs&&n.epochs>0&&Number.isInteger(n.epochs),(function(){return"For fitDataset(), config.epochs is expected to be a positive integer, but got "+n.epochs})),i.util.assert(!r||n.batchesPerEpoch>0&&Number.isInteger(n.batchesPerEpoch),(function(){return"For fitDataset(), config.batchesPerEpoch is expected to be a positive integer if specified, but got "+n.batchesPerEpoch})),i.util.assert(null==n.validationSplit,(function(){return"`validationSplit` is not supported by `fitDataset()`. Use validationData instead."})),t.isTraining)throw new Error("Cannot start training because another fit() call is ongoing.");t.isTraining=!0,c.label=1;case 1:return c.trys.push([1,,26,27]),a=void 0,s=void 0,(o=null!=n.validationData)&&(gn(n.validationData)?i.util.assert(null==n.validationBatches||n.validationBatches>0&&Number.isInteger(n.validationBatches),(function(){return"For fitDataset() with dataset-based validation, config.validationBatches is expected not to be provided, or to be a positive integer, but got "+n.validationBatches})):(u=function(t){if(3===t.length)throw new m("Validation with sample weights is not implemented yet.");return{xs:t[0],ys:t[1]}}(n.validationData),a=u.xs,s=u.ys)),l=t.makeTrainFunction(),h=t.getDedupedMetricsNames(),d=o?h.slice().concat(h.map((function(t){return"val_"+t}))):h.slice(),f=Se(n.callbacks,n.yieldEvery),p=Oe(f,null==n.verbose?1:n.verbose,n.epochs,null,null,function(t,e){var n=null;return null!=e.batchesPerEpoch?n=e.batchesPerEpoch:Number.isFinite(t.size)&&(n=t.size),n}(e,n),null,o,d),y=p.history,(g=p.callbackList).setModel(t),t.history=y,[4,g.onTrainBegin()];case 2:return c.sent(),t.stopTraining_=!1,v=null==n.initialEpoch?0:n.initialEpoch,[4,e.iterator()];case 3:b=c.sent(),c.label=4;case 4:return v<n.epochs?(w={},[4,g.onEpochBegin(v)]):[3,23];case 5:return c.sent(),_=0,C=0,r?[3,7]:[4,e.iterator()];case 6:b=c.sent(),c.label=7;case 7:return!r||_<n.batchesPerEpoch?[4,b.next()]:[3,21];case 8:return k=c.sent(),r&&k.done?(console.warn("You provided `batchesPerEpoch` as "+n.batchesPerEpoch+", but your dataset iterator ran out of data after "+_+" batches; interrupting training. Make sure that your dataset can generate at least `batchesPerEpoch * epochs` batches (in this case, "+n.batchesPerEpoch*n.epochs+" batches). You may need to use the repeat() function when building your dataset."),[3,21]):null==k.value?[3,15]:(S=fn(t,k.value),E=S.xs,O=S.ys,(A={}).batch=C,A.size=E[0].shape[0],[4,g.onBatchBegin(C,A)]);case 9:if(c.sent(),N=[],null==n.classWeight)return[3,13];T=cn(n.classWeight,t.outputNames),z=0,c.label=10;case 10:return z<T.length?(R=(D=N).push,[4,hn(O[z],null,T[z])]):[3,13];case 11:R.apply(D,[c.sent()]),c.label=12;case 12:return++z,[3,10];case 13:for(I=E.concat(O).concat(N),M=l(I),Object(i.dispose)(I),z=0;z<h.length;++z)A[h[z]]=F=M[z],Object(i.keep)(F);return[4,g.onBatchEnd(C,A)];case 14:c.sent(),be(A),C++,_++,c.label=15;case 15:return(r?_>=n.batchesPerEpoch:k.done)?o?(P=void 0,gn(n.validationData)?(j=x,[4,t.evaluateDataset(n.validationData,{batches:n.validationBatches})]):[3,17]):[3,19]:[3,20];case 16:return P=j.apply(void 0,[c.sent()]),[3,18];case 17:P=x(t.evaluate(a,s,{batchSize:null==n.validationBatchSize?32:n.validationBatchSize,verbose:0})),c.label=18;case 18:for(z=0;z<t.metricsNames.length;++z)w["val_"+t.metricsNames[z]]=P[z];c.label=19;case 19:return[3,21];case 20:return t.stopTraining_?[3,21]:[3,7];case 21:return[4,g.onEpochEnd(v,w)];case 22:return c.sent(),v++,t.stopTraining_?[3,23]:[3,4];case 23:return[4,g.onTrainEnd()];case 24:return c.sent(),[4,t.history.syncData()];case 25:return c.sent(),[2,t.history];case 26:return t.isTraining=!1,[7];case 27:return[2]}}))}))}function gn(t){return"function"==typeof t.iterator}function yn(t,e,n){return l(this,void 0,void 0,(function(){var r,o,a,s,u,l,h,d,f,p;return c(this,(function(g){switch(g.label){case 0:if(r=null!=(n=n||{}).batches,o=t.testFunction,a=[],n.verbose>0)throw new m("Verbose mode is not implemented yet.");return i.util.assert(!r||n.batches>0&&Number.isInteger(n.batches),(function(){return"Test loop expects `batches` to be a positive integer, but received "+JSON.stringify(n.batches)})),function(t){return"function"==typeof t.next}(e)?(u=e,[3,3]):[3,1];case 1:return[4,e.iterator()];case 2:u=g.sent(),g.label=3;case 3:s=u,l=0,h=0,d=function(){var e;return c(this,(function(u){switch(u.label){case 0:return[4,s.next()];case 1:return e=u.sent(),a=Object(i.tidy)((function(){if(e.value){var n=fn(t,e.value),r=n.xs.concat(n.ys),s=Object(i.tidy)((function(){return o(r)}));if(Object(i.dispose)(r),0===h)for(var u=0;u<s.length;++u)a.push(Object(i.scalar)(0));var c=r[0].shape[0],d=function(t){var e=s[t],n=a[t];a[t]=Object(i.tidy)((function(){return Object(i.add)(a[t],Object(i.mul)(c,e))})),h>0&&Object(i.dispose)(n)};for(u=0;u<s.length;++u)d(u);Object(i.dispose)(s),l+=c,++h}return a})),e.done?(r&&console.warn("Your dataset iterator ran out of data during evaluateDataset(). Interrupting evalution. Make sure that your dataset can generate at least `batches` batches (in this case, "+n.batches+" batches). You may need to use the repeat() function when building your dataset."),[2,"break"]):[2]}}))},g.label=4;case 4:return!r||h<n.batches?[5,d()]:[3,6];case 5:return"break"===g.sent()?[3,6]:[3,4];case 6:for(f=0;f<a.length;++f)p=a[f],a[f]=Object(i.div)(a[f],l),Object(i.dispose)(p);return[2,w(a)]}}))}))}function vn(t){i.util.assert(t>0&&Number.isInteger(t),(function(){return"batchSize is required to be a positive integer, but got "+t}))}function bn(t,e,n){return null==t?[null]:Array.isArray(t)?t.map((function(t){return ft(t,e,n-e)})):ft(t,e,n-e)}function wn(t,e){return Object(i.tidy)((function(){return null==t?null:Array.isArray(t)?t.map((function(t){return wn(t,e)})):xt(t,"int32"===e.dtype?e:e.toInt())}))}function xn(t,e){for(var n=[],r=0,i=null;r<t;)(i=r+e)>=t&&(i=t),n.push([r,i]),r=i;return n}function _n(t,e,n,r,o,a,s,u,h,d,f,g,y,v,b){return l(this,void 0,void 0,(function(){var l,w,x,_,C,k,S,E;return c(this,(function(O){switch(O.label){case 0:if(null==o&&(o=32),null==a&&(a=1),null==f&&(f=!0),null==y&&(y=0),l=!1,null!=h&&null!=d&&(l=!0),null!=b&&(l=!0,null==v))throw new p("Can only use `validationSteps` when doing step-wise training, i.e., `stepsPerEpoch` must be set.");return null!=(w=t.checkNumSamples(n,o,v,"steps_per_epoch"))&&(x=ct(0,w)),null==s&&(s=1),_=Oe(u,s,a,y,w,v,o,l,g),k=_.history,(C=_.callbackList).setModel(t),t.history=k,[4,C.onTrainBegin()];case 1:O.sent(),t.stopTraining_=!1,S=function(a){var s,u,p,g,y;return c(this,(function(b){switch(b.label){case 0:return[4,C.onEpochBegin(a)];case 1:if(b.sent(),s={},null==v)return[3,2];throw new m("stepsPerEpoch mode is not implemented yet.");case 2:if("batch"===f)throw new m("batch shuffling is not implemneted yet");f&&i.util.shuffle(x),u=Object(i.tensor1d)(x),p=xn(w,o),g=function(a){var f;return c(this,(function(c){switch(c.label){case 0:return[4,C.onBatchBegin(a,f={})];case 1:return c.sent(),Object(i.tidy)((function(){var c=p[a][0],m=p[a][1],g=ft(u,c,m-c);f.batch=a,f.size=m-c;for(var y=wn(n,g),v=e(y),b=0;b<r.length;++b){var w=r[b],x=v[b];f[w]=x,Object(i.keep)(x)}if(a===p.length-1&&l){var _=t.testLoop(h,d,o);for(b=0;b<r.length;++b)w=r[b],x=_[b],Object(i.keep)(x),s["val_"+w]=x}})),[4,C.onBatchEnd(a,f)];case 2:return c.sent(),be(f),t.stopTraining_?[2,"break"]:[2]}}))},y=0,b.label=3;case 3:return y<p.length?[5,g(y)]:[3,6];case 4:if("break"===b.sent())return[3,6];b.label=5;case 5:return++y,[3,3];case 6:u.dispose(),b.label=7;case 7:return[4,C.onEpochEnd(a,s)];case 8:return b.sent(),t.stopTraining_?[2,"break"]:[2]}}))},E=y,O.label=2;case 2:return E<a?[5,S(E)]:[3,5];case 3:if("break"===O.sent())return[3,5];O.label=4;case 4:return++E,[3,2];case 5:return[4,C.onTrainEnd()];case 6:return O.sent(),[4,t.history.syncData()];case 7:return O.sent(),[2,t.history]}}))}))}function Cn(t,e,n,r){return void 0===r&&(r={}),l(this,void 0,void 0,(function(){var o,a,s,u,l,h,d,f,g,y,v,b,w,x,_,C,k,S,E,O;return c(this,(function(c){switch(c.label){case 0:if(t.isTraining)throw new Error("Cannot start training because another fit() call is ongoing.");t.isTraining=!0,c.label=1;case 1:return c.trys.push([1,,7,8]),vn(f=null==r.batchSize?32:r.batchSize),[4,t.standardizeUserData(e,n,r.sampleWeight,r.classWeight,!1,f)];case 2:if(g=c.sent(),o=g[0],a=g[1],d=g[2],y=!1,v=void 0,!(null!=r.validationData&&r.validationData.length>0))return[3,4];if(y=!0,2!==r.validationData.length)throw 3===r.validationData.length?new m("validationData including sample weights is not supported yet."):new p("When passing validation data, it must contain 2 (valX, valY) or 3 (valX, valY, valSampleWeight) items; "+r.validationData+" is invalid.");return[4,t.standardizeUserData(s=r.validationData[0],u=r.validationData[1],null,null,!0,f)];case 3:return b=c.sent(),v=(l=b[0]).concat(h=b[1]),[3,5];case 4:null!=r.validationSplit&&r.validationSplit>0&&r.validationSplit<1?(y=!0,w=Math.floor(o[0].shape[0]*(1-r.validationSplit)),l=bn(o,w,x=o[0].shape[0]),o=bn(o,0,w),h=bn(a,w,x),a=bn(a,0,w),v=l.concat(h)):null!=r.validationSteps&&(y=!0),c.label=5;case 5:return _=o.concat(a).concat(d),t.checkTrainableWeightsConsistency(),C=t.makeTrainFunction(),k=t.getDedupedMetricsNames(),S=void 0,E=void 0,y?(t.makeTestFunction(),S=t.testFunction,E=k.slice().concat(k.map((function(t){return"val_"+t})))):(S=null,v=[],E=k.slice()),O=Se(r.callbacks,r.yieldEvery),[4,_n(t,C,_,k,f,r.epochs,r.verbose,O,S,v,r.shuffle,E,r.initialEpoch,null,null)];case 6:return[2,c.sent()];case 7:return t.isTraining=!1,Sn(o,e),Sn(a,n),Sn(l,s),Sn(h,u),null!=d&&Object(i.dispose)(d),[7];case 8:return[2]}}))}))}function kn(t){var e=[];t instanceof i.Tensor&&(t=[t]);for(var n=0;n<t.length;++n){var r=t[n];if(1===r.rank)e.push(dt(r,1));else{if(0===r.rank)throw new Error("Expected tensor to be at least 1D, but received a 0D tensor (scalar).");e.push(r)}}return e}function Sn(t,e){if(null!=t){var n=[];if(e instanceof i.Tensor)n.push(e.id);else if(Array.isArray(e))e.forEach((function(t){return n.push(t.id)}));else if(null!=e)for(var r in e)n.push(e[r].id);var o=[];if(t instanceof i.Tensor)-1===n.indexOf(t.id)&&o.push(t);else if(Array.isArray(t))t.forEach((function(t){-1===n.indexOf(t.id)&&o.push(t)}));else if(null!=t)for(var a in t){var s=t[a];-1===n.indexOf(s.id)&&o.push(s)}o.forEach((function(t){t.isDisposed||t.dispose()}))}}function En(t){return Array.isArray(t)}function On(t){return!function(t){return t instanceof i.Tensor}(t)&&!En(t)}function An(t,e,n,r,i){if(void 0===r&&(r=!0),void 0===i&&(i=""),null==e||0===e.length){if(null!=t){var o=!1;if(En(t)&&t.length>0)o=!0;else if(On(t)){for(var a in t)if(t.hasOwnProperty(a)){o=!0;break}}else o=!0;if(o)throw new p("Error when checking model "+i+" expected no data, but got "+t)}return[]}if(null==t)return e.map((function(t){return null}));var s;if(On(t)){t=t,s=[];for(var u=0,l=e;u<l.length;u++){var c=l[u];if(null==t[c])throw new p('No data provided for "'+c+'". Need data for each key in: '+e);s.push(t[c])}}else if(En(t)){if((t=t).length!==e.length)throw new p("Error when checking model "+i+": the Array of Tensors that you are passing to your model is not the size the model expected. Expected to see "+e.length+" Tensor(s), but instead got the following list of Tensor(s): "+t);s=t}else{if(t=t,e.length>1)throw new p("The model "+i+" expects "+e.length+" Tensor(s), but only received one Tensor. Found: Tensor with shape "+t.shape);s=[t]}if(s=kn(s),null!=n)for(var h=0;h<e.length;++h)if(null!=n[h]){var d=s[h];if(d.shape.length!==n[h].length)throw new p("Error when checking "+i+": expected "+e[h]+" to have "+n[h].length+" dimension(s). but got array with shape "+d.shape);for(var f=0;f<n[h].length;++f)if(0!==f||r){var m=n[h][f];if(null!=m&&m>=0&&d.shape[f]!==m)throw new p("Error when checking "+i+": expected "+e[h]+" to have shape ["+n[h]+"], but got array with shape ["+d.shape+"].")}}return s}function Nn(t,e,n,r,i){var o;if(void 0===r&&(r=!0),void 0===i&&(i=""),Array.isArray(t)){if(t.length!==e.length)throw new p("Error when checking model "+i+": the Array of Tensors that you are passing to your model is not the size the the model expected. Expected to see "+e.length+" Tensor(s), but instead got "+t.length+" Tensors(s).");o=t}else{if(e.length>1)throw new p("The model expects "+e.length+" "+i+" Tensors, but only received one Tensor. Found: array with shape "+JSON.stringify(t.shape)+".");o=[t]}if(null!=n)for(var a=0;a<e.length;++a)if(null!=n[a]){var s=o[a];if(s.shape.length!==n[a].length)throw new p("Error when checking "+i+": expected "+e[a]+" to have "+n[a].length+" dimension(s), but got array with shape "+JSON.stringify(s.shape));for(var u=0;u<n[a].length;++u)if(0!==u||r){var l=n[a][u];if(null!=l&&l!==s.shape[u])throw new p("Error when checking "+i+": expected "+e[a]+" to have shape "+JSON.stringify(n[a])+" but got array with shape "+JSON.stringify(s.shape)+".")}}}var Tn=function(t){function e(e){var n=t.call(this,e)||this;return n.isTraining=!1,n}return a(e,t),e.prototype.summary=function(t,e,n){if(void 0===n&&(n=console.log),!this.built)throw new p("This model has never been called, thus its weights have not been created yet. So no summary can be displayed. Build the model first (e.g., by calling it on some test data).");!function(t,e,n,r){void 0===r&&(r=console.log);var i,o=function(t){var e=!0,n=[],r=[];for(var i in t.nodesByDepth)n.push(t.nodesByDepth[i]);for(var o=0,a=n;o<a.length;o++){var s=a[o];if(s.length>1||1===s.length&&s[0].inboundLayers.length>1){e=!1;break}r.push.apply(r,s)}if(e)for(var u=0,l=t.layers;u<l.length;u++){for(var c=!1,h=0,d=l[u].inboundNodes;h<d.length;h++)if(-1!==r.indexOf(d[h])){if(c){e=!1;break}c=!0}if(!e)break}return e}(t),a=["Layer (type)","Output shape","Param #"];if(o?(e=e||65,n=n||[.45,.85,1]):(e=e||98,n=n||[.33,.55,.67,1]),n[n.length-1]<=1&&(n=n.map((function(t){return Math.floor(e*t)}))),!o)for(var s in a.push("Receives inputs"),i=[],t.nodesByDepth)i.push.apply(i,t.nodesByDepth[s]);r("_".repeat(e)),Ye(a,n,r),r("=".repeat(e));for(var u=t.layers,l=0;l<u.length;++l)o?Ze(u[l],n,r):Qe(u[l],n,i,r),r((l===u.length-1?"=":"_").repeat(e));t.checkTrainableWeightsConsistency();var c=function(t){return ie(null!=t.collectedTrainableWeights?t.collectedTrainableWeights:t.trainableWeights)}(t),h=ie(t.nonTrainableWeights);r("Total params: "+(c+h)),r("Trainable params: "+c),r("Non-trainable params: "+h),r("_".repeat(e))}(this,t,e,n)},e.prototype.compile=function(t){var e=this;if(null==t.loss&&(t.loss=[]),this.loss=t.loss,"string"==typeof t.optimizer)this.optimizer_=function(t){var e={Adagrad:function(){return i.train.adagrad(.01)},Adadelta:function(){return i.train.adadelta(1,.95,h())},Adam:function(){return i.train.adam(.001,.9,.999,h())},Adamax:function(){return i.train.adamax(.002,.9,.999,h(),0)},RMSProp:function(){return i.train.rmsprop(.001,.9,0,h())},SGD:function(){return i.train.sgd(.01)}};if(e.adagrad=e.Adagrad,e.adadelta=e.Adadelta,e.adam=e.Adam,e.adamax=e.Adamax,e.rmsprop=e.RMSProp,e.sgd=e.SGD,t in e)return e[t]();throw new p("Unknown Optimizer "+t)}(t.optimizer),this.isOptimizerOwned=!0;else{if(!(t.optimizer instanceof i.Optimizer))throw new p("User-defined optimizer must be an instance of tf.Optimizer.");this.optimizer_=t.optimizer,this.isOptimizerOwned=!1}var n=[];if(Array.isArray(t.loss)||"string"==typeof t.loss||"function"==typeof t.loss)if(Array.isArray(t.loss)){if(t.loss.length!==this.outputs.length)throw new p("When passing an Array as loss, it should have one entry per model output. The model has "+this.outputs.length+" output(s), but you passed loss="+t.loss+".");n=t.loss.map((function(t){return ze(t)}))}else{var r=ze(t.loss);this.outputs.forEach((function(t){n.push(r)}))}else{for(var o in t.loss=t.loss,t.loss)if(-1===this.outputNames.indexOf(o))throw new p('Unknown entry in loss dictionary: "'+o+'". Only expected the following keys: '+this.outputNames);for(var a=0,s=this.outputNames;a<s.length;a++){var u=s[a];null==t.loss[u]&&console.warn('Output "'+u+'" is missing from loss dictionary. We assume this was done on purpose, and we will not be expecting data to be passed to '+u+" during training"),n.push(ze(t.loss[u]))}}this.lossFunctions=n,this.feedOutputNames=[],this.feedOutputShapes=[],this.feedLossFns=[];for(var l=0;l<this.outputs.length;++l){var c=this.internalOutputShapes[l];this.feedOutputNames.push(this.outputNames[l]),this.feedOutputShapes.push(c),this.feedLossFns.push(this.lossFunctions[l])}var d=[];this.metrics=t.metrics,this.metricsNames=["loss"],this.metricsTensors=[],tt("loss",(function(){for(var t=0;t<e.outputs.length;++t)-1===d.indexOf(t)&&e.outputs.length>1&&(e.metricsTensors.push([e.lossFunctions[t],t]),e.metricsNames.push(e.outputNames[t]+"_loss"))}));var f=function(t,e){if(null==t||Array.isArray(t)&&0===t.length)return e.map((function(t){return[]}));var n;if("string"==typeof t||"function"==typeof t)n=[t];else{if(!Array.isArray(t)&&"object"!=typeof t)throw new TypeError("Type of metrics argument not understood. Expected an string,function, Array, or Object, found: "+t);n=t}if(Array.isArray(n))return e.map((function(t){return n}));for(var r=[],i=0,o=e;i<o.length;i++){var a=o[i],s=n.hasOwnProperty(a)?n[a]:[];Array.isArray(s)||(s=[s]),r.push(s)}return r}(t.metrics,this.outputNames);tt("metric",(function(){for(var t=function(t){if(-1!==d.indexOf(t))return"continue";!function(n){for(var r,i,o,a=function(n){if("string"==typeof n&&-1!==["accuracy","acc","crossentropy","ce"].indexOf(n)){var a=e.internalOutputShapes[t];1===a[a.length-1]||e.lossFunctions[t]===Fe?-1!==["accuracy","acc"].indexOf(n)?i=Le:-1!==["crossentropy","ce"].indexOf(n)&&(i=Ve):e.lossFunctions[t]===Me?-1!==["accuracy","acc"].indexOf(n)?i=We:-1!==["crossentropy","ce"].indexOf(n)&&(i=He):-1!==["accuracy","acc"].indexOf(n)?i=Be:-1!==["crossentropy","ce"].indexOf(n)&&(i=qe);var s=void 0;-1!==["accuracy","acc"].indexOf(n)?s="acc":-1!==["crossentropy","ce"].indexOf(n)&&(s="ce"),o=i,r=""+s}else{var u=function(t){if("string"==typeof t&&t in Ge)return Ge[t];if("string"!=typeof t&&null!=t)return t;throw new p("Unknown metric "+t)}(n);o=u,r=""+Xe(n)}var l;tt(r,(function(){l=o})),function(t,n,r){e.outputNames.length>1&&(n=e.outputNames[t]+"_"+n),e.metricsNames.push(n),e.metricsTensors.push([r,t])}(t,r,l)},s=0,u=n;s<u.length;s++)a(u[s])}(f[t])},n=0;n<e.outputs.length;++n)t(n)})),this.collectedTrainableWeights=this.trainableWeights},e.prototype.checkTrainableWeightsConsistency=function(){null!=this.collectedTrainableWeights&&this.trainableWeights.length!==this.collectedTrainableWeights.length&&console.warn("Discrepancy between trainableweights and collected trainable weights. Did you set `model.trainable` without calling `model.compile()` afterwards?")},e.prototype.evaluate=function(t,e,n){void 0===n&&(n={});var r=null==n.batchSize?32:n.batchSize;vn(r);var i=this.standardizeUserDataXY(t,e,!0,r);try{var o=i[0].concat(i[1]);return this.makeTestFunction(),w(this.testLoop(this.testFunction,o,r,n.verbose,n.steps))}finally{Sn(i[0],t),Sn(i[1],e)}},e.prototype.evaluateDataset=function(t,e){return l(this,void 0,void 0,(function(){return c(this,(function(n){return this.makeTestFunction(),[2,yn(this,t,e)]}))}))},e.prototype.checkNumSamples=function(t,e,n,r){var i;if(void 0===r&&(r="steps"),null!=n){if(i=null,null!=e)throw new p("If "+r+" is set, batchSize must be null or undefined.Got batchSize = "+e)}else{if(null==t)throw new p("Either the input data should have a defined shape, or "+r+" shoud be specified.");i=Array.isArray(t)?t[0].shape[0]:t.shape[0]}return i},e.prototype.execute=function(t,e){if(Array.isArray(e)&&0===e.length)throw new p("`outputs` is an empty Array, which is not allowed.");var n=Array.isArray(e),r=this.retrieveSymbolicTensors(n?e:[e]),o=new nn;if(t instanceof i.Tensor&&(t=[t]),Array.isArray(t)){if(t.length!==this.inputs.length)throw new p("The number of inputs provided ("+t.length+") does not match the number of inputs of this model ("+this.inputs.length+").");for(var a=0;a<this.inputs.length;++a)o.add(this.inputs[a],t[a])}else for(var s=0,u=this.inputs;s<u.length;s++){var l=u[s],c=t[l.name];if(null==c)throw new p("No value is provided for the model's input "+l.name);o.add(l,c)}var h=an(r,o);return n?h:h[0]},e.prototype.retrieveSymbolicTensors=function(t){for(var e=y(null,t.length),n=t.length,r=0,i=this.layers;r<i.length;r++){for(var o=i[r],a=Array.isArray(o.output)?o.output:[o.output],s=a.map((function(t){return t.name})),u=0;u<t.length;++u){var l=s.indexOf(t[u]);if(-1!==l&&(e[u]=a[l],n--),0===n)break}if(0===n)break}if(n>0){var c=[];throw e.forEach((function(e,n){null==e&&c.push(t[n])})),new p("Cannot find SymbolicTensors for output name(s): "+JSON.stringify(c))}return e},e.prototype.predictLoop=function(t,e,n){var r=this;return void 0===e&&(e=32),void 0===n&&(n=!1),Object(i.tidy)((function(){var o=r.checkNumSamples(t);if(n)throw new m("Verbose predictLoop() is not implemented yet.");for(var a=xn(o,e),s=r.outputs.map((function(t){return[]})),u=function(e){Object(i.tidy)((function(){var n=bn(t,a[e][0],a[e][1]),i=[];if(Array.isArray(n))for(var o=0;o<n.length;++o)i.push({key:r.inputs[o],value:n[o]});else i.push({key:r.inputs[0],value:n});var s=new nn(i);return an(r.outputs,s)})).forEach((function(t,e){return s[e].push(t)}))},l=0;l<a.length;++l)u(l);return w(s.map((function(t){return Object(i.concat)(t,0)})))}))},e.prototype.predict=function(t,e){void 0===e&&(e={});var n=kn(t);Nn(n,this.inputNames,this.feedInputShapes,!1);try{var r=null==e.batchSize?32:e.batchSize;return vn(r),this.predictLoop(n,r)}finally{Sn(n,t)}},e.prototype.predictOnBatch=function(t){Nn(t,this.inputNames,this.feedInputShapes,!0);var e=(Array.isArray(t)?t[0]:t).shape[0];return this.predictLoop(t,e)},e.prototype.standardizeUserDataXY=function(t,e,n,r){if(void 0===n&&(n=!0),null==this.optimizer_)throw new f("You must compile a model before training/testing. Use LayersModel.compile(modelCompileArgs).");for(var o=[],a=0;a<this.feedOutputShapes.length;++a){var s=this.feedOutputShapes[a];o.push(this.feedLossFns[a]===Me?s.slice(0,s.length-1).concat([1]):s)}if(function(t,e,n){var r=A(t.map((function(t){return t.shape[0]})));r.sort();var o=A(e.map((function(t){return t.shape[0]})));if(o.sort(),r.length>1)throw new p("All input Tensors (x) should have the same number of samples. Got array shapes: "+JSON.stringify(t.map((function(t){return t.shape}))));if(o.length>1)throw new p("All target Tensors (y) should have the same number of samples. Got array shapes: "+JSON.stringify(e.map((function(t){return t.shape}))));if(r.length>0&&o.length>0&&!i.util.arraysEqual(r,o))throw new p("Input Tensors should have the same number of samples as target Tensors. Found "+r[0]+" input sample(s) and "+o[0]+" target sample(s).")}(t=An(t,this.feedInputNames,this.feedInputShapes,!1,"input"),e=An(e,this.feedOutputNames,o,!1,"target")),function(t,e,n){for(var r=[Te,Fe,Ie],i=0;i<t.length;++i){var o=t[i],a=e[i],s=n[i];if(null!=a){if(a===Ie&&1===o.shape[o.shape.length-1])throw new p("You are passing a target array of shape "+o.shape+" while using a loss 'categorical_crossentropy'. 'categorical_crossentropy'expects targets to be binary matrices (1s and 0s) of shape [samples, classes].");if(-1!==r.indexOf(a))for(var u=o.shape.slice(1),l=s.slice(1),c=0;c<u.length;++c){var h=l[c];if(null!=h&&u[c]!==h)throw new p("A target Tensor with shape "+o.shape+" was passed for an output of shape "+s+", while using a loss function that expects targets to have the same shape as the output.")}}}}(e,this.feedLossFns,this.feedOutputShapes),this.stateful&&null!=r&&r>0&&t[0].shape[0]%r!=0)throw new p("In a stateful network, you should only pass inputs with a number of samples that is divisible by the batch size "+r+". Found: "+t[0].shape[0]+" sample(s).");return[t,e]},e.prototype.standardizeUserData=function(t,e,n,r,i,o){return void 0===i&&(i=!0),l(this,void 0,void 0,(function(){var a,s,u,l,h,d,f,p;return c(this,(function(c){switch(c.label){case 0:if(a=this.standardizeUserDataXY(t,e,i,o),s=a[0],u=a[1],null!=n)throw new Error("sample weight is not supported yet.");if(l=null,null==r)return[3,4];h=cn(r,this.outputNames),l=[],d=0,c.label=1;case 1:return d<h.length?(p=(f=l).push,[4,hn(u[d],null,h[d])]):[3,4];case 2:p.apply(f,[c.sent()]),c.label=3;case 3:return++d,[3,1];case 4:return[2,[s,u,l]]}}))}))},e.prototype.testLoop=function(t,e,n,r,o){var a=this;return void 0===r&&(r=0),Object(i.tidy)((function(){var s=a.checkNumSamples(e,n,o,"steps"),u=[];if(r>0)throw new m("Verbose mode is not implemented yet.");if(null!=o)throw new m("steps mode in testLoop() is not implemented yet");for(var l=xn(s,n),c=Object(i.tensor1d)(ct(0,s)),h=0;h<l.length;++h){var d=l[h][0],f=l[h][1],p=ft(c,d,f-d),g=wn(e,p),y=t(g);if(0===h)for(var v=0;v<y.length;++v)u.push(Object(i.scalar)(0));for(v=0;v<y.length;++v){var b=y[v];u[v]=Object(i.add)(u[v],Object(i.mul)(f-d,b))}}for(v=0;v<u.length;++v)u[v]=Object(i.div)(u[v],s);return u}))},e.prototype.getDedupedMetricsNames=function(){for(var t=this.metricsNames,e=[],n=0;n<t.length;++n){var r=t[n],i=r;b(t,r)>1&&(i+="_"+b(t.slice(0,n),r)),e.push(i)}return e},e.prototype.makeTrainFunction=function(){var t=this;return function(e){var n=[],r=e.slice(0,t.inputs.length),o=e.slice(t.inputs.length,t.inputs.length+t.outputs.length),a=e.slice(t.inputs.length+t.outputs.length,t.inputs.length+2*t.outputs.length),s=[],u=t.collectedTrainableWeights.map((function(t){return t.read()}));return[t.optimizer_.minimize((function(){for(var e=[],u=0;u<t.inputs.length;++u)e.push({key:t.inputs[u],value:r[u]});var l,c=new nn(e),h=an(t.outputs,c,{training:!0});for(u=0;u<t.lossFunctions.length;++u){var d=(0,t.lossFunctions[u])(o[u],h[u]);null!=a[u]&&(d=dn(d,a[u]));var f=Object(i.mean)(d);n.push(f),l=0===u?d:Object(i.add)(l,d)}for(u=0;u<t.metricsTensors.length;++u){var p=void 0;if(t.outputs.length>1&&u<t.outputs.length)p=n[u];else{var m=t.metricsTensors[u][0],g=t.metricsTensors[u][1];p=Object(i.mean)(m(o[g],h[g]))}Object(i.keep)(p),s.push(p)}return l=Object(i.mean)(l),t.calculateLosses().forEach((function(t){l=Object(i.add)(l,t)})),l}),!0,u)].concat(s)}},e.prototype.makeTestFunction=function(){var t=this;this.testFunction=function(e){return Object(i.tidy)((function(){for(var n,r=[],o=e.slice(0,t.inputs.length),a=e.slice(t.inputs.length,t.inputs.length+t.outputs.length),s=[],u=0;u<t.inputs.length;++u)s.push({key:t.inputs[u],value:o[u]});var l=new nn(s),c=an(t.outputs,l);for(u=0;u<t.lossFunctions.length;++u){var h=t.lossFunctions[u],d=Object(i.mean)(h(a[u],c[u]));n=0===u?d:Object(i.add)(n,d),r.push(n)}for(u=0;u<t.metricsTensors.length;++u){var f=t.metricsTensors[u][0],p=t.metricsTensors[u][1],m=Object(i.mean)(f(a[p],c[p]));r.push(m)}return r}))}},e.prototype.fit=function(t,e,n){return void 0===n&&(n={}),l(this,void 0,void 0,(function(){return c(this,(function(r){return[2,Cn(this,t,e,n)]}))}))},e.prototype.fitDataset=function(t,e){return l(this,void 0,void 0,(function(){return c(this,(function(n){return[2,mn(this,t,e)]}))}))},e.prototype.trainOnBatch=function(t,e){return l(this,void 0,void 0,(function(){var n,r,o,a,s,u,l,h,d;return c(this,(function(c){switch(c.label){case 0:return[4,this.standardizeUserData(t,e)];case 1:n=c.sent(),r=n[0],o=n[1],a=this.makeTrainFunction(),s=a(r.concat(o)),u=[],l=0,h=s,c.label=2;case 2:return l<h.length?[4,h[l].data()]:[3,5];case 3:d=c.sent(),u.push(d[0]),c.label=4;case 4:return l++,[3,2];case 5:return Object(i.dispose)(s),[2,w(u)]}}))}))},e.prototype.getNamedWeights=function(t){for(var e=[],n=null!=t&&t.trainableOnly,r=n?this.trainableWeights:this.weights,i=this.getWeights(n),o=0;o<r.length;++o)n&&!r[o].trainable||e.push({name:r[o].originalName,tensor:i[o]});return e},Object.defineProperty(e.prototype,"stopTraining",{get:function(){return this.stopTraining_},set:function(t){this.stopTraining_=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"optimizer",{get:function(){return this.optimizer_},set:function(t){this.optimizer_!==t&&(this.optimizer_=t,this.isOptimizerOwned=!1)},enumerable:!0,configurable:!0}),e.prototype.dispose=function(){var e=t.prototype.dispose.call(this);if(0===e.refCountAfterDispose&&null!=this.optimizer&&this.isOptimizerOwned){var n=Object(i.memory)().numTensors;this.optimizer_.dispose(),e.numDisposedVariables+=n-Object(i.memory)().numTensors}return e},e.prototype.getLossIdentifiers=function(){var t;if("string"==typeof this.loss)t=_(this.loss);else if(Array.isArray(this.loss)){for(var e=0,n=this.loss;e<n.length;e++)if("string"!=typeof n[e])throw new Error("Serialization of non-string loss is not supported.");t=this.loss.map((function(t){return _(t)}))}else{var r=Object.keys(this.loss);t={};for(var i=this.loss,o=0,a=r;o<a.length;o++){var s=a[o];if("string"!=typeof i[s])throw new Error("Serialization of non-string loss is not supported.");t[s]=_(i[s])}}return t},e.prototype.getMetricIdentifiers=function(){if("string"==typeof this.metrics||"function"==typeof this.metrics)return[_(Xe(this.metrics))];if(Array.isArray(this.metrics))return this.metrics.map((function(t){return _(Xe(t))}));var t={};for(var e in this.metrics)t[e]=_(Xe(this.metrics[e]));return t},e.prototype.getTrainingConfig=function(){return{loss:this.getLossIdentifiers(),metrics:this.getMetricIdentifiers(),optimizer_config:{class_name:this.optimizer.getClassName(),config:this.optimizer.getConfig()}}},e.prototype.loadTrainingConfig=function(t){if(null!=t.weighted_metrics)throw new Error("Loading weight_metrics is not supported yet.");if(null!=t.loss_weights)throw new Error("Loading loss_weights is not supported yet.");if(null!=t.sample_weight_mode)throw new Error("Loading sample_weight_mode is not supported yet.");var e,n,r=Ae(tn(t.optimizer_config));if("string"==typeof t.loss)e=C(t.loss);else if(Array.isArray(t.loss))e=t.loss.map((function(t){return C(t)}));else if(null!=t.loss)for(var i in e={},t.loss)e[i]=C(t.loss[i]);if(Array.isArray(t.metrics))n=t.metrics.map((function(t){return C(t)}));else if(null!=t.metrics)for(var i in n={},t.metrics)n[i]=C(t.metrics[i]);this.compile({loss:e,metrics:n,optimizer:r})},e.prototype.save=function(t,e){return l(this,void 0,void 0,(function(){var n,r,o,a,s,u,l,h,d,f;return c(this,(function(c){switch(c.label){case 0:if("string"==typeof t){if(0===(n=i.io.getSaveHandlers(t)).length)throw new p("Cannot find any save handlers for URL '"+t+"'");if(n.length>1)throw new p("Found more than one ("+n.length+") save handlers for URL '"+t+"'");t=n[0]}if(null==t.save)throw new p("LayersModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");return[4,i.io.encodeWeights(this.getNamedWeights(e))];case 1:return r=c.sent(),o=this.toJSON(null,!1),a={modelTopology:o,format:"layers-model",generatedBy:"TensorFlow.js tfjs-layers v"+en,convertedBy:null},null!=e&&e.includeOptimizer&&null!=this.optimizer?(a.trainingConfig=this.getTrainingConfig(),s="optimizer",d=(h=i.io).encodeWeights,[4,this.optimizer.getWeights()]):[3,4];case 2:return[4,d.apply(h,[c.sent(),s])];case 3:u=c.sent(),l=u.data,(f=r.specs).push.apply(f,u.specs),r.data=i.io.concatenateArrayBuffers([r.data,l]),c.label=4;case 4:return null!=this.userDefinedMetadata&&(Ke(this.userDefinedMetadata,this.name,!0),a.userDefinedMetadata=this.userDefinedMetadata),a.weightData=r.data,a.weightSpecs=r.specs,[2,t.save(a)]}}))}))},e.prototype.setUserDefinedMetadata=function(t){Ke(t,this.name),this.userDefinedMetadata=t},e.prototype.getUserDefinedMetadata=function(){return this.userDefinedMetadata},e.className="Model",e}(function(t){function e(n){var r=t.call(this,{})||this;if(r.containerNodes=new Set,r.name=n.name,null==r.name){var i=r.getClassName().toLowerCase();r.name=Jt(i)}if(r.supportsMasking=!1,r.trainable_=!0,r.inputs=Array.isArray(n.inputs)?n.inputs.slice():[n.inputs],r.outputs=Array.isArray(n.outputs)?n.outputs.slice():[n.outputs],A(r.inputs).length!==r.inputs.length)throw new p("The list of inputs passed to the model is redundant. All inputs should only appear once. Found: "+r.inputs.map((function(t){return t.name})));A(r.outputs).length!==r.outputs.length&&console.warn("The list of outputs passed to the model is redundant. All outputs should only appear once. Found: "+r.outputs.map((function(t){return t.name}))),r.inputLayers=[],r.inputLayersNodeIndices=[],r.inputLayersTensorIndices=[],r.outputLayers=[],r.outputLayersNodeIndices=[],r.outputLayersTensorIndices=[],r.layers=[],r.internalContainerRefs=[];for(var o=0,a=r.outputs;o<a.length;o++){var s=(D=a[o]).sourceLayer,u=D.nodeIndex,l=D.tensorIndex;r.outputLayers.push(s),r.outputLayersNodeIndices.push(u),r.outputLayersTensorIndices.push(l)}for(var c=0,h=r.inputs;c<h.length;c++)s=(D=h[c]).sourceLayer,l=D.tensorIndex,v(0===(u=D.nodeIndex),"input layer has >1 nodes"),v(0===l,"input layer has >1 tensors"),r.inputLayers.push(s),r.inputLayersNodeIndices.push(u),r.inputLayersTensorIndices.push(l);r.inputNames=[],r.outputNames=[],r.feedInputShapes=[],r.feedInputNames=[],r.feedOutputNames=[];for(var d=0;d<r.inputLayers.length;d++){if(!((s=r.inputLayers[d])instanceof ge))throw new TypeError("Input layers to a LayersModel must be InputLayer objects. Received inputs: "+n.inputs+". Input "+d+" (0-based) originates from layer type "+s.getClassName()+".");r.inputNames.push(s.name),r.feedInputShapes.push(s.batchInputShape),r.feedInputNames.push(s.name)}for(var m=0,g=r.outputLayers;m<g.length;m++)r.outputNames.push((s=g[m]).name);r.internalInputShapes=r.inputs.map((function(t){return t.shape})),r.internalOutputShapes=r.outputs.map((function(t){return t.shape}));for(var y={},b={},w={},x={},_={},C=[],k=function(t,n,i,o,a,s){null!=o&&null!=a&&null!=s||(o=t.sourceLayer,a=t.nodeIndex,s=t.tensorIndex);var u=o.inboundNodes[a];if(-1!==i.indexOf(u))throw new f("The tensor "+t.name+' at layer "'+o.name+'" is part of a cycle.');if(-1===n.indexOf(u)){r.containerNodes.add(e.nodeKey(o,a)),o.id in _||(_[o.id]=Object.keys(_).length),-1===i.indexOf(u)&&i.push(u);for(var l=u.inboundLayers.length,c=0;c<l;c++)k(u.inputTensors[c],n,i,u.inboundLayers[c],u.nodeIndices[c],u.tensorIndices[c]);for(n.push(u);i.indexOf(u)>=0;)i.splice(i.indexOf(u),1);C.push(u)}},S=[],E=[],N=0,T=r.outputs;N<T.length;N++){var D=T[N];k(D,S,E)}for(var R=0,I=C.slice().reverse();R<I.length;R++){b[(Q=I[R]).id]=Q,Q.id in y||(y[Q.id]=0);var M=y[Q.id];for(M=Math.max(M,null==w[Q.outboundLayer.id]?0:w[Q.outboundLayer.id]),w[Q.outboundLayer.id]=M,x[Q.outboundLayer.id]=Q.outboundLayer,y[Q.id]=M,d=0;d<Q.inboundLayers.length;d++){var F=Q.inboundLayers[d].inboundNodes[u=Q.nodeIndices[d]];y[F.id]=Math.max(M+1,null==y[F.id]?0:y[F.id]),b[F.id]=F}}var P={};for(var j in y)(M=y[j])in P||(P[M]=[]),P[M].push(b[j]);var z={};for(var L in w)(M=w[L])in z||(z[M]=[]),z[M].push(x[L]);var B=Object.keys(z).map((function(t){return parseInt(t,10)})).sort(O);r.layers=[];for(var U=0,$=B;U<$.length;U++){var V=z[M=$[U]];V.sort((function(t,e){var n=_[t.id],r=_[e.id];return n<r?-1:n>r?1:0}));for(var W=0,q=V;W<q.length;W++)(s=q[W])instanceof e&&r.internalContainerRefs.push(s),r.layers.push(s)}r.layersByDepth=z,B=Object.keys(P).map((function(t){return parseInt(t,10)})).sort(O);for(var H=r.inputs.slice(),G=[],X=0,K=B;X<K.length;X++)for(var Y=0,Z=P[M=K[X]];Y<Z.length;Y++){var Q;if(null!=(s=(Q=Z[Y]).outboundLayer)){for(var J=0,tt=Q.inputTensors;J<tt.length;J++)if(-1===H.indexOf(D=tt[J]))throw new f("Graph disconnected: cannot obtain value for tensor "+D+' at layer "'+s.name+'". The following previous layers were accessed without issue: '+G);for(var et=0,nt=Q.outputTensors;et<nt.length;et++)H.push(D=nt[et]);G.push(s.name)}}r.nodesByDepth=P;for(var rt=r.layers.map((function(t){return t.name})),it=function(t){var e=rt.filter((function(e){return e===t})).length;if(1!==e)throw new f('The name "'+t+'" is used '+e+" times in the model. All layer names should be unique. Layer names: "+JSON.stringify(rt))},ot=0,at=rt;ot<at.length;ot++)it(at[ot]);return r.outboundNodes=[],r.inboundNodes=[],new fe({outboundLayer:r,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:r.inputs,outputTensors:r.outputs,inputMasks:r.inputs.map((function(t){return null})),outputMasks:r.outputs.map((function(t){return null})),inputShapes:r.inputs.map((function(t){return t.shape})),outputShapes:r.outputs.map((function(t){return t.shape}))}),r.built=!0,r._refCount=1,r}return a(e,t),e.prototype.assertNotDisposed=function(){if(0===this._refCount)throw new Error("Container '"+this.name+"' is already disposed.")},e.prototype.dispose=function(){this.assertNotDisposed();var t={refCountAfterDispose:null,numDisposedVariables:0};if(0==--this._refCount){for(var e=0,n=this.layers;e<n.length;e++)t.numDisposedVariables+=n[e].dispose().numDisposedVariables;for(var r=0,i=this.internalContainerRefs;r<i.length;r++)t.numDisposedVariables+=i[r].dispose().numDisposedVariables}return t.refCountAfterDispose=this._refCount,t},Object.defineProperty(e.prototype,"trainable",{get:function(){return this.trainable_},set:function(t){this.layers.forEach((function(e){e._trainableWeights.forEach((function(e){return e.trainable=t}))})),this.trainable_=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"trainableWeights",{get:function(){if(this._trainableWeights.length>0)throw new p("Container instance unexpectedly contains _trainableWeights.The trainable weights of a Container are a union of the trainable weights of its consituent Layers. Its own _trainableWeights must remain an empty Array.");if(!this.trainable)return[];for(var t=[],e=0,n=this.layers;e<n.length;e++)t=t.concat(n[e].trainableWeights);return t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"nonTrainableWeights",{get:function(){for(var t=[],e=0,n=this.layers;e<n.length;e++){var r=n[e];t.push.apply(t,r.nonTrainableWeights)}if(!this.trainable){for(var i=[],o=0,a=this.layers;o<a.length;o++)i.push.apply(i,(r=a[o]).trainableWeights);return i.concat(t)}return t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"weights",{get:function(){return this.trainableWeights.concat(this.nonTrainableWeights)},enumerable:!0,configurable:!0}),e.prototype.loadWeights=function(t,e){void 0===e&&(e=!0);for(var n={},r=0,i=0,o=this.layers;i<o.length;i++)for(var a=0,s=o[i].weights;a<s.length;a++){var u=s[a];if(null!=n[u.originalName])throw new p("Duplicate weight name: "+u.originalName);n[u.originalName]=u,r++}var l=[];for(var c in t){if(null!=n[c])l.push([n[c],t[c]]);else if(e)throw new p("Provided weight data has no target variable: "+c);delete n[c]}if(e){var h=[];for(var d in n)h.push(d);if(h.length>0)throw new p(h.length+" of "+r+" weights are not set: "+h)}se(l)},e.prototype.updatedConfig=function(){var t=this.getConfig(),e={};return e.className=this.getClassName(),e.config=t,e.kerasVersion="tfjs-layers "+en,e.backend="TensorFlow.js",e},e.prototype.toJSON=function(t,e){void 0===e&&(e=!0);var n=function t(e,n){if(null==e)return null;if("string"==typeof e)return _(e);if("number"==typeof e||"boolean"==typeof e)return e;if(e instanceof Array){for(var r=[],i=e.length,o=0;o<i;++o){var a=e[o];Je(n,o,a)?r.push(a):r.push(t(a,n))}return r}for(var s={},u=0,l=Object.keys(e);u<l.length;u++){var c=l[u],h=e[c];s[_(c)]="name"!==c&&"className"!==c||"string"!=typeof h?t(h,c):h}return s}(this.updatedConfig());return e?JSON.stringify(n):n},e.prototype.call=function(t,e){var n=this;return Object(i.tidy)((function(){t=x(t);for(var r=new nn,i=0;i<n.inputs.length;++i)r.add(n.inputs[i],t[i]);return an(n.outputs,r,e)}))},e.prototype.computeMask=function(t,e){var n=this;return Object(i.tidy)((function(){var r;return t=x(t),r=null==e?y(null,t.length):x(e),n.runInternalGraph(t,r)[1]}))},e.prototype.computeOutputShape=function(t){var e=ee(t);if(e.length!==this.inputLayers.length)throw new p("Invalid inputShape argument "+t+": model has "+this.inputLayers.length+" tensor inputs.");for(var n={},r=0;r<e.length;r++){var i=this.inputLayers[r];n[_=i.name+"_0_0"]=e[r]}var o=Object.keys(this.nodesByDepth).map((function(t){return parseInt(t,10)})).sort(O);if(o.length>1)for(var a=0,s=o;a<s.length;a++)for(var u=0,l=this.nodesByDepth[s[a]];u<l.length;u++){var c=l[u];if(i=c.outboundLayer,-1===this.inputLayers.map((function(t){return t.id})).indexOf(i.id)){for(var h=[],d=0;d<c.inboundLayers.length;d++){var f=c.tensorIndices[d],m=n[_=c.inboundLayers[d].name+"_"+c.nodeIndices[d]+"_"+f];h.push(m)}var g=ee(i.computeOutputShape(w(h))),y=i.inboundNodes.indexOf(c);for(d=0;d<g.length;d++)n[_=i.name+"_"+y+"_"+d]=g[d]}}var b=[],x=[];for(r=0;r<this.outputLayers.length;r++){var _=(i=this.outputLayers[r]).name+"_"+(y=this.outputLayersNodeIndices[r])+"_"+(f=this.outputLayersTensorIndices[r]);x.push(_)}for(r=0;r<x.length;r++){var C=x[r];v(C in n),b.push(n[C])}return w(b)},e.prototype.runInternalGraph=function(t,e){null==e&&(e=y(null,t.length));for(var n={},r=0;r<this.inputs.length;++r){var i=this.inputs[r],o=t[r],a=e[r];n[i.id]=[o,a]}for(var s=0,u=Object.keys(this.nodesByDepth).map((function(t){return parseInt(t,10)})).sort(O);s<u.length;s++)for(var l=0,c=this.nodesByDepth[u[s]];l<c.length;l++){for(var h=c[l],d=h.outboundLayer,f=h.inputTensors,p=h.outputTensors,g=new Array,b=0,w=f;b<w.length;b++)(i=w[b]).id in n&&g.push(n[i.id]);if(g.length===f.length){var _={},C=void 0,k=void 0,S=void 0,E=void 0;if(null!=h.callArgs&&(_=h.callArgs),1===g.length){var A=g[0],N=A[0],T=A[1];null==_.mask&&(_.mask=T),S=x(d.call(N,_)),E=x(d.computeMask(N,T)),C=[N],k=[T]}else C=g.map((function(t){return t[0]})),k=g.map((function(t){return t[1]})),null==_.mask&&(_.mask=k),S=x(d.call(C,_)),E=x(d.computeMask(C,k));if(d.activityRegularizer)throw new m("LayersModel invocation with concrete Tensor value(s) in the presence of activity regularizer(s) is not supported yet.");for(r=0;r<p.length;++r)n[(i=p[r]).id]=[o=S[r],a=E[r]]}}for(var D=[],R=[],I=[],M=0,F=this.outputs;M<F.length;M++){v((i=F[M]).id in n,"Could not compute output "+i.name+" : "+i.id);var P=n[i.id],j=P[0];a=P[1],I.push(j.shape),D.push(j),R.push(a)}return[D,R,I]},e.prototype.buildNodeConversionMap=function(t){for(var n,r={},i=0,o=this.layers;i<o.length;i++){var a=o[i];n=a instanceof e?1:0;for(var s=0;s<a.inboundNodes.length;s++){var u=e.nodeKey(a,s);this.containerNodes.has(u)&&(r[u]=n,n+=1)}}return r},e.prototype.getLayer=function(t,e){if(null!=e){if(this.layers.length<=e)throw new p("Was asked to retrieve layer at index "+e+", but model only has "+this.layers.length+" layer(s).");return this.layers[e]}if(null==t)throw new p("Provide either a layer name or layer index");for(var n=0,r=this.layers;n<r.length;n++){var i=r[n];if(i.name===t)return i}throw new p("No such layer: "+t)},e.prototype.calculateLosses=function(){var t=this;return Object(i.tidy)((function(){for(var n=[],r=0,i=t.layers;r<i.length;r++)for(var o=i[r],a=0;a<o.inboundNodes.length;++a){var s=e.nodeKey(o,a);t.containerNodes.has(s)&&n.push.apply(n,o.calculateLosses())}return n}))},e.prototype.getConfig=function(){for(var t={name:this.name},n=this.buildNodeConversionMap(this.layers),r=[],i=0,o=this.layers;i<o.length;i++){for(var a=(w=o[i]).getClassName(),s=w.getConfig(),u=[],l=0;l<w.inboundNodes.length;l++){var c=w.inboundNodes[l],h=e.nodeKey(w,l),d={};if(this.containerNodes.has(h)){if(c.callArgs)try{JSON.stringify(c.callArgs),d=c.callArgs}catch(t){console.warn("Layer "+w.name+" was passed non-serializable keyword arguments: "+c.callArgs+". They will not be included in the serialized model (and thus will be missing at deserialization time)."),d={}}if(c.inboundLayers.length>0){for(var f=[],p=0;p<c.inboundLayers.length;p++){var m=c.inboundLayers[p],g=c.nodeIndices[p],y=c.tensorIndices[p];null==(_=n[e.nodeKey(m,g)])&&(_=0),f.push([m.name,_,y,d])}u.push(f)}}}var v={};v.name=w.name,v.className=a,v.config=s,v.inboundNodes=u,r.push(v)}t.layers=r;var b=[];for(p=0;p<this.inputLayers.length;p++){var w=this.inputLayers[p];h=e.nodeKey(w,g=this.inputLayersNodeIndices[p]),this.containerNodes.has(h)&&(null!==(_=n[h])&&void 0!==_||(_=0),b.push([w.name,_,y=this.inputLayersTensorIndices[p]]))}t.inputLayers=b;var x=[];for(p=0;p<this.outputLayers.length;p++){var _;h=e.nodeKey(w=this.outputLayers[p],g=this.outputLayersNodeIndices[p]),this.containerNodes.has(h)&&(null!==(_=n[h])&&void 0!==_||(_=0),x.push([w.name,_,y=this.outputLayersTensorIndices[p]]))}return t.outputLayers=x,t},e.fromConfig=function(t,e,n,r){void 0===n&&(n={}),void 0===r&&(r=!1);var i={},o={};function a(t,e){t.name in o?o[t.name].push(e):o[t.name]=[e]}function s(t,e){for(var n,r=[],o=0,s=e;o<s.length;o++){var u=s[o],l=u[0],c=u[1],h=u[2];if(n=null==u[3]?{}:u[3],!(l in i))return void a(t,e);var d=i[l];if(d.inboundNodes.length<=c)return void a(t,e);r.push(d.inboundNodes[c].outputTensors[h])}r.length>0&&t.apply(w(r),n)}function u(t){var n=t.name,o=Ae(t,null!=e.customObjects?e.customObjects:{});o.setFastWeightInitDuringBuild(r),i[n]=o,t.inboundNodes.forEach((function(t){if(!(t instanceof Array))throw new p("Corrupted configuration, expected array for nodeData: "+t);a(o,t)}))}for(var l=e.name,c=e.layers,h=0,d=c;h<d.length;h++)u(g=d[h]);for(;!N(o);)for(var f=0,m=c;f<m.length;f++){var g=m[f];if((I=i[g.name]).name in o){var y=o[I.name];delete o[I.name];for(var b=0,x=y;b<x.length;b++)s(I,x[b])}}for(var _=[],C=[],k=0,S=e.inputLayers;k<S.length;k++){var E=(g=S[k])[0],O=g[1],A=g[2];v(E in i);var T=(I=i[E]).inboundNodes[O].outputTensors;_.push(T[A])}for(var D=0,R=e.outputLayers;D<R.length;D++){var I;E=(g=R[D])[0],O=g[1],A=g[2],v(E in i),T=(I=i[E]).inboundNodes[O].outputTensors,C.push(T[A])}return new t({inputs:_,outputs:C,name:l})},Object.defineProperty(e.prototype,"stateful",{get:function(){if(this._stateful)throw new p("Container instance unexpectedly has _stateful = true. The statefulness of a Container is determined by the Layers it contains. Its _stateful property must remain the default false.");for(var t=0,e=this.layers;t<e.length;t++)if(e[t].stateful)return!0;return!1},enumerable:!0,configurable:!0}),e.prototype.resetStates=function(){var t=this;Object(i.tidy)((function(){t.layers.forEach((function(t){t.stateful&&t.resetStates()}))}))},e}(me));function Dn(t,e,n){return l(this,void 0,void 0,(function(){var r,o,a,s,u,l,h,d,f;return c(this,(function(c){switch(c.label){case 0:if(null==n&&(n={}),null==t.load)throw new p("Cannot proceed with model loading because the IOHandler provided does not have the `load` method implemented.");return[4,t.load()];case 1:if(r=c.sent(),null!=(o=r.modelTopology).model_config&&(o=o.model_config),a=null==n.strict||n.strict,s=null!=r.weightData&&null!=r.weightSpecs&&a,u=Ae(tn(o),e,s),null!=(l=r.trainingConfig)&&u.loadTrainingConfig(l),null!=r.userDefinedMetadata&&u.setUserDefinedMetadata(r.userDefinedMetadata),null==r.weightData)return[3,4];if(null==r.weightSpecs)throw new p("LayersModel artifacts contains weight data, but not weight specs. Therefore loading of weights cannot proceed.");return h=function(t,e){var n=i.io.decodeWeights(t,e),r={},o=[];return e.forEach((function(t){"optimizer"===t.group?o.push({name:t.name,tensor:n[t.name]}):r[t.name]=n[t.name]})),{modelWeights:r,optimizerWeights:o}}(r.weightData,r.weightSpecs),f=h.optimizerWeights,u.loadWeights(d=h.modelWeights,a),null!=u.optimizer&&f.length>0?[4,u.optimizer.setWeights(f)]:[3,3];case 2:c.sent(),c.label=3;case 3:Object(i.dispose)(d),Object(i.dispose)(f.map((function(t){return t.tensor}))),c.label=4;case 4:return[2,u]}}))}))}i.serialization.registerClass(Tn);var Rn=function(t){function e(e){var n=t.call(this,{inputs:[],outputs:[]})||this;if(e=e||{},n.trainable=!0,n.built=!1,n.name=null!=e.name?e.name:Jt("sequential_"),null!=e.layers)for(var r=0,i=e.layers;r<i.length;r++)n.add(i[r]);return n}return a(e,t),e.prototype.checkShape=function(t){if(t.inboundNodes[0].outputTensors[0].shape.some((function(t){return t<0})))throw new p("Negative dimension size caused by adding layer "+t.name+" with input shape ["+t.inboundNodes[0].inputTensors[0].shape+"]")},e.prototype.add=function(t){var n,r=t instanceof e||t instanceof Tn;if(r){if(1!==(n=t).outputs.length)throw new p("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");if(1!==n.inputs.length)throw new p("All layers in a Sequential model should have a single input tensor. For multi-input layers, use the functional API.")}if(0===this.outputs.length){if(0===t.inboundNodes.length){if(null==t.batchInputShape)throw new p("The first layer in a Sequential model must get an `inputShape` or `batchInputShape` argument.");var i=ye({batchShape:t.batchInputShape,dtype:t.dtype,name:t.name+"_input"});t.apply(i)}if(r)this.outputs=n.outputs,this.inputs=n.inputs;else{if(1!==t.inboundNodes.length)throw new p("A layer added to a Sequential model must not already be connected somewhere else. LayersModel received layer "+t.name+" which has "+t.inboundNodes.length+" pre-existing inbound connections.");if(1!==t.inboundNodes[0].outputTensors.length)throw new p("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(t),this.outputs=[t.inboundNodes[0].outputTensors[0]],this.inputs=function t(e,n,r){if((null==n||null!=r&&r>0)&&(n=e.sourceLayer,r=e.nodeIndex),0===n.inboundNodes.length)return[e];var i=n.inboundNodes[r];if(0===i.inboundLayers.length)return i.inputTensors;for(var o=[],a=0;a<i.inboundLayers.length;a++)for(var s=0,u=t(i.inputTensors[a],i.inboundLayers[a],i.nodeIndices[a]);s<u.length;s++){var l=u[s];-1===o.indexOf(l)&&o.push(l)}return o}(this.outputs[0])}this.inboundNodes=[],new fe({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:y(null,this.inputs.length),outputMasks:[null],inputShapes:this.inputs.map((function(t){return t.shape})),outputShapes:this.outputs[0].shape})}else{var o=t.apply(this.outputs[0]);if(Array.isArray(o))throw new TypeError("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(t),this.outputs=[o],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}this.layers.push(t),this.built=!1},e.prototype.pop=function(){if(0===this.layers.length)throw new TypeError("There are no layers in the model.");if(this.layers.pop(),0===this.layers.length)this.outputs=[],this.inboundNodes=[],this.outboundNodes=[];else{var t=this.layers.length-1;this.layers[t].outboundNodes=[],this.outputs=[this.layers[t].output],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}},e.prototype.call=function(t,e){return null==this.model&&this.build(),this.model.call(t,e)},e.prototype.build=function(t){if(re(t),0===this.inputs.length||0===this.outputs.length)throw new TypeError("Sequential model cannot be built: model is empty. Add some layers first.");this.model=new Tn({inputs:this.inputs,outputs:this.outputs[0],name:this.name+"_model"}),this.model.trainable=this.trainable,this.supportsMasking=this.model.supportsMasking,this.inputLayers=this.model.inputLayers,this.inputLayersNodeIndices=this.model.inputLayersNodeIndices,this.inputLayersTensorIndices=this.model.inputLayersTensorIndices,this.outputLayers=this.model.outputLayers,this.outputLayersNodeIndices=this.model.outputLayersNodeIndices,this.outputLayersTensorIndices=this.model.outputLayersTensorIndices,this.nodesByDepth=this.model.nodesByDepth,this.containerNodes=this.model.containerNodes,this.outputNames=this.model.outputNames,this.inputNames=this.model.inputNames,this.built=!0},e.prototype.countParams=function(){return this.built||this.build(),t.prototype.countParams.call(this)},e.prototype.summary=function(e,n,r){void 0===r&&(r=console.log),this.built||this.build(),t.prototype.summary.call(this,e,n,r)},e.prototype.setWeights=function(t){null==this.model&&this.build(),this.model.setWeights(t)},e.prototype.evaluate=function(t,e,n){if(void 0===n&&(n={}),!this.built)throw new f("The model needs to be compiled before being used.");return this.model.evaluate(t,e,n)},e.prototype.evaluateDataset=function(t,e){return l(this,void 0,void 0,(function(){return c(this,(function(n){if(!this.built)throw new f("The model needs to be compiled before being used.");return[2,this.model.evaluateDataset(t,e)]}))}))},e.prototype.predict=function(t,e){return void 0===e&&(e={}),null==this.model&&this.build(),this.model.predict(t,e)},e.prototype.predictOnBatch=function(t){return null==this.model&&this.build(),this.model.predictOnBatch(t)},e.prototype.compile=function(t){this.build(),this.model.compile(t),this.optimizer_=this.model.optimizer,this.isOptimizerOwned=this.model.isOptimizerOwned,this.loss=this.model.loss,this.metrics=this.model.metrics,this.metricsTensors=this.model.metricsTensors,this.metricsNames=this.model.metricsNames},Object.defineProperty(e.prototype,"optimizer",{get:function(){return null==this.model?void 0:this.model.optimizer},set:function(t){this.model.optimizer=t},enumerable:!0,configurable:!0}),e.prototype.fit=function(t,e,n){return void 0===n&&(n={}),l(this,void 0,void 0,(function(){return c(this,(function(r){if(!this.built)throw new f("The model needs to be compiled before being used.");return[2,this.model.fit(t,e,n)]}))}))},e.prototype.fitDataset=function(t,e){return l(this,void 0,void 0,(function(){return c(this,(function(n){if(!this.built)throw new f("The model needs to be compiled before being used.");return[2,this.model.fitDataset(t,e)]}))}))},e.prototype.trainOnBatch=function(t,e){return l(this,void 0,void 0,(function(){return c(this,(function(n){return[2,this.model.trainOnBatch(t,e)]}))}))},e.fromConfig=function(t,n,r,o){var a;void 0===r&&(r={}),void 0===o&&(o=!1);var s={};if(n instanceof Array){if(null==n[0].className||"Merge"===n[0].className)throw new p("Legacy serialization format not supported yet.");a=n}else i.util.assert(null!=n.layers,(function(){return"When the config data for a Sequential model is not an Array, it must be an Object that contains the 'layers' field."})),a=n.layers,delete n.layers,s=n;var u=new t(s);if(!(u instanceof e))throw new m("Sequential.fromConfig called on non-Sequential input: "+u);for(var l=0,c=a;l<c.length;l++){var h=Ae(c[l],void 0,o);o&&h.setFastWeightInitDuringBuild(!0),u.add(h)}return u},Object.defineProperty(e.prototype,"stopTraining",{get:function(){if(null==this.model)throw new p("Cannot get the stopTraining property of a sequential model before it is compiled.");return this.model.stopTraining},set:function(t){if(null==this.model)throw new p("Cannot set the stopTraining property of a sequential model before it is compiled.");this.model.stopTraining=t},enumerable:!0,configurable:!0}),e.prototype.getConfig=function(){for(var t=[],e=0,n=this.layers;e<n.length;e++){var r=n[e],i={};i.className=r.getClassName(),i.config=r.getConfig(),t.push(i)}return t},e.className="Sequential",e}(Tn);function In(t){return new Tn(t)}function Mn(t){return new Rn(t)}function Fn(t,e){return null==e&&(e={}),function(t,e){return l(this,void 0,void 0,(function(){var n;return c(this,(function(r){if(null==e&&(e={}),"string"==typeof t){if(0===(n=i.io.getLoadHandlers(t,e.onProgress)).length)n.push(i.io.browserHTTPRequest(t,e));else if(n.length>1)throw new p("Found more than one ("+n.length+") load handlers for URL '"+t+"'");t=n[0]}return[2,Dn(t,void 0,e)]}))}))}(t,e)}function Pn(t){return ye(t)}function jn(t,e){Ee.registerCallbackConstructor(t,e)}i.serialization.registerClass(Rn);var zn=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return a(e,t),e.prototype.getConfig=function(){return{}},e}(i.serialization.Serializable),Ln=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return a(e,t),e.prototype.apply=function(t,e){return void 0===e&&(e=1),function(t,e){if(void 0===e&&(e=1),1!==e)throw new m("Support for alpha values other than 1 ("+e+") is not implemented yet.");return Object(i.elu)(t)}(t,e)},e.className="elu",e}(zn);i.serialization.registerClass(Ln);var Bn=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return a(e,t),e.prototype.apply=function(t){return Object(i.selu)(t)},e.className="selu",e}(zn);i.serialization.registerClass(Bn);var Un=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return a(e,t),e.prototype.apply=function(t){return Object(i.relu)(t)},e.className="relu",e}(zn);i.serialization.registerClass(Un);var $n=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return a(e,t),e.prototype.apply=function(t){return Object(i.tidy)((function(){return Object(i.minimum)(6,Object(i.relu)(t))}))},e.className="relu6",e}(zn);i.serialization.registerClass($n);var Vn=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return a(e,t),e.prototype.apply=function(t){return t},e.className="linear",e}(zn);i.serialization.registerClass(Vn);var Wn=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return a(e,t),e.prototype.apply=function(t){return Object(i.sigmoid)(t)},e.className="sigmoid",e}(zn);i.serialization.registerClass(Wn);var qn=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return a(e,t),e.prototype.apply=function(t){return function(t){return Object(i.tidy)((function(){var e=Object(i.add)(.5,Object(i.mul)(.2,t));return Object(i.clipByValue)(e,0,1)}))}(t)},e.className="hardSigmoid",e}(zn);i.serialization.registerClass(qn);var Hn=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return a(e,t),e.prototype.apply=function(t){return Object(i.softplus)(t)},e.className="softplus",e}(zn);i.serialization.registerClass(Hn);var Gn=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return a(e,t),e.prototype.apply=function(t){return function(t){return Object(i.tidy)((function(){return Object(i.div)(t,Object(i.abs)(t).add(1))}))}(t)},e.className="softsign",e}(zn);i.serialization.registerClass(Gn);var Xn=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return a(e,t),e.prototype.apply=function(t){return Object(i.tanh)(t)},e.className="tanh",e}(zn);i.serialization.registerClass(Xn);var Kn=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return a(e,t),e.prototype.apply=function(t,e){return void 0===e&&(e=-1),Object(i.softmax)(t,e)},e.className="softmax",e}(zn);i.serialization.registerClass(Kn);var Yn=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return a(e,t),e.prototype.apply=function(t,e){return void 0===e&&(e=-1),Object(i.logSoftmax)(t,e)},e.className="logSoftmax",e}(zn);function Zn(t){return t.getClassName()}function Qn(t,e){return void 0===e&&(e={}),E(t,i.serialization.SerializationMap.getMap().classNameMap,e,"activation")}function Jn(t){var e;return null==t?Qn(e={className:"linear",config:{}}):"string"==typeof t?((e={}).className=t,e.config={},Qn(e)):t instanceof zn?t:Qn(t)}function tr(t){if(null!=t&&"object"!=typeof t)throw new Error("Argument to L1L2 regularizer's constructor is expected to be an object, but received: "+t)}i.serialization.registerClass(Yn);var er=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return a(e,t),e}(i.serialization.Serializable),nr=function(t){function e(e){var n=t.call(this)||this;return tr(e),n.l1=null==e||null==e.l1?.01:e.l1,n.l2=null==e||null==e.l2?.01:e.l2,n.hasL1=0!==n.l1,n.hasL2=0!==n.l2,n}return a(e,t),e.prototype.apply=function(t){var e=this;return Object(i.tidy)((function(){var n=Object(i.zeros)([1]);return e.hasL1&&(n=Object(i.add)(n,Object(i.sum)(Object(i.mul)(e.l1,Object(i.abs)(t))))),e.hasL2&&(n=Object(i.add)(n,Object(i.sum)(Object(i.mul)(e.l2,_t(t))))),n.asScalar()}))},e.prototype.getConfig=function(){return{l1:this.l1,l2:this.l2}},e.fromConfig=function(t,e){return new t({l1:e.l1,l2:e.l2})},e.className="L1L2",e}(er);i.serialization.registerClass(nr);var rr={l1l2:"L1L2"};function ir(t){return S(t)}function or(t,e){return void 0===e&&(e={}),E(t,i.serialization.SerializationMap.getMap().classNameMap,e,"regularizer")}function ar(t){return null==t?null:"string"==typeof t?or({className:t in rr?rr[t]:t,config:{}}):t instanceof er?t:or(t)}var sr=function(t){function e(e){var n=t.call(this,null==e?{}:e)||this;return n.supportsMasking=!0,null!=e&&(n.maxValue=e.maxValue),n}return a(e,t),e.prototype.call=function(t,e){t=ne(t);var n=Object(i.relu)(t);return null!=this.maxValue&&(n=Object(i.clipByValue)(n,0,this.maxValue)),n},e.prototype.computeOutputShape=function(t){return t},e.prototype.getConfig=function(){var e={maxValue:this.maxValue},n=t.prototype.getConfig.call(this);return Object.assign(e,n),e},e.className="ReLU",e}(me);i.serialization.registerClass(sr);var ur=function(t){function e(e){var n=t.call(this,null==e?{}:e)||this;return n.DEFAULT_ALPHA=.3,null==e&&(e={}),n.alpha=null==e.alpha?n.DEFAULT_ALPHA:e.alpha,n}return a(e,t),e.prototype.call=function(t,e){var n=ne(t);return Object(i.leakyRelu)(n,this.alpha)},e.prototype.computeOutputShape=function(t){return t},e.prototype.getConfig=function(){var e={alpha:this.alpha},n=t.prototype.getConfig.call(this);return Object.assign(e,n),e},e.className="LeakyReLU",e}(me);i.serialization.registerClass(ur);var lr=function(t){function e(e){var n=t.call(this,null==e?{}:e)||this;if(n.DEFAULT_ALPHA_INITIALIZER="zeros",null==e&&(e={}),n.supportsMasking=!0,n.alphaInitializer=Xt(e.alphaInitializer||n.DEFAULT_ALPHA_INITIALIZER),n.alphaRegularizer=ar(e.alphaRegularizer),n.alphaConstraint=V(e.alphaConstraint),null==e.sharedAxes)n.sharedAxes=null;else if(Array.isArray(e.sharedAxes))n.sharedAxes=e.sharedAxes;else{if("number"!=typeof e.sharedAxes)throw new p("Expected sharedAxes to be a number or an array of numbers, but got "+e.sharedAxes);n.sharedAxes=[e.sharedAxes]}return n}return a(e,t),e.prototype.build=function(t){var e=(t=re(t)).slice(1);if(null!=this.sharedAxes)for(var n=0,r=this.sharedAxes;n<r.length;n++)e[(o=r[n])-1]=1;this.alpha=this.addWeight("alpha",e,"float32",this.alphaInitializer,this.alphaRegularizer,!0,this.alphaConstraint);var i={};if(null!=this.sharedAxes)for(var o=1;o<t.length;++o)i[o]=t[o];this.inputSpec=[new ce({ndim:t.length,axes:i})],this.built=!0},e.prototype.call=function(t,e){return t=ne(t),Object(i.prelu)(t,this.alpha.read())},e.prototype.getConfig=function(){var e={alphaInitializer:Gt(this.alphaInitializer),alphaRegularizer:ir(this.alphaRegularizer),alphaConstraint:U(this.alphaConstraint),sharedAxes:this.sharedAxes},n=t.prototype.getConfig.call(this);return Object.assign(e,n),e},e.className="PReLU",e}(me);i.serialization.registerClass(lr);var cr=function(t){function e(e){var n=t.call(this,null==e?{}:e)||this;if(n.DEFAULT_ALPHA=1,null==e&&(e={}),null!=e.alpha&&e.alpha!==n.DEFAULT_ALPHA)throw new m("Non-default alpha value ("+e.alpha+") is not supported by the ELU layer yet.");return n.alpha=null==e.alpha?n.DEFAULT_ALPHA:e.alpha,n}return a(e,t),e.prototype.call=function(t,e){var n=ne(t);return Object(i.elu)(n)},e.prototype.computeOutputShape=function(t){return t},e.prototype.getConfig=function(){var e={alpha:this.alpha},n=t.prototype.getConfig.call(this);return Object.assign(e,n),e},e.className="ELU",e}(me);i.serialization.registerClass(cr);var hr=function(t){function e(e){var n=t.call(this,null==e?{}:e)||this;return n.DEFAULT_THETA=1,null==e&&(e={}),n.theta=null==e.theta?n.DEFAULT_THETA:e.theta,n}return a(e,t),e.prototype.call=function(t,e){var n=ne(t);return n.mul(ht(n.greater(this.theta),"float32"))},e.prototype.computeOutputShape=function(t){return t},e.prototype.getConfig=function(){var e={theta:this.theta},n=t.prototype.getConfig.call(this);return Object.assign(e,n),e},e.className="ThresholdedReLU",e}(me);i.serialization.registerClass(hr);var dr=function(t){function e(e){var n=t.call(this,null==e?{}:e)||this;return n.DEFAULT_AXIS=1,null==e&&(e={}),n.softmax=(new Kn).apply,n.axis=null==e.axis?n.DEFAULT_AXIS:e.axis,n}return a(e,t),e.prototype.call=function(t,e){var n=ne(t);return this.softmax(n,this.axis)},e.prototype.computeOutputShape=function(t){return t},e.prototype.getConfig=function(){var e={axis:this.axis},n=t.prototype.getConfig.call(this);return Object.assign(e,n),e},e.className="Softmax",e}(me);function fr(t,e,n){if("number"==typeof t)return y(t,e);if(t.length!==e)throw new p("The "+n+" argument must be an integer or tuple of "+e+" integers. Received: "+t.length+" elements.");for(var r=0;r<e;++r){var i=t[r];if(!ot(i))throw new p("The "+n+" argument must be an integer or tuple of "+e+" integers. Received: "+JSON.stringify(t)+" including a non-integer number "+i)}return t}function pr(t,e,n,r,i){return void 0===i&&(i=1),null==t?t:Math.floor((("same"===n?t:t-(e+(e-1)*(i-1))+1)+r-1)/r)}function mr(t,e,n,r){if(null==t)return null;if("valid"===r)t=t*e+lt([n-e,0]);else{if("same"!==r)throw new p("Unsupport padding mode: "+r+".");t*=e}return t}function gr(t,e){return Object(i.tidy)((function(){return Y(e),"channelsFirst"===e?Object(i.transpose)(t,[0,2,3,1]):t}))}function yr(t,e){return Object(i.tidy)((function(){return Y(e),"channelsFirst"===e?Object(i.transpose)(t,[0,2,3,4,1]):t}))}function vr(t,e,n,r,o,a,s,u){return void 0===r&&(r=[1,1]),void 0===o&&(o="valid"),void 0===u&&(u=null),Object(i.tidy)((function(){if(null==a&&(a="channelsLast"),Y(a),3!==t.rank&&4!==t.rank)throw new p("conv2dWithBiasActivation expects input to be of rank 3 or 4, but received "+t.rank+".");if(3!==e.rank&&4!==e.rank)throw new p("conv2dWithBiasActivation expects kernel to be of rank 3 or 4, but received "+t.rank+".");var l=gr(t,a);if("causal"===o)throw new m("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");return l=i.fused.conv2d({x:l,filter:e,strides:r,pad:"same"===o?"same":"valid",dilations:s,dataFormat:"NHWC",bias:n,activation:u}),"channelsFirst"===a&&(l=Object(i.transpose)(l,[0,3,1,2])),l}))}i.serialization.registerClass(dr);var br=function(t){function e(n,r){var i=t.call(this,r)||this;if(i.bias=null,i.DEFAULT_KERNEL_INITIALIZER="glorotNormal",i.DEFAULT_BIAS_INITIALIZER="zeros",e.verifyArgs(r),i.rank=n,R(i.rank,"rank"),1!==i.rank&&2!==i.rank&&3!==i.rank)throw new m("Convolution layer for rank other than 1, 2, or 3 ("+i.rank+") is not implemented yet.");if(i.kernelSize=fr(r.kernelSize,n,"kernelSize"),i.strides=fr(null==r.strides?1:r.strides,n,"strides"),i.padding=null==r.padding?"valid":r.padding,Z(i.padding),i.dataFormat=null==r.dataFormat?"channelsLast":r.dataFormat,Y(i.dataFormat),i.activation=Jn(r.activation),i.useBias=null==r.useBias||r.useBias,i.biasInitializer=Xt(r.biasInitializer||i.DEFAULT_BIAS_INITIALIZER),i.biasConstraint=V(r.biasConstraint),i.biasRegularizer=ar(r.biasRegularizer),i.activityRegularizer=ar(r.activityRegularizer),i.dilationRate=fr(null==r.dilationRate?1:r.dilationRate,n,"dilationRate"),1===i.rank&&Array.isArray(i.dilationRate)&&1!==i.dilationRate.length)throw new p("dilationRate must be a number or an array of a single number for 1D convolution, but received "+JSON.stringify(i.dilationRate));if(2===i.rank){if("number"==typeof i.dilationRate)i.dilationRate=[i.dilationRate,i.dilationRate];else if(2!==i.dilationRate.length)throw new p("dilationRate must be a number or array of two numbers for 2D convolution, but received "+JSON.stringify(i.dilationRate))}else if(3===i.rank)if("number"==typeof i.dilationRate)i.dilationRate=[i.dilationRate,i.dilationRate,i.dilationRate];else if(3!==i.dilationRate.length)throw new p("dilationRate must be a number or array of three numbers for 3D convolution, but received "+JSON.stringify(i.dilationRate));return i}return a(e,t),e.verifyArgs=function(t){if(v("kernelSize"in t,"required key 'kernelSize' not in config"),"number"!=typeof t.kernelSize&&!D(t.kernelSize,"number",1,3))throw new p("BaseConv expects config.kernelSize to be number or number[] with length 1, 2, or 3, but received "+JSON.stringify(t.kernelSize)+".")},e.prototype.getConfig=function(){var e={kernelSize:this.kernelSize,strides:this.strides,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,activation:Zn(this.activation),useBias:this.useBias,biasInitializer:Gt(this.biasInitializer),biasRegularizer:ir(this.biasRegularizer),activityRegularizer:ir(this.activityRegularizer),biasConstraint:U(this.biasConstraint)},n=t.prototype.getConfig.call(this);return Object.assign(e,n),e},e}(me),wr=function(t){function e(n,r){var i=t.call(this,n,r)||this;return i.kernel=null,e.verifyArgs(r),i.filters=r.filters,R(i.filters,"filters"),i.kernelInitializer=Xt(r.kernelInitializer||i.DEFAULT_KERNEL_INITIALIZER),i.kernelConstraint=V(r.kernelConstraint),i.kernelRegularizer=ar(r.kernelRegularizer),i}return a(e,t),e.prototype.build=function(t){var e;t=re(t);var n="channelsFirst"===this.dataFormat?1:t.length-1;if(null==t[n])throw new p("The channel dimension of the input should be defined. Found "+t[n]);var r=t[n],i=this.kernelSize.concat([r,this.filters]);this.kernel=this.addWeight("kernel",i,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[{ndim:this.rank+2,axes:(e={},e[n]=r,e)}],this.built=!0},e.prototype.call=function(t,e){var n=this;return Object(i.tidy)((function(){var e;t=ne(t);var r=null==n.bias?null:n.bias.read(),o=I(n.activation.getClassName());if(null!=o&&2===n.rank)e=vr(t,n.kernel.read(),r,n.strides,n.padding,n.dataFormat,n.dilationRate,o);else{if(1===n.rank)e=function(t,e,n,r,o,a,s){return void 0===r&&(r=1),void 0===o&&(o="valid"),void 0===s&&(s=1),Object(i.tidy)((function(){if(null==a&&(a="channelsLast"),Y(a),3!==t.shape.length)throw new p("The input of a conv1dWithBias operation should be 3, but is "+t.shape.length+" instead.");if(3!==e.shape.length)throw new p("The kernel for a conv1dWithBias operation should be 3, but is "+e.shape.length+" instead");if(null!=n&&1!==n.shape.length)throw new p("The bias for a conv1dWithBias operation should be 1, but is "+e.shape.length+" instead");if("channelsFirst"===a&&(t=Object(i.transpose)(t,[0,2,1])),"causal"===o)throw new m("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");var u=Object(i.conv1d)(t,e,r,"same"===o?"same":"valid","NWC",s);return null!=n&&(u=kt(u,n)),u}))}(t,n.kernel.read(),r,n.strides[0],n.padding,n.dataFormat,n.dilationRate[0]);else if(2===n.rank)e=vr(t,n.kernel.read(),r,n.strides,n.padding,n.dataFormat,n.dilationRate);else{if(3!==n.rank)throw new m("convolutions greater than 3D are not implemented yet.");e=function(t,e,n,r,o,a,s){return void 0===r&&(r=[1,1,1]),void 0===o&&(o="valid"),Object(i.tidy)((function(){if(null==a&&(a="channelsLast"),Y(a),4!==t.rank&&5!==t.rank)throw new p("conv3dWithBias expects input to be of rank 4 or 5, but received "+t.rank+".");if(4!==e.rank&&5!==e.rank)throw new p("conv3dWithBias expects kernel to be of rank 4 or 5, but received "+t.rank+".");var u=yr(t,a);if("causal"===o)throw new m("The support for CAUSAL padding mode in conv3dWithBias is not implemented yet.");return u=Object(i.conv3d)(u,e,r,"same"===o?"same":"valid","NDHWC",s),null!=n&&(u=kt(u,n)),"channelsFirst"===a&&(u=Object(i.transpose)(u,[0,4,1,2,3])),u}))}(t,n.kernel.read(),r,n.strides,n.padding,n.dataFormat,n.dilationRate)}null!=n.activation&&(e=n.activation.apply(e))}return e}))},e.prototype.computeOutputShape=function(t){t=re(t);for(var e=[],n="channelsLast"===this.dataFormat?t.slice(1,t.length-1):t.slice(2),r=0;r<n.length;++r){var i=pr(n[r],this.kernelSize[r],this.padding,this.strides[r],"number"==typeof this.dilationRate?this.dilationRate:this.dilationRate[r]);e.push(i)}var o=[t[0]];return"channelsLast"===this.dataFormat?(o=o.concat(e)).push(this.filters):(o.push(this.filters),o=o.concat(e)),o},e.prototype.getConfig=function(){var e={filters:this.filters,kernelInitializer:Gt(this.kernelInitializer),kernelRegularizer:ir(this.kernelRegularizer),kernelConstraint:U(this.kernelConstraint)},n=t.prototype.getConfig.call(this);return Object.assign(e,n),e},e.verifyArgs=function(t){if(!("filters"in t)||"number"!=typeof t.filters||t.filters<1)throw new p("Convolution layer expected config.filters to be a 'number' > 0 but got "+JSON.stringify(t.filters))},e}(br),xr=function(t){function e(n){var r=t.call(this,2,n)||this;return e.verifyArgs(n),r}return a(e,t),e.prototype.getConfig=function(){var e=t.prototype.getConfig.call(this);return delete e.rank,e},e.verifyArgs=function(t){if("number"!=typeof t.kernelSize&&!D(t.kernelSize,"number",1,2))throw new p("Conv2D expects config.kernelSize to be number or number[] with length 1 or 2, but received "+JSON.stringify(t.kernelSize)+".")},e.className="Conv2D",e}(wr);i.serialization.registerClass(xr);var _r=function(t){function e(n){var r=t.call(this,3,n)||this;return e.verifyArgs(n),r}return a(e,t),e.prototype.getConfig=function(){var e=t.prototype.getConfig.call(this);return delete e.rank,e},e.verifyArgs=function(t){if("number"!=typeof t.kernelSize&&(!Array.isArray(t.kernelSize)||1!==t.kernelSize.length&&3!==t.kernelSize.length))throw new p("Conv3D expects config.kernelSize to be number or [number, number, number], but received "+JSON.stringify(t.kernelSize)+".")},e.className="Conv3D",e}(wr);i.serialization.registerClass(_r);var Cr=function(t){function e(e){var n=t.call(this,e)||this;if(n.inputSpec=[new ce({ndim:4})],"same"!==n.padding&&"valid"!==n.padding)throw new p("Conv2DTranspose currently supports only padding modes 'same' and 'valid', but received padding mode "+n.padding);return n}return a(e,t),e.prototype.build=function(t){var e;if(4!==(t=re(t)).length)throw new p("Input should have rank 4; Received input shape: "+JSON.stringify(t));var n="channelsFirst"===this.dataFormat?1:t.length-1;if(null==t[n])throw new p("The channel dimension of the inputs should be defined. Found `None`.");var r=t[n],i=this.kernelSize.concat([this.filters,r]);this.kernel=this.addWeight("kernel",i,"float32",this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new ce({ndim:4,axes:(e={},e[n]=r,e)})],this.built=!0},e.prototype.call=function(t,e){var n=this;return Object(i.tidy)((function(){var e=ne(t);if(4!==e.shape.length)throw new p("Conv2DTranspose.call() expects input tensor to be rank-4, but received a tensor of rank-"+e.shape.length);var r,o,a=e.shape;"channelsFirst"===n.dataFormat?(r=2,o=3):(r=1,o=2);var s=a[o],u=n.kernelSize[1],l=n.strides[1],c=[a[0],mr(a[r],n.strides[0],n.kernelSize[0],n.padding),mr(s,l,u,n.padding),n.filters];"channelsLast"!==n.dataFormat&&(e=Object(i.transpose)(e,[0,2,3,1]));var h=Object(i.conv2dTranspose)(e,n.kernel.read(),c,n.strides,n.padding);return"channelsLast"!==n.dataFormat&&(h=Object(i.transpose)(h,[0,3,1,2])),null!=n.bias&&(h=kt(h,n.bias.read(),n.dataFormat)),null!=n.activation&&(h=n.activation.apply(h)),h}))},e.prototype.computeOutputShape=function(t){var e,n,r,i=(t=re(t)).slice();"channelsFirst"===this.dataFormat?(e=1,n=2,r=3):(e=3,n=1,r=2);var o=this.kernelSize[0],a=this.kernelSize[1],s=this.strides[0],u=this.strides[1];return i[e]=this.filters,i[n]=mr(i[n],s,o,this.padding),i[r]=mr(i[r],u,a,this.padding),i},e.prototype.getConfig=function(){var e=t.prototype.getConfig.call(this);return delete e.dilationRate,e},e.className="Conv2DTranspose",e}(xr);i.serialization.registerClass(Cr);var kr=function(t){function e(e){return t.call(this,2,e)||this}return a(e,t),e.className="SeparableConv2D",e}(function(t){function e(e,n){var r=t.call(this,e,n)||this;if(r.DEFAULT_DEPTHWISE_INITIALIZER="glorotUniform",r.DEFAULT_POINTWISE_INITIALIZER="glorotUniform",r.depthwiseKernel=null,r.pointwiseKernel=null,null==n.filters)throw new p("The `filters` configuration field is required by SeparableConv, but is unspecified.");if(null!=n.kernelInitializer||null!=n.kernelRegularizer||null!=n.kernelConstraint)throw new p("Fields kernelInitializer, kernelRegularizer and kernelConstraint are invalid for SeparableConv2D. Use depthwiseInitializer, depthwiseRegularizer, depthwiseConstraint, pointwiseInitializer, pointwiseRegularizer and pointwiseConstraint instead.");if(null!=n.padding&&"same"!==n.padding&&"valid"!==n.padding)throw new p("SeparableConv"+r.rank+"D supports only padding modes: 'same' and 'valid', but received "+JSON.stringify(n.padding));return r.depthMultiplier=null==n.depthMultiplier?1:n.depthMultiplier,r.depthwiseInitializer=Xt(n.depthwiseInitializer||r.DEFAULT_DEPTHWISE_INITIALIZER),r.depthwiseRegularizer=ar(n.depthwiseRegularizer),r.depthwiseConstraint=V(n.depthwiseConstraint),r.pointwiseInitializer=Xt(n.depthwiseInitializer||r.DEFAULT_POINTWISE_INITIALIZER),r.pointwiseRegularizer=ar(n.pointwiseRegularizer),r.pointwiseConstraint=V(n.pointwiseConstraint),r}return a(e,t),e.prototype.build=function(t){var e;if((t=re(t)).length<this.rank+2)throw new p("Inputs to SeparableConv"+this.rank+"D should have rank "+(this.rank+2)+", but received input shape: "+JSON.stringify(t));var n="channelsFirst"===this.dataFormat?1:t.length-1;if(null==t[n]||t[n]<0)throw new p("The channel dimension of the inputs should be defined, but found "+JSON.stringify(t[n]));for(var r=t[n],i=this.kernelSize.concat([r,this.depthMultiplier]),o=[],a=0;a<this.rank;++a)o.push(1);o.push(r*this.depthMultiplier,this.filters),this.depthwiseKernel=this.addWeight("depthwise_kernel",i,"float32",this.depthwiseInitializer,this.depthwiseRegularizer,!0,this.depthwiseConstraint),this.pointwiseKernel=this.addWeight("pointwise_kernel",o,"float32",this.pointwiseInitializer,this.pointwiseRegularizer,!0,this.pointwiseConstraint),this.bias=this.useBias?this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):null,this.inputSpec=[new ce({ndim:this.rank+2,axes:(e={},e[n]=r,e)})],this.built=!0},e.prototype.call=function(t,e){var n=this;return Object(i.tidy)((function(){var e;if(t=ne(t),1===n.rank)throw new m("1D separable convolution is not implemented yet.");return 2===n.rank&&("channelsFirst"===n.dataFormat&&(t=Object(i.transpose)(t,[0,2,3,1])),e=Object(i.separableConv2d)(t,n.depthwiseKernel.read(),n.pointwiseKernel.read(),n.strides,n.padding,n.dilationRate,"NHWC")),n.useBias&&(e=kt(e,n.bias.read(),n.dataFormat)),null!=n.activation&&(e=n.activation.apply(e)),"channelsFirst"===n.dataFormat&&(e=Object(i.transpose)(e,[0,3,1,2])),e}))},e.prototype.getConfig=function(){var e=t.prototype.getConfig.call(this);return delete e.rank,delete e.kernelInitializer,delete e.kernelRegularizer,delete e.kernelConstraint,e.depthwiseInitializer=Gt(this.depthwiseInitializer),e.pointwiseInitializer=Gt(this.pointwiseInitializer),e.depthwiseRegularizer=ir(this.depthwiseRegularizer),e.pointwiseRegularizer=ir(this.pointwiseRegularizer),e.depthwiseConstraint=U(this.depthwiseConstraint),e.pointwiseConstraint=U(this.pointwiseConstraint),e},e.className="SeparableConv",e}(wr));i.serialization.registerClass(kr);var Sr=function(t){function e(n){var r=t.call(this,1,n)||this;return e.verifyArgs(n),r.inputSpec=[{ndim:3}],r}return a(e,t),e.prototype.getConfig=function(){var e=t.prototype.getConfig.call(this);return delete e.rank,delete e.dataFormat,e},e.verifyArgs=function(t){if("number"!=typeof t.kernelSize&&!D(t.kernelSize,"number",1,1))throw new p("Conv1D expects config.kernelSize to be number or number[] with length 1, but received "+JSON.stringify(t.kernelSize)+".")},e.className="Conv1D",e}(wr);i.serialization.registerClass(Sr);var Er=function(t){function e(e){var n=t.call(this,e)||this;return n.cropping="number"==typeof e.cropping?[[e.cropping,e.cropping],[e.cropping,e.cropping]]:"number"==typeof e.cropping[0]?[[e.cropping[0],e.cropping[0]],[e.cropping[1],e.cropping[1]]]:e.cropping,n.dataFormat=void 0===e.dataFormat?"channelsLast":e.dataFormat,n.inputSpec=[{ndim:4}],n}return a(e,t),e.prototype.computeOutputShape=function(t){return"channelsFirst"===this.dataFormat?[t[0],t[1],t[2]-this.cropping[0][0]-this.cropping[0][1],t[3]-this.cropping[1][0]-this.cropping[1][1]]:[t[0],t[1]-this.cropping[0][0]-this.cropping[0][1],t[2]-this.cropping[1][0]-this.cropping[1][1],t[3]]},e.prototype.call=function(t,e){var n=this;return Object(i.tidy)((function(){return t=ne(t),"channelsLast"===n.dataFormat?mt(mt(t,n.cropping[0][0],t.shape[1]-n.cropping[0][0]-n.cropping[0][1],2),n.cropping[1][0],t.shape[2]-n.cropping[1][1]-n.cropping[1][0],3):mt(mt(t,n.cropping[0][0],t.shape[2]-n.cropping[0][0]-n.cropping[0][1],3),n.cropping[1][0],t.shape[3]-n.cropping[1][1]-n.cropping[1][0],4)}))},e.prototype.getConfig=function(){var e={cropping:this.cropping,dataFormat:this.dataFormat},n=t.prototype.getConfig.call(this);return Object.assign(e,n),e},e.className="Cropping2D",e}(me);i.serialization.registerClass(Er);var Or=function(t){function e(e){var n=t.call(this,e)||this;return n.DEFAULT_SIZE=[2,2],n.inputSpec=[{ndim:4}],n.size=null==e.size?n.DEFAULT_SIZE:e.size,n.dataFormat=null==e.dataFormat?"channelsLast":e.dataFormat,n}return a(e,t),e.prototype.computeOutputShape=function(t){if("channelsFirst"===this.dataFormat){var e=null==t[2]?null:this.size[0]*t[2],n=null==t[3]?null:this.size[1]*t[3];return[t[0],t[1],e,n]}return[t[0],e=null==t[1]?null:this.size[0]*t[1],n=null==t[2]?null:this.size[1]*t[2],t[3]]},e.prototype.call=function(t,e){var n=this;return Object(i.tidy)((function(){var e=ne(t),r=e.shape;if("channelsFirst"===n.dataFormat){e=Object(i.transpose)(e,[0,2,3,1]);var o=n.size[0]*r[2],a=n.size[1]*r[3],s=e.resizeNearestNeighbor([o,a]);return Object(i.transpose)(s,[0,3,1,2])}return e.resizeNearestNeighbor([o=n.size[0]*r[1],a=n.size[1]*r[2]])}))},e.prototype.getConfig=function(){var e={size:this.size,dataFormat:this.dataFormat},n=t.prototype.getConfig.call(this);return Object.assign(e,n),e},e.className="UpSampling2D",e}(me);i.serialization.registerClass(Or);var Ar=function(t){function e(e){var n=t.call(this,2,e)||this;return n.depthwiseKernel=null,n.depthMultiplier=null==e.depthMultiplier?1:e.depthMultiplier,n.depthwiseInitializer=Xt(e.depthwiseInitializer||n.DEFAULT_KERNEL_INITIALIZER),n.depthwiseConstraint=V(e.depthwiseConstraint),n.depthwiseRegularizer=ar(e.depthwiseRegularizer),n}return a(e,t),e.prototype.build=function(t){if((t=re(t)).length<4)throw new p("Inputs to DepthwiseConv2D should have rank 4. Received input shape: "+JSON.stringify(t)+".");var e="channelsFirst"===this.dataFormat?1:3;if(null==t[e]||t[e]<0)throw new p("The channel dimension of the inputs to DepthwiseConv2D should be defined, but is not ("+t[e]+").");var n=t[e];this.depthwiseKernel=this.addWeight("depthwise_kernel",[this.kernelSize[0],this.kernelSize[1],n,this.depthMultiplier],null,this.depthwiseInitializer,this.depthwiseRegularizer,!0,this.depthwiseConstraint),this.bias=this.useBias?this.addWeight("bias",[n*this.depthMultiplier],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):null,this.built=!0},e.prototype.call=function(t,e){var n=this;return Object(i.tidy)((function(){var e=function(t,e,n,r,o,a){return void 0===n&&(n=[1,1]),void 0===r&&(r="valid"),Object(i.tidy)((function(){null==o&&(o="channelsLast"),Y(o);var a=gr(t,o);if(4!==t.rank)throw new p("Input for depthwiseConv2d is required to be 4-D, but is instead "+t.rank+"-D");if(4!==e.rank)throw new p("depthwiseKernel is required to be 4-D, but is instead "+e.rank+"-D");return a=Object(i.depthwiseConv2d)(a,e,n,"same"===r?"same":"valid","NHWC",null),"channelsFirst"===o&&(a=Object(i.transpose)(a,[0,3,1,2])),a}))}(t=ne(t),n.depthwiseKernel.read(),n.strides,n.padding,n.dataFormat);return n.useBias&&(e=kt(e,n.bias.read(),n.dataFormat)),null!=n.activation&&(e=n.activation.apply(e)),e}))},e.prototype.computeOutputShape=function(t){t=re(t);var e="channelsFirst"===this.dataFormat?t[3]:t[2],n="channelsFirst"===this.dataFormat?t[1]*this.depthMultiplier:t[3]*this.depthMultiplier,r=pr("channelsFirst"===this.dataFormat?t[2]:t[1],this.kernelSize[0],this.padding,this.strides[0]),i=pr(e,this.kernelSize[1],this.padding,this.strides[1]);return"channelsFirst"===this.dataFormat?[t[0],n,r,i]:[t[0],r,i,n]},e.prototype.getConfig=function(){var e=t.prototype.getConfig.call(this);return e.depthMultiplier=this.depthMultiplier,e.depthwiseInitializer=Gt(this.depthwiseInitializer),e.depthwiseRegularizer=ir(this.depthwiseRegularizer),e.depthwiseConstraint=U(this.depthwiseRegularizer),e},e.className="DepthwiseConv2D",e}(br);i.serialization.registerClass(Ar);var Nr=function(t){function e(e){var n=t.call(this,e)||this;return n.rate=Math.max(Math.min(e.rate,1),0),n.noiseShape=e.noiseShape,n.seed=e.seed,n.supportsMasking=!0,n}return a(e,t),e.prototype.getNoiseShape=function(t){if(null==this.noiseShape)return this.noiseShape;for(var e=t.shape,n=[],r=0;r<this.noiseShape.length;++r)n.push(null==this.noiseShape[r]?e[r]:this.noiseShape[r]);return n},e.prototype.call=function(t,e){var n=this;return Object(i.tidy)((function(){n.invokeCallHook(t,e);var r=ne(t);if(0<n.rate&&n.rate<1){var i=null!=e.training&&e.training,o=n.getNoiseShape(r);return Et((function(){return St(r,n.rate,o,n.seed)}),(function(){return r}),i)}return t}))},e.prototype.getConfig=function(){var e={rate:this.rate,noiseShape:this.noiseShape,seed:this.seed},n=t.prototype.getConfig.call(this);return Object.assign(e,n),e},e.prototype.dispose=function(){return t.prototype.dispose.call(this)},e.className="Dropout",e}(me);i.serialization.registerClass(Nr);var Tr=function(t){function e(e){var n=t.call(this,e)||this;if(n.activation=null,n.useBias=!0,n.kernel=null,n.bias=null,n.DEFAULT_KERNEL_INITIALIZER="glorotNormal",n.DEFAULT_BIAS_INITIALIZER="zeros",null==e.batchInputShape&&null==e.inputShape&&null!=e.inputDim){var r=null;null!=e.batchSize&&(r=e.batchSize),n.batchInputShape=[r,e.inputDim]}return n.units=e.units,R(n.units,"units"),n.activation=Jn(e.activation),null!=e.useBias&&(n.useBias=e.useBias),n.kernelInitializer=Xt(e.kernelInitializer||n.DEFAULT_KERNEL_INITIALIZER),n.biasInitializer=Xt(e.biasInitializer||n.DEFAULT_BIAS_INITIALIZER),n.kernelConstraint=V(e.kernelConstraint),n.biasConstraint=V(e.biasConstraint),n.kernelRegularizer=ar(e.kernelRegularizer),n.biasRegularizer=ar(e.biasRegularizer),n.activityRegularizer=ar(e.activityRegularizer),n.supportsMasking=!0,n.inputSpec=[{minNDim:2}],n}return a(e,t),e.prototype.build=function(t){var e,n=(t=re(t))[t.length-1];null==this.kernel&&(this.kernel=this.addWeight("kernel",[n,this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint))),this.inputSpec=[{minNDim:2,axes:(e={},e[-1]=n,e)}],this.built=!0},e.prototype.computeOutputShape=function(t){var e=(t=re(t)).slice();return e[e.length-1]=this.units,e},e.prototype.call=function(t,e){var n=this;return Object(i.tidy)((function(){n.invokeCallHook(t,e);var r,i=ne(t),o=I(n.activation.getClassName());return null!=o?r=wt(i,n.kernel.read(),o,n.bias?n.bias.read():null):(r=wt(i,n.kernel.read()),null!=n.bias&&(r=kt(r,n.bias.read())),null!=n.activation&&(r=n.activation.apply(r))),r}))},e.prototype.getConfig=function(){var e={units:this.units,activation:Zn(this.activation),useBias:this.useBias,kernelInitializer:Gt(this.kernelInitializer),biasInitializer:Gt(this.biasInitializer),kernelRegularizer:ir(this.kernelRegularizer),biasRegularizer:ir(this.biasRegularizer),activityRegularizer:ir(this.activityRegularizer),kernelConstraint:U(this.kernelConstraint),biasConstraint:U(this.biasConstraint)},n=t.prototype.getConfig.call(this);return Object.assign(e,n),e},e.className="Dense",e}(me);i.serialization.registerClass(Tr);var Dr=function(t){function e(e){var n=t.call(this,e||{})||this;return n.inputSpec=[{minNDim:3}],n}return a(e,t),e.prototype.computeOutputShape=function(t){for(var e=0,n=(t=re(t)).slice(1);e<n.length;e++)if(null==n[e])throw new p('The shape of the input to "Flatten" is not fully defined (got '+t.slice(1)+'). Make sure to pass a complete "input_shape" or "batch_input_shape" argument to the first layer in your model.');return[t[0],at(t,1)]},e.prototype.call=function(t,e){var n=this;return Object(i.tidy)((function(){return n.invokeCallHook(t,e),function(t){if(t.rank<=1)throw new p("batchFlatten requires a minimum rank of 2. Got rank: "+t.rank+".");var e=[t.shape[0],at(t.shape,1)];return t.reshape(e)}(ne(t))}))},e.className="Flatten",e}(me);i.serialization.registerClass(Dr);var Rr=function(t){function e(e){var n=t.call(this,e)||this;return n.supportsMasking=!0,n.activation=Jn(e.activation),n}return a(e,t),e.prototype.call=function(t,e){var n=this;return Object(i.tidy)((function(){n.invokeCallHook(t,e);var r=ne(t);return n.activation.apply(r)}))},e.prototype.getConfig=function(){var e={activation:Zn(this.activation)},n=t.prototype.getConfig.call(this);return Object.assign(e,n),e},e.className="Activation",e}(me);i.serialization.registerClass(Rr);var Ir=function(t){function e(e){var n=t.call(this,e)||this;return n.n=e.n,n.inputSpec=[{ndim:2}],n}return a(e,t),e.prototype.computeOutputShape=function(t){return[t[0],this.n,t[1]]},e.prototype.call=function(t,e){var n=this;return Object(i.tidy)((function(){return function(t,e){return Object(i.tidy)((function(){if(2!==t.shape.length)throw new p("repeat() expects a rank-2 tensor, but received a rank-"+t.shape.length+" tensor.");return vt(dt(t,1),[1,e,1])}))}(t=ne(t),n.n)}))},e.prototype.getConfig=function(){var e={n:this.n},n=t.prototype.getConfig.call(this);return Object.assign(e,n),e},e.className="RepeatVector",e}(me);i.serialization.registerClass(Ir);var Mr=function(t){function e(e){var n=t.call(this,e)||this;n.targetShape=e.targetShape;for(var r=0;r<n.targetShape.length;++r)n.isUnknown(n.targetShape[r])&&(n.targetShape[r]=null);return n}return a(e,t),e.prototype.isUnknown=function(t){return t<0||null==t},e.prototype.fixUnknownDimension=function(t,e){for(var n="Total size of new array must be unchanged.",r=e.slice(),i=1,o=null,a=0;a<r.length;++a){var s=r[a];if(this.isUnknown(s)){if(null!==o)throw new p("Can only specifiy one unknown dimension.");o=a}else i*=s}var u=at(t);if(null!==o){if(0===i||u%i!=0)throw new p(n);r[o]=u/i}else if(u!==i)throw new p(n);return r},e.prototype.computeOutputShape=function(t){for(var e=!1,n=0;n<t.length;++n)if(this.isUnknown(t[n])){e=!0;break}return e?t.slice(0,1).concat(this.targetShape):t.slice(0,1).concat(this.fixUnknownDimension(t.slice(1),this.targetShape))},e.prototype.call=function(t,e){var n=this;return Object(i.tidy)((function(){n.invokeCallHook(t,e);var r=ne(t),i=r.shape,o=i.slice(0,1).concat(n.fixUnknownDimension(i.slice(1),n.targetShape));return r.reshape(o)}))},e.prototype.getConfig=function(){var e={targetShape:this.targetShape},n=t.prototype.getConfig.call(this);return Object.assign(e,n),e},e.className="Reshape",e}(me);i.serialization.registerClass(Mr);var Fr=function(t){function e(e){var n=t.call(this,e)||this;if(null==e.dims)throw new Error("Required configuration field `dims` is missing during Permute constructor call.");if(!Array.isArray(e.dims))throw new Error("Permute constructor requires `dims` to be an Array, but received "+e.dims+" instead.");var r=ct(1,e.dims.length+1);if(!i.util.arraysEqual(e.dims.slice().sort(),r))throw new Error("Invalid permutation `dims`: "+JSON.stringify(e.dims)+" `dims` must contain consecutive integers starting from 1.");return n.dims=e.dims,n.dimsIncludingBatch=[0].concat(n.dims),n.inputSpec=[new ce({ndim:n.dims.length+1})],n}return a(e,t),e.prototype.computeOutputShape=function(t){var e=(t=re(t)).slice();return this.dims.forEach((function(n,r){e[r+1]=t[n]})),e},e.prototype.call=function(t,e){return Object(i.transpose)(ne(t),this.dimsIncludingBatch)},e.prototype.getConfig=function(){var e={dims:this.dims},n=t.prototype.getConfig.call(this);return Object.assign(e,n),e},e.className="Permute",e}(me);i.serialization.registerClass(Fr);var Pr=function(t){function e(e){var n=t.call(this,null==e?{}:e)||this;return n.supportsMasking=!0,n.maskValue=null!=e?null==e.maskValue?0:e.maskValue:0,n}return a(e,t),e.prototype.computeOutputShape=function(t){return t},e.prototype.getConfig=function(){var e=t.prototype.getConfig.call(this),n={maskValue:this.maskValue};return Object.assign(n,e),n},e.prototype.computeMask=function(t,e){var n=ne(t);return Object(i.any)(Object(i.notEqual)(n,this.maskValue),-1)},e.prototype.call=function(t,e){var n=this;return Object(i.tidy)((function(){n.invokeCallHook(t,e);var r=ne(t),o=Object(i.any)(Object(i.notEqual)(r,n.maskValue),-1,!0);return r.mul(o.asType(r.dtype))}))},e.className="Masking",e}(me);i.serialization.registerClass(Pr);var jr=function(t){function e(e){var n=t.call(this,e)||this;if(n.embeddings=null,n.DEFAULT_EMBEDDINGS_INITIALIZER="randomUniform",null==e.batchInputShape&&null==e.inputShape){var r=null;null!=e.batchSize&&(r=e.batchSize),n.batchInputShape=null==e.inputLength?[r,null]:[r].concat(x(e.inputLength))}return n.inputDim=e.inputDim,R(n.inputDim,"inputDim"),n.outputDim=e.outputDim,R(n.outputDim,"outputDim"),n.embeddingsInitializer=Xt(e.embeddingsInitializer||n.DEFAULT_EMBEDDINGS_INITIALIZER),n.embeddingsRegularizer=ar(e.embeddingsRegularizer),n.activityRegularizer=ar(e.activityRegularizer),n.embeddingsConstraint=V(e.embeddingsConstraint),n.maskZero=e.maskZero,n.supportsMasking=e.maskZero,n.inputLength=e.inputLength,n}return a(e,t),e.prototype.build=function(t){this.embeddings=this.addWeight("embeddings",[this.inputDim,this.outputDim],this.dtype,this.embeddingsInitializer,this.embeddingsRegularizer,!0,this.embeddingsConstraint),this.built=!0},e.prototype.warnOnIncompatibleInputShape=function(t){},e.prototype.computeMask=function(t,e){var n=this;return Object(i.tidy)((function(){return n.maskZero?(t=ne(t),Object(i.notEqual)(t,Object(i.zerosLike)(t))):null}))},e.prototype.computeOutputShape=function(t){if(t=re(t),null==this.inputLength)return t.concat([this.outputDim]);var e=x(this.inputLength);if(e.length!==t.length-1)throw new p('"inputLength" is '+this.inputLength+", but received input shape has shape "+t);for(var n=0,r=0;r<e.length;++r){var i=e[r],o=t[r+1];if(null!=i&&null!=o&&i!==o)throw new p('"inputLength" is '+this.inputLength+", but received input shape has shape "+t);null==i&&(e[n]=o),n++}return[t[0]].concat(e,[this.outputDim])},e.prototype.call=function(t,e){var n=this;return Object(i.tidy)((function(){n.invokeCallHook(t,e);var r=ne(t);return"int32"!==r.dtype&&(r=ht(r,"int32")),xt(n.embeddings.read(),r.as1D()).reshape(re(n.computeOutputShape(r.shape)))}))},e.prototype.getConfig=function(){var e={inputDim:this.inputDim,outputDim:this.outputDim,embeddingsInitializer:Gt(this.embeddingsInitializer),embeddingsRegularizer:ir(this.embeddingsRegularizer),activityRegularizer:ir(this.activityRegularizer),embeddingsConstraint:U(this.embeddingsConstraint),maskZero:this.maskZero,inputLength:this.inputLength},n=t.prototype.getConfig.call(this);return Object.assign(e,n),e},e.className="Embedding",e}(me);i.serialization.registerClass(jr);var zr=function(t){function e(e){var n=t.call(this,e||{})||this;return n.supportsMasking=!0,n}return a(e,t),e.prototype.mergeFunction=function(t){throw new m},e.prototype.computeElementwiseOpOutputShape=function(t,e){if(null==t||null==e)return null;if(t.length<e.length)return this.computeElementwiseOpOutputShape(e,t);if(0===e.length)return t;for(var n=t.slice(0,t.length-e.length),r=0;r<e.length;++r){var i=t[t.length-e.length+r],o=e[r];if(null==i||null==o||i<0||o<0)n.push(null);else if(1===i)n.push(o);else if(1===o)n.push(i);else{if(i!==o)throw new p("Operands could not be broadcast together with shapes "+JSON.stringify(t)+" "+JSON.stringify(e));n.push(i)}}return n},e.prototype.build=function(t){if(Array.isArray(t)&&!Array.isArray(t[0])&&(t=[re(t)]),(t=t).length<2)throw new p("A merge layer should be called on an Array of at least 2 inputs. Got "+t.length+" input(s).");for(var e=[],n=0,r=t;n<r.length;n++)null!=(a=r[n])&&null!==a[0]&&e.push(a[0]);if((e=A(e)).length>1)throw new p("Can not merge tensors with different batch sizes. Got tensors with shapes: "+JSON.stringify(t)+".");for(var i=null==t[0]?null:t[0].slice(1),o=1;o<t.length;++o){var a=null==t[o]?null:t[o].slice(1);i=this.computeElementwiseOpOutputShape(i,a)}var s=t.map((function(t){return t.length}));this.reshapeRequired=-1!==t.indexOf(null)||1!==A(s).length},e.prototype.call=function(t,e){var n=this;return Object(i.tidy)((function(){if(t=t,n.reshapeRequired){var e=[],r=t.map((function(t){return t.rank}));if(-1===r.indexOf(null)){for(var o=lt(r),a=0,s=t;a<s.length;a++){for(var u=(f=s[a]).rank,l=0;l<o-u;++l)f=dt(f,1);e.push(f)}return n.mergeFunction(e)}for(var c=!1,h=0,d=t;h<d.length;h++){var f;if(null==(u=(f=d[h]).rank)){var p=f.shape,m=p[0],g=p.slice(1).concat([m]),y=f.reshape([m].concat(at(p.slice(1))));y=(y=Object(i.transpose)(y,[1,0])).reshape(g),e.push(y),c=!0}else if(u>1){var v=ct(1,u).concat([0]);e.push(Object(i.transpose)(f,v)),c=!0}else e.push(f)}var b=n.mergeFunction(e),w=b.rank;if(c)if(null==w){var x=b.shape;g=[m=x[x.length-1]].concat(x.slice(0,x.length-1)),b=Object(i.transpose)(b.reshape([-1,m]),[1,0]).reshape(g)}else w>1&&(v=[w-1].concat(ct(0,w-1)),b=Object(i.transpose)(b,v));return b}return n.mergeFunction(t)}))},e.prototype.computeOutputShape=function(t){var e;e=null==(t=t)[0]?null:t[0].slice(1);for(var n=1;n<t.length;++n){var r=null==t[n]?null:t[n].slice(1);e=this.computeElementwiseOpOutputShape(e,r)}for(var i=[],o=0,a=t;o<a.length;o++)null!=(r=a[o])&&null!==r[0]&&i.push(r[0]);return 1===(i=A(i)).length?i.concat(e):[null].concat(e)},e.prototype.computeMask=function(t,e){return Object(i.tidy)((function(){if(null==e)return null;if(!Array.isArray(e))throw new p("`mask` should be an Array");if(!Array.isArray(t))throw new p("`inputs` should be an Array");if(e.length!==t.length)throw new p("The Array 'inputs' and 'mask' are expected to have the same length, but have different lengths ("+t.length+" vs "+e.length+")");if(e.every((function(t){return null==t})))return null;for(var n=(e=e.map((function(t){return null==t?t:Object(i.expandDims)(t,0)})))[0],r=1;r<e.length-1;++r)n=Object(i.logicalAnd)(n,e[r]);return n}))},e}(me),Lr=function(t){function e(e){return t.call(this,e)||this}return a(e,t),e.prototype.mergeFunction=function(t){return Object(i.tidy)((function(){for(var e=t[0].clone(),n=1;n<t.length;++n)e=Object(i.add)(e,t[n]);return e}))},e.className="Add",e}(zr);i.serialization.registerClass(Lr);var Br=function(t){function e(e){return t.call(this,e)||this}return a(e,t),e.prototype.mergeFunction=function(t){return Object(i.tidy)((function(){for(var e=t[0].clone(),n=1;n<t.length;++n)e=Object(i.mul)(e,t[n]);return e}))},e.className="Multiply",e}(zr);i.serialization.registerClass(Br);var Ur=function(t){function e(e){return t.call(this,e)||this}return a(e,t),e.prototype.mergeFunction=function(t){return Object(i.tidy)((function(){for(var e=t[0].clone(),n=1;n<t.length;++n)e=Object(i.add)(e,t[n]);return Object(i.mul)(1/t.length,e)}))},e.className="Average",e}(zr);i.serialization.registerClass(Ur);var $r=function(t){function e(e){return t.call(this,e)||this}return a(e,t),e.prototype.mergeFunction=function(t){return Object(i.tidy)((function(){for(var e=t[0],n=1;n<t.length;++n)e=Object(i.maximum)(e,t[n]);return e}))},e.className="Maximum",e}(zr);i.serialization.registerClass($r);var Vr=function(t){function e(e){return t.call(this,e)||this}return a(e,t),e.prototype.mergeFunction=function(t){return Object(i.tidy)((function(){for(var e=t[0],n=1;n<t.length;++n)e=Object(i.minimum)(e,t[n]);return e}))},e.className="Minimum",e}(zr);i.serialization.registerClass(Vr);var Wr=function(t){function e(e){var n=t.call(this,e)||this;return n.DEFAULT_AXIS=-1,null==e&&(e={}),n.axis=null==e.axis?n.DEFAULT_AXIS:e.axis,n.supportsMasking=!0,n.reshapeRequired=!1,n}return a(e,t),e.prototype.build=function(t){if(!Array.isArray(t)||!Array.isArray(t[0])||1===t.length)throw new p("A `Concatenate` layer should be called on a list of at least 2 inputs");for(var e=!0,n=0,r=t=t;n<r.length;n++)if(null!=(h=r[n])){e=!1;break}if(!e){for(var o=[],a=0;a<t.length;++a){var s=t[a].slice();s.splice(this.axis,1);for(var u=!1,l=0,c=o;l<c.length;l++){var h=c[l];if(i.util.arraysEqual(h,s)){u=!0;break}}u||o.push(s)}if(o.length>1)throw new p("A `Concatenate` layer requires inputs with matching shapes except for the concat axis. Got input shapes: "+JSON.stringify(t))}},e.prototype.mergeFunction=function(t){var e=this;return Object(i.tidy)((function(){return gt(t,e.axis)}))},e.prototype.computeOutputShape=function(t){if(!Array.isArray(t)||!Array.isArray(t[0]))throw new p("A `Concatenate` layer should be called on a list of inputs.");for(var e=t,n=e[0].slice(),r=this.axis<0?n.length+this.axis:this.axis,i=0,o=e.slice(1);i<o.length;i++){var a=o[i];if(null==n[r]||null==a[r]){n[r]=null;break}n[r]+=a[r]}return n},e.prototype.computeMask=function(t,e){var n=this;if(null==e)return null;if(!Array.isArray(e))throw new p("`mask` should be an array for Concatenate");if(!Array.isArray(t))throw new p("`inputs` should be an array for Concatenate");if(e.length!==t.length)throw new p("Mismatch in the length of mask ("+e.length+") and the legnth of inputs ("+t.length+")");return Object(i.tidy)((function(){var r=!0;if(e.forEach((function(t){null==t||(r=!1)})),r)return null;for(var o=[],a=0;a<t.length;++a)o.push(null==e[a]?Object(i.onesLike)(t[a]).asType("bool"):e[a].rank<t[a].rank?Object(i.expandDims)(e[a],-1):e[a]);var s=Object(i.concat)(o,n.axis);return Object(i.all)(s,-1,!1)}))},e.prototype.getConfig=function(){var e={axis:this.axis},n=t.prototype.getConfig.call(this);return Object.assign(e,n),e},e.className="Concatenate",e}(zr);function qr(t,e){for(;t<0;)t+=e;return t}i.serialization.registerClass(Wr);var Hr=function(t){function e(e){var n=t.call(this,e)||this;return n.axes=e.axes,n.normalize=null!=e.normalize&&e.normalize,n.supportsMasking=!0,n.reshapeRequired=!1,n}return a(e,t),e.prototype.build=function(t){i.util.assert(Array.isArray(t)&&2===t.length&&Array.isArray(t[0])&&Array.isArray(t[1]),(function(){return"A `Dot` layer should be called on a list of exactly 2 inputs."}));var e=t[0],n=t[1];if(e.length>3||n.length>3)throw new m("Dot layer does not support tensors of 4D or higher rank yet.");var r=this.interpretAxes(e,n);if(e[r[0]]!==n[r[1]])throw new p("Dimension incompatibility: "+e[r[0]]+" !== "+n[r[1]])},e.prototype.mergeFunction=function(t){if(2!==t.length)throw new p("A `Dot` layer must be called on exactly 2 inputs, but received "+t.length+" input(s).");var e,n=t[0],r=t[1];return e=Array.isArray(this.axes)?this.axes.map((function(e,n){return qr(e,t[n].shape.length)})):[qr(this.axes,n.shape.length),qr(this.axes,r.shape.length)],this.normalize&&(n=Ne(n,e[0]),r=Ne(r,e[1])),function(t,e,n){if(t.shape.length>3||e.shape.length>3)throw new m("batchDot is not implemented for tensors of 4D or higher rank yet");if(i.util.assert(t.shape.length>=2,(function(){return"batchDot requires the rank of x to be >= 2, but got "+t.shape.length})),i.util.assert(t.shape.length>=2,(function(){return"batchDot requires the rank of y to be >= 2, but got "+e.shape.length})),"number"==typeof n&&(n=[n,n]),"complex64"===t.dtype||"complex64"===e.dtype)throw new m("batchDot is not implemented for complex64-type Tensors yet.");var r=t.shape.length,o=e.shape.length;null==n&&(n=[r-1,o-2]);var a=n;return Object(i.tidy)((function(){var n,i;if(r>o){n=r-o;for(var s=[],u=0;u<n;++u)s.push(1);e=e.reshape(e.shape.concat(s))}else if(o>r){for(n=o-r,s=[],u=0;u<n;++u)s.push(1);t=t.reshape(t.shape.concat(s))}else n=0;if(i=2===t.shape.length&&2===e.shape.length?a[0]===a[1]?t.mulStrict(e).sum(a[0]):t.transpose([1,0]).mulStrict(e).sum(a[1]):t.matMul(e,a[0]!==t.shape.length-1,a[1]===e.shape.length-1),n>0){var l,c=[];for(u=l=r>o?r+o-3:r-1;u<l+n;++u)c.push(u);i=i.squeeze(c)}return 1===i.shape.length&&(i=i.expandDims(1)),i}))}(n,r,e)},e.prototype.interpretAxes=function(t,e){return Array.isArray(this.axes)?this.axes:[qr(this.axes,t.length),qr(this.axes,e.length)]},e.prototype.computeOutputShape=function(t){i.util.assert(Array.isArray(t)&&2===t.length&&Array.isArray(t[0])&&Array.isArray(t[1]),(function(){return"A `Dot` layer should be called on a list of exactly 2 inputs."}));var e=t[0].slice(),n=t[1].slice();if(e.length>3||n.length>3)throw new m("Dot layer does not support tensors of 4D or higher rank yet.");var r=this.interpretAxes(e,n);e.splice(r[0],1),n.splice(r[1],1),n.splice(0,1);var o=e.concat(n);return 1===o.length&&o.push(1),o},e.prototype.computeMask=function(t,e){return null},e.prototype.getConfig=function(){var e={axes:this.axes,normalize:this.normalize},n=t.prototype.getConfig.call(this);return Object.assign(e,n),e},e.className="Dot",e}(zr);i.serialization.registerClass(Hr);var Gr=function(t){function e(e){var n=t.call(this,e)||this;return n.supportsMasking=!0,n.stddev=e.stddev,n}return a(e,t),e.prototype.computeOutputShape=function(t){return t},e.prototype.getConfig=function(){var e=t.prototype.getConfig.call(this),n={stddev:this.stddev};return Object.assign(n,e),n},e.prototype.call=function(t,e){var n=this;return Object(i.tidy)((function(){n.invokeCallHook(t,e);var r=ne(t);return Et((function(){return bt(r.shape,0,n.stddev).add(r)}),(function(){return r}),e.training||!1)}))},e.className="GaussianNoise",e}(me);i.serialization.registerClass(Gr);var Xr=function(t){function e(e){var n=t.call(this,e)||this;return n.supportsMasking=!0,n.rate=e.rate,n}return a(e,t),e.prototype.computeOutputShape=function(t){return t},e.prototype.getConfig=function(){var e=t.prototype.getConfig.call(this),n={rate:this.rate};return Object.assign(n,e),n},e.prototype.call=function(t,e){var n=this;return Object(i.tidy)((function(){n.invokeCallHook(t,e);var r=ne(t);return n.rate>0&&n.rate<1?Et((function(){var t=Math.sqrt(n.rate/(1-n.rate));return r.mul(bt(r.shape,1,t))}),(function(){return r}),e.training||!1):r}))},e.className="GaussianDropout",e}(me);i.serialization.registerClass(Xr);var Kr=function(t){function e(e){var n=t.call(this,e)||this;return n.supportsMasking=!0,n.rate=e.rate,n.noiseShape=e.noiseShape,n}return a(e,t),e.prototype._getNoiseShape=function(t){return this.noiseShape||ne(t).shape},e.prototype.computeOutputShape=function(t){return t},e.prototype.getConfig=function(){var e=t.prototype.getConfig.call(this),n={rate:this.rate};return Object.assign(n,e),n},e.prototype.call=function(t,e){var n=this;return Object(i.tidy)((function(){if(n.rate<1&&n.rate>0){var r=n._getNoiseShape(t);return Et((function(){var e=ne(t),o=-1.7580993408473766,a=Object(i.greaterEqual)(Object(i.randomUniform)(r),n.rate);a=ht(a,"float32");var s=Math.pow((1-n.rate)*(1+n.rate*Math.pow(o,2)),-.5),u=-s*o*n.rate;return e.mul(a).add(a.add(-1).mul(o)).mul(s).add(u)}),(function(){return ne(t)}),e.training||!1)}return t}))},e.className="AlphaDropout",e}(me);function Yr(t,e,n,r,o,a){var s;if(void 0===a&&(a=.001),2===t.rank)s=Object(i.batchNorm2d)(t,e,n,r,o,a);else if(3===t.rank)s=Object(i.batchNorm3d)(t,e,n,r,o,a);else{if(4!==t.rank)throw new m("batchNormalization is not implemented for array of rank "+t.rank+" yet");s=Object(i.batchNorm4d)(t,e,n,r,o,a)}return s}i.serialization.registerClass(Kr);var Zr=function(t){function e(e){var n=this;return null==e&&(e={}),(n=t.call(this,e)||this).supportsMasking=!0,n.axis=null==e.axis?-1:e.axis,n.momentum=null==e.momentum?.99:e.momentum,n.epsilon=null==e.epsilon?.001:e.epsilon,n.center=null==e.center||e.center,n.scale=null==e.scale||e.scale,n.betaInitializer=Xt(e.betaInitializer||"zeros"),n.gammaInitializer=Xt(e.gammaInitializer||"ones"),n.movingMeanInitializer=Xt(e.movingMeanInitializer||"zeros"),n.movingVarianceInitializer=Xt(e.movingVarianceInitializer||"ones"),n.betaConstraint=V(e.betaConstraint),n.gammaConstraint=V(e.gammaConstraint),n.betaRegularizer=ar(e.betaRegularizer),n.gammaRegularizer=ar(e.gammaRegularizer),n}return a(e,t),e.prototype.build=function(t){var e;t=re(t);var n=this.axis>=0?this.axis:this.axis+t.length,r=t[n];if(null==r)throw new p("Axis "+n+" of input tensor should have a defined dimension but the layer received an input with shape "+JSON.stringify(t)+".");this.inputSpec=[new ce({ndim:t.length,axes:(e={},e[n]=r,e)})];var i=[r];this.scale&&(this.gamma=this.addWeight("gamma",i,null,this.gammaInitializer,this.gammaRegularizer,!0,this.gammaConstraint)),this.center&&(this.beta=this.addWeight("beta",i,null,this.betaInitializer,this.betaRegularizer,!0,this.betaConstraint)),this.movingMean=this.addWeight("moving_mean",i,null,this.movingMeanInitializer,null,!1),this.movingVariance=this.addWeight("moving_variance",i,null,this.movingVarianceInitializer,null,!1),this.built=!0},e.prototype.call=function(t,e){var n=this;return Object(i.tidy)((function(){var r=null!=e.training&&e.training,o=ne(t),a=o.shape,s=a.length,u=ct(0,s),l=n.axis>=0?n.axis:n.axis+s;u.splice(l,1);var c=y(1,s);c[l]=a[l];var h=u.slice();h.sort();var d=!i.util.arraysEqual(h,ct(0,s).slice(0,s-1));if(!r)return function(){if(d){var t=n.movingMean.read().reshape(c),e=n.movingVariance.read().reshape(c),r=n.center?n.beta.read().reshape(c):null,i=n.scale?n.gamma.read().reshape(c):null;return Yr(o,t,e,r,i,n.epsilon)}return Yr(o,n.movingMean.read(),n.movingVariance.read(),null==n.beta?null:n.beta.read(),null==n.gamma?null:n.gamma.read(),n.epsilon)}();var f=function(t,e,n,r,o){return void 0===o&&(o=.001),i.util.arraysEqual(r.slice().sort(),ct(0,t.rank-1))?function(t,e,n,r,o){return void 0===o&&(o=.001),Object(i.tidy)((function(){var a=Object(i.moments)(t,r),s=a.mean,u=a.variance;return[Yr(t,s,u,n,e,o),s,u]}))}(t,e,n,r,o):function(t,e,n,r,o){return void 0===o&&(o=.001),Object(i.tidy)((function(){for(var a=Object(i.moments)(t,r),s=a.mean,u=a.variance,l=[],c=0,h=ct(0,t.rank);c<h.length;c++){var d=h[c];-1!==r.indexOf(d)?l.push(1):l.push(t.shape[d])}var f=s.reshape(l),p=u.reshape(l),m=null==e?null:e.reshape(l),g=null==n?null:n.reshape(l);return[Yr(t,f,p,g,m,o),s,u]}))}(t,e,n,r,o)}(o,n.gamma.read(),n.beta.read(),u,n.epsilon),p=f[0],m=f[2],g=function(t,e,n){Object(i.tidy)((function(){var r=1-n,i=t.read(),o=i.sub(e).mul(r);t.write(i.sub(o))}))};return g(n.movingMean,f[1],n.momentum),g(n.movingVariance,m,n.momentum),p}))},e.prototype.getConfig=function(){var e={axis:this.axis,momentum:this.momentum,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:Gt(this.betaInitializer),gammaInitializer:Gt(this.gammaInitializer),movingMeanInitializer:Gt(this.movingMeanInitializer),movingVarianceInitializer:Gt(this.movingVarianceInitializer),betaRegularizer:ir(this.betaRegularizer),gammaRegularizer:ir(this.gammaRegularizer),betaConstraint:U(this.betaConstraint),gammaConstraint:U(this.gammaConstraint)},n=t.prototype.getConfig.call(this);return Object.assign(e,n),e},e.className="BatchNormalization",e}(me);i.serialization.registerClass(Zr);var Qr=function(t){function e(e){var n=this;if(null==e&&(e={}),(n=t.call(this,e)||this).axis=null==e.axis?-1:e.axis,"number"==typeof n.axis){if(!Number.isInteger(n.axis))throw new Error("Expected axis to be an integer, but received "+n.axis)}else{if(!Array.isArray(n.axis))throw new Error("Expected axis to be an integer or an array of integers, but received "+JSON.stringify(n.axis));for(var r=0,i=n.axis;r<i.length;r++)if(!Number.isInteger(i[r]))throw new Error("Expected axis to be an array of integers, but received "+JSON.stringify(n.axis))}return n.epsilon=null==e.epsilon?.001:e.epsilon,n.center=null==e.center||e.center,n.scale=null==e.scale||e.scale,n.betaInitializer=Xt(e.betaInitializer||"zeros"),n.gammaInitializer=Xt(e.gammaInitializer||"ones"),n.betaRegularizer=ar(e.betaRegularizer),n.gammaRegularizer=ar(e.gammaRegularizer),n.supportsMasking=!0,n}return a(e,t),e.prototype.build=function(t){var e=(t=re(t)).length;"number"==typeof this.axis&&(this.axis=[this.axis]);for(var n=0;n<this.axis.length;++n)this.axis[n]<0&&(this.axis[n]+=e);for(var r=0,i=this.axis;r<i.length;r++){var o=i[r];if(o<0||o>=e)throw new Error("Invalid axis: "+o)}if(this.axis.length!==A(this.axis).length)throw new Error("Found duplicate axes in: "+this.axis);var a=this.axis.map((function(e){return t[e]}));this.gamma=this.scale?this.addWeight("gamma",a,"float32",this.gammaInitializer,this.gammaRegularizer,!0):null,this.beta=this.center?this.addWeight("beta",a,"float32",this.betaInitializer,this.betaRegularizer,!0):null,this.built=!0},e.prototype.call=function(t,e){var n=this,r=ne(t),o=r.shape,a=o.length;return Object(i.tidy)((function(){for(var t=Object(i.moments)(r,n.axis,!0),e=t.mean,s=t.variance,u=y(1,a),l=0,c=n.axis;l<c.length;l++){var h=c[l];u[h]=o[h]}for(var d=function(t){return null!=t&&t.shape.length!==a&&n.axis!==[a-1]?t.reshape(u):t},f=d(n.gamma.read()),p=d(n.beta.read()),m=[],g=[],v=0;v<a;++v)-1!==n.axis.indexOf(v)?(m.push(o[v]),g.push(1)):(m.push(1),g.push(o[v]));return e=e.tile(m),s=s.tile(m),f=f.tile(g),p=p.tile(g),Yr(r,e,s,p,f,n.epsilon)}))},e.prototype.getConfig=function(){var e={axis:this.axis,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:Gt(this.betaInitializer),gammaInitializer:Gt(this.gammaInitializer),betaRegularizer:ir(this.betaRegularizer),gammaRegularizer:ir(this.gammaRegularizer)},n=t.prototype.getConfig.call(this);return Object.assign(e,n),e},e.className="BatchNormalization",e}(me);i.serialization.registerClass(Qr);var Jr=function(t){function e(e){var n=this;if(null==e&&(e={}),(n=t.call(this,e)||this).dataFormat=null==e.dataFormat?"channelsLast":e.dataFormat,null==e.padding)n.padding=[[1,1],[1,1]];else if("number"==typeof e.padding)n.padding=[[e.padding,e.padding],[e.padding,e.padding]];else{if(e.padding=e.padding,2!==e.padding.length)throw new p("ZeroPadding2D expects padding to be a length-2 array, but received a length-"+e.padding.length+" array.");var r=void 0,i=void 0;if("number"==typeof e.padding[0])r=[e.padding[0],e.padding[0]],i=[e.padding[1],e.padding[1]];else{if(e.padding=e.padding,2!==e.padding[0].length)throw new p("ZeroPadding2D expects height padding to be a length-2 array, but received a length-"+e.padding[0].length+" array.");if(r=e.padding[0],2!==e.padding[1].length)throw new p("ZeroPadding2D expects width padding to be a length-2 array, but received a length-"+e.padding[1].length+" array.");i=e.padding[1]}n.padding=[r,i]}return n.inputSpec=[new ce({ndim:4})],n}return a(e,t),e.prototype.computeOutputShape=function(t){return t=re(t),"channelsFirst"===this.dataFormat?[t[0],t[1],null!=t[2]&&t[2]>=0?t[2]+this.padding[0][0]+this.padding[0][1]:null,null!=t[3]&&t[3]>=0?t[3]+this.padding[1][0]+this.padding[1][1]:null]:[t[0],null!=t[1]&&t[1]>=0?t[1]+this.padding[0][0]+this.padding[0][1]:null,null!=t[2]&&t[2]>=0?t[2]+this.padding[1][0]+this.padding[1][1]:null,t[3]]},e.prototype.call=function(t,e){var n=this;return Object(i.tidy)((function(){return function(t,e,n){return Object(i.tidy)((function(){if(4!==t.rank)throw new p("temporalPadding expects input tensor to be 4-D, but received a "+t.rank+"-D tensor.");if(null==e&&(e=[[1,1],[1,1]]),2!==e.length||2!==e[0].length||2!==e[1].length)throw new p("spatial2dPadding expects `padding` to be an Array of two Arrays, each of which is an Array of two integers.");if(null==n&&(n="channelsLast"),"channelsLast"!==n&&"channelsFirst"!==n)throw new p("Unknown data format: "+n+". Supported data formats are 'channelsLast' and 'channelsFirst.");var r;return r="channelsFirst"===n?[[0,0],[0,0],e[0],e[1]]:[[0,0],e[0],e[1],[0,0]],Object(i.pad)(t,r)}))}(ne(t),n.padding,n.dataFormat)}))},e.prototype.getConfig=function(){var e={padding:this.padding,dataFormat:this.dataFormat},n=t.prototype.getConfig.call(this);return Object.assign(e,n),e},e.className="ZeroPadding2D",e}(me);function ti(t,e,n,r,o,a){return Object(i.tidy)((function(){var s;Y(o),Q(a),Z(r),null==n&&(n=[1,1]),null==r&&(r="valid"),null==o&&(o="channelsLast"),null==a&&(a="max"),t=gr(t,o);var u="same"===r?"same":"valid";return s="max"===a?Object(i.maxPool)(t,e,n,u):Object(i.avgPool)(t,e,n,u),"channelsFirst"===o&&(s=Object(i.transpose)(s,[0,3,1,2])),s}))}function ei(t,e,n,r,o,a){return Object(i.tidy)((function(){var s;Y(o),Q(a),Z(r),null==n&&(n=[1,1,1]),null==r&&(r="valid"),null==o&&(o="channelsLast"),null==a&&(a="max"),t=yr(t,o);var u="same"===r?"same":"valid";return s="max"===a?Object(i.maxPool3d)(t,e,n,u):Object(i.avgPool3d)(t,e,n,u),"channelsFirst"===o&&(s=Object(i.transpose)(s,[0,4,1,2,3])),s}))}i.serialization.registerClass(Jr);var ni=function(t){function e(e){var n=this;if(null==e.poolSize&&(e.poolSize=2),n=t.call(this,e)||this,"number"==typeof e.poolSize)n.poolSize=[e.poolSize];else{if(!Array.isArray(e.poolSize)||1!==e.poolSize.length||"number"!=typeof e.poolSize[0])throw new p("poolSize for 1D convolutional layer must be a number or an Array of a single number, but received "+JSON.stringify(e.poolSize));n.poolSize=e.poolSize}if(R(n.poolSize,"poolSize"),null==e.strides)n.strides=n.poolSize;else if("number"==typeof e.strides)n.strides=[e.strides];else{if(!Array.isArray(e.strides)||1!==e.strides.length||"number"!=typeof e.strides[0])throw new p("strides for 1D convolutional layer must be a number or an Array of a single number, but received "+JSON.stringify(e.strides));n.strides=e.strides}return R(n.strides,"strides"),n.padding=null==e.padding?"valid":e.padding,Z(n.padding),n.inputSpec=[new ce({ndim:3})],n}return a(e,t),e.prototype.computeOutputShape=function(t){var e=pr((t=re(t))[1],this.poolSize[0],this.padding,this.strides[0]);return[t[0],e,t[2]]},e.prototype.call=function(t,e){var n=this;return Object(i.tidy)((function(){n.invokeCallHook(t,e),t=dt(ne(t),2);var r=n.poolingFunction(ne(t),[n.poolSize[0],1],[n.strides[0],1],n.padding,"channelsLast");return Object(i.squeeze)(r,[2])}))},e.prototype.getConfig=function(){var e={poolSize:this.poolSize,padding:this.padding,strides:this.strides},n=t.prototype.getConfig.call(this);return Object.assign(e,n),e},e}(me),ri=function(t){function e(e){return t.call(this,e)||this}return a(e,t),e.prototype.poolingFunction=function(t,e,n,r,i){return Y(i),Z(r),ti(t,e,n,r,i,"max")},e.className="MaxPooling1D",e}(ni);i.serialization.registerClass(ri);var ii=function(t){function e(e){return t.call(this,e)||this}return a(e,t),e.prototype.poolingFunction=function(t,e,n,r,i){return Y(i),Z(r),ti(t,e,n,r,i,"avg")},e.className="AveragePooling1D",e}(ni);i.serialization.registerClass(ii);var oi=function(t){function e(e){var n=this;if(null==e.poolSize&&(e.poolSize=[2,2]),(n=t.call(this,e)||this).poolSize=Array.isArray(e.poolSize)?e.poolSize:[e.poolSize,e.poolSize],null==e.strides)n.strides=n.poolSize;else if(Array.isArray(e.strides)){if(2!==e.strides.length)throw new p("If the strides property of a 2D pooling layer is an Array, it is expected to have a length of 2, but received length "+e.strides.length+".");n.strides=e.strides}else n.strides=[e.strides,e.strides];return R(n.poolSize,"poolSize"),R(n.strides,"strides"),n.padding=null==e.padding?"valid":e.padding,n.dataFormat=null==e.dataFormat?"channelsLast":e.dataFormat,Y(n.dataFormat),Z(n.padding),n.inputSpec=[new ce({ndim:4})],n}return a(e,t),e.prototype.computeOutputShape=function(t){t=re(t);var e="channelsFirst"===this.dataFormat?t[2]:t[1],n="channelsFirst"===this.dataFormat?t[3]:t[2];return e=pr(e,this.poolSize[0],this.padding,this.strides[0]),n=pr(n,this.poolSize[1],this.padding,this.strides[1]),"channelsFirst"===this.dataFormat?[t[0],t[1],e,n]:[t[0],e,n,t[3]]},e.prototype.call=function(t,e){var n=this;return Object(i.tidy)((function(){return n.invokeCallHook(t,e),n.poolingFunction(ne(t),n.poolSize,n.strides,n.padding,n.dataFormat)}))},e.prototype.getConfig=function(){var e={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},n=t.prototype.getConfig.call(this);return Object.assign(e,n),e},e}(me),ai=function(t){function e(e){return t.call(this,e)||this}return a(e,t),e.prototype.poolingFunction=function(t,e,n,r,i){return Y(i),Z(r),ti(t,e,n,r,i,"max")},e.className="MaxPooling2D",e}(oi);i.serialization.registerClass(ai);var si=function(t){function e(e){return t.call(this,e)||this}return a(e,t),e.prototype.poolingFunction=function(t,e,n,r,i){return Y(i),Z(r),ti(t,e,n,r,i,"avg")},e.className="AveragePooling2D",e}(oi);i.serialization.registerClass(si);var ui=function(t){function e(e){var n=this;if(null==e.poolSize&&(e.poolSize=[2,2,2]),(n=t.call(this,e)||this).poolSize=Array.isArray(e.poolSize)?e.poolSize:[e.poolSize,e.poolSize,e.poolSize],null==e.strides)n.strides=n.poolSize;else if(Array.isArray(e.strides)){if(3!==e.strides.length)throw new p("If the strides property of a 3D pooling layer is an Array, it is expected to have a length of 3, but received length "+e.strides.length+".");n.strides=e.strides}else n.strides=[e.strides,e.strides,e.strides];return R(n.poolSize,"poolSize"),R(n.strides,"strides"),n.padding=null==e.padding?"valid":e.padding,n.dataFormat=null==e.dataFormat?"channelsLast":e.dataFormat,Y(n.dataFormat),Z(n.padding),n.inputSpec=[new ce({ndim:5})],n}return a(e,t),e.prototype.computeOutputShape=function(t){t=re(t);var e="channelsFirst"===this.dataFormat?t[2]:t[1],n="channelsFirst"===this.dataFormat?t[3]:t[2],r="channelsFirst"===this.dataFormat?t[4]:t[3];return e=pr(e,this.poolSize[0],this.padding,this.strides[0]),n=pr(n,this.poolSize[1],this.padding,this.strides[1]),r=pr(r,this.poolSize[2],this.padding,this.strides[2]),"channelsFirst"===this.dataFormat?[t[0],t[1],e,n,r]:[t[0],e,n,r,t[4]]},e.prototype.call=function(t,e){var n=this;return Object(i.tidy)((function(){return n.invokeCallHook(t,e),n.poolingFunction(ne(t),n.poolSize,n.strides,n.padding,n.dataFormat)}))},e.prototype.getConfig=function(){var e={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},n=t.prototype.getConfig.call(this);return Object.assign(e,n),e},e}(me),li=function(t){function e(e){return t.call(this,e)||this}return a(e,t),e.prototype.poolingFunction=function(t,e,n,r,i){return Y(i),Z(r),ei(t,e,n,r,i,"max")},e.className="MaxPooling3D",e}(ui);i.serialization.registerClass(li);var ci=function(t){function e(e){return t.call(this,e)||this}return a(e,t),e.prototype.poolingFunction=function(t,e,n,r,i){return Y(i),Z(r),ei(t,e,n,r,i,"avg")},e.className="AveragePooling3D",e}(ui);i.serialization.registerClass(ci);var hi=function(t){function e(e){var n=t.call(this,e)||this;return n.inputSpec=[new ce({ndim:3})],n}return a(e,t),e.prototype.computeOutputShape=function(t){return[t[0],t[2]]},e.prototype.call=function(t,e){throw new m},e}(me),di=function(t){function e(e){return t.call(this,e||{})||this}return a(e,t),e.prototype.call=function(t,e){return Object(i.tidy)((function(){var e=ne(t);return Object(i.mean)(e,1)}))},e.className="GlobalAveragePooling1D",e}(hi);i.serialization.registerClass(di);var fi=function(t){function e(e){return t.call(this,e||{})||this}return a(e,t),e.prototype.call=function(t,e){return Object(i.tidy)((function(){var e=ne(t);return Object(i.max)(e,1)}))},e.className="GlobalMaxPooling1D",e}(hi);i.serialization.registerClass(fi);var pi=function(t){function e(e){var n=t.call(this,e)||this;return n.dataFormat=null==e.dataFormat?"channelsLast":e.dataFormat,Y(n.dataFormat),n.inputSpec=[new ce({ndim:4})],n}return a(e,t),e.prototype.computeOutputShape=function(t){return t=t,"channelsLast"===this.dataFormat?[t[0],t[3]]:[t[0],t[1]]},e.prototype.call=function(t,e){throw new m},e.prototype.getConfig=function(){var e={dataFormat:this.dataFormat},n=t.prototype.getConfig.call(this);return Object.assign(e,n),e},e}(me),mi=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return a(e,t),e.prototype.call=function(t,e){var n=this;return Object(i.tidy)((function(){var e=ne(t);return"channelsLast"===n.dataFormat?Object(i.mean)(e,[1,2]):Object(i.mean)(e,[2,3])}))},e.className="GlobalAveragePooling2D",e}(pi);i.serialization.registerClass(mi);var gi=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return a(e,t),e.prototype.call=function(t,e){var n=this;return Object(i.tidy)((function(){var e=ne(t);return"channelsLast"===n.dataFormat?Object(i.max)(e,[1,2]):Object(i.max)(e,[2,3])}))},e.className="GlobalMaxPooling2D",e}(pi);function yi(t,e,n,r){if(Array.isArray(t)){if(null!=e||null!=n)throw new p("When inputs is an array, neither initialState or constants should be provided");null!=r&&(n=t.slice(t.length-r,t.length),t=t.slice(0,t.length-r)),t.length>1&&(e=t.slice(1,t.length)),t=t[0]}function i(t){return null==t||Array.isArray(t)?t:[t]}return{inputs:t,initialState:e=i(e),constants:n=i(n)}}function vi(t,e,n,r,o,a,s,u){return void 0===r&&(r=!1),void 0===s&&(s=!1),void 0===u&&(u=!1),Object(i.tidy)((function(){var l=e.shape.length;if(l<3)throw new p("Input should be at least 3D, but is "+l+"D.");var c=[1,0].concat(ct(2,l));if(e=Object(i.transpose)(e,c),null!=a)throw new m("The rnn() functoin of the deeplearn.js backend does not support constants yet.");s&&console.warn("Backend rnn(): the unroll = true option is not applicable to the imperative deeplearn.js backend."),null!=o&&((o=o.asType("bool").asType("float32")).rank===l-1&&(o=Object(i.expandDims)(o,-1)),o=Object(i.transpose)(o,c)),r&&(e=Object(i.reverse)(e,0),null!=o&&(o=Object(i.reverse)(o,0)));var h,d,f=[],g=n,y=e.shape[0],v=Object(i.unstack)(e);null!=o&&(d=Object(i.unstack)(o));for(var b,w=function(e){var n=v[e],r=Object(i.tidy)((function(){return t(n,g)}));if(null==o)h=r[0],g=r[1];else{var a=Object(i.tidy)((function(){var t=d[e],n=Object(i.onesLike)(t).sub(t);return{output:r[0].mul(t).addStrict(g[0].mul(n)),newStates:g.map((function(e,i){return r[1][i].mul(t).addStrict(e.mul(n))}))}}));h=a.output,g=a.newStates}u&&f.push(h)},x=0;x<y;++x)w(x);return u&&(b=Object(i.stack)(f,1)),[h,b,g]}))}i.serialization.registerClass(gi);var bi=function(t){function e(e){var n,r=t.call(this,e)||this;if(null==e.cell)throw new p("cell property is missing for the constructor of RNN.");if(null==(n=Array.isArray(e.cell)?new Oi({cells:e.cell}):e.cell).stateSize)throw new p("The RNN cell should have an attribute `stateSize` (tuple of integers, one integer per RNN state).");return r.cell=n,r.returnSequences=null!=e.returnSequences&&e.returnSequences,r.returnState=null!=e.returnState&&e.returnState,r.goBackwards=null!=e.goBackwards&&e.goBackwards,r._stateful=null!=e.stateful&&e.stateful,r.unroll=null!=e.unroll&&e.unroll,r.supportsMasking=!0,r.inputSpec=[new ce({ndim:3})],r.stateSpec=null,r.states_=null,r.numConstants=null,r.keptStates=[],r}return a(e,t),e.prototype.getStates=function(){return null==this.states_?ct(0,Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1).map((function(t){return null})):this.states_},e.prototype.setStates=function(t){this.states_=t},e.prototype.computeOutputShape=function(t){te(t)&&(t=t[0]),t=t;var e=this.cell.stateSize;Array.isArray(e)||(e=[e]);var n,r=e[0];if(n=this.returnSequences?[t[0],t[1],r]:[t[0],r],this.returnState){for(var i=[],o=0,a=e;o<a.length;o++)i.push([t[0],a[o]]);return[n].concat(i)}return n},e.prototype.computeMask=function(t,e){var n=this;return Object(i.tidy)((function(){Array.isArray(e)&&(e=e[0]);var t=n.returnSequences?e:null;if(n.returnState){var r=n.states.map((function(t){return null}));return[t].concat(r)}return t}))},Object.defineProperty(e.prototype,"states",{get:function(){if(null==this.states_){for(var t=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1,e=[],n=0;n<t;++n)e.push(null);return e}return this.states_},set:function(t){this.states_=t},enumerable:!0,configurable:!0}),e.prototype.build=function(t){if(null!=this.numConstants)throw new m("Constants support is not implemented in RNN yet.");te(t)&&(t=t[0]),t=t,this.inputSpec[0]=new ce({shape:[this.stateful?t[0]:null,null,t[t.length-1]]});var e,n=[t[0]].concat(t.slice(2));if(this.cell.build(n),e=Array.isArray(this.cell.stateSize)?this.cell.stateSize:[this.cell.stateSize],null!=this.stateSpec){if(!i.util.arraysEqual(this.stateSpec.map((function(t){return t.shape[t.shape.length-1]})),e))throw new p("An initialState was passed that is not compatible with cell.stateSize. Received stateSpec="+this.stateSpec+"; However cell.stateSize is "+this.cell.stateSize)}else this.stateSpec=e.map((function(t){return new ce({shape:[null,t]})}));this.stateful&&this.resetStates()},e.prototype.resetStates=function(t,e){var n=this;void 0===e&&(e=!1),Object(i.tidy)((function(){if(!n.stateful)throw new d("Cannot call resetStates() on an RNN Layer that is not stateful.");var r=n.inputSpec[0].shape[0];if(null==r)throw new p("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(null==n.states_)n.states_=Array.isArray(n.cell.stateSize)?n.cell.stateSize.map((function(t){return Object(i.zeros)([r,t])})):[Object(i.zeros)([r,n.cell.stateSize])];else if(null==t)Object(i.dispose)(n.states_),null!=n.keptStates&&(Object(i.dispose)(n.keptStates),n.keptStates=[]),Array.isArray(n.cell.stateSize)?n.states_=n.cell.stateSize.map((function(t){return Object(i.zeros)([r,t])})):n.states_[0]=Object(i.zeros)([r,n.cell.stateSize]);else{if(Array.isArray(t)||(t=[t]),t.length!==n.states_.length)throw new p("Layer "+n.name+" expects "+n.states_.length+" state(s), but it received "+t.length+" state value(s). Input received: "+t);!0===e?n.keptStates.push(n.states_.slice()):Object(i.dispose)(n.states_);for(var o=0;o<n.states_.length;++o){var a=t[o],s=Array.isArray(n.cell.stateSize)?n.cell.stateSize[o]:n.cell.stateSize,u=[r,s];if(!i.util.arraysEqual(a.shape,u))throw new p("State "+o+" is incompatible with layer "+n.name+": expected shape="+u+", received shape="+a.shape);n.states_[o]=a}}n.states_=n.states_.map((function(t){return Object(i.keep)(t.clone())}))}))},e.prototype.apply=function(e,n){var r=null==n?null:n.initialState,i=null==n?null:n.constants;null==n&&(n={});var o=yi(e,r,i,this.numConstants);e=o.inputs,i=o.constants;var a=[],s=[];if(null!=(r=o.initialState)){n.initialState=r,a=a.concat(r),this.stateSpec=[];for(var u=0,l=r;u<l.length;u++)this.stateSpec.push(new ce({shape:l[u].shape}));s=s.concat(this.stateSpec)}if(null!=i&&(n.constants=i,a=a.concat(i),this.numConstants=i.length),a[0]instanceof he){var c=[e].concat(a),h=this.inputSpec.concat(s),d=this.inputSpec;this.inputSpec=h;var f=t.prototype.apply.call(this,c,n);return this.inputSpec=d,f}return t.prototype.apply.call(this,e,n)},e.prototype.call=function(t,e){var n=this;return Object(i.tidy)((function(){var r=null==e?null:e.mask,i=null==e?null:e.training,o=null==e?null:e.initialState;t=ne(t),null==o&&(o=n.stateful?n.states_:n.getInitialState(t));var a=Array.isArray(n.cell.stateSize)?n.cell.stateSize.length:1;if(o.length!==a)throw new p("RNN Layer has "+a+" state(s) but was passed "+o.length+" initial state(s).");n.unroll&&console.warn("Ignoring unroll = true for RNN layer, due to imperative backend.");var s={training:i},u=vi((function(t,e){var r=n.cell.call([t].concat(e),s);return[r[0],r.slice(1)]}),t,o,n.goBackwards,r,null,n.unroll,n.returnSequences),l=u[0],c=u[1],h=u[2];n.stateful&&n.resetStates(h,i);var d=n.returnSequences?c:l;return n.returnState?[d].concat(h):d}))},e.prototype.getInitialState=function(t){var e=this;return Object(i.tidy)((function(){var n=Object(i.zeros)(t.shape);return n=dt(n=Object(i.sum)(n,[1,2])),Array.isArray(e.cell.stateSize)?e.cell.stateSize.map((function(t){return t>1?vt(n,[1,t]):n})):e.cell.stateSize>1?[vt(n,[1,e.cell.stateSize])]:[n]}))},Object.defineProperty(e.prototype,"trainableWeights",{get:function(){return this.trainable?this.cell.trainableWeights:[]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"nonTrainableWeights",{get:function(){return this.trainable?this.cell.nonTrainableWeights:this.cell.weights},enumerable:!0,configurable:!0}),e.prototype.setFastWeightInitDuringBuild=function(e){t.prototype.setFastWeightInitDuringBuild.call(this,e),null!=this.cell&&this.cell.setFastWeightInitDuringBuild(e)},e.prototype.getConfig=function(){var e={returnSequences:this.returnSequences,returnState:this.returnState,goBackwards:this.goBackwards,stateful:this.stateful,unroll:this.unroll};null!=this.numConstants&&(e.numConstants=this.numConstants);var n=this.cell.getConfig();e.cell={className:this.cell.getClassName(),config:n};var r=t.prototype.getConfig.call(this);return Object.assign(e,r),e},e.fromConfig=function(t,e,n){void 0===n&&(n={});var r=Ae(e.cell,n);return new t(Object.assign(e,{cell:r}))},e.className="RNN",e}(me);i.serialization.registerClass(bi);var wi=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return a(e,t),e}(me),xi=function(t){function e(e){var n=t.call(this,e)||this;return n.DEFAULT_ACTIVATION="tanh",n.DEFAULT_KERNEL_INITIALIZER="glorotNormal",n.DEFAULT_RECURRENT_INITIALIZER="orthogonal",n.DEFAULT_BIAS_INITIALIZER="zeros",n.units=e.units,R(n.units,"units"),n.activation=Jn(null==e.activation?n.DEFAULT_ACTIVATION:e.activation),n.useBias=null==e.useBias||e.useBias,n.kernelInitializer=Xt(e.kernelInitializer||n.DEFAULT_KERNEL_INITIALIZER),n.recurrentInitializer=Xt(e.recurrentInitializer||n.DEFAULT_RECURRENT_INITIALIZER),n.biasInitializer=Xt(e.biasInitializer||n.DEFAULT_BIAS_INITIALIZER),n.kernelRegularizer=ar(e.kernelRegularizer),n.recurrentRegularizer=ar(e.recurrentRegularizer),n.biasRegularizer=ar(e.biasRegularizer),n.kernelConstraint=V(e.kernelConstraint),n.recurrentConstraint=V(e.recurrentConstraint),n.biasConstraint=V(e.biasConstraint),n.dropout=ut([1,lt([0,null==e.dropout?0:e.dropout])]),n.recurrentDropout=ut([1,lt([0,null==e.recurrentDropout?0:e.recurrentDropout])]),n.stateSize=n.units,n.dropoutMask=null,n.recurrentDropoutMask=null,n}return a(e,t),e.prototype.build=function(t){t=re(t),this.kernel=this.addWeight("kernel",[t[t.length-1],this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.bias=this.useBias?this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):null,this.built=!0},e.prototype.call=function(t,e){var n=this;return Object(i.tidy)((function(){if(2!==(t=t).length)throw new p("SimpleRNNCell expects 2 input Tensors, got "+t.length+".");var r=t[1];t=t[0];var o,a=null!=e.training&&e.training;0<n.dropout&&n.dropout<1&&null==n.dropoutMask&&(n.dropoutMask=Ai((function(){return Object(i.onesLike)(t)}),n.dropout,a)),0<n.recurrentDropout&&n.recurrentDropout<1&&null==n.recurrentDropoutMask&&(n.recurrentDropoutMask=Ai((function(){return Object(i.onesLike)(r)}),n.recurrentDropout,a));var s=n.dropoutMask,u=n.recurrentDropoutMask;o=wt(null!=s?Object(i.mul)(t,s):t,n.kernel.read()),null!=n.bias&&(o=kt(o,n.bias.read())),null!=u&&(r=Object(i.mul)(r,u));var l=Object(i.add)(o,wt(r,n.recurrentKernel.read()));return null!=n.activation&&(l=n.activation.apply(l)),[l,l]}))},e.prototype.getConfig=function(){var e={units:this.units,activation:Zn(this.activation),useBias:this.useBias,kernelInitializer:Gt(this.kernelInitializer),recurrentInitializer:Gt(this.recurrentInitializer),biasInitializer:Gt(this.biasInitializer),kernelRegularizer:ir(this.kernelRegularizer),recurrentRegularizer:ir(this.recurrentRegularizer),biasRegularizer:ir(this.biasRegularizer),activityRegularizer:ir(this.activityRegularizer),kernelConstraint:U(this.kernelConstraint),recurrentConstraint:U(this.recurrentConstraint),biasConstraint:U(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout},n=t.prototype.getConfig.call(this);return Object.assign(e,n),e},e.className="SimpleRNNCell",e}(wi);i.serialization.registerClass(xi);var _i=function(t){function e(e){return e.cell=new xi(e),t.call(this,e)||this}return a(e,t),e.prototype.call=function(e,n){var r=this;return Object(i.tidy)((function(){return null!=r.cell.dropoutMask&&(Object(i.dispose)(r.cell.dropoutMask),r.cell.dropoutMask=null),null!=r.cell.recurrentDropoutMask&&(Object(i.dispose)(r.cell.recurrentDropoutMask),r.cell.recurrentDropoutMask=null),t.prototype.call.call(r,e,{mask:null==n?null:n.mask,training:null==n?null:n.training,initialState:null==n?null:n.initialState})}))},Object.defineProperty(e.prototype,"units",{get:function(){return this.cell.units},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"activation",{get:function(){return this.cell.activation},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"useBias",{get:function(){return this.cell.useBias},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"kernelInitializer",{get:function(){return this.cell.kernelInitializer},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"recurrentInitializer",{get:function(){return this.cell.recurrentInitializer},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"biasInitializer",{get:function(){return this.cell.biasInitializer},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"kernelRegularizer",{get:function(){return this.cell.kernelRegularizer},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"recurrentRegularizer",{get:function(){return this.cell.recurrentRegularizer},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"biasRegularizer",{get:function(){return this.cell.biasRegularizer},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"kernelConstraint",{get:function(){return this.cell.kernelConstraint},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"recurrentConstraint",{get:function(){return this.cell.recurrentConstraint},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"biasConstraint",{get:function(){return this.cell.biasConstraint},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dropout",{get:function(){return this.cell.dropout},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"recurrentDropout",{get:function(){return this.cell.recurrentDropout},enumerable:!0,configurable:!0}),e.prototype.getConfig=function(){var e={units:this.units,activation:Zn(this.activation),useBias:this.useBias,kernelInitializer:Gt(this.kernelInitializer),recurrentInitializer:Gt(this.recurrentInitializer),biasInitializer:Gt(this.biasInitializer),kernelRegularizer:ir(this.kernelRegularizer),recurrentRegularizer:ir(this.recurrentRegularizer),biasRegularizer:ir(this.biasRegularizer),activityRegularizer:ir(this.activityRegularizer),kernelConstraint:U(this.kernelConstraint),recurrentConstraint:U(this.recurrentConstraint),biasConstraint:U(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout},n=t.prototype.getConfig.call(this);return delete n.cell,Object.assign(e,n),e},e.fromConfig=function(t,e){return new t(e)},e.className="SimpleRNN",e}(bi);i.serialization.registerClass(_i);var Ci=function(t){function e(e){var n=t.call(this,e)||this;return n.DEFAULT_ACTIVATION="tanh",n.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",n.DEFAULT_KERNEL_INITIALIZER="glorotNormal",n.DEFAULT_RECURRENT_INITIALIZER="orthogonal",n.DEFAULT_BIAS_INITIALIZER="zeros",n.units=e.units,R(n.units,"units"),n.activation=Jn(void 0===e.activation?n.DEFAULT_ACTIVATION:e.activation),n.recurrentActivation=Jn(void 0===e.recurrentActivation?n.DEFAULT_RECURRENT_ACTIVATION:e.recurrentActivation),n.useBias=null==e.useBias||e.useBias,n.kernelInitializer=Xt(e.kernelInitializer||n.DEFAULT_KERNEL_INITIALIZER),n.recurrentInitializer=Xt(e.recurrentInitializer||n.DEFAULT_RECURRENT_INITIALIZER),n.biasInitializer=Xt(e.biasInitializer||n.DEFAULT_BIAS_INITIALIZER),n.kernelRegularizer=ar(e.kernelRegularizer),n.recurrentRegularizer=ar(e.recurrentRegularizer),n.biasRegularizer=ar(e.biasRegularizer),n.kernelConstraint=V(e.kernelConstraint),n.recurrentConstraint=V(e.recurrentConstraint),n.biasConstraint=V(e.biasConstraint),n.dropout=ut([1,lt([0,null==e.dropout?0:e.dropout])]),n.recurrentDropout=ut([1,lt([0,null==e.recurrentDropout?0:e.recurrentDropout])]),n.implementation=e.implementation,n.stateSize=n.units,n.dropoutMask=null,n.recurrentDropoutMask=null,n}return a(e,t),e.prototype.build=function(t){var e=(t=re(t))[t.length-1];this.kernel=this.addWeight("kernel",[e,3*this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,3*this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.bias=this.useBias?this.addWeight("bias",[3*this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):null,this.built=!0},e.prototype.call=function(t,e){var n=this;return Object(i.tidy)((function(){if(2!==(t=t).length)throw new p("GRUCell expects 2 input Tensors (inputs, h, c), got "+t.length+".");var r=null!=e.training&&e.training,o=t[1];t=t[0],0<n.dropout&&n.dropout<1&&null==n.dropoutMask&&(n.dropoutMask=Ai((function(){return Object(i.onesLike)(t)}),n.dropout,r,3)),0<n.recurrentDropout&&n.recurrentDropout<1&&null==n.recurrentDropoutMask&&(n.recurrentDropoutMask=Ai((function(){return Object(i.onesLike)(o)}),n.recurrentDropout,r,3));var a,s,u,l=n.dropoutMask,c=n.recurrentDropoutMask;0<n.dropout&&n.dropout<1&&(t=Object(i.mul)(t,l[0]));var h=wt(t,n.kernel.read());n.useBias&&(h=kt(h,n.bias.read())),0<n.recurrentDropout&&n.recurrentDropout<1&&(o=Object(i.mul)(o,c[0]));var d=n.recurrentKernel.read(),f=Object(i.split)(d,[2*n.units,n.units],d.rank-1),m=f[1],g=wt(o,f[0]),y=Object(i.split)(h,3,h.rank-1),v=y[0],b=y[1],w=y[2],x=Object(i.split)(g,2,g.rank-1),_=x[0],C=x[1];a=n.recurrentActivation.apply(Object(i.add)(v,_)),s=n.recurrentActivation.apply(Object(i.add)(b,C));var k=wt(Object(i.mul)(s,o),m);u=n.activation.apply(Object(i.add)(w,k));var S=Object(i.add)(Object(i.mul)(a,o),Object(i.mul)(Object(i.add)(1,Object(i.neg)(a)),u));return[S,S]}))},e.prototype.getConfig=function(){var e={units:this.units,activation:Zn(this.activation),recurrentActivation:Zn(this.recurrentActivation),useBias:this.useBias,kernelInitializer:Gt(this.kernelInitializer),recurrentInitializer:Gt(this.recurrentInitializer),biasInitializer:Gt(this.biasInitializer),kernelRegularizer:ir(this.kernelRegularizer),recurrentRegularizer:ir(this.recurrentRegularizer),biasRegularizer:ir(this.biasRegularizer),activityRegularizer:ir(this.activityRegularizer),kernelConstraint:U(this.kernelConstraint),recurrentConstraint:U(this.recurrentConstraint),biasConstraint:U(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation},n=t.prototype.getConfig.call(this);return Object.assign(e,n),e},e.className="GRUCell",e}(wi);i.serialization.registerClass(Ci);var ki=function(t){function e(e){return 0===e.implementation&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),e.cell=new Ci(e),t.call(this,e)||this}return a(e,t),e.prototype.call=function(e,n){var r=this;return Object(i.tidy)((function(){return null!=r.cell.dropoutMask&&(Object(i.dispose)(r.cell.dropoutMask),r.cell.dropoutMask=null),null!=r.cell.recurrentDropoutMask&&(Object(i.dispose)(r.cell.recurrentDropoutMask),r.cell.recurrentDropoutMask=null),t.prototype.call.call(r,e,{mask:null==n?null:n.mask,training:null==n?null:n.training,initialState:null==n?null:n.initialState})}))},Object.defineProperty(e.prototype,"units",{get:function(){return this.cell.units},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"activation",{get:function(){return this.cell.activation},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"recurrentActivation",{get:function(){return this.cell.recurrentActivation},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"useBias",{get:function(){return this.cell.useBias},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"kernelInitializer",{get:function(){return this.cell.kernelInitializer},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"recurrentInitializer",{get:function(){return this.cell.recurrentInitializer},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"biasInitializer",{get:function(){return this.cell.biasInitializer},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"kernelRegularizer",{get:function(){return this.cell.kernelRegularizer},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"recurrentRegularizer",{get:function(){return this.cell.recurrentRegularizer},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"biasRegularizer",{get:function(){return this.cell.biasRegularizer},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"kernelConstraint",{get:function(){return this.cell.kernelConstraint},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"recurrentConstraint",{get:function(){return this.cell.recurrentConstraint},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"biasConstraint",{get:function(){return this.cell.biasConstraint},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dropout",{get:function(){return this.cell.dropout},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"recurrentDropout",{get:function(){return this.cell.recurrentDropout},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"implementation",{get:function(){return this.cell.implementation},enumerable:!0,configurable:!0}),e.prototype.getConfig=function(){var e={units:this.units,activation:Zn(this.activation),recurrentActivation:Zn(this.recurrentActivation),useBias:this.useBias,kernelInitializer:Gt(this.kernelInitializer),recurrentInitializer:Gt(this.recurrentInitializer),biasInitializer:Gt(this.biasInitializer),kernelRegularizer:ir(this.kernelRegularizer),recurrentRegularizer:ir(this.recurrentRegularizer),biasRegularizer:ir(this.biasRegularizer),activityRegularizer:ir(this.activityRegularizer),kernelConstraint:U(this.kernelConstraint),recurrentConstraint:U(this.recurrentConstraint),biasConstraint:U(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation},n=t.prototype.getConfig.call(this);return delete n.cell,Object.assign(e,n),e},e.fromConfig=function(t,e){return 0===e.implmentation&&(e.implementation=1),new t(e)},e.className="GRU",e}(bi);i.serialization.registerClass(ki);var Si=function(t){function e(e){var n=t.call(this,e)||this;return n.DEFAULT_ACTIVATION="tanh",n.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",n.DEFAULT_KERNEL_INITIALIZER="glorotNormal",n.DEFAULT_RECURRENT_INITIALIZER="orthogonal",n.DEFAULT_BIAS_INITIALIZER="zeros",n.units=e.units,R(n.units,"units"),n.activation=Jn(void 0===e.activation?n.DEFAULT_ACTIVATION:e.activation),n.recurrentActivation=Jn(void 0===e.recurrentActivation?n.DEFAULT_RECURRENT_ACTIVATION:e.recurrentActivation),n.useBias=null==e.useBias||e.useBias,n.kernelInitializer=Xt(e.kernelInitializer||n.DEFAULT_KERNEL_INITIALIZER),n.recurrentInitializer=Xt(e.recurrentInitializer||n.DEFAULT_RECURRENT_INITIALIZER),n.biasInitializer=Xt(e.biasInitializer||n.DEFAULT_BIAS_INITIALIZER),n.unitForgetBias=e.unitForgetBias,n.kernelRegularizer=ar(e.kernelRegularizer),n.recurrentRegularizer=ar(e.recurrentRegularizer),n.biasRegularizer=ar(e.biasRegularizer),n.kernelConstraint=V(e.kernelConstraint),n.recurrentConstraint=V(e.recurrentConstraint),n.biasConstraint=V(e.biasConstraint),n.dropout=ut([1,lt([0,null==e.dropout?0:e.dropout])]),n.recurrentDropout=ut([1,lt([0,null==e.recurrentDropout?0:e.recurrentDropout])]),n.implementation=e.implementation,n.stateSize=[n.units,n.units],n.dropoutMask=null,n.recurrentDropoutMask=null,n}return a(e,t),e.prototype.build=function(t){var e,n,r=(t=re(t))[t.length-1];if(this.kernel=this.addWeight("kernel",[r,4*this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,4*this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias){if(this.unitForgetBias){var i=this.biasInitializer,o=this.units;n=new((e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return a(e,t),e.prototype.apply=function(t,e){var n=i.apply([o]),r=(new Dt).apply([o]),a=i.apply([2*o]);return yt(yt(n,r),a)},e}(Nt)).className="CustomInit",e)}else n=this.biasInitializer;this.bias=this.addWeight("bias",[4*this.units],null,n,this.biasRegularizer,!0,this.biasConstraint)}else this.bias=null;this.built=!0},e.prototype.call=function(t,e){var n=this;return Object(i.tidy)((function(){var r=null!=e.training&&e.training;if(3!==(t=t).length)throw new p("LSTMCell expects 3 input Tensors (inputs, h, c), got "+t.length+".");var o=t[1],a=t[2];t=t[0],0<n.dropout&&n.dropout<1&&null==n.dropoutMask&&(n.dropoutMask=Ai((function(){return Object(i.onesLike)(t)}),n.dropout,r,4)),0<n.recurrentDropout&&n.recurrentDropout<1&&null==n.recurrentDropoutMask&&(n.recurrentDropoutMask=Ai((function(){return Object(i.onesLike)(o)}),n.recurrentDropout,r,4));var s,u,l,c,h=n.dropoutMask,d=n.recurrentDropoutMask;0<n.dropout&&n.dropout<1&&(t=Object(i.mul)(t,h[0]));var f=wt(t,n.kernel.read());0<n.recurrentDropout&&n.recurrentDropout<1&&(o=Object(i.mul)(o,d[0])),f=Object(i.add)(f,wt(o,n.recurrentKernel.read())),n.useBias&&(f=kt(f,n.bias.read()));var m=Object(i.split)(f,4,f.rank-1),g=m[1],y=m[2],v=m[3];s=n.recurrentActivation.apply(m[0]),u=n.recurrentActivation.apply(g),l=Object(i.add)(Object(i.mul)(u,a),Object(i.mul)(s,n.activation.apply(y))),c=n.recurrentActivation.apply(v);var b=Object(i.mul)(c,n.activation.apply(l));return[b,b,l]}))},e.prototype.getConfig=function(){var e={units:this.units,activation:Zn(this.activation),recurrentActivation:Zn(this.recurrentActivation),useBias:this.useBias,kernelInitializer:Gt(this.kernelInitializer),recurrentInitializer:Gt(this.recurrentInitializer),biasInitializer:Gt(this.biasInitializer),unitForgetBias:this.unitForgetBias,kernelRegularizer:ir(this.kernelRegularizer),recurrentRegularizer:ir(this.recurrentRegularizer),biasRegularizer:ir(this.biasRegularizer),activityRegularizer:ir(this.activityRegularizer),kernelConstraint:U(this.kernelConstraint),recurrentConstraint:U(this.recurrentConstraint),biasConstraint:U(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation},n=t.prototype.getConfig.call(this);return Object.assign(e,n),e},e.className="LSTMCell",e}(wi);i.serialization.registerClass(Si);var Ei=function(t){function e(e){return 0===e.implementation&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),e.cell=new Si(e),t.call(this,e)||this}return a(e,t),e.prototype.call=function(e,n){var r=this;return Object(i.tidy)((function(){return null!=r.cell.dropoutMask&&(Object(i.dispose)(r.cell.dropoutMask),r.cell.dropoutMask=null),null!=r.cell.recurrentDropoutMask&&(Object(i.dispose)(r.cell.recurrentDropoutMask),r.cell.recurrentDropoutMask=null),t.prototype.call.call(r,e,{mask:null==n?null:n.mask,training:null==n?null:n.training,initialState:null==n?null:n.initialState})}))},Object.defineProperty(e.prototype,"units",{get:function(){return this.cell.units},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"activation",{get:function(){return this.cell.activation},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"recurrentActivation",{get:function(){return this.cell.recurrentActivation},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"useBias",{get:function(){return this.cell.useBias},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"kernelInitializer",{get:function(){return this.cell.kernelInitializer},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"recurrentInitializer",{get:function(){return this.cell.recurrentInitializer},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"biasInitializer",{get:function(){return this.cell.biasInitializer},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"unitForgetBias",{get:function(){return this.cell.unitForgetBias},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"kernelRegularizer",{get:function(){return this.cell.kernelRegularizer},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"recurrentRegularizer",{get:function(){return this.cell.recurrentRegularizer},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"biasRegularizer",{get:function(){return this.cell.biasRegularizer},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"kernelConstraint",{get:function(){return this.cell.kernelConstraint},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"recurrentConstraint",{get:function(){return this.cell.recurrentConstraint},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"biasConstraint",{get:function(){return this.cell.biasConstraint},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dropout",{get:function(){return this.cell.dropout},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"recurrentDropout",{get:function(){return this.cell.recurrentDropout},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"implementation",{get:function(){return this.cell.implementation},enumerable:!0,configurable:!0}),e.prototype.getConfig=function(){var e={units:this.units,activation:Zn(this.activation),recurrentActivation:Zn(this.recurrentActivation),useBias:this.useBias,kernelInitializer:Gt(this.kernelInitializer),recurrentInitializer:Gt(this.recurrentInitializer),biasInitializer:Gt(this.biasInitializer),unitForgetBias:this.unitForgetBias,kernelRegularizer:ir(this.kernelRegularizer),recurrentRegularizer:ir(this.recurrentRegularizer),biasRegularizer:ir(this.biasRegularizer),activityRegularizer:ir(this.activityRegularizer),kernelConstraint:U(this.kernelConstraint),recurrentConstraint:U(this.recurrentConstraint),biasConstraint:U(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation},n=t.prototype.getConfig.call(this);return delete n.cell,Object.assign(e,n),e},e.fromConfig=function(t,e){return 0===e.implmentation&&(e.implementation=1),new t(e)},e.className="LSTM",e}(bi);i.serialization.registerClass(Ei);var Oi=function(t){function e(e){var n=t.call(this,e)||this;return n.cells=e.cells,n}return a(e,t),Object.defineProperty(e.prototype,"stateSize",{get:function(){for(var t=[],e=0,n=this.cells.slice().reverse();e<n.length;e++){var r=n[e];Array.isArray(r.stateSize)?t.push.apply(t,r.stateSize):t.push(r.stateSize)}return t},enumerable:!0,configurable:!0}),e.prototype.call=function(t,e){var n=this;return Object(i.tidy)((function(){for(var r=(t=t).slice(1),i=[],o=0,a=n.cells.slice().reverse();o<a.length;o++){var s=a[o];Array.isArray(s.stateSize)?i.push(r.splice(0,s.stateSize.length)):i.push(r.splice(0,1))}i.reverse();for(var u,l=[],c=0;c<n.cells.length;++c)s=n.cells[c],r=i[c],u=0===c?[t[0]].concat(r):[u[0]].concat(r),u=s.call(u,e),l.push(u.slice(1));r=[];for(var h=0,d=l.slice().reverse();h<d.length;h++)r.push.apply(r,d[h]);return[u[0]].concat(r)}))},e.prototype.build=function(t){var e;te(t)&&(t=t[0]),t=t,this.cells.forEach((function(n,r){tt("RNNCell_"+r,(function(){n.build(t),e=Array.isArray(n.stateSize)?n.stateSize[0]:n.stateSize,t=[t[0],e]}))})),this.built=!0},e.prototype.getConfig=function(){for(var e=[],n=0,r=this.cells;n<r.length;n++){var i=r[n];e.push({className:i.getClassName(),config:i.getConfig()})}var o={cells:e},a=t.prototype.getConfig.call(this);return Object.assign(o,a),o},e.fromConfig=function(t,e,n){void 0===n&&(n={});for(var r=[],i=0,o=e.cells;i<o.length;i++)r.push(Ae(o[i],n));return new t({cells:r})},Object.defineProperty(e.prototype,"trainableWeights",{get:function(){if(!this.trainable)return[];for(var t=[],e=0,n=this.cells;e<n.length;e++)t.push.apply(t,n[e].trainableWeights);return t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"nonTrainableWeights",{get:function(){for(var t=[],e=0,n=this.cells;e<n.length;e++){var r=n[e];t.push.apply(t,r.nonTrainableWeights)}if(!this.trainable){for(var i=[],o=0,a=this.cells;o<a.length;o++)i.push.apply(i,(r=a[o]).trainableWeights);return i.concat(t)}return t},enumerable:!0,configurable:!0}),e.prototype.getWeights=function(){for(var t=[],e=0,n=this.cells;e<n.length;e++)t.push.apply(t,n[e].weights);return ae(t)},e.prototype.setWeights=function(t){for(var e=[],n=0,r=this.cells;n<r.length;n++)for(var i=r[n],o=t.splice(i.weights.length),a=0;a<i.weights.length;++a)e.push([i.weights[a],o[a]]);se(e)},e.className="StackedRNNCells",e}(wi);function Ai(t,e,n,r){function o(){return St(t(),e)}if(void 0===n&&(n=null),void 0===r&&(r=1),r>1){for(var a=[],s=0;s<r;s++)a.push(Et(o,t,n));return a.map((function(t){return Object(i.keep)(t.clone())}))}return Object(i.keep)(Et(o,t,n).clone())}i.serialization.registerClass(Oi);var Ni=function(t){function e(e){var n=t.call(this,e)||this;return n.layer=e.layer,n}return a(e,t),e.prototype.build=function(t){this.built=!0},Object.defineProperty(e.prototype,"trainable",{get:function(){return null!=this.layer&&this.layer.trainable},set:function(t){null!=this.layer&&(this.layer.trainable=t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"trainableWeights",{get:function(){return this.layer.trainableWeights},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"nonTrainableWeights",{get:function(){return this.layer.nonTrainableWeights},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"updates",{get:function(){return this.layer._updates},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"losses",{get:function(){return this.layer.losses},enumerable:!0,configurable:!0}),e.prototype.getWeights=function(){return this.layer.getWeights()},e.prototype.setWeights=function(t){this.layer.setWeights(t)},e.prototype.getConfig=function(){var e={layer:{className:this.layer.getClassName(),config:this.layer.getConfig()}},n=t.prototype.getConfig.call(this);return Object.assign(e,n),e},e.prototype.setFastWeightInitDuringBuild=function(e){t.prototype.setFastWeightInitDuringBuild.call(this,e),null!=this.layer&&this.layer.setFastWeightInitDuringBuild(e)},e.fromConfig=function(t,e,n){void 0===n&&(n={});var r=Ae(e.layer,n);delete e.layer;var i={layer:r};return Object.assign(i,e),new t(i)},e}(me),Ti=function(t){function e(e){var n=t.call(this,e)||this;return n.supportsMasking=!0,n}return a(e,t),e.prototype.build=function(e){if((e=re(e)).length<3)throw new p("TimeDistributed layer expects an input shape >= 3D, but received input shape "+JSON.stringify(e));this.inputSpec=[{shape:e}];var n=[e[0]].concat(e.slice(2));this.layer.built||(this.layer.build(n),this.layer.built=!0),t.prototype.build.call(this,e)},e.prototype.computeOutputShape=function(t){var e=[(t=re(t))[0]].concat(t.slice(2)),n=this.layer.computeOutputShape(e);return[n[0],t[1]].concat(n.slice(1))},e.prototype.call=function(t,e){var n=this;return Object(i.tidy)((function(){return vi((function(t,r){return[ne(n.layer.call(t,e)),[]]}),t=ne(t),[],!1,null,null,!1,!0)[1]}))},e.className="TimeDistributed",e}(Ni);i.serialization.registerClass(Ti);var Di=function(t){function e(e){var n=t.call(this,e)||this,r=e.layer.getConfig(),i={};i.className=e.layer.getClassName(),i.config=r,n.forwardLayer=Ae(i),r.goBackwards=!0!==r.goBackwards;var o={};if(o.className=e.layer.getClassName(),o.config=r,n.backwardLayer=Ae(o),n.forwardLayer.name="forward_"+n.forwardLayer.name,n.backwardLayer.name="backward_"+n.backwardLayer.name,n.mergeMode=void 0===e.mergeMode?"concat":e.mergeMode,function(t){T(X,"BidirectionalMergeMode",t)}(n.mergeMode),e.weights)throw new m("weights support is not implemented for Bidirectional layer yet.");return n._stateful=e.layer.stateful,n.returnSequences=e.layer.returnSequences,n.returnState=e.layer.returnState,n.supportsMasking=!0,n._trainable=!0,n.inputSpec=e.layer.inputSpec,n.numConstants=null,n}return a(e,t),Object.defineProperty(e.prototype,"trainable",{get:function(){return this._trainable},set:function(t){this._trainable=t,null!=this.forwardLayer&&(this.forwardLayer.trainable=t),null!=this.backwardLayer&&(this.backwardLayer.trainable=t)},enumerable:!0,configurable:!0}),e.prototype.getWeights=function(){return this.forwardLayer.getWeights().concat(this.backwardLayer.getWeights())},e.prototype.setWeights=function(t){var e=Math.floor(t.length/2);this.forwardLayer.setWeights(t.slice(0,e)),this.backwardLayer.setWeights(t.slice(e))},e.prototype.computeOutputShape=function(t){var e,n,r,i=this.forwardLayer.computeOutputShape(t);return Array.isArray(i)&&Array.isArray(i[0])||(i=[i]),i=i,this.returnState?(r=i.slice(1),e=i[0]):e=i[0],e=e,"concat"===this.mergeMode?(e[e.length-1]*=2,n=[e]):n=null==this.mergeMode?[e,e.slice()]:[e],this.returnState?null==this.mergeMode?n.concat(r).concat(r.slice()):[e].concat(r).concat(r.slice()):w(n)},e.prototype.apply=function(e,n){var r=null==n?null:n.initialState,i=null==n?null:n.constants;null==n&&(n={});var o=yi(e,r,i,this.numConstants);if(e=o.inputs,r=o.initialState,i=o.constants,Array.isArray(e)&&(r=e.slice(1),e=e[0]),(null==r||0===r.length)&&null==i)return t.prototype.apply.call(this,e,n);var a=[],s=[];if(null!=r){var u=r.length;if(u%2>0)throw new p("When passing `initialState` to a Bidrectional RNN, the state should be an Array containing the states of the underlying RNNs.");n.initialState=r,a.push.apply(a,r);var l=r.map((function(t){return new ce({shape:t.shape})}));this.forwardLayer.stateSpec=l.slice(0,u/2),this.backwardLayer.stateSpec=l.slice(u/2),s.push.apply(s,l)}if(null!=i)throw new m("Support for constants in Bidirectional layers is not implemented yet.");for(var c=a[0]instanceof he,h=0,d=a;h<d.length;h++)if(d[h]instanceof he!==c)throw new p("The initial state of a Bidirectional layer cannot be specified as a mix of symbolic and non-symbolic tensors");if(c){var f=[e].concat(a),g=this.inputSpec.concat(s),y=this.inputSpec;this.inputSpec=g;var v=t.prototype.apply.call(this,f,n);return this.inputSpec=y,v}return t.prototype.apply.call(this,e,n)},e.prototype.call=function(t,e){var n=this;return Object(i.tidy)((function(){if(null!=e.mask)throw new m("The support for masking is not implemented for Bidirectional layers yet.");var r,o,a,s,u=e.initialState;if(null==u)r=n.forwardLayer.call(t,e),o=n.backwardLayer.call(t,e);else{var l=u.slice(0,u.length/2),c=u.slice(u.length/2);r=n.forwardLayer.call(t,Object.assign(e,{initialState:l})),o=n.backwardLayer.call(t,Object.assign(e,{initialState:c}))}return n.returnState&&(Array.isArray(r)&&(a=r.slice(1).concat(o.slice(1))),r=r[0],o=o[0]),n.returnSequences&&(o=Object(i.reverse)(o,1)),"concat"===n.mergeMode?s=gt([r,o]):"sum"===n.mergeMode?s=Object(i.add)(r,o):"ave"===n.mergeMode?s=Object(i.mul)(.5,Object(i.add)(r,o)):"mul"===n.mergeMode?s=Object(i.mul)(r,o):null==n.mergeMode&&(s=[r,o]),n.returnState?null==n.mergeMode?s.concat(a):[s].concat(a):s}))},e.prototype.resetStates=function(t){this.forwardLayer.resetStates(),this.backwardLayer.resetStates()},e.prototype.build=function(t){var e=this;tt(this.forwardLayer.name,(function(){e.forwardLayer.build(t)})),tt(this.backwardLayer.name,(function(){e.backwardLayer.build(t)})),this.built=!0},Object.defineProperty(e.prototype,"trainableWeights",{get:function(){return this.forwardLayer.trainableWeights.concat(this.backwardLayer.trainableWeights)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"nonTrainableWeights",{get:function(){return this.forwardLayer.nonTrainableWeights.concat(this.backwardLayer.nonTrainableWeights)},enumerable:!0,configurable:!0}),e.prototype.setFastWeightInitDuringBuild=function(e){t.prototype.setFastWeightInitDuringBuild.call(this,e),null!=this.forwardLayer&&this.forwardLayer.setFastWeightInitDuringBuild(e),null!=this.backwardLayer&&this.backwardLayer.setFastWeightInitDuringBuild(e)},e.prototype.getConfig=function(){var e={mergeMode:this.mergeMode},n=t.prototype.getConfig.call(this);return Object.assign(e,n),e},e.fromConfig=function(t,e){var n=Ae(e.layer);if(delete e.layer,null!=e.numConstants)throw new m("Deserialization of a Bidirectional layer with numConstants present is not supported yet.");var r=e;return r.layer=n,new t(r)},e.className="Bidirectional",e}(Ni);function Ri(t){return new ii(t)}function Ii(t){return new si(t)}function Mi(t){return new ci(t)}function Fi(t){return new fi(t)}function Pi(t){return new gi(t)}function ji(t){return new ri(t)}function zi(t){return new ai(t)}i.serialization.registerClass(Di);var Li=Object.freeze({inputLayer:function(t){return new ge(t)},elu:function(t){return new cr(t)},reLU:function(t){return new sr(t)},leakyReLU:function(t){return new ur(t)},prelu:function(t){return new lr(t)},softmax:function(t){return new dr(t)},thresholdedReLU:function(t){return new hr(t)},conv1d:function(t){return new Sr(t)},conv2d:function(t){return new xr(t)},conv2dTranspose:function(t){return new Cr(t)},conv3d:function(t){return new _r(t)},separableConv2d:function(t){return new kr(t)},cropping2D:function(t){return new Er(t)},upSampling2d:function(t){return new Or(t)},depthwiseConv2d:function(t){return new Ar(t)},activation:function(t){return new Rr(t)},dense:function(t){return new Tr(t)},dropout:function(t){return new Nr(t)},flatten:function(t){return new Dr(t)},repeatVector:function(t){return new Ir(t)},reshape:function(t){return new Mr(t)},permute:function(t){return new Fr(t)},embedding:function(t){return new jr(t)},add:function(t){return new Lr(t)},average:function(t){return new Ur(t)},concatenate:function(t){return new Wr(t)},maximum:function(t){return new $r(t)},minimum:function(t){return new Vr(t)},multiply:function(t){return new Br(t)},dot:function(t){return new Hr(t)},batchNormalization:function(t){return new Zr(t)},layerNormalization:function(t){return new Qr(t)},zeroPadding2d:function(t){return new Jr(t)},averagePooling1d:Ri,avgPool1d:function(t){return Ri(t)},avgPooling1d:function(t){return Ri(t)},averagePooling2d:Ii,avgPool2d:function(t){return Ii(t)},avgPooling2d:function(t){return Ii(t)},averagePooling3d:Mi,avgPool3d:function(t){return Mi(t)},avgPooling3d:function(t){return Mi(t)},globalAveragePooling1d:function(t){return new di(t)},globalAveragePooling2d:function(t){return new mi(t)},globalMaxPooling1d:Fi,globalMaxPooling2d:Pi,maxPooling1d:ji,maxPooling2d:zi,maxPooling3d:function(t){return new li(t)},gru:function(t){return new ki(t)},gruCell:function(t){return new Ci(t)},lstm:function(t){return new Ei(t)},lstmCell:function(t){return new Si(t)},simpleRNN:function(t){return new _i(t)},simpleRNNCell:function(t){return new xi(t)},rnn:function(t){return new bi(t)},stackedRNNCells:function(t){return new Oi(t)},bidirectional:function(t){return new Di(t)},timeDistributed:function(t){return new Ti(t)},globalMaxPool1d:Fi,globalMaxPool2d:Pi,maxPool1d:ji,maxPool2d:zi,Layer:me,RNN:bi,RNNCell:wi,input:Pn,gaussianNoise:function(t){return new Gr(t)},gaussianDropout:function(t){return new Xr(t)},alphaDropout:function(t){return new Kr(t)},masking:function(t){return new Pr(t)}}),Bi=Object.freeze({binaryAccuracy:function(t,e){return Le(t,e)},binaryCrossentropy:function(t,e){return Ve(t,e)},sparseCategoricalAccuracy:function(t,e){return We(t,e)},categoricalAccuracy:function(t,e){return Be(t,e)},categoricalCrossentropy:function(t,e){return qe(t,e)},precision:function(t,e){return $e(t,e)},recall:function(t,e){return function(t,e){return Object(i.tidy)((function(){var n=Ue(t,e),r=function(t,e){return Object(i.tidy)((function(){return Object(i.logicalAnd)(t.equal(1),e.equal(0)).sum().cast("float32")}))}(t,e),o=n.add(r);return Object(i.where)(Object(i.greater)(o,0),n.div(o),0).cast("float32")}))}(t,e)},cosineProximity:function(t,e){return Pe(t,e)},meanAbsoluteError:function(t,e){return De(t,e)},meanAbsolutePercentageError:function(t,e){return Re(t,e)},MAPE:function(t,e){return Re(t,e)},mape:function(t,e){return Re(t,e)},meanSquaredError:function(t,e){return Te(t,e)},MSE:function(t,e){return Te(t,e)},mse:function(t,e){return Te(t,e)}}),Ui=Object.freeze({modelFromJSON:function(t,e){return l(this,void 0,void 0,(function(){var n,r,o,a,s,u,l,h;return c(this,(function(c){switch(c.label){case 0:return"modelTopology"in t||(t={modelTopology:t}),null!=(n=(t=t).modelTopology).model_config&&(n=n.model_config),r=tn(n),o=Ae(r,e),null==t.weightsManifest?[3,2]:[4,i.io.loadWeights(t.weightsManifest,t.pathPrefix,o.weights.map((function(t){return t.originalName})))];case 1:for(a=c.sent(),s={},u=0,l=o.weights;u<l.length;u++)s[(h=l[u]).originalName]=a[h.originalName];o.loadWeights(s),Object(i.dispose)(a),c.label=2;case 2:return[2,o]}}))}))}}),$i=Object.freeze({l1l2:function(t){return new nr(t)},l1:function(t){return function(t){return tr(t),new nr({l1:null!=t?t.l1:null,l2:0})}(t)},l2:function(t){return function(t){return tr(t),new nr({l2:null!=t?t.l2:null,l1:0})}(t)}}),Vi=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.model=null,e}return a(e,t),e.prototype.setModel=function(t){if(!(t instanceof Tn))throw new Error("model must be a LayersModel, not some other Container");this.model=t},e}(we);function Wi(t,e){return t<e}function qi(t,e){return t>e}var Hi=function(t){function e(e){var n=t.call(this)||this;if(null==e&&(e={}),e.restoreBestWeights)throw new m("restoreBestWeights = True is not implemented in EarlyStopping yet.");return n.monitor=e.monitor||"val_loss",n.minDelta=Math.abs(e.minDelta||0),n.patience=e.patience||0,n.verbose=e.verbose||0,n.mode=e.mode||"auto",n.baseline=e.baseline,-1===["auto","min","max"].indexOf(n.mode)&&(console.warn("EarlyStopping mode '"+n.mode+"' is invalid. Falling back to mode 'auto'."),n.mode="auto"),n.monitorFunc="min"===n.mode?Wi:"max"===n.mode||-1!==n.monitor.indexOf("acc")?qi:Wi,n.monitorFunc===Wi&&(n.minDelta*=-1),n}return a(e,t),e.prototype.onTrainBegin=function(t){return l(this,void 0,void 0,(function(){return c(this,(function(t){return this.wait=0,this.stoppedEpoch=0,this.best=null!=this.baseline?this.baseline:this.monitorFunc===Wi?1/0:-1/0,[2]}))}))},e.prototype.onEpochEnd=function(t,e){return l(this,void 0,void 0,(function(){var n;return c(this,(function(r){switch(r.label){case 0:return[4,ve(e)];case 1:return r.sent(),null==(n=this.getMonitorValue(e))||(this.monitorFunc(n-this.minDelta,this.best)?(this.best=n,this.wait=0):(this.wait++,this.wait>=this.patience&&(this.stoppedEpoch=t,this.model.stopTraining=!0))),[2]}}))}))},e.prototype.onTrainEnd=function(t){return l(this,void 0,void 0,(function(){return c(this,(function(t){return this.stoppedEpoch>0&&this.verbose&&console.log("Epoch "+this.stoppedEpoch+": early stopping."),[2]}))}))},e.prototype.getMonitorValue=function(t){null==t&&(t={});var e=t[this.monitor];return null==e&&console.warn("Metric for EarlyStopping "+this.monitor+" is not available. Available metrics are: "+Object.keys(t)),e},e}(Vi),Gi={earlyStopping:function(t){return new Hi(t)}},Xi=n("tgWb"),Ki=function(t,e){return(Ki=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function Yi(t,e){function n(){this.constructor=t}Ki(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function Zi(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(a,s)}u((r=r.apply(t,e||[])).next())}))}function Qi(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}function Ji(t,e){return t(e={exports:{}},e.exports),e.exports}"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self&&self;var to=Ji((function(t){!function(t,e,n){function r(t,e){return e.c=t.c,e.s0=t.s0,e.s1=t.s1,e.s2=t.s2,e}function i(t,e){var n=new function(t){var e,n=this,r=(e=4022871197,function(t){t=t.toString();for(var n=0;n<t.length;n++){var r=.02519603282416938*(e+=t.charCodeAt(n));r-=e=r>>>0,e=(r*=e)>>>0,e+=4294967296*(r-=e)}return 2.3283064365386963e-10*(e>>>0)});n.next=function(){var t=2091639*n.s0+2.3283064365386963e-10*n.c;return n.s0=n.s1,n.s1=n.s2,n.s2=t-(n.c=0|t)},n.c=1,n.s0=r(" "),n.s1=r(" "),n.s2=r(" "),n.s0-=r(t),n.s0<0&&(n.s0+=1),n.s1-=r(t),n.s1<0&&(n.s1+=1),n.s2-=r(t),n.s2<0&&(n.s2+=1),r=null}(t),i=e&&e.state,o=n.next;return o.int32=function(){return 4294967296*n.next()|0},o.double=function(){return o()+11102230246251565e-32*(2097152*o()|0)},o.quick=o,i&&("object"==typeof i&&r(i,n),o.state=function(){return r(n,{})}),o}e&&e.exports?e.exports=i:this.alea=i}(0,t)})),eo=Ji((function(t){!function(t,e,n){function r(t,e){return e.x=t.x,e.y=t.y,e.z=t.z,e.w=t.w,e}function i(t,e){var n=new function(t){var e=this,n="";e.x=0,e.y=0,e.z=0,e.w=0,e.next=function(){var t=e.x^e.x<<11;return e.x=e.y,e.y=e.z,e.z=e.w,e.w^=e.w>>>19^t^t>>>8},t===(0|t)?e.x=t:n+=t;for(var r=0;r<n.length+64;r++)e.x^=0|n.charCodeAt(r),e.next()}(t),i=e&&e.state,o=function(){return(n.next()>>>0)/4294967296};return o.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},o.int32=n.next,o.quick=o,i&&("object"==typeof i&&r(i,n),o.state=function(){return r(n,{})}),o}e&&e.exports?e.exports=i:this.xor128=i}(0,t)})),no=Ji((function(t){!function(t,e,n){function r(t,e){return e.x=t.x,e.y=t.y,e.z=t.z,e.w=t.w,e.v=t.v,e.d=t.d,e}function i(t,e){var n=new function(t){var e=this,n="";e.next=function(){var t=e.x^e.x>>>2;return e.x=e.y,e.y=e.z,e.z=e.w,e.w=e.v,(e.d=e.d+362437|0)+(e.v=e.v^e.v<<4^t^t<<1)|0},e.x=0,e.y=0,e.z=0,e.w=0,e.v=0,t===(0|t)?e.x=t:n+=t;for(var r=0;r<n.length+64;r++)e.x^=0|n.charCodeAt(r),r==n.length&&(e.d=e.x<<10^e.x>>>4),e.next()}(t),i=e&&e.state,o=function(){return(n.next()>>>0)/4294967296};return o.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},o.int32=n.next,o.quick=o,i&&("object"==typeof i&&r(i,n),o.state=function(){return r(n,{})}),o}e&&e.exports?e.exports=i:this.xorwow=i}(0,t)})),ro=Ji((function(t){!function(t,e,n){function r(t,e){return e.x=t.x.slice(),e.i=t.i,e}function i(t,e){null==t&&(t=+new Date);var n=new function(t){var e=this;e.next=function(){var t,n,r=e.x,i=e.i;return t=r[i],n=(t^=t>>>7)^t<<24,n^=(t=r[i+1&7])^t>>>10,n^=(t=r[i+3&7])^t>>>3,n^=(t=r[i+4&7])^t<<7,t=r[i+7&7],n^=(t^=t<<13)^t<<9,r[i]=n,e.i=i+1&7,n},function(t,e){var n,r=[];if(e===(0|e))r[0]=e;else for(e=""+e,n=0;n<e.length;++n)r[7&n]=r[7&n]<<15^e.charCodeAt(n)+r[n+1&7]<<13;for(;r.length<8;)r.push(0);for(n=0;n<8&&0===r[n];++n);for(8==n&&(r[7]=-1),t.x=r,t.i=0,n=256;n>0;--n)t.next()}(e,t)}(t),i=e&&e.state,o=function(){return(n.next()>>>0)/4294967296};return o.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},o.int32=n.next,o.quick=o,i&&(i.x&&r(i,n),o.state=function(){return r(n,{})}),o}e&&e.exports?e.exports=i:this.xorshift7=i}(0,t)})),io=Ji((function(t){!function(t,e,n){function r(t,e){return e.i=t.i,e.w=t.w,e.X=t.X.slice(),e}function i(t,e){null==t&&(t=+new Date);var n=new function(t){var e=this;e.next=function(){var t,n,r=e.w,i=e.X,o=e.i;return e.w=r=r+1640531527|0,n=i[o+34&127],t=i[o=o+1&127],n^=n<<13,t^=t<<17,n=i[o]=(n^=n>>>15)^(t^=t>>>12),e.i=o,n+(r^r>>>16)|0},function(t,e){var n,r,i,o,a,s=[],u=128;for(e===(0|e)?(r=e,e=null):(e+="\0",r=0,u=Math.max(u,e.length)),i=0,o=-32;o<u;++o)e&&(r^=e.charCodeAt((o+32)%e.length)),0===o&&(a=r),r^=r<<10,r^=r>>>15,r^=r<<4,r^=r>>>13,o>=0&&(i=0==(n=s[127&o]^=r+(a=a+1640531527|0))?i+1:0);for(i>=128&&(s[127&(e&&e.length||0)]=-1),i=127,o=512;o>0;--o)r=s[i+34&127],n=s[i=i+1&127],r^=r<<13,n^=n<<17,s[i]=(r^=r>>>15)^(n^=n>>>12);t.w=a,t.X=s,t.i=i}(e,t)}(t),i=e&&e.state,o=function(){return(n.next()>>>0)/4294967296};return o.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},o.int32=n.next,o.quick=o,i&&(i.X&&r(i,n),o.state=function(){return r(n,{})}),o}e&&e.exports?e.exports=i:this.xor4096=i}(0,t)})),oo=Ji((function(t){!function(t,e,n){function r(t,e){return e.a=t.a,e.b=t.b,e.c=t.c,e.d=t.d,e}function i(t,e){var n=new function(t){var e=this,n="";e.next=function(){var t=e.b,n=e.c,r=e.d,i=e.a;return t=t<<25^t>>>7^n,n=n-r|0,r=r<<24^r>>>8^i,i=i-t|0,e.b=t=t<<20^t>>>12^n,e.c=n=n-r|0,e.d=r<<16^n>>>16^i,e.a=i-t|0},e.a=0,e.b=0,e.c=-1640531527,e.d=1367130551,t===Math.floor(t)?(e.a=t/4294967296|0,e.b=0|t):n+=t;for(var r=0;r<n.length+20;r++)e.b^=0|n.charCodeAt(r),e.next()}(t),i=e&&e.state,o=function(){return(n.next()>>>0)/4294967296};return o.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},o.int32=n.next,o.quick=o,i&&("object"==typeof i&&r(i,n),o.state=function(){return r(n,{})}),o}e&&e.exports?e.exports=i:this.tychei=i}(0,t)})),ao=Ji((function(t){!function(e,r){var i,o=this,a=256,s=r.pow(a,6),u=r.pow(2,52),l=2*u,c=255;function h(t,n,h){var m=[],g=f(function t(e,n){var r,i=[],o=typeof e;if(n&&"object"==o)for(r in e)try{i.push(t(e[r],n-1))}catch(t){}return i.length?i:"string"==o?e:e+"\0"}((n=1==n?{entropy:!0}:n||{}).entropy?[t,p(e)]:null==t?function(){try{var t;return i&&(t=i.randomBytes)?t=t(a):(t=new Uint8Array(a),(o.crypto||o.msCrypto).getRandomValues(t)),p(t)}catch(t){var n=o.navigator,r=n&&n.plugins;return[+new Date,o,r,o.screen,p(e)]}}():t,3),m),y=new function(t){var e,n=t.length,r=this,i=0,o=r.i=r.j=0,s=r.S=[];for(n||(t=[n++]);i<a;)s[i]=i++;for(i=0;i<a;i++)s[i]=s[o=c&o+t[i%n]+(e=s[i])],s[o]=e;(r.g=function(t){for(var e,n=0,i=r.i,o=r.j,s=r.S;t--;)e=s[i=c&i+1],n=n*a+s[c&(s[i]=s[o=c&o+e])+(s[o]=e)];return r.i=i,r.j=o,n})(a)}(m),v=function(){for(var t=y.g(6),e=s,n=0;t<u;)t=(t+n)*a,e*=a,n=y.g(1);for(;t>=l;)t/=2,e/=2,n>>>=1;return(t+n)/e};return v.int32=function(){return 0|y.g(4)},v.quick=function(){return y.g(4)/4294967296},v.double=v,f(p(y.S),e),(n.pass||h||function(t,e,n,i){return i&&(i.S&&d(i,y),t.state=function(){return d(y,{})}),n?(r.random=t,e):t})(v,g,"global"in n?n.global:this==r,n.state)}function d(t,e){return e.i=t.i,e.j=t.j,e.S=t.S.slice(),e}function f(t,e){for(var n,r=t+"",i=0;i<r.length;)e[c&i]=c&(n^=19*e[c&i])+r.charCodeAt(i++);return p(e)}function p(t){return String.fromCharCode.apply(0,t)}if(r.seedrandom=h,f(r.random(),e),t.exports){t.exports=h;try{i=n(4)}catch(t){}}}([],Math)}));ao.alea=to,ao.xor128=eo,ao.xorwow=no,ao.xorshift7=ro,ao.xor4096=io,ao.tychei=oo;var so=ao.alea;function uo(t,e,n,r){if(void 0===n&&(n=new Map),void 0===r&&(r=new Set),null==t)return null;if(r.has(t))throw new Error("Circular references are not supported.");if(n.has(t))return n.get(t);var i=e(t);if(i.recurse&&null!==i.value)throw new Error("A deep map function may not return both a value and recurse=true.");if(i.recurse){if(ho(t)){var o=Array.isArray(t)?[]:{};for(var a in r.add(t),t){var s=uo(t[a],e,n,r);o[a]=s}return r.delete(t),o}throw new Error("Can't recurse into non-iterable type: "+t)}return n.set(t,i.value),i.value}function lo(t){return null===t?null:ho(t[0])?{value:null,recurse:!0}:{value:t,recurse:!1}}function co(t,e){return Zi(this,void 0,void 0,(function(){var n,r,i,o,a,s;return Qi(this,(function(u){switch(u.label){case 0:n=new Map,uo(t,e,n),r=0,i=Array.from(n.keys()),u.label=1;case 1:return r<i.length?(a=n.get(o=i[r]))instanceof Promise?[4,a]:[3,3]:[3,4];case 2:s=u.sent(),n.set(o,s),u.label=3;case 3:return r++,[3,1];case 4:return[2,uo(t,e,n)]}}))}))}function ho(t){return null!=t&&!ArrayBuffer.isView(t)&&(Array.isArray(t)||"object"==typeof t&&!(t instanceof i.Tensor))}function fo(t){return function(t,e){return uo(t,e)}(t,po)}function po(t){return t instanceof i.Tensor?{value:t.clone(),recurse:!1}:ho(t)?{value:null,recurse:!0}:{value:t,recurse:!1}}var mo=function(){function t(t){if(this.capacity=t,this.begin=0,this.end=0,null==t)throw new RangeError("Can't create a ring buffer of unknown capacity.");if(t<1)throw new RangeError("Can't create ring buffer of capacity < 1.");this.data=new Array(t),this.doubledCapacity=2*t}return t.prototype.wrap=function(t){for(;t<0;)t+=this.doubledCapacity;return t%this.doubledCapacity},t.prototype.get=function(t){if(t<0)throw new RangeError("Can't get item at a negative index.");return this.data[t%this.capacity]},t.prototype.set=function(t,e){if(t<0)throw new RangeError("Can't set item at a negative index.");this.data[t%this.capacity]=e},t.prototype.length=function(){var t=this.end-this.begin;return t<0&&(t=this.doubledCapacity+t),t},t.prototype.isFull=function(){return this.length()===this.capacity},t.prototype.isEmpty=function(){return 0===this.length()},t.prototype.push=function(t){if(this.isFull())throw new RangeError("Ring buffer is full.");this.set(this.end,t),this.end=this.wrap(this.end+1)},t.prototype.pushAll=function(t){for(var e=0,n=t;e<n.length;e++)this.push(n[e])},t.prototype.pop=function(){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");this.end=this.wrap(this.end-1);var t=this.get(this.end);return this.set(this.end,void 0),t},t.prototype.unshift=function(t){if(this.isFull())throw new RangeError("Ring buffer is full.");this.begin=this.wrap(this.begin-1),this.set(this.begin,t)},t.prototype.shift=function(){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");var t=this.get(this.begin);return this.set(this.begin,void 0),this.begin=this.wrap(this.begin+1),t},t.prototype.shuffleExcise=function(t){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");var e=this.wrap(this.begin+t),n=this.get(e);return this.set(e,this.pop()),n},t}(),go=function(t){function e(){return t.call(this,e.INITIAL_CAPACITY)||this}return Yi(e,t),e.prototype.isFull=function(){return!1},e.prototype.push=function(e){t.prototype.isFull.call(this)&&this.expand(),t.prototype.push.call(this,e)},e.prototype.unshift=function(e){t.prototype.isFull.call(this)&&this.expand(),t.prototype.unshift.call(this,e)},e.prototype.expand=function(){for(var t=2*this.capacity,e=new Array(t),n=this.length(),r=0;r<n;r++)e[r]=this.get(this.wrap(this.begin+r));this.data=e,this.capacity=t,this.doubledCapacity=2*this.capacity,this.begin=0,this.end=n},e.INITIAL_CAPACITY=32,e}(mo);function yo(t){return new ko(t)}function vo(t){return new So(t)}function bo(t,e){return new Po(t,e)}function wo(t,e){return void 0===e&&(e=xo.FAIL),new jo(t,e)}var xo,_o,Co=function(){function t(){}return t.prototype.toArray=function(){return Zi(this,void 0,void 0,(function(){var t,e;return Qi(this,(function(n){switch(n.label){case 0:return t=[],[4,this.next()];case 1:e=n.sent(),n.label=2;case 2:return e.done?[3,4]:(t.push(e.value),[4,this.next()]);case 3:return e=n.sent(),[3,2];case 4:return[2,t]}}))}))},t.prototype.toArrayForTest=function(){return Zi(this,void 0,void 0,(function(){var t,e,n;return Qi(this,(function(r){switch(r.label){case 0:return t=this.prefetch(100),e=[],[4,t.next()];case 1:n=r.sent(),r.label=2;case 2:return n.done?[3,4]:(e.push(n.value),[4,t.next()]);case 3:return n=r.sent(),[3,2];case 4:return[2,e]}}))}))},t.prototype.resolveFully=function(){return Zi(this,void 0,void 0,(function(){var t;return Qi(this,(function(e){switch(e.label){case 0:return[4,this.next()];case 1:t=e.sent(),e.label=2;case 2:return t.done?[3,4]:[4,this.next()];case 3:return t=e.sent(),[3,2];case 4:return[2]}}))}))},t.prototype.resolveWhile=function(t){return Zi(this,void 0,void 0,(function(){var e,n;return Qi(this,(function(r){switch(r.label){case 0:return[4,this.next()];case 1:e=r.sent(),n=t(e.value),r.label=2;case 2:return e.done||!n?[3,4]:[4,this.next()];case 3:return e=r.sent(),n=t(e.value),[3,2];case 4:return[2]}}))}))},t.prototype.handleErrors=function(t){return new Ro(this,t)},t.prototype.filter=function(t){return new To(this,t)},t.prototype.map=function(t){return new Do(this,t)},t.prototype.mapAsync=function(t){return new Io(this,t)},t.prototype.serialMapAsync=function(t){return new Io(this,t).serial()},t.prototype.flatmap=function(t){return new Fo(this,t)},t.prototype.forEachAsync=function(t){return Zi(this,void 0,void 0,(function(){return Qi(this,(function(e){return[2,this.map(t).resolveFully()]}))}))},t.prototype.serialForEach=function(t){return Zi(this,void 0,void 0,(function(){return Qi(this,(function(e){return[2,this.serialMapAsync(t).resolveWhile((function(t){return!0===t}))]}))}))},t.prototype.rowMajorBatch=function(t,e){return void 0===e&&(e=!0),new No(this,t,e)},t.prototype.columnMajorBatch=function(t,e,n){return void 0===e&&(e=!0),void 0===n&&(n=lo),this.rowMajorBatch(t,e).map((function(t){return function(t,e){return void 0===e&&(e=lo),function t(e,n,r){void 0===r&&(r=new Set);var i=e[0];if(r.has(i))throw new Error("Circular references are not supported.");var o=n(e);if(o.recurse&&null!==o.value)throw new Error("A deep zip function may not return both a value and recurse=true.");if(o.recurse){if(ho(i)){var a=Array.isArray(i)?[]:{};r.add(i);var s=function(i){var o=t(e.map((function(t){return t[i]})),n,r);a[i]=o};for(var u in i)s(u);return r.delete(i),a}throw new Error("Can't recurse into non-iterable type: "+i)}return o.value}(t,e)}(t,n)}))},t.prototype.concatenate=function(t,e){return new Po(yo([this,t]),e)},t.prototype.take=function(t){return t<0||null==t?this:new Ao(this,t)},t.prototype.skip=function(t){return t<0||null==t?this:new Oo(this,t)},t.prototype.prefetch=function(t){return new zo(this,t)},t.prototype.shuffle=function(t,e){return new Lo(this,t,e)},t.prototype.serial=function(){return new Eo(this)},t}(),ko=function(t){function e(e){var n=t.call(this)||this;return n.items=e,n.trav=0,n}return Yi(e,t),e.prototype.summary=function(){return"Array of "+this.items.length+" items"},e.prototype.next=function(){return Zi(this,void 0,void 0,(function(){var t;return Qi(this,(function(e){return this.trav>=this.items.length?[2,{value:null,done:!0}]:(t=this.items[this.trav],this.trav++,[2,{value:fo(t),done:!1}])}))}))},e}(Co),So=function(t){function e(e){var n=t.call(this)||this;return n.nextFn=e,n}return Yi(e,t),e.prototype.summary=function(){return"Function call"},e.prototype.next=function(){return Zi(this,void 0,void 0,(function(){return Qi(this,(function(t){try{return[2,this.nextFn()]}catch(t){throw t.message="Error thrown while iterating through a dataset: "+t.message,t}return[2]}))}))},e}(Co),Eo=function(t){function e(e){var n=t.call(this)||this;return n.upstream=e,n.lastRead=Promise.resolve({value:null,done:!1}),n}return Yi(e,t),e.prototype.summary=function(){return this.upstream.summary()+" -> Serial"},e.prototype.next=function(){return Zi(this,void 0,void 0,(function(){var t=this;return Qi(this,(function(e){return this.lastRead=this.lastRead.then((function(){return t.serialNext()})),[2,this.lastRead]}))}))},e.prototype.serialNext=function(){return Zi(this,void 0,void 0,(function(){return Qi(this,(function(t){return[2,this.upstream.next()]}))}))},e}(Co),Oo=function(t){function e(e,n){var r=t.call(this)||this;return r.upstream=e,r.maxCount=n,r.count=0,r.lastRead=Promise.resolve({value:null,done:!1}),r}return Yi(e,t),e.prototype.summary=function(){return this.upstream.summary()+" -> Skip"},e.prototype.next=function(){return Zi(this,void 0,void 0,(function(){var t=this;return Qi(this,(function(e){return this.lastRead=this.lastRead.then((function(){return t.serialNext()})),[2,this.lastRead]}))}))},e.prototype.serialNext=function(){return Zi(this,void 0,void 0,(function(){var t;return Qi(this,(function(e){switch(e.label){case 0:return this.count++<this.maxCount?[4,this.upstream.next()]:[3,2];case 1:return(t=e.sent()).done?[2,t]:(Object(i.dispose)(t.value),[3,0]);case 2:return[2,this.upstream.next()]}}))}))},e}(Co),Ao=function(t){function e(e,n){var r=t.call(this)||this;return r.upstream=e,r.maxCount=n,r.count=0,r}return Yi(e,t),e.prototype.summary=function(){return this.upstream.summary()+" -> Take"},e.prototype.next=function(){return Zi(this,void 0,void 0,(function(){return Qi(this,(function(t){return this.count++>=this.maxCount?[2,{value:null,done:!0}]:[2,this.upstream.next()]}))}))},e}(Co),No=function(t){function e(e,n,r){void 0===r&&(r=!0);var i=t.call(this)||this;return i.upstream=e,i.batchSize=n,i.enableSmallLastBatch=r,i.lastRead=Promise.resolve({value:null,done:!1}),i}return Yi(e,t),e.prototype.summary=function(){return this.upstream.summary()+" -> RowMajorBatch"},e.prototype.next=function(){return Zi(this,void 0,void 0,(function(){var t=this;return Qi(this,(function(e){return this.lastRead=this.lastRead.then((function(){return t.serialNext()})),[2,this.lastRead]}))}))},e.prototype.serialNext=function(){return Zi(this,void 0,void 0,(function(){var t,e;return Qi(this,(function(n){switch(n.label){case 0:t=[],n.label=1;case 1:return t.length<this.batchSize?[4,this.upstream.next()]:[3,3];case 2:return(e=n.sent()).done?this.enableSmallLastBatch&&t.length>0?[2,{value:t,done:!1}]:[2,{value:null,done:!0}]:(t.push(e.value),[3,1]);case 3:return[2,{value:t,done:!1}]}}))}))},e}(Co),To=function(t){function e(e,n){var r=t.call(this)||this;return r.upstream=e,r.predicate=n,r.lastRead=Promise.resolve({value:null,done:!1}),r}return Yi(e,t),e.prototype.summary=function(){return this.upstream.summary()+" -> Filter"},e.prototype.next=function(){return Zi(this,void 0,void 0,(function(){var t=this;return Qi(this,(function(e){return this.lastRead=this.lastRead.then((function(){return t.serialNext()})),[2,this.lastRead]}))}))},e.prototype.serialNext=function(){return Zi(this,void 0,void 0,(function(){var t;return Qi(this,(function(e){switch(e.label){case 0:return[4,this.upstream.next()];case 1:return(t=e.sent()).done||this.predicate(t.value)?[2,t]:(Object(i.dispose)(t.value),[3,0]);case 2:return[2]}}))}))},e}(Co),Do=function(t){function e(e,n){var r=t.call(this)||this;return r.upstream=e,r.transform=n,r}return Yi(e,t),e.prototype.summary=function(){return this.upstream.summary()+" -> Map"},e.prototype.next=function(){return Zi(this,void 0,void 0,(function(){var t,e,n,r,o,a,s;return Qi(this,(function(u){switch(u.label){case 0:return[4,this.upstream.next()];case 1:if((t=u.sent()).done)return[2,{value:null,done:!0}];for(e=i.tensor_util.getTensorsInContainer(t.value),n=this.transform(t.value),r=i.tensor_util.getTensorsInContainer(n),o=0,a=e;o<a.length;o++)i.tensor_util.isTensorInList(s=a[o],r)||s.dispose();return[2,{value:n,done:!1}]}}))}))},e}(Co),Ro=function(t){function e(e,n){var r=t.call(this)||this;return r.upstream=e,r.handler=n,r.count=0,r.lastRead=Promise.resolve({value:null,done:!1}),r}return Yi(e,t),e.prototype.summary=function(){return this.upstream.summary()+" -> handleErrors"},e.prototype.next=function(){return Zi(this,void 0,void 0,(function(){var t=this;return Qi(this,(function(e){return this.lastRead=this.lastRead.then((function(){return t.serialNext()})),[2,this.lastRead]}))}))},e.prototype.serialNext=function(){return Zi(this,void 0,void 0,(function(){var t;return Qi(this,(function(e){switch(e.label){case 0:e.label=1;case 1:return e.trys.push([1,3,,4]),[4,this.upstream.next()];case 2:return[2,e.sent()];case 3:return t=e.sent(),this.handler(t)?[3,4]:[2,{value:null,done:!0}];case 4:return[3,0];case 5:return[2]}}))}))},e}(Co),Io=function(t){function e(e,n){var r=t.call(this)||this;return r.upstream=e,r.transform=n,r}return Yi(e,t),e.prototype.summary=function(){return this.upstream.summary()+" -> AsyncMap"},e.prototype.next=function(){return Zi(this,void 0,void 0,(function(){var t,e,n,r,o,a,s;return Qi(this,(function(u){switch(u.label){case 0:return[4,this.upstream.next()];case 1:return(t=u.sent()).done?[2,{value:null,done:!0}]:(e=i.tensor_util.getTensorsInContainer(t.value),[4,this.transform(t.value)]);case 2:for(n=u.sent(),r=i.tensor_util.getTensorsInContainer(n),o=0,a=e;o<a.length;o++)i.tensor_util.isTensorInList(s=a[o],r)||s.dispose();return[2,{value:n,done:!1}]}}))}))},e}(Co),Mo=function(t){function e(){var e=t.call(this)||this;return e.outputQueue=new go,e.lastRead=Promise.resolve({value:null,done:!1}),e}return Yi(e,t),e.prototype.next=function(){return Zi(this,void 0,void 0,(function(){var t=this;return Qi(this,(function(e){return this.lastRead=this.lastRead.then((function(){return t.serialNext()})),[2,this.lastRead]}))}))},e.prototype.serialNext=function(){return Zi(this,void 0,void 0,(function(){return Qi(this,(function(t){switch(t.label){case 0:return 0!==this.outputQueue.length()?[3,2]:[4,this.pump()];case 1:return t.sent()?[3,0]:[2,{value:null,done:!0}];case 2:return[2,{value:this.outputQueue.shift(),done:!1}]}}))}))},e}(Co),Fo=function(t){function e(e,n){var r=t.call(this)||this;return r.upstream=e,r.transform=n,r}return Yi(e,t),e.prototype.summary=function(){return this.upstream.summary()+" -> Flatmap"},e.prototype.pump=function(){return Zi(this,void 0,void 0,(function(){var t,e,n,r,o,a,s;return Qi(this,(function(u){switch(u.label){case 0:return[4,this.upstream.next()];case 1:if((t=u.sent()).done)return[2,!1];for(e=i.tensor_util.getTensorsInContainer(t.value),n=this.transform(t.value),r=i.tensor_util.getTensorsInContainer(n),this.outputQueue.pushAll(n),o=0,a=e;o<a.length;o++)i.tensor_util.isTensorInList(s=a[o],r)||s.dispose();return[2,!0]}}))}))},e}(Mo),Po=function(t){function e(e,n){var r=t.call(this)||this;return r.baseErrorHandler=n,r.lastRead=null,r.iterator=null,r.moreIterators=e,r}return Yi(e,t),e.prototype.summary=function(){return"TODO: fill in upstream of chained summaries -> Chained"},e.prototype.next=function(){return Zi(this,void 0,void 0,(function(){return Qi(this,(function(t){return this.lastRead=this.readFromChain(this.lastRead),[2,this.lastRead]}))}))},e.prototype.readFromChain=function(t){return Zi(this,void 0,void 0,(function(){var e,n;return Qi(this,(function(r){switch(r.label){case 0:return[4,t];case 1:return r.sent(),null!=this.iterator?[3,3]:[4,this.moreIterators.next()];case 2:if((e=r.sent()).done)return[2,{value:null,done:!0}];this.iterator=e.value,null!=this.baseErrorHandler&&(this.iterator=this.iterator.handleErrors(this.baseErrorHandler)),r.label=3;case 3:return[4,this.iterator.next()];case 4:return(n=r.sent()).done?(this.iterator=null,[2,this.readFromChain(t)]):[2,n]}}))}))},e}(Co);(_o=xo||(xo={}))[_o.FAIL=0]="FAIL",_o[_o.SHORTEST=1]="SHORTEST",_o[_o.LONGEST=2]="LONGEST";var jo=function(t){function e(e,n){void 0===n&&(n=xo.FAIL);var r=t.call(this)||this;return r.iterators=e,r.mismatchMode=n,r.count=0,r.currentPromise=null,r}return Yi(e,t),e.prototype.summary=function(){return"{TODO: fill in upstream of zip summaries} -> Zip"},e.prototype.nextState=function(t){return Zi(this,void 0,void 0,(function(){function e(t){return t instanceof Co?{value:t.next().then((function(t){return n++,t.done&&r++,t.value})),recurse:!1}:{value:null,recurse:!0}}var n,r,i;return Qi(this,(function(o){switch(o.label){case 0:return[4,t];case 1:return o.sent(),n=0,r=0,[4,co(this.iterators,e)];case 2:if(i=o.sent(),n===r)return[2,{value:null,done:!0}];if(r>0)switch(this.mismatchMode){case xo.FAIL:throw new Error("Zipped streams should have the same length. Mismatched at element "+this.count+".");case xo.SHORTEST:return[2,{value:null,done:!0}]}return this.count++,[2,{value:i,done:!1}]}}))}))},e.prototype.next=function(){return Zi(this,void 0,void 0,(function(){return Qi(this,(function(t){return this.currentPromise=this.nextState(this.currentPromise),[2,this.currentPromise]}))}))},e}(Co),zo=function(t){function e(e,n){var r=t.call(this)||this;return r.upstream=e,r.bufferSize=n,r.buffer=new mo(n),r}return Yi(e,t),e.prototype.summary=function(){return this.upstream.summary()+" -> Prefetch"},e.prototype.refill=function(){for(;!this.buffer.isFull();){var t=this.upstream.next();this.buffer.push(t)}},e.prototype.next=function(){return this.refill(),this.buffer.shift()},e}(Co),Lo=function(t){function e(e,n,r){var o=t.call(this,e,n)||this;return o.upstream=e,o.windowSize=n,o.upstreamExhausted=!1,o.random=so(r||i.util.now().toString()),o.lastRead=Promise.resolve({value:null,done:!1}),o}return Yi(e,t),e.prototype.next=function(){return Zi(this,void 0,void 0,(function(){var t=this;return Qi(this,(function(e){return this.lastRead=this.lastRead.then((function(){return t.serialNext()})),[2,this.lastRead]}))}))},e.prototype.randomInt=function(t){return Math.floor(this.random()*t)},e.prototype.chooseIndex=function(){return this.randomInt(this.buffer.length())},e.prototype.serialNext=function(){return Zi(this,void 0,void 0,(function(){var t,e;return Qi(this,(function(n){switch(n.label){case 0:this.upstreamExhausted||this.refill(),n.label=1;case 1:return this.buffer.isEmpty()?[3,3]:(t=this.chooseIndex(),[4,this.buffer.shuffleExcise(t)]);case 2:return(e=n.sent()).done?(this.upstreamExhausted=!0,[3,1]):(this.refill(),[2,e]);case 3:return[2,{value:null,done:!0}]}}))}))},e}(zo),Bo=function(){function t(){this.size=null}return t.prototype.batch=function(t,e){var n=this;void 0===e&&(e=!0);var r=this;return i.util.assert(t>0,(function(){return"batchSize needs to be positive, but it is\n      "+t})),Uo((function(){return Zi(n,void 0,void 0,(function(){return Qi(this,(function(n){switch(n.label){case 0:return[4,r.iterator()];case 1:return[2,n.sent().columnMajorBatch(t,e,Wo)]}}))}))}),this.size===1/0||null==this.size?this.size:e?Math.ceil(this.size/t):Math.floor(this.size/t))},t.prototype.concatenate=function(t){var e=this,n=this;return Uo((function(){return Zi(e,void 0,void 0,(function(){var e,r;return Qi(this,(function(i){switch(i.label){case 0:return[4,n.iterator()];case 1:return r=(e=i.sent()).concatenate,[4,t.iterator()];case 2:return[2,r.apply(e,[i.sent()])]}}))}))}),this.size===1/0||t.size===1/0?1/0:null!=this.size&&null!=t.size?this.size+t.size:null)},t.prototype.filter=function(t){var e=this,n=this;return Uo((function(){return Zi(e,void 0,void 0,(function(){return Qi(this,(function(e){switch(e.label){case 0:return[4,n.iterator()];case 1:return[2,e.sent().filter((function(e){return Object(i.tidy)((function(){return t(e)}))}))]}}))}))}),this.size===1/0?1/0:null)},t.prototype.forEachAsync=function(t){return Zi(this,void 0,void 0,(function(){return Qi(this,(function(e){switch(e.label){case 0:return[4,this.iterator()];case 1:return[2,e.sent().forEachAsync(t)]}}))}))},t.prototype.forEach=function(t){return Zi(this,void 0,void 0,(function(){return Qi(this,(function(e){return Object(i.deprecationWarn)("dataset.forEach() is deprecated and will be removed. Please use dataset.forEachAsync() instead"),[2,this.forEachAsync(t)]}))}))},t.prototype.map=function(t){var e=this,n=this;return Uo((function(){return Zi(e,void 0,void 0,(function(){return Qi(this,(function(e){switch(e.label){case 0:return[4,n.iterator()];case 1:return[2,e.sent().map((function(e){return Object(i.tidy)((function(){return t(e)}))}))]}}))}))}),this.size)},t.prototype.mapAsync=function(t){var e=this,n=this;return Uo((function(){return Zi(e,void 0,void 0,(function(){return Qi(this,(function(e){switch(e.label){case 0:return[4,n.iterator()];case 1:return[2,e.sent().mapAsync(t)]}}))}))}),this.size)},t.prototype.prefetch=function(t){var e=this;if(null==t)throw new RangeError("`Dataset.prefetch()` requires bufferSize to be specified.");var n=this;return Uo((function(){return Zi(e,void 0,void 0,(function(){return Qi(this,(function(e){switch(e.label){case 0:return[4,n.iterator()];case 1:return[2,e.sent().prefetch(t)]}}))}))}),this.size)},t.prototype.repeat=function(t){var e=this,n=this;return Uo((function(){return Zi(e,void 0,void 0,(function(){var e=this;return Qi(this,(function(r){return[2,bo(vo((function(){return Zi(e,void 0,void 0,(function(){var t;return Qi(this,(function(e){switch(e.label){case 0:return t={},[4,n.iterator()];case 1:return[2,(t.value=e.sent(),t.done=!1,t)]}}))}))})).take(t))]}))}))}),null!=this.size&&t>0?this.size*t:0===t?0:null!=this.size&&(void 0===t||t<0)?1/0:null)},t.prototype.skip=function(t){var e=this,n=this;return Uo((function(){return Zi(e,void 0,void 0,(function(){return Qi(this,(function(e){switch(e.label){case 0:return[4,n.iterator()];case 1:return[2,e.sent().skip(t)]}}))}))}),null!=this.size&&t>=0&&this.size>=t?this.size-t:null!=this.size&&(this.size<t||void 0===t||t<0)?0:null)},t.prototype.shuffle=function(t,e,n){var r=this;if(void 0===n&&(n=!0),null==t||t<0)throw null==this.size?new RangeError("`Dataset.shuffle()` requires bufferSize to be specified."):new RangeError("`Dataset.shuffle()` requires bufferSize to be specified.  If your data fits in main memory (for regular JS objects), and/or GPU memory (for `tf.Tensor`s), consider setting bufferSize to the dataset size ("+this.size+" elements)");var o=this,a=so(e||i.util.now().toString());return Uo((function(){return Zi(r,void 0,void 0,(function(){var e;return Qi(this,(function(r){switch(r.label){case 0:return e=a.int32(),n&&(e+=a.int32()),[4,o.iterator()];case 1:return[2,r.sent().shuffle(t,e.toString())]}}))}))}),this.size)},t.prototype.take=function(t){var e=this,n=this;return Uo((function(){return Zi(e,void 0,void 0,(function(){return Qi(this,(function(e){switch(e.label){case 0:return[4,n.iterator()];case 1:return[2,e.sent().take(t)]}}))}))}),null!=this.size&&this.size>t?t:null!=this.size&&this.size<=t?this.size:null)},t.prototype.toArray=function(){return Zi(this,void 0,void 0,(function(){return Qi(this,(function(t){switch(t.label){case 0:if(this.size===1/0)throw new Error("Can not convert infinite data stream to array.");return[4,this.iterator()];case 1:return[2,t.sent().toArray()]}}))}))},t.prototype.toArrayForTest=function(){return Zi(this,void 0,void 0,(function(){return Qi(this,(function(t){switch(t.label){case 0:if(this.size===1/0)throw new Error("Can not convert infinite data stream to array.");return[4,this.iterator()];case 1:return[2,t.sent().toArrayForTest()]}}))}))},t.MAX_BUFFER_SIZE=1e4,t}();function Uo(t,e){return void 0===e&&(e=null),new(function(n){function r(){var t=null!==n&&n.apply(this,arguments)||this;return t.size=e,t}return Yi(r,n),r.prototype.iterator=function(){return Zi(this,void 0,void 0,(function(){return Qi(this,(function(e){return[2,t()]}))}))},r}(Bo))}function $o(t){var e=this;return Uo((function(){return Zi(e,void 0,void 0,(function(){return Qi(this,(function(e){return[2,yo(t)]}))}))}),t.length)}function Vo(t){var e,n=this;if(!ho(t))throw new Error("The argument to zip() must be an object or array.");if(Array.isArray(t))for(var r=0;r<t.length;r++)e=null==e?t[r].size:Math.min(e,t[r].size);else if(t instanceof Object)for(var i in t)e=null==e?t[i].size:Math.min(e,t[i].size);return Uo((function(){return Zi(n,void 0,void 0,(function(){return Qi(this,(function(e){switch(e.label){case 0:return[4,co(t,(function(t){if(t instanceof Bo)return{value:t.iterator(),recurse:!1};if(ho(t))return{value:null,recurse:!0};throw new Error("Leaves of the structure passed to zip() must be Datasets, not primitives.")}))];case 1:return[2,wo(e.sent(),xo.SHORTEST)]}}))}))}),e)}function Wo(t){return null===t?null:function(t){return null==t||function(t){return null===t||"object"!=typeof t&&"function"!=typeof t}(t)||Array.isArray(t)||"object"==typeof t&&t instanceof i.Tensor||i.util.isTypedArray(t)}(t[0])?{value:qo(t),recurse:!1}:{value:null,recurse:!0}}function qo(t){if(0===t.length)throw new Error("Can't make a batch of zero elements.");return t[0]instanceof i.Tensor?Object(i.stack)(t):Object(i.tensor)(t)}var Ho=function(t){function e(e){var n=t.call(this)||this;return n.input=e,n}return Yi(e,t),e.prototype.iterator=function(){return Zi(this,void 0,void 0,(function(){return Qi(this,(function(t){switch(t.label){case 0:return[4,this.input.iterator()];case 1:return[2,t.sent().decodeUTF8().split("\n").map((function(t){return t.endsWith("\r")&&(t=t.slice(0,-1)),t}))]}}))}))},e}(Bo),Go=Symbol("out"),Xo=Symbol("field"),Ko=Symbol("quote"),Yo=Symbol("quoteafterquote"),Zo=Symbol("quoteinquote"),Qo=function(t){function e(e,n){var r=t.call(this)||this;return r.input=e,r.hasHeader=!0,r.fullColumnNames=null,r.columnNamesValidated=!1,r.columnConfigs=null,r.configuredColumnsOnly=!1,r.delimiter=",",r.delimWhitespace=!1,r.base=new Ho(e),n||(n={}),r.hasHeader=!1!==n.hasHeader,r.fullColumnNames=n.columnNames,r.columnConfigs=n.columnConfigs,r.configuredColumnsOnly=n.configuredColumnsOnly,n.delimWhitespace?(i.util.assert(null==n.delimiter,(function(){return"Delimiter should not be provided when delimWhitespace is true."})),r.delimWhitespace=!0,r.delimiter=" "):r.delimiter=n.delimiter?n.delimiter:",",r}return Yi(e,t),e.prototype.columnNames=function(){return Zi(this,void 0,void 0,(function(){return Qi(this,(function(t){switch(t.label){case 0:return this.columnNamesValidated?[3,2]:[4,this.setColumnNames()];case 1:t.sent(),t.label=2;case 2:return[2,this.configuredColumnsOnly?Object.keys(this.columnConfigs):this.fullColumnNames]}}))}))},e.prototype.setColumnNames=function(){return Zi(this,void 0,void 0,(function(){var t,e,n,r,o,a,s=this;return Qi(this,(function(u){switch(u.label){case 0:return[4,this.maybeReadHeaderLine()];case 1:if(t=u.sent(),!this.fullColumnNames&&!t)throw new Error("Column names must be provided if there is no header line.");if(this.fullColumnNames&&t&&i.util.assert(t.length===this.fullColumnNames.length,(function(){return"The length of provided columnNames ("+s.fullColumnNames.length.toString()+") does not match the length of the header line read from file ("+t.length.toString()+")."})),this.fullColumnNames||(this.fullColumnNames=t),e=this.fullColumnNames.reduce((function(t,e){return t[e]=t[e]+1||1,t}),{}),n=Object.keys(e).filter((function(t){return e[t]>1})),i.util.assert(0===n.length,(function(){return"Duplicate column names found: "+n.toString()})),this.columnConfigs)for(r=0,o=Object.keys(this.columnConfigs);r<o.length;r++)if(-1===this.fullColumnNames.indexOf(a=o[r]))throw new Error('The key "'+a+'" provided in columnConfigs does not match any of the column names ('+this.fullColumnNames.toString()+").");return this.columnNamesValidated=!0,[2]}}))}))},e.prototype.maybeReadHeaderLine=function(){return Zi(this,void 0,void 0,(function(){var t;return Qi(this,(function(e){switch(e.label){case 0:return this.hasHeader?[4,this.base.iterator()]:[3,3];case 1:return[4,e.sent().next()];case 2:if((t=e.sent()).done)throw new Error("No data was found for CSV parsing.");return[2,this.parseRow(t.value,!1)];case 3:return[2,null]}}))}))},e.prototype.iterator=function(){return Zi(this,void 0,void 0,(function(){var t,e=this;return Qi(this,(function(n){switch(n.label){case 0:return this.columnNamesValidated?[3,2]:[4,this.setColumnNames()];case 1:n.sent(),n.label=2;case 2:return[4,this.base.iterator()];case 3:return t=n.sent(),this.hasHeader&&(t=t.skip(1)),[2,t.map((function(t){return e.makeDataElement(t)}))]}}))}))},e.prototype.makeDataElement=function(t){for(var e=this.parseRow(t),n={},r={},i=0;i<this.fullColumnNames.length;i++){var o=this.fullColumnNames[i],a=this.columnConfigs?this.columnConfigs[o]:null;if(!this.configuredColumnsOnly||a){var s=e[i],u=null;if(""===s)if(a&&void 0!==a.default)u=a.default;else{if(a&&(a.required||a.isLabel))throw new Error("Required column "+o+" is empty in this line: "+t);u=void 0}else{var l=Number(s);if(isNaN(l))u=a&&"bool"===a.dtype?this.getBoolean(s):s;else if(a&&a.dtype)switch(a.dtype){case"float32":u=l;break;case"int32":u=Math.floor(l);break;case"bool":u=this.getBoolean(s);break;default:u=l}else u=l}a&&a.isLabel?r[o]=u:n[o]=u}}return 0===Object.keys(r).length?n:{xs:n,ys:r}},e.prototype.getBoolean=function(t){return"1"===t||"true"===t.toLowerCase()?1:0},e.prototype.parseRow=function(t,e){void 0===e&&(e=!0);for(var n=[],r=0,i=t.length,o=Go,a=0;a<i;a++)switch(o){case Go:switch(t.charAt(a)){case'"':r=a+1,o=Ko;break;case this.delimiter:if(r=a+1," "===this.delimiter&&this.delimWhitespace)break;n.push(""),o=Go;break;default:o=Xo,r=a}break;case Xo:switch(t.charAt(a)){case this.delimiter:n.push(t.substring(r,a)),o=Go,r=a+1}break;case Ko:switch(t.charAt(a)){case'"':o=Yo}break;case Yo:switch(t.charAt(a)){case this.delimiter:n.push(t.substring(r,a-1)),o=Go,r=a+1;break;case'"':o=Ko;break;default:o=Zo}break;case Zo:switch(t.charAt(a)){case'"':o=Ko}}if(n.push(o===Yo?t.substring(r,i-1):t.substring(r)),e&&n.length!==this.fullColumnNames.length)throw new Error("Invalid row in csv file. Should have "+this.fullColumnNames.length+" elements in a row, but got "+n);return n},e}(Bo),Jo=function(t){function e(e){var n=t.call(this)||this;n.microphoneConfig=e,n.isClosed=!1,n.fftSize=e.fftSize||1024;var r=Math.log2(n.fftSize);if(n.fftSize<0||r<4||r>14||!Number.isInteger(r))throw new Error("Invalid fftSize: it must be a power of 2 between 2 to 4 and 2 to 14, but got "+n.fftSize);if(n.numFrames=e.numFramesPerSpectrogram||43,n.sampleRateHz=e.sampleRateHz,n.columnTruncateLength=e.columnTruncateLength||n.fftSize,n.audioTrackConstraints=e.audioTrackConstraints,n.smoothingTimeConstant=e.smoothingTimeConstant||0,n.includeSpectrogram=!1!==e.includeSpectrogram,n.includeWaveform=!0===e.includeWaveform,!n.includeSpectrogram&&!n.includeWaveform)throw new Error("Both includeSpectrogram and includeWaveform are false. At least one type of data should be returned.");return n}return Yi(e,t),e.prototype.summary=function(){return"microphone"},e.create=function(t){return void 0===t&&(t={}),Zi(this,void 0,void 0,(function(){var n;return Qi(this,(function(r){switch(r.label){case 0:if(i.ENV.get("IS_NODE"))throw new Error("microphone API is only supported in browser environment.");return[4,(n=new e(t)).start()];case 1:return r.sent(),[2,n]}}))}))},e.prototype.start=function(){return Zi(this,void 0,void 0,(function(){var t,e,n,r;return Qi(this,(function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),t=this,[4,navigator.mediaDevices.getUserMedia({audio:null==this.audioTrackConstraints||this.audioTrackConstraints,video:!1})];case 1:return t.stream=i.sent(),[3,3];case 2:throw e=i.sent(),new Error("Error thrown while initializing video stream: "+e.message);case 3:if(!this.stream)throw new Error("Could not obtain audio from microphone.");if(n=window.AudioContext||window.webkitAudioContext,this.audioContext=new n,this.sampleRateHz){if(this.audioContext.sampleRate!==this.sampleRateHz)throw new Error("Mismatch in sampling rate: Expected: "+this.sampleRateHz+"; Actual: "+this.audioContext.sampleRate)}else this.sampleRateHz=this.audioContext.sampleRate;return r=this.audioContext.createMediaStreamSource(this.stream),this.analyser=this.audioContext.createAnalyser(),this.analyser.fftSize=2*this.fftSize,this.analyser.smoothingTimeConstant=this.smoothingTimeConstant,r.connect(this.analyser),this.freqData=new Float32Array(this.fftSize),this.timeData=new Float32Array(this.fftSize),[2]}}))}))},e.prototype.next=function(){return Zi(this,void 0,void 0,(function(){var t,e,n,r,i;return Qi(this,(function(o){switch(o.label){case 0:return this.isClosed?[2,{value:null,done:!0}]:[4,this.getAudioData()];case 1:return n=o.sent(),this.includeSpectrogram&&(r=this.flattenQueue(n.freqDataQueue),t=this.getTensorFromAudioDataArray(r,[this.numFrames,this.columnTruncateLength,1])),this.includeWaveform&&(i=this.flattenQueue(n.timeDataQueue),e=this.getTensorFromAudioDataArray(i,[this.numFrames*this.fftSize,1])),[2,{value:{spectrogram:t,waveform:e},done:!1}]}}))}))},e.prototype.capture=function(){return Zi(this,void 0,void 0,(function(){return Qi(this,(function(t){switch(t.label){case 0:return[4,this.next()];case 1:return[2,t.sent().value]}}))}))},e.prototype.getAudioData=function(){return Zi(this,void 0,void 0,(function(){var t,e,n,r=this;return Qi(this,(function(i){return t=[],e=[],n=0,[2,new Promise((function(i){var o=setInterval((function(){r.includeSpectrogram&&(r.analyser.getFloatFrequencyData(r.freqData),r.freqData[0]===-1/0&&i({freqDataQueue:t,timeDataQueue:e}),t.push(r.freqData.slice(0,r.columnTruncateLength))),r.includeWaveform&&(r.analyser.getFloatTimeDomainData(r.timeData),e.push(r.timeData.slice())),++n===r.numFrames&&(clearInterval(o),i({freqDataQueue:t,timeDataQueue:e}))}),r.fftSize/r.sampleRateHz*1e3)}))]}))}))},e.prototype.stop=function(){this.isClosed||(this.isClosed=!0,this.analyser.disconnect(),this.audioContext.close(),null!=this.stream&&this.stream.getTracks().length>0&&this.stream.getTracks()[0].stop())},e.prototype.toArray=function(){throw new Error("Can not convert infinite audio stream to array.")},e.prototype.getSampleRate=function(){return this.sampleRateHz},e.prototype.flattenQueue=function(t){var e=t[0].length,n=new Float32Array(t.length*e);return t.forEach((function(t,r){return n.set(t,r*e)})),n},e.prototype.getTensorFromAudioDataArray=function(t,e){var n=new Float32Array(i.util.sizeFromShape(e));return n.set(t,n.length-t.length),Object(i.tensor)(n,e)},e}(Co),ta=function(t){function e(e,n){var r=t.call(this)||this;if(r.webcamVideoElement=e,r.webcamConfig=n,r.isClosed=!0,r.resize=!1,r.needToResize())if(r.resize=!0,r.cropSize=[r.webcamConfig.resizeHeight,r.webcamConfig.resizeWidth],r.cropBoxInd=Object(i.tensor1d)([0],"int32"),r.webcamConfig.centerCrop){var o=1*r.webcamConfig.resizeWidth/r.webcamVideoElement.width,a=1*r.webcamConfig.resizeHeight/r.webcamVideoElement.height,s=(1-o)/2,u=(1-a)/2,l=s+o,c=a+u;r.cropBox=Object(i.tensor2d)([u,s,c,l],[1,4])}else r.cropBox=Object(i.tensor2d)([0,0,1,1],[1,4]);return r}return Yi(e,t),e.prototype.summary=function(){return"webcam"},e.create=function(t,n){return void 0===n&&(n={}),Zi(this,void 0,void 0,(function(){var r;return Qi(this,(function(o){switch(o.label){case 0:if(i.ENV.get("IS_NODE"))throw new Error("tf.data.webcam is only supported in browser environment.");if(!t){if(t=document.createElement("video"),!n.resizeWidth||!n.resizeHeight)throw new Error("Please provide webcam video element, or resizeWidth and resizeHeight to create a hidden video element.");t.width=n.resizeWidth,t.height=n.resizeHeight}return[4,(r=new e(t,n)).start()];case 1:return o.sent(),[2,r]}}))}))},e.prototype.start=function(){return Zi(this,void 0,void 0,(function(){var t,e,n=this;return Qi(this,(function(r){switch(r.label){case 0:this.webcamConfig.facingMode&&i.util.assert("user"===this.webcamConfig.facingMode||"environment"===this.webcamConfig.facingMode,(function(){return"Invalid webcam facing mode: "+n.webcamConfig.facingMode+". Please provide 'user' or 'environment'"})),r.label=1;case 1:return r.trys.push([1,3,,4]),t=this,[4,navigator.mediaDevices.getUserMedia({video:{deviceId:this.webcamConfig.deviceId,facingMode:this.webcamConfig.facingMode?this.webcamConfig.facingMode:"user",width:this.webcamVideoElement.width,height:this.webcamVideoElement.height}})];case 2:return t.stream=r.sent(),[3,4];case 3:throw(e=r.sent()).message="Error thrown while initializing video stream: "+e.message,e;case 4:if(!this.stream)throw new Error("Could not obtain video from webcam.");try{this.webcamVideoElement.srcObject=this.stream}catch(t){console.log(t),this.webcamVideoElement.src=window.URL.createObjectURL(this.stream)}return this.webcamVideoElement.play(),this.isClosed=!1,[2,new Promise((function(t){n.webcamVideoElement.onloadedmetadata=function(){t()}}))]}}))}))},e.prototype.next=function(){return Zi(this,void 0,void 0,(function(){var t;return Qi(this,(function(e){if(this.isClosed)return[2,{value:null,done:!0}];try{t=i.browser.fromPixels(this.webcamVideoElement)}catch(t){throw new Error("Error thrown converting video to pixels: "+JSON.stringify(t))}if(!this.resize)return[2,{value:t,done:!1}];try{return[2,{value:this.cropAndResizeFrame(t),done:!1}]}catch(t){throw new Error("Error thrown cropping the video: "+t.message)}finally{t.dispose()}return[2]}))}))},e.prototype.needToResize=function(){return!(!this.webcamConfig.resizeWidth||!this.webcamConfig.resizeHeight||this.webcamVideoElement.width===this.webcamConfig.resizeWidth&&this.webcamVideoElement.height===this.webcamConfig.resizeHeight)},e.prototype.cropAndResizeFrame=function(t){var e=this;return Object(i.tidy)((function(){var n,r=t.toFloat().expandDims(0),o=(n=i.image.cropAndResize(r,e.cropBox,e.cropBoxInd,e.cropSize,"bilinear")).shape;return n.reshape(o.slice(1))}))},e.prototype.capture=function(){return Zi(this,void 0,void 0,(function(){return Qi(this,(function(t){switch(t.label){case 0:return[4,this.next()];case 1:return[2,t.sent().value]}}))}))},e.prototype.stop=function(){this.stream.getTracks().forEach((function(t){return t.stop()}));try{this.webcamVideoElement.srcObject=null}catch(t){console.log(t),this.webcamVideoElement.src=null}this.isClosed=!0},e.prototype.toArray=function(){throw new Error("Can not convert infinite video stream to array.")},e}(Co),ea=function(){},na=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Yi(e,t),e.prototype.split=function(t){return new ra(this,t)},e}(Co),ra=function(t){function e(e,n){var r=t.call(this)||this;return r.upstream=e,r.impl=new ia(e,n),r}return Yi(e,t),e.prototype.summary=function(){return this.impl.summary()},e.prototype.next=function(){return Zi(this,void 0,void 0,(function(){return Qi(this,(function(t){return[2,this.impl.next()]}))}))},e}(na),ia=function(t){function e(e,n){var r=t.call(this)||this;return r.upstream=e,r.separator=n,r.carryover="",r}return Yi(e,t),e.prototype.summary=function(){return this.upstream.summary()+" -> Split('"+this.separator+"')"},e.prototype.pump=function(){return Zi(this,void 0,void 0,(function(){var t,e,n,r;return Qi(this,(function(i){switch(i.label){case 0:return[4,this.upstream.next()];case 1:if((t=i.sent()).done)return""===this.carryover?[2,!1]:(this.outputQueue.push(this.carryover),this.carryover="",[2,!0]);for((e=t.value.split(this.separator))[0]=this.carryover+e[0],n=0,r=e.slice(0,-1);n<r.length;n++)this.outputQueue.push(r[n]);return this.carryover=e[e.length-1],[2,!0]}}))}))},e}(Mo),oa=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Yi(e,t),e.prototype.decodeUTF8=function(){return new aa(this)},e}(Co),aa=function(t){function e(e){var n=t.call(this)||this;return n.upstream=e,n.impl=new sa(e),n}return Yi(e,t),e.prototype.summary=function(){return this.impl.summary()},e.prototype.next=function(){return Zi(this,void 0,void 0,(function(){return Qi(this,(function(t){return[2,this.impl.next()]}))}))},e}(na),sa=function(t){function e(e){var r=t.call(this)||this;if(r.upstream=e,i.ENV.get("IS_BROWSER"))r.decoder=new TextDecoder("utf-8");else{var o=n(5).StringDecoder;r.decoder=new o("utf8")}return r}return Yi(e,t),e.prototype.summary=function(){return this.upstream.summary()+" -> Utf8"},e.prototype.pump=function(){return Zi(this,void 0,void 0,(function(){var t,e,n;return Qi(this,(function(r){switch(r.label){case 0:return[4,this.upstream.next()];case 1:return(t=r.sent()).done?[2,!1]:(e=t.value,n=i.ENV.get("IS_BROWSER")?this.decoder.decode(e,{stream:!0}):this.decoder.write(Buffer.from(e.buffer)),this.outputQueue.push(n),[2,!0])}}))}))},e}(Mo),ua=function(t){function e(e,n){void 0===n&&(n={});var r=t.call(this)||this;return r.file=e,r.options=n,i.util.assert(e instanceof Uint8Array||!!i.ENV.get("IS_BROWSER")&&(e instanceof File||e instanceof Blob),(function(){return"FileChunkIterator only supports File, Blob and Uint8Array right now."})),r.offset=n.offset||0,r.chunkSize=n.chunkSize||1048576,r}return Yi(e,t),e.prototype.summary=function(){return"FileChunks "+this.file},e.prototype.next=function(){return Zi(this,void 0,void 0,(function(){var t,e,n=this;return Qi(this,(function(r){switch(r.label){case 0:return this.offset>=(this.file instanceof Uint8Array?this.file.byteLength:this.file.size)?[2,{value:null,done:!0}]:(t=new Promise((function(t,e){var r=n.offset+n.chunkSize;if(n.file instanceof Uint8Array)t(new Uint8Array(n.file.slice(n.offset,r)));else{var i=new FileReader;i.onload=function(n){var r=i.result;if(r instanceof ArrayBuffer&&(r=new Uint8Array(r)),!(r instanceof Uint8Array))return e(new TypeError("FileReader returned unknown type."));t(r)},i.onabort=function(t){return e(new Error("Aborted"))},i.onerror=function(t){return e(new Error(t.type))};var o=n.file.slice(n.offset,r);i.readAsArrayBuffer(o)}n.offset=r})),e={},[4,t]);case 1:return[2,(e.value=r.sent(),e.done=!1,e)]}}))}))},e}(oa);function la(t,e){return void 0===e&&(e={}),Zi(this,void 0,void 0,(function(){var n,r,o,a,s;return Qi(this,(function(u){switch(u.label){case 0:return"string"==typeof t?n=t:(n=t.url,r=ca(t)),[4,i.util.fetch(n,r)];case 1:return(o=u.sent()).ok?(s=Uint8Array.bind,[4,o.arrayBuffer()]):[3,3];case 2:return a=new(s.apply(Uint8Array,[void 0,u.sent()])),[2,new ua(a,e)];case 3:throw new Error(o.statusText)}}))}))}var ca=function(t){return{method:t.method,headers:t.headers,body:t.body,mode:t.mode,credentials:t.credentials,cache:t.cache,redirect:t.redirect,referrer:t.referrer,integrity:t.integrity}};function ha(t){return"string"==typeof t&&"file://"===t.substr(0,7)}var da=function(t){function e(e,n){void 0===n&&(n={});var r=t.call(this)||this;return r.input=e,r.options=n,r}return Yi(e,t),e.prototype.iterator=function(){return Zi(this,void 0,void 0,(function(){var t;return Qi(this,(function(e){return ha(this.input)&&i.ENV.get("IS_NODE")&&(t=n(6),this.input=t.readFileSync(this.input.substr(7))),[2,new ua(this.input,this.options)]}))}))},e}(ea),fa=function(t){function e(e,n){void 0===n&&(n={});var r=t.call(this)||this;return r.url=e,r.fileOptions=n,r}return Yi(e,t),e.prototype.iterator=function(){return Zi(this,void 0,void 0,(function(){return Qi(this,(function(t){return ha(this.url)?[2,new da(this.url,this.fileOptions).iterator()]:[2,la(this.url,this.fileOptions)]}))}))},e}(ea);function pa(t,e){return void 0===e&&(e={}),new Qo(new fa(t),e)}function ma(t){var e=this,n=vo(t);return Uo((function(){return Zi(e,void 0,void 0,(function(){return Qi(this,(function(t){return[2,n]}))}))}))}function ga(t){var e=this;return Uo((function(){return Zi(e,void 0,void 0,(function(){var e;return Qi(this,(function(n){switch(n.label){case 0:return[4,t()];case 1:return e=n.sent(),[2,vo((function(){return e.next()}))]}}))}))}))}function ya(t,e){return Zi(this,void 0,void 0,(function(){return Qi(this,(function(n){return[2,ta.create(t,e)]}))}))}function va(t){return Zi(this,void 0,void 0,(function(){return Qi(this,(function(e){return[2,Jo.create(t)]}))}))}var ba="1.2.11",wa={"tfjs-core":i.version_core,"tfjs-data":ba,"tfjs-layers":en,"tfjs-converter":Xi.e,tfjs:"1.2.11"}},CEZr:function(t,e,n){"use strict";var r=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(e){o(e)}}function s(t){try{u(r.throw(t))}catch(e){o(e)}}function u(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(a,s)}u((r=r.apply(t,e||[])).next())}))},i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const o=i(n("etOl")),a=n("Ewl0"),s=n("YYB2"),u=n("jke5");e.scatterplot=function(t,e,n={}){return r(this,void 0,void 0,(function*(){let r=e.values;const i=null==e.series?[]:e.series;r=Array.isArray(r[0])?r:[r];const c=[];r.forEach((t,e)=>{const n=null!=i[e]?i[e]:"Series "+(e+1),r=t.map(t=>Object.assign({},t,{series:n}));c.push(...r)}),null!=n.seriesColors&&s.assert(n.seriesColors.length===r.length,"Must have an equal number of series colors as there are data series");const h=u.getDrawArea(t),d=Object.assign({},l,n),f={width:d.width||a.getDefaultWidth(h),height:d.height||a.getDefaultHeight(h),padding:0,autosize:{type:"fit",contains:"padding",resize:!0},config:{axis:{labelFontSize:d.fontSize,titleFontSize:d.fontSize},text:{fontSize:d.fontSize},legend:{labelFontSize:d.fontSize,titleFontSize:d.fontSize}},data:{values:c},mark:{type:"point",clip:!0,tooltip:{content:"data"}},encoding:{x:{field:"x",type:d.xType,title:d.xLabel,scale:d.zoomToFit?{zero:!1}:null!=d.xAxisDomain?{domain:d.xAxisDomain}:void 0},y:{field:"y",type:d.yType,title:d.yLabel,scale:d.zoomToFit?{zero:!1}:null!=d.yAxisDomain?{domain:d.yAxisDomain}:void 0},color:{field:"series",type:"nominal",scale:{range:d.seriesColors}},shape:{field:"series",type:"nominal"}}};return yield o.default(h,f,{actions:!1,mode:"vega-lite",defaultStyle:!1}),Promise.resolve()}))};const l={xLabel:"x",yLabel:"y",xType:"quantitative",yType:"quantitative",zoomToFit:!1,fontSize:11}},DXxi:function(t,e){const n="object"==typeof process&&process.env&&process.env.NODE_DEBUG&&/\bsemver\b/i.test(process.env.NODE_DEBUG)?(...t)=>console.error("SEMVER",...t):()=>{};t.exports=n},Dknc:function(t,e,n){const r=n("8GxW");t.exports=(t,e,n)=>r(t,e,n)>=0},Ewl0:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=n("Ad6o"),i=n("jke5"),o={prepend:!1};e.subSurface=function(t,e,n={}){const a=i.getDrawArea(t),s=r.css({"& canvas":{display:"block"},marginTop:".5rem",marginBottom:".5rem"}),u=r.css({backgroundColor:"white",display:"inline-block",boxSizing:"border-box",borderBottom:"1px solid #357EDD",lineHeight:"2em",padding:"0 10px 0 10px",marginBottom:"20px",fontWeight:"600",textAlign:"left"}),l=Object.assign({},o,n);let c=a.querySelector(`div[data-name=${e}]`);if(!c){if(c=document.createElement("div"),c.setAttribute("class",""+s),c.dataset.name=e,l.title){const t=document.createElement("div");t.setAttribute("class","subsurface-title "+u),t.innerText=l.title,c.appendChild(t)}l.prepend?a.insertBefore(c,a.firstChild):a.appendChild(c)}return c},e.getDefaultWidth=function(t){let e=0,n=t;for(;n&&0===n.clientWidth;)n=n.parentElement,e=50;return n.clientWidth-e},e.getDefaultHeight=function(t){return 0===t.clientHeight?200:t.clientHeight}},EzSE:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=n("ML/J"),i=n("Ad6o");e.Tabs=class extends r.Component{render(){const{tabNames:t,activeTab:e,handleClick:n}=this.props,a=t.length>0?t.map(t=>r.h(o,{key:t,id:t,handleClick:n,isActive:t===e},t)):null,s=i.css({overflowX:"scroll",overflowY:"hidden",whiteSpace:"nowrap",borderBottomStyle:"solid",borderBottomWidth:"1px",borderColor:"#eee",paddingBottom:"1rem",marginTop:"1rem"});return r.h("div",{className:s+" visor-tabs"},a)}};class o extends r.Component{render(){const{children:t,isActive:e,handleClick:n,id:o}=this.props,a=i.css({borderBottomColor:e?"#357EDD":"#AAAAAA",borderBottomWidth:"1px",borderBottomStyle:"solid",cursor:"pointer",":hover":{color:"#357EDD"},display:"inline-block",marginRight:"1rem",padding:".5rem",fontSize:"1rem",fontWeight:"bold"});return r.h("a",{className:a+" tf-tab","data-isactive":e,onClick:()=>n(o)},t)}}},I9dd:function(t,e,n){const r=n("ex/Z"),{ANY:i}=n("vwDW"),o=n("MpxT"),a=n("8GxW"),s=(t,e,n)=>{if(1===t.length&&t[0].semver===i)return 1===e.length&&e[0].semver===i;const r=new Set;let s,c,h,d,f,p,m;for(const i of t)">"===i.operator||">="===i.operator?s=u(s,i,n):"<"===i.operator||"<="===i.operator?c=l(c,i,n):r.add(i.semver);if(r.size>1)return null;if(s&&c){if(h=a(s.semver,c.semver,n),h>0)return null;if(0===h&&(">="!==s.operator||"<="!==c.operator))return null}for(const i of r){if(s&&!o(i,String(s),n))return null;if(c&&!o(i,String(c),n))return null;for(const t of e)if(!o(i,String(t),n))return!1;return!0}for(const i of e){if(m=m||">"===i.operator||">="===i.operator,p=p||"<"===i.operator||"<="===i.operator,s)if(">"===i.operator||">="===i.operator){if(d=u(s,i,n),d===i)return!1}else if(">="===s.operator&&!o(s.semver,String(i),n))return!1;if(c)if("<"===i.operator||"<="===i.operator){if(f=l(c,i,n),f===i)return!1}else if("<="===c.operator&&!o(c.semver,String(i),n))return!1;if(!i.operator&&(c||s)&&0!==h)return!1}return!(s&&p&&!c&&0!==h||c&&m&&!s&&0!==h)},u=(t,e,n)=>{if(!t)return e;const r=a(t.semver,e.semver,n);return r>0?t:r<0||">"===e.operator&&">="===t.operator?e:t},l=(t,e,n)=>{if(!t)return e;const r=a(t.semver,e.semver,n);return r<0?t:r>0||"<"===e.operator&&"<="===t.operator?e:t};t.exports=(t,e,n)=>{t=new r(t,n),e=new r(e,n);let i=!1;t:for(const r of t.set){for(const t of e.set){const e=s(r,t,n);if(i=i||null!==e,e)continue t}if(i)return!1}return!0}},IsDc:function(t,e,n){const{MAX_SAFE_COMPONENT_LENGTH:r}=n("/kWe"),i=n("DXxi"),o=(e=t.exports={}).re=[],a=e.src=[],s=e.t={};let u=0;const l=(t,e,n)=>{const r=u++;i(r,e),s[t]=r,a[r]=e,o[r]=new RegExp(e,n?"g":void 0)};l("NUMERICIDENTIFIER","0|[1-9]\\d*"),l("NUMERICIDENTIFIERLOOSE","[0-9]+"),l("NONNUMERICIDENTIFIER","\\d*[a-zA-Z-][a-zA-Z0-9-]*"),l("MAINVERSION",`(${a[s.NUMERICIDENTIFIER]})\\.(${a[s.NUMERICIDENTIFIER]})\\.(${a[s.NUMERICIDENTIFIER]})`),l("MAINVERSIONLOOSE",`(${a[s.NUMERICIDENTIFIERLOOSE]})\\.(${a[s.NUMERICIDENTIFIERLOOSE]})\\.(${a[s.NUMERICIDENTIFIERLOOSE]})`),l("PRERELEASEIDENTIFIER",`(?:${a[s.NUMERICIDENTIFIER]}|${a[s.NONNUMERICIDENTIFIER]})`),l("PRERELEASEIDENTIFIERLOOSE",`(?:${a[s.NUMERICIDENTIFIERLOOSE]}|${a[s.NONNUMERICIDENTIFIER]})`),l("PRERELEASE",`(?:-(${a[s.PRERELEASEIDENTIFIER]}(?:\\.${a[s.PRERELEASEIDENTIFIER]})*))`),l("PRERELEASELOOSE",`(?:-?(${a[s.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${a[s.PRERELEASEIDENTIFIERLOOSE]})*))`),l("BUILDIDENTIFIER","[0-9A-Za-z-]+"),l("BUILD",`(?:\\+(${a[s.BUILDIDENTIFIER]}(?:\\.${a[s.BUILDIDENTIFIER]})*))`),l("FULLPLAIN",`v?${a[s.MAINVERSION]}${a[s.PRERELEASE]}?${a[s.BUILD]}?`),l("FULL",`^${a[s.FULLPLAIN]}$`),l("LOOSEPLAIN",`[v=\\s]*${a[s.MAINVERSIONLOOSE]}${a[s.PRERELEASELOOSE]}?${a[s.BUILD]}?`),l("LOOSE",`^${a[s.LOOSEPLAIN]}$`),l("GTLT","((?:<|>)?=?)"),l("XRANGEIDENTIFIERLOOSE",a[s.NUMERICIDENTIFIERLOOSE]+"|x|X|\\*"),l("XRANGEIDENTIFIER",a[s.NUMERICIDENTIFIER]+"|x|X|\\*"),l("XRANGEPLAIN",`[v=\\s]*(${a[s.XRANGEIDENTIFIER]})(?:\\.(${a[s.XRANGEIDENTIFIER]})(?:\\.(${a[s.XRANGEIDENTIFIER]})(?:${a[s.PRERELEASE]})?${a[s.BUILD]}?)?)?`),l("XRANGEPLAINLOOSE",`[v=\\s]*(${a[s.XRANGEIDENTIFIERLOOSE]})(?:\\.(${a[s.XRANGEIDENTIFIERLOOSE]})(?:\\.(${a[s.XRANGEIDENTIFIERLOOSE]})(?:${a[s.PRERELEASELOOSE]})?${a[s.BUILD]}?)?)?`),l("XRANGE",`^${a[s.GTLT]}\\s*${a[s.XRANGEPLAIN]}$`),l("XRANGELOOSE",`^${a[s.GTLT]}\\s*${a[s.XRANGEPLAINLOOSE]}$`),l("COERCE",`(^|[^\\d])(\\d{1,${r}})(?:\\.(\\d{1,${r}}))?(?:\\.(\\d{1,${r}}))?(?:$|[^\\d])`),l("COERCERTL",a[s.COERCE],!0),l("LONETILDE","(?:~>?)"),l("TILDETRIM",`(\\s*)${a[s.LONETILDE]}\\s+`,!0),e.tildeTrimReplace="$1~",l("TILDE",`^${a[s.LONETILDE]}${a[s.XRANGEPLAIN]}$`),l("TILDELOOSE",`^${a[s.LONETILDE]}${a[s.XRANGEPLAINLOOSE]}$`),l("LONECARET","(?:\\^)"),l("CARETTRIM",`(\\s*)${a[s.LONECARET]}\\s+`,!0),e.caretTrimReplace="$1^",l("CARET",`^${a[s.LONECARET]}${a[s.XRANGEPLAIN]}$`),l("CARETLOOSE",`^${a[s.LONECARET]}${a[s.XRANGEPLAINLOOSE]}$`),l("COMPARATORLOOSE",`^${a[s.GTLT]}\\s*(${a[s.LOOSEPLAIN]})$|^$`),l("COMPARATOR",`^${a[s.GTLT]}\\s*(${a[s.FULLPLAIN]})$|^$`),l("COMPARATORTRIM",`(\\s*)${a[s.GTLT]}\\s*(${a[s.LOOSEPLAIN]}|${a[s.XRANGEPLAIN]})`,!0),e.comparatorTrimReplace="$1$2$3",l("HYPHENRANGE",`^\\s*(${a[s.XRANGEPLAIN]})\\s+-\\s+(${a[s.XRANGEPLAIN]})\\s*$`),l("HYPHENRANGELOOSE",`^\\s*(${a[s.XRANGEPLAINLOOSE]})\\s+-\\s+(${a[s.XRANGEPLAINLOOSE]})\\s*$`),l("STAR","(<|>)?=?\\s*\\*"),l("GTE0","^\\s*>=\\s*0.0.0\\s*$"),l("GTE0PRE","^\\s*>=\\s*0.0.0-0\\s*$")},JBAE:function(t,e,n){var r=function(){"use strict";function t(t,e){return null!=e&&t instanceof e}var e,n,r;try{e=Map}catch(s){e=function(){}}try{n=Set}catch(s){n=function(){}}try{r=Promise}catch(s){r=function(){}}function i(o,s,u,l,c){"object"==typeof s&&(u=s.depth,l=s.prototype,c=s.includeNonEnumerable,s=s.circular);var h=[],d=[],f="undefined"!=typeof Buffer;return void 0===s&&(s=!0),void 0===u&&(u=1/0),function o(u,p){if(null===u)return null;if(0===p)return u;var m,g;if("object"!=typeof u)return u;if(t(u,e))m=new e;else if(t(u,n))m=new n;else if(t(u,r))m=new r((function(t,e){u.then((function(e){t(o(e,p-1))}),(function(t){e(o(t,p-1))}))}));else if(i.__isArray(u))m=[];else if(i.__isRegExp(u))m=new RegExp(u.source,a(u)),u.lastIndex&&(m.lastIndex=u.lastIndex);else if(i.__isDate(u))m=new Date(u.getTime());else{if(f&&Buffer.isBuffer(u))return m=Buffer.allocUnsafe?Buffer.allocUnsafe(u.length):new Buffer(u.length),u.copy(m),m;t(u,Error)?m=Object.create(u):void 0===l?(g=Object.getPrototypeOf(u),m=Object.create(g)):(m=Object.create(l),g=l)}if(s){var y=h.indexOf(u);if(-1!=y)return d[y];h.push(u),d.push(m)}for(var v in t(u,e)&&u.forEach((function(t,e){var n=o(e,p-1),r=o(t,p-1);m.set(n,r)})),t(u,n)&&u.forEach((function(t){var e=o(t,p-1);m.add(e)})),u){var b;g&&(b=Object.getOwnPropertyDescriptor(g,v)),b&&null==b.set||(m[v]=o(u[v],p-1))}if(Object.getOwnPropertySymbols){var w=Object.getOwnPropertySymbols(u);for(v=0;v<w.length;v++){var x=w[v];(!(C=Object.getOwnPropertyDescriptor(u,x))||C.enumerable||c)&&(m[x]=o(u[x],p-1),C.enumerable||Object.defineProperty(m,x,{enumerable:!1}))}}if(c){var _=Object.getOwnPropertyNames(u);for(v=0;v<_.length;v++){var C,k=_[v];(C=Object.getOwnPropertyDescriptor(u,k))&&C.enumerable||(m[k]=o(u[k],p-1),Object.defineProperty(m,k,{enumerable:!1}))}}return m}(o,u)}function o(t){return Object.prototype.toString.call(t)}function a(t){var e="";return t.global&&(e+="g"),t.ignoreCase&&(e+="i"),t.multiline&&(e+="m"),e}return i.clonePrototype=function(t){if(null===t)return null;var e=function(){};return e.prototype=t,new e},i.__objToStr=o,i.__isDate=function(t){return"object"==typeof t&&"[object Date]"===o(t)},i.__isArray=function(t){return"object"==typeof t&&"[object Array]"===o(t)},i.__isRegExp=function(t){return"object"==typeof t&&"[object RegExp]"===o(t)},i.__getRegExpFlags=a,i}();t.exports&&(t.exports=r)},JCZO:function(t,e,n){const r=n("8GxW");t.exports=(t,e,n)=>r(t,e,n)<0},KHQI:function(t,e){const n=/^[0-9]+$/,r=(t,e)=>{const r=n.test(t),i=n.test(e);return r&&i&&(t=+t,e=+e),t===e?0:r&&!i?-1:i&&!r?1:t<e?-1:1};t.exports={compareIdentifiers:r,rcompareIdentifiers:(t,e)=>r(e,t)}},LJ9E:function(t,e,n){const r=n("3wIk");t.exports=(t,e)=>new r(t,e).patch},LwnN:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=n("rtRu");let i;e.visor=function(){if("undefined"==typeof document)throw new Error("No document defined. This library needs a browser/dom to work");if(document.getElementById("tfjs-visor-container")&&null!=i)return i;let t,e=document.getElementById("tfjs-visor-container");function n(e,n){let i=null;return t=r.VisorComponent.render(e,t,{ref:t=>i=t,surfaceList:Array.from(n.values())}),i}null==e&&(e=document.createElement("div"),e.id="tfjs-visor-container",document.body.appendChild(e));const a=new Map,s=n(e,a);return i=new o(s,e,a,n),i};class o{constructor(t,e,n,r){this.visorComponent=t,this.el=e,this.surfaceList=n,this.renderVisor=r}surface(t){const{name:e}=t,n=null==t.tab?"Visor":t.tab;if(null==e||!("string"==typeof e||e instanceof String))throw new Error("You must pass a config object with a 'name' property to create or retrieve a surface");const r=Object.assign({},t,{tab:n}),i=`${e}-${n}`;return this.surfaceList.has(i)||this.surfaceList.set(i,r),this.renderVisor(this.el,this.surfaceList),this.visorComponent.getSurface(e,n)}isFullscreen(){return this.visorComponent.isFullscreen()}isOpen(){return this.visorComponent.isOpen()}close(){return this.visorComponent.close()}open(){return this.visorComponent.open()}toggle(){return this.visorComponent.toggle()}toggleFullScreen(){return this.visorComponent.toggleFullScreen()}bindKeys(){return this.visorComponent.bindKeys()}unbindKeys(){return this.visorComponent.unbindKeys()}setActiveTab(t){if(!this.visorComponent.state.tabs.has(t))throw new Error(`Tab '${t}' does not exist`);this.visorComponent.setState({activeTab:t})}}e.Visor=o},MAmL:function(t,e,n){"use strict";n.r(e);var r=/[A-Z]/g,i=/^ms-/,o={};function a(t){return"-"+t.toLowerCase()}e.default=function(t){if(o.hasOwnProperty(t))return o[t];var e=t.replace(r,a);return o[t]=i.test(e)?"-"+e:e}},"ML/J":function(t,e,n){"use strict";function r(){}n.r(e),n.d(e,"h",(function(){return s})),n.d(e,"createElement",(function(){return s})),n.d(e,"cloneElement",(function(){return c})),n.d(e,"Component",(function(){return F})),n.d(e,"render",(function(){return P})),n.d(e,"rerender",(function(){return p})),n.d(e,"options",(function(){return i}));var i={},o=[],a=[];function s(t,e){var n,s,u,l,c=a;for(l=arguments.length;l-- >2;)o.push(arguments[l]);for(e&&null!=e.children&&(o.length||o.push(e.children),delete e.children);o.length;)if((s=o.pop())&&void 0!==s.pop)for(l=s.length;l--;)o.push(s[l]);else"boolean"==typeof s&&(s=null),(u="function"!=typeof t)&&(null==s?s="":"number"==typeof s?s=String(s):"string"!=typeof s&&(u=!1)),u&&n?c[c.length-1]+=s:c===a?c=[s]:c.push(s),n=u;var h=new r;return h.nodeName=t,h.children=c,h.attributes=null==e?void 0:e,h.key=null==e?void 0:e.key,void 0!==i.vnode&&i.vnode(h),h}function u(t,e){for(var n in e)t[n]=e[n];return t}var l="function"==typeof Promise?Promise.resolve().then.bind(Promise.resolve()):setTimeout;function c(t,e){return s(t.nodeName,u(u({},t.attributes),e),arguments.length>2?[].slice.call(arguments,2):t.children)}var h=/acit|ex(?:s|g|n|p|$)|rph|ows|mnc|ntw|ine[ch]|zoo|^ord/i,d=[];function f(t){!t._dirty&&(t._dirty=!0)&&1==d.push(t)&&(i.debounceRendering||l)(p)}function p(){var t,e=d;for(d=[];t=e.pop();)t._dirty&&I(t)}function m(t,e,n){return"string"==typeof e||"number"==typeof e?void 0!==t.splitText:"string"==typeof e.nodeName?!t._componentConstructor&&g(t,e.nodeName):n||t._componentConstructor===e.nodeName}function g(t,e){return t.normalizedNodeName===e||t.nodeName.toLowerCase()===e.toLowerCase()}function y(t){var e=u({},t.attributes);e.children=t.children;var n=t.nodeName.defaultProps;if(void 0!==n)for(var r in n)void 0===e[r]&&(e[r]=n[r]);return e}function v(t){var e=t.parentNode;e&&e.removeChild(t)}function b(t,e,n,r,i){if("className"===e&&(e="class"),"key"===e);else if("ref"===e)n&&n(null),r&&r(t);else if("class"!==e||i)if("style"===e){if(r&&"string"!=typeof r&&"string"!=typeof n||(t.style.cssText=r||""),r&&"object"==typeof r){if("string"!=typeof n)for(var o in n)o in r||(t.style[o]="");for(var o in r)t.style[o]="number"==typeof r[o]&&!1===h.test(o)?r[o]+"px":r[o]}}else if("dangerouslySetInnerHTML"===e)r&&(t.innerHTML=r.__html||"");else if("o"==e[0]&&"n"==e[1]){var a=e!==(e=e.replace(/Capture$/,""));e=e.toLowerCase().substring(2),r?n||t.addEventListener(e,w,a):t.removeEventListener(e,w,a),(t._listeners||(t._listeners={}))[e]=r}else if("list"!==e&&"type"!==e&&!i&&e in t)!function(t,e,n){try{t[e]=n}catch(r){}}(t,e,null==r?"":r),null!=r&&!1!==r||t.removeAttribute(e);else{var s=i&&e!==(e=e.replace(/^xlink:?/,""));null==r||!1===r?s?t.removeAttributeNS("http://www.w3.org/1999/xlink",e.toLowerCase()):t.removeAttribute(e):"function"!=typeof r&&(s?t.setAttributeNS("http://www.w3.org/1999/xlink",e.toLowerCase(),r):t.setAttribute(e,r))}else t.className=r||""}function w(t){return this._listeners[t.type](i.event&&i.event(t)||t)}var x=[],_=0,C=!1,k=!1;function S(){for(var t;t=x.pop();)i.afterMount&&i.afterMount(t),t.componentDidMount&&t.componentDidMount()}function E(t,e,n,r,i,o){_++||(C=null!=i&&void 0!==i.ownerSVGElement,k=null!=t&&!("__preactattr_"in t));var a=function t(e,n,r,i,o){var a=e,s=C;if(null!=n&&"boolean"!=typeof n||(n=""),"string"==typeof n||"number"==typeof n)return e&&void 0!==e.splitText&&e.parentNode&&(!e._component||o)?e.nodeValue!=n&&(e.nodeValue=n):(a=document.createTextNode(n),e&&(e.parentNode&&e.parentNode.replaceChild(a,e),O(e,!0))),a.__preactattr_=!0,a;var u,l,c=n.nodeName;if("function"==typeof c)return function(t,e,n,r){for(var i=t&&t._component,o=i,a=t,s=i&&t._componentConstructor===e.nodeName,u=s,l=y(e);i&&!u&&(i=i._parentComponent);)u=i.constructor===e.nodeName;return i&&u&&(!r||i._component)?(R(i,l,3,n,r),t=i.base):(o&&!s&&(M(o),t=a=null),i=T(e.nodeName,l,n),t&&!i.nextBase&&(i.nextBase=t,a=null),R(i,l,1,n,r),t=i.base,a&&t!==a&&(a._component=null,O(a,!1))),t}(e,n,r,i);if(C="svg"===c||"foreignObject"!==c&&C,c=String(c),(!e||!g(e,c))&&(u=c,(l=C?document.createElementNS("http://www.w3.org/2000/svg",u):document.createElement(u)).normalizedNodeName=u,a=l,e)){for(;e.firstChild;)a.appendChild(e.firstChild);e.parentNode&&e.parentNode.replaceChild(a,e),O(e,!0)}var h=a.firstChild,d=a.__preactattr_,f=n.children;if(null==d){d=a.__preactattr_={};for(var p=a.attributes,w=p.length;w--;)d[p[w].name]=p[w].value}return!k&&f&&1===f.length&&"string"==typeof f[0]&&null!=h&&void 0!==h.splitText&&null==h.nextSibling?h.nodeValue!=f[0]&&(h.nodeValue=f[0]):(f&&f.length||null!=h)&&function(e,n,r,i,o){var a,s,u,l,c,h=e.childNodes,d=[],f={},p=0,g=0,y=h.length,b=0,w=n?n.length:0;if(0!==y)for(var x=0;x<y;x++){var _=h[x],C=_.__preactattr_;null!=(k=w&&C?_._component?_._component.__key:C.key:null)?(p++,f[k]=_):(C||(void 0!==_.splitText?!o||_.nodeValue.trim():o))&&(d[b++]=_)}if(0!==w)for(x=0;x<w;x++){var k;if(c=null,null!=(k=(l=n[x]).key))p&&void 0!==f[k]&&(c=f[k],f[k]=void 0,p--);else if(!c&&g<b)for(a=g;a<b;a++)if(void 0!==d[a]&&m(s=d[a],l,o)){c=s,d[a]=void 0,a===b-1&&b--,a===g&&g++;break}c=t(c,l,r,i),u=h[x],c&&c!==e&&c!==u&&(null==u?e.appendChild(c):c===u.nextSibling?v(u):e.insertBefore(c,u))}if(p)for(var x in f)void 0!==f[x]&&O(f[x],!1);for(;g<=b;)void 0!==(c=d[b--])&&O(c,!1)}(a,f,r,i,k||null!=d.dangerouslySetInnerHTML),function(t,e,n){var r;for(r in n)e&&null!=e[r]||null==n[r]||b(t,r,n[r],n[r]=void 0,C);for(r in e)"children"===r||"innerHTML"===r||r in n&&e[r]===("value"===r||"checked"===r?t[r]:n[r])||b(t,r,n[r],n[r]=e[r],C)}(a,n.attributes,d),C=s,a}(t,e,n,r,o);return i&&a.parentNode!==i&&i.appendChild(a),--_||(k=!1,o||S()),a}function O(t,e){var n=t._component;n?M(n):(null!=t.__preactattr_&&t.__preactattr_.ref&&t.__preactattr_.ref(null),!1!==e&&null!=t.__preactattr_||v(t),A(t))}function A(t){for(t=t.lastChild;t;){var e=t.previousSibling;O(t,!0),t=e}}var N={};function T(t,e,n){var r,i=N[t.name];if(t.prototype&&t.prototype.render?(r=new t(e,n),F.call(r,e,n)):((r=new F(e,n)).constructor=t,r.render=D),i)for(var o=i.length;o--;)if(i[o].constructor===t){r.nextBase=i[o].nextBase,i.splice(o,1);break}return r}function D(t,e,n){return this.constructor(t,n)}function R(t,e,n,r,o){t._disable||(t._disable=!0,(t.__ref=e.ref)&&delete e.ref,(t.__key=e.key)&&delete e.key,!t.base||o?t.componentWillMount&&t.componentWillMount():t.componentWillReceiveProps&&t.componentWillReceiveProps(e,r),r&&r!==t.context&&(t.prevContext||(t.prevContext=t.context),t.context=r),t.prevProps||(t.prevProps=t.props),t.props=e,t._disable=!1,0!==n&&(1!==n&&!1===i.syncComponentUpdates&&t.base?f(t):I(t,1,o)),t.__ref&&t.__ref(t))}function I(t,e,n,r){if(!t._disable){var o,a,s,l=t.props,c=t.state,h=t.context,d=t.prevProps||l,f=t.prevState||c,p=t.prevContext||h,m=t.base,g=t.nextBase,v=m||g,b=t._component,w=!1;if(m&&(t.props=d,t.state=f,t.context=p,2!==e&&t.shouldComponentUpdate&&!1===t.shouldComponentUpdate(l,c,h)?w=!0:t.componentWillUpdate&&t.componentWillUpdate(l,c,h),t.props=l,t.state=c,t.context=h),t.prevProps=t.prevState=t.prevContext=t.nextBase=null,t._dirty=!1,!w){o=t.render(l,c,h),t.getChildContext&&(h=u(u({},h),t.getChildContext()));var C,k,A=o&&o.nodeName;if("function"==typeof A){var N=y(o);(a=b)&&a.constructor===A&&N.key==a.__key?R(a,N,1,h,!1):(C=a,t._component=a=T(A,N,h),a.nextBase=a.nextBase||g,a._parentComponent=t,R(a,N,0,h,!1),I(a,1,n,!0)),k=a.base}else s=v,(C=b)&&(s=t._component=null),(v||1===e)&&(s&&(s._component=null),k=E(s,o,h,n||!m,v&&v.parentNode,!0));if(v&&k!==v&&a!==b){var D=v.parentNode;D&&k!==D&&(D.replaceChild(k,v),C||(v._component=null,O(v,!1)))}if(C&&M(C),t.base=k,k&&!r){for(var F=t,P=t;P=P._parentComponent;)(F=P).base=k;k._component=F,k._componentConstructor=F.constructor}}if(!m||n?x.unshift(t):w||(t.componentDidUpdate&&t.componentDidUpdate(d,f,p),i.afterUpdate&&i.afterUpdate(t)),null!=t._renderCallbacks)for(;t._renderCallbacks.length;)t._renderCallbacks.pop().call(t);_||r||S()}}function M(t){i.beforeUnmount&&i.beforeUnmount(t);var e=t.base;t._disable=!0,t.componentWillUnmount&&t.componentWillUnmount(),t.base=null;var n=t._component;n?M(n):e&&(e.__preactattr_&&e.__preactattr_.ref&&e.__preactattr_.ref(null),t.nextBase=e,v(e),function(t){var e=t.constructor.name;(N[e]||(N[e]=[])).push(t)}(t),A(e)),t.__ref&&t.__ref(null)}function F(t,e){this._dirty=!0,this.context=e,this.props=t,this.state=this.state||{}}function P(t,e,n){return E(n,t,{},!1,e,!1)}u(F.prototype,{setState:function(t,e){var n=this.state;this.prevState||(this.prevState=u({},n)),u(n,"function"==typeof t?t(n,this.props):t),e&&(this._renderCallbacks=this._renderCallbacks||[]).push(e),f(this)},forceUpdate:function(t){t&&(this._renderCallbacks=this._renderCallbacks||[]).push(t),I(this,2)},render:function(){}}),e.default={h:s,createElement:s,cloneElement:c,Component:F,render:P,rerender:p,options:i}},MgzW:function(t,e,n){"use strict";var r=Object.getOwnPropertySymbols,i=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable;function a(t){if(null==t)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(t)}t.exports=function(){try{if(!Object.assign)return!1;var t=new String("abc");if(t[5]="de","5"===Object.getOwnPropertyNames(t)[0])return!1;for(var e={},n=0;n<10;n++)e["_"+String.fromCharCode(n)]=n;if("0123456789"!==Object.getOwnPropertyNames(e).map((function(t){return e[t]})).join(""))return!1;var r={};return"abcdefghijklmnopqrst".split("").forEach((function(t){r[t]=t})),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},r)).join("")}catch(i){return!1}}()?Object.assign:function(t,e){for(var n,s,u=a(t),l=1;l<arguments.length;l++){for(var c in n=Object(arguments[l]))i.call(n,c)&&(u[c]=n[c]);if(r){s=r(n);for(var h=0;h<s.length;h++)o.call(n,s[h])&&(u[s[h]]=n[s[h]])}}return u}},MpxT:function(t,e,n){const r=n("ex/Z");t.exports=(t,e,n)=>{try{e=new r(e,n)}catch(i){return!1}return e.test(t)}},NgHg:function(t,e,n){"use strict";var r=/-(.)/g;t.exports=function(t){return t.replace(r,(function(t,e){return e.toUpperCase()}))}},O9TA:function(t,e,n){const r=n("Ybu3");t.exports=(t,e)=>{const n=r(t,e);return n&&n.prerelease.length?n.prerelease:null}},Pp8E:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e,n,r,i){for(var o=0,a=t.length;o<a;++o){var s=t[o](e,n,r,i);if(s)return s}},t.exports=e.default},QUk2:function(t,e,n){"use strict";var r=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(e){o(e)}}function s(t){try{u(r.throw(t))}catch(e){o(e)}}function u(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(a,s)}u((r=r.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0});const i=n("C1Pg"),o=n("YYB2");e.arrayStats=function(t){if(!Array.isArray(t))throw new Error("input must be an array");if(0===t.length)return{numVals:0,numNans:0,numZeros:0,max:void 0,min:void 0};const e=t.length;let n=-1/0,r=1/0,i=0,o=0,a=0;for(let u=0;u<e;u++){const e=t[u];e>n&&(n=e),e<r&&(r=e),0===e&&(i+=1),isNaN(e)?o+=1:isFinite(e)||(a+=1)}const s={numVals:e,numZeros:i,numNans:o,max:n,min:r,numInfs:a};return s.max===-1/0&&(s.max=NaN),s.min===1/0&&(s.min=NaN),s},e.tensorStats=function(t){return r(this,void 0,void 0,(function*(){const[e,n,r]=i.tidy(()=>{const e=i.scalar(0,t.dtype);return[t.min(),t.max(),t.equal(e).sum()]});return Promise.all([t.data(),e.data(),n.data(),r.data()]).then(([t,e,n,r])=>{const i=t.length;let o=0,a=0;for(let l=0;l<i;l++){const e=t[l];isNaN(e)?o+=1:isFinite(e)||(a+=1)}let s=e[0],u=n[0];return o===i&&(s=NaN,u=NaN),{numVals:i,numZeros:r[0],numNans:o,min:s,max:u,numInfs:a}})}))},e.confusionMatrix=function(t,e,n,a){return r(this,void 0,void 0,(function*(){o.assert(1===t.rank,"labels must be a 1D tensor"),o.assert(1===e.rank,"predictions must be a 1D tensor"),o.assert(t.size===e.size,"labels and predictions must be the same length"),null!=a&&o.assert(a.size===e.size,"labels and predictions must be the same length");const r=t.cast("int32"),s=e.cast("int32");null==n&&(n=i.tidy(()=>i.maximum(r.max(),s.max()).cast("int32").dataSync()[0]+1));let u=Promise.resolve(null);return null!=a&&(u=a.data()),Promise.all([r.data(),s.data(),u]).then(([t,e,r])=>{const i=Array(n).fill(0);for(let o=0;o<n;o++)i[o]=Array(n).fill(0);for(let n=0;n<t.length;n++)i[t[n]][e[n]]+=null!=r?r[n]:1;return i})}))},e.accuracy=function(t,e){return r(this,void 0,void 0,(function*(){o.assertShapesMatch(t.shape,e.shape,"Error computing accuracy.");const n=t.equal(e),r=n.mean(),a=(yield r.data())[0];return i.dispose([n,r]),a}))},e.perClassAccuracy=function(t,e,n){return r(this,void 0,void 0,(function*(){return o.assert(1===t.rank,"labels must be a 1D tensor"),o.assert(1===e.rank,"predictions must be a 1D tensor"),o.assert(t.size===e.size,"labels and predictions must be the same length"),null==n&&(n=i.tidy(()=>i.maximum(t.max(),e.max()).dataSync()[0]+1)),Promise.all([t.data(),e.data()]).then(([t,e])=>{const r=Array(n).fill(0),i=Array(n).fill(0);for(let n=0;n<t.length;n++){const o=t[n],a=e[n];r[o]+=1,o===a&&(i[o]+=1)}const o=[];for(let n=0;n<r.length;n++)o.push({count:r[n],accuracy:0===r[n]?0:i[n]/r[n]});return o})}))}},"Re/O":function(t,e,n){"use strict";n.r(e),n.d(e,"AdadeltaOptimizer",(function(){return Yh})),n.d(e,"AdagradOptimizer",(function(){return Zh})),n.d(e,"AdamOptimizer",(function(){return Qh})),n.d(e,"AdamaxOptimizer",(function(){return Jh})),n.d(e,"DataStorage",(function(){return Xr})),n.d(e,"ENV",(function(){return l})),n.d(e,"Environment",(function(){return s})),n.d(e,"KernelBackend",(function(){return Kr})),n.d(e,"MomentumOptimizer",(function(){return ed})),n.d(e,"Optimizer",(function(){return Kh})),n.d(e,"RMSPropOptimizer",(function(){return nd})),n.d(e,"Rank",(function(){return lt})),n.d(e,"Reduction",(function(){return sc})),n.d(e,"SGDOptimizer",(function(){return td})),n.d(e,"Tensor",(function(){return st})),n.d(e,"TensorBuffer",(function(){return rt})),n.d(e,"Variable",(function(){return ut})),n.d(e,"abs",(function(){return os})),n.d(e,"acos",(function(){return as})),n.d(e,"acosh",(function(){return ss})),n.d(e,"add",(function(){return au})),n.d(e,"addN",(function(){return su})),n.d(e,"addStrict",(function(){return uu})),n.d(e,"all",(function(){return Sl})),n.d(e,"any",(function(){return El})),n.d(e,"argMax",(function(){return Ol})),n.d(e,"argMin",(function(){return Al})),n.d(e,"asin",(function(){return us})),n.d(e,"asinh",(function(){return ls})),n.d(e,"atan",(function(){return cs})),n.d(e,"atan2",(function(){return lu})),n.d(e,"atanh",(function(){return hs})),n.d(e,"avgPool",(function(){return ml})),n.d(e,"avgPool3d",(function(){return vl})),n.d(e,"backend",(function(){return Ke})),n.d(e,"backend_util",(function(){return pi})),n.d(e,"basicLSTMCell",(function(){return ql})),n.d(e,"batchNorm",(function(){return Ys})),n.d(e,"batchNorm2d",(function(){return Zs})),n.d(e,"batchNorm3d",(function(){return Qs})),n.d(e,"batchNorm4d",(function(){return Js})),n.d(e,"batchNormalization",(function(){return Ks})),n.d(e,"batchNormalization2d",(function(){return Hs})),n.d(e,"batchNormalization3d",(function(){return Gs})),n.d(e,"batchNormalization4d",(function(){return Xs})),n.d(e,"batchToSpaceND",(function(){return Jn})),n.d(e,"booleanMaskAsync",(function(){return Vu})),n.d(e,"browser",(function(){return zh})),n.d(e,"buffer",(function(){return Zn})),n.d(e,"cast",(function(){return tr})),n.d(e,"ceil",(function(){return ds})),n.d(e,"clipByValue",(function(){return fs})),n.d(e,"clone",(function(){return er})),n.d(e,"complex",(function(){return pn})),n.d(e,"concat",(function(){return In})),n.d(e,"concat1d",(function(){return Mn})),n.d(e,"concat2d",(function(){return Fn})),n.d(e,"concat3d",(function(){return Pn})),n.d(e,"concat4d",(function(){return jn})),n.d(e,"conv1d",(function(){return Gu})),n.d(e,"conv2d",(function(){return Xu})),n.d(e,"conv2dTranspose",(function(){return nl})),n.d(e,"conv3d",(function(){return Ku})),n.d(e,"conv3dTranspose",(function(){return rl})),n.d(e,"cos",(function(){return ps})),n.d(e,"cosh",(function(){return ms})),n.d(e,"cumsum",(function(){return nr})),n.d(e,"customGrad",(function(){return Wr})),n.d(e,"deprecationWarn",(function(){return Ie})),n.d(e,"depthToSpace",(function(){return rr})),n.d(e,"depthwiseConv2d",(function(){return Qu})),n.d(e,"diag",(function(){return ic})),n.d(e,"disableDeprecationWarnings",(function(){return Re})),n.d(e,"dispose",(function(){return Le})),n.d(e,"disposeVariables",(function(){return Me})),n.d(e,"div",(function(){return cu})),n.d(e,"divStrict",(function(){return hu})),n.d(e,"dot",(function(){return ol})),n.d(e,"dropout",(function(){return oc})),n.d(e,"elu",(function(){return Pl})),n.d(e,"enableDebugMode",(function(){return De})),n.d(e,"enableProdMode",(function(){return Te})),n.d(e,"engine",(function(){return Fe})),n.d(e,"env",(function(){return u})),n.d(e,"equal",(function(){return Ou})),n.d(e,"equalStrict",(function(){return Au})),n.d(e,"erf",(function(){return gs})),n.d(e,"exp",(function(){return ys})),n.d(e,"expandDims",(function(){return ir})),n.d(e,"expm1",(function(){return vs})),n.d(e,"eye",(function(){return or})),n.d(e,"fft",(function(){return Zl})),n.d(e,"fill",(function(){return An})),n.d(e,"findBackend",(function(){return He})),n.d(e,"findBackendFactory",(function(){return Ge})),n.d(e,"floor",(function(){return bs})),n.d(e,"floorDiv",(function(){return du})),n.d(e,"frame",(function(){return cc})),n.d(e,"fused",(function(){return jc})),n.d(e,"gather",(function(){return Uu})),n.d(e,"gatherND",(function(){return rc})),n.d(e,"getBackend",(function(){return We})),n.d(e,"grad",(function(){return Lr})),n.d(e,"grads",(function(){return Br})),n.d(e,"greater",(function(){return Nu})),n.d(e,"greaterEqual",(function(){return Tu})),n.d(e,"greaterEqualStrict",(function(){return Du})),n.d(e,"greaterStrict",(function(){return Ru})),n.d(e,"hammingWindow",(function(){return lc})),n.d(e,"hannWindow",(function(){return uc})),n.d(e,"ifft",(function(){return Ql})),n.d(e,"imag",(function(){return gn})),n.d(e,"image",(function(){return Ic})),n.d(e,"inTopKAsync",(function(){return fc})),n.d(e,"io",(function(){return Mh})),n.d(e,"irfft",(function(){return tc})),n.d(e,"isFinite",(function(){return Ds})),n.d(e,"isInf",(function(){return Ts})),n.d(e,"isNaN",(function(){return Ns})),n.d(e,"keep",(function(){return Be})),n.d(e,"leakyRelu",(function(){return jl})),n.d(e,"less",(function(){return Iu})),n.d(e,"lessEqual",(function(){return Mu})),n.d(e,"lessEqualStrict",(function(){return Fu})),n.d(e,"lessStrict",(function(){return Pu})),n.d(e,"linalg",(function(){return Oc})),n.d(e,"linspace",(function(){return Nn})),n.d(e,"localResponseNormalization",(function(){return Vl})),n.d(e,"log",(function(){return ws})),n.d(e,"log1p",(function(){return xs})),n.d(e,"logSigmoid",(function(){return _s})),n.d(e,"logSoftmax",(function(){return Gr})),n.d(e,"logSumExp",(function(){return Nl})),n.d(e,"logicalAnd",(function(){return tu})),n.d(e,"logicalNot",(function(){return eu})),n.d(e,"logicalOr",(function(){return nu})),n.d(e,"logicalXor",(function(){return ru})),n.d(e,"losses",(function(){return Cc})),n.d(e,"matMul",(function(){return il})),n.d(e,"math",(function(){return Ph})),n.d(e,"max",(function(){return Tl})),n.d(e,"maxPool",(function(){return pl})),n.d(e,"maxPool3d",(function(){return yl})),n.d(e,"maximum",(function(){return fu})),n.d(e,"maximumStrict",(function(){return pu})),n.d(e,"mean",(function(){return Dl})),n.d(e,"memory",(function(){return Pe})),n.d(e,"min",(function(){return Rl})),n.d(e,"minimum",(function(){return mu})),n.d(e,"minimumStrict",(function(){return gu})),n.d(e,"mod",(function(){return yu})),n.d(e,"modStrict",(function(){return vu})),n.d(e,"moments",(function(){return Il})),n.d(e,"movingAverage",(function(){return Gl})),n.d(e,"mul",(function(){return bu})),n.d(e,"mulStrict",(function(){return wu})),n.d(e,"multiRNNCell",(function(){return Hl})),n.d(e,"multinomial",(function(){return ar})),n.d(e,"neg",(function(){return Cs})),n.d(e,"nextFrame",(function(){return ad})),n.d(e,"norm",(function(){return Wl})),n.d(e,"notEqual",(function(){return ju})),n.d(e,"notEqualStrict",(function(){return zu})),n.d(e,"oneHot",(function(){return sr})),n.d(e,"ones",(function(){return En})),n.d(e,"onesLike",(function(){return Dn})),n.d(e,"op",(function(){return fn})),n.d(e,"outerProduct",(function(){return al})),n.d(e,"pad",(function(){return ur})),n.d(e,"pad1d",(function(){return lr})),n.d(e,"pad2d",(function(){return cr})),n.d(e,"pad3d",(function(){return hr})),n.d(e,"pad4d",(function(){return dr})),n.d(e,"pool",(function(){return gl})),n.d(e,"pow",(function(){return xu})),n.d(e,"powStrict",(function(){return _u})),n.d(e,"prelu",(function(){return zl})),n.d(e,"print",(function(){return Qn})),n.d(e,"prod",(function(){return Fl})),n.d(e,"profile",(function(){return je})),n.d(e,"rand",(function(){return fr})),n.d(e,"randomGamma",(function(){return mr})),n.d(e,"randomNormal",(function(){return pr})),n.d(e,"randomUniform",(function(){return gr})),n.d(e,"range",(function(){return Tn})),n.d(e,"ready",(function(){return Ve})),n.d(e,"real",(function(){return mn})),n.d(e,"reciprocal",(function(){return ks})),n.d(e,"registerBackend",(function(){return Xe})),n.d(e,"relu",(function(){return Ll})),n.d(e,"relu6",(function(){return Bl})),n.d(e,"removeBackend",(function(){return qe})),n.d(e,"reshape",(function(){return yr})),n.d(e,"reverse",(function(){return sl})),n.d(e,"reverse1d",(function(){return ul})),n.d(e,"reverse2d",(function(){return ll})),n.d(e,"reverse3d",(function(){return cl})),n.d(e,"reverse4d",(function(){return hl})),n.d(e,"rfft",(function(){return Jl})),n.d(e,"round",(function(){return Ss})),n.d(e,"rsqrt",(function(){return Es})),n.d(e,"scalar",(function(){return bn})),n.d(e,"scatterND",(function(){return Yl})),n.d(e,"selu",(function(){return Ul})),n.d(e,"separableConv2d",(function(){return el})),n.d(e,"serialization",(function(){return $h})),n.d(e,"setBackend",(function(){return $e})),n.d(e,"setPlatform",(function(){return Ye})),n.d(e,"setdiff1dAsync",(function(){return kr})),n.d(e,"sigmoid",(function(){return Os})),n.d(e,"sign",(function(){return As})),n.d(e,"signal",(function(){return dc})),n.d(e,"sin",(function(){return Rs})),n.d(e,"sinh",(function(){return Is})),n.d(e,"slice",(function(){return bl})),n.d(e,"slice1d",(function(){return wl})),n.d(e,"slice2d",(function(){return xl})),n.d(e,"slice3d",(function(){return _l})),n.d(e,"slice4d",(function(){return Cl})),n.d(e,"softmax",(function(){return Hr})),n.d(e,"softplus",(function(){return Ms})),n.d(e,"spaceToBatchND",(function(){return vr})),n.d(e,"sparseToDense",(function(){return nc})),n.d(e,"spectral",(function(){return ec})),n.d(e,"split",(function(){return zn})),n.d(e,"sqrt",(function(){return Fs})),n.d(e,"square",(function(){return Ps})),n.d(e,"squaredDifference",(function(){return Cu})),n.d(e,"squaredDifferenceStrict",(function(){return ku})),n.d(e,"squeeze",(function(){return br})),n.d(e,"stack",(function(){return wr})),n.d(e,"step",(function(){return js})),n.d(e,"stft",(function(){return hc})),n.d(e,"stridedSlice",(function(){return Xl})),n.d(e,"sub",(function(){return Su})),n.d(e,"subStrict",(function(){return Eu})),n.d(e,"sum",(function(){return Ml})),n.d(e,"tan",(function(){return zs})),n.d(e,"tanh",(function(){return Ls})),n.d(e,"tensor",(function(){return yn})),n.d(e,"tensor1d",(function(){return wn})),n.d(e,"tensor2d",(function(){return xn})),n.d(e,"tensor3d",(function(){return _n})),n.d(e,"tensor4d",(function(){return Cn})),n.d(e,"tensor5d",(function(){return kn})),n.d(e,"tensor6d",(function(){return Sn})),n.d(e,"tensor_util",(function(){return _t})),n.d(e,"test_util",(function(){return Hh})),n.d(e,"tidy",(function(){return ze})),n.d(e,"tile",(function(){return xr})),n.d(e,"time",(function(){return Ue})),n.d(e,"topk",(function(){return Kl})),n.d(e,"train",(function(){return id})),n.d(e,"transpose",(function(){return $l})),n.d(e,"truncatedNormal",(function(){return _r})),n.d(e,"unsortedSegmentSum",(function(){return $u})),n.d(e,"unstack",(function(){return Cr})),n.d(e,"util",(function(){return Z})),n.d(e,"valueAndGrad",(function(){return Ur})),n.d(e,"valueAndGrads",(function(){return $r})),n.d(e,"variable",(function(){return pt})),n.d(e,"variableGrads",(function(){return Vr})),n.d(e,"version_core",(function(){return Gh})),n.d(e,"webgl",(function(){return Xh})),n.d(e,"where",(function(){return iu})),n.d(e,"whereAsync",(function(){return ou})),n.d(e,"zeros",(function(){return On})),n.d(e,"zerosLike",(function(){return Rn}));var r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function i(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function o(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(a,s)}u((r=r.apply(t,e||[])).next())}))}function a(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}var s=function(){function t(t){this.global=t,this.flags={},this.flagRegistry={},this.urlFlags={},this.populateURLFlags()}return t.prototype.setPlatform=function(t,e){null!=this.platform&&console.warn("Platform "+this.platformName+" has already been set. Overwriting the platform with "+e+"."),this.platformName=t,this.platform=e},t.prototype.registerFlag=function(t,e,n){if(this.flagRegistry[t]={evaluationFn:e,setHook:n},null!=this.urlFlags[t]){var r=this.urlFlags[t];console.warn("Setting feature override from URL "+t+": "+r+"."),this.set(t,r)}},t.prototype.get=function(t){return t in this.flags||(this.flags[t]=this.evaluateFlag(t)),this.flags[t]},t.prototype.getNumber=function(t){return this.get(t)},t.prototype.getBool=function(t){return this.get(t)},t.prototype.getFlags=function(){return this.flags},Object.defineProperty(t.prototype,"features",{get:function(){return this.flags},enumerable:!0,configurable:!0}),t.prototype.set=function(t,e){if(null==this.flagRegistry[t])throw new Error("Cannot set flag "+t+" as it has not been registered.");this.flags[t]=e,null!=this.flagRegistry[t].setHook&&this.flagRegistry[t].setHook(e)},t.prototype.evaluateFlag=function(t){if(null==this.flagRegistry[t])throw new Error("Cannot evaluate flag '"+t+"': no evaluation function found.");return this.flagRegistry[t].evaluationFn()},t.prototype.setFlags=function(t){this.flags=Object.assign({},t)},t.prototype.reset=function(){this.flags={},this.urlFlags={},this.populateURLFlags()},t.prototype.populateURLFlags=function(){var t=this;if(void 0!==this.global&&void 0!==this.global.location&&void 0!==this.global.location.search){var e,n=(e={},this.global.location.search.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,(function(t){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];return function(t,e,n){t[decodeURIComponent(e)]=decodeURIComponent(n||"")}(e,n[0],n[1]),n.join("=")})),e);"tfjsflags"in n&&n.tfjsflags.split(",").forEach((function(e){var n=e.split(":"),r=n[0];t.urlFlags[r]=function(t,e){if("true"===(e=e.toLowerCase())||"false"===e)return"true"===e;if(""+ +e===e)return+e;throw new Error("Could not parse value flag value "+e+" for flag "+t+".")}(r,n[1])}))}},t}();function u(){return l}var l=null;function c(t){for(var e=t.length,n=0,r=0;e>0;)r=Math.random()*e|0,n=t[--e],t[e]=t[r],t[r]=n}function h(t,e,n){return Math.max(t,Math.min(e,n))}function d(t){return t%2==0?t:t+1}function f(t){for(var e=0,n=0;n<t.length;n++)e+=t[n];return e}function p(t,e){if(!t)throw new Error("string"==typeof e?e:e())}function m(t,e,n){void 0===n&&(n=""),p(b(t,e),(function(){return n+" Shapes "+t+" and "+e+" must match"}))}function g(t){p(null!=t,(function(){return"The input to the tensor constructor must be a non-null value."}))}function y(t,e,n){if(void 0===e&&(e=[]),void 0===n&&(n=!1),null==e&&(e=[]),Array.isArray(t)||I(t)&&!n)for(var r=0;r<t.length;++r)y(t[r],e,n);else e.push(t);return e}function v(t){if(0===t.length)return 1;for(var e=t[0],n=1;n<t.length;n++)e*=t[n];return e}function b(t,e){if(t===e)return!0;if(null==t||null==e)return!1;if(t.length!==e.length)return!1;for(var n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0}function w(t){return t%1==0}function x(t){if(null!=Math.tanh)return Math.tanh(t);if(t===1/0)return 1;if(t===-1/0)return-1;var e=Math.exp(2*t);return(e-1)/(e+1)}function _(t){var e=Math.ceil(Math.sqrt(t));return[e,Math.ceil(t/e)]}function C(t,e){return e<=t.length?t:t+" ".repeat(e-t.length)}function k(t,e,n){return void 0===e&&(e=function(t){return 0}),new Promise((function(r,i){var o=0,a=function(){if(t())r();else{var s=e(++o);null!=n&&o>=n?i():setTimeout(a,s)}};a()}))}function S(t,e){for(var n=1,r=-1,i=0;i<t.length;++i)if(t[i]>=0)n*=t[i];else if(-1===t[i]){if(-1!==r)throw Error("Shapes can only have 1 implicit size. Found -1 at dim "+r+" and dim "+i);r=i}else if(t[i]<0)throw Error("Shapes can not be < 0. Found "+t[i]+" at dim "+i);if(-1===r){if(e>0&&e!==n)throw Error("Size("+e+") must match the product of shape "+t);return t}if(0===n)throw Error("Cannot infer the missing size in ["+t+"] when there are 0 elements");if(e%n!=0)throw Error("The implicit shape can't be a fractional number. Got "+e+" / "+n);var o=t.slice();return o[r]=e/n,o}function E(t,e){var n=e.length;return p((t=null==t?e.map((function(t,e){return e})):[].concat(t)).every((function(t){return t>=-n&&t<n})),(function(){return"All values in axis param must be in range [-"+n+", "+n+") but got axis "+t})),p(t.every((function(t){return w(t)})),(function(){return"All values in axis param must be integers but got axis "+t})),t.map((function(t){return t<0?n+t:t}))}function O(t,e){for(var n=[],r=[],i=null!=e&&Array.isArray(e)&&0===e.length,o=null==e||i?null:E(e,t).sort(),a=0,s=0;s<t.length;++s){if(null!=o){if(o[a]===s&&1!==t[s])throw new Error("Can't squeeze axis "+s+" since its dim '"+t[s]+"' is not 1");(null==o[a]||o[a]>s)&&1===t[s]&&(n.push(t[s]),r.push(s)),o[a]<=s&&a++}1!==t[s]&&(n.push(t[s]),r.push(s))}return{newShape:n,keptDims:r}}function A(t,e){var n=null;if(null==t||"float32"===t)n=new Float32Array(e);else if("int32"===t)n=new Int32Array(e);else{if("bool"!==t)throw new Error("Unknown data type "+t);n=new Uint8Array(e)}return n}function N(t,e){var n=null;if(null==t||"float32"===t)n=new Float32Array(e);else if("int32"===t)n=new Int32Array(e);else if("bool"===t)n=new Uint8Array(e);else{if("string"!==t)throw new Error("Unknown data type "+t);n=new Array(e)}return n}function T(t,e){for(var n=0;n<t.length;n++){var r=t[n];if(isNaN(r)||!isFinite(r))throw Error("A tensor of type "+e+" being uploaded contains "+r+".")}}function D(t){return"bool"===t||"complex64"===t||"float32"===t||"int32"===t||"string"===t}function R(t,e){return!("complex64"===e||"float32"===e&&"complex64"!==t||"int32"===e&&"float32"!==t&&"complex64"!==t||"bool"===e&&"bool"===t)}function I(t){return t instanceof Float32Array||t instanceof Int32Array||t instanceof Uint8Array}function M(t){if("float32"===t||"int32"===t)return 4;if("complex64"===t)return 8;if("bool"===t)return 1;throw new Error("Unknown dtype "+t)}function F(t){if(null==t)return 0;var e=0;return t.forEach((function(t){return e+=t.length})),e}function P(t){return"string"==typeof t||t instanceof String}function j(t){return"boolean"==typeof t}function z(t){return"number"==typeof t}function L(t){return Array.isArray(t)?L(t[0]):t instanceof Float32Array?"float32":t instanceof Int32Array||t instanceof Uint8Array?"int32":z(t)?"float32":P(t)?"string":j(t)?"bool":"float32"}function B(t){return!!(t&&t.constructor&&t.call&&t.apply)}function U(t,e){for(var n=e;n<t;++n)if(t%n==0)return n;return t}function $(t){var e=t.length;if(e<2)return[];var n=new Array(e-1);n[e-2]=t[e-1];for(var r=e-3;r>=0;--r)n[r]=n[r+1]*t[r+1];return n}function V(t,e,n){if("string"===e)throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(t)&&(t=y(t)),n&&T(t,e),function(t,e){return t instanceof Float32Array&&"float32"===e||t instanceof Int32Array&&"int32"===e||t instanceof Uint8Array&&"bool"===e}(t,e))return t;if(null==e||"float32"===e||"complex64"===e)return new Float32Array(t);if("int32"===e)return new Int32Array(t);if("bool"===e){for(var r=new Uint8Array(t.length),i=0;i<r.length;++i)0!==Math.round(t[i])&&(r[i]=1);return r}throw new Error("Unknown data type "+e)}function W(t,e){if(0===t.length)return e[0];var n=t.reduce((function(t,e){return t*e}));if(0===n)return[];if(n!==e.length)throw new Error("["+t+"] does not match the input size.");return function t(e,n,r){var i=new Array;if(1===n.length)for(var o=n[0],a=0;a<o;a++)i[a]=r[e+a];else{o=n[0];var s=n.slice(1),u=s.reduce((function(t,e){return t*e}));for(a=0;a<o;a++)i[a]=t(e+a*u,s,r)}return i}(0,t,e)}function q(t,e){for(var n=H(t,e),r=0;r<n.length;r++)n[r]=1;return n}function H(t,e){if(null==e||"float32"===e||"complex64"===e)return new Float32Array(t);if("int32"===e)return new Int32Array(t);if("bool"===e)return new Uint8Array(t);throw new Error("Unknown data type "+e)}function G(){return u().platform.now()}function X(t){t.forEach((function(e){p(Number.isInteger(e)&&e>=0,(function(){return"Tensor must have a shape comprised of positive integers but got shape ["+t+"]."}))}))}function K(t,e){return void 0===e&&(e="utf-8"),e=e||"utf-8",u().platform.encode(t,e)}function Y(t,e){return void 0===e&&(e="utf-8"),e=e||"utf-8",u().platform.decode(t,e)}var Z=Object.freeze({shuffle:c,clamp:h,nearestLargerEven:d,sum:f,randUniform:function(t,e){var n=Math.random();return e*n+(1-n)*t},distSquared:function(t,e){for(var n=0,r=0;r<t.length;r++){var i=Number(t[r])-Number(e[r]);n+=i*i}return n},assert:p,assertShapesMatch:m,assertNonNull:g,flatten:y,sizeFromShape:v,isScalarShape:function(t){return 0===t.length},arraysEqual:b,isInt:w,tanh:x,sizeToSquarishShape:_,createShuffledIndices:function(t){for(var e=new Uint32Array(t),n=0;n<t;++n)e[n]=n;return c(e),e},rightPad:C,repeatedTry:k,inferFromImplicitShape:S,parseAxisParam:E,squeezeShape:O,getTypedArrayFromDType:A,getArrayFromDType:N,checkConversionForErrors:T,isValidDtype:D,hasEncodingLoss:R,isTypedArray:I,bytesPerElement:M,bytesFromStringArray:F,isString:P,isBoolean:j,isNumber:z,inferDtype:L,isFunction:B,nearestDivisor:U,computeStrides:$,toTypedArray:V,toNestedArray:W,makeOnesTypedArray:q,makeZerosTypedArray:H,now:G,assertNonNegativeIntegerDimensions:X,fetch:function(t,e){return u().platform.fetch(t,e)},encodeString:K,decodeString:Y}),Q=function(){function t(t,e){this.backendTimer=t,this.logger=e,null==e&&(this.logger=new J)}return t.prototype.profileKernel=function(t,e,n){var r,i=this,o=this.backendTimer.time((function(){r=n()}));return(Array.isArray(r)?r:[r]).forEach((function(n){n.data().then((function(r){!function(t,e,n){if("float32"!==e)return!1;for(var r=0;r<t.length;r++){var i=t[r];if(isNaN(i)||!isFinite(i))return console.warn("Found "+i+" in the result of '"+n+"'"),!0}}(r,n.dtype,t),o.then((function(o){var a="";null!=o.getExtraProfileInfo&&(a=o.getExtraProfileInfo()),i.logger.logKernelProfile(t,n,r,o.kernelMs,e,a)}))}))})),r},t}(),J=function(){function t(){}return t.prototype.logKernelProfile=function(t,e,n,r,i,o){var a=C(r+"ms",9),s=C(t,25),u=e.rank,l=e.size,c=C(e.shape.toString(),14),h="";for(var d in i){var f=i[d].shape,p=f.length;h+=d+": "+p+"D "+(p>0?f:"")+" "}console.log("%c"+s+"\t%c"+a+"\t%c"+u+"D "+c+"\t%c"+l+"\t%c"+h+"\t%c"+o,"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")},t}();function tt(t,e,n){return C(Array.isArray(t)?parseFloat(t[0].toFixed(7))+" + "+parseFloat(t[1].toFixed(7))+"j":P(t)?"'"+t+"'":"bool"===n?et(t):parseFloat(t.toFixed(7)).toString(),e)}function et(t){return 0===t?"false":"true"}function nt(t){for(var e=[],n=0;n<t.length;n+=2)e.push([t[n],t[n+1]]);return e}var rt=function(){function t(t,e,n){var r=this;if(this.dtype=e,this.shape=t.slice(),this.size=v(t),null!=n){var i=n.length;p(i===this.size,(function(){return"Length of values '"+i+"' does not match the size inferred by the shape '"+r.size+"'."}))}if("complex64"===e)throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=n||N(e,this.size),this.strides=$(t)}return t.prototype.set=function(t){for(var e=this,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];0===n.length&&(n=[0]),p(n.length===this.rank,(function(){return"The number of provided coordinates ("+n.length+") must match the rank ("+e.rank+")"}));var i=this.locToIndex(n);this.values[i]=t},t.prototype.get=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];0===t.length&&(t=[0]);for(var n=0,r=0,i=t;r<i.length;r++){var o=i[r];if(o<0||o>=this.shape[n]){var a="Requested out of range element at "+t+".   Buffer shape="+this.shape;throw new Error(a)}n++}for(var s=t[t.length-1],u=0;u<t.length-1;++u)s+=this.strides[u]*t[u];return this.values[s]},t.prototype.locToIndex=function(t){if(0===this.rank)return 0;if(1===this.rank)return t[0];for(var e=t[t.length-1],n=0;n<t.length-1;++n)e+=this.strides[n]*t[n];return e},t.prototype.indexToLoc=function(t){if(0===this.rank)return[];if(1===this.rank)return[t];for(var e=new Array(this.shape.length),n=0;n<e.length-1;++n)e[n]=Math.floor(t/this.strides[n]),t-=e[n]*this.strides[n];return e[e.length-1]=t,e},Object.defineProperty(t.prototype,"rank",{get:function(){return this.shape.length},enumerable:!0,configurable:!0}),t.prototype.toTensor=function(){return st.make(this.shape,{values:this.values},this.dtype)},t}(),it=null,ot=null,at=null,st=function(){function t(t,e,n,r,i){this.kept=!1,this.isDisposedInternal=!1,this.shape=t.slice(),this.dtype=e||"float32",this.size=v(t),this.strides=$(t),this.dataId=null!=r?r:{},this.id=it().nextTensorId(),this.rankType=this.rank<5?this.rank.toString():"higher",it().registerTensor(this,i),null!=n&&it().write(i,this.dataId,n)}return t.make=function(e,n,r,i){var o=n.values;return null!=n.values&&"string"===r&&P(n.values[0])&&(o=n.values.map((function(t){return K(t)}))),new t(e,r,o,n.dataId,i)},t.prototype.flatten=function(){return this.throwIfDisposed(),this.as1D()},t.prototype.asScalar=function(){return this.throwIfDisposed(),p(1===this.size,(function(){return"The array must have only 1 element."})),this.reshape([])},t.prototype.as1D=function(){return this.throwIfDisposed(),this.reshape([this.size])},t.prototype.as2D=function(t,e){return this.throwIfDisposed(),this.reshape([t,e])},t.prototype.as3D=function(t,e,n){return this.throwIfDisposed(),this.reshape([t,e,n])},t.prototype.as4D=function(t,e,n,r){return this.throwIfDisposed(),this.reshape([t,e,n,r])},t.prototype.as5D=function(t,e,n,r,i){return this.throwIfDisposed(),this.reshape([t,e,n,r,i])},t.prototype.asType=function(t){return this.throwIfDisposed(),ot.cast(this,t)},Object.defineProperty(t.prototype,"rank",{get:function(){return this.shape.length},enumerable:!0,configurable:!0}),t.prototype.buffer=function(){return o(this,void 0,void 0,(function(){var t;return a(this,(function(e){switch(e.label){case 0:return[4,this.data()];case 1:return t=e.sent(),[2,ot.buffer(this.shape,this.dtype,t)]}}))}))},t.prototype.bufferSync=function(){return ot.buffer(this.shape,this.dtype,this.dataSync())},t.prototype.array=function(){return o(this,void 0,void 0,(function(){var t;return a(this,(function(e){switch(e.label){case 0:return[4,this.data()];case 1:return t=e.sent(),[2,W(this.shape,t)]}}))}))},t.prototype.arraySync=function(){return W(this.shape,this.dataSync())},t.prototype.data=function(){return o(this,void 0,void 0,(function(){var t,e;return a(this,(function(n){switch(n.label){case 0:return this.throwIfDisposed(),t=it().read(this.dataId),"string"!==this.dtype?[3,2]:[4,t];case 1:e=n.sent();try{return[2,e.map((function(t){return Y(t)}))]}catch(t){throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}n.label=2;case 2:return[2,t]}}))}))},t.prototype.dataSync=function(){this.throwIfDisposed();var t=it().readSync(this.dataId);if("string"===this.dtype)try{return t.map((function(t){return Y(t)}))}catch(t){throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return t},t.prototype.bytes=function(){return o(this,void 0,void 0,(function(){var t;return a(this,(function(e){switch(e.label){case 0:return this.throwIfDisposed(),[4,it().read(this.dataId)];case 1:return t=e.sent(),"string"===this.dtype?[2,t]:[2,new Uint8Array(t.buffer)]}}))}))},t.prototype.dispose=function(){this.isDisposed||(it().disposeTensor(this),this.isDisposedInternal=!0)},Object.defineProperty(t.prototype,"isDisposed",{get:function(){return this.isDisposedInternal},enumerable:!0,configurable:!0}),t.prototype.throwIfDisposed=function(){if(this.isDisposed)throw new Error("Tensor is disposed.")},t.prototype.toFloat=function(){return this.asType("float32")},t.prototype.toInt=function(){return this.asType("int32")},t.prototype.toBool=function(){return this.asType("bool")},t.prototype.print=function(t){return void 0===t&&(t=!1),ot.print(this,t)},t.prototype.reshape=function(t){return this.throwIfDisposed(),ot.reshape(this,t)},t.prototype.reshapeAs=function(t){return this.throwIfDisposed(),this.reshape(t.shape)},t.prototype.expandDims=function(t){return void 0===t&&(t=0),ot.expandDims(this,t)},t.prototype.cumsum=function(t,e,n){return void 0===t&&(t=0),void 0===e&&(e=!1),void 0===n&&(n=!1),ot.cumsum(this,t,e,n)},t.prototype.squeeze=function(t){return this.throwIfDisposed(),ot.squeeze(this,t)},t.prototype.clone=function(){return this.throwIfDisposed(),ot.clone(this)},t.prototype.oneHot=function(t,e,n){return this.throwIfDisposed(),ot.oneHot(this,t,e,n)},t.prototype.toString=function(t){return void 0===t&&(t=!1),function(t,e,n,r){var i=$(e),o=function(t,e,n,r){var i=v(e),o=r[r.length-1],a=new Array(o).fill(0),s=e.length,u="complex64"===n?nt(t):t;if(s>1)for(var l=0;l<i/o;l++)for(var c=l*o,h=0;h<o;h++)a[h]=Math.max(a[h],tt(u[c+h],0,n).length);return a}(t,e,n,i),a=e.length,s=function t(e,n,r,i,o,a){void 0===a&&(a=!0);var s="complex64"===r?2:1,u=n[0],l=n.length;if(0===l)return"complex64"===r?[tt(nt(e)[0],0,r)]:"bool"===r?[et(e[0])]:[e[0].toString()];if(1===l){if(u>20){var c=Array.from(e.slice(0,3*s)),h=Array.from(e.slice(u-3*s,u));return"complex64"===r&&(c=nt(c),h=nt(h)),["["+c.map((function(t,e){return tt(t,o[e],r)})).join(", ")+", ..., "+h.map((function(t,e){return tt(t,o[u-3+e],r)})).join(", ")+"]"]}return["["+("complex64"===r?nt(e):Array.from(e)).map((function(t,e){return tt(t,o[e],r)})).join(", ")+"]"]}var d=n.slice(1),f=i.slice(1),p=i[0]*s,m=[];if(u>20){for(var g=0;g<3;g++)m.push.apply(m,t(e.slice(y=g*p,y+p),d,r,f,o,!1));for(m.push("..."),g=u-3;g<u;g++)m.push.apply(m,t(e.slice(y=g*p,y+p),d,r,f,o,g===u-1))}else for(g=0;g<u;g++){var y;m.push.apply(m,t(e.slice(y=g*p,y+p),d,r,f,o,g===u-1))}var v=2===l?",":"";for(m[0]="["+m[0]+v,g=1;g<m.length-1;g++)m[g]=" "+m[g]+v;var b=",\n";for(g=2;g<l;g++)b+="\n";return m[m.length-1]=" "+m[m.length-1]+"]"+(a?"":b),m}(t,e,n,i,o),u=["Tensor"];return r&&(u.push("  dtype: "+n),u.push("  rank: "+a),u.push("  shape: ["+e+"]"),u.push("  values:")),u.push(s.map((function(t){return"    "+t})).join("\n")),u.join("\n")}(this.dataSync(),this.shape,this.dtype,t)},t.prototype.tile=function(t){return this.throwIfDisposed(),ot.tile(this,t)},t.prototype.gather=function(t,e){return void 0===e&&(e=0),this.throwIfDisposed(),ot.gather(this,t,e)},t.prototype.matMul=function(t,e,n){return void 0===e&&(e=!1),void 0===n&&(n=!1),this.throwIfDisposed(),ot.matMul(this,t,e,n)},t.prototype.dot=function(t){return this.throwIfDisposed(),ot.dot(this,t)},t.prototype.norm=function(t,e,n){return void 0===t&&(t="euclidean"),void 0===e&&(e=null),void 0===n&&(n=!1),this.throwIfDisposed(),ot.norm(this,t,e,n)},t.prototype.slice=function(t,e){return this.throwIfDisposed(),ot.slice(this,t,e)},t.prototype.reverse=function(t){return this.throwIfDisposed(),ot.reverse(this,t)},t.prototype.concat=function(e,n){return void 0===n&&(n=0),this.throwIfDisposed(),e instanceof t&&(e=[e]),ot.concat([this].concat(e),n)},t.prototype.split=function(t,e){return void 0===e&&(e=0),this.throwIfDisposed(),ot.split(this,t,e)},t.prototype.stack=function(t,e){return void 0===e&&(e=0),ot.stack([this,t],e)},t.prototype.unstack=function(t){return void 0===t&&(t=0),ot.unstack(this,t)},t.prototype.pad=function(t,e){return void 0===e&&(e=0),ot.pad(this,t,e)},t.prototype.batchNormalization=function(t,e,n,r,i){return void 0===n&&(n=.001),at("tf.batchNormalization() is going away. Use tf.batchNorm() instead, and note the positional argument change of scale, offset, and varianceEpsilon"),this.batchNorm(t,e,i,r,n)},t.prototype.batchNorm=function(t,e,n,r,i){return void 0===i&&(i=.001),this.throwIfDisposed(),ot.batchNorm(this,t,e,n,r,i)},t.prototype.all=function(t,e){return void 0===t&&(t=null),void 0===e&&(e=!1),this.throwIfDisposed(),ot.all(this,t,e)},t.prototype.any=function(t,e){return void 0===t&&(t=null),void 0===e&&(e=!1),this.throwIfDisposed(),ot.any(this,t,e)},t.prototype.logSumExp=function(t,e){return void 0===t&&(t=null),void 0===e&&(e=!1),this.throwIfDisposed(),ot.logSumExp(this,t,e)},t.prototype.sum=function(t,e){return void 0===t&&(t=null),void 0===e&&(e=!1),this.throwIfDisposed(),ot.sum(this,t,e)},t.prototype.prod=function(t,e){return void 0===t&&(t=null),void 0===e&&(e=!1),this.throwIfDisposed(),ot.prod(this,t,e)},t.prototype.mean=function(t,e){return void 0===t&&(t=null),void 0===e&&(e=!1),this.throwIfDisposed(),ot.mean(this,t,e)},t.prototype.min=function(t,e){return void 0===t&&(t=null),void 0===e&&(e=!1),this.throwIfDisposed(),ot.min(this,t,e)},t.prototype.max=function(t,e){return void 0===t&&(t=null),void 0===e&&(e=!1),this.throwIfDisposed(),ot.max(this,t,e)},t.prototype.argMin=function(t){return void 0===t&&(t=null),this.throwIfDisposed(),ot.argMin(this,t)},t.prototype.argMax=function(t){return void 0===t&&(t=null),this.throwIfDisposed(),ot.argMax(this,t)},t.prototype.cast=function(t){return this.throwIfDisposed(),ot.cast(this,t)},t.prototype.add=function(t){return this.throwIfDisposed(),ot.add(this,t)},t.prototype.addStrict=function(t){return this.throwIfDisposed(),ot.addStrict(this,t)},t.prototype.atan2=function(t){return this.throwIfDisposed(),ot.atan2(this,t)},t.prototype.sub=function(t){return this.throwIfDisposed(),ot.sub(this,t)},t.prototype.subStrict=function(t){return this.throwIfDisposed(),ot.subStrict(this,t)},t.prototype.pow=function(t){return this.throwIfDisposed(),ot.pow(this,t)},t.prototype.powStrict=function(t){return this.throwIfDisposed(),ot.powStrict(this,t)},t.prototype.mul=function(t){return this.throwIfDisposed(),ot.mul(this,t)},t.prototype.mulStrict=function(t){return this.throwIfDisposed(),ot.mulStrict(this,t)},t.prototype.div=function(t){return this.throwIfDisposed(),ot.div(this,t)},t.prototype.floorDiv=function(t){return this.throwIfDisposed(),ot.floorDiv(this,t)},t.prototype.divStrict=function(t){return this.throwIfDisposed(),ot.divStrict(this,t)},t.prototype.minimum=function(t){return this.throwIfDisposed(),ot.minimum(this,t)},t.prototype.minimumStrict=function(t){return this.throwIfDisposed(),ot.minimumStrict(this,t)},t.prototype.maximum=function(t){return this.throwIfDisposed(),ot.maximum(this,t)},t.prototype.maximumStrict=function(t){return this.throwIfDisposed(),ot.maximumStrict(this,t)},t.prototype.mod=function(t){return this.throwIfDisposed(),ot.mod(this,t)},t.prototype.modStrict=function(t){return this.throwIfDisposed(),ot.modStrict(this,t)},t.prototype.squaredDifference=function(t){return this.throwIfDisposed(),ot.squaredDifference(this,t)},t.prototype.squaredDifferenceStrict=function(t){return this.throwIfDisposed(),ot.squaredDifferenceStrict(this,t)},t.prototype.transpose=function(t){return this.throwIfDisposed(),ot.transpose(this,t)},t.prototype.notEqual=function(t){return this.throwIfDisposed(),ot.notEqual(this,t)},t.prototype.notEqualStrict=function(t){return this.throwIfDisposed(),ot.notEqualStrict(this,t)},t.prototype.less=function(t){return this.throwIfDisposed(),ot.less(this,t)},t.prototype.lessStrict=function(t){return this.throwIfDisposed(),ot.lessStrict(this,t)},t.prototype.equal=function(t){return this.throwIfDisposed(),ot.equal(this,t)},t.prototype.equalStrict=function(t){return this.throwIfDisposed(),ot.equalStrict(this,t)},t.prototype.lessEqual=function(t){return this.throwIfDisposed(),ot.lessEqual(this,t)},t.prototype.lessEqualStrict=function(t){return this.throwIfDisposed(),ot.lessEqualStrict(this,t)},t.prototype.greater=function(t){return this.throwIfDisposed(),ot.greater(this,t)},t.prototype.greaterStrict=function(t){return this.throwIfDisposed(),ot.greaterStrict(this,t)},t.prototype.greaterEqual=function(t){return this.throwIfDisposed(),ot.greaterEqual(this,t)},t.prototype.greaterEqualStrict=function(t){return this.throwIfDisposed(),ot.greaterEqualStrict(this,t)},t.prototype.logicalAnd=function(t){return this.throwIfDisposed(),ot.logicalAnd(this,t)},t.prototype.logicalOr=function(t){return this.throwIfDisposed(),ot.logicalOr(this,t)},t.prototype.logicalNot=function(){return this.throwIfDisposed(),ot.logicalNot(this)},t.prototype.logicalXor=function(t){return this.throwIfDisposed(),ot.logicalXor(this,t)},t.prototype.where=function(t,e){return this.throwIfDisposed(),ot.where(t,this,e)},t.prototype.neg=function(){return this.throwIfDisposed(),ot.neg(this)},t.prototype.ceil=function(){return this.throwIfDisposed(),ot.ceil(this)},t.prototype.floor=function(){return this.throwIfDisposed(),ot.floor(this)},t.prototype.sign=function(){return this.throwIfDisposed(),ot.sign(this)},t.prototype.isNaN=function(){return this.throwIfDisposed(),ot.isNaN(this)},t.prototype.isInf=function(){return this.throwIfDisposed(),ot.isInf(this)},t.prototype.isFinite=function(){return this.throwIfDisposed(),ot.isFinite(this)},t.prototype.exp=function(){return this.throwIfDisposed(),ot.exp(this)},t.prototype.expm1=function(){return this.throwIfDisposed(),ot.expm1(this)},t.prototype.log=function(){return this.throwIfDisposed(),ot.log(this)},t.prototype.log1p=function(){return this.throwIfDisposed(),ot.log1p(this)},t.prototype.sqrt=function(){return this.throwIfDisposed(),ot.sqrt(this)},t.prototype.rsqrt=function(){return this.throwIfDisposed(),ot.rsqrt(this)},t.prototype.square=function(){return this.throwIfDisposed(),ot.square(this)},t.prototype.reciprocal=function(){return this.throwIfDisposed(),ot.reciprocal(this)},t.prototype.abs=function(){return this.throwIfDisposed(),ot.abs(this)},t.prototype.clipByValue=function(t,e){return this.throwIfDisposed(),ot.clipByValue(this,t,e)},t.prototype.relu=function(){return this.throwIfDisposed(),ot.relu(this)},t.prototype.relu6=function(){return this.throwIfDisposed(),ot.relu6(this)},t.prototype.elu=function(){return this.throwIfDisposed(),ot.elu(this)},t.prototype.selu=function(){return this.throwIfDisposed(),ot.selu(this)},t.prototype.leakyRelu=function(t){return void 0===t&&(t=.2),this.throwIfDisposed(),ot.leakyRelu(this,t)},t.prototype.prelu=function(t){return this.throwIfDisposed(),ot.prelu(this,t)},t.prototype.sigmoid=function(){return this.throwIfDisposed(),ot.sigmoid(this)},t.prototype.logSigmoid=function(){return this.throwIfDisposed(),ot.logSigmoid(this)},t.prototype.softplus=function(){return this.throwIfDisposed(),ot.softplus(this)},t.prototype.zerosLike=function(){return this.throwIfDisposed(),ot.zerosLike(this)},t.prototype.onesLike=function(){return this.throwIfDisposed(),ot.onesLike(this)},t.prototype.sin=function(){return this.throwIfDisposed(),ot.sin(this)},t.prototype.cos=function(){return this.throwIfDisposed(),ot.cos(this)},t.prototype.tan=function(){return this.throwIfDisposed(),ot.tan(this)},t.prototype.asin=function(){return this.throwIfDisposed(),ot.asin(this)},t.prototype.acos=function(){return this.throwIfDisposed(),ot.acos(this)},t.prototype.atan=function(){return this.throwIfDisposed(),ot.atan(this)},t.prototype.sinh=function(){return this.throwIfDisposed(),ot.sinh(this)},t.prototype.cosh=function(){return this.throwIfDisposed(),ot.cosh(this)},t.prototype.tanh=function(){return this.throwIfDisposed(),ot.tanh(this)},t.prototype.asinh=function(){return this.throwIfDisposed(),ot.asinh(this)},t.prototype.acosh=function(){return this.throwIfDisposed(),ot.acosh(this)},t.prototype.atanh=function(){return this.throwIfDisposed(),ot.atanh(this)},t.prototype.erf=function(){return this.throwIfDisposed(),ot.erf(this)},t.prototype.round=function(){return this.throwIfDisposed(),ot.round(this)},t.prototype.step=function(t){return void 0===t&&(t=0),this.throwIfDisposed(),ot.step(this,t)},t.prototype.softmax=function(t){return void 0===t&&(t=-1),this.throwIfDisposed(),ot.softmax(this,t)},t.prototype.logSoftmax=function(t){return void 0===t&&(t=-1),this.throwIfDisposed(),ot.logSoftmax(this,t)},t.prototype.resizeBilinear=function(t,e){return void 0===e&&(e=!1),this.throwIfDisposed(),ot.image.resizeBilinear(this,t,e)},t.prototype.resizeNearestNeighbor=function(t,e){return void 0===e&&(e=!1),this.throwIfDisposed(),ot.image.resizeNearestNeighbor(this,t,e)},t.prototype.conv1d=function(t,e,n,r,i,o){return void 0===r&&(r="NWC"),void 0===i&&(i=1),this.throwIfDisposed(),ot.conv1d(this,t,e,n,r,i,o)},t.prototype.conv2d=function(t,e,n,r,i,o){return void 0===r&&(r="NHWC"),void 0===i&&(i=[1,1]),this.throwIfDisposed(),ot.conv2d(this,t,e,n,r,i,o)},t.prototype.conv2dTranspose=function(t,e,n,r,i){return this.throwIfDisposed(),ot.conv2dTranspose(this,t,e,n,r,i)},t.prototype.depthwiseConv2D=function(t,e,n,r,i,o){return void 0===r&&(r="NHWC"),void 0===i&&(i=[1,1]),this.throwIfDisposed(),ot.depthwiseConv2d(this,t,e,n,r,i,o)},t.prototype.separableConv2d=function(t,e,n,r,i,o){return void 0===i&&(i=[1,1]),void 0===o&&(o="NHWC"),this.throwIfDisposed(),ot.separableConv2d(this,t,e,n,r,i,o)},t.prototype.avgPool=function(t,e,n,r){return this.throwIfDisposed(),ot.avgPool(this,t,e,n,r)},t.prototype.maxPool=function(t,e,n,r){return this.throwIfDisposed(),ot.maxPool(this,t,e,n,r)},t.prototype.localResponseNormalization=function(t,e,n,r){return void 0===t&&(t=5),void 0===e&&(e=1),void 0===n&&(n=1),void 0===r&&(r=.5),ot.localResponseNormalization(this,t,e,n,r)},t.prototype.pool=function(t,e,n,r,i){return this.throwIfDisposed(),ot.pool(this,t,e,n,r,i)},t.prototype.variable=function(t,e,n){return void 0===t&&(t=!0),this.throwIfDisposed(),ut.variable(this,t,e,n)},t.prototype.unsortedSegmentSum=function(t,e){return this.throwIfDisposed(),ot.unsortedSegmentSum(this,t,e)},t.prototype.batchToSpaceND=function(t,e){return this.throwIfDisposed(),ot.batchToSpaceND(this,t,e)},t.prototype.spaceToBatchND=function(t,e){return this.throwIfDisposed(),ot.spaceToBatchND(this,t,e)},t.prototype.topk=function(t,e){return void 0===t&&(t=1),void 0===e&&(e=!0),this.throwIfDisposed(),ot.topk(this,t,e)},t.prototype.stridedSlice=function(t,e,n,r,i,o,a,s){return void 0===r&&(r=0),void 0===i&&(i=0),void 0===o&&(o=0),void 0===a&&(a=0),void 0===s&&(s=0),this.throwIfDisposed(),ot.stridedSlice(this,t,e,n,r,i,o,a,s)},t.prototype.depthToSpace=function(t,e){return this.throwIfDisposed(),ot.depthToSpace(this,t,e)},t.prototype.fft=function(){return this.throwIfDisposed(),ot.spectral.fft(this)},t.prototype.ifft=function(){return this.throwIfDisposed(),ot.spectral.ifft(this)},t.prototype.rfft=function(){return this.throwIfDisposed(),ot.spectral.rfft(this)},t.prototype.irfft=function(){return this.throwIfDisposed(),ot.spectral.irfft(this)},t}();Object.defineProperty(st,Symbol.hasInstance,{value:function(t){return!!t&&null!=t.dataId&&null!=t.shape&&null!=t.dtype}});var ut=function(t){function e(e,n,r){void 0===n&&(n=!0);var i=t.call(this,e.shape,e.dtype,null,e.dataId)||this;i.trainable=n,i.name=r,null==i.name&&(i.name=it().nextVariableId().toString());try{it().registerVariable(i)}catch(t){throw it().disposeTensor(i),t}return i}return i(e,t),e.variable=function(t,n,r,i){return void 0===n&&(n=!0),null!=i&&i!==t.dtype&&(t=t.asType(i)),new e(t,n,r)},e.prototype.assign=function(t){if(t.dtype!==this.dtype)throw new Error("dtype of the new value ("+t.dtype+") and previous value ("+this.dtype+") must match");if(!b(t.shape,this.shape))throw new Error("shape of the new value ("+t.shape+") and previous value ("+this.shape+") must match");it().disposeTensor(this),this.dataId=t.dataId,it().registerTensor(this)},e.prototype.dispose=function(){it().disposeVariable(this),this.isDisposedInternal=!0},e}(st);Object.defineProperty(ut,Symbol.hasInstance,{value:function(t){return t instanceof st&&null!=t.assign&&t.assign instanceof Function}});var lt,ct,ht,dt,ft,pt=ut.variable;!function(t){t.R0="R0",t.R1="R1",t.R2="R2",t.R3="R3",t.R4="R4",t.R5="R5",t.R6="R6"}(lt||(lt={})),function(t){t.float32="float32",t.int32="int32",t.bool="int32",t.complex64="complex64"}(ct||(ct={})),function(t){t.float32="float32",t.int32="int32",t.bool="bool",t.complex64="complex64"}(ht||(ht={})),function(t){t.float32="float32",t.int32="float32",t.bool="float32",t.complex64="complex64"}(dt||(dt={})),function(t){t.float32="complex64",t.int32="complex64",t.bool="complex64",t.complex64="complex64"}(ft||(ft={}));var mt={float32:dt,int32:ct,bool:ht,complex64:ft};function gt(t,e){if("string"===t||"string"===e){if("string"===t&&"string"===e)return"string";throw new Error("Can not upcast "+t+" with "+e)}return mt[t][e]}function yt(t){return gt(t,"int32")}function vt(t,e){if(t.dtype===e.dtype)return[t,e];var n=gt(t.dtype,e.dtype);return[t.cast(n),e.cast(n)]}function bt(t,e){p(t.dtype===e.dtype,(function(){return"The dtypes of the first("+t.dtype+") and second("+e.dtype+") input must match"}))}function wt(t){var e=[];return function t(e,n,r){if(null!=e)if(e instanceof st)n.push(e);else if(i=e,Array.isArray(i)||"object"==typeof i){var i,o=e;for(var a in o){var s=o[a];r.has(s)||(r.add(s),t(s,n,r))}}}(t,e,new Set),e}var xt,_t=Object.freeze({makeTypesMatch:vt,assertTypesMatch:bt,isTensorInList:function(t,e){for(var n=0;n<e.length;n++)if(e[n].id===t.id)return!0;return!1},getTensorsInContainer:wt}),Ct=function(){function t(){this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null}}return t.prototype.dispose=function(){for(var t in this.registeredVariables)this.registeredVariables[t].dispose()},t}(),kt=function(){function t(t){this.ENV=t,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new Ct}return t.prototype.ready=function(){return o(this,void 0,void 0,(function(){var t,e,n;return a(this,(function(r){switch(r.label){case 0:if(null!=this.pendingBackendInit)return[2,this.pendingBackendInit.then((function(){}))];if(null!=this.backendInstance)return[2];t=this.getSortedBackends(),e=0,r.label=1;case 1:return e<t.length?[4,this.initializeBackend(n=t[e]).success]:[3,5];case 2:return r.sent()?[4,this.setBackend(n)]:[3,4];case 3:return r.sent(),[2];case 4:return e++,[3,1];case 5:throw new Error("Could not initialize any backends, all backend initializations failed.")}}))}))},Object.defineProperty(t.prototype,"backend",{get:function(){if(null!=this.pendingBackendInit)throw new Error("Backend '"+this.backendName+"' has not yet been initialized. Make sure to await tf.ready() before calling other methods");if(null==this.backendInstance){var t=this.initializeBackendsAndReturnBest(),e=t.name;if(t.asyncInit)throw new Error("The highest priority backend '"+e+"' has not yet been initialized. Make sure to await tf.ready() before calling other methods");this.setBackend(e)}return this.backendInstance},enumerable:!0,configurable:!0}),t.prototype.backendNames=function(){return Object.keys(this.registryFactory)},t.prototype.findBackend=function(t){if(!(t in this.registry)){if(!(t in this.registryFactory))return null;if(this.initializeBackend(t).asyncInit)return null}return this.registry[t]},t.prototype.findBackendFactory=function(t){return t in this.registryFactory?this.registryFactory[t].factory:null},t.prototype.registerBackend=function(t,e,n){return void 0===n&&(n=1),t in this.registryFactory?(console.warn(t+" backend was already registered. Reusing existing backend factory."),!1):(this.registryFactory[t]={factory:e,priority:n},!0)},t.prototype.setBackend=function(t){return o(this,void 0,void 0,(function(){var e,n,r;return a(this,(function(i){switch(i.label){case 0:if(null==this.registryFactory[t])throw new Error("Backend name '"+t+"' not found in registry");return this.backendName=t,null!=this.registry[t]?[3,4]:(this.backendInstance=null,e=this.initializeBackend(t),n=e.success,e.asyncInit?[4,n]:[3,2]);case 1:return r=i.sent(),[3,3];case 2:r=n,i.label=3;case 3:if(!r)return[2,!1];i.label=4;case 4:return this.backendInstance=this.registry[t],this.profiler=new Q(this.backendInstance),[2,!0]}}))}))},t.prototype.initializeBackend=function(t){var e=this,n=this.registryFactory[t];if(null==n)throw new Error("Cannot initialize backend "+t+", no registration found.");try{var r=n.factory();if(Promise.resolve(r)===r){var i=++this.pendingBackendInitId,o=r.then((function(n){return!(i<e.pendingBackendInitId||(e.registry[t]=n,e.pendingBackendInit=null,0))})).catch((function(n){return!(i<e.pendingBackendInitId||(e.pendingBackendInit=null,console.warn("Initialization of backend "+t+" failed"),console.warn(n.stack||n.message),1))}));return this.pendingBackendInit=o,{success:o,asyncInit:!0}}return this.registry[t]=r,{success:!0,asyncInit:!1}}catch(e){return console.warn("Initialization of backend "+t+" failed"),console.warn(e.stack||e.message),{success:!1,asyncInit:!1}}},t.prototype.removeBackend=function(t){if(!(t in this.registryFactory))throw new Error(t+" backend not found in registry");this.backendName===t&&null!=this.pendingBackendInit&&this.pendingBackendInitId++,t in this.registry&&(this.registry[t].dispose(),delete this.registry[t]),delete this.registryFactory[t],this.backendName===t&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)},t.prototype.getSortedBackends=function(){var t=this;if(0===Object.keys(this.registryFactory).length)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort((function(e,n){return t.registryFactory[n].priority-t.registryFactory[e].priority}))},t.prototype.initializeBackendsAndReturnBest=function(){for(var t=this.getSortedBackends(),e=0;e<t.length;e++){var n=t[e],r=this.initializeBackend(n),i=r.asyncInit;if(i||r.success)return{name:n,asyncInit:i}}throw new Error("Could not initialize any backends, all backend initializations failed.")},t.prototype.moveData=function(t,e){this.write(t,e,this.readSync(e))},t.prototype.tidy=function(t,e){var n,r=this,i=null;if(null==e){if("function"!=typeof t)throw new Error("Please provide a function to tidy()");e=t}else{if("string"!=typeof t&&!(t instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if("function"!=typeof e)throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");i=t}return this.scopedRun((function(){return r.startScope(i)}),(function(){return r.endScope(n)}),(function(){return(n=e())instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),n}))},t.prototype.scopedRun=function(t,e,n){t();try{var r=n();return e(),r}catch(t){throw e(),t}},t.prototype.nextTensorId=function(){return t.nextTensorId++},t.prototype.nextVariableId=function(){return t.nextVariableId++},t.prototype.clone=function(t){var e=st.make(t.shape,{dataId:t.dataId},t.dtype);return this.addTapeNode([t],e,(function(t){return[t.toFloat()]})),e},t.prototype.runKernel=function(t,e,n){var r,i=this,o=[],a=this.isTapeOn(),s=null!=this.state.activeScope?this.state.activeScope.name:"",u=function(t){a&&(o=t.map((function(t){return i.keep(i.clone(t))})))},l=this.state.numBytes,c=this.state.numTensors;if(this.scopedRun((function(){return i.state.kernelDepth++}),(function(){return i.state.kernelDepth--}),(function(){r=i.ENV.getBool("DEBUG")?i.profiler.profileKernel(s,e,(function(){return t(i.backend,u)})):t(i.backend,u)})),a){var h={id:this.state.nextTapeNodeId++,name:s,inputs:e,outputs:Array.isArray(r)?r:[r],saved:o};null!=n&&(h.gradient=function(t){return n(t,o)}),this.state.activeTape.push(h)}return this.state.profiling&&this.state.activeProfile.kernels.push({name:s,bytesAdded:this.state.numBytes-l,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-c,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(e).map((function(t){return e[t].shape})),outputShape:Array.isArray(r)?r.map((function(t){return t.shape})):r.shape}),r},t.prototype.registerTensor=function(t,e){var n=this.state.tensorInfo.has(t.dataId)?this.state.tensorInfo.get(t.dataId).refCount:0;if(this.state.numTensors++,"string"===t.dtype&&this.state.numStringTensors++,0===n){this.state.numDataBuffers++;var r=0;"complex64"!==t.dtype&&"string"!==t.dtype&&(r=t.size*M(t.dtype)),this.state.tensorInfo.set(t.dataId,{backend:null!=e?e:this.backend,dtype:t.dtype,shape:t.shape,bytes:r,refCount:0}),this.state.numBytes+=r,null!=e?e.register(t.dataId,t.shape,t.dtype):this.backend.register(t.dataId,t.shape,t.dtype)}this.state.tensorInfo.get(t.dataId).refCount++,t instanceof ut||this.track(t)},t.prototype.registerVariable=function(t){if(null!=this.state.registeredVariables[t.name])throw new Error("Variable with name "+t.name+" was already registered");this.state.registeredVariables[t.name]=t},t.prototype.disposeTensor=function(t){if(this.state.tensorInfo.has(t.dataId)){this.state.numTensors--,"string"===t.dtype&&this.state.numStringTensors--;var e=this.state.tensorInfo.get(t.dataId);e.refCount<=1?("complex64"!==t.dtype&&(this.state.numBytes-=e.bytes),this.state.numDataBuffers--,e.backend.disposeData(t.dataId),this.state.tensorInfo.delete(t.dataId)):this.state.tensorInfo.get(t.dataId).refCount--}},t.prototype.disposeVariables=function(){for(var t in this.state.registeredVariables)this.disposeVariable(this.state.registeredVariables[t])},t.prototype.disposeVariable=function(t){this.disposeTensor(t),null!=this.state.registeredVariables[t.name]&&delete this.state.registeredVariables[t.name]},t.prototype.memory=function(){var t=this.backend.memory();return t.numTensors=this.state.numTensors,t.numDataBuffers=this.state.numDataBuffers,t.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(t.unreliable=!0,null==t.reasons&&(t.reasons=[]),t.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),t},t.prototype.profile=function(t){return o(this,void 0,void 0,(function(){var e,n;return a(this,(function(r){return this.state.profiling=!0,e=this.state.numBytes,n=this.state.numTensors,this.state.activeProfile.kernels=[],this.state.activeProfile.result=t(),this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max.apply(Math,this.state.activeProfile.kernels.map((function(t){return t.totalBytesSnapshot}))),this.state.activeProfile.newBytes=this.state.numBytes-e,this.state.activeProfile.newTensors=this.state.numTensors-n,[2,this.state.activeProfile]}))}))},t.prototype.isTapeOn=function(){return this.state.gradientDepth>0&&0===this.state.kernelDepth},t.prototype.addTapeNode=function(t,e,n){var r={};t.forEach((function(t,e){r[e]=t}));var i={id:this.state.nextTapeNodeId++,name:this.state.activeScope.name,inputs:r,outputs:[e],gradient:function(t){var e=n(t),r={};return e.forEach((function(t,e){r[e]=function(){return t}})),r}};this.state.activeTape.push(i)},t.prototype.keep=function(t){return t.kept=!0,t},t.prototype.startTape=function(){0===this.state.gradientDepth&&(this.state.activeTape=[]),this.state.gradientDepth++},t.prototype.endTape=function(){this.state.gradientDepth--},t.prototype.startScope=function(t){var e={track:[],name:"unnamed scope",id:this.state.nextScopeId++};t&&(e.name=t),this.state.scopeStack.push(e),this.state.activeScope=e},t.prototype.endScope=function(t){for(var e=this,n=wt(t),r=new Set(n.map((function(t){return t.id}))),i=0;i<this.state.activeScope.track.length;i++){var o=this.state.activeScope.track[i];o.kept||r.has(o.id)||o.dispose()}var a=this.state.scopeStack.pop();this.state.activeScope=0===this.state.scopeStack.length?null:this.state.scopeStack[this.state.scopeStack.length-1],n.forEach((function(t){t.kept||t.scopeId!==a.id||e.track(t)}))},t.prototype.gradients=function(t,e,n,r){var i=this;if(void 0===r&&(r=!1),p(e.length>0,(function(){return"gradients() received an empty list of xs."})),null!=n&&"float32"!==n.dtype)throw new Error("dy must have 'float32' dtype, but has '"+n.dtype+"'");var o=this.scopedRun((function(){return i.startTape()}),(function(){return i.endTape()}),(function(){return i.tidy("forward",t)}));p(o instanceof st,(function(){return"The result y returned by f() must be a tensor."}));var a=function(t,e,n){for(var r={},i={},o=0;o<e.length;o++)r[e[o].id]=!0;for(o=0;o<t.length;o++){var a=(p=t[o]).inputs;for(var s in a){for(var u=a[s],l=!1,c=0;c<e.length;c++)if(r[u.id]){p.outputs.forEach((function(t){return r[t.id]=!0})),l=!0,i[p.id]=!0;break}if(l)break}}var h={};h[n.id]=!0;var d={};for(o=t.length-1;o>=0;o--)for(a=(p=t[o]).inputs,c=0;c<p.outputs.length;c++)if(h[p.outputs[c].id]){for(var s in a)h[a[s].id]=!0,d[p.id]=!0;break}var f=[];for(o=0;o<t.length;o++){var p;if(i[(p=t[o]).id]&&d[p.id]){var m={};for(var s in p.inputs){var g=p.inputs[s];r[g.id]&&(m[s]=g)}var y=Object.assign({},p);y.inputs=m,y.outputs=p.outputs,f.push(y)}}return f}(this.state.activeTape,e,o);if(!r&&0===a.length&&e.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",(function(){var t,r,s={};s[o.id]=null==n?(r=q(v(t=o.shape),"float32"),st.make(t,{values:r})):n,function(t,e,n){for(var r=function(r){var i=e[r],o=[];if(i.outputs.forEach((function(e){var n=t[e.id];if(null!=n)o.push(n);else{var r=st.make(e.shape,{values:H(e.size,e.dtype)},e.dtype);o.push(r)}})),null==i.gradient)throw new Error("Cannot compute gradient: gradient function not found for "+i.name+".");var a=i.gradient(1===i.outputs.length?o[0]:o),s=function(e){if(!(e in a))throw new Error("Cannot backprop through input "+e+". Available gradients found: "+Object.keys(a)+".");var r=n((function(){return a[e]()}));if("float32"!==r.dtype)throw new Error("Error in gradient for op "+i.name+". The gradient of input "+e+" must have 'float32' dtype, but has '"+r.dtype+"'");var o=i.inputs[e];if(!b(r.shape,o.shape))throw new Error("Error in gradient for op "+i.name+". The gradient of input '"+e+"' has shape '"+r.shape+"', which does not match the shape of the input '"+o.shape+"'");if(null==t[o.id])t[o.id]=r;else{var s=t[o.id];t[o.id]=s.add(r),s.dispose()}};for(var u in i.inputs)s(u)},i=e.length-1;i>=0;i--)r(i)}(s,a,(function(t){return i.tidy(t)}));var u=e.map((function(t){return s[t.id]}));return 0===i.state.gradientDepth&&(i.state.activeTape.forEach((function(t){for(var e in t.saved)t.saved[e].dispose()})),i.state.activeTape=null),{value:o,grads:u}}))},t.prototype.customGrad=function(t){var e=this;return p(B(t),(function(){return"The f passed in customGrad(f) must be a function."})),function(){for(var n,r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];p(r.every((function(t){return t instanceof st})),(function(){return"The args passed in customGrad(f)(x1, x2,...) must all be tensors"}));var o={};return r.forEach((function(t,e){o[e]=t})),e.runKernel((function(e,i){return p((n=t.apply(void 0,r.concat([i]))).value instanceof st,(function(){return"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor"})),p(B(n.gradFunc),(function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function."})),n.value}),o,(function(t,e){var i=n.gradFunc(t,e),o=Array.isArray(i)?i:[i];p(o.length===r.length,(function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...)."})),p(o.every((function(t){return t instanceof st})),(function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors."}));var a={};return o.forEach((function(t,e){a[e]=function(){return t}})),a}))}},t.prototype.write=function(t,e,n){var r=this.state.tensorInfo.get(e),i=r.backend;if(t=t||this.backend,"string"===r.dtype){var o=F(n);this.state.numBytes+=o-r.bytes,r.bytes=o}t!==i&&(i.disposeData(e),r.backend=t,t.register(e,r.shape,r.dtype)),t.write(e,n)},t.prototype.readSync=function(t){return this.state.tensorInfo.get(t).backend.readSync(t)},t.prototype.read=function(t){return this.state.tensorInfo.get(t).backend.read(t)},t.prototype.fromPixels=function(t,e){return this.backend.fromPixels(t,e)},t.prototype.time=function(t){return o(this,void 0,void 0,(function(){var e,n;return a(this,(function(r){switch(r.label){case 0:return e=G(),[4,this.backend.time(t)];case 1:return(n=r.sent()).wallMs=G()-e,[2,n]}}))}))},t.prototype.track=function(t){return null!=this.state.activeScope&&(t.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(t)),t},Object.defineProperty(t.prototype,"registeredVariables",{get:function(){return this.state.registeredVariables},enumerable:!0,configurable:!0}),t.prototype.reset=function(){for(var t in this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new Ct,this.registry)this.registry[t].dispose(),delete this.registry[t];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null},t.nextTensorId=0,t.nextVariableId=0,t}(),St=function(){var t=function(){if(null==xt){var t=void 0;if("undefined"!=typeof window)t=window;else if("undefined"!=typeof global)t=global;else if("undefined"!=typeof process)t=process;else{if("undefined"==typeof self)throw new Error("Could not find a global object");t=self}xt=t}return xt}();if(null==t._tfengine){var e=new s(t);t._tfengine=new kt(e)}return function(t){l=t}(t._tfengine.ENV),it=function(){return t._tfengine},t._tfengine}();function Et(){return"undefined"!=typeof window&&null!=window.document||"undefined"!=typeof WorkerGlobalScope}var Ot=u();Ot.registerFlag("DEBUG",(function(){return!1}),(function(t){t&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")})),Ot.registerFlag("IS_BROWSER",(function(){return Et()})),Ot.registerFlag("IS_NODE",(function(){return"undefined"!=typeof process&&void 0!==process.versions&&void 0!==process.versions.node})),Ot.registerFlag("IS_CHROME",(function(){return"undefined"!=typeof navigator&&null!=navigator&&null!=navigator.userAgent&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor)})),Ot.registerFlag("PROD",(function(){return!1})),Ot.registerFlag("TENSORLIKE_CHECK_SHAPE_CONSISTENCY",(function(){return Ot.getBool("DEBUG")})),Ot.registerFlag("DEPRECATION_WARNINGS_ENABLED",(function(){return!0})),Ot.registerFlag("IS_TEST",(function(){return!1}));var At,Nt,Tt={},Dt={alpha:!1,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,depth:!1,stencil:!1,failIfMajorPerformanceCaveat:!0};function Rt(t,e){Tt[t]=e}function It(t){t in Tt||(Tt[t]=function(t){if(1!==t&&2!==t)throw new Error("Cannot get WebGL rendering context, WebGL is disabled.");var e=Mt(t);return e.addEventListener("webglcontextlost",(function(e){e.preventDefault(),delete Tt[t]}),!1),1===t?e.getContext("webgl",Dt)||e.getContext("experimental-webgl",Dt):e.getContext("webgl2",Dt)}(t));var e=Tt[t];return e.isContextLost()?(delete Tt[t],It(t)):(e.disable(e.DEPTH_TEST),e.disable(e.STENCIL_TEST),e.disable(e.BLEND),e.disable(e.DITHER),e.disable(e.POLYGON_OFFSET_FILL),e.disable(e.SAMPLE_COVERAGE),e.enable(e.SCISSOR_TEST),e.enable(e.CULL_FACE),e.cullFace(e.BACK),Tt[t])}function Mt(t){if("undefined"!=typeof OffscreenCanvas&&2===t)return new OffscreenCanvas(300,150);if("undefined"!=typeof document)return document.createElement("canvas");throw new Error("Cannot create a canvas in this context")}function Ft(t,e){return[e,t]}function Pt(t){var e=v(t);return _(Math.ceil(e/4))}function jt(t,e){return[Math.max(1,Math.ceil(e/2)),Math.max(1,Math.ceil(t/2))]}function zt(t,e){var n,r,i,o,a,s,l,c,h,d=t;return 2===u().getNumber("WEBGL_VERSION")?(n=d.R32F,r=d.R16F,i=d.RGBA16F,o=d.RGBA32F,a=d.RED,s=4,l=1,c=d.HALF_FLOAT,h=d.FLOAT):(n=t.RGBA,r=t.RGBA,i=t.RGBA,o=d.RGBA,a=t.RGBA,s=4,l=4,c=null!=e?e.HALF_FLOAT_OES:null,h=t.FLOAT),{internalFormatFloat:n,internalFormatHalfFloat:r,internalFormatPackedHalfFloat:i,internalFormatPackedFloat:o,textureFormatFloat:a,downloadTextureFormat:t.RGBA,downloadUnpackNumChannels:s,defaultNumChannels:l,textureTypeHalfFloat:c,textureTypeFloat:h}}function Lt(t,e,n){var r=n();return e&&function(t){var e=t.getError();if(e!==t.NO_ERROR)throw new Error("WebGL Error: "+Ut(t,e))}(t),r}function Bt(t){return!!(u().getBool("WEBGL_RENDER_FLOAT32_ENABLED")||0===t||5.96e-8<Math.abs(t)&&Math.abs(t)<65504)}function Ut(t,e){switch(e){case t.NO_ERROR:return"NO_ERROR";case t.INVALID_ENUM:return"INVALID_ENUM";case t.INVALID_VALUE:return"INVALID_VALUE";case t.INVALID_OPERATION:return"INVALID_OPERATION";case t.INVALID_FRAMEBUFFER_OPERATION:return"INVALID_FRAMEBUFFER_OPERATION";case t.OUT_OF_MEMORY:return"OUT_OF_MEMORY";case t.CONTEXT_LOST_WEBGL:return"CONTEXT_LOST_WEBGL";default:return"Unknown error code "+e}}function $t(t,e,n){return he(t,e,(function(){return t.getExtension(n)}),'Extension "'+n+'" not supported on this browser.')}function Vt(t,e,n){var r=he(t,e,(function(){return t.createShader(t.VERTEX_SHADER)}),"Unable to create vertex WebGLShader.");if(Lt(t,e,(function(){return t.shaderSource(r,n)})),Lt(t,e,(function(){return t.compileShader(r)})),!1===t.getShaderParameter(r,t.COMPILE_STATUS))throw console.log(t.getShaderInfoLog(r)),new Error("Failed to compile vertex shader.");return r}function Wt(t,e,n){var r=he(t,e,(function(){return t.createShader(t.FRAGMENT_SHADER)}),"Unable to create fragment WebGLShader.");if(Lt(t,e,(function(){return t.shaderSource(r,n)})),Lt(t,e,(function(){return t.compileShader(r)})),!1===t.getShaderParameter(r,t.COMPILE_STATUS))throw function(t,e){var n=Gt.exec(e);if(null==n)return console.log("Couldn't parse line number in error: "+e),void console.log(t);for(var r=+n[1],i=t.split("\n"),o=i.length.toString().length+2,a=i.map((function(t,e){return C((e+1).toString(),o)+t})),s=0,u=0;u<a.length;u++)s=Math.max(a[u].length,s);var l=a.slice(0,r-1),c=a.slice(r-1,r),h=a.slice(r);console.log(l.join("\n")),console.log(e.split("\n")[0]),console.log("%c "+C(c[0],s),"border:1px solid red; background-color:#e3d2d2; color:#a61717"),console.log(h.join("\n"))}(n,t.getShaderInfoLog(r)),new Error("Failed to compile fragment shader.");return r}!function(t){t[t.RENDER=0]="RENDER",t[t.UPLOAD=1]="UPLOAD",t[t.PIXELS=2]="PIXELS",t[t.DOWNLOAD=3]="DOWNLOAD"}(At||(At={})),function(t){t[t.UNPACKED_FLOAT16=0]="UNPACKED_FLOAT16",t[t.UNPACKED_FLOAT32=1]="UNPACKED_FLOAT32",t[t.PACKED_4X1_UNSIGNED_BYTE=2]="PACKED_4X1_UNSIGNED_BYTE",t[t.PACKED_2X2_FLOAT32=3]="PACKED_2X2_FLOAT32",t[t.PACKED_2X2_FLOAT16=4]="PACKED_2X2_FLOAT16"}(Nt||(Nt={}));var qt,Ht,Gt=/ERROR: [0-9]+:([0-9]+):/g;function Xt(t,e){return he(t,e,(function(){return t.createProgram()}),"Unable to create WebGLProgram.")}function Kt(t,e,n){if(Lt(t,e,(function(){return t.linkProgram(n)})),!1===t.getProgramParameter(n,t.LINK_STATUS))throw console.log(t.getProgramInfoLog(n)),new Error("Failed to link vertex and fragment shaders.")}function Yt(t,e,n){if(Lt(t,e,(function(){return t.validateProgram(n)})),!1===t.getProgramParameter(n,t.VALIDATE_STATUS))throw console.log(t.getProgramInfoLog(n)),new Error("Shader program validation failed.")}function Zt(t,e,n){var r=he(t,e,(function(){return t.createBuffer()}),"Unable to create WebGLBuffer");return Lt(t,e,(function(){return t.bindBuffer(t.ARRAY_BUFFER,r)})),Lt(t,e,(function(){return t.bufferData(t.ARRAY_BUFFER,n,t.STATIC_DRAW)})),r}function Qt(t,e,n){var r=he(t,e,(function(){return t.createBuffer()}),"Unable to create WebGLBuffer");return Lt(t,e,(function(){return t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,r)})),Lt(t,e,(function(){return t.bufferData(t.ELEMENT_ARRAY_BUFFER,n,t.STATIC_DRAW)})),r}function Jt(t,e){return he(t,e,(function(){return t.createTexture()}),"Unable to create WebGLTexture.")}function te(t,e){var n=u().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(t<=0||e<=0){var r="["+t+"x"+e+"]";throw new Error("Requested texture size "+r+" is invalid.")}if(t>n||e>n)throw r="["+t+"x"+e+"]",new Error("Requested texture size "+r+" greater than WebGL maximum on this browser / GPU ["+n+"x"+n+"].")}function ee(t,e){return he(t,e,(function(){return t.createFramebuffer()}),"Unable to create WebGLFramebuffer.")}function ne(t,e,n,r,i,o,a,s){var u=t.getAttribLocation(n,r);return-1!==u&&(Lt(t,e,(function(){return t.bindBuffer(t.ARRAY_BUFFER,i)})),Lt(t,e,(function(){return t.vertexAttribPointer(u,o,t.FLOAT,!1,a,s)})),Lt(t,e,(function(){return t.enableVertexAttribArray(u)})),!0)}function re(t,e,n,r){de(t,r),Lt(t,e,(function(){return t.activeTexture(t.TEXTURE0+r)})),Lt(t,e,(function(){return t.bindTexture(t.TEXTURE_2D,n)}))}function ie(t,e,n,r){return he(t,e,(function(){return t.getUniformLocation(n,r)}),'uniform "'+r+'" not present in program.')}function oe(t,e,n){return t.getUniformLocation(e,n)}function ae(t,e,n,r,i,o){Lt(t,e,(function(){return re(t,e,r,o)})),Lt(t,e,(function(){return t.uniform1i(i,o)}))}function se(t,e,n,r){Lt(t,e,(function(){return t.bindFramebuffer(t.FRAMEBUFFER,r)})),Lt(t,e,(function(){return t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,n,0)}))}function ue(t,e,n){Lt(t,e,(function(){return t.bindFramebuffer(t.FRAMEBUFFER,n)})),Lt(t,e,(function(){return t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,null,0)}))}function le(t){var e=t.checkFramebufferStatus(t.FRAMEBUFFER);if(e!==t.FRAMEBUFFER_COMPLETE)throw new Error("Error binding framebuffer: "+ce(t,e))}function ce(t,e){switch(e){case t.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_ATTACHMENT";case t.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT";case t.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return"FRAMEBUFFER_INCOMPLETE_DIMENSIONS";case t.FRAMEBUFFER_UNSUPPORTED:return"FRAMEBUFFER_UNSUPPORTED";default:return"unknown error "+e}}function he(t,e,n,r){var i=Lt(t,e,(function(){return n()}));if(null==i)throw new Error(r);return i}function de(t,e){var n=t.MAX_COMBINED_TEXTURE_IMAGE_UNITS-1,r=e+t.TEXTURE0;if(r<t.TEXTURE0||r>n)throw new Error("textureUnit must be in [gl.TEXTURE0, gl.TEXTURE"+n+"].")}function fe(t,e){return void 0===e&&(e=2),v(t.slice(0,t.length-e))}function pe(t){if(0===t.length)throw Error("Cannot get rows and columns of an empty shape array.");return[t.length>1?t[t.length-2]:1,t[t.length-1]]}function me(t){var e=[1,1,1];return 0===t.length||1===t.length&&1===t[0]||(e=[fe(t)].concat(pe(t))),e}function ge(t,e){var n;void 0===e&&(e=!1);var r=u().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(e&&(r*=2,1===(t=t.map((function(e,n){return n>=t.length-2?d(t[n]):t[n]}))).length&&(t=[2,t[0]])),2!==t.length){var i=O(t);t=i.newShape}var o=v(t);if(t.length<=1&&o<=r)return[1,o];if(2===t.length&&t[0]<=r&&t[1]<=r)return t;if(3===t.length&&t[0]*t[1]<=r&&t[2]<=r)return[t[0]*t[1],t[2]];if(3===t.length&&t[0]<=r&&t[1]*t[2]<=r)return[t[0],t[1]*t[2]];if(4===t.length&&t[0]*t[1]*t[2]<=r&&t[3]<=r)return[t[0]*t[1]*t[2],t[3]];if(4===t.length&&t[0]<=r&&t[1]*t[2]*t[3]<=r)return[t[0],t[1]*t[2]*t[3]];if(e){var a=fe(t),s=2,l=2;return t.length&&(s=(n=pe(t))[0],l=n[1]),_(o=a*(s/2)*(l/2)).map((function(t){return 2*t}))}return _(o)}function ye(t){return t%2==0}function ve(t,e){if(b(t=t.slice(-2),e=e.slice(-2)))return!0;if(!t.length||!e.length)return!0;if(0===t[0]||0===t[1]||0===e[0]||0===e[1])return!0;if(t.length!==e.length){var n=t.slice(-1)[0],r=e.slice(-1)[0];if(n===r)return!0;if(ye(n)&&ye(r)&&(1===t[0]||1===e[0]))return!0}return t[1]===e[1]&&ye(t[0])&&ye(e[0])}function be(t){if(null==qt){var e=It(t);qt=e.getParameter(e.MAX_TEXTURE_SIZE)}return qt}function we(t){if(null==Ht){var e=It(t);Ht=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS)}return Math.min(16,Ht)}function xe(t){if(0===t)return 0;var e=It(t);return _e(e,"EXT_disjoint_timer_query_webgl2")&&2===t?2:_e(e,"EXT_disjoint_timer_query")?1:0}function _e(t,e){return null!=t.getExtension(e)}function Ce(t){try{if(null!=It(t))return!0}catch(t){return!1}return!1}function ke(t){if(0===t)return!1;var e=It(t);if(1===t){if(!_e(e,"OES_texture_float"))return!1}else if(!_e(e,"EXT_color_buffer_float"))return!1;return Ee(e)}function Se(t){if(0===t)return!1;var e=It(t);if(1!==t){if(_e(e,"EXT_color_buffer_float"))return Ee(e);if(_e(e,"EXT_color_buffer_half_float")){var n=e.getExtension("EXT_color_buffer_half_float");return function(t,e){var n=zt(t,e),r=t.createTexture();t.bindTexture(t.TEXTURE_2D,r),t.texImage2D(t.TEXTURE_2D,0,n.internalFormatHalfFloat,1,1,0,n.textureFormatFloat,n.textureTypeHalfFloat,null);var i=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,i),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,r,0);var o=t.checkFramebufferStatus(t.FRAMEBUFFER)===t.FRAMEBUFFER_COMPLETE;return t.bindTexture(t.TEXTURE_2D,null),t.bindFramebuffer(t.FRAMEBUFFER,null),t.deleteTexture(r),t.deleteFramebuffer(i),o}(e,n)}return!1}return!!_e(e,"OES_texture_float")&&!!_e(e,"WEBGL_color_buffer_float")&&Ee(e)}function Ee(t){var e=zt(t),n=t.createTexture();t.bindTexture(t.TEXTURE_2D,n),t.texImage2D(t.TEXTURE_2D,0,e.internalFormatFloat,1,1,0,e.textureFormatFloat,e.textureTypeFloat,null);var r=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,r),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,n,0);var i=t.checkFramebufferStatus(t.FRAMEBUFFER)===t.FRAMEBUFFER_COMPLETE;return t.bindTexture(t.TEXTURE_2D,null),t.bindFramebuffer(t.FRAMEBUFFER,null),t.deleteTexture(n),t.deleteFramebuffer(r),i}function Oe(t){return 2===t&&null!=It(t).fenceSync}var Ae=Object.freeze({callAndCheck:Lt,canBeRepresented:Bt,getWebGLErrorMessage:Ut,getExtensionOrThrow:$t,createVertexShader:Vt,createFragmentShader:Wt,createProgram:Xt,linkProgram:Kt,validateProgram:Yt,createStaticVertexBuffer:Zt,createStaticIndexBuffer:Qt,getNumChannels:function(){return 2===u().getNumber("WEBGL_VERSION")?1:4},createTexture:Jt,validateTextureSize:te,createFramebuffer:ee,bindVertexBufferToProgramAttribute:ne,bindTextureUnit:re,unbindTextureUnit:function(t,e,n){de(t,n),Lt(t,e,(function(){return t.activeTexture(t.TEXTURE0+n)})),Lt(t,e,(function(){return t.bindTexture(t.TEXTURE_2D,null)}))},getProgramUniformLocationOrThrow:ie,getProgramUniformLocation:oe,bindTextureToProgramUniformSampler:ae,bindCanvasToFramebuffer:function(t,e){Lt(t,e,(function(){return t.bindFramebuffer(t.FRAMEBUFFER,null)})),Lt(t,e,(function(){return t.viewport(0,0,t.canvas.width,t.canvas.height)})),Lt(t,e,(function(){return t.scissor(0,0,t.canvas.width,t.canvas.height)}))},bindColorTextureToFramebuffer:se,unbindColorTextureFromFramebuffer:ue,validateFramebuffer:le,getFramebufferErrorMessage:ce,getBatchDim:fe,getRowsCols:pe,getShapeAs3D:me,getTextureShapeFromLogicalShape:ge,isReshapeFree:ve,getWebGLMaxTextureSize:be,resetMaxTextureSize:function(){qt=null},resetMaxTexturesInShader:function(){Ht=null},getMaxTexturesInShader:we,getWebGLDisjointQueryTimerVersion:xe,hasExtension:_e,isWebGLVersionEnabled:Ce,isCapableOfRenderingToFloatTexture:ke,isDownloadFloatTextureEnabled:Se,isWebGLFenceEnabled:Oe}),Ne=u();function Te(){u().set("PROD",!0)}function De(){u().set("DEBUG",!0)}function Re(){u().set("DEPRECATION_WARNINGS_ENABLED",!1),console.warn("TensorFlow.js deprecation warnings have been disabled.")}function Ie(t){u().getBool("DEPRECATION_WARNINGS_ENABLED")&&console.warn(t+" You can disable deprecation warnings with tf.disableDeprecationWarnings().")}function Me(){St.disposeVariables()}function Fe(){return St}function Pe(){return St.memory()}function je(t){return St.profile(t)}function ze(t,e){return St.tidy(t,e)}function Le(t){wt(t).forEach((function(t){return t.dispose()}))}function Be(t){return St.keep(t)}function Ue(t){return St.time(t)}function $e(t){return St.setBackend(t)}function Ve(){return St.ready()}function We(){return St.backendName}function qe(t){St.removeBackend(t)}function He(t){return St.findBackend(t)}function Ge(t){return St.findBackendFactory(t)}function Xe(t,e,n){return void 0===n&&(n=1),St.registerBackend(t,e,n)}function Ke(){return St.backend}function Ye(t,e){u().setPlatform(t,e)}function Ze(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];u().getBool("IS_TEST")||console.warn.apply(console,t)}function Qe(t,e){var n=t;if(I(t))return"string"===e?[]:[t.length];if(!Array.isArray(t))return[];for(var r=[];Array.isArray(n)||I(n)&&"string"!==e;)r.push(n.length),n=n[0];return Array.isArray(t)&&u().getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&function t(e,n,r){if(r=r||[],Array.isArray(e)||I(e)){p(n.length>0,(function(){return"Element arr["+r.join("][")+"] should be a primitive, but is an array of "+e.length+" elements"})),p(e.length===n[0],(function(){return"Element arr["+r.join("][")+"] should have "+n[0]+" elements, but has "+e.length+" elements"}));for(var i=n.slice(1),o=0;o<e.length;++o)t(e[o],i,r.concat(o))}else p(0===n.length,(function(){return"Element arr["+r.join("][")+"] is a primitive, but should be an array/TypedArray of "+n[0]+" elements"}))}(t,r,[]),r}function Je(t,e,n,r){if(null!=t&&("numeric"!==t&&t!==e||"numeric"===t&&"string"===e))throw new Error("Argument '"+n+"' passed to '"+r+"' must be "+t+" tensor, but got "+e+" tensor")}function tn(t,e,n,r){if(void 0===r&&(r="numeric"),t instanceof st)return Je(r,t.dtype,e,n),t;var i=L(t);if("string"!==i&&["bool","int32","float32"].indexOf(r)>=0&&(i=r),Je(r,i,e,n),null==t||!I(t)&&!Array.isArray(t)&&"number"!=typeof t&&"boolean"!=typeof t&&"string"!=typeof t)throw new Error("Argument '"+e+"' passed to '"+n+"' must be a Tensor or TensorLike, but got '"+(null==t?"null":t.constructor.name)+"'");var o=Qe(t,i);I(t)||Array.isArray(t)||(t=[t]);var a="string"!==i?V(t,i,u().getBool("DEBUG")):y(t,[],!0);return st.make(o,{values:a},i)}function en(t,e,n,r){if(void 0===r&&(r="numeric"),!Array.isArray(t))throw new Error("Argument "+e+" passed to "+n+" must be a `Tensor[]` or `TensorLike[]`");return t.map((function(t,r){return tn(t,e+"["+r+"]",n)}),r)}function nn(t,e){for(var n=0;n<t.length;++n)if(t[t.length-n-1]!==e-1-n)return!1;return!0}function rn(t,e,n){for(var r=t.length+e.length,i=[],o=0,a=0,s=0;s<r;s++)-1===n.indexOf(s)?i.push(t[o++]):i.push(e[a++]);return i}function on(t,e){for(var n=[],r=t.length,i=0;i<r;i++)-1===e.indexOf(i)&&n.push(t[i]);return[n,e.map((function(e){return t[e]}))]}function an(t,e){return rn(t,e.map((function(t){return 1})),e)}function sn(t,e,n){p(nn(e,n),(function(){return t+" supports only inner-most axes for now. Got axes "+e+" and rank-"+n+" input."}))}function un(t,e){if(nn(t,e))return null;for(var n=[],r=0;r<e;++r)-1===t.indexOf(r)&&n.push(r);return t.forEach((function(t){return n.push(t)})),n}function ln(t){return t.map((function(t,e){return[e,t]})).sort((function(t,e){return t[1]-e[1]})).map((function(t){return t[0]}))}function cn(t,e){for(var n=[],r=e-t;r<e;++r)n.push(r);return n}function hn(t,e){var n=t[0].length;t.forEach((function(t,e){p(t.length===n,(function(){return"Error in concat"+n+"D: rank of tensors["+e+"] must be the same as the rank of the rest ("+n+")"}))})),p(e>=0&&e<n,(function(){return"Error in concat"+n+"D: axis must be between 0 and "+(n-1)+"."}));var r=t[0];t.forEach((function(t,i){for(var o=0;o<n;o++)p(o===e||t[o]===r[o],(function(){return"Error in concat"+n+"D: Shape of tensors["+i+"] ("+t+") does not match the shape of the rest ("+r+") along the non-concatenated axis "+i+"."}))}))}function dn(t,e){for(var n=t[0].slice(),r=1;r<t.length;r++)n[e]+=t[r][e];return n}function fn(t){var e=Object.keys(t);if(1!==e.length)throw new Error("Please provide an object with a single key (operation name) mapping to a function. Got an object with "+e.length+" keys.");var n=e[0],r=t[n];n.endsWith("_")&&(n=n.substring(0,n.length-1));var i=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];St.startScope(n);try{var i=r.apply(void 0,t);return i instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),St.endScope(i),i}catch(t){throw St.endScope(null),t}};return Object.defineProperty(i,"name",{value:n,configurable:!0}),i}Ne.registerFlag("HAS_WEBGL",(function(){return Ne.getNumber("WEBGL_VERSION")>0})),Ne.registerFlag("WEBGL_VERSION",(function(){return Ce(2)?2:Ce(1)?1:0})),Ne.registerFlag("WEBGL_BUFFER_SUPPORTED",(function(){return 2===Ne.get("WEBGL_VERSION")})),Ne.registerFlag("WEBGL_CPU_FORWARD",(function(){return!0})),Ne.registerFlag("WEBGL_FORCE_F16_TEXTURES",(function(){return!1})),Ne.registerFlag("WEBGL_PACK",(function(){return Ne.getBool("HAS_WEBGL")})),Ne.registerFlag("WEBGL_PACK_NORMALIZATION",(function(){return Ne.getBool("WEBGL_PACK")})),Ne.registerFlag("WEBGL_PACK_CLIP",(function(){return Ne.getBool("WEBGL_PACK")})),Ne.registerFlag("WEBGL_PACK_DEPTHWISECONV",(function(){return!1})),Ne.registerFlag("WEBGL_PACK_BINARY_OPERATIONS",(function(){return Ne.getBool("WEBGL_PACK")})),Ne.registerFlag("WEBGL_PACK_UNARY_OPERATIONS",(function(){return Ne.getBool("WEBGL_PACK")})),Ne.registerFlag("WEBGL_PACK_ARRAY_OPERATIONS",(function(){return Ne.getBool("WEBGL_PACK")})),Ne.registerFlag("WEBGL_PACK_IMAGE_OPERATIONS",(function(){return Ne.getBool("WEBGL_PACK")})),Ne.registerFlag("WEBGL_PACK_REDUCE",(function(){return Ne.getBool("WEBGL_PACK")})),Ne.registerFlag("WEBGL_LAZILY_UNPACK",(function(){return Ne.getBool("WEBGL_PACK")})),Ne.registerFlag("WEBGL_CONV_IM2COL",(function(){return Ne.getBool("WEBGL_PACK")})),Ne.registerFlag("WEBGL_MAX_TEXTURE_SIZE",(function(){return be(Ne.getNumber("WEBGL_VERSION"))})),Ne.registerFlag("WEBGL_MAX_TEXTURES_IN_SHADER",(function(){return we(Ne.getNumber("WEBGL_VERSION"))})),Ne.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION",(function(){var t=Ne.getNumber("WEBGL_VERSION");return 0===t?0:xe(t)})),Ne.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE",(function(){return Ne.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0&&(t=navigator.userAgent||navigator.vendor||window.opera,!(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(t)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(t.substr(0,4))));var t})),Ne.registerFlag("WEBGL_RENDER_FLOAT32_CAPABLE",(function(){return ke(Ne.getNumber("WEBGL_VERSION"))})),Ne.registerFlag("WEBGL_RENDER_FLOAT32_ENABLED",(function(){return!Ne.getBool("WEBGL_FORCE_F16_TEXTURES")&&Ne.getBool("WEBGL_RENDER_FLOAT32_CAPABLE")})),Ne.registerFlag("WEBGL_DOWNLOAD_FLOAT_ENABLED",(function(){return Se(Ne.getNumber("WEBGL_VERSION"))})),Ne.registerFlag("WEBGL_FENCE_API_ENABLED",(function(){return Oe(Ne.getNumber("WEBGL_VERSION"))})),Ne.registerFlag("WEBGL_SIZE_UPLOAD_UNIFORM",(function(){return Ne.getBool("WEBGL_RENDER_FLOAT32_ENABLED")?4:0})),at=Ie;var pn=fn({complex_:function(t,e){var n=tn(t,"real","complex"),r=tn(e,"imag","complex");return m(n.shape,r.shape,"real and imag shapes, "+n.shape+" and "+r.shape+", must match in call to tf.complex()."),St.runKernel((function(t){return t.complex(n,r)}),{$real:n,$imag:r})}}),mn=fn({real_:function(t){var e=tn(t,"input","real");return St.runKernel((function(t){return t.real(e)}),{$input:e})}}),gn=fn({imag_:function(t){var e=tn(t,"input","imag");return St.runKernel((function(t){return t.imag(e)}),{$input:e})}});function yn(t,e,n){return vn(t,e,Qe(t,n),n)}function vn(t,e,n,r){if(null==r&&(r=L(t)),"complex64"===r)throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if(!I(t)&&!Array.isArray(t)&&"number"!=typeof t&&"boolean"!=typeof t&&"string"!=typeof t)throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(null!=e){X(e);var i=v(e),o=v(n);p(i===o,(function(){return"Based on the provided shape, ["+e+"], the tensor should have "+i+" values but has "+o}));for(var a=0;a<n.length;++a){var s=a!==n.length-1||n[a]!==v(e.slice(a));p(n[a]===e[a]||!s,(function(){return"Error creating a new Tensor. Inferred shape ("+n+") does not match the provided shape ("+e+"). "}))}}return I(t)||Array.isArray(t)||(t=[t]),e=e||n,t="string"!==r?V(t,r,u().getBool("DEBUG")):y(t,[],!0),st.make(e,{values:t},r)}function bn(t,e){if((I(t)&&"string"!==e||Array.isArray(t))&&"complex64"!==e)throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if("string"===e&&I(t)&&!(t instanceof Uint8Array))throw new Error("When making a scalar from encoded string, the value must be `Uint8Array`.");return vn(t,[],[],e)}function wn(t,e){g(t);var n=Qe(t,e);if(1!==n.length)throw new Error("tensor1d() requires values to be a flat/TypedArray");return vn(t,null,n,e)}function xn(t,e,n){if(g(t),null!=e&&2!==e.length)throw new Error("tensor2d() requires shape to have two numbers");var r=Qe(t,n);if(2!==r.length&&1!==r.length)throw new Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(1===r.length&&null==e)throw new Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return vn(t,e,r,n)}function _n(t,e,n){if(g(t),null!=e&&3!==e.length)throw new Error("tensor3d() requires shape to have three numbers");var r=Qe(t,n);if(3!==r.length&&1!==r.length)throw new Error("tensor3d() requires values to be number[][][] or flat/TypedArray");if(1===r.length&&null==e)throw new Error("tensor3d() requires shape to be provided when `values` are a flat array");return vn(t,e,r,n)}function Cn(t,e,n){if(g(t),null!=e&&4!==e.length)throw new Error("tensor4d() requires shape to have four numbers");var r=Qe(t,n);if(4!==r.length&&1!==r.length)throw new Error("tensor4d() requires values to be number[][][][] or flat/TypedArray");if(1===r.length&&null==e)throw new Error("tensor4d() requires shape to be provided when `values` are a flat array");return vn(t,e,r,n)}function kn(t,e,n){if(g(t),null!=e&&5!==e.length)throw new Error("tensor5d() requires shape to have five numbers");var r=Qe(t,n);if(5!==r.length&&1!==r.length)throw new Error("tensor5d() requires values to be number[][][][][] or flat/TypedArray");if(1===r.length&&null==e)throw new Error("tensor5d() requires shape to be provided when `values` are a flat array");return vn(t,e,r,n)}function Sn(t,e,n){if(g(t),null!=e&&6!==e.length)throw new Error("tensor6d() requires shape to have six numbers");var r=Qe(t,n);if(6!==r.length&&1!==r.length)throw new Error("tensor6d() requires values to be number[][][][][][] or flat/TypedArray");if(1===r.length&&null==e)throw new Error("tensor6d() requires shape to be provided when `values` are a flat array");return vn(t,e=e||r,r,n)}function En(t,e){if(void 0===e&&(e="float32"),"complex64"===e){var n=En(t,"float32"),r=On(t,"float32");return pn(n,r)}var i=q(v(t),e);return st.make(t,{values:i},e)}function On(t,e){if(void 0===e&&(e="float32"),"complex64"===e){var n=On(t,"float32"),r=On(t,"float32");return pn(n,r)}var i=H(v(t),e);return st.make(t,{values:i},e)}function An(t,e,n){return St.runKernel((function(r){return r.fill(t,e,n)}),{})}function Nn(t,e,n){if(n<=0)throw new Error("The number of values should be positive.");return St.runKernel((function(r){return r.linspace(t,e,n)}),{})}function Tn(t,e,n,r){if(void 0===n&&(n=1),void 0===r&&(r="float32"),0===n)throw new Error("Cannot have a step of zero");if(t===e||t<e&&n<0||e<t&&n>1)return On([0],r);var i=H(Math.abs(Math.ceil((e-t)/n)),r);e<t&&1===n&&(n=-1),i[0]=t;for(var o=1;o<i.length;o++)i[o]=i[o-1]+n;return wn(i,r)}var Dn=fn({onesLike_:function(t){var e=tn(t,"x","onesLike");if("complex64"===e.dtype){var n=Dn(mn(e)),r=Rn(gn(e));return pn(n,r)}return St.runKernel((function(t){return t.onesLike(e)}),{$x:e},(function(t,e){return{$x:function(){return Rn(t)}}}))}}),Rn=fn({zerosLike_:function(t){var e=tn(t,"x","zerosLike");return St.runKernel((function(t){return t.zerosLike(e)}),{$x:e},(function(t,e){return{$x:function(){return Rn(t)}}}))}}),In=fn({concat_:function(t,e){void 0===e&&(e=0),p(t.length>=1,(function(){return"Pass at least one tensor to concat"}));var n=en(t,"tensors","concat");"complex64"===n[0].dtype&&n.forEach((function(t){if("complex64"!==t.dtype)throw new Error("Cannot concatenate complex64 tensors with a tensor\n          with dtype "+t.dtype+". ")})),e=E(e,n[0].shape)[0];var r=dn(n.map((function(t){return t.shape})),e);if(0===v(r))return yn([],r);if(1===(n=n.filter((function(t){return t.size>0}))).length)return n[0];var i=n.map((function(t){return t.shape}));return hn(i,e),St.runKernel((function(t){return t.concat(n,e)}),n,(function(t){var n=i.map((function(t){return t[e]}));return zn(t,n,e).map((function(t){return function(){return t}}))}))}}),Mn=fn({concat1d_:function(t){return In(t,0)}}),Fn=fn({concat2d_:function(t,e){return In(t,e)}}),Pn=fn({concat3d_:function(t,e){return In(t,e)}}),jn=fn({concat4d_:function(t,e){return In(t,e)}}),zn=fn({split_:function(t,e,n){void 0===n&&(n=0);var r,i=tn(t,"x","split");return n=E(n,i.shape)[0],"number"==typeof e?(p(i.shape[n]%e==0,(function(){return"Number of splits must evenly divide the axis."})),r=new Array(e).fill(i.shape[n]/e)):(p(i.shape[n]===e.reduce((function(t,e){return t+e})),(function(){return"The sum of sizes must match the size of the axis dimension."})),r=e),St.runKernel((function(t){return t.split(i,r,n)}),{$x:i},(function(t){return{$x:function(){return In(t,n)}}}))}});function Ln(t,e){return t(e={exports:{}},e.exports),e.exports}"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self&&self;var Bn=Ln((function(t){!function(t,e,n){function r(t){var e,n=this,r=(e=4022871197,function(t){t=t.toString();for(var n=0;n<t.length;n++){var r=.02519603282416938*(e+=t.charCodeAt(n));r-=e=r>>>0,e=(r*=e)>>>0,e+=4294967296*(r-=e)}return 2.3283064365386963e-10*(e>>>0)});n.next=function(){var t=2091639*n.s0+2.3283064365386963e-10*n.c;return n.s0=n.s1,n.s1=n.s2,n.s2=t-(n.c=0|t)},n.c=1,n.s0=r(" "),n.s1=r(" "),n.s2=r(" "),n.s0-=r(t),n.s0<0&&(n.s0+=1),n.s1-=r(t),n.s1<0&&(n.s1+=1),n.s2-=r(t),n.s2<0&&(n.s2+=1),r=null}function i(t,e){return e.c=t.c,e.s0=t.s0,e.s1=t.s1,e.s2=t.s2,e}function o(t,e){var n=new r(t),o=e&&e.state,a=n.next;return a.int32=function(){return 4294967296*n.next()|0},a.double=function(){return a()+11102230246251565e-32*(2097152*a()|0)},a.quick=a,o&&("object"==typeof o&&i(o,n),a.state=function(){return i(n,{})}),a}e&&e.exports?e.exports=o:this.alea=o}(0,t)})),Un=Ln((function(t){!function(t,e,n){function r(t){var e=this,n="";e.x=0,e.y=0,e.z=0,e.w=0,e.next=function(){var t=e.x^e.x<<11;return e.x=e.y,e.y=e.z,e.z=e.w,e.w^=e.w>>>19^t^t>>>8},t===(0|t)?e.x=t:n+=t;for(var r=0;r<n.length+64;r++)e.x^=0|n.charCodeAt(r),e.next()}function i(t,e){return e.x=t.x,e.y=t.y,e.z=t.z,e.w=t.w,e}function o(t,e){var n=new r(t),o=e&&e.state,a=function(){return(n.next()>>>0)/4294967296};return a.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},a.int32=n.next,a.quick=a,o&&("object"==typeof o&&i(o,n),a.state=function(){return i(n,{})}),a}e&&e.exports?e.exports=o:this.xor128=o}(0,t)})),$n=Ln((function(t){!function(t,e,n){function r(t){var e=this,n="";e.next=function(){var t=e.x^e.x>>>2;return e.x=e.y,e.y=e.z,e.z=e.w,e.w=e.v,(e.d=e.d+362437|0)+(e.v=e.v^e.v<<4^t^t<<1)|0},e.x=0,e.y=0,e.z=0,e.w=0,e.v=0,t===(0|t)?e.x=t:n+=t;for(var r=0;r<n.length+64;r++)e.x^=0|n.charCodeAt(r),r==n.length&&(e.d=e.x<<10^e.x>>>4),e.next()}function i(t,e){return e.x=t.x,e.y=t.y,e.z=t.z,e.w=t.w,e.v=t.v,e.d=t.d,e}function o(t,e){var n=new r(t),o=e&&e.state,a=function(){return(n.next()>>>0)/4294967296};return a.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},a.int32=n.next,a.quick=a,o&&("object"==typeof o&&i(o,n),a.state=function(){return i(n,{})}),a}e&&e.exports?e.exports=o:this.xorwow=o}(0,t)})),Vn=Ln((function(t){!function(t,e,n){function r(t){var e=this;e.next=function(){var t,n,r=e.x,i=e.i;return t=r[i],n=(t^=t>>>7)^t<<24,n^=(t=r[i+1&7])^t>>>10,n^=(t=r[i+3&7])^t>>>3,n^=(t=r[i+4&7])^t<<7,t=r[i+7&7],n^=(t^=t<<13)^t<<9,r[i]=n,e.i=i+1&7,n},function(t,e){var n,r=[];if(e===(0|e))r[0]=e;else for(e=""+e,n=0;n<e.length;++n)r[7&n]=r[7&n]<<15^e.charCodeAt(n)+r[n+1&7]<<13;for(;r.length<8;)r.push(0);for(n=0;n<8&&0===r[n];++n);for(8==n&&(r[7]=-1),t.x=r,t.i=0,n=256;n>0;--n)t.next()}(e,t)}function i(t,e){return e.x=t.x.slice(),e.i=t.i,e}function o(t,e){null==t&&(t=+new Date);var n=new r(t),o=e&&e.state,a=function(){return(n.next()>>>0)/4294967296};return a.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},a.int32=n.next,a.quick=a,o&&(o.x&&i(o,n),a.state=function(){return i(n,{})}),a}e&&e.exports?e.exports=o:this.xorshift7=o}(0,t)})),Wn=Ln((function(t){!function(t,e,n){function r(t){var e=this;e.next=function(){var t,n,r=e.w,i=e.X,o=e.i;return e.w=r=r+1640531527|0,n=i[o+34&127],t=i[o=o+1&127],n^=n<<13,t^=t<<17,n=i[o]=(n^=n>>>15)^(t^=t>>>12),e.i=o,n+(r^r>>>16)|0},function(t,e){var n,r,i,o,a,s=[],u=128;for(e===(0|e)?(r=e,e=null):(e+="\0",r=0,u=Math.max(u,e.length)),i=0,o=-32;o<u;++o)e&&(r^=e.charCodeAt((o+32)%e.length)),0===o&&(a=r),r^=r<<10,r^=r>>>15,r^=r<<4,r^=r>>>13,o>=0&&(i=0==(n=s[127&o]^=r+(a=a+1640531527|0))?i+1:0);for(i>=128&&(s[127&(e&&e.length||0)]=-1),i=127,o=512;o>0;--o)r=s[i+34&127],n=s[i=i+1&127],r^=r<<13,n^=n<<17,s[i]=(r^=r>>>15)^(n^=n>>>12);t.w=a,t.X=s,t.i=i}(e,t)}function i(t,e){return e.i=t.i,e.w=t.w,e.X=t.X.slice(),e}function o(t,e){null==t&&(t=+new Date);var n=new r(t),o=e&&e.state,a=function(){return(n.next()>>>0)/4294967296};return a.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},a.int32=n.next,a.quick=a,o&&(o.X&&i(o,n),a.state=function(){return i(n,{})}),a}e&&e.exports?e.exports=o:this.xor4096=o}(0,t)})),qn=Ln((function(t){!function(t,e,n){function r(t){var e=this,n="";e.next=function(){var t=e.b,n=e.c,r=e.d,i=e.a;return t=t<<25^t>>>7^n,n=n-r|0,r=r<<24^r>>>8^i,i=i-t|0,e.b=t=t<<20^t>>>12^n,e.c=n=n-r|0,e.d=r<<16^n>>>16^i,e.a=i-t|0},e.a=0,e.b=0,e.c=-1640531527,e.d=1367130551,t===Math.floor(t)?(e.a=t/4294967296|0,e.b=0|t):n+=t;for(var r=0;r<n.length+20;r++)e.b^=0|n.charCodeAt(r),e.next()}function i(t,e){return e.a=t.a,e.b=t.b,e.c=t.c,e.d=t.d,e}function o(t,e){var n=new r(t),o=e&&e.state,a=function(){return(n.next()>>>0)/4294967296};return a.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},a.int32=n.next,a.quick=a,o&&("object"==typeof o&&i(o,n),a.state=function(){return i(n,{})}),a}e&&e.exports?e.exports=o:this.tychei=o}(0,t)})),Hn=Ln((function(t){!function(e,r){var i,o=this,a=256,s=r.pow(a,6),u=r.pow(2,52),l=2*u,c=255;function h(t,n,c){var h=[],g=p(function t(e,n){var r,i=[],o=typeof e;if(n&&"object"==o)for(r in e)try{i.push(t(e[r],n-1))}catch(t){}return i.length?i:"string"==o?e:e+"\0"}((n=1==n?{entropy:!0}:n||{}).entropy?[t,m(e)]:null==t?function(){try{var t;return i&&(t=i.randomBytes)?t=t(a):(t=new Uint8Array(a),(o.crypto||o.msCrypto).getRandomValues(t)),m(t)}catch(t){var n=o.navigator,r=n&&n.plugins;return[+new Date,o,r,o.screen,m(e)]}}():t,3),h),y=new d(h),v=function(){for(var t=y.g(6),e=s,n=0;t<u;)t=(t+n)*a,e*=a,n=y.g(1);for(;t>=l;)t/=2,e/=2,n>>>=1;return(t+n)/e};return v.int32=function(){return 0|y.g(4)},v.quick=function(){return y.g(4)/4294967296},v.double=v,p(m(y.S),e),(n.pass||c||function(t,e,n,i){return i&&(i.S&&f(i,y),t.state=function(){return f(y,{})}),n?(r.random=t,e):t})(v,g,"global"in n?n.global:this==r,n.state)}function d(t){var e,n=t.length,r=this,i=0,o=r.i=r.j=0,s=r.S=[];for(n||(t=[n++]);i<a;)s[i]=i++;for(i=0;i<a;i++)s[i]=s[o=c&o+t[i%n]+(e=s[i])],s[o]=e;(r.g=function(t){for(var e,n=0,i=r.i,o=r.j,s=r.S;t--;)e=s[i=c&i+1],n=n*a+s[c&(s[i]=s[o=c&o+e])+(s[o]=e)];return r.i=i,r.j=o,n})(a)}function f(t,e){return e.i=t.i,e.j=t.j,e.S=t.S.slice(),e}function p(t,e){for(var n,r=t+"",i=0;i<r.length;)e[c&i]=c&(n^=19*e[c&i])+r.charCodeAt(i++);return m(e)}function m(t){return String.fromCharCode.apply(0,t)}if(r.seedrandom=h,p(r.random(),e),t.exports){t.exports=h;try{i=n(1)}catch(t){}}}([],Math)}));Hn.alea=Bn,Hn.xor128=Un,Hn.xorwow=$n,Hn.xorshift7=Vn,Hn.xor4096=Wn,Hn.tychei=qn;var Gn=Hn.alea,Xn=function(){function t(t,e,n,r,i){this.mean=t,this.stdDev=e,this.dtype=n,this.nextVal=NaN,this.truncated=r,this.truncated&&(this.upper=this.mean+2*this.stdDev,this.lower=this.mean-2*this.stdDev);var o=i||Math.random();this.random=Gn(o.toString())}return t.prototype.nextValue=function(){if(!isNaN(this.nextVal)){var t=this.nextVal;return this.nextVal=NaN,t}for(var e,n,r=!1;!r;){var i=void 0,o=void 0,a=void 0;do{a=(i=2*this.random()-1)*i+(o=2*this.random()-1)*o}while(a>=1||0===a);var s=Math.sqrt(-2*Math.log(a)/a);e=this.mean+this.stdDev*i*s,n=this.mean+this.stdDev*o*s,this.truncated&&!this.isValidTruncated(e)||(r=!0)}return this.truncated&&!this.isValidTruncated(n)||(this.nextVal=this.convertValue(n)),this.convertValue(e)},t.prototype.convertValue=function(t){return null==this.dtype||"float32"===this.dtype?t:Math.round(t)},t.prototype.isValidTruncated=function(t){return t<=this.upper&&t>=this.lower},t}(),Kn=function(){function t(t,e,n,r){this.alpha=t,this.beta=1/e,this.dtype=n;var i=r||Math.random();this.randu=Gn(i.toString()),this.randn=new Xn(0,1,n,!1,this.randu()),this.d=t<1?t+2/3:t-1/3,this.c=1/Math.sqrt(9*this.d)}return t.prototype.nextValue=function(){for(var t,e,n,r,i,o;;){do{r=this.randn.nextValue(),o=1+this.c*r}while(o<=0);if(e=1-.331*(t=r*r)*t,n=.5*t+this.d*(1-(o*=o*o)+Math.log(o)),(i=this.randu())<e||Math.log(i)<n)break}return o*=1/this.beta*this.d,this.alpha<1&&(o*=Math.pow(this.randu(),1/this.alpha)),this.convertValue(o)},t.prototype.convertValue=function(t){return"float32"===this.dtype?t:Math.round(t)},t}(),Yn=function(){function t(t,e,n,r){var i=this;if(void 0===t&&(t=0),void 0===e&&(e=1),this.canReturnFloat=function(){return null==i.dtype||"float32"===i.dtype},this.min=t,this.range=e-t,this.dtype=n,null==r&&(r=Math.random()),"number"==typeof r&&(r=r.toString()),!this.canReturnFloat()&&this.range<=1)throw new Error("The difference between "+t+" - "+e+" <= 1 and dtype is not float");this.random=Gn(r)}return t.prototype.convertValue=function(t){return this.canReturnFloat()?t:Math.round(t)},t.prototype.nextValue=function(){return this.convertValue(this.min+this.range*this.random())},t}();function Zn(t,e,n){return void 0===e&&(e="float32"),e=e||"float32",X(t),new rt(t,e,n)}function Qn(t,e){void 0===e&&(e=!1),console.log(t.toString(e))}var Jn=fn({batchToSpaceND_:function(t,e,n){var r=tn(t,"x","batchToSpaceND"),i=e.reduce((function(t,e){return t*e}));return p(r.rank>=1+e.length,(function(){return"input rank is "+r.rank+" but should be > than blockShape.length "+e.length})),p(n.length===e.length,(function(){return"crops.length is "+n.length+" but should be equal to blockShape.length  "+e.length})),p(r.shape[0]%i==0,(function(){return"input tensor batch is "+r.shape[0]+" but is not divisible by the product of the elements of blockShape "+e.join(" * ")+" === "+i})),St.runKernel((function(t){return t.batchToSpaceND(r,e,n)}),{$x:r},(function(t){return{$x:function(){return t.spaceToBatchND(e,n)}}}))}}),tr=fn({cast_:function(t,e){var n=tn(t,"x","cast");if(!D(e))throw new Error("Failed to cast to unknown dtype "+e);if("string"===e&&"string"!==n.dtype||"string"!==e&&"string"===n.dtype)throw new Error("Only strings can be casted to strings");return St.runKernel((function(t){return t.cast(n,e)}),{$x:n},(function(t){return{$x:function(){return t.clone()}}}))}}),er=fn({clone_:function(t){var e=tn(t,"x","clone",null);return St.runKernel((function(t){return st.make(e.shape,{dataId:e.dataId},e.dtype)}),{$x:e},(function(t){return{$x:function(){return t.toFloat()}}}))}}),nr=fn({cumsum_:function(t,e,n,r){void 0===e&&(e=0),void 0===n&&(n=!1),void 0===r&&(r=!1);var i=tn(t,"x","cumsum"),o=un([e|=0],i.rank),a=i;null!=o&&(a=i.transpose(o));var s=cn(1,i.rank)[0],u=St.runKernel((function(t){return t.cumsum(a,s,n,r)}),{permutedX:a},(function(t){return{permutedX:function(){return t.cumsum(e,n,!r)}}}));return null!=o&&(u=u.transpose(o)),u}}),rr=fn({depthToSpace_:function(t,e,n){void 0===n&&(n="NHWC");var r=tn(t,"x","depthToSpace"),i="NHWC"===n?r.shape[1]:r.shape[2],o="NHWC"===n?r.shape[2]:r.shape[3],a="NHWC"===n?r.shape[3]:r.shape[1];return p(i*e>=0,(function(){return"Negative dimension size caused by overflow when multiplying\n      "+i+" and "+e+"  for depthToSpace with input shape\n      "+r.shape})),p(o*e>=0,(function(){return"Negative dimension size caused by overflow when multiplying\n      "+o+" and "+e+" for depthToSpace with input shape\n          "+r.shape})),p(a%(e*e)==0,(function(){return"Dimension size must be evenly divisible by "+e*e+" but is "+a+" for depthToSpace with input shape "+r.shape})),St.runKernel((function(t){return t.depthToSpace(r,e,n)}),{$x:r})}}),ir=fn({expandDims_:function(t,e){void 0===e&&(e=0);var n=tn(t,"x","expandDims",null);p(e<=n.rank,(function(){return"Axis must be <= rank of the tensor"}));var r=n.shape.slice();return e<0&&(p(-(n.rank+1)<=e,(function(){return"Axis must be in the interval ["+-(n.rank+1)+", "+n.rank+"]"})),e=n.rank+e+1),r.splice(e,0,1),yr(n,r)}}),or=fn({eye_:function(t,e,n,r){void 0===r&&(r="float32"),null==e&&(e=t);for(var i=Zn([t,e],r),o=t<=e?t:e,a=0;a<o;++a)i.set(1,a,a);var s=i.toTensor().as2D(t,e);if(null==n)return s;if(1===n.length)return xr(ir(s,0),[n[0],1,1]);if(2===n.length)return xr(ir(ir(s,0),0),[n[0],n[1],1,1]);if(3===n.length)return xr(ir(ir(ir(s,0),0),0),[n[0],n[1],n[2],1,1]);throw new Error("eye() currently supports only 1D and 2D batchShapes, but received "+n.length+"D.")}}),ar=fn({multinomial_:function(t,e,n,r){void 0===r&&(r=!1);var i=tn(t,"logits","multinomial"),o=i.size,a=i.rank;if(o<2)throw new Error("Error in multinomial: you need at least 2 outcomes, but got "+o+".");if(a>2)throw new Error("Rank of probabilities must be 1 or 2, but is "+a);n=n||Math.random();var s=1===a?i.as2D(1,-1):i,u=St.runKernel((function(t){return t.multinomial(s,r,e,n)}),{logits2D:s});return 1===a?u.as1D():u}}),sr=fn({oneHot_:function(t,e,n,r){if(void 0===n&&(n=1),void 0===r&&(r=0),e<2)throw new Error("Error in oneHot: depth must be >=2, but it is "+e);var i=tn(t,"indices","oneHot","int32"),o=i.shape.concat([e]);return i=i.flatten(),St.runKernel((function(t){return t.oneHot(i,e,n,r)}),{$indices:i},(function(t){return{$indices:function(){return On(i.shape,"float32")}}})).reshape(o)}}),ur=fn({pad_:function(t,e,n){void 0===n&&(n=0);var r=tn(t,"x","pad");if(0===r.rank)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");var i=e.map((function(t){return t[0]}));return St.runKernel((function(t){return t.pad(r,e,n)}),{$x:r},(function(t){return{$x:function(){return t.slice(i,r.shape)}}}))}}),lr=fn({pad1d_:function(t,e,n){return void 0===n&&(n=0),p(2===e.length,(function(){return"Invalid number of paddings. Must be length of 2."})),ur(t,[e],n)}}),cr=fn({pad2d_:function(t,e,n){return void 0===n&&(n=0),p(2===e.length&&2===e[0].length&&2===e[1].length,(function(){return"Invalid number of paddings. Must be length of 2 each."})),ur(t,e,n)}}),hr=fn({pad3d_:function(t,e,n){return void 0===n&&(n=0),p(3===e.length&&2===e[0].length&&2===e[1].length&&2===e[2].length,(function(){return"Invalid number of paddings. Must be length of 2 each."})),ur(t,e,n)}}),dr=fn({pad4d_:function(t,e,n){return void 0===n&&(n=0),p(4===e.length&&2===e[0].length&&2===e[1].length&&2===e[2].length&&2===e[3].length,(function(){return"Invalid number of paddings. Must be length of 2 each."})),ur(t,e,n)}}),fr=fn({rand_:function(t,e,n){var r=v(t),i=null;if(null==n||"float32"===n)i=new Float32Array(r);else if("int32"===n)i=new Int32Array(r);else{if("bool"!==n)throw new Error("Unknown data type "+n);i=new Uint8Array(r)}for(var o=0;o<r;o++)i[o]=e();return st.make(t,{values:i},n)}}),pr=fn({randomNormal_:function(t,e,n,r,i){if(void 0===e&&(e=0),void 0===n&&(n=1),null!=r&&"bool"===r)throw new Error("Unsupported data type "+r);for(var o=new Xn(e,n,r,!1,i),a=Zn(t,r),s=0;s<a.values.length;s++)a.values[s]=o.nextValue();return a.toTensor()}}),mr=fn({randomGamma_:function(t,e,n,r,i){if(void 0===n&&(n=1),void 0===r&&(r="float32"),null==n&&(n=1),null==r&&(r="float32"),"float32"!==r&&"int32"!==r)throw new Error("Unsupported data type "+r);for(var o=new Kn(e,n,r,i),a=Zn(t,r),s=0;s<a.values.length;s++)a.values[s]=o.nextValue();return a.toTensor()}}),gr=fn({randomUniform_:function(t,e,n,r,i){void 0===e&&(e=0),void 0===n&&(n=1),void 0===r&&(r="float32");for(var o=Zn(t,r),a=new Yn(e,n,null,i),s=0;s<o.values.length;s++)o.values[s]=a.nextValue();return o.toTensor()}}),yr=fn({reshape_:function(t,e){var n=tn(t,"x","reshape",null);return e=S(e,n.size),p(n.size===v(e),(function(){return"new shape and old shape must have the same number of elements."})),St.runKernel((function(t){return t.reshape(n,e)}),{$x:n},(function(t){return{$x:function(){return t.reshape(n.shape)}}}))}}),vr=fn({spaceToBatchND_:function(t,e,n){var r=tn(t,"x","spaceToBatchND");return p(r.rank>=1+e.length,(function(){return"input rank "+r.rank+" should be > than [blockShape] "+e.length})),p(n.length===e.length,(function(){return"paddings.shape[0] "+n.length+" must be equal to [blockShape] "+e.length})),p(r.shape.reduce((function(t,r,i){return i>0&&i<=e.length?t&&(r+n[i-1][0]+n[i-1][1])%e[i-1]==0:t}),!0),(function(){return"input spatial dimensions "+r.shape.slice(1)+" with paddings "+n.toString()+" must be divisible by blockShapes "+e.toString()})),St.runKernel((function(t){return t.spaceToBatchND(r,e,n)}),{$x:r},(function(t){return{$x:function(){return t.batchToSpaceND(e,n)}}}))}}),br=fn({squeeze_:function(t,e){var n=tn(t,"x","squeeze");return yr(n,O(n.shape,e).newShape)}}),wr=fn({stack_:function(t,e){void 0===e&&(e=0);var n=en(t,"tensors","stack");if(p(n.length>=1,(function(){return"Pass at least one tensor to tf.stack"})),1===n.length)return n[0].expandDims(e);var r=n[0].shape,i=n[0].dtype;p(e<=n[0].rank,(function(){return"Axis must be <= rank of the tensor"})),n.forEach((function(t){m(r,t.shape,"All tensors passed to stack must have matching shapes")})),n.forEach((function(t){p(i===t.dtype,(function(){return"All tensors passed to stack must have matching dtypes"}))}));var o=n.map((function(t){return t.expandDims(e)}));return In(o,e)}}),xr=fn({tile_:function(t,e){var n=tn(t,"x","tile",null);return p(n.rank===e.length,(function(){return"Error in transpose: rank of input "+n.rank+" must match length of reps "+e+"."})),St.runKernel((function(t,r){var i=t.tile(n,e);return r([n]),i}),{$x:n},(function(t,n){var r=n[0];return{$x:function(){var n=Rn(r);if(1===r.rank)for(var i=0;i<e[0];++i)n=n.add(t.slice([i*r.shape[0]],[r.shape[0]]));else if(2===r.rank)for(i=0;i<e[0];++i)for(var o=0;o<e[1];++o)n=n.add(t.slice([i*r.shape[0],o*r.shape[1]],[r.shape[0],r.shape[1]]));else if(3===r.rank)for(i=0;i<e[0];++i)for(o=0;o<e[1];++o)for(var a=0;a<e[2];++a)n=n.add(t.slice([i*r.shape[0],o*r.shape[1],a*r.shape[2]],[r.shape[0],r.shape[1],r.shape[2]]));else{if(4!==r.rank)throw new Error("Gradient for tile operation is not implemented for rank-"+r.rank+" tensors yet.");for(i=0;i<e[0];++i)for(o=0;o<e[1];++o)for(a=0;a<e[2];++a)for(var s=0;s<e[3];++s)n=n.add(t.slice([i*r.shape[0],o*r.shape[1],a*r.shape[2],s*r.shape[3]],[r.shape[0],r.shape[1],r.shape[2],r.shape[3]]))}return n}}}))}}),_r=fn({truncatedNormal_:function(t,e,n,r,i){if(void 0===e&&(e=0),void 0===n&&(n=1),null!=r&&"bool"===r)throw new Error("Unsupported data type "+r);for(var o=new Xn(e,n,r,!0,i),a=Zn(t,r),s=0;s<a.values.length;s++)a.values[s]=o.nextValue();return a.toTensor()}}),Cr=fn({unstack_:function(t,e){void 0===e&&(e=0),e=e||0;var n=tn(t,"x","unstack");return p(e>=-n.shape.length&&e<n.shape.length,(function(){return"Axis = "+e+" is not in [-"+n.shape.length+", "+n.shape.length+")"})),e<0&&(e+=n.shape.length),St.runKernel((function(t){return t.unstack(n,e)}),{$x:n},(function(t){return{$x:function(){return wr(t,e)}}}))}}),kr=function(t,e){return o(this,void 0,void 0,(function(){var n,r,i,o,s,u,l,c,h,d;return a(this,(function(a){switch(a.label){case 0:return n=tn(t,"x","setdiff1d"),r=tn(e,"y","setdiff1d"),p(n.dtype===r.dtype,(function(){return"x and y should have the same dtype, but got x ("+n.dtype+") and y ("+r.dtype+")."})),p(1===n.rank,(function(){return"x should be 1D tensor, but got x ("+n.shape+")."})),p(1===r.rank,(function(){return"y should be 1D tensor, but got y ("+r.shape+")."})),[4,n.data()];case 1:return i=a.sent(),[4,r.data()];case 2:for(o=a.sent(),s=new Set(o),u=0,h=0;h<i.length;h++)s.has(i[h])||u++;for(l=new rt([u],n.dtype),c=new rt([u],"int32"),h=0,d=0;h<i.length;h++)s.has(i[h])||(l.values[d]=i[h],c.values[d]=h,d++);return[2,[l.toTensor(),c.toTensor()]]}}))}))};function Sr(t,e,n,r){void 0===r&&(r=!0);var i=[];if(r)(i=i.concat(e.slice(0))).push(t[0]/n),i=i.concat(t.slice(1));else{i=i.concat(t[0]);for(var o=e.length,a=0;a<o;++a)i=i.concat([t[a+1]/e[a],e[a]]);i=i.concat(t.slice(o+1))}return i}function Er(t,e,n){void 0===n&&(n=!0);var r=[];if(n){r.push(e);for(var i=e+1;i<t;++i)i<=2*e?(r.push(i),r.push(i-(e+1))):r.push(i)}else{var o=[],a=[];for(i=1;i<t;++i)i>=2*e+1||i%2==1?a.push(i):o.push(i);r.push.apply(r,o),r.push(0),r.push.apply(r,a)}return r}function Or(t,e,n,r){void 0===r&&(r=!0);var i=[];i.push(r?t[0]/n:t[0]*n);for(var o=1;o<t.length;++o)i.push(o<=e.length?r?e[o-1]*t[o]:t[o]/e[o-1]:t[o]);return i}function Ar(t,e){for(var n=[0],r=0;r<e;++r)n.push(t[r][0]);return n}function Nr(t,e,n){for(var r=t.slice(0,1),i=0;i<n;++i)r.push(t[i+1]-e[i][0]-e[i][1]);return r}function Tr(t,e){if(t.rank<1)throw new Error("tf.gatherND() expects the input to be rank 1 or higher, but the rank was "+t.rank+".");if(e.rank<1)throw new Error("tf.gatherND() expects the indices to be rank 1 or higher, but the rank was "+e.rank+".");if("int32"!==e.dtype)throw new Error("tf.gatherND() expects the indices to be int32 type, but the dtype was "+e.dtype+".");if(e.shape[e.rank-1]>t.rank)throw new Error("index innermost dimension length must be <= tensor rank; saw: "+e.shape[e.rank-1]+" vs. "+t.rank);if(0===t.size)throw new Error("Requested more than 0 entries, but input is empty. Input shape: "+t.shape+".");for(var n=e.shape,r=n[n.length-1],i=1,o=0;o<n.length-1;++o)i*=n[o];var a=t.shape,s=n.slice();s.pop();var u=1;for(o=r;o<t.rank;++o)u*=a[o],s.push(a[o]);var l=$(t.shape).map((function(t){return t/u})).concat([1]).slice(0,r);return[s,i,u,l]}function Dr(t){return t<=30?t:U(t,Math.floor(Math.sqrt(t)))}function Rr(t,e,n){for(var r=e.rank>1?e.shape[e.rank-1]:1,i=n.length,o=1,a=r;a<i;++a)o*=n[a];return{sliceRank:r,numUpdates:e.size/(r<1?1:r),sliceSize:o,strides:$(n.slice(0,r)).concat([1]),outputSize:v(n)}}function Ir(t){for(var e=[],n=0;t>0;)1&t&&e.push(n),t/=2,n++;return e}function Mr(t,e,n){for(var r=[],i=0;i<t.length;i++)r[i]=Math.ceil((e[i]-t[i])/n[i]);return r}function Fr(t,e,n,r,i){var o=e[i];(t&1<<i||null==o)&&(o=(n[i]||1)>0?Number.MIN_SAFE_INTEGER:Number.MAX_SAFE_INTEGER);var a=r[i];return o<0&&(o+=a),h(0,o,a-1)}function Pr(t,e,n,r,i){var o=e[i],a=n[i]||1;(t&1<<i||null==o)&&(o=a>0?Number.MAX_SAFE_INTEGER:Number.MIN_SAFE_INTEGER);var s=r[i];return o<0&&(o+=s),a>0?h(0,o,s):h(-1,o,s-1)}function jr(t,e,n){for(var r=n.length,i=0;i<n.length;i++)if(n[i]>1){r=i;break}for(i=r+1;i<n.length;i++)if(e[i]>0||n[i]!==t[i])return!1;return!0}function zr(t,e){for(var n=t.length>0?t[t.length-1]:1,r=0;r<t.length-1;r++)n+=t[r]*e[r];return n}function Lr(t){return p(B(t),(function(){return"The f passed in grad(f) must be a function"})),function(e,n){var r=tn(e,"x","tf.grad",null),i=null!=n?tn(n,"dy","tf.grad"):null;return St.tidy((function(){var e=St.gradients((function(){return t(r)}),[r],i),n=e.grads;return null!=i&&m(e.value.shape,i.shape,"The shape of dy passed in grad(f)(x, dy) must match the shape returned by f(x)"),qr(n),n[0]}))}}function Br(t){return p(B(t),(function(){return"The f passed in grads(f) must be a function"})),function(e,n){p(Array.isArray(e),(function(){return"The args passed in grads(f)(args) must be an array of `Tensor`s or `TensorLike`s"}));var r=en(e,"args","tf.grads",null),i=null!=n?tn(n,"dy","tf.grads"):null;return St.tidy((function(){var e=St.gradients((function(){return t.apply(void 0,r)}),r,i),n=e.grads;return null!=i&&m(e.value.shape,i.shape,"The shape of dy passed in grads(f)([x1,...], dy) must match the shape returned by f([x1,...])"),qr(n),n}))}}function Ur(t){return p(B(t),(function(){return"The f passed in valueAndGrad(f) must be a function"})),function(e,n){p(e instanceof st,(function(){return"The x passed in valueAndGrad(f)(x) must be a tensor"})),p(null==n||n instanceof st,(function(){return"The dy passed in valueAndGrad(f)(x, dy) must be a tensor"}));var r=St.gradients((function(){return t(e)}),[e],n),i=r.grads,o=r.value;return qr(i),{grad:i[0],value:o}}}function $r(t){return p(B(t),(function(){return"The f passed in valueAndGrads(f) must be a function"})),function(e,n){p(Array.isArray(e)&&e.every((function(t){return t instanceof st})),(function(){return"The args passed in valueAndGrads(f)(args) must be array of tensors"})),p(null==n||n instanceof st,(function(){return"The dy passed in valueAndGrads(f)(args, dy) must be a tensor"}));var r=St.gradients((function(){return t.apply(void 0,e)}),e,n);return null!=n&&m(r.value.shape,n.shape,"The shape of dy passed in valueAndGrads(f)([x1,...], dy) must match the shape returned by f([x1,...])"),qr(r.grads),r}}function Vr(t,e){p(B(t),(function(){return"The f passed in variableGrads(f) must be a function"})),p(null==e||Array.isArray(e)&&e.every((function(t){return t instanceof ut})),(function(){return"The varList passed in variableGrads(f, varList) must be an array of variables"}));var n=null!=e;if(!n)for(var r in e=[],St.registeredVariables)e.push(St.registeredVariables[r]);var i=n?e.filter((function(t){return!t.trainable})):null,o=e.length;p((e=e.filter((function(t){return t.trainable}))).length>0,(function(){return"variableGrads() expects at least one of the input variables to be trainable, but none of the "+o+" variables is trainable."}));var a=St.gradients(t,e,null,!0),s=a.value,u=a.grads;p(u.some((function(t){return null!=t})),(function(){return"Cannot find a connection between any variable and the result of the loss function y=f(x). Please make sure the operations that use variables are inside the function f passed to minimize()."})),p(0===s.rank,(function(){return"The f passed in variableGrads(f) must return a scalar, but it returned a rank-"+s.rank+" tensor"}));var l={};return e.forEach((function(t,e){null!=u[e]&&(l[t.name]=u[e])})),null!=i&&i.forEach((function(t){return l[t.name]=null})),{value:s,grads:l}}function Wr(t){return St.customGrad(t)}function qr(t){if(t.filter((function(t){return null==t})).length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that\n    the f you passed encloses all operations that lead from x to y.")}var Hr=fn({softmax_:function(t,e){void 0===e&&(e=-1);var n=tn(t,"logits","softmax");if(-1===e&&(e=n.rank-1),e!==n.rank-1)throw Error("Softmax along a non-last dimension is not yet supported. Logits was rank "+n.rank+" and dim was "+e);return Wr((function(t,n){var r=t.logSumExp([e],!0),i=t.toFloat().sub(r).exp();return n([i]),{value:i,gradFunc:function(t,n){var r=n[0],i=t.mul(r);return i.sub(i.sum([e],!0).mul(r))}}}))(n)}}),Gr=fn({logSoftmax_:function(t,e){void 0===e&&(e=-1);var n=tn(t,"logits","logSoftmax");if(-1===e&&(e=n.rank-1),e!==n.rank-1)throw Error("Log Softmax along a non-last dimension is not yet supported. Logits was rank "+n.rank+" and axis was "+e);return Wr((function(t,n){var r=t.max(e,!0),i=t.sub(r),o=i.toFloat().sub(i.exp().sum(e,!0).log());return n([o]),{value:o,gradFunc:function(t,n){var r=n[0].exp();return t.sub(t.sum(e,!0).mul(r))}}}))(n)}}),Xr=function(){function t(t,e){this.backend=t,this.dataMover=e,this.data=new WeakMap}return t.prototype.get=function(t){return this.data.has(t)||this.dataMover.moveData(this.backend,t),this.data.get(t)},t.prototype.set=function(t,e){this.data.set(t,e)},t.prototype.has=function(t){return this.data.has(t)},t.prototype.delete=function(t){return this.data.delete(t)},t}(),Kr=function(){function t(){}return t.prototype.time=function(t){throw new Error("Not yet implemented.")},t.prototype.read=function(t){throw new Error("Not yet implemented.")},t.prototype.readSync=function(t){throw new Error("Not yet implemented.")},t.prototype.disposeData=function(t){throw new Error("Not yet implemented.")},t.prototype.write=function(t,e){throw new Error("Not yet implemented.")},t.prototype.fromPixels=function(t,e){throw new Error("Not yet implemented.")},t.prototype.register=function(t,e,n){throw new Error("Not yet implemented.")},t.prototype.memory=function(){throw new Error("Not yet implemented.")},t.prototype.floatPrecision=function(){throw new Error("Not yet implemented")},t.prototype.epsilon=function(){return 32===this.floatPrecision()?1e-7:1e-4},t.prototype.batchMatMul=function(t,e,n,r){throw new Error("Not yet implemented")},t.prototype.fusedBatchMatMul=function(t){throw new Error("Not yet implemented")},t.prototype.slice=function(t,e,n){throw new Error("Not yet implemented")},t.prototype.stridedSlice=function(t,e,n,r){throw new Error("Not yet implemented")},t.prototype.unstack=function(t,e){throw new Error("Not yet implemented")},t.prototype.reverse=function(t,e){throw new Error("Not yet implemented")},t.prototype.concat=function(t,e){throw new Error("Not yet implemented")},t.prototype.neg=function(t){throw new Error("Not yet implemented")},t.prototype.add=function(t,e){throw new Error("Not yet implemented")},t.prototype.addN=function(t){throw new Error("Not yet implemented")},t.prototype.subtract=function(t,e){throw new Error("Not yet implemented")},t.prototype.multiply=function(t,e){throw new Error("Not yet implemented")},t.prototype.realDivide=function(t,e){throw new Error("Not yet implemented")},t.prototype.floorDiv=function(t,e){throw new Error("Not yet implemented")},t.prototype.sum=function(t,e){throw new Error("Not yet implemented")},t.prototype.prod=function(t,e){throw new Error("Not yet implemented")},t.prototype.unsortedSegmentSum=function(t,e,n){throw new Error("Not yet implemented")},t.prototype.argMin=function(t,e){throw new Error("Not yet implemented")},t.prototype.argMax=function(t,e){throw new Error("Not yet implemented")},t.prototype.equal=function(t,e){throw new Error("Not yet implemented")},t.prototype.notEqual=function(t,e){throw new Error("Not yet implemented")},t.prototype.less=function(t,e){throw new Error("Not yet implemented")},t.prototype.lessEqual=function(t,e){throw new Error("Not yet implemented")},t.prototype.greater=function(t,e){throw new Error("Not yet implemented")},t.prototype.greaterEqual=function(t,e){throw new Error("Not yet implemented")},t.prototype.logicalNot=function(t){throw new Error("Not yet implemented")},t.prototype.logicalAnd=function(t,e){throw new Error("Not yet implemented")},t.prototype.logicalOr=function(t,e){throw new Error("Not yet implemented")},t.prototype.where=function(t){throw new Error("Not yet implemented")},t.prototype.select=function(t,e,n){throw new Error("Not yet implemented")},t.prototype.topk=function(t,e,n){throw new Error("Not yet implemented")},t.prototype.min=function(t,e){throw new Error("Not yet implemented")},t.prototype.minimum=function(t,e){throw new Error("Not yet implemented")},t.prototype.mod=function(t,e){throw new Error("Not yet implemented")},t.prototype.max=function(t,e){throw new Error("Not yet implemented")},t.prototype.maximum=function(t,e){throw new Error("Not yet implemented")},t.prototype.all=function(t,e){throw new Error("Not yet implemented")},t.prototype.any=function(t,e){throw new Error("Not yet implemented")},t.prototype.squaredDifference=function(t,e){throw new Error("Not yet implemented")},t.prototype.ceil=function(t){throw new Error("Not yet implemented")},t.prototype.floor=function(t){throw new Error("Not yet implemented")},t.prototype.round=function(t){throw new Error("Not yet implemented")},t.prototype.sign=function(t){throw new Error("Not yet implemented")},t.prototype.isNaN=function(t){throw new Error("Not yet implemented")},t.prototype.isInf=function(t){throw new Error("Not yet implemented")},t.prototype.isFinite=function(t){throw new Error("Not yet implemented")},t.prototype.pow=function(t,e){throw new Error("Not yet implemented")},t.prototype.exp=function(t){throw new Error("Not yet implemented")},t.prototype.expm1=function(t){throw new Error("Not yet implemented")},t.prototype.log=function(t){throw new Error("Not yet implemented")},t.prototype.log1p=function(t){throw new Error("Not yet implemented")},t.prototype.sqrt=function(t){throw new Error("Not yet implemented")},t.prototype.rsqrt=function(t){throw new Error("Not yet implemented")},t.prototype.square=function(t){throw new Error("Not yet implemented")},t.prototype.reciprocal=function(t){throw new Error("Not yet implemented")},t.prototype.relu=function(t){throw new Error("Not yet implemented")},t.prototype.relu6=function(t){throw new Error("Not yet implemented")},t.prototype.prelu=function(t,e){throw new Error("Not yet implemented")},t.prototype.elu=function(t){throw new Error("Not yet implemented")},t.prototype.eluDer=function(t,e){throw new Error("Not yet implemented")},t.prototype.selu=function(t){throw new Error("Not yet implemented")},t.prototype.int=function(t){throw new Error("Not yet implemented")},t.prototype.clip=function(t,e,n){throw new Error("Not yet implemented")},t.prototype.abs=function(t){throw new Error("Not yet implemented")},t.prototype.complexAbs=function(t){throw new Error("Not yet implemented")},t.prototype.sigmoid=function(t){throw new Error("Not yet implemented")},t.prototype.softplus=function(t){throw new Error("Not yet implemented")},t.prototype.sin=function(t){throw new Error("Not yet implemented")},t.prototype.cos=function(t){throw new Error("Not yet implemented")},t.prototype.tan=function(t){throw new Error("Not yet implemented")},t.prototype.asin=function(t){throw new Error("Not yet implemented")},t.prototype.acos=function(t){throw new Error("Not yet implemented")},t.prototype.atan=function(t){throw new Error("Not yet implemented")},t.prototype.atan2=function(t,e){throw new Error("Not yet implemented")},t.prototype.sinh=function(t){throw new Error("Not yet implemented")},t.prototype.cosh=function(t){throw new Error("Not yet implemented")},t.prototype.tanh=function(t){throw new Error("Not yet implemented")},t.prototype.asinh=function(t){throw new Error("Not yet implemented")},t.prototype.acosh=function(t){throw new Error("Not yet implemented")},t.prototype.atanh=function(t){throw new Error("Not yet implemented")},t.prototype.erf=function(t){throw new Error("Not yet implemented")},t.prototype.step=function(t,e){throw new Error("Not yet implemented")},t.prototype.fusedConv2d=function(t){throw new Error("Not yet implemented")},t.prototype.conv2d=function(t,e,n){throw new Error("Not yet implemented")},t.prototype.conv2dDerInput=function(t,e,n){throw new Error("Not yet implemented")},t.prototype.conv2dDerFilter=function(t,e,n){throw new Error("Not yet implemented")},t.prototype.fusedDepthwiseConv2D=function(t){throw new Error("Not yet implemented")},t.prototype.depthwiseConv2D=function(t,e,n){throw new Error("Not yet implemented")},t.prototype.depthwiseConv2DDerInput=function(t,e,n){throw new Error("Not yet implemented")},t.prototype.depthwiseConv2DDerFilter=function(t,e,n){throw new Error("Not yet implemented")},t.prototype.conv3d=function(t,e,n){throw new Error("Not yet implemented")},t.prototype.conv3dDerInput=function(t,e,n){throw new Error("Not yet implemented")},t.prototype.conv3dDerFilter=function(t,e,n){throw new Error("Not yet implemented")},t.prototype.maxPool=function(t,e){throw new Error("Not yet implemented")},t.prototype.maxPoolBackprop=function(t,e,n,r){throw new Error("Not yet implemented")},t.prototype.avgPool=function(t,e){throw new Error("Not yet implemented")},t.prototype.avgPoolBackprop=function(t,e,n){throw new Error("Not yet implemented")},t.prototype.avgPool3d=function(t,e){throw new Error("Not yet implemented")},t.prototype.avgPool3dBackprop=function(t,e,n){throw new Error("Not yet implemented")},t.prototype.maxPool3d=function(t,e){throw new Error("Not yet implemented")},t.prototype.maxPool3dBackprop=function(t,e,n,r){throw new Error("Not yet implemented")},t.prototype.reshape=function(t,e){throw new Error("Not yet implemented")},t.prototype.cast=function(t,e){throw new Error("Not yet implemented")},t.prototype.tile=function(t,e){throw new Error("Not yet implemented")},t.prototype.pad=function(t,e,n){throw new Error("Not yet implemented")},t.prototype.transpose=function(t,e){throw new Error("Not yet implemented")},t.prototype.gather=function(t,e,n){throw new Error("Not yet implemented")},t.prototype.gatherND=function(t,e){throw new Error("Not yet implemented")},t.prototype.scatterND=function(t,e,n){throw new Error("Not yet implemented")},t.prototype.batchToSpaceND=function(t,e,n){throw new Error("Not yet implemented")},t.prototype.spaceToBatchND=function(t,e,n){throw new Error("Not yet implemented")},t.prototype.resizeBilinear=function(t,e,n,r){throw new Error("Not yet implemented")},t.prototype.resizeBilinearBackprop=function(t,e,n){throw new Error("Not yet implemented")},t.prototype.resizeNearestNeighbor=function(t,e,n,r){throw new Error("Not yet implemented")},t.prototype.resizeNearestNeighborBackprop=function(t,e,n){throw new Error("Not yet implemented")},t.prototype.batchNormalization=function(t,e,n,r,i,o){throw new Error("Not yet implemented")},t.prototype.localResponseNormalization4D=function(t,e,n,r,i){throw new Error("Not yet implemented")},t.prototype.LRNGrad=function(t,e,n,r,i,o,a){throw new Error("Not yet implemented")},t.prototype.multinomial=function(t,e,n,r){throw new Error("Not yet implemented")},t.prototype.oneHot=function(t,e,n,r){throw new Error("Not yet implemented")},t.prototype.cumsum=function(t,e,n,r){throw new Error("Not yet implemented")},t.prototype.nonMaxSuppression=function(t,e,n,r,i){throw new Error("Not yet implemented")},t.prototype.fft=function(t){throw new Error("Not yet implemented")},t.prototype.ifft=function(t){throw new Error("Not yet implemented")},t.prototype.complex=function(t,e){throw new Error("Not yet implemented")},t.prototype.real=function(t){throw new Error("Not yet implemented")},t.prototype.imag=function(t){throw new Error("Not yet implemented")},t.prototype.cropAndResize=function(t,e,n,r,i,o){throw new Error("Not yet implemented")},t.prototype.depthToSpace=function(t,e,n){throw new Error("Not yet implemented")},t.prototype.split=function(t,e,n){throw new Error("Not yet implemented")},t.prototype.sparseToDense=function(t,e,n,r){throw new Error("Not yet implemented")},t.prototype.diag=function(t){throw new Error("Not yet implemented")},t.prototype.fill=function(t,e,n){throw new Error("Not yet implemented.")},t.prototype.onesLike=function(t){throw new Error("Not yet implemented")},t.prototype.zerosLike=function(t){throw new Error("Not yet implemented")},t.prototype.linspace=function(t,e,n){throw new Error("Not yet implemented")},t.prototype.dispose=function(){throw new Error("Not yet implemented")},t}();function Yr(t,e){for(var n=t.length,r=[],i=0;i<n;i++){var o=n-1-i;(e[e.length-1-i]||1)>1&&1===(t[o]||1)&&r.unshift(o)}return r}function Zr(t,e){for(var n=[],r=0;r<e.length;r++){var i=t[t.length-r-1],o=e.length-r-1;(null==i||1===i&&e[o]>1)&&n.unshift(o)}return n}function Qr(t,e){for(var n=[],r=Math.max(t.length,e.length),i=0;i<r;i++){var o=t[t.length-i-1];null==o&&(o=1);var a=e[e.length-i-1];if(null==a&&(a=1),1===o)n.unshift(a);else if(1===a)n.unshift(o);else{if(o!==a)throw Error("Operands could not be broadcast together with shapes "+t+" and "+e+".");n.unshift(o)}}return n}function Jr(t,e,n,r,i,o,a){void 0===a&&(a="channelsLast");var s,u=ii(e),l=u[0],c=u[1];if("channelsLast"===a)s=[l,c,t[3],t[3]];else{if("channelsFirst"!==a)throw new Error("Unknown dataFormat "+a);s=[l,c,t[1],t[1]]}return ei(t,s,n,r,i,o,!1,a)}function ti(t,e,n,r,i,o,a){void 0===a&&(a="NDHWC");var s,u,l=oi(e),c=l[0],h=l[1],d=l[2];if("NDHWC"===a)u="channelsLast",s=[c,h,d,t[4],t[4]];else{if("NCDHW"!==a)throw new Error("Unknown dataFormat "+a);u="channelsFirst",s=[c,h,d,t[1],t[1]]}return ni(t,s,n,r,i,!1,u,o)}function ei(t,e,n,r,i,o,a,s){void 0===a&&(a=!1),void 0===s&&(s="channelsLast");var u=[-1,-1,-1,-1],l=u[0],c=u[1],h=u[2],d=u[3];if("channelsLast"===s)l=t[0],c=t[1],h=t[2],d=t[3];else{if("channelsFirst"!==s)throw new Error("Unknown dataFormat "+s);l=t[0],d=t[1],c=t[2],h=t[3]}var f,m=e[0],g=e[1],y=e[3],v=ii(n),b=v[0],x=v[1],_=ii(r),C=_[0],k=_[1],S=ai(m,C),E=ai(g,k),O=function(t,e,n,r,i,o,a,s){var u,l,c;if("number"==typeof t){u={top:t,bottom:t,left:t,right:t,type:0===t?"VALID":"NUMBER"};var h=function(t,e,n,r,i){null==r&&(r=ri(t,e,n));var o=t[1],a=si((t[0]-e+2*r)/n+1,i);p(w(a),(function(){return"The output # of rows ("+a+") must be an integer. Change the stride and/or zero pad parameters"}));var s=si((o-e+2*r)/n+1,i);return p(w(s),(function(){return"The output # of columns ("+s+") must be an integer. Change the stride and/or zero pad parameters"})),[a,s]}([e,n],o,r,t,s);l=h[0],c=h[1]}else if("same"===t){l=Math.ceil(e/r),c=Math.ceil(n/i);var d=Math.max(0,(l-1)*r+o-e),f=Math.max(0,(c-1)*i+a-n),m=Math.floor(d/2),g=d-m,y=Math.floor(f/2);u={top:m,bottom:g,left:y,right:f-y,type:"SAME"}}else{if("valid"!==t)throw Error("Unknown padding parameter: "+t);u={top:0,bottom:0,left:0,right:0,type:"VALID"},l=Math.ceil((e-o+1)/r),c=Math.ceil((n-a+1)/i)}return{padInfo:u,outHeight:l,outWidth:c}}(i,c,h,b,x,S,E,o),A=O.outHeight,N=O.outWidth,T=a?y*d:y;return"channelsFirst"===s?f=[l,T,A,N]:"channelsLast"===s&&(f=[l,A,N,T]),{batchSize:l,dataFormat:s,inHeight:c,inWidth:h,inChannels:d,outHeight:A,outWidth:N,outChannels:T,padInfo:O.padInfo,strideHeight:b,strideWidth:x,filterHeight:m,filterWidth:g,effectiveFilterHeight:S,effectiveFilterWidth:E,dilationHeight:C,dilationWidth:k,inShape:t,outShape:f,filterShape:e}}function ni(t,e,n,r,i,o,a,s){void 0===o&&(o=!1),void 0===a&&(a="channelsLast");var u=[-1,-1,-1,-1,-1],l=u[0],c=u[1],h=u[2],d=u[3],f=u[4];if("channelsLast"===a)l=t[0],c=t[1],h=t[2],d=t[3],f=t[4];else{if("channelsFirst"!==a)throw new Error("Unknown dataFormat "+a);l=t[0],f=t[1],c=t[2],h=t[3],d=t[4]}var m,g=e[0],y=e[1],v=e[2],b=e[4],x=oi(n),_=x[0],C=x[1],k=x[2],S=oi(r),E=S[0],O=S[1],A=S[2],N=ai(g,E),T=ai(y,O),D=ai(v,A),R=function(t,e,n,r,i,o,a,s,u,l,c){var h,d,f,m;if("number"==typeof t){h={top:t,bottom:t,left:t,right:t,front:t,back:t,type:0===t?"VALID":"NUMBER"};var g=function(t,e,n,r,i,o){null==i&&(i=ri(t,e,r));var a=t[1],s=t[2],u=si((t[0]-e+2*i)/r+1,o);p(w(u),(function(){return"The output # of depths ("+u+") must be an integer. Change the stride and/or zero pad parameters"}));var l=si((a-e+2*i)/r+1,o);p(w(l),(function(){return"The output # of rows ("+l+") must be an integer. Change the stride and/or zero pad parameters"}));var c=si((s-e+2*i)/r+1,o);return p(w(c),(function(){return"The output # of columns ("+c+") must be an integer. Change the stride and/or zero pad parameters"})),[u,l,c,1]}([e,n,r,1],s,0,i,t,c);d=g[0],f=g[1],m=g[2]}else if("same"===t){var y=((d=Math.ceil(e/i))-1)*i+s-e,v=((f=Math.ceil(n/o))-1)*o+u-n,b=((m=Math.ceil(r/a))-1)*a+l-r,x=Math.floor(y/2),_=y-x,C=Math.floor(v/2),k=v-C,S=Math.floor(b/2);h={top:C,bottom:k,left:S,right:b-S,front:x,back:_,type:"SAME"}}else{if("valid"!==t)throw Error("Unknown padding parameter: "+t);h={top:0,bottom:0,left:0,right:0,front:0,back:0,type:"VALID"},d=Math.ceil((e-s+1)/i),f=Math.ceil((n-u+1)/o),m=Math.ceil((r-l+1)/a)}return{padInfo:h,outDepth:d,outHeight:f,outWidth:m}}(i,c,h,d,_,C,k,N,T,D,s),I=R.outDepth,M=R.outHeight,F=R.outWidth,P=o?b*f:b;return"channelsFirst"===a?m=[l,P,I,M,F]:"channelsLast"===a&&(m=[l,I,M,F,P]),{batchSize:l,dataFormat:a,inDepth:c,inHeight:h,inWidth:d,inChannels:f,outDepth:I,outHeight:M,outWidth:F,outChannels:P,padInfo:R.padInfo,strideDepth:_,strideHeight:C,strideWidth:k,filterDepth:g,filterHeight:y,filterWidth:v,effectiveFilterDepth:N,effectiveFilterHeight:T,effectiveFilterWidth:D,dilationDepth:E,dilationHeight:O,dilationWidth:A,inShape:t,outShape:m,filterShape:e}}function ri(t,e,n,r){void 0===r&&(r=1);var i=ai(e,r);return Math.floor((t[0]*(n-1)-n+i)/2)}function ii(t){return"number"==typeof t?[t,t,t]:2===t.length?[t[0],t[1],1]:t}function oi(t){return"number"==typeof t?[t,t,t]:t}function ai(t,e){return e<=1?t:t+(t-1)*(e-1)}function si(t,e){if(!e)return t;switch(e){case"round":return Math.round(t);case"ceil":return Math.ceil(t);case"floor":return Math.floor(t);default:throw new Error("Unknown roundingMode "+e)}}function ui(t){var e=ii(t);return 1===e[0]&&1===e[1]&&1===e[2]}function li(t,e){return ui(t)||ui(e)}function ci(t){if("NHWC"===t)return"channelsLast";if("NCHW"===t)return"channelsFirst";throw new Error("Unknown dataFormat "+t)}function hi(t,e,n){if("complex64"===e){if("complex64"===t.dtype)return t.clone();var r=On(t.shape),i=t.toFloat(),o=n.complex(i,r);return r.dispose(),i.dispose(),o}if(!R(t.dtype,e))return st.make(t.shape,{dataId:t.dataId},e);if("complex64"===t.dtype){var a=n.real(t);return o=a.cast(e),a.dispose(),o}if("int32"===e)return n.int(t);if("bool"===e){var s=bn(0,t.dtype);return o=n.notEqual(t,s),s.dispose(),o}throw new Error("Error in Cast: failed to cast "+t.dtype+" to "+e)}function di(t,e){return st.make(e,{dataId:t.dataId},t.dtype)}function fi(t,e,n){var r=(e-t)/(n-1),i=H(n,"float32");i[0]=t;for(var o=1;o<i.length;o++)i[o]=i[o-1]+r;return wn(i,"float32")}var pi=Object.freeze({castTensor:hi,reshapeTensor:di,linspaceImpl:fi,upcastType:gt,axesAreInnerMostDims:nn,combineLocations:rn,computeOutAndReduceShapes:on,expandShapeToKeepDim:an,assertAxesAreInnerMostDims:sn,getAxesPermutation:un,getUndoAxesPermutation:ln,getInnerMostAxes:cn,getBroadcastDims:Yr,getReductionAxes:Zr,assertAndGetBroadcastShape:Qr,assertParamsConsistent:hn,computeOutShape:dn,computePool2DInfo:Jr,computePool3DInfo:ti,computeConv2DInfo:ei,computeConv3DInfo:ni,computeDefaultPad:ri,tupleValuesAreOne:ui,eitherStridesOrDilationsAreOne:li,convertConv2DDataFormat:ci});function mi(t,e){if(t.length!==e.length)throw new Error("Cannot merge real and imag arrays of different lengths. real:"+t.length+", imag: "+e.length+".");for(var n=new Float32Array(2*t.length),r=0;r<n.length;r+=2)n[r]=t[r/2],n[r+1]=e[r/2];return n}function gi(t,e){return{real:t[2*e],imag:t[2*e+1]}}function yi(t,e,n,r){t[2*r]=e,t[2*r+1]=n}function vi(t,e,n){var r=(n?2:-2)*Math.PI*(t/e);return{real:Math.cos(r),imag:Math.sin(r)}}function bi(t,e,n,r,i){for(var o=Array.from(e).map((function(t,e){return{score:t,boxIndex:e}})).filter((function(t){return t.score>i})).sort((function(t,e){return e.score-t.score})),a=[],s=0;s<o.length;s++){var u=o[s],l=u.boxIndex;if(u.score<i)break;for(var c=!1,h=a.length-1;h>=0;--h)if(wi(t,l,a[h])>=r){c=!0;break}if(!c&&(a.push(l),a.length>=n))break}return wn(a,"int32")}function wi(t,e,n){var r=t.subarray(4*e,4*e+4),i=t.subarray(4*n,4*n+4),o=Math.min(r[0],r[2]),a=Math.min(r[1],r[3]),s=Math.max(r[0],r[2]),u=Math.max(r[1],r[3]),l=Math.min(i[0],i[2]),c=Math.min(i[1],i[3]),h=Math.max(i[0],i[2]),d=Math.max(i[1],i[3]),f=(s-o)*(u-a),p=(h-l)*(d-c);if(f<=0||p<=0)return 0;var m=Math.max(o,l),g=Math.max(a,c),y=Math.min(s,h),v=Math.min(u,d),b=Math.max(y-m,0)*Math.max(v-g,0);return b/(f+p-b)}function xi(t,e,n){var r=new Array(t.rank).fill(0),i=t.shape.slice();return e.map((function(e){i[n]=e;var o=t.slice(r,i);return r[n]+=e,o}))}function _i(t,e){for(var n=new Array(t.rank),r=0;r<n.length;r++)n[r]=t.shape[r]*e[r];var i=Zn(n,t.dtype);for(r=0;r<i.values.length;++r){for(var o=i.indexToLoc(r),a=new Array(t.rank),s=0;s<a.length;s++)a[s]=o[s]%t.shape[s];var u=t.locToIndex(a);i.values[r]=t.values[u]}return i.toTensor()}function Ci(t,e,n,r,i){for(var o=e[e.length-1],a=[t.length/o,o],s=a[0],u=a[1],l=A(n,s*r),c=A("int32",s*r),h=0;h<s;h++){for(var d=h*u,f=t.subarray(d,d+u),p=[],m=0;m<f.length;m++)p.push({value:f[m],index:m});p.sort((function(t,e){return e.value-t.value}));var g=h*r,y=l.subarray(g,g+r),v=c.subarray(g,g+r);for(m=0;m<r;m++)y[m]=p[m].value,v[m]=p[m].index}var b=e.slice();return b[b.length-1]=r,[yn(l,b,n),yn(c,b,"int32")]}function ki(t,e){for(var n=[],r=0;r<e.length;r++)e[r]&&n.push(r);var i=Zn(t,"int32"),o=Zn([n.length,t.length],"int32");for(r=0;r<n.length;r++){var a=i.indexToLoc(n[r]);o.values.set(a,r*t.length)}return o.toTensor()}var Si=function(t,e){this.outputShape=[],this.outputShape=t,this.variableNames=e.map((function(t,e){return"T"+e}));var n=[];this.variableNames.forEach((function(t){n.push("float v"+t+" = get"+t+"AtOutCoords();")}));var r=this.variableNames.map((function(t){return"v"+t})).join(" + ");this.userCode="\n      void main() {\n        "+n.join("\n        ")+"\n\n        float result = "+r+";\n        setOutput(result);\n      }\n    "},Ei=function(t,e){this.outputShape=[],this.usesPackedTextures=!0,this.outputShape=t,this.variableNames=e.map((function(t,e){return"T"+e}));var n=[];this.variableNames.forEach((function(t){n.push("vec4 v"+t+" = get"+t+"AtOutCoords();")}));var r=this.variableNames.map((function(t){return"v"+t})).join(" + ");this.userCode="\n      void main() {\n        "+n.join("\n        ")+"\n\n        vec4 result = "+r+";\n        setOutput(result);\n      }\n    "},Oi=function(t,e,n){this.variableNames=["A"];var r=t.windowSize,i=t.batchSize,o=Math.ceil(t.inSize/r);n||this.variableNames.push("bestIndicesA"),this.outputShape=[i,o],this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = outIdx * "+r+";\n\n        int bestIndex = inOffset;\n        float bestValue = getA(batch, bestIndex);\n\n        for (int i = 0; i < "+r+"; i++) {\n          int inIdx = "+(n?"inOffset + i;":"round(getBestIndicesA(batch, inOffset + i));")+";\n          float candidate = getA(batch, inIdx);\n          if (candidate "+("max"===e?">":"<")+" bestValue) {\n            bestValue = candidate;\n            bestIndex = inIdx;\n          }\n        }\n        setOutput(float(bestIndex));\n      }\n    "};function Ai(t,e){return["x","y","z","w","u","v"].slice(0,e).map((function(e){return t+"."+e}))}function Ni(t,e){return 1===e?[t]:Ai(t,e)}function Ti(){var t,e,n,r,i,o,a,s,l,c;return 2===u().getNumber("WEBGL_VERSION")?(t="#version 300 es",e="in",n="out",r="in",i="texture",o="outputColor",a="out vec4 outputColor;",s="\n      bool isnan_custom(float val) {\n        return (val > 0.0 || val < 0.0) ? false : val != 0.0;\n      }\n\n      bvec4 isnan_custom(vec4 val) {\n        return bvec4(isnan_custom(val.x),\n          isnan_custom(val.y), isnan_custom(val.z), isnan_custom(val.w));\n      }\n\n      #define isnan(value) isnan_custom(value)\n    ",l="",c="\n      #define round(value) newRound(value)\n      int newRound(float value) {\n        return int(floor(value + 0.5));\n      }\n\n      ivec4 newRound(vec4 value) {\n        return ivec4(floor(value + vec4(0.5)));\n      }\n    "):(t="",e="attribute",n="varying",r="varying",i="texture2D",o="gl_FragColor",a="",s="\n      #define isnan(value) isnan_custom(value)\n      bool isnan_custom(float val) {\n        return (val > 0. || val < 1. || val == 0.) ? false : true;\n      }\n      bvec4 isnan_custom(vec4 val) {\n        return bvec4(isnan(val.x), isnan(val.y), isnan(val.z), isnan(val.w));\n      }\n    ",l="\n      uniform float INFINITY;\n\n      bool isinf(float val) {\n        return abs(val) == INFINITY;\n      }\n      bvec4 isinf(vec4 val) {\n        return equal(abs(val), vec4(INFINITY));\n      }\n    ",c="\n      int round(float value) {\n        return int(floor(value + 0.5));\n      }\n\n      ivec4 round(vec4 value) {\n        return ivec4(floor(value + vec4(0.5)));\n      }\n    "),{version:t,attribute:e,varyingVs:n,varyingFs:r,texture2D:i,output:o,defineOutput:a,defineSpecialNaN:s,defineSpecialInf:l,defineRound:c}}function Di(t,e,n){void 0===n&&(n="index");var r=$(e);return r.map((function(e,i){return"int "+t[i]+" = "+n+" / "+e+"; "+(i===r.length-1?"int "+t[i+1]+" = "+n+" - "+t[i]+" * "+e:"index -= "+t[i]+" * "+e)+";"})).join("")}function Ri(t){var e=$(t).map((function(t){return t.toString()}));return"\n  int getFlatIndex(ivec3 coords) {\n    return coords.x * "+e[0]+" + coords.y * "+e[1]+" + coords.z;\n  }\n"}var Ii="\n  const float FLOAT_MAX = 1.70141184e38;\n  const float FLOAT_MIN = 1.17549435e-38;\n\n  lowp vec4 encode_float(highp float v) {\n    if (isnan(v)) {\n      return vec4(255, 255, 255, 255);\n    }\n\n    highp float av = abs(v);\n\n    if(av < FLOAT_MIN) {\n      return vec4(0.0, 0.0, 0.0, 0.0);\n    } else if(v > FLOAT_MAX) {\n      return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;\n    } else if(v < -FLOAT_MAX) {\n      return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;\n    }\n\n    highp vec4 c = vec4(0,0,0,0);\n\n    highp float e = floor(log2(av));\n    highp float m = exp2(fract(log2(av))) - 1.0;\n\n    c[2] = floor(128.0 * m);\n    m -= c[2] / 128.0;\n    c[1] = floor(32768.0 * m);\n    m -= c[1] / 32768.0;\n    c[0] = floor(8388608.0 * m);\n\n    highp float ebias = e + 127.0;\n    c[3] = floor(ebias / 2.0);\n    ebias -= c[3] * 2.0;\n    c[2] += floor(ebias) * 128.0;\n\n    c[3] += 128.0 * step(0.0, -v);\n\n    return c / 255.0;\n  }\n";function Mi(t,e,n,r){var i=[];t.forEach((function(t){var e=v(t.shapeInfo.logicalShape);t.shapeInfo.isUniform?i.push("uniform float "+t.name+(e>1?"["+e+"]":"")+";"):(i.push("uniform sampler2D "+t.name+";"),i.push("uniform int offset"+t.name+";"))}));var o,a,s=i.join("\n"),u=t.map((function(t){return function(t,e,n){void 0===n&&(n=!1);var r="";return r+=n?function t(e){var n;switch(e.shapeInfo.logicalShape.length){case 0:return"\n    vec4 get"+(n=e.name).charAt(0).toUpperCase()+n.slice(1)+"() {\n      return "+Ti().texture2D+"("+n+", halfCR);\n    }\n  ";case 1:return function(t){var e=t.name,n="get"+e.charAt(0).toUpperCase()+e.slice(1),r=t.shapeInfo.texShape,i=[Math.ceil(r[0]/2),Math.ceil(r[1]/2)],o=Ti();return"\n    vec4 "+n+"(int index) {\n      vec2 uv = packedUVfrom1D(\n        "+i[0]+", "+i[1]+", index);\n      return "+o.texture2D+"("+e+", uv);\n    }\n  "}(e);case 2:return function(t){var e=t.shapeInfo.logicalShape,n=t.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),i=t.shapeInfo.texShape,o=i[0],a=i[1],s=Ti();if(null!=i&&b(e,i))return"\n      vec4 "+r+"(int row, int col) {\n        vec2 uv = (vec2(col, row) + halfCR) / vec2("+a+".0, "+o+".0);\n\n        return "+s.texture2D+"("+n+", uv);\n      }\n    ";var u=[Math.ceil(i[0]/2),Math.ceil(i[1]/2)];return"\n    vec4 "+r+"(int row, int col) {\n      vec2 uv = packedUVfrom2D("+Math.ceil(e[1]/2)+", "+u[0]+", "+u[1]+", row, col);\n      return "+s.texture2D+"("+n+", uv);\n    }\n  "}(e);case 3:return function(e){var n=e.shapeInfo.logicalShape,r=e.name,i="get"+r.charAt(0).toUpperCase()+r.slice(1),o=e.shapeInfo.texShape,a=[Math.ceil(o[0]/2),Math.ceil(o[1]/2)];if(1===n[0]){var s=$i(e,n.slice(1));return"\n        "+t(s)+"\n        vec4 "+i+"(int b, int row, int col) {\n          return "+i+"("+Vi(["b","row","col"],[1,2])+");\n        }\n      "}var u=a[0],l=a[1],c=Math.ceil(n[2]/2);return"\n    vec4 "+i+"(int b, int row, int col) {\n      vec2 uv = packedUVfrom3D(\n        "+u+", "+l+", "+c*Math.ceil(n[1]/2)+", "+c+", b, row, col);\n      return "+Ti().texture2D+"("+r+", uv);\n    }\n  "}(e);default:return function(t){for(var e=t.shapeInfo.logicalShape,n=e.length,r=t.name,i="get"+r.charAt(0).toUpperCase()+r.slice(1),o=t.shapeInfo.texShape,a=[Math.ceil(o[0]/2),Math.ceil(o[1]/2)],s=a[0],u=a[1],l=Math.ceil(e[n-1]/2),c=l*Math.ceil(e[n-2]/2),h="int b, int row, int col",d="b * "+c+" + (row / 2) * "+l+" + (col / 2)",f=2;f<n-1;f++)h="int b"+f+", "+h,d="b"+f+" * "+(c*=e[n-f-1])+" + "+d;return"\n    vec4 "+i+"("+h+") {\n      int index = "+d+";\n      int texR = index / "+u+";\n      int texC = index - texR * "+u+";\n      vec2 uv = (vec2(texC, texR) + halfCR) / vec2("+u+", "+s+");\n      return "+Ti().texture2D+"("+r+", uv);\n    }\n  "}(e)}}(t):function t(e){var n=e.shapeInfo.logicalShape;switch(n.length){case 0:return function(t){var e=t.name,n="get"+e.charAt(0).toUpperCase()+e.slice(1);if(t.shapeInfo.isUniform)return"float "+n+"() {return "+e+";}";var r=t.shapeInfo.texShape;if(1===r[0]&&1===r[1])return"\n      float "+n+"() {\n        return sampleTexture("+e+", halfCR);\n      }\n    ";var i=t.shapeInfo.texShape;return"\n    float "+n+"() {\n      vec2 uv = uvFromFlat("+i[0]+", "+i[1]+", "+Li(e)+");\n      return sampleTexture("+e+", uv);\n    }\n  "}(e);case 1:return function(t){var e=t.name,n="get"+e.charAt(0).toUpperCase()+e.slice(1);if(t.shapeInfo.isUniform)return"\n      float "+n+"(int index) {\n        "+Bi(t)+"\n      }\n    ";var r=t.shapeInfo.texShape,i=r[0],o=r[1];if(1===o&&1===i)return"\n      float "+n+"(int index) {\n        return sampleTexture("+e+", halfCR);\n      }\n    ";var a=Li(e);return 1===o?"\n      float "+n+"(int index) {\n        vec2 uv = vec2(0.5, (float(index + "+a+") + 0.5) / "+i+".0);\n        return sampleTexture("+e+", uv);\n      }\n    ":1===i?"\n      float "+n+"(int index) {\n        vec2 uv = vec2((float(index + "+a+") + 0.5) / "+o+".0, 0.5);\n        return sampleTexture("+e+", uv);\n      }\n    ":"\n    float "+n+"(int index) {\n      vec2 uv = uvFromFlat("+i+", "+o+", index + "+a+");\n      return sampleTexture("+e+", uv);\n    }\n  "}(e);case 2:return function(e){var n=e.shapeInfo.logicalShape,r=e.name,i="get"+r.charAt(0).toUpperCase()+r.slice(1),o=e.shapeInfo.texShape;if(null!=o&&b(n,o))return"\n    float "+i+"(int row, int col) {\n      vec2 uv = (vec2(col, row) + halfCR) / vec2("+o[1]+".0, "+o[0]+".0);\n      return sampleTexture("+r+", uv);\n    }\n  ";var a=O(n),s=a.newShape,u=a.keptDims;if(s.length<n.length){var l=$i(e,s);return"\n      "+t(l)+"\n      float "+i+"(int row, int col) {\n        return "+i+"("+Vi(["row","col"],u)+");\n      }\n    "}if(e.shapeInfo.isUniform)return"\n      float "+i+"(int row, int col) {\n        int index = round(dot(vec2(row, col), vec2("+n[1]+", 1)));\n        "+Bi(e)+"\n      }\n    ";var c=o[0],h=o[1],d=Li(r);return 1===h?"\n    float "+i+"(int row, int col) {\n      float index = dot(vec3(row, col, "+d+"), vec3("+n[1]+", 1, 1));\n      vec2 uv = vec2(0.5, (index + 0.5) / "+c+".0);\n      return sampleTexture("+r+", uv);\n    }\n  ":1===c?"\n    float "+i+"(int row, int col) {\n      float index = dot(vec3(row, col, "+d+"), vec3("+n[1]+", 1, 1));\n      vec2 uv = vec2((index + 0.5) / "+h+".0, 0.5);\n      return sampleTexture("+r+", uv);\n    }\n  ":"\n  float "+i+"(int row, int col) {\n    // Explicitly use integer operations as dot() only works on floats.\n    int index = row * "+n[1]+" + col + "+d+";\n    vec2 uv = uvFromFlat("+c+", "+h+", index);\n    return sampleTexture("+r+", uv);\n  }\n"}(e);case 3:return function(e){var n=e.shapeInfo.logicalShape,r=e.name,i="get"+r.charAt(0).toUpperCase()+r.slice(1),o=n[1]*n[2],a=n[2],s=O(n),u=s.newShape,l=s.keptDims;if(u.length<n.length){var c=$i(e,u);return"\n        "+t(c)+"\n        float "+i+"(int row, int col, int depth) {\n          return "+i+"("+Vi(["row","col","depth"],l)+");\n        }\n      "}if(e.shapeInfo.isUniform)return"\n      float "+i+"(int row, int col, int depth) {\n        int index = round(dot(vec3(row, col, depth),\n                          vec3("+o+", "+a+", 1)));\n        "+Bi(e)+"\n      }\n    ";var h=e.shapeInfo.texShape,d=h[0],f=h[1],p=e.shapeInfo.flatOffset;return f===o&&null==p?"\n        float "+i+"(int row, int col, int depth) {\n          float texR = float(row);\n          float texC = dot(vec2(col, depth), vec2("+a+", 1));\n          vec2 uv = (vec2(texC, texR) + halfCR) /\n                     vec2("+f+".0, "+d+".0);\n          return sampleTexture("+r+", uv);\n        }\n      ":f===a&&null==p?"\n    float "+i+"(int row, int col, int depth) {\n      float texR = dot(vec2(row, col), vec2("+n[1]+", 1));\n      float texC = float(depth);\n      vec2 uv = (vec2(texC, texR) + halfCR) / vec2("+f+".0, "+d+".0);\n      return sampleTexture("+r+", uv);\n    }\n  ":"\n      float "+i+"(int row, int col, int depth) {\n        // Explicitly use integer operations as dot() only works on floats.\n        int index = row * "+o+" + col * "+a+" + depth + "+Li(r)+";\n        vec2 uv = uvFromFlat("+d+", "+f+", index);\n        return sampleTexture("+r+", uv);\n      }\n  "}(e);case 4:return function(e){var n=e.shapeInfo.logicalShape,r=e.name,i="get"+r.charAt(0).toUpperCase()+r.slice(1),o=n[3],a=n[2]*o,s=n[1]*a,u=O(n),l=u.newShape,c=u.keptDims;if(l.length<n.length){var h=$i(e,l);return"\n      "+t(h)+"\n      float "+i+"(int row, int col, int depth, int depth2) {\n        return "+i+"("+Vi(["row","col","depth","depth2"],c)+");\n      }\n    "}if(e.shapeInfo.isUniform)return"\n      float "+i+"(int row, int col, int depth, int depth2) {\n        int index = round(dot(vec4(row, col, depth, depth2),\n                          vec4("+s+", "+a+", "+o+", 1)));\n        "+Bi(e)+"\n      }\n    ";var d=e.shapeInfo.flatOffset,f=e.shapeInfo.texShape,p=f[0],m=f[1];return m===s&&null==d?"\n      float "+i+"(int row, int col, int depth, int depth2) {\n        float texR = float(row);\n        float texC =\n            dot(vec3(col, depth, depth2),\n                vec3("+a+", "+o+", 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2("+m+".0, "+p+".0);\n        return sampleTexture("+r+", uv);\n      }\n    ":m===o&&null==d?"\n      float "+i+"(int row, int col, int depth, int depth2) {\n        float texR = dot(vec3(row, col, depth),\n                         vec3("+n[1]*n[2]+", "+n[2]+", 1));\n        float texC = float(depth2);\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2("+m+".0, "+p+".0);\n        return sampleTexture("+r+", uv);\n      }\n    ":"\n    float "+i+"(int row, int col, int depth, int depth2) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * "+s+" + col * "+a+" +\n          depth * "+o+" + depth2;\n      vec2 uv = uvFromFlat("+p+", "+m+", index + "+Li(r)+");\n      return sampleTexture("+r+", uv);\n    }\n  "}(e);case 5:return function(e){var n=e.shapeInfo.logicalShape,r=e.name,i="get"+r.charAt(0).toUpperCase()+r.slice(1),o=n[4],a=n[3]*o,s=n[2]*a,u=n[1]*s,l=O(n),c=l.newShape,h=l.keptDims;if(c.length<n.length){var d=$i(e,c);return"\n      "+t(d)+"\n      float "+i+"(int row, int col, int depth, int depth2, int depth3) {\n        return "+i+"("+Vi(["row","col","depth","depth2","depth3"],h)+");\n      }\n    "}if(e.shapeInfo.isUniform)return"\n      float "+i+"(int row, int col, int depth, int depth2, int depth3) {\n        float index = dot(\n          vec4(row, col, depth, depth2),\n          vec4("+u+", "+s+", "+a+", "+o+")) +\n          depth3;\n        "+Bi(e)+"\n      }\n    ";var f=e.shapeInfo.flatOffset,p=e.shapeInfo.texShape,m=p[0],g=p[1];return g===u&&null==f?"\n      float "+i+"(int row, int col, int depth, int depth2, int depth3) {\n        int texR = row;\n        float texC = dot(vec4(col, depth, depth2, depth3),\n                         vec4("+s+", "+a+", "+o+", 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2("+g+".0, "+m+".0);\n        return sampleTexture("+r+", uv);\n      }\n    ":g===o&&null==f?"\n      float "+i+"(int row, int col, int depth, int depth2, int depth3) {\n        float texR = dot(\n          vec4(row, col, depth, depth2),\n          vec4("+n[1]*n[2]*n[3]+",\n               "+n[2]*n[3]+", "+n[3]+", 1));\n        int texC = depth3;\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2("+g+".0, "+m+".0);\n        return sampleTexture("+r+", uv);\n      }\n    ":"\n    float "+i+"(int row, int col, int depth, int depth2, int depth3) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * "+u+" + col * "+s+" + depth * "+a+" +\n          depth2 * "+o+" + depth3 + "+Li(r)+";\n      vec2 uv = uvFromFlat("+m+", "+g+", index);\n      return sampleTexture("+r+", uv);\n    }\n  "}(e);case 6:return function(e){var n=e.shapeInfo.logicalShape,r=e.name,i="get"+r.charAt(0).toUpperCase()+r.slice(1),o=O(n),a=o.newShape,s=o.keptDims;if(a.length<n.length){var u=$i(e,a);return"\n      "+t(u)+"\n      float "+i+"(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        return "+i+"("+Vi(["row","col","depth","depth2","depth3","depth4"],s)+");\n      }\n    "}var l=n[5],c=n[4]*l,h=n[3]*c,d=n[2]*h,f=n[1]*d;if(e.shapeInfo.isUniform)return"\n      float "+i+"(int row, int col, int depth,\n                  int depth2, int depth3, int depth4) {\n        int index = round(dot(\n          vec4(row, col, depth, depth2),\n          vec4("+f+", "+d+", "+h+", "+c+")) +\n          dot(\n            vec2(depth3, depth4),\n            vec2("+l+", 1)));\n        "+Bi(e)+"\n      }\n    ";var p=e.shapeInfo.flatOffset,m=e.shapeInfo.texShape,g=m[0],y=m[1];return y===f&&null==p?"\n      float "+i+"(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        int texR = row;\n        float texC = dot(vec4(col, depth, depth2, depth3),\n          vec4("+d+", "+h+", "+c+", "+l+")) +\n               float(depth4);\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2("+y+".0, "+g+".0);\n        return sampleTexture("+r+", uv);\n      }\n    ":y===l&&null==p?"\n      float "+i+"(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        float texR = dot(vec4(row, col, depth, depth2),\n          vec4("+n[1]*n[2]*n[3]*n[4]+",\n               "+n[2]*n[3]*n[4]+",\n               "+n[3]*n[4]+",\n               "+n[4]+")) + float(depth3);\n        int texC = depth4;\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2("+y+".0, "+g+".0);\n        return sampleTexture("+r+", uv);\n      }\n    ":"\n    float "+i+"(int row, int col, int depth,\n                  int depth2, int depth3, int depth4) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * "+f+" + col * "+d+" + depth * "+h+" +\n          depth2 * "+c+" + depth3 * "+l+" + depth4 + "+Li(r)+";\n      vec2 uv = uvFromFlat("+g+", "+y+", index);\n      return sampleTexture("+r+", uv);\n    }\n  "}(e);default:throw new Error(n.length+"-D input sampling is not yet supported")}}(t),t.shapeInfo.logicalShape.length<=e.logicalShape.length&&(r+=n?function(t,e){var n,r,i=t.name,o=i.charAt(0).toUpperCase()+i.slice(1),a="get"+o+"AtOutCoords",s=t.shapeInfo.logicalShape.length,u=e.logicalShape.length,l=Yr(t.shapeInfo.logicalShape,e.logicalShape),c=Ui(u),h=u-s,d=["x","y","z","w","u","v"];n=0===s?"":u<2&&l.length>=1?"coords = 0;":l.map((function(t){return"coords."+d[t+h]+" = 0;"})).join("\n"),r=u<2&&s>0?"coords":t.shapeInfo.logicalShape.map((function(t,e){return"coords."+d[e+h]})).join(", ");var f="return outputValue;",p=1===v(t.shapeInfo.logicalShape),m=1===v(e.logicalShape);if(1!==s||p||m){if(p&&!m)f=1===u?"\n        return vec4(outputValue.x, outputValue.x, 0., 0.);\n      ":"\n        return vec4(outputValue.x);\n      ";else if(l.length){var g=s-2,y=s-1;l.indexOf(g)>-1&&l.indexOf(y)>-1?f="return vec4(outputValue.x);":l.indexOf(g)>-1?f="return vec4(outputValue.x, outputValue.y, outputValue.x, outputValue.y);":l.indexOf(y)>-1&&(f="return vec4(outputValue.xx, outputValue.zz);")}}else f="\n      return vec4(outputValue.xy, outputValue.xy);\n    ";return"\n    vec4 "+a+"() {\n      "+c+" coords = getOutputCoords();\n      "+n+"\n      vec4 outputValue = get"+o+"("+r+");\n      "+f+"\n    }\n  "}(t,e):function(t,e){var n=t.name,r=n.charAt(0).toUpperCase()+n.slice(1),i="get"+r+"AtOutCoords",o=t.shapeInfo.logicalShape.length,a=e.logicalShape.length;if(!t.shapeInfo.isUniform&&o===a&&null==t.shapeInfo.flatOffset&&b(t.shapeInfo.texShape,e.texShape))return"\n      float "+i+"() {\n        return sampleTexture("+n+", resultUV);\n      }\n    ";var s=Ui(a),u=Yr(t.shapeInfo.logicalShape,e.logicalShape),l=a-o,c=["x","y","z","w","u","v"];return"\n    float "+i+"() {\n      "+s+" coords = getOutputCoords();\n      "+(0===o?"":a<2&&u.length>=1?"coords = 0;":u.map((function(t){return"coords."+c[t+l]+" = 0;"})).join("\n"))+"\n      return get"+r+"("+(a<2&&o>0?"coords":t.shapeInfo.logicalShape.map((function(t,e){return"coords."+c[e+l]})).join(", "))+");\n    }\n  "}(t,e)),r}(t,e,r)})).join("\n"),l=e.texShape,c=Ti(),h=function(t){return"\n    float sampleTexture(sampler2D textureSampler, vec2 uv) {\n      return "+t.texture2D+"(textureSampler, uv).r;\n    }\n  "}(c),d=function(t){return t.version+"\n    precision highp float;\n    precision highp int;\n    precision highp sampler2D;\n    "+t.varyingFs+" vec2 resultUV;\n    "+t.defineOutput+"\n    const vec2 halfCR = vec2(0.5, 0.5);\n\n    struct ivec5\n    {\n      int x;\n      int y;\n      int z;\n      int w;\n      int u;\n    };\n\n    struct ivec6\n    {\n      int x;\n      int y;\n      int z;\n      int w;\n      int u;\n      int v;\n    };\n\n    uniform float NAN;\n    "+t.defineSpecialNaN+"\n    "+t.defineSpecialInf+"\n    "+t.defineRound+"\n\n    int imod(int x, int y) {\n      return x - y * (x / y);\n    }\n\n    int idiv(int a, int b, float sign) {\n      int res = a / b;\n      int mod = imod(a, b);\n      if (sign < 0. && mod != 0) {\n        res -= 1;\n      }\n      return res;\n    }\n\n    //Based on the work of Dave Hoskins\n    //https://www.shadertoy.com/view/4djSRW\n    #define HASHSCALE1 443.8975\n    float random(float seed){\n      vec2 p = resultUV * seed;\n      vec3 p3  = fract(vec3(p.xyx) * HASHSCALE1);\n      p3 += dot(p3, p3.yzx + 19.19);\n      return fract((p3.x + p3.y) * p3.z);\n    }\n\n    "+Fi+"\n    "+Pi+"\n    "+ji+"\n  "}(c);return e.isPacked?(o=function(t,e){switch(t.length){case 0:return"\n    int getOutputCoords() {\n      return 0;\n    }\n  ";case 1:return function(t,e){var n=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)];return 1===n[0]?"\n      int getOutputCoords() {\n        return 2 * int(resultUV.x * "+n[1]+".0);\n      }\n    ":1===n[1]?"\n      int getOutputCoords() {\n        return 2 * int(resultUV.y * "+n[0]+".0);\n      }\n    ":"\n    int getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2("+n[0]+", "+n[1]+"));\n      return 2 * (resTexRC.x * "+n[1]+" + resTexRC.y);\n    }\n  "}(0,e);case 2:return function(t,e){var n=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)];if(b(t,e))return"\n      ivec2 getOutputCoords() {\n        return 2 * ivec2(resultUV.yx * vec2("+n[0]+", "+n[1]+"));\n      }\n    ";var r=Math.ceil(t[1]/2);return"\n    ivec2 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2("+n[0]+", "+n[1]+"));\n\n      int index = resTexRC.x * "+n[1]+" + resTexRC.y;\n      int r = 2 * (index / "+r+");\n      int c = imod(index, "+r+") * 2;\n\n      return ivec2(r, c);\n    }\n  "}(t,e);case 3:return n=t,r=e,i=[Math.ceil(r[0]/2),Math.ceil(r[1]/2)],a=(o=Math.ceil(n[2]/2))*Math.ceil(n[1]/2),"\n    ivec3 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2("+i[0]+", "+i[1]+"));\n      int index = resTexRC.x * "+i[1]+" + resTexRC.y;\n\n      int b = index / "+a+";\n      index -= b * "+a+";\n\n      int r = 2 * (index / "+o+");\n      int c = imod(index, "+o+") * 2;\n\n      return ivec3(b, r, c);\n    }\n  ";default:return function(t,e){for(var n=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)],r=Math.ceil(t[t.length-1]/2),i=r*Math.ceil(t[t.length-2]/2),o=i,a="",s="b, r, c",u=2;u<t.length-1;u++)a="\n      int b"+u+" = index / "+(o*=t[t.length-u-1])+";\n      index -= b"+u+" * "+o+";\n    "+a,s="b"+u+", "+s;return"\n    ivec"+t.length+" getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2("+n[0]+", "+n[1]+"));\n      int index = resTexRC.x * "+n[1]+" + resTexRC.y;\n\n      "+a+"\n\n      int b = index / "+i+";\n      index -= b * "+i+";\n\n      int r = 2 * (index / "+r+");\n      int c = imod(index, "+r+") * 2;\n\n      return ivec"+t.length+"("+s+");\n    }\n  "}(t,e)}var n,r,i,o,a}(e.logicalShape,l),a=function(t){return"\n    void setOutput(vec4 val) {\n      "+t.output+" = val;\n    }\n  "}(c)):(o=function(t,e){switch(t.length){case 0:return"\n    int getOutputCoords() {\n      return 0;\n    }\n  ";case 1:return function(t,e){return 1===e[0]?"\n      int getOutputCoords() {\n        return int(resultUV.x * "+e[1]+".0);\n      }\n    ":1===e[1]?"\n      int getOutputCoords() {\n        return int(resultUV.y * "+e[0]+".0);\n      }\n    ":"\n    int getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2("+e[0]+", "+e[1]+"));\n      return resTexRC.x * "+e[1]+" + resTexRC.y;\n    }\n  "}(0,e);case 2:return function(t,e){return b(t,e)?"\n      ivec2 getOutputCoords() {\n        return ivec2(resultUV.yx * vec2("+e[0]+", "+e[1]+"));\n      }\n    ":1===t[1]?"\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2("+e[0]+", "+e[1]+"));\n        int index = resTexRC.x * "+e[1]+" + resTexRC.y;\n        return ivec2(index, 0);\n      }\n    ":1===t[0]?"\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2("+e[0]+", "+e[1]+"));\n        int index = resTexRC.x * "+e[1]+" + resTexRC.y;\n        return ivec2(0, index);\n      }\n    ":"\n    ivec2 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2("+e[0]+", "+e[1]+"));\n      int index = resTexRC.x * "+e[1]+" + resTexRC.y;\n      int r = index / "+t[1]+";\n      int c = index - r * "+t[1]+";\n      return ivec2(r, c);\n    }\n  "}(t,e);case 3:return n=e,r=Di(["r","c","d"],t),"\n    ivec3 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2("+n[0]+", "+n[1]+"));\n      int index = resTexRC.x * "+n[1]+" + resTexRC.y;\n      "+r+"\n      return ivec3(r, c, d);\n    }\n  ";case 4:return function(t,e){var n=Di(["r","c","d","d2"],t);return"\n    ivec4 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n        vec2("+e[0]+", "+e[1]+"));\n      int index = resTexRC.x * "+e[1]+" + resTexRC.y;\n      "+n+"\n      return ivec4(r, c, d, d2);\n    }\n  "}(t,e);case 5:return function(t,e){var n=Di(["r","c","d","d2","d3"],t);return"\n    ivec5 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx * vec2("+e[0]+",\n                             "+e[1]+"));\n\n      int index = resTexRC.x * "+e[1]+" + resTexRC.y;\n\n      "+n+"\n\n      ivec5 outShape = ivec5(r, c, d, d2, d3);\n      return outShape;\n    }\n  "}(t,e);case 6:return function(t,e){var n=Di(["r","c","d","d2","d3","d4"],t);return"\n    ivec6 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n        vec2("+e[0]+", "+e[1]+"));\n      int index = resTexRC.x * "+e[1]+" + resTexRC.y;\n\n      "+n+"\n\n      ivec6 result = ivec6(r, c, d, d2, d3, d4);\n      return result;\n    }\n  "}(t,e);default:throw new Error(t.length+"-D output sampling is not yet supported")}var n,r}(e.logicalShape,l),a=function(t){return"\n    void setOutput(float val) {\n      "+t.output+" = vec4(val, 0, 0, 0);\n    }\n  "}(c)),r&&(d+=zi),[d,h,a,s,o,u,n].join("\n")}var Fi="\nvec2 uvFromFlat(int texNumR, int texNumC, int index) {\n  int texR = index / texNumC;\n  int texC = index - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\nvec2 packedUVfrom1D(int texNumR, int texNumC, int index) {\n  int texelIndex = index / 2;\n  int texR = texelIndex / texNumC;\n  int texC = texelIndex - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n",Pi="\nvec2 packedUVfrom2D(int texelsInLogicalRow, int texNumR,\n  int texNumC, int row, int col) {\n  int texelIndex = (row / 2) * texelsInLogicalRow + (col / 2);\n  int texR = texelIndex / texNumC;\n  int texC = texelIndex - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n",ji="\nvec2 packedUVfrom3D(int texNumR, int texNumC,\n    int texelsInBatch, int texelsInLogicalRow, int b,\n    int row, int col) {\n  int index = b * texelsInBatch + (row / 2) * texelsInLogicalRow + (col / 2);\n  int texR = index / texNumC;\n  int texC = index - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n",zi="\n  float getChannel(vec4 frag, vec2 innerDims) {\n    vec2 modCoord = mod(innerDims, 2.);\n    return modCoord.x == 0. ?\n      (modCoord.y == 0. ? frag.r : frag.g) :\n      (modCoord.y == 0. ? frag.b : frag.a);\n  }\n  float getChannel(vec4 frag, int dim) {\n    float modCoord = mod(float(dim), 2.);\n    return modCoord == 0. ? frag.r : frag.g;\n  }\n";function Li(t){return"offset"+t}function Bi(t){var e=t.name,n=v(t.shapeInfo.logicalShape);return n<2?"return "+e+";":"\n    for (int i = 0; i < "+n+"; i++) {\n      if (i == index) {\n        return "+e+"[i];\n      }\n    }\n  "}function Ui(t){if(t<=1)return"int";if(2===t)return"ivec2";if(3===t)return"ivec3";if(4===t)return"ivec4";if(5===t)return"ivec5";if(6===t)return"ivec6";throw Error("GPU for rank "+t+" is not yet supported")}function $i(t,e){var n=JSON.parse(JSON.stringify(t));return n.shapeInfo.logicalShape=e,n}function Vi(t,e){return e.map((function(e){return t[e]})).join(", ")}var Wi=function(t,e,n,r){this.variableNames=["A"],this.usesPackedTextures=!0,p(t.length>2,(function(){return"Packed arg"+(n.charAt(0).toUpperCase()+n.slice(1))+" supports only inputs with rank above 2."}));var i=Math.ceil(t[t.length-1]/e);this.outputShape=t.slice(0,-1),i>1&&this.outputShape.push(i),r||this.variableNames.push("bestIndicesA");var o,a,s=this.outputShape,u=s.length,l=Ui(u),c=Ni("coords",u);if(1===i){var h=Ui(a=u+1);o="\n        "+h+" sourceLocR = "+h+"("+c.join()+", 0);\n        ++"+c[u-1]+";\n        "+h+" sourceLocG = "+h+"("+c.join()+", 0);\n        ++"+c[u-2]+";\n        "+h+" sourceLocA = "+h+"("+c.join()+", 0);\n        --"+c[u-1]+";\n        "+h+" sourceLocB = "+h+"("+c.join()+", 0);\n        --"+c[u-2]+";"}else a=u,o="\n        "+l+" sourceLocR = coords;\n        ++"+c[u-1]+";\n        "+l+" sourceLocG = coords;\n        ++"+c[u-2]+";\n        "+l+" sourceLocA = coords;\n        --"+c[u-1]+";\n        "+l+" sourceLocB = coords;\n        --"+c[u-2]+";";var d=["x","y","z","w","u","v"].slice(0,a),f="."+d[a-1],m=d.map((function(t){return"int "+t})),g=Ni("sourceLocR",a-1).concat("inIdx.r"),y=Ni("sourceLocG",a-1).concat("inIdx.g"),v=Ni("sourceLocB",a-1).concat("inIdx.b"),b=Ni("sourceLocA",a-1).concat("inIdx.a"),w="max"===n?"greaterThan":"lessThan",x=r?"":"\n          inIdx = round(vec4(getBestIndicesAChannel("+g.join()+"),\n                             getBestIndicesAChannel("+y.join()+"),\n                             getBestIndicesAChannel("+v.join()+"),\n                             getBestIndicesAChannel("+b.join()+")));",_="vec4(\n            getAChannel("+g.join()+"),\n            hasNextCol ? getAChannel("+y.join()+") : 0.,\n            hasNextRow ? getAChannel("+v.join()+") : 0.,\n            hasNextRow && hasNextCol ? getAChannel("+b.join()+") : 0.)",C=r?"":"\n      float getBestIndicesAChannel("+m.join()+") {\n        return getChannel(getBestIndicesA("+d.join()+"),\n                                          vec2("+d.slice(-2).join()+"));\n      }";this.userCode="\n      float getAChannel("+m.join()+") {\n        return getChannel(getA("+d.join()+"),\n                               vec2("+d.slice(-2).join()+"));\n      }\n      "+C+"\n      void main() {\n        "+l+" coords = getOutputCoords();\n        bool hasNextCol = "+c[u-1]+" < "+(s[u-1]-1)+";\n        bool hasNextRow = "+c[u-2]+" < "+(s[u-2]-1)+";\n        "+o+"\n        ivec4 srcIdx = ivec4(sourceLocR"+f+", sourceLocG"+f+",\n          sourceLocB"+f+", sourceLocA"+f+") * "+e+";\n        ivec4 inIdx = srcIdx;\n        vec4 bestIndex = vec4(inIdx);\n        vec4 bestValue = "+_+";\n\n        for (int i = 0; i < "+e+"; i++) {\n          inIdx = srcIdx;\n          "+x+"\n          vec4 candidate = "+_+";\n          bvec4 nan = isnan(candidate);\n          bvec4 replace = bvec4(\n            vec4("+w+"(candidate, bestValue)) * (vec4(1.0) - vec4(nan)));\n\n          bestValue = vec4(replace.x  ? candidate.x : bestValue.x,\n                           replace.y  ? candidate.y : bestValue.y,\n                           replace.z  ? candidate.z : bestValue.z,\n                           replace.w  ? candidate.w : bestValue.w);\n          bestIndex = mix(bestIndex, vec4(inIdx), vec4(replace));\n          srcIdx++;\n        }\n        setOutput(bestIndex);\n      }\n    "},qi=function(t){this.variableNames=["dy"],this.outputShape=t.inShape;var e=t.effectiveFilterHeight,n=t.effectiveFilterWidth;this.userCode="\n      const ivec2 pads = ivec2("+(e-1-t.padInfo.top)+", "+(n-1-t.padInfo.left)+");\n      const float avgMultiplier = float("+1/(t.filterHeight*t.filterWidth)+");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n\n        ivec2 dyRCCorner = coords.yz - pads;\n        int dyRCorner = dyRCCorner.x;\n        int dyCCorner = dyRCCorner.y;\n\n        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < "+e+";\n            wR += "+t.dilationHeight+") {\n          float dyR = float(dyRCorner + wR) / "+t.strideHeight+".0;\n\n          if (dyR < 0.0 || dyR >= "+t.outHeight+".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          for (int wC = 0; wC < "+n+";\n            wC+= "+t.dilationWidth+") {\n            float dyC = float(dyCCorner + wC) / "+t.strideWidth+".0;\n\n            if (dyC < 0.0 || dyC >= "+t.outWidth+".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            float dyValue = getDy(b, idyR, idyC, d);\n\n            dotProd += dyValue * avgMultiplier;\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},Hi=function(t){this.variableNames=["dy"],this.outputShape=t.inShape;var e=t.effectiveFilterDepth,n=t.effectiveFilterHeight,r=t.effectiveFilterWidth;this.userCode="\n      const ivec3 pads = ivec3("+(e-1-t.padInfo.front)+", "+(n-1-t.padInfo.top)+", "+(r-1-t.padInfo.left)+");\n      const float avgMultiplier = float("+1/(t.filterDepth*t.filterHeight*t.filterWidth)+");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyDCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        // Convolve dy(?, ?, ?, d) with pos mask(:, :, :, ch) to get\n        // dx(xD, xR, xC, ch).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int wD = 0; wD < "+e+";\n            wD += "+t.dilationDepth+") {\n          float dyD = float(dyDCorner + wD) / "+t.strideDepth+".0;\n\n          if (dyD < 0.0 || dyD >= "+t.outDepth+".0 || fract(dyD) > 0.0) {\n            continue;\n          }\n          int idyD = int(dyD);\n\n          for (int wR = 0; wR < "+n+";\n              wR += "+t.dilationHeight+") {\n            float dyR = float(dyRCorner + wR) / "+t.strideHeight+".0;\n\n            if (dyR < 0.0 || dyR >= "+t.outHeight+".0 ||\n                fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            for (int wC = 0; wC < "+r+";\n                wC += "+t.dilationWidth+") {\n              float dyC = float(dyCCorner + wC) / "+t.strideWidth+".0;\n\n              if (dyC < 0.0 || dyC >= "+t.outWidth+".0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              float dyValue = getDy(batch, idyD, idyR, idyC, ch);\n\n              dotProd += dyValue * avgMultiplier;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},Gi=function(t,e,n,r,i,o){this.outputShape=[],this.variableNames=["x","mean","variance"],Qr(t,e),Qr(t,n);var a="0.0";null!=r&&(Qr(t,r),this.variableNames.push("offset"),a="getOffsetAtOutCoords()");var s="1.0";null!=i&&(Qr(t,i),this.variableNames.push("scale"),s="getScaleAtOutCoords()"),this.outputShape=t,this.userCode="\n      void main() {\n        float x = getXAtOutCoords();\n        float mean = getMeanAtOutCoords();\n        float variance = getVarianceAtOutCoords();\n        float offset = "+a+";\n        float scale = "+s+";\n        float inv = scale * inversesqrt(variance + float("+o+"));\n        setOutput(dot(vec3(x, -mean, offset), vec3(inv, inv, 1)));\n      }\n    "},Xi=function(t,e,n,r,i,o){this.usesPackedTextures=!0,this.variableNames=["x","mean","variance"],Qr(t,e),Qr(t,n);var a="vec4(0.0)";null!=r&&(Qr(t,r),this.variableNames.push("offset"),a="getOffsetAtOutCoords()");var s="vec4(1.0)";null!=i&&(Qr(t,i),this.variableNames.push("scale"),s="getScaleAtOutCoords()"),this.outputShape=t,this.userCode="\n      void main() {\n        vec4 offset = "+a+";\n        vec4 scale = "+s+";\n\n        vec4 x = getXAtOutCoords();\n        vec4 mean = getMeanAtOutCoords();\n        vec4 variance = getVarianceAtOutCoords();\n\n        vec4 inv = scale * inversesqrt(variance + vec4("+o+"));\n\n        setOutput((x - mean) * inv + offset);\n      }\n    "},Ki=function(t,e,n){this.variableNames=["AReal","AImag","BReal","BImag"],this.outputShape=Qr(e,n),this.userCode="\n      float binaryOpComplex(\n          float areal, float aimag, float breal, float bimag) {\n        "+t+"\n      }\n\n      void main() {\n        float areal = getARealAtOutCoords();\n        float aimag = getAImagAtOutCoords();\n        float breal = getBRealAtOutCoords();\n        float bimag = getBImagAtOutCoords();\n        setOutput(binaryOpComplex(areal, aimag, breal, bimag));\n      }\n    "},Yi="return a + b;",Zi="return a - b;",Qi="return a * b;",Ji="return (a < 0.) ? b * a : a;",to=function(t,e,n){this.variableNames=["A","B"],this.outputShape=Qr(e,n),this.userCode="\n      float binaryOperation(float a, float b) {\n        "+t+"\n      }\n\n      void main() {\n        float a = getAAtOutCoords();\n        float b = getBAtOutCoords();\n        setOutput(binaryOperation(a, b));\n      }\n    "},eo="\n  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));\n  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);\n",no=function(t,e,n,r){void 0===r&&(r=!1),this.variableNames=["A","B"],this.supportsBroadcasting=!0,this.usesPackedTextures=!0,this.outputShape=Qr(e,n);var i=this.outputShape.length,o="";if(r)if(0===i||1===v(this.outputShape))o="\n          result.y = 0.;\n          result.z = 0.;\n          result.w = 0.;\n        ";else if(o="\n          "+Ui(i)+" coords = getOutputCoords();\n        ",1===i)o+="\n            result.y = (coords + 1) >= "+this.outputShape[0]+" ? 0. : result.y;\n            result.z = 0.;\n            result.w = 0.;\n          ";else{var a=Ni("coords",i);o+="\n            bool nextRowOutOfBounds =\n              ("+a[i-2]+" + 1) >= "+this.outputShape[i-2]+";\n            bool nextColOutOfBounds =\n              ("+a[i-1]+" + 1) >= "+this.outputShape[i-1]+";\n            result.y = nextColOutOfBounds ? 0. : result.y;\n            result.z = nextRowOutOfBounds ? 0. : result.z;\n            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;\n          "}this.userCode="\n      vec4 binaryOperation(vec4 a, vec4 b) {\n        "+t+"\n      }\n\n      void main() {\n        vec4 a = getAAtOutCoords();\n        vec4 b = getBAtOutCoords();\n\n        vec4 result = binaryOperation(a, b);\n        "+o+"\n\n        setOutput(result);\n      }\n    "},ro=function(){function t(t){this.variableNames=["A"],this.outputShape=t,this.userCode="\n      uniform float minVal;\n      uniform float maxVal;\n\n      void main() {\n        float value = getAAtOutCoords();\n        if (isnan(value)) {\n          setOutput(value);\n          return;\n        }\n\n        setOutput(clamp(value, minVal, maxVal));\n      }\n    "}return t.prototype.getCustomSetupFunc=function(t,e){var n=this;return function(r,i){null==n.minLoc&&(n.minLoc=r.getUniformLocationNoThrow(i,"minVal"),n.maxLoc=r.getUniformLocationNoThrow(i,"maxVal")),r.gl.uniform1f(n.minLoc,t),r.gl.uniform1f(n.maxLoc,e)}},t}(),io=function(){function t(t){this.variableNames=["A"],this.usesPackedTextures=!0,this.outputShape=t,this.userCode="\n      uniform float minVal;\n      uniform float maxVal;\n\n      void main() {\n        vec4 value = getAAtOutCoords();\n\n        if (any(isnan(value))) {\n          setOutput(value);\n          return;\n        }\n\n        setOutput(clamp(value, vec4(minVal), vec4(maxVal)));\n      }\n    "}return t.prototype.getCustomSetupFunc=function(t,e){var n=this;return function(r,i){null==n.minLoc&&(n.minLoc=r.getUniformLocationNoThrow(i,"minVal"),n.maxLoc=r.getUniformLocationNoThrow(i,"maxVal")),r.gl.uniform1f(n.minLoc,t),r.gl.uniform1f(n.maxLoc,e)}},t}(),oo=function(t){this.variableNames=["real","imag"],this.outputShape=t,this.userCode="\n      void main() {\n        float re = abs(getRealAtOutCoords());\n        float im = abs(getImagAtOutCoords());\n        float mx = max(re, im);\n\n        // sadly the length function in glsl is not underflow-safe\n        // (at least not on Intel GPUs). So the safe solution is\n        // to ensure underflow-safety in all cases.\n        setOutput(\n          mx == 0.0 ? 0.0 : mx * length(vec2(1, min(re, im)/mx))\n        );\n      }\n    "},ao=function(t){this.outputShape=[],this.outputShape=dn(t,1),this.variableNames=t.map((function(t,e){return"T"+e}));var e=new Array(t.length-1);e[0]=t[0][1];for(var n=1;n<e.length;n++)e[n]=e[n-1]+t[n][1];var r=["if (yC < "+e[0]+") setOutput(getT0(yR, yC));"];for(n=1;n<e.length;n++)r.push("else if (yC < "+e[n]+") setOutput(getT"+n+"(yR, yC-"+e[n-1]+"));");r.push("else setOutput(getT"+e.length+"(yR, yC-"+e[e.length-1]+"));"),this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int yR = coords.x;\n        int yC = coords.y;\n\n        "+r.join("\n        ")+"\n      }\n    "},so=function(t,e){this.usesPackedTextures=!0,this.outputShape=[],this.outputShape=dn(t,e);var n=this.outputShape,r=n.length,i=Ui(r),o=Ni("coords",r),a=["x","y","z","w","u","v"].slice(0,r);this.variableNames=t.map((function(t,e){return"T"+e}));var s=new Array(t.length-1);s[0]=t[0][e];for(var u=1;u<s.length;u++)s[u]=s[u-1]+t[u][e];var l=a[e],c=a.slice(-2),h=a.join(),d="if ("+l+" < "+s[0]+") {\n        return getChannel(\n            getT0("+h+"), vec2("+c.join()+"));\n        }";for(u=1;u<s.length;u++){var f=s[u-1];d+="\n        if ("+l+" < "+s[u]+"  && "+l+" >= "+s[u-1]+") {\n          return getChannel(\n            getT"+u+"("+uo(a,l,f)+"),\n            vec2("+uo(c,l,f)+"));\n        }"}var p=s[s.length-1];d+="\n        return getChannel(\n          getT"+s.length+"("+uo(a,l,p)+"),\n          vec2("+uo(c,l,p)+"));",this.userCode="\n      float getValue("+a.map((function(t){return"int "+t}))+") {\n        "+d+"\n      }\n\n      void main() {\n        "+i+" coords = getOutputCoords();\n        vec4 result = vec4(getValue("+o+"), 0., 0., 0.);\n\n        "+o[r-1]+" = "+o[r-1]+" + 1;\n        if ("+o[r-1]+" < "+n[r-1]+") {\n          result.g = getValue("+o+");\n        }\n\n        "+o[r-2]+" = "+o[r-2]+" + 1;\n        if ("+o[r-2]+" < "+n[r-2]+") {\n          result.a = getValue("+o+");\n        }\n\n        "+o[r-1]+" = "+o[r-1]+" - 1;\n        if ("+o[r-2]+" < "+n[r-2]+" &&\n            "+o[r-1]+" < "+n[r-1]+") {\n          result.b = getValue("+o+");\n        }\n        setOutput(result);\n      }\n    "};function uo(t,e,n){var r=t.indexOf(e);return t.map((function(t,e){return e===r?t+" - "+n:t})).join()}var lo=function(t){this.variableNames=["x","dy"],this.outputShape=t.filterShape,this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int wR = coords.x;\n        int wC = coords.y;\n        int d1 = coords.z;\n        int d2 = coords.w;\n\n        // Convolve x(?, ?, d1) with dy(:, :, d2) to get dw(wR, wC, d1, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int b = 0; b < "+t.batchSize+"; b++) {\n          for (int yR = 0; yR < "+t.outHeight+"; yR++) {\n            int xR = wR + yR * "+t.strideHeight+" - "+t.padInfo.top+";\n\n            if (xR < 0 || xR >= "+t.inHeight+") {\n              continue;\n            }\n\n            for (int yC = 0; yC < "+t.outWidth+"; yC++) {\n              int xC = wC + yC * "+t.strideWidth+" - "+t.padInfo.left+";\n\n              if (xC < 0 || xC >= "+t.inWidth+") {\n                continue;\n              }\n\n              if ("+("channelsLast"===t.dataFormat)+") {\n                float dyValue = getDy(b, yR, yC, d2);\n                float xValue = getX(b, xR, xC, d1);\n                dotProd += (xValue * dyValue);\n              } else {\n                float dyValue = getDy(b, d2, yR, yC);\n                float xValue = getX(b, d1, xR, xC);\n                dotProd += (xValue * dyValue);\n              }\n\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},co=function(t){this.variableNames=["dy","W"],this.outputShape=t.inShape;var e=t.filterHeight,n=t.filterWidth,r="channelsLast"===t.dataFormat;this.userCode="\n      const ivec2 pads = ivec2("+(e-1-t.padInfo.top)+", "+(n-1-t.padInfo.left)+");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d1 = coords["+(r?3:1)+"];\n\n        ivec2 dyCorner = ivec2(coords["+(r?1:2)+"], coords["+(r?2:3)+"]) - pads;\n        int dyRCorner = dyCorner.x;\n        int dyCCorner = dyCorner.y;\n\n        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < "+e+"; wR++) {\n          float dyR = float(dyRCorner + wR) / "+t.strideHeight+".0;\n\n          if (dyR < 0.0 || dyR >= "+t.outHeight+".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          int wRPerm = "+e+" - 1 - wR;\n\n          for (int wC = 0; wC < "+n+"; wC++) {\n            float dyC = float(dyCCorner + wC) / "+t.strideWidth+".0;\n\n            if (dyC < 0.0 || dyC >= "+t.outWidth+".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            int wCPerm = "+n+" - 1 - wC;\n\n            for (int d2 = 0; d2 < "+t.outChannels+"; d2++) {\n\n              if ("+r+") {\n                float xValue = getDy(batch, idyR, idyC, d2);\n                float wValue = getW(wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              } else {\n                float xValue = getDy(batch, d2, idyR, idyC);\n                float wValue = getW(wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              }\n\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},ho=function(t){this.variableNames=["x","dy"],this.outputShape=t.filterShape,this.userCode="\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int wF = coords.x;\n        int wR = coords.y;\n        int wC = coords.z;\n        int d1 = coords.w;\n        int d2 = coords.u;\n\n        float dotProd = 0.0;\n\n        for (int b = 0; b < "+t.batchSize+"; b++) {\n          for (int yF = 0; yF < "+t.outDepth+"; yF++) {\n            int xF = wF + yF * "+t.strideDepth+" - "+t.padInfo.front+";\n\n            if (xF < 0 || xF >= "+t.inDepth+") {\n              continue;\n            }\n\n            for (int yR = 0; yR < "+t.outHeight+"; yR++) {\n              int xR = wR + yR * "+t.strideHeight+" - "+t.padInfo.top+";\n\n              if (xR < 0 || xR >= "+t.inHeight+") {\n                continue;\n              }\n\n              for (int yC = 0; yC < "+t.outWidth+"; yC++) {\n                int xC = wC + yC * "+t.strideWidth+" - "+t.padInfo.left+";\n\n                if (xC < 0 || xC >= "+t.inWidth+") {\n                  continue;\n                }\n\n                float dyValue = getDy(b, yF, yR, yC, d2);\n                float xValue = getX(b, xF, xR, xC, d1);\n                dotProd += (xValue * dyValue);\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},fo=function(t){this.variableNames=["dy","W"],this.outputShape=t.inShape;var e=t.filterDepth,n=t.filterHeight,r=t.filterWidth;this.userCode="\n      const ivec3 pads = ivec3("+(e-1-t.padInfo.front)+", "+(n-1-t.padInfo.top)+", "+(r-1-t.padInfo.left)+");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int d1 = coords.u;\n\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyFCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        float dotProd = 0.0;\n        for (int wF = 0; wF < "+e+"; wF++) {\n          float dyF = float(dyFCorner + wF) / "+t.strideDepth+".0;\n\n          if (dyF < 0.0 || dyF >= "+t.outDepth+".0 || fract(dyF) > 0.0) {\n            continue;\n          }\n          int idyF = int(dyF);\n\n          int wFPerm = "+e+" - 1 - wF;\n\n          for (int wR = 0; wR < "+n+"; wR++) {\n            float dyR = float(dyRCorner + wR) / "+t.strideHeight+".0;\n\n            if (dyR < 0.0 || dyR >= "+t.outHeight+".0 ||\n              fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            int wRPerm = "+n+" - 1 - wR;\n\n            for (int wC = 0; wC < "+r+"; wC++) {\n              float dyC = float(dyCCorner + wC) / "+t.strideWidth+".0;\n\n              if (dyC < 0.0 || dyC >= "+t.outWidth+".0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              int wCPerm = "+r+" - 1 - wC;\n\n              for (int d2 = 0; d2 < "+t.outChannels+"; d2++) {\n                float xValue = getDy(batch, idyF, idyR, idyC, d2);\n                float wValue = getW(wFPerm, wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},po=function(t){this.variableNames=["x","dy"],this.outputShape=t.filterShape,this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int wR = coords.x;\n        int wC = coords.y;\n        int d1 = coords.z;\n        int dm = coords.w;\n        int d2 = d1 * "+t.outChannels/t.inChannels+" + dm;\n\n        float dotProd = 0.0;\n\n        // TO DO: Vec4 over the batch size\n        for (int b = 0; b < "+t.batchSize+"; b++) {\n          for (int yR = 0; yR < "+t.outHeight+"; yR++) {\n            int xR = wR + yR * "+t.strideHeight+" - "+t.padInfo.top+";\n\n            if (xR < 0 || xR >= "+t.inHeight+") {\n              continue;\n            }\n\n            for (int yC = 0; yC < "+t.outWidth+"; yC++) {\n              int xC = wC + yC * "+t.strideWidth+" - "+t.padInfo.left+";\n\n              if (xC < 0 || xC >= "+t.inWidth+") {\n                continue;\n              }\n\n              float dyValue = getDy(b, yR, yC, d2);\n              float xValue = getX(b, xR, xC, d1);\n              dotProd += (xValue * dyValue);\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},mo=function(t){this.variableNames=["dy","W"],this.outputShape=t.inShape;var e=t.filterHeight,n=t.filterWidth,r=t.outChannels/t.inChannels;this.userCode="\n      const ivec2 pads = ivec2("+(e-1-t.padInfo.top)+", "+(n-1-t.padInfo.left)+");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d1 = coords[3];\n        ivec2 dyCorner = coords.yz - pads;\n        int dyRCorner = dyCorner.x;\n        int dyCCorner = dyCorner.y;\n\n        float dotProd = 0.0;\n\n        for (int wR = 0; wR < "+e+"; wR++) {\n          float dyR = float(dyRCorner + wR) / "+t.strideHeight+".0;\n\n          if (dyR < 0.0 || dyR >= "+t.outHeight+".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          int wRPerm = "+e+" - 1 - wR;\n\n          for (int wC = 0; wC < "+n+"; wC++) {\n            float dyC = float(dyCCorner + wC) / "+t.strideWidth+".0;\n\n            if (dyC < 0.0 || dyC >= "+t.outWidth+".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            int wCPerm = "+n+" - 1 - wC;\n\n            // TO DO: Vec4 over the channelMul\n            for (int dm = 0; dm < "+r+"; dm++) {\n              int d2 = d1 * "+r+" + dm;\n              float xValue = getDy(batch, idyR, idyC, d2);\n              float wValue = getW(wRPerm, wCPerm, d1, dm);\n              dotProd += xValue * wValue;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},go=function(t,e,n,r){void 0===e&&(e=!1),void 0===n&&(n=null),void 0===r&&(r=!1),this.variableNames=["x","W"],this.outputShape=t.outShape;var i=t.padInfo.top,o=t.padInfo.left,a=t.strideHeight,s=t.strideWidth,u=t.dilationHeight,l=t.dilationWidth,c=t.filterHeight,h=t.filterWidth,d=4*Math.floor(t.inChannels/4),f=t.inChannels%4,p="channelsLast"===t.dataFormat,m=p?1:2,g=p?2:3,y=p?3:1,v="",b="";n&&(v=r?"float activation(float a) {\n          float b = getPreluActivationWeightsAtOutCoords();\n          "+n+"\n        }":"\n          float activation(float x) {\n            "+n+"\n          }\n        ",b="result = activation(result);");var w=e?"result += getBiasAtOutCoords();":"";e&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),this.userCode="\n      "+v+"\n\n      const ivec2 strides = ivec2("+a+", "+s+");\n      const ivec2 pads = ivec2("+i+", "+o+");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d2 = coords["+y+"];\n\n        ivec2 xRCCorner =\n            ivec2(coords["+m+"], coords["+g+"]) * strides - pads;\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // Convolve x(?, ?, d1) with w(:, :, d1, d2) to get y(yR, yC, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < "+c+"; wR++) {\n          int xR = xRCorner + wR * "+u+";\n\n          if (xR < 0 || xR >= "+t.inHeight+") {\n            continue;\n          }\n\n          for (int wC = 0; wC < "+h+"; wC++) {\n            int xC = xCCorner + wC * "+l+";\n\n            if (xC < 0 || xC >= "+t.inWidth+") {\n              continue;\n            }\n\n            for (int d1 = 0; d1 < "+d+"; d1 += 4) {\n              vec4 wValues = vec4(\n                getW(wR, wC, d1, d2),\n                getW(wR, wC, d1 + 1, d2),\n                getW(wR, wC, d1 + 2, d2),\n                getW(wR, wC, d1 + 3, d2)\n              );\n\n              if ("+p+") {\n                vec4 xValues = vec4(\n                  getX(batch, xR, xC, d1),\n                  getX(batch, xR, xC, d1 + 1),\n                  getX(batch, xR, xC, d1 + 2),\n                  getX(batch, xR, xC, d1 + 3)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec4 xValues = vec4(\n                  getX(batch, d1, xR, xC),\n                  getX(batch, d1 + 1, xR, xC),\n                  getX(batch, d1 + 2, xR, xC),\n                  getX(batch, d1 + 3, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n            }\n\n            if ("+(1===f)+") {\n\n              if ("+p+") {\n                dotProd +=\n                    getX(batch, xR, xC, "+d+") *\n                    getW(wR, wC, "+d+", d2);\n              } else {\n                dotProd +=\n                    getX(batch, "+d+", xR, xC) *\n                    getW(wR, wC, "+d+", d2);\n              }\n\n            } else if ("+(2===f)+") {\n              vec2 wValues = vec2(\n                getW(wR, wC, "+d+", d2),\n                getW(wR, wC, "+d+" + 1, d2)\n              );\n\n              if ("+p+") {\n                vec2 xValues = vec2(\n                  getX(batch, xR, xC, "+d+"),\n                  getX(batch, xR, xC, "+d+" + 1)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec2 xValues = vec2(\n                  getX(batch, "+d+", xR, xC),\n                  getX(batch, "+d+" + 1, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n\n            } else if ("+(3===f)+") {\n              vec3 wValues = vec3(\n                getW(wR, wC, "+d+", d2),\n                getW(wR, wC, "+d+" + 1, d2),\n                getW(wR, wC, "+d+" + 2, d2)\n              );\n\n              if ("+p+") {\n                vec3 xValues = vec3(\n                  getX(batch, xR, xC, "+d+"),\n                  getX(batch, xR, xC, "+d+" + 1),\n                  getX(batch, xR, xC, "+d+" + 2)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec3 xValues = vec3(\n                  getX(batch, "+d+", xR, xC),\n                  getX(batch, "+d+" + 1, xR, xC),\n                  getX(batch, "+d+" + 2, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n\n            }\n          }\n        }\n\n        float result = dotProd;\n        "+w+"\n        "+b+"\n        setOutput(result);\n      }\n    "},yo=function(t){this.variableNames=["x","W"],this.outputShape=t.outShape;var e=t.padInfo.front,n=t.padInfo.top,r=t.padInfo.left,i=t.strideDepth,o=t.strideHeight,a=t.strideWidth,s=t.dilationDepth,u=t.dilationHeight,l=t.dilationWidth,c=t.filterDepth,h=t.filterHeight,d=t.filterWidth,f=4*Math.floor(t.inChannels/4),p=t.inChannels%4;this.userCode="\n      const ivec3 strides = ivec3("+i+", "+o+", "+a+");\n      const ivec3 pads = ivec3("+e+", "+n+", "+r+");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int d2 = coords.u;\n\n        ivec3 xFRCCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n        int xFCorner = xFRCCorner.x;\n        int xRCorner = xFRCCorner.y;\n        int xCCorner = xFRCCorner.z;\n\n        // Convolve x(?, ?, ?, d1) with w(:, :, :, d1, d2) to get\n        // y(yF, yR, yC, d2). ? = to be determined. : = across all\n        // values in that axis.\n        float dotProd = 0.0;\n        for (int wF = 0; wF < "+c+"; wF++) {\n          int xF = xFCorner + wF * "+s+";\n\n          if (xF < 0 || xF >= "+t.inDepth+") {\n            continue;\n          }\n\n          for (int wR = 0; wR < "+h+"; wR++) {\n            int xR = xRCorner + wR * "+u+";\n\n            if (xR < 0 || xR >= "+t.inHeight+") {\n              continue;\n            }\n\n            for (int wC = 0; wC < "+d+"; wC++) {\n              int xC = xCCorner + wC * "+l+";\n\n              if (xC < 0 || xC >= "+t.inWidth+") {\n                continue;\n              }\n\n              for (int d1 = 0; d1 < "+f+"; d1 += 4) {\n                vec4 xValues = vec4(\n                  getX(batch, xF, xR, xC, d1),\n                  getX(batch, xF, xR, xC, d1 + 1),\n                  getX(batch, xF, xR, xC, d1 + 2),\n                  getX(batch, xF, xR, xC, d1 + 3)\n                );\n                vec4 wValues = vec4(\n                  getW(wF, wR, wC, d1, d2),\n                  getW(wF, wR, wC, d1 + 1, d2),\n                  getW(wF, wR, wC, d1 + 2, d2),\n                  getW(wF, wR, wC, d1 + 3, d2)\n                );\n\n                dotProd += dot(xValues, wValues);\n              }\n\n              if ("+(1===p)+") {\n                dotProd +=\n                  getX(batch, xF, xR, xC, "+f+") *\n                  getW(wF, wR, wC, "+f+", d2);\n              } else if ("+(2===p)+") {\n                vec2 xValues = vec2(\n                  getX(batch, xF, xR, xC, "+f+"),\n                  getX(batch, xF, xR, xC, "+f+" + 1)\n                );\n                vec2 wValues = vec2(\n                  getW(wF, wR, wC, "+f+", d2),\n                  getW(wF, wR, wC, "+f+" + 1, d2)\n                );\n                dotProd += dot(xValues, wValues);\n              } else if ("+(3===p)+") {\n                vec3 xValues = vec3(\n                  getX(batch, xF, xR, xC, "+f+"),\n                  getX(batch, xF, xR, xC, "+f+" + 1),\n                  getX(batch, xF, xR, xC, "+f+" + 2)\n                );\n                vec3 wValues = vec3(\n                  getW(wF, wR, wC, "+f+", d2),\n                  getW(wF, wR, wC, "+f+" + 1, d2),\n                  getW(wF, wR, wC, "+f+" + 2, d2)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},vo=function(t,e,n,r){void 0===e&&(e=!1),void 0===n&&(n=null),void 0===r&&(r=!1),this.variableNames=["x","W"],this.outputShape=t.outShape;var i=t.inHeight,o=t.inWidth,a=t.padInfo.top,s=t.padInfo.left,u=t.strideHeight,l=t.strideWidth,c=t.dilationHeight,h=t.dilationWidth,d=t.filterHeight,f=t.filterWidth,p=t.outChannels/t.inChannels,m="",g="";n&&(m=r?"float activation(float a) {\n          float b = getPreluActivationWeightsAtOutCoords();\n          "+n+"\n        }":"\n          float activation(float x) {\n            "+n+"\n          }\n        ",g="result = activation(result);");var y=e?"result += getBiasAtOutCoords();":"";e&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),this.userCode="\n      "+m+"\n\n      const ivec2 strides = ivec2("+u+", "+l+");\n      const ivec2 pads = ivec2("+a+", "+s+");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords.x;\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int d2 = coords.w;\n        int d1 = d2 / "+p+";\n        int q = d2 - d1 * "+p+";\n\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // Convolve x(?, ?, d1) with w(:, :, d1, q) to get y(yR, yC, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        // TO DO(dsmilkov): Flatten the two for loops and vec4 the operations.\n        for (int wR = 0; wR < "+d+"; wR++) {\n          int xR = xRCorner + wR * "+c+";\n\n          if (xR < 0 || xR >= "+i+") {\n            continue;\n          }\n\n          for (int wC = 0; wC < "+f+"; wC++) {\n            int xC = xCCorner + wC * "+h+";\n\n            if (xC < 0 || xC >= "+o+") {\n              continue;\n            }\n\n            float xVal = getX(batch, xR, xC, d1);\n            float wVal = getW(wR, wC, d1, q);\n            dotProd += xVal * wVal;\n          }\n        }\n\n        float result = dotProd;\n        "+y+"\n        "+g+"\n        setOutput(result);\n      }\n    "},bo=function(t,e,n,r){void 0===e&&(e=!1),void 0===n&&(n=null),void 0===r&&(r=!1),this.variableNames=["x","W"],this.usesPackedTextures=!0,this.outputShape=t.outShape;for(var i=t.inHeight,o=t.inWidth,a=t.padInfo.top,s=t.padInfo.left,u=t.strideHeight,l=t.strideWidth,c=t.dilationHeight,h=t.dilationWidth,f=t.filterHeight,p=t.filterWidth,m=p,g="int xR; int xC; int xCOffset;",y=0;y<f;y++)for(var v=0;v<p;v++)g+="\n          vec4 xTexelR"+y+"C"+2*v+" = vec4(0.);\n          vec4 wR"+y+"C"+v+" = vec4(0.);\n          vec4 xR"+y+"C"+v+" = vec4(0.);";for(y=0;y<f;y++)for(var b=0;b<m;b++){if(g+="\n          xR = xRCorner + "+y*c+";\n          xC = xCCorner + "+(v=2*b)*h+";\n        ",1===l){if(v<p&&(g+=s%2==1?"\n                xCOffset = xC + 1;\n                if(xR >= 0 && xR < "+i+" && xCOffset >= 0 && xCOffset < "+o+") {\n                  xTexelR"+y+"C"+v+" = getX(batch, xR, xCOffset, d1);\n                } else {\n                  xTexelR"+y+"C"+v+" = vec4(0.);\n                }\n\n                xCOffset = xC + 1 - 2;\n                if(xR >= 0 && xR < "+i+" && xCOffset >= 0 && xCOffset < "+o+") {\n                  vec4 previous = getX(batch, xR, xCOffset, d1);\n                  xR"+y+"C"+v+" = vec4(previous.zw, xTexelR"+y+"C"+v+".xy);\n                } else {\n                  xR"+y+"C"+v+" = vec4(0, 0, xTexelR"+y+"C"+v+".xy);\n                }\n              ":"\n                if(xR >= 0 && xR < "+i+" && xC >= 0 && xC < "+o+") {\n                  xTexelR"+y+"C"+v+" = getX(batch, xR, xC, d1);\n                } else {\n                  xTexelR"+y+"C"+v+" = vec4(0.);\n                }\n\n                xR"+y+"C"+v+" = xTexelR"+y+"C"+v+";\n              ",v+1<p)){var w=s%2==0?d(h):h;h%2==0&&s%2==1||h%2!=0&&s%2!=1?(g+="\n                  xCOffset = xC + "+s%2+" + "+w+";\n\n                  if(xR >= 0 && xR < "+i+" &&\n                    xCOffset >= 0 && xCOffset < "+o+") {\n                    xTexelR"+y+"C"+(v+2)+" = getX(batch, xR, xCOffset, d1);\n                  }\n                ",h>1&&(g+="\n                    xCOffset -= 2;\n                    if(xR >= 0 && xR < "+i+" &&\n                      xCOffset >= 0 && xCOffset < "+o+") {\n                      xTexelR"+y+"C"+v+" = getX(batch, xR, xCOffset, d1);\n                    } else {\n                      xTexelR"+y+"C"+v+" = vec4(0.);\n                    }\n                  "),g+="\n                  xR"+y+"C"+(v+1)+" = vec4(\n                    xTexelR"+y+"C"+v+".zw, xTexelR"+y+"C"+(v+2)+".xy);\n                "):g+="\n                  xCOffset = xC + "+w+";\n\n                  if(xR >= 0 && xR < "+i+" &&\n                    xCOffset >= 0 && xCOffset < "+o+") {\n                    xTexelR"+y+"C"+(v+2)+" = getX(batch, xR, xCOffset, d1);\n                  }\n\n                  xR"+y+"C"+(v+1)+" = xTexelR"+y+"C"+(v+2)+";\n                "}}else v<p&&(g+="\n              if(xR >= 0 && xR < "+i+") {\n            ",s%2==1?(g+="\n                xCOffset = xC + 1 - "+l+";\n                if(xCOffset >= 0 && xCOffset < "+o+") {\n                  xTexelR"+y+"C"+v+" = getX(batch, xR, xCOffset, d1);\n                } else {\n                  xTexelR"+y+"C"+v+" = vec4(0.);\n                }\n\n                if(xC + 1 >= 0 && xC + 1 < "+o+") {\n                  xTexelR"+y+"C"+(v+2)+" = getX(batch, xR, xC + 1, d1);\n                } else {\n                  xTexelR"+y+"C"+(v+2)+" = vec4(0.);\n                }\n\n                xR"+y+"C"+v+" = vec4(\n                  xTexelR"+y+"C"+v+".zw, xTexelR"+y+"C"+(v+2)+".zw);\n              ",v+1<p&&(g+="\n                  vec4 final = vec4(0.);\n                  xCOffset = xC + 1 + "+l+";\n                  if(xCOffset >= 0 && xCOffset < "+o+") {\n                    final = getX(batch, xR, xCOffset, d1);\n                  }\n                  xR"+y+"C"+(v+1)+" = vec4(xTexelR"+y+"C"+(v+2)+".xy, final.xy);\n                ")):(g+="\n                if(xC >= 0 && xC < "+o+") {\n                  xTexelR"+y+"C"+v+" = getX(batch, xR, xC, d1);\n                } else {\n                  xTexelR"+y+"C"+v+" = vec4(0.);\n                }\n\n                xCOffset = xC + "+l+";\n                if(xCOffset >= 0 && xCOffset < "+o+") {\n                  xTexelR"+y+"C"+(v+2)+" = getX(batch, xR, xCOffset, d1);\n                } else {\n                  xTexelR"+y+"C"+(v+2)+" = vec4(0.);\n                }\n\n                xR"+y+"C"+v+" = vec4(\n                  xTexelR"+y+"C"+v+".xy, xTexelR"+y+"C"+(v+2)+".xy);\n              ",v+1<p&&(g+="\n                  xR"+y+"C"+(v+1)+" = vec4(\n                    xTexelR"+y+"C"+v+".zw, xTexelR"+y+"C"+(v+2)+".zw);\n                ")),g+="}");v<p&&(g+="\n            vec4 wTexelR"+y+"C"+v+" = getW("+y+", "+v+", d1, q);\n            wR"+y+"C"+v+" = vec4(wTexelR"+y+"C"+v+".xz, wTexelR"+y+"C"+v+".xz);\n          ",v+1<p&&(g+="\n              vec4 wTexelR"+y+"C"+(v+1)+" = getW("+y+", "+(v+1)+", d1, q);\n              wR"+y+"C"+(v+1)+" =\n                vec4(wTexelR"+y+"C"+(v+1)+".xz, wTexelR"+y+"C"+(v+1)+".xz);"))}for(y=0;y<f;y++)for(v=0;v<p;v++)g+="dotProd += xR"+y+"C"+v+" * wR"+y+"C"+v+";";var x="",_="";n&&(x=r?"vec4 activation(vec4 a) {\n          vec4 b = getPreluActivationWeightsAtOutCoords();\n          "+n+"\n        }":"vec4 activation(vec4 x) {\n          "+n+"\n        }",_="result = activation(result);");var C=e?"result += getBiasAtOutCoords();":"";e&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),this.userCode="\n      "+x+"\n\n      const ivec2 strides = ivec2("+u+", "+l+");\n      const ivec2 pads = ivec2("+a+", "+s+");\n\n      void main() {\n\n        ivec4 coords = getOutputCoords();\n        int batch = coords.x;\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int d2 = coords.w;\n        int d1 = d2;\n        int q = 0;\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        vec4 dotProd = vec4(0.);\n\n        "+g+"\n\n        vec4 result = dotProd;\n        "+C+"\n        "+_+"\n        setOutput(result);\n      }\n    "},wo=function(t,e,n,r,i){this.variableNames=["Image","Boxes","BoxInd"],this.outputShape=[];var o=t[0],a=t[1],s=t[2],u=n[0],l=n[1];this.outputShape=[e[0],u,l,t[3]];var c=[a-1+".0",s-1+".0"],h=c[0],d=c[1],f=u>1?[""+(a-1)/(u-1),"(y2-y1) * height_ratio","y1*"+h+" + float(y)*(height_scale)"]:["0.0","0.0","0.5 * (y1+y2) * "+h],p=l>1?[""+(s-1)/(l-1),"(x2-x1) * width_ratio","x1*"+d+" + float(x)*(width_scale)"]:["0.0","0.0","0.5 * (x1+x2) * "+d];this.userCode="\n      const float height_ratio = float("+f[0]+");\n      const float width_ratio = float("+p[0]+");\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int y = coords[1];\n        int x = coords[2];\n        int d = coords[3];\n\n        // get box vals\n        float y1 = getBoxes(b,0);\n        float x1 = getBoxes(b,1);\n        float y2 = getBoxes(b,2);\n        float x2 = getBoxes(b,3);\n\n        // get image in batch index\n        int bInd = round(getBoxInd(b));\n        if(bInd < 0 || bInd >= "+o+") {\n          return;\n        }\n\n        float height_scale = "+f[1]+";\n        float width_scale = "+p[1]+";\n\n        float in_y = "+f[2]+";\n        if( in_y < 0.0 || in_y > "+h+" ) {\n          setOutput(float("+i+"));\n          return;\n        }\n        float in_x = "+p[2]+";\n        if( in_x < 0.0 || in_x > "+d+" ) {\n          setOutput(float("+i+"));\n          return;\n        }\n\n        vec2 sourceFracIndexCR = vec2(in_x,in_y);\n        if("+("bilinear"===r?1:0)+" == 1) {\n          // Compute the four integer indices.\n          ivec2 sourceFloorCR = ivec2(sourceFracIndexCR);\n          ivec2 sourceCeilCR = ivec2(ceil(sourceFracIndexCR));\n\n          float topLeft = getImage(b, sourceFloorCR.y, sourceFloorCR.x, d);\n          float bottomLeft = getImage(b, sourceCeilCR.y, sourceFloorCR.x, d);\n          float topRight = getImage(b, sourceFloorCR.y, sourceCeilCR.x, d);\n          float bottomRight = getImage(b, sourceCeilCR.y, sourceCeilCR.x, d);\n\n          vec2 fracCR = sourceFracIndexCR - vec2(sourceFloorCR);\n\n          float top = topLeft + (topRight - topLeft) * fracCR.x;\n          float bottom = bottomLeft + (bottomRight - bottomLeft) * fracCR.x;\n          float newValue = top + (bottom - top) * fracCR.y;\n          setOutput(newValue);\n        } else {\n          // Compute the coordinators of nearest neighbor point.\n          ivec2 sourceNearestCR = ivec2(floor(\n            sourceFracIndexCR + vec2(0.5,0.5)));\n          float newValue = getImage(b, sourceNearestCR.y, sourceNearestCR.x, d);\n          setOutput(newValue);\n        }\n      }\n    "},xo=function(t,e,n){this.variableNames=["x"],this.outputShape=t;var r=t.length,i=t[t.length-1],o=n?"<":">";this.userCode="\n      int getIndex(int i) {\n        "+(n?"return "+i+" -i - 1;":"return i;")+"\n      }\n\n      void main() {\n        "+Ui(r)+" coords = getOutputCoords();\n        int end = "+_o(r,"coords")+";\n        float val = 0.0;\n        for (int i = "+i+" - 1; i >= 0; i -= 1) {\n          int idx = getIndex(i);\n          if (idx "+o+" end) {\n            continue;\n          }\n          if (idx == end && "+e+") {\n            continue;\n          }\n          "+_o(r,"coords")+" = idx;\n          val += getX("+function(t,e){if(1===t)return""+e;if(2===t)return e+".x, "+e+".y";if(3===t)return e+".x, "+e+".y, "+e+".z";if(4===t)return e+".x, "+e+".y, "+e+".z, "+e+".w";throw Error("Cumulative sum for rank "+t+" is not yet supported")}(r,"coords")+");\n        }\n        setOutput(val);\n      }\n    "};function _o(t,e){if(1===t)return""+e;if(2===t)return e+".y";if(3===t)return e+".z";if(4===t)return e+".w";throw Error("Cumulative sum for rank "+t+" is not yet supported")}var Co=function(t,e){this.variableNames=["A"];var n=Ti();this.outputShape=t,this.userCode="\n      ivec3 outCoordsFromFlatIndex(int index) {\n        "+Di(["r","c","d"],t)+"\n        return ivec3(r, c, d);\n      }\n\n      void main() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n          vec2("+e[0]+", "+e[1]+"));\n        int index = 4 * (resTexRC.x * "+e[1]+" + resTexRC.y);\n\n        vec4 result = vec4(0.);\n\n        for (int i=0; i<4; i++) {\n          int flatIndex = index + i;\n          ivec3 rc = outCoordsFromFlatIndex(flatIndex);\n          result[i] = getA(rc.x, rc.y, rc.z);\n        }\n\n        "+n.output+" = result;\n      }\n    "},ko=function(t,e){this.variableNames=["A"],this.usesPackedTextures=!0;var n=Ti();this.outputShape=t,this.userCode="\n      ivec3 outCoordsFromFlatIndex(int index) {\n        "+Di(["r","c","d"],t)+"\n        return ivec3(r, c, d);\n      }\n\n      void main() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n          vec2("+e[0]+", "+e[1]+"));\n        int index = 4 * (resTexRC.x * "+e[1]+" + resTexRC.y);\n\n        vec4 result = vec4(0.);\n\n        for (int i=0; i<4; i++) {\n          int flatIndex = index + i;\n          ivec3 rc = outCoordsFromFlatIndex(flatIndex);\n          result[i] = getChannel(getA(rc.x, rc.y, rc.z), vec2(rc.y, rc.z));\n        }\n\n        "+n.output+" = result;\n      }\n    "},So=function(){function t(t,e,n){this.variableNames=["x"],this.outputShape=[],this.outputShape=t,this.blockSize=e,this.dataFormat=n,this.userCode="\n    void main() {\n      ivec4 coords = getOutputCoords();\n      int b = coords[0];\n      int h = "+this.getHeightCoordString()+";\n      int w = "+this.getWidthCoordString()+";\n      int d = "+this.getDepthCoordString()+";\n\n      int in_h = h / "+e+";\n      int offset_h = imod(h, "+e+");\n      int in_w = w / "+e+";\n      int offset_w = imod(w, "+e+");\n      int offset_d = (offset_h * "+e+" + offset_w) *\n        "+this.getOutputDepthSize()+";\n      int in_d = d + offset_d;\n\n      float result = "+this.getInputSamplingString()+";\n      setOutput(result);\n    }\n  "}return t.prototype.getHeightCoordString=function(){return"NHWC"===this.dataFormat?"coords[1]":"coords[2]"},t.prototype.getWidthCoordString=function(){return"NHWC"===this.dataFormat?"coords[2]":"coords[3]"},t.prototype.getDepthCoordString=function(){return"NHWC"===this.dataFormat?"coords[3]":"coords[1]"},t.prototype.getOutputDepthSize=function(){return"NHWC"===this.dataFormat?this.outputShape[3]:this.outputShape[1]},t.prototype.getInputSamplingString=function(){return"NHWC"===this.dataFormat?"getX(b, in_h, in_w, in_d)":"getX(b, in_d, in_h, in_w)"},t}(),Eo=function(t){this.variableNames=["X"],this.outputShape=[t,t],this.userCode="\n      void main() {\n          ivec2 coords = getOutputCoords();\n          float val = coords[0] == coords[1] ? getX(coords[0]) : 0.0;\n          setOutput(val);\n      }\n    "},Oo=function(t){this.variableNames=["A"];var e=Ti();this.outputShape=t,this.userCode="\n      "+Ii+"\n\n      void main() {\n        float x = getAAtOutCoords();\n        "+e.output+" = encode_float(x);\n      }\n    "},Ao=function(t){this.variableNames=["A"],this.usesPackedTextures=!0;var e=Ti();this.outputShape=t,this.userCode="\n      "+Ii+"\n\n      void main() {\n        ivec3 coords = getOutputCoords();\n        float x = getChannel(getAAtOutCoords(), vec2(coords.y, coords.z));\n        "+e.output+" = encode_float(x);\n      }\n    "},No=function(t,e,n){void 0===n&&(n=!1),this.variableNames=["A"];var r=Ti(),i=e[0],o=e[1];this.outputShape=t;var a="result";n&&(a="floor(result * 255. + 0.5)"),this.userCode="\n      "+Ri(t)+"\n\n      void main() {\n        ivec3 coords = getOutputCoords();\n\n        int flatIndex = getFlatIndex(coords);\n        int offset = imod(flatIndex, 4);\n\n        flatIndex = idiv(flatIndex, 4, 1.);\n        \n        int r = flatIndex / "+o+";\n        int c = imod(flatIndex, "+o+");\n        vec2 uv = (vec2(c, r) + halfCR) / vec2("+o+".0, "+i+".0);\n        vec4 values = "+r.texture2D+"(A, uv);\n\n        float result;\n\n        if(offset == 0) {\n          result = values[0];\n        } else if(offset == 1) {\n          result = values[1];\n        } else if(offset == 2) {\n          result = values[2];\n        } else {\n          result = values[3];\n        }\n\n        "+r.output+" = vec4("+a+", 0., 0., 0.);\n      }\n    "},To=function(t,e,n){void 0===n&&(n=!1),this.variableNames=["A"];var r=Ti(),i=e[0],o=e[1];this.outputShape=t;var a="",s="result";n&&(s="floor(result * 255. + 0.5)");for(var u=0;u<=1;u++)for(var l=0;l<=1;l++){var c=2*u+l;a+="\n          localCoords = coords;\n          if(localCoords[2] + "+l+" < "+t[2]+") {\n            localCoords[2] += "+l+";\n            if(localCoords[1] + "+u+" < "+t[1]+") {\n              localCoords[1] += "+u+";\n\n              flatIndex = getFlatIndex(localCoords);\n              offset = imod(flatIndex, 4);\n    \n              flatIndex = idiv(flatIndex, 4, 1.);\n\n              r = flatIndex / "+o+";\n              c = imod(flatIndex, "+o+");\n              uv = (vec2(c, r) + halfCR) / vec2("+o+".0, "+i+".0);\n              values = "+r.texture2D+"(A, uv);\n\n              if(offset == 0) {\n                result["+c+"] = values[0];\n              } else if(offset == 1) {\n                result["+c+"] = values[1];\n              } else if(offset == 2) {\n                result["+c+"] = values[2];\n              } else {\n                result["+c+"] = values[3];\n              }\n            }\n          }\n        "}this.userCode="\n      "+Ri(t)+"\n\n      void main() {\n        ivec3 coords = getOutputCoords();\n\n        vec4 result = vec4(0.);\n        int flatIndex, r, c, offset;\n        ivec3 localCoords;\n        vec2 uv;\n        vec4 values;\n        \n        "+a+"\n\n        "+r.output+" = "+s+";\n      }\n    "},Do=function(t,e,n){this.variableNames=["real","imag"];var r=e[1];this.outputShape=e;var i=n?"2.0 * "+Math.PI:"-2.0 * "+Math.PI;this.userCode="\n      const float exponentMultiplier = "+i+";\n\n      float unaryOpComplex(float real, float expR, float imag, float expI) {\n        "+t+"\n      }\n\n      float mulMatDFT(int batch, int index) {\n        float indexRatio = float(index) / float("+r+");\n        float exponentMultiplierTimesIndexRatio =\n            exponentMultiplier * indexRatio;\n\n        float result = 0.0;\n\n        for (int i = 0; i < "+r+"; i++) {\n          // x = (-2|2 * PI / N) * index * i;\n          float x = exponentMultiplierTimesIndexRatio * float(i);\n          float expR = cos(x);\n          float expI = sin(x);\n          float real = getReal(batch, i);\n          float imag = getImag(batch, i);\n\n          result +=\n              unaryOpComplex(real, expR, imag, expI) / "+(n?r+".0":"1.0")+";\n        }\n\n        return result;\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        setOutput(mulMatDFT(coords[0], coords[1]));\n      }\n    "},Ro=function(){function t(t,e){this.outputShape=[],this.variableNames=["x"],this.outputShape=t,this.userCode="\n      uniform float value;\n      void main() {\n        // Input can be obtained from uniform value.\n        setOutput(value);\n      }\n    "}return t.prototype.getCustomSetupFunc=function(t){var e=this;return function(n,r){null==e.valueLoc&&(e.valueLoc=n.getUniformLocationNoThrow(r,"value")),n.gl.uniform1f(e.valueLoc,t)}},t}(),Io=function(t){this.variableNames=["A"];var e=Ti(),n=t[0],r=t[1];this.outputShape=t,this.userCode="\n      void main() {\n        ivec3 coords = getOutputCoords();\n        int texR = coords[0];\n        int texC = coords[1];\n        int depth = coords[2];\n        vec2 uv = (vec2(texC, texR) + halfCR) / vec2("+r+".0, "+n+".0);\n\n        vec4 values = "+e.texture2D+"(A, uv);\n        float value;\n        if (depth == 0) {\n          value = values.r;\n        } else if (depth == 1) {\n          value = values.g;\n        } else if (depth == 2) {\n          value = values.b;\n        } else if (depth == 3) {\n          value = values.a;\n        }\n\n        setOutput(floor(value * 255.0 + 0.5));\n      }\n    "},Mo=function(t){this.variableNames=["A"];var e=Ti(),n=t[0],r=t[1];this.outputShape=t,this.userCode="\n      void main() {\n        ivec3 coords = getOutputCoords();\n        int texR = coords[0];\n        int texC = coords[1];\n        int depth = coords[2];\n\n        vec4 result = vec4(0.);\n\n        for(int row=0; row<=1; row++) {\n          for(int col=0; col<=1; col++) {\n            texC = coords[1] + row;\n            depth = coords[2] + col;\n\n            vec2 uv = (vec2(texC, texR) + halfCR) / vec2("+r+".0, "+n+".0);\n            vec4 values = "+e.texture2D+"(A, uv);\n            float value;\n            if (depth == 0) {\n              value = values.r;\n            } else if (depth == 1) {\n              value = values.g;\n            } else if (depth == 2) {\n              value = values.b;\n            } else if (depth == 3) {\n              value = values.a;\n            }\n\n            result[row * 2 + col] = floor(value * 255.0 + 0.5);\n          }\n        }\n\n        "+e.output+" = result;\n      }\n    "},Fo=function(t,e,n){this.variableNames=["A","indices"];var r=t.slice();r[n]=e,this.outputShape=r,this.rank=r.length;var i=Ui(this.rank),o=function(t,e){var n=t.length;if(n>4)throw Error("Gather for rank "+n+" is not yet supported");if(1===n)return"int(getIndices(resRC))";for(var r=["resRC.x","resRC.y","resRC.z","resRC.w"],i=[],o=0;o<t.length;o++)i.push(o===e?"int(getIndices("+r[o]+"))":""+r[o]);return i.join()}(t,n);this.userCode="\n      void main() {\n        "+i+" resRC = getOutputCoords();\n        setOutput(getA("+o+"));\n      }\n    "},Po=function(t,e,n){this.sliceDim=t,this.strides=e,this.variableNames=["x","indices"],this.outputShape=n;var r=Ui(e.length),i=Ui(n.length);this.userCode="\n        "+r+" strides = "+r+"("+this.strides+");\n         void main() {\n          "+i+" coords = getOutputCoords();\n          int flattenIndex = 0;\n          for (int j = 0; j < "+this.sliceDim+"; j++) {\n            int index = round(getIndices(coords[0], j));\n            flattenIndex += index * "+(this.sliceDim>1?"strides[j]":"strides")+";\n          }\n          setOutput(getX(flattenIndex, coords[1]));\n        }\n      "};function jo(t,e){var n=Ti();return Vt(t,e,n.version+"\n    precision highp float;\n    "+n.attribute+" vec3 clipSpacePos;\n    "+n.attribute+" vec2 uv;\n    "+n.varyingVs+" vec2 resultUV;\n\n    void main() {\n      gl_Position = vec4(clipSpacePos, 1);\n      resultUV = uv;\n    }")}function zo(t,e){return Zt(t,e,new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0]))}function Lo(t,e){return Qt(t,e,new Uint16Array([0,1,2,2,1,3]))}function Bo(t,e,n,r,i,o,a){te(n,r);var s=Jt(t,e),u=t.TEXTURE_2D;return Lt(t,e,(function(){return t.bindTexture(u,s)})),Lt(t,e,(function(){return t.texParameteri(u,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE)})),Lt(t,e,(function(){return t.texParameteri(u,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE)})),Lt(t,e,(function(){return t.texParameteri(u,t.TEXTURE_MIN_FILTER,t.NEAREST)})),Lt(t,e,(function(){return t.texParameteri(u,t.TEXTURE_MAG_FILTER,t.NEAREST)})),Lt(t,e,(function(){return t.texImage2D(u,0,i,n,r,0,o,a,null)})),Lt(t,e,(function(){return t.bindTexture(t.TEXTURE_2D,null)})),s}function Uo(t,e,n,r,i){var o=Ft(n,r);return Bo(t,e,o[0],o[1],i.internalFormatFloat,i.textureFormatFloat,t.FLOAT)}function $o(t,e,n,r,i){var o=Ft(n,r);return Bo(t,e,o[0],o[1],i.internalFormatHalfFloat,i.textureFormatFloat,i.textureTypeHalfFloat)}function Vo(t,e,n,r,i){var o=Ft(n,r);return Bo(t,e,o[0],o[1],t.RGBA,t.RGBA,t.UNSIGNED_BYTE)}function Wo(t,e,n,r,i){var o=jt(n,r);return Bo(t,e,o[0],o[1],i.internalFormatPackedFloat,t.RGBA,t.FLOAT)}function qo(t,e,n,r,i){var o=jt(n,r);return Bo(t,e,o[0],o[1],i.internalFormatPackedHalfFloat,t.RGBA,i.textureTypeHalfFloat)}function Ho(t,e,n,r){return Lt(t,e,(function(){return t.bindBuffer(t.ARRAY_BUFFER,r)})),ne(t,e,n,"clipSpacePos",r,3,20,0)&&ne(t,e,n,"uv",r,2,20,12)}function Go(t,e,n,r,i,o,a){var s,u,l;Lt(t,e,(function(){return t.bindTexture(t.TEXTURE_2D,n)})),o instanceof Uint8Array?(s=new Uint8Array(r*i*4),u=t.UNSIGNED_BYTE,l=t.RGBA):(s=new Float32Array(r*i*4),u=t.FLOAT,l=a.internalFormatPackedFloat),s.set(o),Lt(t,e,(function(){return t.texImage2D(t.TEXTURE_2D,0,l,r,i,0,t.RGBA,u,s)})),Lt(t,e,(function(){return t.bindTexture(t.TEXTURE_2D,null)}))}function Xo(t,e,n,r){Lt(t,e,(function(){return t.bindTexture(t.TEXTURE_2D,n)})),r.data instanceof Uint8Array?Lt(t,e,(function(){return t.texImage2D(t.TEXTURE_2D,0,t.RGBA,r.width,r.height,0,t.RGBA,t.UNSIGNED_BYTE,r.data)})):Lt(t,e,(function(){return t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,r)})),Lt(t,e,(function(){return t.bindTexture(t.TEXTURE_2D,null)}))}function Ko(t,e,n,r,i){var o=t.createBuffer();Lt(t,e,(function(){return t.bindBuffer(t.PIXEL_PACK_BUFFER,o)}));var a=16*n*r;return Lt(t,e,(function(){return t.bufferData(t.PIXEL_PACK_BUFFER,a,t.STREAM_READ)})),Lt(t,e,(function(){return t.readPixels(0,0,r,n,t.RGBA,t.FLOAT,0)})),Lt(t,e,(function(){return t.bindBuffer(t.PIXEL_PACK_BUFFER,null)})),o}function Yo(t,e,n){var r=t,i=new Float32Array(n);return r.bindBuffer(r.PIXEL_PACK_BUFFER,e),r.getBufferSubData(r.PIXEL_PACK_BUFFER,0,i),r.bindBuffer(r.PIXEL_PACK_BUFFER,null),i}function Zo(t,e,n,r,i){var o=Ft(n,r),a=o[0],s=o[1],u=new Uint8Array(n*r*4);return Lt(t,e,(function(){return t.readPixels(0,0,a,s,i.downloadTextureFormat,t.UNSIGNED_BYTE,u)})),new Float32Array(u.buffer)}function Qo(t,e,n,r,i,o,a,s){var u=t,l=new Float32Array(function(t,e){var n=jt(t,e);return n[0]*n[1]*4}(o,a));return u.bindBuffer(u.PIXEL_PACK_BUFFER,e),u.getBufferSubData(u.PIXEL_PACK_BUFFER,0,l),u.bindBuffer(u.PIXEL_PACK_BUFFER,null),l}function Jo(t,e,n,r){var i=new Float32Array(n*r*4);return Lt(t,e,(function(){return t.readPixels(0,0,r,n,t.RGBA,t.FLOAT,i)})),i}var ta=Object.freeze({createVertexShader:jo,createVertexBuffer:zo,createIndexBuffer:Lo,createFloat32MatrixTexture:Uo,createFloat16MatrixTexture:$o,createUnsignedBytesMatrixTexture:Vo,createPackedMatrixTexture:Wo,createFloat16PackedMatrixTexture:qo,bindVertexProgramAttributeStreams:Ho,uploadDenseMatrixToTexture:Go,uploadPixelDataToTexture:Xo,createBufferFromOutputTexture:Ko,downloadFloat32MatrixFromBuffer:Yo,downloadByteEncodedFloatMatrixFromOutputTexture:Zo,downloadPackedMatrixFromBuffer:Qo,downloadMatrixFromPackedOutputTexture:Jo}),ea=function(){function t(t){this.outputTexture=null,this.program=null,this.disposed=!1,this.vertexAttrsAreBound=!1,this.itemsToPoll=[];var e=u().getNumber("WEBGL_VERSION");if(null!=t?(this.gl=t,Rt(e,t)):this.gl=It(e),1===u().getNumber("WEBGL_VERSION"))this.textureFloatExtension=$t(this.gl,this.debug,"OES_texture_float"),this.colorBufferFloatExtension=this.gl.getExtension("WEBGL_color_buffer_float"),this.textureHalfFloatExtension=$t(this.gl,this.debug,"OES_texture_half_float"),this.colorBufferHalfFloatExtension=this.gl.getExtension("EXT_color_buffer_half_float");else if(_e(this.gl,"EXT_color_buffer_float"))this.colorBufferFloatExtension=this.gl.getExtension("EXT_color_buffer_float");else{if(!_e(this.gl,"EXT_color_buffer_half_float"))throw new Error("GL context does not support color renderable floats");this.colorBufferHalfFloatExtension=this.gl.getExtension("EXT_color_buffer_half_float")}this.vertexBuffer=zo(this.gl,this.debug),this.indexBuffer=Lo(this.gl,this.debug),this.framebuffer=ee(this.gl,this.debug),this.textureConfig=zt(this.gl,this.textureHalfFloatExtension)}return Object.defineProperty(t.prototype,"debug",{get:function(){return u().getBool("DEBUG")},enumerable:!0,configurable:!0}),t.prototype.dispose=function(){var t=this;if(!this.disposed){null!=this.program&&console.warn("Disposing a GPGPUContext that still has a bound WebGLProgram. This is probably a resource leak, delete the program with GPGPUContext.deleteProgram before disposing."),null!=this.outputTexture&&console.warn("Disposing a GPGPUContext that still has a bound output matrix texture.  This is probably a resource leak, delete the output matrix texture with GPGPUContext.deleteMatrixTexture before disposing.");var e=this.gl;Lt(e,this.debug,(function(){return e.finish()})),Lt(e,this.debug,(function(){return e.bindFramebuffer(e.FRAMEBUFFER,null)})),Lt(e,this.debug,(function(){return e.deleteFramebuffer(t.framebuffer)})),Lt(e,this.debug,(function(){return e.bindBuffer(e.ARRAY_BUFFER,null)})),Lt(e,this.debug,(function(){return e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null)})),Lt(e,this.debug,(function(){return e.deleteBuffer(t.indexBuffer)})),this.disposed=!0}},t.prototype.createFloat32MatrixTexture=function(t,e){return this.throwIfDisposed(),Uo(this.gl,this.debug,t,e,this.textureConfig)},t.prototype.createFloat16MatrixTexture=function(t,e){return this.throwIfDisposed(),$o(this.gl,this.debug,t,e,this.textureConfig)},t.prototype.createUnsignedBytesMatrixTexture=function(t,e){return this.throwIfDisposed(),Vo(this.gl,this.debug,t,e)},t.prototype.uploadPixelDataToTexture=function(t,e){this.throwIfDisposed(),Xo(this.gl,this.debug,t,e)},t.prototype.uploadDenseMatrixToTexture=function(t,e,n,r){this.throwIfDisposed(),Go(this.gl,this.debug,t,e,n,r,this.textureConfig)},t.prototype.createFloat16PackedMatrixTexture=function(t,e){return this.throwIfDisposed(),qo(this.gl,this.debug,t,e,this.textureConfig)},t.prototype.createPackedMatrixTexture=function(t,e){return this.throwIfDisposed(),Wo(this.gl,this.debug,t,e,this.textureConfig)},t.prototype.deleteMatrixTexture=function(t){var e=this;this.throwIfDisposed(),this.outputTexture===t&&(ue(this.gl,this.debug,this.framebuffer),this.outputTexture=null),Lt(this.gl,this.debug,(function(){return e.gl.deleteTexture(t)}))},t.prototype.downloadByteEncodedFloatMatrixFromOutputTexture=function(t,e,n){var r=this;return this.downloadMatrixDriver(t,(function(){return Zo(r.gl,r.debug,e,n,r.textureConfig)}))},t.prototype.downloadPackedMatrixFromBuffer=function(t,e,n,r,i,o){return Qo(this.gl,t,0,0,0,i,o)},t.prototype.downloadFloat32MatrixFromBuffer=function(t,e){return Yo(this.gl,t,e)},t.prototype.createBufferFromTexture=function(t,e,n){this.bindTextureToFrameBuffer(t);var r=Ko(this.gl,this.debug,e,n);return this.unbindTextureToFrameBuffer(),r},t.prototype.createAndWaitForFence=function(){var t=this.createFence(this.gl);return this.pollFence(t)},t.prototype.createFence=function(t){var e,n,r=this;if(u().getBool("WEBGL_FENCE_API_ENABLED")){var i=t,o=i.fenceSync(i.SYNC_GPU_COMMANDS_COMPLETE,0);t.flush(),n=function(){var t=i.clientWaitSync(o,0,0);return t===i.ALREADY_SIGNALED||t===i.CONDITION_SATISFIED},e=o}else u().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?(e=this.beginQuery(),this.endQuery(),n=function(){return r.isQueryAvailable(e,u().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}):n=function(){return!0};return{query:e,isFencePassed:n}},t.prototype.downloadMatrixFromPackedTexture=function(t,e,n){var r=this;return this.downloadMatrixDriver(t,(function(){return Jo(r.gl,r.debug,e,n)}))},t.prototype.createProgram=function(t){this.throwIfDisposed();var e=this.gl,n=Wt(e,this.debug,t),r=jo(e,this.debug),i=Xt(e,this.debug);return Lt(e,this.debug,(function(){return e.attachShader(i,r)})),Lt(e,this.debug,(function(){return e.attachShader(i,n)})),Kt(e,this.debug,i),this.debug&&Yt(e,this.debug,i),this.vertexAttrsAreBound||(this.setProgram(i),this.vertexAttrsAreBound=Ho(e,this.debug,this.program,this.vertexBuffer)),i},t.prototype.deleteProgram=function(t){var e=this;this.throwIfDisposed(),t===this.program&&(this.program=null),null!=t&&Lt(this.gl,this.debug,(function(){return e.gl.deleteProgram(t)}))},t.prototype.setProgram=function(t){var e=this;this.throwIfDisposed(),this.program=t,null!=this.program&&this.debug&&Yt(this.gl,this.debug,this.program),Lt(this.gl,this.debug,(function(){return e.gl.useProgram(t)}))},t.prototype.getUniformLocation=function(t,e,n){return void 0===n&&(n=!0),this.throwIfDisposed(),n?ie(this.gl,this.debug,t,e):oe(this.gl,t,e)},t.prototype.getAttributeLocation=function(t,e){var n=this;return this.throwIfDisposed(),Lt(this.gl,this.debug,(function(){return n.gl.getAttribLocation(t,e)}))},t.prototype.getUniformLocationNoThrow=function(t,e){return this.throwIfDisposed(),this.gl.getUniformLocation(t,e)},t.prototype.setInputMatrixTexture=function(t,e,n){this.throwIfDisposed(),this.throwIfNoProgram(),ae(this.gl,this.debug,0,t,e,n)},t.prototype.setOutputMatrixTexture=function(t,e,n){this.setOutputMatrixTextureDriver(t,n,e)},t.prototype.setOutputPackedMatrixTexture=function(t,e,n){this.throwIfDisposed();var r=jt(e,n);this.setOutputMatrixTextureDriver(t,r[0],r[1])},t.prototype.setOutputMatrixWriteRegion=function(t,e,n,r){this.setOutputMatrixWriteRegionDriver(n,t,r,e)},t.prototype.setOutputPackedMatrixWriteRegion=function(t,e,n,r){throw new Error("setOutputPackedMatrixWriteRegion not implemented.")},t.prototype.debugValidate=function(){null!=this.program&&Yt(this.gl,this.debug,this.program),le(this.gl)},t.prototype.executeProgram=function(){this.throwIfDisposed(),this.throwIfNoProgram();var t=this.gl;this.debug&&this.debugValidate(),Lt(t,this.debug,(function(){return t.drawElements(t.TRIANGLES,6,t.UNSIGNED_SHORT,0)}))},t.prototype.blockUntilAllProgramsCompleted=function(){var t=this;this.throwIfDisposed(),Lt(this.gl,this.debug,(function(){return t.gl.finish()}))},t.prototype.getQueryTimerExtension=function(){return null==this.disjointQueryTimerExtension&&(this.disjointQueryTimerExtension=$t(this.gl,this.debug,2===u().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")?"EXT_disjoint_timer_query_webgl2":"EXT_disjoint_timer_query")),this.disjointQueryTimerExtension},t.prototype.getQueryTimerExtensionWebGL2=function(){return this.getQueryTimerExtension()},t.prototype.getQueryTimerExtensionWebGL1=function(){return this.getQueryTimerExtension()},t.prototype.beginQuery=function(){if(2===u().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")){var t=this.gl,e=this.getQueryTimerExtensionWebGL2(),n=t.createQuery();return t.beginQuery(e.TIME_ELAPSED_EXT,n),n}var r=this.getQueryTimerExtensionWebGL1(),i=r.createQueryEXT();return r.beginQueryEXT(r.TIME_ELAPSED_EXT,i),i},t.prototype.endQuery=function(){if(2!==u().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")){var t=this.getQueryTimerExtensionWebGL1();t.endQueryEXT(t.TIME_ELAPSED_EXT)}else{var e=this.gl,n=this.getQueryTimerExtensionWebGL2();e.endQuery(n.TIME_ELAPSED_EXT)}},t.prototype.waitForQueryAndGetTime=function(t){return o(this,void 0,void 0,(function(){var e=this;return a(this,(function(n){switch(n.label){case 0:return[4,k((function(){return e.disposed||e.isQueryAvailable(t,u().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}))];case 1:return n.sent(),[2,this.getQueryTime(t,u().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))]}}))}))},t.prototype.getQueryTime=function(t,e){if(0===e)return null;if(2===e){var n=this.gl;return n.getQueryParameter(t,n.QUERY_RESULT)/1e6}var r=this.getQueryTimerExtensionWebGL1();return r.getQueryObjectEXT(t,r.QUERY_RESULT_EXT)/1e6},t.prototype.isQueryAvailable=function(t,e){if(0===e)return!0;if(2===e){var n=this.gl,r=this.getQueryTimerExtensionWebGL2(),i=n.getQueryParameter(t,n.QUERY_RESULT_AVAILABLE);return null==this.disjoint&&(this.disjoint=this.gl.getParameter(r.GPU_DISJOINT_EXT)),i&&!this.disjoint}return i=(r=this.getQueryTimerExtensionWebGL1()).getQueryObjectEXT(t,r.QUERY_RESULT_AVAILABLE_EXT),null==this.disjoint&&(this.disjoint=this.gl.getParameter(r.GPU_DISJOINT_EXT)),i&&!this.disjoint},t.prototype.pollFence=function(t){var e=this;return new Promise((function(n){e.addItemToPoll((function(){return t.isFencePassed()}),(function(){return n()}))}))},t.prototype.pollItems=function(){for(var t=function(t){for(var e=0;e<t.length&&t[e]();++e);return e-1}(this.itemsToPoll.map((function(t){return t.isDoneFn}))),e=0;e<=t;++e)(0,this.itemsToPoll[e].resolveFn)();this.itemsToPoll=this.itemsToPoll.slice(t+1)},t.prototype.addItemToPoll=function(t,e){var n=this;this.itemsToPoll.push({isDoneFn:t,resolveFn:e}),this.itemsToPoll.length>1||k((function(){return n.pollItems(),0===n.itemsToPoll.length}))},t.prototype.bindTextureToFrameBuffer=function(t){this.throwIfDisposed(),se(this.gl,this.debug,t,this.framebuffer),this.debug&&le(this.gl)},t.prototype.unbindTextureToFrameBuffer=function(){null!=this.outputTexture?(se(this.gl,this.debug,this.outputTexture,this.framebuffer),this.debug&&le(this.gl)):ue(this.gl,this.debug,this.framebuffer)},t.prototype.downloadMatrixDriver=function(t,e){this.bindTextureToFrameBuffer(t);var n=e();return this.unbindTextureToFrameBuffer(),n},t.prototype.setOutputMatrixTextureDriver=function(t,e,n){this.throwIfDisposed();var r=this.gl;se(r,this.debug,t,this.framebuffer),this.debug&&le(r),this.outputTexture=t,Lt(r,this.debug,(function(){return r.viewport(0,0,e,n)})),Lt(r,this.debug,(function(){return r.scissor(0,0,e,n)}))},t.prototype.setOutputMatrixWriteRegionDriver=function(t,e,n,r){var i=this;this.throwIfDisposed(),Lt(this.gl,this.debug,(function(){return i.gl.scissor(t,e,n,r)}))},t.prototype.throwIfDisposed=function(){if(this.disposed)throw new Error("Attempted to use disposed GPGPUContext.")},t.prototype.throwIfNoProgram=function(){if(null==this.program)throw new Error("No GPU program is currently set.")},t}();function na(t,e){if(t.length!==e.length)throw Error("Binary was compiled with "+t.length+" inputs, but was executed with "+e.length+" inputs");t.forEach((function(t,n){var r=t.logicalShape,i=e[n],o=i.shape;if(!b(r,o))throw Error("Binary was compiled with different shapes than the current args. Shapes "+r+" and "+o+" must match");if(!t.isUniform||!i.isUniform){var a=t.texShape,s=i.isUniform?null:i.texData.texShape;if(!b(a,s))throw Error("Binary was compiled with different texture shapes than the current args. Shape "+a+" and "+s+" must match")}}))}var ra=function(t,e,n){this.variableNames=["A"],this.usesPackedTextures=!0,this.outputShape=t;for(var r=n.inChannels,i=n.strideWidth,o=n.strideHeight,a=n.padInfo,s=n.outWidth,u=n.dilationWidth,l=n.dilationHeight,c=n.dataFormat,h=a.left,d=a.top,f=r*n.filterWidth,p=Ti(),m="channelsLast"===c,g=m?0:1,y=m?1:2,v="",b=0;b<=1;b++)for(var w=0;w<=1;w++)v+="\n          blockIndex = rc.y + "+w+";\n          pos = rc.x + "+b+";\n\n          if(blockIndex < "+t[1]+" && pos < "+t[0]+") {\n            offsetY = int(blockIndex / ("+s+")) * "+o+" - "+d+";\n            d0 = offsetY + "+l+" * (pos / "+f+");\n\n            if(d0 < "+e[g]+" && d0 >= 0) {\n\n              offsetX = int(mod(float(blockIndex), "+s+".) * "+i+". - "+h+".);\n              d1 = offsetX + "+u+" * (int(mod(float(pos), "+f+".) / "+r+".));\n\n              if(d1 < "+e[y]+" && d1 >= 0) {\n\n                ch = int(mod(float(pos), "+r+".));\n\n                if ("+m+") {\n                  innerDims = vec2(d1, ch);\n                  result["+(2*b+w)+"] = getChannel(\n                    getA(d0, int(innerDims.x),\n                    int(innerDims.y)), innerDims);\n                } else {\n                  innerDims = vec2(d0, d1);\n                  result["+(2*b+w)+"] = getChannel(\n                    getA(ch, int(innerDims.x),\n                    int(innerDims.y)), innerDims);\n                }\n              }\n            }\n          }\n        ";this.userCode="\n      void main() {\n        ivec2 rc = getOutputCoords();\n\n        vec4 result = vec4(0);\n\n        int blockIndex, pos, offsetY, d0, offsetX, d1, ch;\n        vec2 innerDims;\n\n        "+v+"\n\n        "+p.output+" = result;\n      }\n    "},ia=function(t,e,n,r,i){this.variableNames=["x"],this.outputShape=[];var o=e,a=t[3]-1;this.outputShape=t;var s="float("+n+") + float("+r+") * sum";this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int r = coords[1];\n        int c = coords[2];\n        int d = coords[3];\n        float x = getX(b, r, c, d);\n        float sum = 0.0;\n        for (int j = -"+o+"; j <= "+o+"; j++) {\n          int idx = d + j;\n          if (idx >= 0 && idx <=  "+a+") {\n            float z = getX(b, r, c, idx);\n            sum += z * z;\n          }\n        }\n        float val = x * "+(.5===i?"inversesqrt("+s+")":1===i?"1.0/("+s+")":"exp(log("+s+") * float(-"+i+"));")+";\n        setOutput(val);\n      }\n    "},oa=function(t,e,n,r,i){this.variableNames=["inputImage","outputImage","dy"],this.outputShape=[],this.outputShape=t,this.depth=t[3],this.depthRadius=e,this.bias=n,this.alpha=r,this.beta=i,this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int r = coords[1];\n        int c = coords[2];\n\n        float result = 0.0;\n        for (int d = 0; d < "+this.depth+"; ++d) {\n          int depthBegin = int(max(0.0, float(d - "+e+")));\n          int depthEnd = int(min(float("+this.depth+"),\n              float(d + "+e+" + 1)));\n\n          const int MIN_DEPTH_BEGIN = 0;\n          const int MAX_DEPTH_END = "+this.depth+";\n\n          float norm = 0.0;\n          for (int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k) {\n            if (k < depthBegin){\n              continue;\n            }\n            else if (k >= depthBegin && k < depthEnd) {\n              norm += getInputImage(b, r, c, k) * getInputImage(b, r, c, k);\n            }\n            else {\n              break;\n            }\n          }\n\n          norm = float("+r+") * norm + float("+n+");\n\n          for(int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k){\n            if (k < depthBegin){\n              continue;\n            }\n            else if (k >= depthBegin && k < depthEnd){\n              float dyi = -2.0 * float("+r+")\n                * float("+i+")\n                * getInputImage(b ,r ,c, k) * getOutputImage(b, r, c, d)\n                / norm;\n              if (k == d) {\n                dyi += pow(norm, -1.0 * "+i+");\n              }\n              if (k == coords[3]) {\n                dyi *= getDy(b, r, c, d);\n                result += dyi;\n              }\n            }\n            else {\n              break;\n            }\n          }\n      }\n      setOutput(result);\n      }\n    "},aa=function(t,e,n,r,i){this.variableNames=["x"],this.outputShape=[],this.usesPackedTextures=!0;var o=e,a=t[3]-1;this.outputShape=t;var s="float("+n+") + float("+r+") * sum";this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords.x;\n        int r = coords.y;\n        int c = coords.z;\n        int d = coords.w;\n\n        bool hasNextCol = d < "+this.outputShape[3]+";\n        bool hasNextRow = c < "+this.outputShape[2]+";\n\n        vec4 sum = vec4(0.);\n        vec4 xFragAtOutputCoords = getX(b, r, c, d);\n\n        vec4 xAtOutputCoords = vec4(\n          getChannel(xFragAtOutputCoords, vec2(c, d)),\n          hasNextCol ?\n            getChannel(xFragAtOutputCoords, vec2(c, d + 1)) : 0.0,\n          hasNextRow ?\n            getChannel(xFragAtOutputCoords , vec2(c + 1, d)) : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getChannel(xFragAtOutputCoords, vec2(c + 1, d + 1)) : 0.0\n        );\n\n        int firstChannel = d - "+o+";\n        vec2 cache = vec2(0.);\n        if(firstChannel >= 0){\n          vec4 firstChannelFrag = getX(b, r, c, firstChannel);\n          cache.x = getChannel(firstChannelFrag, vec2(c, firstChannel));\n            if(hasNextRow){\n              cache.y = getChannel(firstChannelFrag, vec2(c + 1, firstChannel));\n            }\n        }\n\n        ivec2 depth = ivec2(d, d + 1);\n        for (int j = - "+o+"; j <= "+o+"; j++) {\n          ivec2 idx = depth + j;\n          bvec2 aboveLowerBound = greaterThanEqual(idx, ivec2(0));\n          bvec2 belowUpperBound = lessThanEqual(idx, ivec2("+a+"));\n\n          bool depthInRange = aboveLowerBound.x && belowUpperBound.x;\n          bool depthPlusOneInRange = aboveLowerBound.y && belowUpperBound.y;\n\n          if(depthInRange || depthPlusOneInRange){\n            vec4 z = vec4(0.);\n            vec4 xFragAtCurrentDepth;\n            z.xz = cache.xy;\n            if(depthPlusOneInRange && hasNextCol){\n              xFragAtCurrentDepth = idx.y != d ?\n                getX(b, r, c, idx.y) : xFragAtOutputCoords;\n              z.y = getChannel(xFragAtCurrentDepth, vec2(c, idx.y));\n              if(hasNextRow){\n                z.w = getChannel(xFragAtCurrentDepth, vec2(c + 1, idx.y));\n              }\n            }\n            cache.xy = z.yw;\n            sum += z * z;\n          }\n        }\n        vec4 result = xAtOutputCoords * "+(.5===i?"inversesqrt("+s+")":1===i?"1.0/("+s+")":"exp(log("+s+") * float(-"+i+"));")+";\n        setOutput(result);\n      }\n    "},sa=function(t){this.variableNames=["dy","maxPos"],this.outputShape=t.inShape;var e=t.effectiveFilterHeight,n=t.effectiveFilterWidth;this.userCode="\n      const ivec2 pads = ivec2("+(e-1-t.padInfo.top)+", "+(n-1-t.padInfo.left)+");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n\n        ivec2 dyRCCorner = coords.yz - pads;\n        int dyRCorner = dyRCCorner.x;\n        int dyCCorner = dyRCCorner.y;\n\n        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < "+e+";\n          wR += "+t.dilationHeight+") {\n          float dyR = float(dyRCorner + wR) / "+t.strideHeight+".0;\n\n          if (dyR < 0.0 || dyR >= "+t.outHeight+".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          for (int wC = 0; wC < "+n+"; wC++) {\n            float dyC = float(dyCCorner + wC) / "+t.strideWidth+".0;\n\n            if (dyC < 0.0 || dyC >= "+t.outWidth+".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            float dyValue = getDy(b, idyR, idyC, d);\n            int maxPosValue = "+(e*n-1)+" - int(getMaxPos(b, idyR, idyC, d));\n\n            // Get the current value, check it against the value from the\n            // position matrix.\n            int curPosValue = wR * "+n+" + wC;\n            float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);\n\n            dotProd += dyValue * mask;\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},ua=function(t){this.variableNames=["dy","maxPos"],this.outputShape=t.inShape;var e=t.effectiveFilterDepth,n=t.effectiveFilterHeight,r=t.effectiveFilterWidth;this.userCode="\n      const ivec3 pads = ivec3("+(e-1-t.padInfo.front)+", "+(n-1-t.padInfo.top)+", "+(r-1-t.padInfo.left)+");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyDCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        // Convolve dy(?, ?, ?, ch) with pos mask(:, :, :, d) to get\n        // dx(xD, xR, xC, ch).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int wD = 0; wD < "+e+";\n           wD += "+t.dilationDepth+") {\n          float dyD = float(dyDCorner + wD) / "+t.strideDepth+".0;\n\n          if (dyD < 0.0 || dyD >= "+t.outDepth+".0 || fract(dyD) > 0.0) {\n            continue;\n          }\n          int idyD = int(dyD);\n\n          for (int wR = 0; wR < "+n+";\n              wR += "+t.dilationHeight+") {\n            float dyR = float(dyRCorner + wR) / "+t.strideHeight+".0;\n\n            if (dyR < 0.0 || dyR >= "+t.outHeight+".0 ||\n                fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            for (int wC = 0; wC < "+r+";\n                wC += "+t.dilationWidth+") {\n              float dyC = float(dyCCorner + wC) / "+t.strideWidth+".0;\n\n              if (dyC < 0.0 || dyC >= "+t.outWidth+".0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              float dyValue = getDy(batch, idyD, idyR, idyC, ch);\n              int maxPosValue = "+(e*n*r-1)+" -\n                  int(getMaxPos(batch, idyD, idyR, idyC, ch));\n\n              // Get the current value, check it against the value from the\n              // position matrix.\n              int curPosValue =\n                  wD * "+n+" * "+r+" +\n                  wR * "+r+" + wC;\n              float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);\n\n              dotProd += dyValue * mask;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},la=function(t,e,n,r,i,o,a){void 0===n&&(n=!1),void 0===r&&(r=!1),void 0===i&&(i=!1),void 0===o&&(o=null),void 0===a&&(a=!1),this.variableNames=["matrixA","matrixB"],this.usesPackedTextures=!0,this.outputShape=e;var s=Math.ceil((n?t[1]:t[2])/2),u=n?"i * 2, rc.y":"rc.y, i * 2",l=r?"rc.z, i * 2":"i * 2, rc.z",c=n?["a.xxyy","a.zzww"]:["a.xxzz","a.yyww"],h=r?["b.xzxz","b.ywyw"]:["b.xyxy","b.zwzw"],d="",f="";o&&(d=a?"vec4 activation(vec4 a) {\n          vec4 b = getPreluActivationWeightsAtOutCoords();\n          "+o+"\n        }":"vec4 activation(vec4 x) {\n          "+o+"\n        }",f="result = activation(result);");var p=i?"result += getBiasAtOutCoords();":"";i&&this.variableNames.push("bias"),a&&this.variableNames.push("preluActivationWeights"),this.userCode="\n      "+d+"\n\n      const float sharedDimension = "+s+".0;\n\n      vec4 dot2x2ARowBCol(ivec3 rc) {\n        vec4 result = vec4(0);\n        for (int i = 0; i < "+s+"; i++) {\n          vec4 a = getMatrixA(rc.x, "+u+");\n          vec4 b = getMatrixB(rc.x, "+l+");\n\n          // These swizzled products need to be separately added.\n          // See: https://github.com/tensorflow/tfjs/issues/1735\n          result += ("+c[0]+" * "+h[0]+");\n          result += ("+c[1]+" * "+h[1]+");\n        }\n        return result;\n      }\n\n      void main() {\n        ivec3 rc = getOutputCoords();\n        vec4 result = dot2x2ARowBCol(rc);\n\n        "+p+"\n\n        "+f+"\n\n        setOutput(result);\n      }\n    "},ca=function(){function t(t,e,n){this.variableNames=["probs"],this.outputShape=[t,n],this.userCode="\n      uniform float seed;\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n\n        float r = random(seed);\n        float cdf = 0.0;\n\n        for (int i = 0; i < "+(e-1)+"; i++) {\n          cdf += getProbs(batch, i);\n\n          if (r < cdf) {\n            setOutput(float(i));\n            return;\n          }\n        }\n\n        // If no other event happened, last event happened.\n        setOutput(float("+(e-1)+"));\n      }\n    "}return t.prototype.getCustomSetupFunc=function(t){var e=this;return function(n,r){null==e.seedLoc&&(e.seedLoc=n.getUniformLocation(r,"seed")),n.gl.uniform1f(e.seedLoc,t)}},t}(),ha=function(t,e,n,r){this.variableNames=["indices"],this.outputShape=[t,e],this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int index = round(getIndices(coords.x));\n        setOutput(mix(float("+r+"), float("+n+"),\n                      float(index == coords.y)));\n      }\n    "},da=function(t){this.variableNames=["A"],this.outputShape=t;var e=t.length;if(0===e)this.userCode="\n        void main() {\n          setOutput(vec4(getA(), 0., 0., 0.));\n        }\n      ";else{var n=Ni("rc",e),r=Ui(e),i=function(t,e,n){if(1===t)return"rc > "+e[0];for(var r="",i=t-2;i<t;i++)r+=n[i]+" >= "+e[i],i<t-1&&(r+="||");return r}(e,t,n),o=function(t,e,n,r){if(1===t)return"";var i=r.slice(-2);return"\n    int r = "+i[0]+";\n    int c = "+i[1]+";\n    int rp1 = r + 1;\n    int cp1 = c + 1;\n\n    bool cEdge = cp1 >= "+e+";\n    bool rEdge = rp1 >= "+n+";\n  "}(e,t[t.length-1],t[t.length-2],n),a=function(t,e){var n=t.length,r=function(t,e){for(var n=[],r=0;r<=1;r++)for(var i=0;i<=1;i++){for(var o=(0===r?"r":"rp1")+", "+(0===i?"c":"cp1"),a=2;a<t;a++)o=e[e.length-1-a]+","+o;n.push(o)}return n}(n,e);return 1===n?"getA(rc),\n            rc + 1 >= "+t[0]+" ? 0. : getA(rc + 1),\n            0, 0":"getA("+r[0]+"),\n          cEdge ? 0. : getA("+r[1]+"),\n          rEdge ? 0. : getA("+r[2]+"),\n          rEdge || cEdge ? 0. : getA("+r[3]+")"}(t,n);this.userCode="\n        void main() {\n          "+r+" rc = getOutputCoords();\n\n          if("+i+") {\n            setOutput(vec4(0));\n          } else {\n            "+o+"\n\n            setOutput(vec4("+a+"));\n          }\n        }\n      "}},fa=function(t,e,n){this.variableNames=["x"],this.outputShape=e.map((function(e,n){return e[0]+t[n]+e[1]}));var r=t.length,i=Ui(r),o=e.map((function(t){return t[0]})).join(","),a=e.map((function(e,n){return e[0]+t[n]})).join(","),s=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,r);this.userCode=1!==r?"\n      "+i+" start = "+i+"("+o+");\n      "+i+" end = "+i+"("+a+");\n\n      void main() {\n        "+i+" outC = getOutputCoords();\n        if (any(lessThan(outC, start)) || any(greaterThanEqual(outC, end))) {\n          setOutput(float("+n+"));\n        } else {\n          "+i+" coords = outC - start;\n          setOutput(getX("+s+"));\n        }\n      }\n    ":"\n        int start = "+o+";\n        int end = "+a+";\n\n        void main() {\n          int outC = getOutputCoords();\n          if (outC < start || outC >= end) {\n            setOutput(float("+n+"));\n          } else {\n            setOutput(getX(outC - start));\n          }\n        }\n      "},pa=function(t,e,n){this.variableNames=["x"],this.usesPackedTextures=!0,this.outputShape=e.map((function(e,n){return e[0]+t[n]+e[1]}));for(var r=t.length,i=Ui(r),o=e.map((function(t){return t[0]})).join(","),a=e.map((function(e,n){return e[0]+t[n]})).join(","),s=Ni("rc",r),u=Ni("source",r),l=s[r-1]+" < "+this.outputShape[r-1],c=1===r?"source":"vec2("+u.slice(-2).join()+")",h=[i+" rc = outputLoc;",s[r-1]+" += 1;\n       if("+l+") {\n      ",1===r?"":"}\n       rc = outputLoc;\n       "+s[r-2]+" += 1;\n       if("+s[r-2]+" < "+this.outputShape[r-2]+") {",1===r?"":"  "+s[r-1]+" += 1;\n         if("+l+") {"],d=1===r?"rc < start || rc >= end":"any(lessThan(rc, start)) || any(greaterThanEqual(rc, end))",f="",p=0,m=1===r?2:4;p<m;p++)f+="\n        "+h[p]+"\n        if ("+d+") {\n          result["+p+"] = float("+n+");\n        } else {\n          "+i+" source = rc - start;\n          result["+p+"] = getChannel(getX("+u.join()+"), "+c+");\n        }\n      ";this.userCode="\n      const "+i+" start = "+i+"("+o+");\n      const "+i+" end = "+i+"("+a+");\n\n      void main() {\n        "+i+" outputLoc = getOutputCoords();\n        vec4 result = vec4(0.);\n        "+(f+=1===r?"} ":"}}")+"\n        setOutput(result);\n      }\n    "},ma=function(t,e,n){if(this.variableNames=["x"],"avg"===e&&n)throw new Error("Cannot compute positions for average pool.");var r=t.filterWidth,i=t.strideHeight,o=t.strideWidth,a=t.dilationHeight,s=t.dilationWidth,u=t.effectiveFilterHeight,l=t.effectiveFilterWidth,c=t.padInfo.top,h=t.padInfo.left;this.outputShape=t.outShape;var d="avg"===e,f="0.0";if(d||(f="-1.0 / 1e-20"),n)this.userCode="\n        const ivec2 strides = ivec2("+i+", "+o+");\n        const ivec2 pads = ivec2("+c+", "+h+");\n\n        void main() {\n          ivec4 coords = getOutputCoords();\n          int batch = coords[0];\n          int d = coords[3];\n\n          ivec2 xRCCorner = coords.yz * strides - pads;\n          int xRCorner = xRCCorner.x;\n          int xCCorner = xRCCorner.y;\n\n          // max/min x(?, ?, d) to get y(yR, yC, d).\n          // ? = to be determined\n          float minMaxValue = 0.0;\n          float minMaxValueFound = 0.0;\n          int minMaxPosition = 0;\n          float avgValue = 0.0;\n\n          for (int wR = 0; wR < "+u+";\n              wR += "+a+") {\n            int xR = xRCorner + wR;\n\n            if (xR < 0 || xR >= "+t.inHeight+") {\n              continue;\n            }\n\n            for (int wC = 0; wC < "+l+";\n                wC += "+s+") {\n              int xC = xCCorner + wC;\n\n              if (xC < 0 || xC >= "+t.inWidth+") {\n                continue;\n              }\n\n              float value = getX(batch, xR, xC, d);\n\n              // If a min / max value has already been found, use it. If not,\n              // use the current value.\n              float currMinMaxValue = mix(\n                  value, minMaxValue, minMaxValueFound);\n              if (value >= currMinMaxValue) {\n                minMaxValue = value;\n                minMaxValueFound = 1.0;\n                minMaxPosition = wR * "+l+" + wC;\n              }\n            }\n          }\n          setOutput(float(minMaxPosition));\n        }\n      ";else{var p=e+"("+e+"("+e+"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";"avg"===e&&(p="avgValue / count");var m=4*Math.floor(r/4),g=r%4,y="\n      if ("+d+") {\n        avgValue += dot(values, ones);\n      } else {\n        minMaxValue = max(values, minMaxValue);\n      }\n    ";this.userCode="\n      const ivec2 strides = ivec2("+i+", "+o+");\n      const ivec2 pads = ivec2("+c+", "+h+");\n      const float initializationValue = "+f+";\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float count = 0.0;\n\n      float getValue(int batch, int xR, int xC, int d) {\n        if (xC < 0 || xC >= "+t.inWidth+") {\n          return initializationValue;\n        }\n        count += 1.0;\n        return getX(batch, xR, xC, d);\n      }\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d = coords[3];\n\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // max/min x(?, ?, d) to get y(yR, yC, d).\n        // ? = to be determined\n        vec4 minMaxValue = vec4("+f+");\n        float avgValue = 0.0;\n        count = 0.0;\n\n        for (int wR = 0; wR < "+u+";\n            wR += "+a+") {\n          int xR = xRCorner + wR;\n\n          if (xR < 0 || xR >= "+t.inHeight+") {\n            continue;\n          }\n\n          for (int wC = 0; wC < "+m+"; wC += 4) {\n            int xC = xCCorner + wC * "+s+";\n\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + "+s+", d),\n              getValue(batch, xR, xC + 2 * "+s+", d),\n              getValue(batch, xR, xC + 3 * "+s+", d)\n            );\n\n            "+y+"\n          }\n\n          int xC = xCCorner + "+m+";\n          if ("+(1===g)+") {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              initializationValue,\n              initializationValue,\n              initializationValue\n            );\n\n            "+y+"\n          } else if ("+(2===g)+") {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + "+s+", d),\n              initializationValue,\n              initializationValue\n            );\n\n            "+y+"\n          } else if ("+(3===g)+") {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + "+s+", d),\n              getValue(batch, xR, xC + 2 * "+s+", d),\n              initializationValue\n            );\n\n            "+y+"\n          }\n        }\n        setOutput("+p+");\n      }\n    "}},ga=function(t,e,n){if(this.variableNames=["x"],"avg"===e&&n)throw new Error("Cannot compute positions for average pool.");var r=t.filterWidth,i=t.strideDepth,o=t.strideHeight,a=t.strideWidth,s=t.dilationDepth,u=t.dilationHeight,l=t.dilationWidth,c=t.effectiveFilterDepth,h=t.effectiveFilterHeight,d=t.effectiveFilterWidth,f=t.padInfo.front,p=t.padInfo.top,m=t.padInfo.left;this.outputShape=t.outShape;var g="avg"===e,y="0.0";if(g||(y="-1.0 / 1e-20"),n)this.userCode="\n        const ivec3 strides =\n            ivec3("+i+", "+o+", "+a+");\n        const ivec3 pads = ivec3("+f+", "+p+", "+m+");\n\n        void main() {\n          ivec5 coords = getOutputCoords();\n          int batch = coords.x;\n          int ch = coords.u;\n\n          ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n          int xDCorner = xCorner.x;\n          int xRCorner = xCorner.y;\n          int xCCorner = xCorner.z;\n\n          // max/min x(?, ?, ?, ch) to get y(yD, yR, yC, ch).\n          // ? = to be determined\n          float minMaxValue = 0.0;\n          float minMaxValueFound = 0.0;\n          int minMaxPosition = 0;\n\n          for (int wD = 0; wD < "+c+";\n              wD += "+s+") {\n            int xD = xDCorner + wD;\n\n            if (xD < 0 || xD >= "+t.inDepth+") {\n              continue;\n            }\n\n            for (int wR = 0; wR < "+h+";\n                wR += "+u+") {\n              int xR = xRCorner + wR;\n\n              if (xR < 0 || xR >= "+t.inHeight+") {\n                continue;\n              }\n\n              for (int wC = 0; wC < "+d+";\n                  wC += "+l+") {\n                int xC = xCCorner + wC;\n\n                if (xC < 0 || xC >= "+t.inWidth+") {\n                  continue;\n                }\n\n                float value = getX(batch, xD, xR, xC, ch);\n\n                // If a min / max value has already been found, use it. If not,\n                // use the current value.\n                float currMinMaxValue = mix(\n                    value, minMaxValue, minMaxValueFound);\n                if (value >= currMinMaxValue) {\n                  minMaxValue = value;\n                  minMaxValueFound = 1.0;\n                  minMaxPosition =\n                      wD * "+h+" * "+d+" +\n                      wR * "+d+" + wC;;\n                }\n              }\n            }\n          }\n          setOutput(float(minMaxPosition));\n        }\n      ";else{var v=e+"("+e+"("+e+"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";"avg"===e&&(v="avgValue / count");var b=4*Math.floor(r/4),w=r%4,x="\n      if ("+g+") {\n        avgValue += dot(values, ones);\n      } else {\n        minMaxValue = max(values, minMaxValue);\n      }\n    ";this.userCode="\n      const ivec3 strides =\n        ivec3("+i+", "+o+", "+a+");\n      const ivec3 pads = ivec3("+f+", "+p+", "+m+");\n      const float initializationValue = "+y+";\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float count = 0.0;\n\n      float getValue(int batch, int xD, int xR, int xC, int ch) {\n        if (xC < 0 || xC >= "+t.inWidth+") {\n          return initializationValue;\n        }\n        count += 1.0;\n        return getX(batch, xD, xR, xC, ch);\n      }\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n        int xDCorner = xCorner.x;\n        int xRCorner = xCorner.y;\n        int xCCorner = xCorner.z;\n\n        // max/min x(?, ?, ?, d) to get y(yD, yR, yC, ch).\n        // ? = to be determined\n        vec4 minMaxValue = vec4("+y+");\n        float avgValue = 0.0;\n        count = 0.0;\n\n        for (int wD = 0; wD < "+c+";\n            wD += "+s+") {\n          int xD = xDCorner + wD;\n\n          if (xD < 0 || xD >= "+t.inDepth+") {\n            continue;\n          }\n\n          for (int wR = 0; wR < "+h+";\n            wR += "+u+") {\n            int xR = xRCorner + wR;\n\n            if (xR < 0 || xR >= "+t.inHeight+") {\n              continue;\n            }\n\n            for (int wC = 0; wC < "+b+"; wC += 4) {\n              int xC = xCCorner + wC * "+l+";\n\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + "+l+", ch),\n                getValue(batch, xD, xR, xC + 2 * "+l+", ch),\n                getValue(batch, xD, xR, xC + 3 * "+l+", ch)\n              );\n\n              "+x+"\n            }\n\n            int xC = xCCorner + "+b+";\n            if ("+(1===w)+") {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                initializationValue,\n                initializationValue,\n                initializationValue\n              );\n\n              "+x+"\n            } else if ("+(2===w)+") {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + "+l+", ch),\n                initializationValue,\n                initializationValue\n              );\n\n              "+x+"\n            } else if ("+(3===w)+") {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + "+l+", ch),\n                getValue(batch, xD, xR, xC + 2 * "+l+", ch),\n                initializationValue\n              );\n\n              "+x+"\n            }\n          }\n          setOutput("+v+");\n        }\n      }\n    "}},ya=function(t,e){this.variableNames=["x"];var n=t.windowSize,r=t.batchSize,i=t.inSize,o=Math.ceil(i/n);this.outputShape=[r,o];var a="0.0",s="";"prod"===e?a="1.0":"min"===e?(a="1.0 / 1e-20",s="min"):"max"===e&&(a="-1.0 / 1e-20",s="max");var u=e+"("+e+"("+e+"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";"sum"===e?u="sumValue":"prod"===e?u="prodValue":"all"===e?u="allValue":"any"===e&&(u="anyValue");var l=4*Math.floor(n/4),c=n%4,h="\n      if ("+("sum"===e)+") {\n        sumValue += dot(values, ones);\n      } else if ("+("prod"===e)+") {\n        vec2 tmp = vec2(values[0], values[1]) * vec2(values[2], values[3]);\n        prodValue *= tmp[0] * tmp[1];\n      } else {\n        minMaxValue = "+s+"(values, minMaxValue);\n      }\n    ",d="vec4";"all"===e?(a="1.0",h="\n        bool reducedAllValue = all(values);\n        float floatedReducedAllValue = float(reducedAllValue);\n        allValue = float(allValue >= 1.0 && floatedReducedAllValue >= 1.0);\n      ",d="bvec4"):"any"===e&&(a="0.0",h="\n        bool reducedAnyValue = any(values);\n        float floatedReducedAnyValue = float(reducedAnyValue);\n        anyValue = float(anyValue >= 1.0 || floatedReducedAnyValue >= 1.0);\n      ",d="bvec4");var f="";i%n>0&&(f="\n        if (inIdx < 0 || inIdx >= "+i+") {\n          return initializationValue;\n        }\n      "),this.userCode="\n      const float initializationValue = "+a+";\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float getValue(int batch, int inIdx) {\n        "+f+"\n        return getX(batch, inIdx);\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = outIdx * "+n+";\n\n        vec4 minMaxValue = vec4("+a+");\n        float prodValue = 1.0;\n        float sumValue = 0.0;\n        float allValue = 1.0;\n        float anyValue = 0.0;\n\n        for (int i = 0; i < "+l+"; i += 4) {\n          int inIdx = inOffset + i;\n          "+d+" values = "+d+"(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            getValue(batch, inIdx + 3)\n          );\n\n          "+h+"\n        }\n\n        int inIdx = inOffset + "+l+";\n        if ("+(1===c)+") {\n          "+d+" values = "+d+"(\n            getValue(batch, inIdx),\n            initializationValue,\n            initializationValue,\n            initializationValue\n          );\n\n          "+h+"\n        } else if ("+(2===c)+") {\n          "+d+" values = "+d+"(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            initializationValue,\n            initializationValue\n          );\n\n          "+h+"\n        } else if ("+(3===c)+") {\n          "+d+" values = "+d+"(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            initializationValue\n          );\n\n          "+h+"\n        }\n        setOutput("+u+");\n      }\n    "},va=function(t,e){this.variableNames=["A"],this.usesPackedTextures=!0,this.outputShape=t;for(var n="",r=0;r<4;r++){var i="thisRC = rc;";r%2==1&&(i+="thisRC.z += 1;"),r>1&&(i+="thisRC.y += 1;"),n+="\n        "+i+"\n        "+(r>0?"if(thisRC.y < rows && thisRC.z < cols){":"")+"\n          int flatIndex = getFlatIndex(thisRC);\n\n          ivec3 inputRC = inputCoordsFromReshapedOutCoords(flatIndex);\n          vec2 inputRCInnerDims = vec2(float(inputRC.y),float(inputRC.z));\n\n          result["+r+"] =\n            getChannel(getA(inputRC.x, inputRC.y, inputRC.z), inputRCInnerDims);\n        "+(r>0?"}":"")+"\n      "}this.userCode="\n      \n    ivec3 inputCoordsFromReshapedOutCoords(int index) {\n      "+Di(["r","c","d"],e)+"\n      return ivec3(r, c, d);\n    }\n  \n      "+Ri(t)+"\n\n      void main() {\n        ivec3 rc = getOutputCoords();\n\n        vec4 result = vec4(0.);\n\n        ivec3 thisRC;\n        int rows = "+t[1]+";\n        int cols = "+t[2]+";\n\n        "+n+"\n\n        setOutput(result);\n      }\n    "},ba=function(t,e,n){this.variableNames=["dy"],this.outputShape=[],this.outputShape=e.shape;var r=e.shape,i=r[1],o=r[2],a=t.shape,s=a[1],u=a[2],l=[n&&s>1?i-1:i,n&&u>1?o-1:o],c=[n&&s>1?s-1:s,n&&u>1?u-1:u],h=l[0]/c[0],d=l[1]/c[1],f=1/h,p=1/d,m=2*Math.ceil(f)+2,g=2*Math.ceil(p)+2;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        int r = coords[1];\n        int c = coords[2];\n\n        float accumulator = 0.0;\n\n        const float heightScale = float("+h+");\n        const float widthScale = float("+d+");\n\n        const float invHeightScale = float("+f+");\n        const float invWidthScale = float("+p+");\n\n        const int winHeight = int("+m+");\n        const int winWidth = int("+g+");\n\n        // Compute bounds for where in dy we will look\n        float startRLerp = floor(float(r) * invHeightScale);\n        int startDyR = int(startRLerp - float(winHeight / 2));\n\n        float startCLerp = floor(float(c) * invWidthScale);\n        int startDyC = int(startCLerp - float(winWidth / 2));\n\n        // Loop over dy\n        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {\n          int dyR = dyROffset + startDyR;\n\n          // Guard against the window exceeding the bounds of dy\n          if (dyR < 0 || dyR >= "+s+") {\n            continue;\n          }\n\n          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {\n            int dyC = dyCOffset + startDyC;\n\n            // Guard against the window exceeding the bounds of dy\n            if (dyC < 0 || dyC >= "+u+") {\n              continue;\n            }\n\n            float dxR = float(dyR) * heightScale;\n            int topDxRIndex = int(floor(dxR));\n            int bottomDxRIndex = int(min(ceil(dxR), "+(i-1)+".0));\n            float dxRLerp = dxR - float(topDxRIndex);\n            float inverseDxRLerp = 1.0 - dxRLerp;\n\n            float dxC = float(dyC) * widthScale;\n            int leftDxCIndex = int(floor(dxC));\n            int rightDxCIndex = int(min(ceil(dxC), "+(o-1)+".0));\n            float dxCLerp = dxC - float(leftDxCIndex);\n            float inverseDxCLerp = 1.0 - dxCLerp;\n\n            if (r == topDxRIndex && c == leftDxCIndex) {\n              // topLeft\n              accumulator +=\n                getDy(b, dyR, dyC, d) * inverseDxRLerp * inverseDxCLerp;\n            }\n\n            if (r == topDxRIndex && c == rightDxCIndex) {\n              // topRight\n              accumulator += getDy(b, dyR, dyC, d) * inverseDxRLerp * dxCLerp;\n            }\n\n            if (r == bottomDxRIndex && c == leftDxCIndex) {\n              // bottomLeft\n              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * inverseDxCLerp;\n            }\n\n            if (r == bottomDxRIndex && c == rightDxCIndex) {\n              // bottomRight\n              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * dxCLerp;\n            }\n          }\n        }\n        // End loop over dy\n\n        setOutput(accumulator);\n      }\n    "},wa=function(t,e,n,r){this.variableNames=["A"],this.outputShape=[];var i=t[1],o=t[2];this.outputShape=[t[0],e,n,t[3]];var a=[r&&e>1?i-1:i,r&&n>1?o-1:o],s=[r&&e>1?e-1:e,r&&n>1?n-1:n];this.userCode="\n      const vec2 effectiveInputOverOutputRatioRC = vec2(\n          "+a[0]/s[0]+",\n          "+a[1]/s[1]+");\n      const vec2 inputShapeRC = vec2("+i+".0, "+o+".0);\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        ivec2 yRC = coords.yz;\n\n        // Fractional source index.\n        vec2 sourceFracIndexRC = vec2(yRC) * effectiveInputOverOutputRatioRC;\n\n        // Compute the four integer indices.\n        ivec2 sourceFloorRC = ivec2(sourceFracIndexRC);\n        ivec2 sourceCeilRC = ivec2(\n          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));\n\n        float topLeft = getA(b, sourceFloorRC.x, sourceFloorRC.y, d);\n        float bottomLeft = getA(b, sourceCeilRC.x, sourceFloorRC.y, d);\n        float topRight = getA(b, sourceFloorRC.x, sourceCeilRC.y, d);\n        float bottomRight = getA(b, sourceCeilRC.x, sourceCeilRC.y, d);\n\n        vec2 fracRC = sourceFracIndexRC - vec2(sourceFloorRC);\n\n        float top = topLeft + (topRight - topLeft) * fracRC.y;\n        float bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;\n        float newValue = top + (bottom - top) * fracRC.x;\n\n        setOutput(newValue);\n      }\n    "},xa=function(t,e,n,r){this.variableNames=["A"],this.usesPackedTextures=!0,this.outputShape=[];var i=t[1],o=t[2],a=t[3];this.outputShape=[t[0],e,n,a];var s=[r&&e>1?i-1:i,r&&n>1?o-1:o],u=[r&&e>1?e-1:e,r&&n>1?n-1:n];this.userCode="\n      const vec3 effectiveInputOverOutputRatioRC = vec3(\n          "+s[0]/u[0]+",\n          "+s[1]/u[1]+",\n          "+s[1]/u[1]+");\n      const vec3 inputShapeRC = vec3("+i+".0, "+o+".0,\n                                     "+o+".0);\n\n      float getAValue(int b, int r, int c, int d) {\n        return getChannel(getA(b, r, c, d), vec2(c, d));\n      }\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        // Calculate values for next column in yRC.z.\n        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);\n\n        // Fractional source index.\n        vec3 sourceFracIndexRC = vec3(yRC) * effectiveInputOverOutputRatioRC;\n\n        // Compute the four integer indices.\n        ivec3 sourceFloorRC = ivec3(sourceFracIndexRC);\n        ivec3 sourceCeilRC = ivec3(\n          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));\n        \n        // Should we calculate next column and row elements in 2x2 packed cell.\n        bool hasNextCol = d < "+(a-1)+"; \n        bool hasNextRow = coords.z < "+(n-1)+";\n\n        // In parallel, construct four corners for all four components in\n        // packed 2x2 cell.\n        vec4 topLeft = vec4(\n          getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d),\n          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d + 1) : 0.0);\n\n        vec4 bottomLeft = vec4(\n          getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d),\n          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d + 1) : 0.0);\n\n        vec4 topRight = vec4(\n          getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d),\n          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d + 1) : 0.0);\n\n        vec4 bottomRight = vec4(\n          getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d),\n          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d + 1) : 0.0);\n\n        vec3 fracRC = sourceFracIndexRC - vec3(sourceFloorRC);\n\n        vec4 top = mix(topLeft, topRight, fracRC.yyzz);\n        vec4 bottom = mix(bottomLeft, bottomRight, fracRC.yyzz);\n        vec4 newValue = mix(top, bottom, fracRC.x);\n\n        setOutput(newValue);\n      }\n    "},_a=function(t,e,n){this.variableNames=["dy"],this.outputShape=[],this.outputShape=e.shape;var r=e.shape,i=r[1],o=r[2],a=t.shape,s=a[1],u=a[2],l=[n&&s>1?i-1:i,n&&u>1?o-1:o],c=[n&&s>1?s-1:s,n&&u>1?u-1:u],h=l[0]/c[0],d=l[1]/c[1],f=1/h,p=1/d,m=2*Math.ceil(f)+2,g=2*Math.ceil(p)+2;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        int r = coords[1];\n        int c = coords[2];\n\n        float accumulator = 0.0;\n\n        const float heightScale = float("+h+");\n        const float widthScale = float("+d+");\n\n        const float invHeightScale = float("+f+");\n        const float invWidthScale = float("+p+");\n\n        const int winHeight = int("+m+");\n        const int winWidth = int("+g+");\n\n        // Compute bounds for where in dy we will look\n        float startRLerp = floor(float(r) * invHeightScale);\n        int startDyR = int(floor(startRLerp - float(winHeight / 2)));\n\n        float startCLerp = floor(float(c) * invWidthScale);\n        int startDyC = int(floor(startCLerp - float(winWidth / 2)));\n\n        // Loop over dy\n        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {\n          int dyR = dyROffset + startDyR;\n\n          // Guard against the window exceeding the bounds of dy\n          if (dyR < 0 || dyR >= "+s+") {\n            continue;\n          }\n\n          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {\n            int dyC = dyCOffset + startDyC;\n\n            // Guard against the window exceeding the bounds of dy\n            if (dyC < 0 || dyC >= "+u+") {\n              continue;\n            }\n\n            float sourceFracRow =\n              float("+l[0]+") *\n                (float(dyR) / float("+c[0]+"));\n\n            float sourceFracCol =\n                float("+l[1]+") *\n                  (float(dyC) / float("+c[1]+"));\n\n            int sourceNearestRow = int(min(\n                float(int("+i+") - 1),\n                "+n+" ? float(round(sourceFracRow)) :\n                                  float(floor(sourceFracRow))));\n\n            int sourceNearestCol = int(min(\n                float(int("+o+") - 1),\n                "+n+" ? float(round(sourceFracCol)) :\n                                  float(floor(sourceFracCol))));\n\n            if (r == sourceNearestRow && c == sourceNearestCol) {\n              accumulator += getDy(b, dyR, dyC, d);\n            }\n          }\n        }\n        // End loop over dy\n\n        setOutput(accumulator);\n      }\n    "},Ca=function(t,e,n,r){this.variableNames=["A"],this.outputShape=[];var i=t[1],o=t[2];this.outputShape=[t[0],e,n,t[3]];var a=[r&&e>1?i-1:i,r&&n>1?o-1:o],s=[r&&e>1?e-1:e,r&&n>1?n-1:n];this.userCode="\n      const vec2 effectiveInputOverOutputRatioRC = vec2(\n          "+a[0]/s[0]+",\n          "+a[1]/s[1]+");\n      const vec2 inputShapeRC = vec2("+i+".0, "+o+".0);\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        ivec2 yRC = coords.yz;\n\n        // Fractional source index.\n        vec2 sourceFracIndexRC = vec2(yRC) * effectiveInputOverOutputRatioRC;\n\n        // Compute the coordinators of nearest neighbor point.\n        ivec2 sourceNearestRC = ivec2(\n          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + "+(r?"0.5":"0.0")+")));\n\n        float newValue = getA(b, sourceNearestRC.x, sourceNearestRC.y, d);\n\n        setOutput(newValue);\n      }\n    "},ka=function(t,e){this.variableNames=["x"];var n=t.length;if(n>4)throw new Error("WebGL backend: Reverse of rank-"+n+" tensor is not yet supported");if(this.outputShape=t,1!==n){var r=t.map((function(n,r){return function(n){return-1!==e.indexOf(n)&&1!==t[n]?t[n]+" - coords["+n+"] - 1":"coords["+n+"]"}(r)})).join(","),i=Ui(n);this.userCode="\n      void main() {\n        "+i+" coords = getOutputCoords();\n        setOutput(getX("+r+"));\n      }\n    "}else this.userCode="\n        void main() {\n          int coord = getOutputCoords();\n          setOutput(getX("+t[0]+" - coord - 1));\n        }\n      "},Sa=function(t,e){this.variableNames=["x"],this.usesPackedTextures=!0;var n=t.length;if(n>4)throw new Error("WebGL backend: Reverse of rank-"+n+" tensor is not yet supported");this.outputShape=t;var r=Ni("rc",n),i=r[n-1]+" + 1 < "+this.outputShape[n-1],o=r[n-2]+" + 1 < "+this.outputShape[n-2],a=Ui(n);function s(n){var r=t.map((function(r,i){return function(n,r){return-1!==e.indexOf(n)&&1!==t[n]?t[n]+" - "+r[n]+" - 1":""+r[n]}(i,n)}));return"getChannel(getX("+r.join(",")+"), vec2("+r.slice(-2).join(",")+"))"}this.userCode=1===n?"\n        void main(){\n          int rc = getOutputCoords();\n          vec4 result = vec4(0.);\n          result.r = getChannel(getX("+t[0]+" - rc - 1),\n            "+t[0]+" - rc - 1);\n          if("+i+"){\n              result.g = getChannel(getX("+t[0]+" - (rc  + 1) - 1),\n                "+t[0]+" - (rc  + 1) - 1);\n          }\n          setOutput(result);\n        }\n      ":"\n        void main() {\n          "+a+" rc = getOutputCoords();\n          vec4 result = vec4(0.);\n          result.r = "+function(t){return s(t)}(r.slice())+";\n          if("+i+"){\n            result.g = "+function(t){return t[n-1]="("+t[n-1]+" + 1)",s(t)}(r.slice())+";\n          }\n          if("+o+") {\n            result.b = "+function(t){return t[n-2]="("+t[n-2]+" + 1)",s(t)}(r.slice())+";\n            if("+i+") {\n              result.a = "+function(t){return t[n-1]="("+t[n-1]+" + 1)",t[n-2]="("+t[n-2]+" + 1)",s(t)}(r.slice())+";\n            }\n          }\n          setOutput(result);\n        }\n    "},Ea=function(t,e,n,r,i,o,a){void 0===a&&(a=!0),this.variableNames=["updates","indices","defaultValue"],this.outputShape=o;var s=Ui(i.length),u=Ui(o.length),l="";1===n?l="i":2===n&&(l="i, j");var c="";1===r?c="i":2===r&&(c="i, coords[1]"),this.userCode="\n        "+s+" strides = "+s+"("+i+");\n\n        void main() {\n          "+u+" coords = getOutputCoords();\n          float sum = 0.0;\n          bool found = false;\n          for (int i = 0; i < "+t+"; i++) {\n            int flattenedIndex = 0;\n            for (int j = 0; j < "+e+"; j++) {\n              int index = round(getIndices("+l+"));\n              flattenedIndex += index * "+(e>1?"strides[j]":"strides")+";\n            }\n            if (flattenedIndex == coords[0]) {\n              sum += getUpdates("+c+");\n              found = true;\n            }\n          }\n          setOutput(mix(getDefaultValue(), sum, float(found)));\n        }\n      "},Oa=function(t,e){this.variableNames=["x","segmentIds"];var n=t.windowSize,r=t.batchSize,i=t.inSize,o=t.numSegments,a=o*Math.ceil(i/n);this.outputShape=[r,a];var s=4*Math.floor(n/4),u=n%4,l="\n        sumValue += dot(values, segFilter);\n    ",c="";i%n>0&&(c="\n        if (inIdx < 0 || inIdx >= "+i+") {\n          return initializationValue;\n        }\n      ");var h="";i%n>0&&(h="\n        if (inIdx < 0 || inIdx >= "+i+") {\n          return -1.0;\n        }\n      "),this.userCode="\n      const float initializationValue = 0.0;\n\n      float getValue(int batch, int inIdx) {\n        "+c+"\n        return getX(batch, inIdx);\n      }\n\n      float getSegmentIdAtIndex(int inIdx) {\n        "+h+"\n        return getSegmentIds(inIdx);\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = int(floor(float(outIdx) / float(\n          "+o+")) * float("+n+"));\n        int currentSeg = int(mod(float(outIdx), float("+o+")));\n\n        float sumValue = 0.0;\n\n        for (int i = 0; i < "+s+"; i += 4) {\n          int inIdx = inOffset + i;\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            getValue(batch, inIdx + 3)\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 3)) == currentSeg ? 1 : 0\n          );\n\n          "+l+"\n        }\n\n        int inIdx = inOffset + "+s+";\n        if ("+(1===u)+") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            initializationValue,\n            initializationValue,\n            initializationValue\n          );\n\n          int inIdxSeg = int(getSegmentIdAtIndex(inIdx));\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            0,\n            0,\n            0\n          );\n\n          "+l+"\n        } else if ("+(2===u)+") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            initializationValue,\n            initializationValue\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n              0,\n              0\n          );\n\n          "+l+"\n        } else if ("+(3===u)+") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            initializationValue\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,\n            0\n          );\n\n          "+l+"\n        }\n        setOutput(sumValue);\n      }\n    "},Aa=function(t,e,n){var r,i;if(this.variableNames=["c","a","b"],this.outputShape=e,n>4)throw Error("Where for rank "+n+" is not yet supported");if(1===n)i="resRC",r="resRC";else{for(var o=["resRC.x","resRC.y","resRC.z","resRC.w"],a=[],s=[],u=0;u<e.length;u++)s.push(""+o[u]),u<t&&a.push(""+o[u]);r=a.join(),i=s.join()}var l=Ui(n);this.userCode="\n      void main() {\n        "+l+" resRC = getOutputCoords();\n        float cVal = getC("+r+");\n        if (cVal >= 1.0) {\n          setOutput(getA("+i+"));\n        } else {\n          setOutput(getB("+i+"));\n        }\n      }\n    "},Na=function(){function t(t){this.variableNames=["source"],this.outputShape=t,this.rank=t.length;var e,n=Ui(this.rank),r="uniform int start["+this.rank+"];",i=function(t){if(1===t)return"sourceLoc";if(t<=6)return Ta.slice(0,t).map((function(t){return"sourceLoc."+t})).join(",");throw Error("Slicing for rank "+t+" is not yet supported")}(this.rank);e="\n        "+n+" sourceLoc;\n        "+n+" coords = getOutputCoords();\n        "+t.map((function(t,e){return"sourceLoc."+Ta[e]+" = start["+e+"] + coords."+Ta[e]+";"})).join("\n")+"\n      ",this.userCode="\n      "+r+"\n      void main() {\n        "+e+"\n        setOutput(getSource("+i+"));\n      }\n    "}return t.prototype.getCustomSetupFunc=function(t){var e=this;if(t.length!==this.rank)throw Error("The rank ("+this.rank+") of the program must match the length of start ("+t.length+")");return function(n,r){null==e.startLoc&&(e.startLoc=n.getUniformLocationNoThrow(r,"start"),null==e.startLoc)||n.gl.uniform1iv(e.startLoc,t)}},t}(),Ta=["x","y","z","w","u","v"],Da=function(){function t(t){this.variableNames=["source"],this.usesPackedTextures=!0,this.outputShape=t,this.rank=t.length;var e=Ui(this.rank),n=Ni("coords",this.rank),r=Ni("sourceLoc",this.rank),i=1===this.rank?"sourceLoc":"vec2("+r.slice(-2).join()+")",o="getChannel(getSource("+r.join()+"), "+i+")",a="\n      result.x = "+o+";\n      if (++"+n[this.rank-1]+" < "+t[this.rank-1]+") {\n        ++"+r[this.rank-1]+";\n        result.y = "+o+";\n        --"+r[this.rank-1]+";\n      }\n    ",s=1===this.rank?"":"\n      --"+n[this.rank-1]+";\n      if (++"+n[this.rank-2]+" < "+t[this.rank-2]+") {\n        ++"+r[this.rank-2]+";\n        result.z = "+o+";\n        if (++"+n[this.rank-1]+" < "+t[this.rank-1]+") {\n          ++"+r[this.rank-1]+";\n          result.w = "+o+";\n        }\n      }\n    ",u=this.rank<=4?"sourceLoc = coords +\n            "+e+"("+t.map((function(t,e){return"start["+e+"]"})).join()+");":t.map((function(t,e){return r[e]+" = "+n[e]+" + start["+e+"];"})).join("\n");this.userCode="\n      uniform int start["+this.rank+"];\n      void main() {\n        "+e+" coords = getOutputCoords();\n        "+e+" sourceLoc;\n        "+u+" \n        vec4 result = vec4(0.);\n        "+a+"\n        "+s+"\n        setOutput(result);\n      }\n    "}return t.prototype.getCustomSetupFunc=function(t){var e=this;if(t.length!==this.rank)throw Error("The rank ("+this.rank+") of the program must match the length of start ("+t.length+")");return function(n,r){null==e.startLoc&&(e.startLoc=n.getUniformLocationNoThrow(r,"start"),null==e.startLoc)||n.gl.uniform1iv(e.startLoc,t)}},t}(),Ra=function(t,e,n){this.variableNames=["x"],this.outputShape=n;var r=n.length,i=Ui(n.length),o=Ui(n.length),a="";if(1===r)a="coords * strides + begin";else{var s=0;a=n.map((function(t,e){return s++,1===n.length?"coords * strides["+e+"] + begin["+e+"]":"coords["+(s-1)+"] * strides["+e+"] + begin["+e+"]"})).join(",")}this.userCode="\n      "+i+" begin = "+i+"("+t+");\n      "+i+" strides = "+i+"("+e+");\n\n      void main() {\n        "+o+" coords = getOutputCoords();\n        setOutput(getX("+a+"));\n      }\n    "},Ia=function(){function t(t){this.gpgpu=t,this.numUsedTextures=0,this.numFreeTextures=0,this.freeTextures={},this.logEnabled=!1,this.usedTextures={}}return t.prototype.acquireTexture=function(t,e,n){var r,i=Ma(e,n),o=Fa(t,i,n);if(o in this.freeTextures||(this.freeTextures[o]=[]),o in this.usedTextures||(this.usedTextures[o]=[]),this.freeTextures[o].length>0){this.numFreeTextures--,this.numUsedTextures++,this.log();var a=this.freeTextures[o].shift();return this.usedTextures[o].push(a),a}return this.numUsedTextures++,this.log(),i===Nt.PACKED_2X2_FLOAT32?r=this.gpgpu.createPackedMatrixTexture(t[0],t[1]):i===Nt.PACKED_2X2_FLOAT16?r=this.gpgpu.createFloat16PackedMatrixTexture(t[0],t[1]):i===Nt.UNPACKED_FLOAT32?r=this.gpgpu.createFloat32MatrixTexture(t[0],t[1]):i===Nt.UNPACKED_FLOAT16?r=this.gpgpu.createFloat16MatrixTexture(t[0],t[1]):i===Nt.PACKED_4X1_UNSIGNED_BYTE&&(r=this.gpgpu.createUnsignedBytesMatrixTexture(t[0],t[1])),this.usedTextures[o].push(r),r},t.prototype.releaseTexture=function(t,e,n,r){if(null!=this.freeTextures){var i=Fa(e,Ma(n,r),r);i in this.freeTextures||(this.freeTextures[i]=[]),this.freeTextures[i].push(t),this.numFreeTextures++,this.numUsedTextures--;var o=this.usedTextures[i],a=o.indexOf(t);if(a<0)throw new Error("Cannot release a texture that was never provided by this texture manager");o.splice(a,1),this.log()}},t.prototype.log=function(){this.logEnabled&&console.log("Free/Used",this.numFreeTextures+" / "+this.numUsedTextures,"("+(this.numFreeTextures+this.numUsedTextures)+")")},t.prototype.getNumUsedTextures=function(){return this.numUsedTextures},t.prototype.getNumFreeTextures=function(){return this.numFreeTextures},t.prototype.dispose=function(){var t=this;if(null!=this.freeTextures){for(var e in this.freeTextures)this.freeTextures[e].forEach((function(e){t.gpgpu.deleteMatrixTexture(e)}));for(var e in this.usedTextures)this.usedTextures[e].forEach((function(e){t.gpgpu.deleteMatrixTexture(e)}));this.freeTextures=null,this.usedTextures=null,this.numUsedTextures=0,this.numFreeTextures=0}},t}();function Ma(t,e){if(t===At.UPLOAD)return Nt.PACKED_2X2_FLOAT32;if(t===At.RENDER||null==t)return function(t){return u().getBool("WEBGL_RENDER_FLOAT32_ENABLED")?t?Nt.PACKED_2X2_FLOAT32:Nt.UNPACKED_FLOAT32:t?Nt.PACKED_2X2_FLOAT16:Nt.UNPACKED_FLOAT16}(e);if(t===At.DOWNLOAD||t===At.PIXELS)return Nt.PACKED_4X1_UNSIGNED_BYTE;throw new Error("Unknown logical texture type "+t)}function Fa(t,e,n){return t[0]+"_"+t[1]+"_"+e+"_"+n}var Pa=function(t,e){this.variableNames=["A"];for(var n=new Array(t.length),r=0;r<n.length;r++)n[r]=t[r]*e[r];this.outputShape=n,this.rank=n.length;var i=Ui(this.rank),o=function(t){var e=t.length;if(e>5)throw Error("Tile for rank "+e+" is not yet supported");if(1===e)return"imod(resRC, "+t[0]+")";for(var n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u"],r=[],i=0;i<t.length;i++)r.push("imod("+n[i]+", "+t[i]+")");return r.join()}(t);this.userCode="\n      void main() {\n        "+i+" resRC = getOutputCoords();\n        setOutput(getA("+o+"));\n      }\n    "},ja=function(t,e){this.variableNames=["A"];for(var n=new Array(t.length),r=0;r<n.length;r++)n[r]=t[e[r]];this.outputShape=n,this.rank=n.length;var i=Ui(this.rank),o=function(t){var e=t.length;if(e>6)throw Error("Transpose for rank "+e+" is not yet supported");for(var n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u","resRC.v"],r=new Array(e),i=0;i<t.length;i++)r[t[i]]=n[i];return r.join()}(e);this.userCode="\n    void main() {\n      "+i+" resRC = getOutputCoords();\n      setOutput(getA("+o+"));\n    }\n    "},za=function(t,e){this.variableNames=["A"],this.usesPackedTextures=!0;for(var n=new Array(t.length),r=0;r<n.length;r++)n[r]=t[e[r]];if(this.outputShape=n,this.rank=n.length,this.rank>6)throw Error("Packed transpose for rank "+this.rank+" is not yet supported.");var i=Ui(this.rank),o=Ai("rc",this.rank),a=new Array(this.rank);for(r=0;r<e.length;r++)a[e[r]]=o[r];var s="vec2("+a.slice(-2).join()+")",u="++"+o[this.rank-1]+" < "+n[this.rank-1],l="getChannel(getA("+a.join()+"), "+s+")";this.userCode="\n    void main() {\n      "+i+" rc = getOutputCoords();\n      vec4 result = vec4(0.);\n      result[0] = "+l+";\n      if("+u+") {\n        result[1] = "+l+";\n      }\n      --"+o[this.rank-1]+";\n      if(++"+o[this.rank-2]+" < "+n[this.rank-2]+") {\n        result[2] = "+l+";\n        if("+u+") {\n          result[3] = "+l+";\n        }\n      }  \n      setOutput(result);\n    }\n    "},La=function(t,e){this.variableNames=["A"],this.outputShape=t,this.userCode="\n      float unaryOperation(float x) {\n        "+e+"\n      }\n\n      void main() {\n        float x = getAAtOutCoords();\n        float y = unaryOperation(x);\n\n        setOutput(y);\n      }\n    "},Ba="if (isnan(x)) return x;",Ua="return abs(x);",$a=Ba+"\n  return (x < 0.0) ? 0.0 : x;\n",Va=Ba+"\n  return (x < 0.0) ? 0.0 : min(6.0, x);\n",Wa="return (x >= 0.0) ? x : (exp(x) - 1.0);",qa="return -x;",Ha="return ceil(x);",Ga="return floor(x);",Xa="return exp(x);",Ka="return exp(x) - 1.0;",Ya="return x;",Za="\n  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n",Qa="\n  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n",Ja="\n  vec4 result;\n\n  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);\n  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);\n  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);\n  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);\n\n  return result;\n",ts=function(t,e){this.variableNames=["A"],this.usesPackedTextures=!0,this.outputShape=t,this.userCode="\n      vec4 unaryOperation(vec4 x) {\n        "+e+"\n      }\n\n      void main() {\n        vec4 x = getAAtOutCoords();\n        vec4 y = unaryOperation(x);\n\n        setOutput(y);\n      }\n    "},es=function(t){this.variableNames=["A"],this.usesPackedTextures=!0,this.outputShape=t;var e=t.length,n=Ni("rc",e),r=Ui(e),i=function(t,e){if(1===t)return"rc";for(var n="",r=0;r<t;r++)n+=e[r],r<t-1&&(n+=",");return n}(e,n),o=n.slice(-2),a=e<=1?"rc":"vec2("+o.join(",")+")";this.userCode="\n      void main() {\n        "+r+" rc = getOutputCoords();\n        vec4 packedInput = getA("+i+");\n\n        setOutput(getChannel(packedInput, "+a+"));\n      }\n    "},ns={};function rs(t,e){if(void 0===e&&(e=!1),"linear"===t)return"return x;";if("relu"===t)return e?Za:$a;if("elu"===t)return e?Ja:Wa;if("relu6"===t)return e?Qa:Va;if("prelu"===t)return e?eo:Ji;throw new Error("Activation "+t+" has not been implemented for the WebGL backend.")}var is=function(){function t(t){if(this.gpgpu=t,this.pendingRead=new WeakMap,this.pendingDisposal=new WeakSet,this.dataRefCount=new WeakMap,this.numBytesInGPU=0,this.uploadWaitMs=0,this.downloadWaitMs=0,this.warnedAboutMemory=!1,this.disposed=!1,!u().getBool("HAS_WEBGL"))throw new Error("WebGL is not supported on this device");if(null==t){var e=It(u().getNumber("WEBGL_VERSION"));this.binaryCache=((n=u().getNumber("WEBGL_VERSION"))in ns||(ns[n]={}),ns[n]),this.gpgpu=new ea(e),this.canvas=e.canvas,this.gpgpuCreatedLocally=!0}else this.binaryCache={},this.gpgpuCreatedLocally=!1,this.canvas=t.gl.canvas;var n;this.textureManager=new Ia(this.gpgpu),this.numMBBeforeWarning=null==u().global.screen?1024:u().global.screen.height*u().global.screen.width*window.devicePixelRatio*600/1024/1024,this.texData=new Xr(this,St)}return t.prototype.register=function(t,e,n){if(this.texData.has(t))throw new Error("Data buffer is already registered");this.texData.set(t,{shape:e,dtype:n})},t.prototype.fromPixels=function(t,e){if(null==t)throw new Error("pixels passed to tf.browser.fromPixels() can not be null");var n="undefined"!=typeof OffscreenCanvas&&t instanceof OffscreenCanvas||"undefined"!=typeof HTMLCanvasElement&&t instanceof HTMLCanvasElement,r=t.data instanceof Uint8Array,i="undefined"!=typeof ImageData&&t instanceof ImageData,o="undefined"!=typeof HTMLVideoElement&&t instanceof HTMLVideoElement,a="undefined"!=typeof HTMLImageElement&&t instanceof HTMLImageElement,s=o?[t.videoWidth,t.videoHeight]:[t.width,t.height],l=s[0],c=s[1],h=[c,l],d=[c,l,e];if(!(n||r||i||o||a))throw new Error("pixels passed to tf.browser.fromPixels() must be either an HTMLVideoElement, HTMLImageElement, HTMLCanvasElement, ImageData in browser, or OffscreenCanvas, ImageData in webworker or {data: Uint32Array, width: number, height: number}, but was "+t.constructor.name);(a||o)&&(null==this.fromPixels2DContext&&(this.fromPixels2DContext=Mt(u().getNumber("WEBGL_VERSION")).getContext("2d")),this.fromPixels2DContext.canvas.width=l,this.fromPixels2DContext.canvas.height=c,this.fromPixels2DContext.drawImage(t,0,0,l,c),t=this.fromPixels2DContext.canvas);var f,p,m=this.makeTensorHandle(h,"int32");if(this.texData.get(m.dataId).usage=At.PIXELS,this.gpgpu.uploadPixelDataToTexture(this.getTexture(m.dataId),t),u().getBool("WEBGL_PACK")){f=new Mo(d);var g=this.makePackedTensor(f.outputShape,m.dtype);p=this.compileAndRun(f,[m],g)}else f=new Io(d),p=this.compileAndRun(f,[m]);return this.disposeData(m.dataId),p},t.prototype.makeTensorHandle=function(t,e){var n={};return this.register(n,t,e),{dataId:n,shape:t,dtype:e}},t.prototype.write=function(t,e){if(null==e)throw new Error("MathBackendWebGL.write(): values can not be null");if(u().getBool("DEBUG"))for(var n=0;n<e.length;n++){var r=e[n];if(!Bt(r)){if(u().getBool("WEBGL_RENDER_FLOAT32_CAPABLE"))throw Error("The value "+r+" cannot be represented with your current settings. Consider enabling float32 rendering: 'tf.env().set('WEBGL_RENDER_FLOAT32_ENABLED', true);'");throw Error("The value "+r+" cannot be represented on this device.")}}var i=this.texData.get(t);if("complex64"===i.dtype)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");this.releaseGPUData(t),i.usage=At.UPLOAD,i.values=e},t.prototype.readSync=function(t){var e=this.texData.get(t),n=e.values,r=e.dtype,i=e.complexTensors,o=e.shape;if(null!=e.slice){var a;a=e.isPacked?new ts(o,Ya):new La(o,Ya);var s=this.compileAndRun(a,[{dataId:t,shape:o,dtype:r}]),u=this.readSync(s.dataId);return s.dispose(),u}if(null!=n)return this.convertAndCacheOnCPU(t);if("string"===r)return n;var l,c,h=null!=this.activeTimers;return h&&(l=G()),c="complex64"===r?mi(i.real.dataSync(),i.imag.dataSync()):this.getValuesFromTexture(t),h&&(this.downloadWaitMs+=G()-l),this.convertAndCacheOnCPU(t,c)},t.prototype.read=function(t){return o(this,void 0,void 0,(function(){var e,n,r,i,o,s,l,c,h,d,f,p,m,g,y,b,w,x,_;return a(this,(function(a){switch(a.label){case 0:if(this.pendingRead.has(t))return e=this.pendingRead.get(t),[2,new Promise((function(t){return e.push(t)}))];if(n=this.texData.get(t),r=n.values,i=n.shape,o=n.dtype,s=n.complexTensors,l=n.isPacked,null!=n.slice)return c=l?new ts(i,Ya):new La(i,Ya),h=this.compileAndRun(c,[{dataId:t,shape:i,dtype:o}]),d=this.read(h.dataId),h.dispose(),[2,d];if(null!=r)return[2,this.convertAndCacheOnCPU(t)];if(!u().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")&&2===u().getNumber("WEBGL_VERSION"))throw new Error("tensor.data() with WEBGL_DOWNLOAD_FLOAT_ENABLED=false and WEBGL_VERSION=2 not yet supported.");return f=null,"complex64"!==o&&u().get("WEBGL_BUFFER_SUPPORTED")&&(p=this.decode(t),m=this.texData.get(p.dataId),f=(_=this.gpgpu).createBufferFromTexture.apply(_,[m.texture].concat(Pt(i)))),this.pendingRead.set(t,[]),"complex64"===o?[3,2]:[4,this.gpgpu.createAndWaitForFence()];case 1:a.sent(),a.label=2;case 2:return"complex64"!==o?[3,4]:[4,Promise.all([s.real.data(),s.imag.data()])];case 3:return y=a.sent(),g=mi(y[0],y[1]),[3,5];case 4:null==f?g=this.getValuesFromTexture(t):(b=v(i),g=this.gpgpu.downloadFloat32MatrixFromBuffer(f,b)),a.label=5;case 5:return null!=p&&this.disposeData(p.dataId),w=this.convertAndCacheOnCPU(t,g),x=this.pendingRead.get(t),this.pendingRead.delete(t),x.forEach((function(t){return t(w)})),this.pendingDisposal.has(t)&&(this.pendingDisposal.delete(t),this.disposeData(t)),[2,w]}}))}))},t.prototype.getValuesFromTexture=function(t){var e,n=this,r=this.texData.get(t),i=r.shape,o=r.dtype,a=r.isPacked,s=v(i);if(u().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")){var l=this.decode(t),c=this.texData.get(l.dataId),h=(e=this.gpgpu).downloadMatrixFromPackedTexture.apply(e,[c.texture].concat(Pt(i))).subarray(0,s);return this.disposeData(l.dataId),h}var d=u().getBool("WEBGL_PACK")&&!0===a,f=d?me(i):i,p=this.makeTensorHandle(f,"float32");p.size=v(i),this.texData.get(p.dataId).usage=At.DOWNLOAD;var m=ze((function(){var e=d?new Ao(f):new Oo(f);return n.compileAndRun(e,[{shape:f,dtype:o,dataId:t}],p,null)})),g=this.texData.get(m.dataId),y=this.gpgpu.downloadByteEncodedFloatMatrixFromOutputTexture(g.texture,g.texShape[0],g.texShape[1]).subarray(0,s);return this.disposeData(p.dataId),y},t.prototype.time=function(t){return o(this,void 0,void 0,(function(){var e,n,r,i,o,s,u;return a(this,(function(a){switch(a.label){case 0:return e=this.activeTimers,n=[],r=!1,null==this.programTimersStack?(this.programTimersStack=n,r=!0):this.activeTimers.push(n),this.activeTimers=n,t(),i=y(this.activeTimers.map((function(t){return t.query}))).filter((function(t){return null!=t})),o=y(this.activeTimers.map((function(t){return t.name}))).filter((function(t){return null!=t})),this.activeTimers=e,r&&(this.programTimersStack=null),[4,Promise.all(i)];case 1:return s=a.sent(),u={uploadWaitMs:this.uploadWaitMs,downloadWaitMs:this.downloadWaitMs,kernelMs:f(s),getExtraProfileInfo:function(){return s.map((function(t,e){return{name:o[e],ms:t}})).map((function(t){return t.name+": "+t.ms})).join(", ")},wallMs:null},this.uploadWaitMs=0,this.downloadWaitMs=0,[2,u]}}))}))},t.prototype.memory=function(){return{unreliable:!1,numBytesInGPU:this.numBytesInGPU}},t.prototype.startTimer=function(){return u().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?this.gpgpu.beginQuery():{startMs:G(),endMs:null}},t.prototype.endTimer=function(t){return u().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?(this.gpgpu.endQuery(),t):(t.endMs=G(),t)},t.prototype.getQueryTime=function(t){return o(this,void 0,void 0,(function(){var e;return a(this,(function(n){return u().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?[2,this.gpgpu.waitForQueryAndGetTime(t)]:[2,(e=t).endMs-e.startMs]}))}))},t.prototype.disposeData=function(t){if(!this.pendingDisposal.has(t))if(this.pendingRead.has(t))this.pendingDisposal.add(t);else if(this.texData.has(t)){this.releaseGPUData(t);var e=this.texData.get(t).complexTensors;null!=e&&(e.real.dispose(),e.imag.dispose()),this.texData.delete(t)}},t.prototype.releaseGPUData=function(t){var e=this.texData.get(t),n=e.texture,r=e.dtype,i=e.texShape,o=e.usage,a=e.isPacked,s=e.slice,u=s&&s.origDataId||t,l=this.dataRefCount.get(u);l>1?this.dataRefCount.set(u,l-1):(this.dataRefCount.delete(u),null!=n&&(this.numBytesInGPU-=this.computeBytes(i,r),this.textureManager.releaseTexture(n,i,o,a)));var c=this.texData.get(t);c.texture=null,c.texShape=null,c.isPacked=!1,c.slice=null},t.prototype.getTexture=function(t){return this.uploadToGPU(t),this.texData.get(t).texture},t.prototype.getDataInfo=function(t){return this.texData.get(t)},t.prototype.getCPUBackend=function(){return u().getBool("WEBGL_CPU_FORWARD")?(null==this.cpuBackend&&(this.cpuBackend=St.findBackend("cpu")),this.cpuBackend):null},t.prototype.shouldExecuteOnCPU=function(t,e){var n=this;return void 0===e&&(e=128),null!=this.getCPUBackend()&&t.every((function(t){return null==n.texData.get(t.dataId).texture&&t.size<e}))},t.prototype.getGPGPUContext=function(){return this.gpgpu},t.prototype.complex=function(t,e){var n=this.makeOutputArray(t.shape,"complex64");return this.texData.get(n.dataId).complexTensors={real:St.keep(t.clone()),imag:St.keep(e.clone())},n},t.prototype.real=function(t){return this.texData.get(t.dataId).complexTensors.real.clone()},t.prototype.imag=function(t){return this.texData.get(t.dataId).complexTensors.imag.clone()},t.prototype.slice=function(t,e,n){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.slice(t,e,n);if(0===v(n))return yn([],n,t.dtype);var r=this.texData.get(t.dataId).isPacked,i=jr(t.shape,e,n);if(r||!i){var o=u().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new Da(n):new Na(n),a=o.getCustomSetupFunc(e);return this.compileAndRun(o,[t],null,a)}return this.uploadToGPU(t.dataId),this.shallowSlice(t,e,n)},t.prototype.shallowSlice=function(t,e,n){var r=this.texData.get(t.dataId),i=st.make(n,{},t.dtype,this),o=this.texData.get(i.dataId);Object.assign(o,r),o.shape=n,o.dtype=t.dtype;var a=zr(e,t.strides);r.slice&&(a+=r.slice.flatOffset),o.slice={flatOffset:a,origDataId:r.slice&&r.slice.origDataId||t.dataId};var s=this.dataRefCount.get(o.slice.origDataId)||1;return this.dataRefCount.set(o.slice.origDataId,s+1),i},t.prototype.stridedSlice=function(t,e,n,r){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.stridedSlice(t,e,n,r);var i=Mr(e,n,r);if(i.some((function(t){return 0===t})))return yn([],i);var o=new Ra(e,r,i);return this.compileAndRun(o,[t])},t.prototype.reverse=function(t,e){var n=u().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new Sa(t.shape,e):new ka(t.shape,e);return this.compileAndRun(n,[t])},t.prototype.concat=function(t,e){if("complex64"===t[0].dtype){var n=t.map((function(t){return mn(t)})),r=t.map((function(t){return gn(t)}));return pn(this.concat(n,e),this.concat(r,e))}if(this.shouldExecuteOnCPU(t))return this.cpuBackend.concat(t,e);if(1===t.length)return t[0];if(t.length>u().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER")){var i=Math.floor(t.length/2),o=this.concat(t.slice(0,i),e),a=this.concat(t.slice(i),e);return this.concat([o,a],e)}if(u().getBool("WEBGL_PACK_ARRAY_OPERATIONS")&&t[0].rank>1){var s=new so(t.map((function(t){return t.shape})),e);return this.compileAndRun(s,t)}var l=dn(t.map((function(t){return t.shape})),e),c=t.map((function(t){return t.as2D(-1,v(t.shape.slice(e)))})),h=new ao(c.map((function(t){return t.shape})));return this.compileAndRun(h,c).reshape(l)},t.prototype.neg=function(t){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.neg(t);if(u().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(t,qa,t.dtype);var e=new La(t.shape,qa);return this.compileAndRun(e,[t])},t.prototype.batchMatMul=function(t,e,n,r){var i=n?t.shape[2]:t.shape[1],o=r?e.shape[1]:e.shape[2],a=n?t.shape[1]:t.shape[2],s=t.shape[0];if((1===i||1===o)&&a>1e3){n&&(t=t.transpose([0,2,1])),r&&(e=e.transpose([0,2,1]));var u=1===o?t:t.as3D(s,a,1),l=1===o?2:1,c=1===o?e.as3D(s,1,a):e;return this.multiply(u,c).sum(l,!0)}var h=gt(t.dtype,e.dtype),d=new la(t.shape,[s,i,o],n,r),f=this.makePackedTensor(d.outputShape,h);return this.compileAndRun(d,[t,e],f)},t.prototype.fusedBatchMatMul=function(t){var e=t.a,n=t.b,r=t.transposeA,i=t.transposeB,o=t.bias,a=t.activation,s=t.preluActivationWeights,u=r?e.shape[2]:e.shape[1],l=i?n.shape[1]:n.shape[2],c=e.shape[0],h=gt(e.dtype,n.dtype),d=null!=o,f=null!=s,p=a?rs(a,!0):null,m=new la(e.shape,[c,u,l],r,i,d,p,f),g=this.makePackedTensor(m.outputShape,h),y=[e,n];return o&&y.push(o),s&&y.push(s),this.compileAndRun(m,y,g)},t.prototype.multiply=function(t,e){if("complex64"===t.dtype){var n=this.texData.get(t.dataId),r=this.texData.get(e.dataId),i=new Ki("return areal * breal - aimag * bimag;",t.shape,e.shape),o=new Ki("return areal * bimag + aimag * breal;",t.shape,e.shape),a=[this.makeComplexComponentTensorHandle(t,n.complexTensors.real),this.makeComplexComponentTensorHandle(t,n.complexTensors.imag),this.makeComplexComponentTensorHandle(e,r.complexTensors.real),this.makeComplexComponentTensorHandle(e,r.complexTensors.imag)],s=this.compileAndRun(i,a),l=this.compileAndRun(o,a),c=this.complex(s,l);return s.dispose(),l.dispose(),c}if(this.shouldExecuteOnCPU([t,e]))return this.cpuBackend.multiply(t,e);if(u().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,e,Qi,t.dtype);var h=new to(Qi,t.shape,e.shape),d=this.makeOutputArray(h.outputShape,t.dtype);return this.compileAndRun(h,[t,e],d)},t.prototype.batchNormalization=function(t,e,n,r,i,o){var a=[t,e,n],s=null;null!=o&&(s=o.shape,a.push(o));var l=null;if(null!=i&&(l=i.shape,a.push(i)),u().getBool("WEBGL_PACK_NORMALIZATION")){var c=new Xi(t.shape,e.shape,n.shape,s,l,r);return this.compileAndRun(c,a)}var h=new Gi(t.shape,e.shape,n.shape,s,l,r);return this.compileAndRun(h,a)},t.prototype.localResponseNormalization4D=function(t,e,n,r,i){var o=u().getBool("WEBGL_PACK_NORMALIZATION")?new aa(t.shape,e,n,r,i):new ia(t.shape,e,n,r,i);return this.compileAndRun(o,[t])},t.prototype.LRNGrad=function(t,e,n,r,i,o,a){var s=new oa(e.shape,r,i,o,a);return this.compileAndRun(s,[e,n,t])},t.prototype.tile=function(t,e){if("string"===t.dtype){var n=this.readSync(t.dataId).map((function(t){return Y(t)}));return _i(Zn(t.shape,t.dtype,n),e)}var r=new Pa(t.shape,e);return this.compileAndRun(r,[t])},t.prototype.pad=function(t,e,n){var r=u().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new pa(t.shape,e,n):new fa(t.shape,e,n);return this.compileAndRun(r,[t])},t.prototype.transpose=function(t,e){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.transpose(t,e);var n=u().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new za(t.shape,e):new ja(t.shape,e);return this.compileAndRun(n,[t])},t.prototype.gather=function(t,e,n){if(this.shouldExecuteOnCPU([t,e]))return this.cpuBackend.gather(t,e,n);var r=new Fo(t.shape,e.size,n);return this.compileAndRun(r,[t,e])},t.prototype.batchToSpaceND=function(t,e,n){p(t.rank<=4,(function(){return"batchToSpaceND for rank > 4 with a WebGL backend not implemented yet"}));var r=e.reduce((function(t,e){return t*e})),i=Sr(t.shape,e,r),o=Er(i.length,e.length),a=Or(t.shape,e,r),s=Ar(n,e.length),u=Nr(a,n,e.length);return t.reshape(i).transpose(o).reshape(a).slice(s,u)},t.prototype.spaceToBatchND=function(t,e,n){p(t.rank<=4,(function(){return"spaceToBatchND for rank > 4 with a WebGL backend not implemented yet"}));var r=e.reduce((function(t,e){return t*e})),i=[[0,0]];i.push.apply(i,n);for(var o=1+e.length;o<t.shape.length;++o)i.push([0,0]);var a=t.pad(i),s=Sr(a.shape,e,r,!1),u=Er(s.length,e.length,!1),l=Or(a.shape,e,r,!1);return a.reshape(s).transpose(u).reshape(l)},t.prototype.reduce=function(t,e,n){var r=t.shape[0],i=t.shape[1],o=Dr(i),a=new ya({windowSize:o,inSize:i,batchSize:r},e),s=a.outputShape,u=this.makeOutputArray([s[0],s[1]],n);return this.compileAndRun(a,[t],u),1===u.shape[1]?u:this.reduce(u,e,n)},t.prototype.argReduce=function(t,e,n){void 0===n&&(n=null);var r=t.shape[0],i=t.shape[1];null!=n&&(r=n.shape[0],i=n.shape[1]);var o=Dr(i),a=new Oi({windowSize:o,inSize:i,batchSize:r},e,null==n),s=a.outputShape,u=this.makeOutputArray([s[0],s[1]],"int32"),l=[t];return null!=n&&l.push(n),this.compileAndRun(a,l,u),1===u.shape[1]?u:this.argReduce(t,e,u)},t.prototype.argReducePacked=function(t,e,n){void 0===n&&(n=null);var r=null!=n?n.shape:t.shape,i=Dr(r[r.length-1]),o=new Wi(r,i,e,null==n),a=this.makePackedTensor(o.outputShape,"int32");return this.compileAndRun(o,null==n?[t]:[t,n],a),a.rank===t.rank?this.argReducePacked(t,e,a):a},t.prototype.sum=function(t,e){sn("sum",e,t.rank);var n=on(t.shape,e),r=n[0],i=v(n[1]),o=t.as2D(-1,i),a=yt(t.dtype);return this.reduce(o,"sum",a).reshape(r)},t.prototype.prod=function(t,e){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.prod(t,e);var n=on(t.shape,e),r=n[0],i=v(n[1]),o=t.as2D(-1,i),a=yt(t.dtype);return this.reduce(o,"prod",a).reshape(r)},t.prototype.unsortedSegmentSum=function(t,e,n){var r=0,i=un([r],t.rank),o=t;null!=i&&(o=t.transpose(i),r=cn(1,t.rank)[0]);var a=function(t,e,n){for(var r=[],i=t.length,o=0;o<i;o++)r.push(o!==e?t[o]:n);return r}(o.shape,r,n),s=v([o.shape[r]]),u=o.as2D(-1,s),l=yt(t.dtype),c=this.segOpCompute(u,"unsortedSegmentSum",e,l,n).reshape(a);return null!=i&&(c=c.transpose(ln(i))),c},t.prototype.segOpCompute=function(t,e,n,r,i){var o=t.shape[0],a=t.shape[1],s=function(t,e){var n,r=!1;for(t<=30?(n=t,r=!0):n=U(t,Math.floor(Math.sqrt(t)));!r;)n>e||n===t?r=!0:n=U(t,n+1);return n}(a,i),u=new Oa({windowSize:s,inSize:a,batchSize:o,numSegments:i},e),l=u.outputShape,c=this.makeOutputArray([l[0],l[1]],r);return this.compileAndRun(u,[t,n],c),c.shape[1]===i?c:(n=Tn(0,i).tile([a/s]),this.segOpCompute(c,e,n,r,i))},t.prototype.argMinMaxReduce=function(t,e,n){var r=[e];if(sn("arg"+n.charAt(0).toUpperCase()+n.slice(1),r,t.rank),!u().getBool("WEBGL_PACK_REDUCE")||t.rank<=2){var i=on(t.shape,r),o=i[0],a=v(i[1]),s=t.as2D(-1,a);return this.argReduce(s,n).reshape(o)}return this.argReducePacked(t,n)},t.prototype.argMin=function(t,e){return this.argMinMaxReduce(t,e,"min")},t.prototype.argMax=function(t,e){return this.argMinMaxReduce(t,e,"max")},t.prototype.cumsum=function(t,e,n,r){if(e!==t.rank-1)throw new Error("WebGL cumsum shader expects an inner-most axis="+(t.rank-1)+" but got axis="+e);var i=new xo(t.shape,n,r);return this.compileAndRun(i,[t])},t.prototype.equal=function(t,e){if(u().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,e,"\n  return vec4(equal(a, b));\n","bool");var n=new to("return float(a == b);",t.shape,e.shape),r=this.makeOutputArray(n.outputShape,"bool");return this.compileAndRun(n,[t,e],r)},t.prototype.notEqual=function(t,e){if(u().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,e,"\n  return vec4(notEqual(a, b));\n","bool");var n=new to("return float(a != b);",t.shape,e.shape),r=this.makeOutputArray(n.outputShape,"bool");return this.compileAndRun(n,[t,e],r)},t.prototype.less=function(t,e){if(this.shouldExecuteOnCPU([t,e]))return this.cpuBackend.less(t,e);if(u().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,e,"\n  return vec4(lessThan(a, b));\n","bool");var n=new to("return float(a < b);",t.shape,e.shape),r=this.makeOutputArray(n.outputShape,"bool");return this.compileAndRun(n,[t,e],r)},t.prototype.lessEqual=function(t,e){if(u().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,e,"\n  return vec4(lessThanEqual(a, b));\n","bool");var n=new to("return float(a <= b);",t.shape,e.shape),r=this.makeOutputArray(n.outputShape,"bool");return this.compileAndRun(n,[t,e],r)},t.prototype.greater=function(t,e){if(this.shouldExecuteOnCPU([t,e]))return this.cpuBackend.greater(t,e);if(u().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,e,"\n  return vec4(greaterThan(a, b));\n","bool");var n=new to("return float(a > b);",t.shape,e.shape),r=this.makeOutputArray(n.outputShape,"bool");return this.compileAndRun(n,[t,e],r)},t.prototype.greaterEqual=function(t,e){if(u().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,e,"\n  return vec4(greaterThanEqual(a, b));\n","bool");var n=new to("return float(a >= b);",t.shape,e.shape),r=this.makeOutputArray(n.outputShape,"bool");return this.compileAndRun(n,[t,e],r)},t.prototype.logicalNot=function(t){var e=new La(t.shape,"return float(!(x >= 1.0));");return this.compileAndRun(e,[t])},t.prototype.logicalAnd=function(t,e){if(u().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,e,"\n  return vec4(\n    vec4(greaterThanEqual(a, vec4(1.0))) *\n    vec4(greaterThanEqual(b, vec4(1.0))));\n","bool");var n=new to("return float(a >= 1.0 && b >= 1.0);",t.shape,e.shape),r=this.makeOutputArray(n.outputShape,"bool");return this.compileAndRun(n,[t,e],r)},t.prototype.logicalOr=function(t,e){if(u().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,e,"\n  return min(\n    vec4(greaterThanEqual(a, vec4(1.0))) +\n    vec4(greaterThanEqual(b, vec4(1.0))),\n    vec4(1.0));\n","bool");var n=new to("return float(a >= 1.0 || b >= 1.0);",t.shape,e.shape),r=this.makeOutputArray(n.outputShape,"bool");return this.compileAndRun(n,[t,e],r)},t.prototype.select=function(t,e,n){var r=new Aa(t.rank,e.shape,e.rank),i=this.makeOutputArray(r.outputShape,gt(e.dtype,n.dtype));return this.compileAndRun(r,[t,e,n],i)},t.prototype.where=function(t){Ze("tf.where() in webgl locks the UI thread. Call tf.whereAsync() instead");var e=t.dataSync();return ki(t.shape,e)},t.prototype.topk=function(t,e,n){return Ci(t.dataSync(),t.shape,t.dtype,e)},t.prototype.min=function(t,e){sn("min",e,t.rank);var n=on(t.shape,e),r=n[0],i=v(n[1]),o=t.as2D(-1,i);return this.reduce(o,"min",o.dtype).reshape(r)},t.prototype.minimum=function(t,e){if(this.shouldExecuteOnCPU([t,e]))return this.cpuBackend.minimum(t,e);var n=u().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new no("\n  vec4 result = vec4(min(a, b));\n  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));\n  \n  result.r = isNaN.r > 0. ? NAN : result.r;\n  result.g = isNaN.g > 0. ? NAN : result.g;\n  result.b = isNaN.b > 0. ? NAN : result.b;\n  result.a = isNaN.a > 0. ? NAN : result.a;\n\n  return result;\n",t.shape,e.shape):new to("\n  if (isnan(a)) return a;\n  if (isnan(b)) return b;\n\n  return min(a, b);\n",t.shape,e.shape);return this.compileAndRun(n,[t,e])},t.prototype.mod=function(t,e){var n=u().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new no("\n  vec4 result = mod(a, b);\n  vec4 isNaN = vec4(equal(b, vec4(0.0)));\n  \n  result.r = isNaN.r > 0. ? NAN : result.r;\n  result.g = isNaN.g > 0. ? NAN : result.g;\n  result.b = isNaN.b > 0. ? NAN : result.b;\n  result.a = isNaN.a > 0. ? NAN : result.a;\n\n  return result;\n",t.shape,e.shape):new to("if (b == 0.0) return NAN;\n  return mod(a, b);",t.shape,e.shape);return this.compileAndRun(n,[t,e])},t.prototype.max=function(t,e){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.max(t,e);sn("max",e,t.rank);var n=on(t.shape,e),r=n[0],i=v(n[1]),o=t.as2D(-1,i);return this.reduce(o,"max",o.dtype).reshape(r)},t.prototype.maximum=function(t,e){if(this.shouldExecuteOnCPU([t,e]))return this.cpuBackend.maximum(t,e);var n=u().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new no("\n  vec4 result = vec4(max(a, b));\n  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));\n  \n  result.r = isNaN.r > 0. ? NAN : result.r;\n  result.g = isNaN.g > 0. ? NAN : result.g;\n  result.b = isNaN.b > 0. ? NAN : result.b;\n  result.a = isNaN.a > 0. ? NAN : result.a;\n\n  return result;\n",t.shape,e.shape):new to("\n  if (isnan(a)) return a;\n  if (isnan(b)) return b;\n\n  return max(a, b);\n",t.shape,e.shape);return this.compileAndRun(n,[t,e])},t.prototype.all=function(t,e){sn("all",e,t.rank);var n=on(t.shape,e),r=n[0],i=v(n[1]),o=t.as2D(-1,i);return this.reduce(o,"all",o.dtype).reshape(r)},t.prototype.any=function(t,e){sn("any",e,t.rank);var n=on(t.shape,e),r=n[0],i=v(n[1]),o=t.as2D(-1,i);return this.reduce(o,"any",o.dtype).reshape(r)},t.prototype.squaredDifference=function(t,e){var n=u().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new no("return (a - b) * (a - b);",t.shape,e.shape):new to("return (a - b) * (a - b);",t.shape,e.shape);return this.compileAndRun(n,[t,e])},t.prototype.realDivide=function(t,e){if(u().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,e,"\n  // vec4 one = vec4(equal(a, b));\n  // return one + (vec4(1.0) - one) * a / b;\n  vec4 result = a / b;\n  if(a.x == b.x) {\n    result.x = 1.;\n  }\n  if(a.y == b.y) {\n    result.y = 1.;\n  }\n  if(a.z == b.z) {\n    result.z = 1.;\n  }\n  if(a.w == b.w) {\n    result.w = 1.;\n  }\n\n  return result;\n","float32",!0);var n=new to("\nif (a == b) {\n  return 1.0;\n};\nreturn a / b;",t.shape,e.shape),r=this.makeOutputArray(n.outputShape,"float32");return this.compileAndRun(n,[t,e],r)},t.prototype.floorDiv=function(t,e){if(u().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,e,"\n  ivec4 ia = round(a);\n  ivec4 ib = round(b);\n  bvec4 cond = notEqual(ib, ivec4(0));\n  ivec4 result = ivec4(0);\n  vec4 s = sign(a) * sign(b);\n\n  // Windows (D3D) wants guaranteed non-zero int division at compile-time.\n  if (cond[0]) {\n    result[0] = idiv(ia[0], ib[0], s[0]);\n  }\n  if (cond[1]) {\n    result[1] = idiv(ia[1], ib[1], s[1]);\n  }\n  if (cond[2]) {\n    result[2] = idiv(ia[2], ib[2], s[2]);\n  }\n  if (cond[3]) {\n    result[3] = idiv(ia[3], ib[3], s[3]);\n  }\n  return vec4(result);\n","int32");var n=new to("\n  float s = sign(a) * sign(b);\n  int ia = round(a);\n  int ib = round(b);\n  if (ib != 0) {\n    // Windows (D3D) wants guaranteed non-zero int division at compile-time.\n    return float(idiv(ia, ib, s));\n  } else {\n    return NAN;\n  }\n",t.shape,e.shape),r=this.makeOutputArray(n.outputShape,"int32");return this.compileAndRun(n,[t,e],r)},t.prototype.add=function(t,e){if("complex64"===t.dtype&&"complex64"===e.dtype)return this.complexSeparableBinaryOp(t,e,Yi);if(this.shouldExecuteOnCPU([t,e]))return this.cpuBackend.add(t,e);var n=gt(t.dtype,e.dtype);if(u().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,e,Yi,n);var r=new to(Yi,t.shape,e.shape),i=this.makeOutputArray(r.outputShape,n);return this.compileAndRun(r,[t,e],i)},t.prototype.packedUnaryOp=function(t,e,n){var r=new ts(t.shape,e),i=this.makePackedTensor(r.outputShape,n);return this.compileAndRun(r,[t],i)},t.prototype.packedBinaryOp=function(t,e,n,r,i){void 0===i&&(i=!1);var o=new no(n,t.shape,e.shape,i),a=this.makePackedTensor(o.outputShape,r);return this.compileAndRun(o,[t,e],a)},t.prototype.complexSeparableBinaryOp=function(t,e,n){var r=this,i=this.texData.get(t.dataId),o=this.texData.get(e.dataId),a=[[i.complexTensors.real,o.complexTensors.real],[i.complexTensors.imag,o.complexTensors.imag]].map((function(i){var o=i[0],a=i[1],s=r.makeComplexComponentTensorHandle(t,o),u=r.makeComplexComponentTensorHandle(e,a),l=new to(n,t.shape,e.shape),c=r.makeOutputArray(l.outputShape,gt(o.dtype,a.dtype));return r.compileAndRun(l,[s,u],c)})),s=a[0],u=a[1],l=this.complex(s,u);return s.dispose(),u.dispose(),l},t.prototype.makeComplexComponentTensorHandle=function(t,e){return{dataId:e.dataId,dtype:e.dtype,shape:t.shape}},t.prototype.addN=function(t){if(1===t.length)return t[0];if(t.length>u().get("WEBGL_MAX_TEXTURES_IN_SHADER")){var e=Math.floor(t.length/2),n=this.addN(t.slice(0,e)),r=this.addN(t.slice(e));return this.addN([n,r])}var i=t.map((function(t){return t.dtype})).reduce((function(t,e){return gt(t,e)})),o=t.map((function(t){return t.shape})),a=u().getBool("WEBGL_PACK"),s=a?new Ei(t[0].shape,o):new Si(t[0].shape,o),l=a?this.makePackedTensor(s.outputShape,i):this.makeOutputArray(s.outputShape,i);return this.compileAndRun(s,t,l)},t.prototype.subtract=function(t,e){if("complex64"===t.dtype&&"complex64"===e.dtype)return this.complexSeparableBinaryOp(t,e,Zi);if(this.shouldExecuteOnCPU([t,e]))return this.cpuBackend.subtract(t,e);var n=gt(t.dtype,e.dtype);if(u().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,e,Zi,t.dtype);var r=new to(Zi,t.shape,e.shape),i=this.makeOutputArray(r.outputShape,n);return this.compileAndRun(r,[t,e],i)},t.prototype.pow=function(t,e){var n=u().getBool("WEBGL_PACK_BINARY_OPERATIONS"),r=n?new no("\n  // isModRound1 has 1 for components with round(mod(b, 2.0)) == 1, 0 otherwise.\n  vec4 isModRound1 = vec4(equal(round(mod(b, 2.0)), ivec4(1)));\n  vec4 multiplier = sign(a) * isModRound1 + (vec4(1.0) - isModRound1);\n  vec4 result = multiplier * pow(abs(a), b);\n\n  // Ensure that a^0 = 1, including 0^0 = 1 as this correspond to TF and JS\n  bvec4 isExpZero = equal(b, vec4(0.0));\n  result.r = isExpZero.r ? 1.0 : result.r;\n  result.g = isExpZero.g ? 1.0 : result.g;\n  result.b = isExpZero.b ? 1.0 : result.b;\n  result.a = isExpZero.a ? 1.0 : result.a;\n\n  vec4 isNaN = vec4(lessThan(a, vec4(0.0))) * vec4(lessThan(floor(b), b));\n  \n  result.r = isNaN.r > 0. ? NAN : result.r;\n  result.g = isNaN.g > 0. ? NAN : result.g;\n  result.b = isNaN.b > 0. ? NAN : result.b;\n  result.a = isNaN.a > 0. ? NAN : result.a;\n\n  return result;\n",t.shape,e.shape):new to("\nif(a < 0.0 && floor(b) < b){\n  return NAN;\n}\nif (b == 0.0) {\n  return 1.0;\n}\nreturn (round(mod(b, 2.0)) != 1) ?\n    pow(abs(a), b) : sign(a) * pow(abs(a), b);\n",t.shape,e.shape),i=gt(t.dtype,e.dtype),o=n?this.makePackedTensor(r.outputShape,i):this.makeOutputArray(r.outputShape,i);return this.compileAndRun(r,[t,e],o)},t.prototype.ceil=function(t){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.ceil(t);if(u().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(t,Ha,t.dtype);var e=new La(t.shape,Ha);return this.compileAndRun(e,[t])},t.prototype.floor=function(t){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.floor(t);if(u().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(t,Ga,t.dtype);var e=new La(t.shape,Ga);return this.compileAndRun(e,[t])},t.prototype.sign=function(t){var e=new La(t.shape,"\n  if (isnan(x)) { return 0.0; }\n  return sign(x);\n");return this.compileAndRun(e,[t])},t.prototype.isNaN=function(t){var e=new La(t.shape,"return float(isnan(x));"),n=this.makeOutputArray(e.outputShape,"bool");return this.compileAndRun(e,[t],n)},t.prototype.isInf=function(t){var e=new La(t.shape,"return float(isinf(x));"),n=this.makeOutputArray(e.outputShape,"bool");return this.compileAndRun(e,[t],n)},t.prototype.isFinite=function(t){var e=new La(t.shape,"return float(!isnan(x) && !isinf(x));"),n=this.makeOutputArray(e.outputShape,"bool");return this.compileAndRun(e,[t],n)},t.prototype.round=function(t){var e=new La(t.shape,"\n  // OpenGL ES does not support round function.\n  // The algorithm is based on banker's rounding.\n  float base = floor(x);\n  if ((x - base) < 0.5) {\n    return floor(x);\n  } else if ((x - base) > 0.5) {\n    return ceil(x);\n  } else {\n    if (mod(base, 2.0) == 0.0) {\n      return base;\n    } else {\n      return base + 1.0;\n    }\n  }\n");return this.compileAndRun(e,[t])},t.prototype.exp=function(t){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.exp(t);if(u().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(t,Xa,t.dtype);var e=new La(t.shape,Xa);return this.compileAndRun(e,[t])},t.prototype.expm1=function(t){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.expm1(t);if(u().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(t,Ka,t.dtype);var e=new La(t.shape,Ka);return this.compileAndRun(e,[t])},t.prototype.log=function(t){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.log(t);if(u().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(t,"\n  vec4 result = log(x);\n  vec4 isNaN = vec4(lessThan(x, vec4(0.0)));\n  result.r = isNaN.r == 1.0 ? NAN : result.r;\n  result.g = isNaN.g == 1.0 ? NAN : result.g;\n  result.b = isNaN.b == 1.0 ? NAN : result.b;\n  result.a = isNaN.a == 1.0 ? NAN : result.a;\n\n  return result;\n",t.dtype);var e=new La(t.shape,"if (x < 0.0) return NAN;\n  return log(x);");return this.compileAndRun(e,[t])},t.prototype.log1p=function(t){var e=new La(t.shape,"return log(1.0 + x);");return this.compileAndRun(e,[t])},t.prototype.sqrt=function(t){var e=new La(t.shape,"return sqrt(x);");return this.compileAndRun(e,[t])},t.prototype.rsqrt=function(t){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.rsqrt(t);var e=new La(t.shape,"return inversesqrt(x);");return this.compileAndRun(e,[t])},t.prototype.square=function(t){var e=new La(t.shape,"return x * x;");return this.compileAndRun(e,[t])},t.prototype.reciprocal=function(t){var e=new La(t.shape,"return 1.0 / x;");return this.compileAndRun(e,[t])},t.prototype.relu=function(t){var e;return e=u().getBool("WEBGL_PACK")?new ts(t.shape,Za):new La(t.shape,$a),this.compileAndRun(e,[t])},t.prototype.relu6=function(t){var e;return e=u().getBool("WEBGL_PACK")?new ts(t.shape,Qa):new La(t.shape,Va),this.compileAndRun(e,[t])},t.prototype.prelu=function(t,e){var n=u().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new no(eo,t.shape,e.shape):new to(Ji,t.shape,e.shape);return this.compileAndRun(n,[t,e])},t.prototype.elu=function(t){if(u().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(t,Ja,t.dtype);var e=new La(t.shape,Wa);return this.compileAndRun(e,[t])},t.prototype.eluDer=function(t,e){var n=u().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new no("\n  vec4 bGTEZero = vec4(greaterThanEqual(b, vec4(0.)));\n  return (bGTEZero * a) + ((vec4(1.0) - bGTEZero) * (a * (b + vec4(1.0))));\n",t.shape,e.shape):new to("return (b >= 1.0) ? a : a * (b + 1.0);",t.shape,e.shape);return this.compileAndRun(n,[t,e])},t.prototype.selu=function(t){var e=new La(t.shape,"\n  // Stable and Attracting Fixed Point (0, 1) for Normalized Weights.\n  // see: https://arxiv.org/abs/1706.02515\n  float scaleAlpha = 1.7580993408473768;\n  float scale = 1.0507009873554805;\n  return (x >= 0.0) ? scale * x : scaleAlpha * (exp(x) - 1.0);\n");return this.compileAndRun(e,[t])},t.prototype.int=function(t){var e=new La(t.shape,"return float(int(x));"),n=this.makeOutputArray(e.outputShape,"int32");return this.compileAndRun(e,[t],n)},t.prototype.clip=function(t,e,n){var r,i=(r=u().getBool("WEBGL_PACK_CLIP")?new io(t.shape):new ro(t.shape)).getCustomSetupFunc(e,n);return this.compileAndRun(r,[t],null,i)},t.prototype.abs=function(t){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.abs(t);if(u().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(t,Ua,t.dtype);var e=new La(t.shape,Ua);return this.compileAndRun(e,[t])},t.prototype.complexAbs=function(t){var e=this.texData.get(t.dataId),n=new oo(t.shape),r=[this.makeComplexComponentTensorHandle(t,e.complexTensors.real),this.makeComplexComponentTensorHandle(t,e.complexTensors.imag)];return this.compileAndRun(n,r)},t.prototype.sigmoid=function(t){var e=new La(t.shape,"return 1.0 / (1.0 + exp(-1.0 * x));");return this.compileAndRun(e,[t])},t.prototype.softplus=function(t){var e=new La(t.shape,"\n  float epsilon = 1.1920928955078125e-7;\n  float threshold = log(epsilon) + 2.0;\n\n  bool too_large = x > -threshold;\n  bool too_small = x < threshold;\n\n  float result;\n  float exp_x = exp(x);\n\n  if (too_large){\n    result = x;\n  }\n  else if (too_small){\n    result = exp_x;\n  }\n  else{\n    result = log(exp_x + 1.0);\n  }\n  return result;\n");return this.compileAndRun(e,[t])},t.prototype.sin=function(t){var e=new La(t.shape,"if (isnan(x)) return x;\n  return sin(x);\n");return this.compileAndRun(e,[t])},t.prototype.cos=function(t){var e=new La(t.shape,"if (isnan(x)) return x;\n  return cos(x);\n");return this.compileAndRun(e,[t])},t.prototype.tan=function(t){var e=new La(t.shape,"return tan(x);");return this.compileAndRun(e,[t])},t.prototype.asin=function(t){var e=new La(t.shape,"if (isnan(x)) return x;\n  if (abs(x) > 1.) {\n    return NAN;\n  }\n  return asin(x);\n");return this.compileAndRun(e,[t])},t.prototype.acos=function(t){var e=new La(t.shape,"if (isnan(x)) return x;\n  if (abs(x) > 1.) {\n    return NAN;\n  }\n  return acos(x);\n");return this.compileAndRun(e,[t])},t.prototype.atan=function(t){var e=new La(t.shape,"if (isnan(x)) return x;\n  return atan(x);\n");return this.compileAndRun(e,[t])},t.prototype.atan2=function(t,e){var n=u().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new no("\n  vec4 result = atan(a, b);\n  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));\n  \n  result.r = isNaN.r > 0. ? NAN : result.r;\n  result.g = isNaN.g > 0. ? NAN : result.g;\n  result.b = isNaN.b > 0. ? NAN : result.b;\n  result.a = isNaN.a > 0. ? NAN : result.a;\n\n  return result;\n",t.shape,e.shape):new to("\n  if (isnan(a)) return a;\n  if (isnan(b)) return b;\n\n  return atan(a, b);\n",t.shape,e.shape);return this.compileAndRun(n,[t,e])},t.prototype.sinh=function(t){var e=new La(t.shape,"\n  float e2x = exp(x);\n  return (e2x - 1.0 / e2x) / 2.0;\n");return this.compileAndRun(e,[t])},t.prototype.cosh=function(t){var e=new La(t.shape,"\n  float e2x = exp(-x);\n  return (e2x + 1.0 / e2x) / 2.0;\n");return this.compileAndRun(e,[t])},t.prototype.tanh=function(t){var e=new La(t.shape,"\n  float e2x = exp(-2.0 * abs(x));\n  return sign(x) * (1.0 - e2x) / (1.0 + e2x);\n");return this.compileAndRun(e,[t])},t.prototype.asinh=function(t){var e=new La(t.shape,"if (isnan(x)) return x;return log(x + sqrt(x * x + 1.0));");return this.compileAndRun(e,[t])},t.prototype.acosh=function(t){var e=new La(t.shape,"if (isnan(x)) return x;\n  if (x < 1.0) return NAN;\n  return log(x + sqrt(x * x - 1.0));");return this.compileAndRun(e,[t])},t.prototype.atanh=function(t){var e=new La(t.shape,"if (isnan(x)) return x;\n  if ((x < -1.0) || (x > 1.0)) return NAN;\n  return (log(1.0 + x) - log(1.0 - x)) / 2.0;");return this.compileAndRun(e,[t])},t.prototype.erf=function(t){var e=new La(t.shape,'\n  // Error function is calculated approximately with elementary function.\n  // See "Handbook of Mathematical Functions with Formulas,\n  // Graphs, and Mathematical Tables", Abramowitz and Stegun.\n  float p = 0.3275911;\n  float a1 = 0.254829592;\n  float a2 = -0.284496736;\n  float a3 = 1.421413741;\n  float a4 = -1.453152027;\n  float a5 = 1.061405429;\n\n  float sign = sign(x);\n  x = abs(x);\n  float t = 1.0 / (1.0 + p * x);\n  return sign * (1.0 - (((((a5*t + a4)*t) + a3)*t + a2)*t + a1)*t*exp(-x*x));\n');return this.compileAndRun(e,[t])},t.prototype.step=function(t,e){var n=new La(t.shape,function(t){return void 0===t&&(t=0),Ba+"\n    return x > 0.0 ? 1.0 : float("+t+");\n  "}(e));return this.compileAndRun(n,[t])},t.prototype.conv2dByMatMul=function(t,e,n,r,i,o){var a=t.shape,s=this.texData.get(t.dataId),l="channelsLast"===n.dataFormat,c=a[2]%2!=0&&!!s.isPacked;if((1==a[0]*a[1]*a[2]||1===n.outChannels)&&n.inChannels>1e3||!u().getBool("WEBGL_LAZILY_UNPACK")||!u().getBool("WEBGL_PACK_BINARY_OPERATIONS")||!c){var h=this.reshape(t,[1,l?a[0]*a[1]*a[2]:a[0]*a[2]*a[3],n.inChannels]),d=this.reshape(e,[1,n.inChannels,n.outChannels]);return this.reshape(this.fusedBatchMatMul({a:h,b:d,transposeA:!1,transposeB:!1,bias:r,activation:i,preluActivationWeights:o}),n.outShape)}var f=st.make([1,l?a[0]*a[1]*(a[2]+1):a[0]*a[2]*(a[3]+1),n.inChannels],{dataId:t.dataId},t.dtype,this),m=s.shape;s.shape=s.shape.slice(),s.shape[s.shape.length-2]++,p(ve(s.shape,f.shape),(function(){return"packed reshape "+s.shape+" to "+f.shape+" isn't free"}));var g=this.reshape(e,[1,n.inChannels,n.outChannels]),y=this.fusedBatchMatMul({a:f,b:g,transposeA:!1,transposeB:!1,bias:r,activation:i,preluActivationWeights:o}),v=this.texData.get(y.dataId);return p(v.isPacked,(function(){return"batchMatMul result is expected to be packed"})),s.shape=m,v.shape=n.outShape,st.make(n.outShape,{dataId:y.dataId},y.dtype,this)},t.prototype.conv2dWithIm2Row=function(t,e,n,r,i,o){var a=n.outWidth,s=n.outHeight,u="channelsLast"===n.dataFormat,l=n.filterWidth*n.filterHeight*n.inChannels,c=s*a,h=[l,c],d=t.squeeze([0]),f=e.reshape([1,l,-1]),p=new ra(h,d.shape,n),m=this.compileAndRun(p,[d]).reshape([1,h[0],h[1]]),g=null!=r,y=null!=o,v=i?rs(i,!0):null,b=new la(m.shape,[1,c,n.outChannels],!0,!1,g,v,y),w=[m,f];return r&&w.push(r),y&&w.push(o),this.compileAndRun(b,w).reshape(u?[1,s,a,n.outChannels]:[1,n.outChannels,s,a])},t.prototype.fusedConv2d=function(t){var e=t.input,n=t.filter,r=t.convInfo,i=t.bias,o=t.activation,a=t.preluActivationWeights;if(1===r.filterHeight&&1===r.filterWidth&&1===r.dilationHeight&&1===r.dilationWidth&&1===r.strideHeight&&1===r.strideWidth&&("SAME"===r.padInfo.type||"VALID"===r.padInfo.type))return this.conv2dByMatMul(e,n,r,i,o,a);if(u().getBool("WEBGL_CONV_IM2COL")&&1===e.shape[0])return this.conv2dWithIm2Row(e,n,r,i,o,a);var s=null!=i,l=null!=a,c=o?rs(o,!1):null,h=new go(r,s,c,l),d=[e,n];return i&&d.push(i),a&&d.push(a),this.compileAndRun(h,d)},t.prototype.conv2d=function(t,e,n){if(1===n.filterHeight&&1===n.filterWidth&&1===n.dilationHeight&&1===n.dilationWidth&&1===n.strideHeight&&1===n.strideWidth&&("SAME"===n.padInfo.type||"VALID"===n.padInfo.type))return this.conv2dByMatMul(t,e,n);if(u().getBool("WEBGL_CONV_IM2COL")&&1===t.shape[0])return this.conv2dWithIm2Row(t,e,n);var r=new go(n);return this.compileAndRun(r,[t,e])},t.prototype.conv2dDerInput=function(t,e,n){var r=new co(n);return this.compileAndRun(r,[t,e])},t.prototype.conv2dDerFilter=function(t,e,n){var r=new lo(n);return this.compileAndRun(r,[t,e])},t.prototype.fusedDepthwiseConv2D=function(t){var e,n=t.input,r=t.filter,i=t.convInfo,o=t.bias,a=t.activation,s=t.preluActivationWeights,l=u().getBool("WEBGL_PACK_DEPTHWISECONV")&&i.strideWidth<=2&&i.outChannels/i.inChannels==1,c=a?rs(a,l):null,h=[n,r],d=null!=o,f=null!=s;return d&&h.push(o),f&&h.push(s),l?(e=new bo(i,d,c,f),this.compileAndRun(e,h,this.makePackedTensor(i.outShape,n.dtype))):(e=new vo(i,d,c,f),this.compileAndRun(e,h))},t.prototype.depthwiseConv2D=function(t,e,n){var r;return u().getBool("WEBGL_PACK_DEPTHWISECONV")&&n.strideWidth<=2&&n.outChannels/n.inChannels==1?(r=new bo(n),this.compileAndRun(r,[t,e],this.makePackedTensor(n.outShape,t.dtype))):(r=new vo(n),this.compileAndRun(r,[t,e]))},t.prototype.depthwiseConv2DDerInput=function(t,e,n){var r=new mo(n);return this.compileAndRun(r,[t,e])},t.prototype.depthwiseConv2DDerFilter=function(t,e,n){var r=new po(n);return this.compileAndRun(r,[t,e])},t.prototype.conv3d=function(t,e,n){var r=new yo(n);return this.compileAndRun(r,[t,e])},t.prototype.conv3dDerInput=function(t,e,n){var r=new fo(n);return this.compileAndRun(r,[t,e])},t.prototype.conv3dDerFilter=function(t,e,n){var r=new ho(n);return this.compileAndRun(r,[t,e])},t.prototype.maxPool=function(t,e){var n=new ma(e,"max",!1),r=this.makeOutputArray(n.outputShape,t.dtype);return this.compileAndRun(n,[t],r)},t.prototype.avgPool=function(t,e){var n=new ma(e,"avg",!1),r=this.makeOutputArray(n.outputShape,"float32");return this.compileAndRun(n,[t],r)},t.prototype.maxPoolBackprop=function(t,e,n,r){var i=new ma(r,"max",!0),o=this.compileAndRun(i,[e]),a=new sa(r),s=this.makeOutputArray(a.outputShape,e.dtype),u=this.compileAndRun(a,[t,o],s);return o.dispose(),u},t.prototype.avgPoolBackprop=function(t,e,n){var r=new qi(n),i=this.makeOutputArray(r.outputShape,e.dtype);return this.compileAndRun(r,[t],i)},t.prototype.cast=function(t,e){return hi(t,e,this)},t.prototype.unstack=function(t,e){for(var n=t.shape[e],r=new Array(t.rank-1),i=0,o=0;o<t.rank;o++)o!==e&&(r[i++]=t.shape[o]);var a=new Array(t.rank).fill(0),s=t.shape.slice();s[e]=1;var u=new Array(n);for(o=0;o<u.length;o++)a[e]=o,u[o]=this.slice(t,a,s).reshape(r);return u},t.prototype.avgPool3d=function(t,e){var n=new ga(e,"avg",!1),r=this.makeOutputArray(n.outputShape,"float32");return this.compileAndRun(n,[t],r)},t.prototype.avgPool3dBackprop=function(t,e,n){var r=new Hi(n),i=this.makeOutputArray(r.outputShape,e.dtype);return this.compileAndRun(r,[t],i)},t.prototype.maxPool3d=function(t,e){var n=new ga(e,"max",!1),r=this.makeOutputArray(n.outputShape,"float32");return this.compileAndRun(n,[t],r)},t.prototype.maxPool3dBackprop=function(t,e,n,r){var i=new ga(r,"max",!0),o=this.compileAndRun(i,[e]),a=new ua(r),s=this.makeOutputArray(a.outputShape,e.dtype),u=this.compileAndRun(a,[t,o],s);return o.dispose(),u},t.prototype.reshape=function(t,e){var n=this.texData.get(t.dataId);return!n.isPacked||ve(t.shape,e)||null!==n.texture&&ve(n.shape,e)?di(t,e):this.packedReshape(t,e)},t.prototype.resizeBilinear=function(t,e,n,r){var i=u().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new xa(t.shape,e,n,r):new wa(t.shape,e,n,r);return this.compileAndRun(i,[t])},t.prototype.resizeBilinearBackprop=function(t,e,n){var r=new ba(t,e,n);return this.compileAndRun(r,[t])},t.prototype.resizeNearestNeighbor=function(t,e,n,r){var i=new Ca(t.shape,e,n,r);return this.compileAndRun(i,[t])},t.prototype.resizeNearestNeighborBackprop=function(t,e,n){var r=new _a(t,e,n);return this.compileAndRun(r,[t])},t.prototype.multinomial=function(t,e,n,r){var i=e?t:Hr(t),o=new ca(i.shape[0],i.shape[1],n),a=this.makeOutputArray(o.outputShape,"int32"),s=o.getCustomSetupFunc(r);return this.compileAndRun(o,[i],a,s)},t.prototype.oneHot=function(t,e,n,r){var i=new ha(t.size,e,n,r);return this.compileAndRun(i,[t])},t.prototype.diag=function(t){var e=new Eo(t.size);return this.compileAndRun(e,[t])},t.prototype.nonMaxSuppression=function(t,e,n,r,i){return Ze("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead"),bi(t.dataSync(),e.dataSync(),n,r,i)},t.prototype.cropAndResize=function(t,e,n,r,i,o){var a=new wo(t.shape,e.shape,r,i,o);return this.compileAndRun(a,[t,e,n])},t.prototype.depthToSpace=function(t,e,n){p(e>1,(function(){return"blockSize should be > 1 for depthToSpace, but was: "+e}));var r=t.shape[0],i=("NHWC"===n?t.shape[1]:t.shape[2])*e,o=("NHWC"===n?t.shape[2]:t.shape[3])*e,a=("NHWC"===n?t.shape[3]:t.shape[1])/(e*e),s=new So("NHWC"===n?[r,i,o,a]:[r,a,i,o],e,n);return this.compileAndRun(s,[t])},t.prototype.split=function(t,e,n){return xi(t,e,n)},t.prototype.scatterND=function(t,e,n){var r=Rr(0,t,n),i=r.sliceRank,o=r.numUpdates,a=r.sliceSize,s=r.strides,u=r.outputSize,l=[u/a,a],c=t.reshape([o,i]),h=e.reshape([o,a]);if(0===u)return di(yn([]),n);var d=bn(0),f=new Ea(o,i,c.rank,h.rank,s,l);return this.compileAndRun(f,[h,c,d]).reshape(n)},t.prototype.sparseToDense=function(t,e,n,r){var i=Rr(0,t,n),o=new Ea(i.numUpdates,i.sliceRank,t.rank,e.rank,i.strides,[i.outputSize,1],!1);return this.compileAndRun(o,[e,t,r]).reshape(n)},t.prototype.fft=function(t){return this.fftImpl(t,!1)},t.prototype.ifft=function(t){return this.fftImpl(t,!0)},t.prototype.fftImpl=function(t,e){var n=this.texData.get(t.dataId),r=new Do("return real * expR - imag * expI;",t.shape,e),i=new Do("return real * expI + imag * expR;",t.shape,e),o=[this.makeComplexComponentTensorHandle(t,n.complexTensors.real),this.makeComplexComponentTensorHandle(t,n.complexTensors.imag)],a=this.compileAndRun(r,o),s=this.compileAndRun(i,o),u=this.complex(a,s).as2D(t.shape[0],t.shape[1]);return a.dispose(),s.dispose(),u},t.prototype.gatherND=function(t,e){var n=e.shape,r=n[n.length-1],i=Tr(t,e),o=i[0],a=i[1],s=i[2],u=i[3],l=e.reshape([a,r]),c=t.reshape([t.size/s,s]),h=new Po(r,u,[a,s]);return this.compileAndRun(h,[c,l]).reshape(o)},t.prototype.fill=function(t,e,n){if("string"===(n=n||L(e))){var r=N(n,v(t));return r.fill(e),st.make(t,{values:r},n)}var i=new Ro(t,e),o=i.getCustomSetupFunc(e),a=this.makeOutputArray(t,n);return this.compileAndRun(i,[],a,o)},t.prototype.onesLike=function(t){if("string"===t.dtype)throw new Error("onesLike is not supported under string dtype");return this.fill(t.shape,1,t.dtype)},t.prototype.zerosLike=function(t){return this.fill(t.shape,"string"===t.dtype?"":0,t.dtype)},t.prototype.linspace=function(t,e,n){return fi(t,e,n)},t.prototype.makeOutputArray=function(t,e){return st.make(t,{},e,this)},t.prototype.makePackedTensor=function(t,e){var n=st.make(t,{},e,this);return this.texData.get(n.dataId).isPacked=!0,n},t.prototype.unpackTensor=function(t){var e=new es(t.shape);return this.compileAndRun(e,[t],st.make(e.outputShape,{},t.dtype,this))},t.prototype.packTensor=function(t){var e=new da(t.shape);return this.compileAndRun(e,[t],this.makePackedTensor(t.shape,t.dtype),null,!0)},t.prototype.packedReshape=function(t,e){var n=t.reshape([fe(t.shape)].concat(pe(t.shape))),r=[fe(e)].concat(pe(e)),i=new va(r,n.shape);return this.compileAndRun(i,[n],null,null,!0).reshape(e)},t.prototype.decode=function(t){var e,n=this.texData.get(t),r=n.isPacked,i=n.shape,o=n.dtype,a=me(i),s=Pt(i),u=this.makeTensorHandle(i,"float32");return this.texData.get(u.dataId).isPacked=!0,this.texData.get(u.dataId).dtype=o,this.texData.get(u.dataId).texShape=s.map((function(t){return 2*t})),e=r?new ko(a,s):new Co(a,s),this.compileAndRun(e,[{shape:a,dtype:o,dataId:t}],u,null,!0),u},t.prototype.compileAndRun=function(t,e,n,r,i){var o=this;if(void 0===i&&(i=!1),null==n&&(n=t.usesPackedTextures?this.makePackedTensor(t.outputShape,e[0].dtype):this.makeOutputArray(t.outputShape,e[0].dtype)),0===n.size)return this.texData.get(n.dataId).values=A(n.dtype,0),n;var a=e.map((function(e){if("complex64"===e.dtype)throw new Error("GPGPUProgram does not support complex64 input. For complex64 dtypes, please separate the program into real and imaginary parts.");var n=o.texData.get(e.dataId);if(null==n.texture){if(!t.usesPackedTextures&&v(e.shape)<=u().getNumber("WEBGL_SIZE_UPLOAD_UNIFORM"))return{shape:e.shape,texData:null,isUniform:!0,uniformValues:n.values};t.usesPackedTextures&&(n.isPacked=!0,n.shape=e.shape)}else if(!!n.isPacked!=!!t.usesPackedTextures)e=n.isPacked?o.unpackTensor(e):o.packTensor(e),n=o.texData.get(e.dataId);else if(n.isPacked&&!ve(n.shape,e.shape)){var r=e,i=e.shape;e.shape=n.shape,e=o.packedReshape(e,i),n=o.texData.get(e.dataId),r.shape=i}return o.uploadToGPU(e.dataId),{shape:e.shape,texData:n,isUniform:!1}}));this.uploadToGPU(n.dataId);var s,l={shape:n.shape,texData:this.texData.get(n.dataId),isUniform:!1},c=function(t,e,n){var r="";return e.concat(n).forEach((function(t){r+=t.shape+"_"+(t.isUniform?"uniform":t.texData.texShape)+"_"+(null!=t.texData&&null!=t.texData.slice&&t.texData.slice.flatOffset>0)})),t.constructor.name+"_"+r+"_"+t.userCode}(t,a,l),h=this.getAndSaveBinary(c,(function(){return function(t,e,n,r){var i=e.userCode,o=n.map((function(t,n){var r={logicalShape:t.shape,texShape:t.isUniform?null:t.texData.texShape,isUniform:t.isUniform,isPacked:!t.isUniform&&t.texData.isPacked,flatOffset:null};return null!=t.texData&&null!=t.texData.slice&&t.texData.slice.flatOffset>0&&(r.flatOffset=t.texData.slice.flatOffset),{name:e.variableNames[n],shapeInfo:r}})),a=o.map((function(t){return t.shapeInfo})),s={logicalShape:r.shape,texShape:r.texData.texShape,isUniform:!1,isPacked:r.texData.isPacked,flatOffset:null},l=Mi(o,s,i,e.usesPackedTextures),c=t.createProgram(l),h=null,d=t.getUniformLocation(c,"NAN",!1);1===u().getNumber("WEBGL_VERSION")&&(h=t.getUniformLocation(c,"INFINITY",!1));for(var f={},p=0;p<e.variableNames.length;p++){var m=e.variableNames[p];f[m]=t.getUniformLocation(c,m,!1),f["offset"+m]=t.getUniformLocation(c,"offset"+m,!1)}return{program:e,source:l,webGLProgram:c,uniformLocations:f,inShapeInfos:a,outShapeInfo:s,infLoc:h,nanLoc:d}}(o.gpgpu,t,a,l)})),d=null!=this.activeTimers;return d&&(s=this.startTimer()),function(t,e,n,r,i){na(e.inShapeInfos,n),na([e.outShapeInfo],[r]);var o=r.texData.texture,a=r.texData.texShape;r.texData.isPacked?t.setOutputPackedMatrixTexture(o,a[0],a[1]):t.setOutputMatrixTexture(o,a[0],a[1]),t.setProgram(e.webGLProgram),1===u().getNumber("WEBGL_VERSION")&&null!==e.infLoc&&t.gl.uniform1f(e.infLoc,1/0),null!==e.nanLoc&&t.gl.uniform1f(e.nanLoc,NaN),n.forEach((function(n,r){var i=e.program.variableNames[r],o=e.uniformLocations[i],a=e.uniformLocations["offset"+i];if(null!=o)if(n.isUniform)if(v(n.shape)<2)t.gl.uniform1f(o,n.uniformValues[0]);else{var s=n.uniformValues;s instanceof Float32Array||(s=new Float32Array(s)),t.gl.uniform1fv(o,s)}else null!=n.texData.slice&&null!=a&&t.gl.uniform1i(a,n.texData.slice.flatOffset),t.setInputMatrixTexture(n.texData.texture,o,r)})),null!=i&&i(t,e.webGLProgram),t.executeProgram()}(this.gpgpu,h,a,l,r),d&&(s=this.endTimer(s),this.activeTimers.push({name:t.constructor.name,query:this.getQueryTime(s)})),!u().getBool("WEBGL_LAZILY_UNPACK")&&this.texData.get(n.dataId).isPacked&&!1===i?this.unpackTensor(n):n},t.prototype.getAndSaveBinary=function(t,e){return t in this.binaryCache||(this.binaryCache[t]=e()),this.binaryCache[t]},t.prototype.getTextureManager=function(){return this.textureManager},t.prototype.dispose=function(){this.disposed||(this.textureManager.dispose(),null!=this.canvas&&null!=this.canvas.remove?this.canvas.remove():this.canvas=null,null!=this.fromPixels2DContext&&this.fromPixels2DContext.canvas.remove&&this.fromPixels2DContext.canvas.remove(),this.gpgpuCreatedLocally&&(this.gpgpu.program=null,this.gpgpu.dispose()),this.disposed=!0)},t.prototype.floatPrecision=function(){var t=this;return null==this.floatPrecisionValue&&(this.floatPrecisionValue=ze((function(){if(!u().get("WEBGL_RENDER_FLOAT32_ENABLED")){var e=u().getBool("DEBUG");u().set("DEBUG",!1);var n=t.abs(bn(1e-8)).dataSync()[0];if(u().set("DEBUG",e),n>0)return 32}return 16}))),this.floatPrecisionValue},t.prototype.epsilon=function(){return 32===this.floatPrecision()?1e-7:1e-4},t.prototype.uploadToGPU=function(t){var e,n=this.texData.get(t),r=n.shape,i=n.dtype,o=n.values,a=n.usage,s=n.isPacked;if(null==n.texture){var u,l=null!=this.activeTimers;l&&(u=G());var c=n.texShape;if(null==c&&(c=ge(r,s),n.texShape=c),null!=o){var h=me(r),d=void 0,f=c[1],p=c[0],m=o instanceof Uint8Array;s?(f=(e=jt(c[0],c[1]))[0],d=new To(h,[p=e[1],f],m)):d=new No(h,[p,f],m);var g=this.makeTensorHandle([p,f],i);this.texData.get(g.dataId).usage=m?At.PIXELS:At.UPLOAD,this.gpgpu.uploadDenseMatrixToTexture(this.getTexture(g.dataId),f,p,o);var y=this.makeTensorHandle(d.outputShape,g.dtype);y.size=v(d.outputShape),this.texData.get(y.dataId).isPacked=s,this.compileAndRun(d,[g],y);var b=this.texData.get(y.dataId);n.texture=b.texture,n.texShape=b.texShape,n.isPacked=b.isPacked,n.usage=b.usage,this.disposeData(g.dataId),this.texData.delete(y.dataId),n.values=null,l&&(this.uploadWaitMs+=G()-u)}else{var w=this.acquireTexture(c,a,i,s);n.texture=w}}},t.prototype.convertAndCacheOnCPU=function(t,e){var n=this.texData.get(t),r=n.dtype;return this.releaseGPUData(t),null!=e&&(n.values=function(t,e){if("float32"===e||"complex64"===e)return t;if("int32"===e||"bool"===e){for(var n="int32"===e?new Int32Array(t.length):new Uint8Array(t.length),r=0;r<n.length;++r)n[r]=Math.round(t[r]);return n}throw new Error("Unknown dtype "+e)}(e,r)),n.values},t.prototype.acquireTexture=function(t,e,n,r){if(this.numBytesInGPU+=this.computeBytes(t,n),!this.warnedAboutMemory&&this.numBytesInGPU>1024*this.numMBBeforeWarning*1024){var i=(this.numBytesInGPU/1024/1024).toFixed(2);this.warnedAboutMemory=!0,console.warn("High memory usage in GPU: "+i+" MB, most likely due to a memory leak")}return this.textureManager.acquireTexture(t,e,r)},t.prototype.computeBytes=function(t,e){return t[0]*t[1]*M(e)},t}();Et()&&St.registerBackend("webgl",(function(){return new is}),2);var os=fn({abs_:function(t){var e=tn(t,"x","abs");return"complex64"===e.dtype?St.runKernel((function(t){return t.complexAbs(e)}),{$x:e}):St.runKernel((function(t,n){var r=t.abs(e);return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return t.mul(n.toFloat().step(-1))}}}))}}),as=fn({acos_:function(t){var e=tn(t,"x","acos");return St.runKernel((function(t,n){var r=t.acos(e);return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return t.divStrict(bn(1).sub(n.toFloat().square()).sqrt()).neg()}}}))}}),ss=fn({acosh_:function(t){var e=tn(t,"x","acosh");return St.runKernel((function(t,n){var r=t.acosh(e);return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return t.divStrict(n.toFloat().square().sub(1).sqrt())}}}))}}),us=fn({asin_:function(t){var e=tn(t,"x","asin");return St.runKernel((function(t,n){var r=t.asin(e);return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return t.divStrict(bn(1).sub(n.toFloat().square()).sqrt())}}}))}}),ls=fn({asinh_:function(t){var e=tn(t,"x","asinh");return St.runKernel((function(t,n){var r=t.asinh(e);return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return t.divStrict(bn(1).add(n.toFloat().square()).sqrt())}}}))}}),cs=fn({atan_:function(t){var e=tn(t,"x","atan");return St.runKernel((function(t,n){var r=t.atan(e);return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return t.div(n.toFloat().square().add(1))}}}))}}),hs=fn({atanh_:function(t){var e=tn(t,"x","atanh");return St.runKernel((function(t,n){var r=t.atanh(e);return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return t.div(bn(1).sub(n.toFloat().square()))}}}))}}),ds=fn({ceil_:function(t){var e=tn(t,"x","ceil");return St.runKernel((function(t){return t.ceil(e)}),{$x:e},(function(t){return{$x:function(){return Rn(t)}}}))}}),fs=fn({clipByValue_:function(t,e,n){var r=tn(t,"x","clipByValue");return p(e<=n,(function(){return"Error in clip: min ("+e+") must be less than or equal to max ("+n+")."})),St.runKernel((function(t,i){var o=t.clip(r,e,n);return i([r]),o}),{$x:r},(function(t,r){var i=r[0];return{$x:function(){return t.where(i.greaterEqual(e).logicalAnd(i.lessEqual(n)),Rn(t))}}}))}}),ps=fn({cos_:function(t){var e=tn(t,"x","cos");return St.runKernel((function(t,n){var r=t.cos(e);return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return n.toFloat().sin().neg().mul(t)}}}))}}),ms=fn({cosh_:function(t){var e=tn(t,"x","cosh");return St.runKernel((function(t,n){var r=t.cosh(e);return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return n.toFloat().sinh().mulStrict(t)}}}))}}),gs=fn({erf_:function(t){var e=tn(t,"x","erf");return p("int32"===e.dtype||"float32"===e.dtype,(function(){return"Input dtype must be `int32` or `float32`."})),"int32"===e.dtype&&(e=e.toFloat()),St.runKernel((function(t,n){var r=t.erf(e);return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return t.mul(n.square().neg().exp().mul(2/Math.sqrt(Math.PI)))}}}))}}),ys=fn({exp_:function(t){var e=tn(t,"x","exp");return St.runKernel((function(t,n){var r=t.exp(e);return n([r]),r}),{$x:e},(function(t,e){return{$x:function(){return t.mulStrict(e[0])}}}))}}),vs=fn({expm1_:function(t){var e=tn(t,"x","expm1");return St.runKernel((function(t,n){var r=t.expm1(e);return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return t.mul(n.exp())}}}))}}),bs=fn({floor_:function(t){var e=tn(t,"x","floor");return St.runKernel((function(t){return t.floor(e)}),{$x:e},(function(t){return{$x:function(){return Rn(t)}}}))}}),ws=fn({log_:function(t){var e=tn(t,"x","log");return St.runKernel((function(t,n){var r=t.log(e);return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return t.div(n.toFloat())}}}))}}),xs=fn({log1p_:function(t){var e=tn(t,"x","log1p");return St.runKernel((function(t,n){var r=t.log1p(e);return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return t.div(n.add(1))}}}))}}),_s=fn({logSigmoid_:function(t){var e=tn(t,"x","logSigmoid");return St.runKernel((function(t,n){var r=t.softplus(e.neg()).neg();return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return t.mul(n.neg().sigmoid())}}}))}}),Cs=fn({neg_:function(t){var e=tn(t,"x","neg");return St.runKernel((function(t){return t.neg(e)}),{$x:e},(function(t){return{$x:function(){return t.neg()}}}))}}),ks=fn({reciprocal_:function(t){var e=tn(t,"x","reciprocal");return St.runKernel((function(t,n){var r=t.reciprocal(e);return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return t.div(n.square().neg())}}}))}}),Ss=fn({round_:function(t){var e=tn(t,"x","round");return St.runKernel((function(t){return t.round(e)}),{$x:e},(function(t){return{$x:function(){return Rn(t)}}}))}}),Es=fn({rsqrt_:function(t){var e=tn(t,"x","rsqrt");return St.runKernel((function(t,n){var r=t.rsqrt(e);return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return t.div(n.pow(1.5).mul(2)).neg()}}}))}}),Os=fn({sigmoid_:function(t){var e=tn(t,"x","sigmoid");return St.runKernel((function(t,n){var r=t.sigmoid(e);return n([r]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return t.mul(n.mul(bn(1).sub(n)))}}}))}}),As=fn({sign_:function(t){var e=tn(t,"x","sign");return St.runKernel((function(t){return t.sign(e)}),{$x:e},(function(t){return{$x:function(){return Rn(t)}}}))}}),Ns=fn({isNaN_:function(t){var e=tn(t,"x","isNaN");return St.runKernel((function(t){return t.isNaN(e)}),{$x:e},(function(t){return{$x:function(){return Rn(t)}}}))}}),Ts=fn({isInf_:function(t){var e=tn(t,"x","isInf");return St.runKernel((function(t){return t.isInf(e)}),{$x:e},(function(t){return{$x:function(){return Rn(t)}}}))}}),Ds=fn({isFinite_:function(t){var e=tn(t,"x","isFinite");return St.runKernel((function(t){return t.isFinite(e)}),{$x:e},(function(t){return{$x:function(){return Rn(t)}}}))}}),Rs=fn({sin_:function(t){var e=tn(t,"x","sin");return St.runKernel((function(t,n){var r=t.sin(e);return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return n.toFloat().cos().mul(t)}}}))}}),Is=fn({sinh_:function(t){var e=tn(t,"x","sinh");return St.runKernel((function(t,n){var r=t.sinh(e);return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return n.toFloat().cosh().mulStrict(t)}}}))}}),Ms=fn({softplus_:function(t){var e=tn(t,"x","softplus");return St.runKernel((function(t,n){var r=t.softplus(e);return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return t.mul(n.sigmoid())}}}))}}),Fs=fn({sqrt_:function(t){var e=tn(t,"x","sqrt");return St.runKernel((function(t,n){var r=t.sqrt(e);return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return t.div(n.toFloat().sqrt().mul(2))}}}))}}),Ps=fn({square_:function(t){var e=tn(t,"x","square");return St.runKernel((function(t,n){return n([e]),t.square(e)}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return t.mul(n.toFloat().mul(2))}}}))}}),js=fn({step_:function(t,e){void 0===e&&(e=0);var n=tn(t,"x","step");return St.runKernel((function(t){return t.step(n,e)}),{$x:n},(function(t){return{$x:function(){return Rn(t)}}}))}}),zs=fn({tan_:function(t){var e=tn(t,"x","tan");return St.runKernel((function(t,n){var r=t.tan(e);return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return t.div(n.cos().square())}}}))}}),Ls=fn({tanh_:function(t){var e=tn(t,"x","tanh");return St.runKernel((function(t,n){var r=t.tanh(e);return n([r]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return bn(1).sub(n.square()).mulStrict(t)}}}))}});function Bs(t,e,n,r,i,o){var a,s,u=tn(t,"x","batchNorm"),l=tn(e,"mean","batchNorm"),c=tn(n,"variance","batchNorm");return null!=i&&(a=tn(i,"scale","batchNorm")),null!=r&&(s=tn(r,"offset","batchNorm")),p(2===u.rank,(function(){return"Error in batchNorm3D: x must be rank 3 but got rank "+u.rank+"."})),p(2===l.rank||1===l.rank,(function(){return"Error in batchNorm2D: mean must be rank 2 or rank 1 but got rank "+l.rank+"."})),p(2===c.rank||1===c.rank,(function(){return"Error in batchNorm2D: variance must be rank 2 or rank 1 but got rank "+c.rank+"."})),null!=a&&p(2===a.rank||1===a.rank,(function(){return"Error in batchNorm2D: scale must be rank 2 or rank 1 but got rank "+a.rank+"."})),null!=s&&p(2===s.rank||1===s.rank,(function(){return"Error in batchNorm2D: offset must be rank 2 or rank 1 but got rank "+s.rank+"."})),Vs(u,l,c,s,a,o)}function Us(t,e,n,r,i,o){var a,s,u=tn(t,"x","batchNorm"),l=tn(e,"mean","batchNorm"),c=tn(n,"variance","batchNorm");return null!=i&&(a=tn(i,"scale","batchNorm")),null!=r&&(s=tn(r,"offset","batchNorm")),p(3===u.rank,(function(){return"Error in batchNorm3D: x must be rank 3 but got rank "+u.rank+"."})),p(3===l.rank||1===l.rank,(function(){return"Error in batchNorm3D: mean must be rank 3 or rank 1 but got rank "+l.rank+"."})),p(3===c.rank||1===c.rank,(function(){return"Error in batchNorm3D: variance must be rank 3 or rank 1 but got rank "+c.rank+"."})),null!=a&&p(3===a.rank||1===a.rank,(function(){return"Error in batchNorm3D: scale must be rank 3 or rank 1 but got rank "+a.rank+"."})),null!=s&&p(3===s.rank||1===s.rank,(function(){return"Error in batchNorm3D: offset must be rank 3 or rank 1 but got rank "+s.rank+"."})),Vs(u,l,c,s,a,o)}function $s(t,e,n,r,i,o){var a,s,u=tn(t,"x","batchNorm"),l=tn(e,"mean","batchNorm"),c=tn(n,"variance","batchNorm");return null!=i&&(a=tn(i,"scale","batchNorm")),null!=r&&(s=tn(r,"offset","batchNorm")),p(4===u.rank,(function(){return"Error in batchNorm4D: x must be rank 4 but got rank "+u.rank+"."})),p(4===l.rank||1===l.rank,(function(){return"Error in batchNorm4D: mean must be rank 4 or rank 1 but got rank "+l.rank+"."})),p(4===c.rank||1===c.rank,(function(){return"Error in batchNorm4D: variance must be rank 4 or rank 1 but got rank "+c.rank+"."})),null!=a&&p(4===a.rank||1===a.rank,(function(){return"Error in batchNorm4D: scale must be rank 4 or rank 1 but got rank "+a.rank+"."})),null!=s&&p(4===s.rank||1===s.rank,(function(){return"Error in batchNorm4D: offset must be rank 4 or rank 1 but got rank "+s.rank+"."})),Vs(u,l,c,s,a,o)}function Vs(t,e,n,r,i,o){null==o&&(o=.001);var a,s,u,l=tn(t,"x","batchNorm"),c=tn(e,"mean","batchNorm"),h=tn(n,"variance","batchNorm");return null!=i&&(a=tn(i,"scale","batchNorm")),null!=r&&(s=tn(r,"offset","batchNorm")),p(c.rank===h.rank,(function(){return"Batch normalization gradient requires mean and variance to have equal ranks."})),p(null==s||c.rank===s.rank,(function(){return"Batch normalization gradient requires mean and offset to have equal ranks."})),p(null==a||c.rank===a.rank,(function(){return"Batch normalization gradient requires mean and scale to have equal ranks."})),u=0===l.rank||1===l.rank?l.as4D(1,1,1,l.size):2===l.rank?l.as4D(1,1,l.shape[0],l.shape[1]):3===l.rank?l.as4D(1,l.shape[0],l.shape[1],l.shape[2]):l,St.runKernel((function(t,e){var n=t.batchNormalization(u,Ws(c),Ws(h),o,Ws(a),Ws(s));return e([l,c,h,a]),n}),{$x:l,$mean:c,$variance:h,$scale:a,$offset:s},(function(t,e){var n=e[0],r=e[1],i=e[2],a=e[3],s=null==a?bn(1):a,l=Zr(r.shape,u.shape),c=[];if(1===r.rank){for(var h=0;h<u.shape.length-1;++h)c.push(u.shape[h]);c.push(1)}var d=n.sub(r),f=t.mul(s),p=Es(i.add(bn(o))),m=p.mul(p).mul(p).mul(bn(-.5));return{$x:function(){return 1===r.rank?t.mul(xr(p.as4D(1,1,1,r.shape[0]),c)).mul(s).reshape(n.shape):t.mul(p).mul(s).reshape(n.shape)},$mean:function(){var t=p.mul(bn(-1)).mul(f);return 1===r.rank&&(t=t.sum(l)),t.reshape(r.shape)},$variance:function(){var t=m.mul(d).mul(f);return 1===r.rank&&(t=t.sum(l)),t.reshape(r.shape)},$scale:function(){var e=d.mul(p),n=t.mul(e);return 1===r.rank&&(n=n.sum(l)),n.reshape(r.shape)},$offset:function(){var e=t;return 1===r.rank&&(e=e.sum(l)),e.reshape(r.shape)}}})).reshape(l.shape)}function Ws(t){return null==t?null:0===t.rank?t.as1D():1===t.rank?t:2===t.rank?t.as4D(1,1,t.shape[0],t.shape[1]):3===t.rank?t.as4D(1,t.shape[0],t.shape[1],t.shape[2]):t}function qs(){Ie("tf.batchNormalization() is going away. Use tf.batchNorm() instead, and note the positional argument change of scale, offset, and varianceEpsilon")}var Hs=fn({batchNormalization2d_:function(t,e,n,r,i,o){return void 0===r&&(r=.001),qs(),Bs(t,e,n,o,i,r)}}),Gs=fn({batchNormalization3d_:function(t,e,n,r,i,o){return void 0===r&&(r=.001),qs(),Us(t,e,n,o,i,r)}}),Xs=fn({batchNormalization4d_:function(t,e,n,r,i,o){return void 0===r&&(r=.001),qs(),$s(t,e,n,o,i,r)}}),Ks=fn({batchNormalization_:function(t,e,n,r,i,o){return void 0===r&&(r=.001),qs(),Vs(t,e,n,o,i,r)}}),Ys=fn({batchNorm_:Vs}),Zs=fn({batchNorm2d_:Bs}),Qs=fn({batchNorm3d_:Us}),Js=fn({batchNorm4d_:$s}),tu=fn({logicalAnd_:function(t,e){var n=tn(t,"a","logicalAnd","bool"),r=tn(e,"b","logicalAnd","bool");return Qr(n.shape,r.shape),St.runKernel((function(t){return t.logicalAnd(n,r)}),{$a:n,$b:r})}}),eu=fn({logicalNot_:function(t){var e=tn(t,"x","logicalNot","bool");return St.runKernel((function(t){return t.logicalNot(e)}),{$x:e})}}),nu=fn({logicalOr_:function(t,e){var n=tn(t,"a","logicalOr","bool"),r=tn(e,"b","logicalOr","bool");return Qr(n.shape,r.shape),St.runKernel((function(t){return t.logicalOr(n,r)}),{$a:n,$b:r})}}),ru=fn({logicalXor_:function(t,e){var n=tn(t,"a","logicalXor","bool"),r=tn(e,"b","logicalXor","bool");return Qr(n.shape,r.shape),nu(t,e).logicalAnd(tu(t,e).logicalNot())}}),iu=fn({where_:function(t,e,n){var r=tn(e,"a","where"),i=tn(n,"b","where"),o=tn(t,"condition","where","bool");return m(r.shape,i.shape,"Error in where: "),1===o.rank?p(o.shape[0]===r.shape[0],(function(){return"The first dimension of `a` must match the size of `condition`."})):m(o.shape,i.shape,"Error in where: "),St.runKernel((function(t,e){var n=t.select(o,r,i);return e([o]),n}),{$condition:o,$a:r,$b:i},(function(t,e){var n=e[0];return{$condition:function(){return Rn(n).toFloat()},$a:function(){return t.mul(n.cast(t.dtype))},$b:function(){return t.mul(n.logicalNot().cast(t.dtype))}}}))}}),ou=function(t){return o(this,void 0,void 0,(function(){var e,n,r;return a(this,(function(i){switch(i.label){case 0:return[4,(e=tn(t,"condition","whereAsync","bool")).data()];case 1:return n=i.sent(),r=ki(e.shape,n),t!==e&&e.dispose(),[2,r]}}))}))},au=fn({add_:function(t,e){var n,r=tn(t,"a","add"),i=tn(e,"b","add");n=vt(r,i);var o=Qr((r=n[0]).shape,(i=n[1]).shape);return St.runKernel((function(t){return t.add(r,i)}),{$a:r,$b:i},(function(t){return{$a:function(){var e=t,n=Zr(r.shape,o);return n.length>0&&(e=e.sum(n)),e.reshape(r.shape)},$b:function(){var e=t,n=Zr(i.shape,o);return n.length>0&&(e=e.sum(n)),e.reshape(i.shape)}}}))}}),su=fn({addN_:function(t){p(Array.isArray(t),(function(){return"The argument passed to tf.addN() must be a list of tensors"})),p(t.length>=1,(function(){return"Must pass at least one tensor to tf.addN(), but got "+t.length}));var e=t.map((function(t,e){return tn(t,"tensors"+e,"addN")})),n=e[0];return e.forEach((function(t){if(t.dtype!==n.dtype)throw new Error("All tensors passed to tf.addN() must have the same dtype")})),e.forEach((function(t){if(!b(t.shape,n.shape))throw new Error("All tensors passed to tf.addN() must have the same shape")})),St.runKernel((function(t){return t.addN(e)}),e,(function(t){var n={};return e.forEach((function(e,r){n[r]=function(){return t.clone()}})),n}))}}),uu=fn({addStrict_:function(t,e){var n=tn(t,"a","addStrict"),r=tn(e,"b","addStrict");return m(n.shape,r.shape,"Error in addStrict: "),n.add(r)}}),lu=fn({atan2_:function(t,e){var n,r=tn(t,"a","atan2"),i=tn(e,"b","atan2");n=vt(r,i);var o=Qr((r=n[0]).shape,(i=n[1]).shape);return St.runKernel((function(t,e){var n=t.atan2(r,i);return e([r,i]),n}),{$a:r,$b:i},(function(t,e){var n=e[0],r=e[1];return{$a:function(){var e=au(n.square(),r.square()),i=t.mul(r.div(e)),a=Zr(n.shape,o);return a.length>0&&(i=i.sum(a)),i.reshape(n.shape)},$b:function(){var e=au(n.square(),r.square()),i=Cs(t.mul(n.div(e))),a=Zr(r.shape,o);return a.length>0&&(i=i.sum(a)),i.reshape(r.shape)}}}))}}),cu=fn({div_:function(t,e){var n,r=tn(t,"a","div"),i=tn(e,"b","div");if(n=vt(r,i),i=n[1],"int32"===(r=n[0]).dtype&&"int32"===i.dtype)return du(r,i);var o=Qr(r.shape,i.shape);return St.runKernel((function(t,e){var n=t.realDivide(r,i);return e([r,i]),n}),{$a:r,$b:i},(function(t,e){var n=e[0],r=e[1];return{$a:function(){var e=t.div(r.toFloat()),i=Zr(n.shape,o);return i.length>0?e.sum(i).reshape(n.shape):e},$b:function(){var e=t.mul(n.toFloat()),i=Zr(r.shape,o);i.length>0&&(e=e.sum(i).reshape(r.shape));var a=r.square();return e.div(a.toFloat()).neg()}}}))}}),hu=fn({divStrict_:function(t,e){var n=tn(t,"a","div"),r=tn(e,"b","div");return m(n.shape,r.shape,"Error in divideStrict: "),n.div(r)}}),du=fn({floorDiv_:function(t,e){var n,r=tn(t,"a","floorDiv"),i=tn(e,"b","floorDiv");n=vt(r,i);var o=Qr((r=n[0]).shape,(i=n[1]).shape);return St.runKernel((function(t,e){var n=t.floorDiv(r,i);return e([r,i]),n}),{$a:r,$b:i},(function(t,e){var n=e[0],r=e[1];return{$a:function(){var e=t.div(r.toFloat()),i=Zr(n.shape,o);return i.length>0?e.sum(i).reshape(n.shape):e},$b:function(){var e=t.mul(n.toFloat()),i=Zr(r.shape,o);i.length>0&&(e=e.sum(i).reshape(r.shape));var a=r.square();return e.div(a.toFloat()).neg()}}}))}}),fu=fn({maximum_:function(t,e){var n,r=tn(t,"a","maximum"),i=tn(e,"b","maximum");return n=vt(r,i),i=n[1],"bool"===(r=n[0]).dtype&&(r=r.toInt(),i=i.toInt()),Qr(r.shape,i.shape),St.runKernel((function(t,e){var n=t.maximum(r,i);return e([r,i]),n}),{$a:r,$b:i},(function(t,e){var n=e[0],r=e[1];return{$a:function(){return t.mul(n.greaterEqual(r).toFloat())},$b:function(){return t.mul(n.less(r).toFloat())}}}))}}),pu=fn({maximumStrict_:function(t,e){var n=tn(t,"a","maximumStrict"),r=tn(e,"b","maximumStrict");return m(n.shape,r.shape,"Error in maximumStrict: "),n.maximum(r)}}),mu=fn({minimum_:function(t,e){var n,r=tn(t,"a","minimum"),i=tn(e,"b","minimum");return n=vt(r,i),i=n[1],"bool"===(r=n[0]).dtype&&(r=r.toInt(),i=i.toInt()),Qr(r.shape,i.shape),St.runKernel((function(t,e){var n=t.minimum(r,i);return e([r,i]),n}),{$a:r,$b:i},(function(t,e){var n=e[0],r=e[1];return{$a:function(){return t.mul(n.lessEqual(r).toFloat())},$b:function(){return t.mul(n.greater(r).toFloat())}}}))}}),gu=fn({minimumStrict_:function(t,e){var n=tn(t,"a","minimumStrict"),r=tn(e,"b","minimumStrict");return m(n.shape,r.shape,"Error in minimumStrict: "),n.minimum(r)}}),yu=fn({mod_:function(t,e){var n,r=tn(t,"a","mod"),i=tn(e,"b","mod");n=vt(r,i);var o=Qr((r=n[0]).shape,(i=n[1]).shape);return St.runKernel((function(t,e){var n=t.mod(r,i);return e([r,i]),n}),{$a:r,$b:i},(function(t,e){var n=e[0],r=e[1];return{$a:function(){var e=Zr(n.shape,o);return e.length>0?t.sum(e).reshape(n.shape):t},$b:function(){var e=t.mul(n.div(r).floor().neg()),i=Zr(r.shape,o);return i.length>0?e.sum(i).reshape(r.shape):e}}}))}}),vu=fn({modStrict_:function(t,e){var n=tn(t,"a","modStrict"),r=tn(e,"b","modStrict");return m(n.shape,r.shape,"Error in modStrict: "),n.mod(r)}}),bu=fn({mul_:function(t,e){var n,r=tn(t,"a","mul"),i=tn(e,"b","mul");n=vt(r,i);var o=Qr((r=n[0]).shape,(i=n[1]).shape);return St.runKernel((function(t,e){var n=t.multiply(r,i);return e([r,i]),n}),{$a:r,$b:i},(function(t,e){var n=e[0],r=e[1];return{$a:function(){var e=t.mul(r.toFloat()),i=Zr(n.shape,o);return i.length>0?e.sum(i).reshape(n.shape):e},$b:function(){var e=t.mul(n.toFloat()),i=Zr(r.shape,o);return i.length>0?e.sum(i).reshape(r.shape):e}}}))}}),wu=fn({mulStrict_:function(t,e){var n=tn(t,"a","mul"),r=tn(e,"b","mul");return m(n.shape,r.shape,"Error in multiplyStrict: "),n.mul(r)}}),xu=fn({pow_:function(t,e){var n=tn(t,"base","pow"),r=tn(e,"exp","pow"),i=Qr(n.shape,r.shape);return t=n.cast(gt(n.dtype,r.dtype)),e=r.cast(gt(n.dtype,r.dtype)),St.runKernel((function(t,e){var i=t.pow(n,r);return e([n,r,i]),i}),{$base:n,$exp:r},(function(t,e){var n=e[0],r=e[1],o=e[2];return{$base:function(){var e=r.toFloat(),o=t.mul(e.mul(n.pow(e.sub(bn(1))))),a=Zr(n.shape,i);return a.length>0&&(o=o.sum(a)),o.reshape(n.shape)},$exp:function(){var e=n.greater(0),a=n.log().where(e,Rn(n)),s=t.mul(o.mul(a)),u=Zr(r.shape,i);return u.length>0&&(s=s.sum(u)),s.reshape(r.shape)}}}))}}),_u=fn({powStrict_:function(t,e){return m(t.shape,e.shape,"Error in powStrict: "),t.pow(e)}}),Cu=fn({squaredDifference_:function(t,e){var n,r=tn(t,"a","squaredDifference"),i=tn(e,"b","squaredDifference");return n=vt(r,i),Qr((r=n[0]).shape,(i=n[1]).shape),St.runKernel((function(t,e){var n=t.squaredDifference(r,i);return e([r,i]),n}),{$a:r,$b:i},(function(t,e){var n=e[0],r=e[1],i=bn(2);return{$a:function(){return t.mul(n.sub(r).mul(i))},$b:function(){return t.mul(r.sub(n).mul(i))}}}))}}),ku=fn({squaredDifferenceStrict_:function(t,e){var n=tn(t,"a","squaredDifferenceStrict"),r=tn(e,"b","squaredDifferenceStrict");return m(n.shape,r.shape,"Error in squaredDifferenceStrict: "),n.squaredDifference(r)}}),Su=fn({sub_:function(t,e){var n,r=tn(t,"a","sub"),i=tn(e,"b","sub");n=vt(r,i);var o=Qr((r=n[0]).shape,(i=n[1]).shape);return St.runKernel((function(t){return t.subtract(r,i)}),{$a:r,$b:i},(function(t){return{$a:function(){var e=t,n=Zr(r.shape,o);return n.length>0&&(e=e.sum(n)),e.reshape(r.shape)},$b:function(){var e=t,n=Zr(i.shape,o);return n.length>0&&(e=e.sum(n)),e.neg().reshape(i.shape)}}}))}}),Eu=fn({subStrict_:function(t,e){var n=tn(t,"a","subStrict"),r=tn(e,"b","subStrict");return m(n.shape,r.shape,"Error in subStrict: "),n.sub(r)}}),Ou=fn({equal_:function(t,e){var n,r=tn(t,"a","equal"),i=tn(e,"b","equal");return n=vt(r,i),Qr((r=n[0]).shape,(i=n[1]).shape),St.runKernel((function(t){return t.equal(r,i)}),{$a:r,$b:i})}}),Au=fn({equalStrict_:function(t,e){var n=tn(t,"a","equalStrict"),r=tn(e,"b","equalStrict");return m(n.shape,r.shape,"Error in equalStrict: "),n.equal(r)}}),Nu=fn({greater_:function(t,e){var n,r=tn(t,"a","greater"),i=tn(e,"b","greater");return n=vt(r,i),Qr((r=n[0]).shape,(i=n[1]).shape),St.runKernel((function(t){return t.greater(r,i)}),{$a:r,$b:i})}}),Tu=fn({greaterEqual_:function(t,e){var n,r=tn(t,"a","greaterEqual"),i=tn(e,"b","greaterEqual");return n=vt(r,i),Qr((r=n[0]).shape,(i=n[1]).shape),St.runKernel((function(t,e){var n=t.greaterEqual(r,i);return e([r,i]),n}),{$a:r,$b:i},(function(t,e){var n=e[0],r=e[1];return{$a:function(){return Rn(n)},$b:function(){return Rn(r)}}}))}}),Du=fn({greaterEqualStrict_:function(t,e){var n=tn(t,"a","greaterEqualStrict"),r=tn(e,"b","greaterEqualStrict");return m(n.shape,r.shape,"Error in greaterEqualStrict: "),n.greaterEqual(r)}}),Ru=fn({greaterStrict_:function(t,e){var n=tn(t,"a","greaterStrict"),r=tn(e,"b","greaterStrict");return m(n.shape,r.shape,"Error in greaterStrict: "),n.greater(r)}}),Iu=fn({less_:function(t,e){var n,r=tn(t,"a","less"),i=tn(e,"b","less");return n=vt(r,i),Qr((r=n[0]).shape,(i=n[1]).shape),St.runKernel((function(t){return t.less(r,i)}),{$a:r,$b:i})}}),Mu=fn({lessEqual_:function(t,e){var n,r=tn(t,"a","lessEqual"),i=tn(e,"b","lessEqual");return n=vt(r,i),Qr((r=n[0]).shape,(i=n[1]).shape),St.runKernel((function(t){return t.lessEqual(r,i)}),{$a:r,$b:i})}}),Fu=fn({lessEqualStrict_:function(t,e){var n=tn(t,"a","lessEqualStrict"),r=tn(e,"b","lessEqualStrict");return m(n.shape,r.shape,"Error in lessEqualStrict: "),n.lessEqual(r)}}),Pu=fn({lessStrict_:function(t,e){var n=tn(t,"a","lessStrict"),r=tn(e,"b","lessStrict");return m(n.shape,r.shape,"Error in lessStrict: "),n.less(r)}}),ju=fn({notEqual_:function(t,e){var n,r=tn(t,"a","notEqual"),i=tn(e,"b","notEqual");return n=vt(r,i),Qr((r=n[0]).shape,(i=n[1]).shape),St.runKernel((function(t){return t.notEqual(r,i)}),{$a:r,$b:i})}}),zu=fn({notEqualStrict_:function(t,e){var n=tn(t,"a","notEqualStrict"),r=tn(e,"b","notEqualStrict");return m(n.shape,r.shape,"Error in notEqualStrict: "),n.notEqual(r)}});function Lu(t,e){for(var n=[],r=t;r<e;++r)n.push(r);return n}function Bu(t){for(var e=[],n=0;n<t.length;++n)for(var r=0;r<t[n].length;++r)e.push(t[n][r]);return e}var Uu=fn({gather_:function(t,e,n){void 0===n&&(n=0);var r=tn(t,"x","gather"),i=tn(e,"indices","gather","int32");n=E(n,r.shape)[0];var o=function(t,e,n){for(var r=t.shape[n],i=[],o=1,a=1,s=0;s<n;s++)i.push(t.shape[s]),o*=t.shape[s];for(s=0;s<e.rank;s++)i.push(e.shape[s]);for(s=n+1;s<t.rank;s++)i.push(t.shape[s]),a*=t.shape[s];return{batchSize:o,sliceSize:a,dimSize:r,outputShape:i}}(r,i,n);return St.runKernel((function(t,e){var o=t.gather(r,i.flatten(),n);return e([i]),o}),{$x:r},(function(t,e){var i=e[0];return{$x:function(){var e=r.shape,o=i.size,a=e.slice(0,n),s=a.length,u=e.slice(n,e.length).slice(1),l=u.length,c=Lu(0,s),h=Lu(s+1,s+1+l),d=Bu([a,[o],u]),f=t.reshape(d),p=i.reshape([o]),m=Bu([[s],c,h]),g=f.transpose(m),y=$u(g,p,r.shape[n]),v=ln(m);return y.transpose(v)}}})).reshape(o.outputShape)}}),$u=fn({unsortedSegmentSum_:function(t,e,n){var r=tn(t,"x","unsortedSegmentSum"),i=tn(e,"segmentIds","unsortedSegmentSum","int32");return p(w(n),(function(){return"numSegments must be of dtype int"})),St.runKernel((function(t,e){var o=t.unsortedSegmentSum(r,i,n);return e([i]),o}),{$x:r},(function(t,e){var n=e[0];return{$x:function(){return function(t,e){for(var n=fu(e,Rn(e)),r=Uu(t,n),i=Tu(e,bn(0,"int32")),o=r.rank-i.rank,a=0;a<o;++a)i=ir(i,a+1);i=tu(i,En(r.shape,"bool"));var s=Rn(r);return iu(i,r,s)}(t,n)}}}))}}),Vu=function(t,e,n){return o(this,void 0,void 0,(function(){var r,i,o,s,u,l,c,h,d,f,g,y,v;return a(this,(function(a){switch(a.label){case 0:for(r=tn(t,"tensor","boolMask"),i=tn(e,"mask","boolMask","bool"),o=null==n?0:n,u=r.shape,p((s=i.rank)>0,(function(){return"mask cannot be scalar"})),m(u.slice(o,o+s),i.shape,"mask's shape must match the first K dimensions of tensor's shape,"),l=1,c=o;c<o+s;c++)l*=u[c];return h=u.slice(0,o).concat([l],u.slice(o+s)),d=r.reshape(h),f=i.reshape([-1]),[4,ou(f)];case 1:return g=a.sent(),y=g.squeeze([1]),v=Uu(d,y,o),t!==r&&r.dispose(),e!==i&&i.dispose(),y.dispose(),d.dispose(),f.dispose(),g.dispose(),[2,v]}}))}))};function Wu(t,e,n,r,i,o,a){void 0===o&&(o="NHWC"),p(t.length===e.rank,(function(){return"Length of inShape ("+t.length+") and rank of dy ("+e.rank+") must match"}));var s=t,u=e,l=!1;3===e.rank&&(l=!0,u=e.as4D(1,e.shape[0],e.shape[1],e.shape[2]),s=[1,t[0],t[1],t[2]]),p(4===s.length,(function(){return"Error in conv2dDerInput: inShape must be length 4, but got length "+s.length+"."})),p(4===u.rank,(function(){return"Error in conv2dDerInput: dy must be rank 4, but got rank "+u.rank})),p(4===n.rank,(function(){return"Error in conv2dDerInput: filter must be rank 4, but got rank "+n.rank}));var c="NHWC"===o?s[3]:s[1],h="NHWC"===o?u.shape[3]:u.shape[1];p(c===n.shape[2],(function(){return"Error in conv2dDerInput: depth of input ("+c+") must match input depth for filter "+n.shape[2]+"."})),p(h===n.shape[3],(function(){return"Error in conv2dDerInput: depth of output ("+h+") must match output depth for filter "+n.shape[3]+"."})),null!=a&&p(w(i),(function(){return"Error in conv2dDerInput: pad must be an integer when using, dimRoundingMode "+a+" but got pad "+i+"."}));var d=ci(o),f=ei(s,n.shape,r,1,i,a,!1,d),m=St.runKernel((function(t,e){var r=t.conv2dDerInput(u,n,f);return e([n,u]),r}),{dy4D:u,filter:n},(function(t,e){var n=e[0],s=e[1];return{dy4D:function(){return Xu(t,n,r,i,o,1,a)},filter:function(){return Yu(t,s,n.shape,r,i,o,a)}}}));return l?m.as3D(m.shape[1],m.shape[2],m.shape[3]):m}function qu(t){var e=function(t){return"number"==typeof t?[t,t,t]:2===t.length?[t[0],t[1],1]:t}(t);return 1===e[0]&&1===e[1]&&1===e[2]}function Hu(t,e,n,r,i){p(t.length===e.rank,(function(){return"Length of inShape ("+t.length+") and rank of dy ("+e.rank+") must match"}));var o=t,a=e,s=!1;4===e.rank&&(s=!0,a=e.as5D(1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]),o=[1,t[0],t[1],t[2],t[3]]);var u=o[4],l=a.shape[4];p(5===o.length,(function(){return"Error in conv3dDerInput: inShape must be length 5, but got length "+o.length+"."})),p(5===a.rank,(function(){return"Error in conv3dDerInput: dy must be rank 5, but got rank "+a.rank})),p(5===n.rank,(function(){return"Error in conv3dDerInput: filter must be rank 5, but got rank "+n.rank})),p(u===n.shape[3],(function(){return"Error in conv3dDerInput: depth of input ("+u+") must match input depth for filter "+n.shape[3]+"."})),p(l===n.shape[4],(function(){return"Error in conv3dDerInput: depth of output ("+l+") must match output depth for filter "+n.shape[4]+"."}));var c=ni(o,n.shape,r,1,i),h=St.runKernel((function(t){return t.conv3dDerInput(a,n,c)}),{dy5D:a});return s?h.as4D(h.shape[1],h.shape[2],h.shape[3],h.shape[4]):h}var Gu=fn({conv1d_:function(t,e,n,r,i,o,a){void 0===i&&(i="NWC"),void 0===o&&(o=1);var s=tn(t,"x","conv1d"),u=tn(e,"filter","conv1d"),l=s,c=!1;2===s.rank&&(c=!0,l=s.as3D(1,s.shape[0],s.shape[1])),p(3===l.rank,(function(){return"Error in conv1d: input must be rank 3, but got rank "+l.rank+"."})),p(3===u.rank,(function(){return"Error in conv1d: filter must be rank 3, but got rank "+u.rank+"."})),null!=a&&p(w(r),(function(){return"Error in conv1d: pad must be an integer when using, dimRoundingMode "+a+" but got pad "+r+"."})),p(l.shape[2]===u.shape[1],(function(){return"Error in conv1d: depth of input ("+l.shape[2]+") must match input depth for filter "+u.shape[1]+"."})),p(li(n,o),(function(){return"Error in conv1D: Either stride or dilation must be 1. Got stride "+n+" and dilation '"+o+"'"})),p("NWC"===i,(function(){return"Error in conv1d: got dataFormat of "+i+" but only NWC is currently supported."}));var h=u.as4D(1,u.shape[0],u.shape[1],u.shape[2]),d=l.as4D(l.shape[0],1,l.shape[1],l.shape[2]),f=Xu(d,h,[1,n],r,"NHWC",[1,o],a);return c?f.as2D(f.shape[2],f.shape[3]):f.as3D(f.shape[0],f.shape[2],f.shape[3])}}),Xu=fn({conv2d_:function(t,e,n,r,i,o,a){void 0===i&&(i="NHWC"),void 0===o&&(o=[1,1]);var s=tn(t,"x","conv2d"),u=tn(e,"filter","conv2d"),l=s,c=!1;3===s.rank&&(c=!0,l=s.as4D(1,s.shape[0],s.shape[1],s.shape[2])),p(4===l.rank,(function(){return"Error in conv2d: input must be rank 4, but got rank "+l.rank+"."})),p(4===u.rank,(function(){return"Error in conv2d: filter must be rank 4, but got rank "+u.rank+"."})),null!=a&&p(w(r),(function(){return"Error in conv2d: pad must be an integer when using, dimRoundingMode "+a+" but got pad "+r+"."}));var h="NHWC"===i?l.shape[3]:l.shape[1];p(h===u.shape[2],(function(){return"Error in conv2d: depth of input ("+h+") must match input depth for filter "+u.shape[2]+"."})),p(li(n,o),(function(){return"Error in conv2D: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+o+"'"}));var d=ci(i),f=ei(l.shape,u.shape,n,o,r,a,!1,d),m=St.runKernel((function(t,e){var n=t.conv2d(l,u,f);return e([u,l]),n}),{x:l,$filter:u},(function(t,e){var a=e[0],s=e[1];return p(ui(o),(function(){return"Error in gradient of conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '"+o+"'"})),{x:function(){return Zu(s.shape,t,a,n,r,i)},$filter:function(){return Yu(s,t,a.shape,n,r,i)}}}));return c?m.as3D(m.shape[1],m.shape[2],m.shape[3]):m}}),Ku=fn({conv3d_:function(t,e,n,r,i,o){void 0===i&&(i="NDHWC"),void 0===o&&(o=[1,1,1]);var a=tn(t,"x","conv3d"),s=tn(e,"filter","conv3d"),u=a,l=!1;4===a.rank&&(l=!0,u=a.as5D(1,a.shape[0],a.shape[1],a.shape[2],a.shape[3])),p(5===u.rank,(function(){return"Error in conv3d: input must be rank 5, but got rank "+u.rank+"."})),p(5===s.rank,(function(){return"Error in conv3d: filter must be rank 5, but got rank "+s.rank+"."})),p(u.shape[4]===s.shape[3],(function(){return"Error in conv3d: depth of input ("+u.shape[4]+") must match input depth for filter "+s.shape[3]+"."})),p(function(t,e){return qu(t)||qu(e)}(n,o),(function(){return"Error in conv3D: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+o+"'"})),p("NDHWC"===i,(function(){return"Error in conv3d: got dataFormat of "+i+" but only NDHWC is currently supported."}));var c=ni(u.shape,s.shape,n,o,r),h=St.runKernel((function(t,e){var n=t.conv3d(u,s,c);return e([u,s]),n}),{x:u,$filter:s},(function(t,e){p(qu(o),(function(){return"Error in gradient of conv3D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '"+o+"'"}));var i=e[0],a=e[1];return{x:function(){return Hu(i.shape,t,a,n,r)},$filter:function(){return function(t,e,n,r,i){var o=t;4===t.rank&&(o=t.as5D(1,t.shape[0],t.shape[1],t.shape[2],t.shape[3]));var a=e;4===a.rank&&(a=e.as5D(1,e.shape[0],e.shape[1],e.shape[2],e.shape[3])),p(5===o.rank,(function(){return"Error in conv3dDerFilter: input must be rank 5, but got shape "+o.shape+"."})),p(5===a.rank,(function(){return"Error in conv3dDerFilter: dy must be rank 5, but got shape "+a.shape+"."})),p(5===n.length,(function(){return"Error in conv3dDerFilter: filterShape must be length 5, but got "+n+"."})),p(o.shape[4]===n[3],(function(){return"Error in conv3dDerFilter: depth of input "+o.shape[4]+") must match input depth in filter ("+n[3]+"."})),p(a.shape[4]===n[4],(function(){return"Error in conv3dDerFilter: depth of dy ("+a.shape[4]+") must match output depth for filter ("+n[4]+")."}));var s=ni(o.shape,n,r,1,i);return St.runKernel((function(t){return t.conv3dDerFilter(o,a,s)}),{x5D:o,dy5D:a})}(i,t,a.shape,n,r)}}}));return l?h.as4D(h.shape[1],h.shape[2],h.shape[3],h.shape[4]):h}}),Yu=fn({conv2dDerFilter_:function(t,e,n,r,i,o,a){void 0===o&&(o="NHWC");var s=t;3===t.rank&&(s=t.as4D(1,t.shape[0],t.shape[1],t.shape[2]));var u=e;3===u.rank&&(u=e.as4D(1,e.shape[0],e.shape[1],e.shape[2])),p(4===s.rank,(function(){return"Error in conv2dDerFilter: input must be rank 4, but got shape "+s.shape+"."})),p(4===u.rank,(function(){return"Error in conv2dDerFilter: dy must be rank 4, but got shape "+u.shape+"."})),p(4===n.length,(function(){return"Error in conv2dDerFilter: filterShape must be length 4, but got "+n+"."}));var l="NHWC"===o?s.shape[3]:s.shape[1],c="NHWC"===o?u.shape[3]:u.shape[1];p(l===n[2],(function(){return"Error in conv2dDerFilter: depth of input "+l+") must match input depth in filter ("+n[2]+"."})),p(c===n[3],(function(){return"Error in conv2dDerFilter: depth of dy ("+c+") must match output depth for filter ("+n[3]+")."})),null!=a&&p(w(i),(function(){return"Error in conv2dDerFilter: pad must be an integer when using, dimRoundingMode "+a+" but got pad "+i+"."}));var h=ci(o),d=ei(s.shape,n,r,1,i,a,!1,h);return St.runKernel((function(t){return t.conv2dDerFilter(s,u,d)}),{x4D:s,dy4D:u})}}),Zu=fn({conv2dDerInput_:Wu}),Qu=fn({depthwiseConv2d_:function(t,e,n,r,i,o,a){void 0===i&&(i="NHWC"),void 0===o&&(o=[1,1]);var s=tn(t,"x","depthwiseConv2d"),u=tn(e,"filter","depthwiseConv2d"),l=s,c=!1;3===s.rank&&(c=!0,l=s.as4D(1,s.shape[0],s.shape[1],s.shape[2])),p(4===l.rank,(function(){return"Error in depthwiseConv2d: input must be rank 4, but got rank "+l.rank+"."})),p(4===u.rank,(function(){return"Error in depthwiseConv2d: filter must be rank 4, but got rank "+u.rank+"."})),p(l.shape[3]===u.shape[2],(function(){return"Error in depthwiseConv2d: number of input channels ("+l.shape[3]+") must match the inChannels dimension in filter "+u.shape[2]+"."})),null==o&&(o=[1,1]),p(li(n,o),(function(){return"Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+o+"'"})),null!=a&&p(w(r),(function(){return"Error in depthwiseConv2d: pad must be an integer when using, dimRoundingMode "+a+" but got pad "+r+"."}));var h=ei(l.shape,u.shape,n,o,r,a,!0),d=St.runKernel((function(t,e){var n=t.depthwiseConv2D(l,u,h);return e([l,u]),n}),{x:l,$filter:u},(function(t,e){p(ui(o),(function(){return"Error in gradient of depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations '"+o+"'"}));var n=e[0],r=e[1];return{x:function(){return Ju(n.shape,t,r,h)},$filter:function(){return tl(n,t,r.shape,h)}}}));return c?d.as3D(d.shape[1],d.shape[2],d.shape[3]):d}}),Ju=fn({depthwiseConv2dDerInput_:function(t,e,n,r){var i=e,o=!1;3===e.rank&&(o=!0,i=e.as4D(1,e.shape[0],e.shape[1],e.shape[2]));var a=St.runKernel((function(t){return t.depthwiseConv2DDerInput(i,n,r)}),{dy4D:i});return o?a.as3D(a.shape[1],a.shape[2],a.shape[3]):a}}),tl=fn({depthwiseConv2dDerFilter_:function(t,e,n,r){var i=t;3===t.rank&&(i=t.as4D(1,t.shape[0],t.shape[1],t.shape[2]));var o=e;return 3===o.rank&&(o=e.as4D(1,e.shape[0],e.shape[1],e.shape[2])),St.runKernel((function(t){return t.depthwiseConv2DDerFilter(i,o,r)}),{x4D:i,dy4D:o})}}),el=fn({separableConv2d_:function(t,e,n,r,i,o,a){void 0===o&&(o=[1,1]),void 0===a&&(a="NHWC");var s=tn(t,"x","separableConv2d"),u=tn(e,"depthwiseFilter","separableConv2d"),l=tn(n,"pointwiseFilter","separableConv2d"),c=s,h=!1;if(3===s.rank&&(h=!0,c=s.as4D(1,s.shape[0],s.shape[1],s.shape[2])),"NCHW"===a)throw new Error("separableConv2d currently does not support dataFormat NCHW; only NHWC is supported");p(4===c.rank,(function(){return"Error in separableConv2d: input must be rank 4, but got rank "+c.rank+"."})),p(4===u.rank,(function(){return"Error in separableConv2d: depthwise filter must be rank 4, but got rank "+u.rank+"."})),p(4===l.rank,(function(){return"Error in separableConv2d: pointwise filter must be rank 4, but got rank "+u.rank+"."})),p(1===l.shape[0],(function(){return"Error in separableConv2d: the first dimension of pointwise filter  must be 1, but got "+l.shape[0]+"."})),p(1===l.shape[1],(function(){return"Error in separableConv2d: the second dimension of pointwise filter must be 1, but got "+l.shape[1]+"."}));var d=u.shape[2],f=u.shape[3];p(l.shape[2]===d*f,(function(){return"Error in separableConv2d: the third dimension of pointwise filter must be "+d*f+", but got "+l.shape[2]+"."}));var m=Qu(c,u,r,i,a,o),g=Xu(m,l,1,"valid",a);return h?g.as3D(g.shape[1],g.shape[2],g.shape[3]):g}}),nl=fn({conv2dTranspose_:function(t,e,n,r,i,o){return Wu(n,tn(t,"x","conv2dTranspose"),tn(e,"filter","conv2dTranspose"),r,i,"NHWC",o)}}),rl=fn({conv3dTranspose_:function(t,e,n,r,i){return Hu(n,tn(t,"x","conv3dTranspose"),tn(e,"filter","conv3dTranspose"),r,i)}}),il=fn({matMul_:function(t,e,n,r){var i;void 0===n&&(n=!1),void 0===r&&(r=!1);var o=tn(t,"a","matMul"),a=tn(e,"b","matMul");i=vt(o,a),o=i[0],a=i[1];var s=n?o.shape[o.rank-2]:o.shape[o.rank-1],u=r?a.shape[a.rank-1]:a.shape[a.rank-2],l=n?o.shape[o.rank-1]:o.shape[o.rank-2],c=r?a.shape[a.rank-2]:a.shape[a.rank-1],h=o.shape.slice(0,-2),d=a.shape.slice(0,-2),f=v(h),m=v(d);p(o.rank>=2&&a.rank>=2&&o.rank===a.rank,(function(){return"Error in matMul: inputs must have the same rank of at least 2, got ranks "+o.rank+" and "+a.rank+"."})),p(b(h,d),(function(){return"Error in matMul: outer dimensions ("+h+") and ("+d+") of Tensors with shapes "+o.shape+" and "+a.shape+" must match."})),p(s===u,(function(){return"Error in matMul: inner shapes ("+s+") and ("+u+") of Tensors with shapes "+o.shape+" and "+a.shape+" and transposeA="+n+" and transposeB="+r+" must match."}));var g=o.shape.slice(0,-2).concat([l,c]),y=n?o.as3D(f,s,l):o.as3D(f,l,s),w=r?a.as3D(m,c,u):a.as3D(m,u,c);return St.runKernel((function(t,e){var i=t.batchMatMul(y,w,n,r);return e([y,w]),i}),{$a:y,$b:w},(function(t,e){var i=e[0],o=e[1];return n||r?!n&&r?{$a:function(){return t.matMul(o,!1,!1)},$b:function(){return t.matMul(i,!0,!1)}}:n&&!r?{$a:function(){return o.matMul(t,!1,!0)},$b:function(){return i.matMul(t,!1,!1)}}:{$a:function(){return o.matMul(t,!0,!0)},$b:function(){return t.matMul(i,!0,!0)}}:{$a:function(){return t.matMul(o,!1,!0)},$b:function(){return i.matMul(t,!0,!1)}}})).reshape(g)}}),ol=fn({dot_:function(t,e){var n=tn(t,"t1","dot"),r=tn(e,"t2","dot");p(!(1!==n.rank&&2!==n.rank||1!==r.rank&&2!==r.rank),(function(){return"Error in dot: inputs must all be rank 1 or 2, but got ranks "+n.rank+" and "+r.rank+"."}));var i=1===n.rank?n.size:n.shape[1],o=1===r.rank?r.size:r.shape[0];return p(i===o,(function(){return"Error in dot: inner dimensions of inputs must match, but got "+i+" and "+o+"."})),1===n.rank&&1===r.rank?n.as2D(1,-1).matMul(r.as2D(-1,1)).asScalar():1===n.rank&&2===r.rank?n.as2D(1,-1).matMul(r.as2D(r.shape[0],r.shape[1])).as1D():2===n.rank&&1===r.rank?n.matMul(r.as2D(-1,1)).as1D():n.matMul(r.as2D(r.shape[0],r.shape[1]))}}),al=fn({outerProduct_:function(t,e){var n=tn(t,"v1","outerProduct"),r=tn(e,"v2","outerProduct");return p(1===n.rank&&1===r.rank,(function(){return"Error in outerProduct: inputs must be rank 1, but got ranks "+n.rank+" and "+r.rank+"."})),n.as2D(-1,1).matMul(r.as2D(1,-1))}}),sl=fn({reverse_:function(t,e){var n=tn(t,"x","reverse");if(0===n.rank)return n.clone();var r=E(e,n.shape);return St.runKernel((function(t){return t.reverse(n,r)}),{$x:n},(function(t){return{$x:function(){return t.reverse(r)}}})).reshapeAs(n)}}),ul=fn({reverse1d_:function(t){var e=tn(t,"x","reverse");return p(1===e.rank,(function(){return"Error in reverse1D: x must be rank 1 but got rank "+e.rank+"."})),sl(e,0)}}),ll=fn({reverse2d_:function(t,e){var n=tn(t,"x","reverse");return p(2===n.rank,(function(){return"Error in reverse2D: x must be rank 2 but got rank "+n.rank+"."})),sl(n,e)}}),cl=fn({reverse3d_:function(t,e){var n=tn(t,"x","reverse");return p(3===n.rank,(function(){return"Error in reverse3D: x must be rank 3 but got rank "+n.rank+"."})),sl(n,e)}}),hl=fn({reverse4d_:function(t,e){var n=tn(t,"x","reverse");return p(4===n.rank,(function(){return"Error in reverse4D: x must be rank 4 but got rank "+n.rank+"."})),sl(n,e)}});function dl(t,e,n,r,i,o){var a=tn(t,"x","maxPool"),s=a,u=!1;3===a.rank&&(u=!0,s=a.as4D(1,a.shape[0],a.shape[1],a.shape[2])),null==r&&(r=[1,1]),p(4===s.rank,(function(){return"Error in maxPool: input must be rank 4 but got rank "+s.rank+"."})),p(li(n,r),(function(){return"Error in maxPool: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+r+"'"})),null!=o&&p(w(i),(function(){return"Error in maxPool: pad must be an integer when using, dimRoundingMode "+o+" but got pad "+i+"."}));var l=Jr(s.shape,e,n,r,i,o),c=St.runKernel((function(t,e){var n=t.maxPool(s,l);return e([s,n]),n}),{x:s},(function(t,o){var a=o[0],s=o[1];return{x:function(){return function(t,e,n,r,i,o,a,s){var u=tn(t,"dy","maxPoolBackprop"),l=tn(e,"input","maxPoolBackprop"),c=tn(n,"output","maxPoolBackprop");p(l.rank===u.rank,(function(){return"Rank of input ("+l.rank+") does not match rank of dy ("+u.rank+")"})),null==o&&(o=[1,1]),p(li(i,o),(function(){return"Error in maxPoolBackProp: Either strides or dilations must be 1. Got strides "+i+" and dilations '"+o+"'"})),p(4===u.rank,(function(){return"Error in maxPoolBackprop: dy must be rank 4 but got rank "+u.rank+"."})),p(4===l.rank,(function(){return"Error in maxPoolBackprop: input must be rank 4 but got rank "+l.rank+"."}));var h=Jr(l.shape,r,i,o,a,void 0);return St.runKernel((function(t){return t.maxPoolBackprop(u,l,c,h)}),{$dy:u,$input:l})}(t,a,s,e,n,r,i)}}}));return u?c.as3D(c.shape[1],c.shape[2],c.shape[3]):c}function fl(t,e,n,r,i,o){var a=tn(t,"x","avgPool","float32");null==r&&(r=[1,1]),p(li(n,r),(function(){return"Error in avgPool: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+r+"'"}));var s=a,u=!1;3===a.rank&&(u=!0,s=a.as4D(1,a.shape[0],a.shape[1],a.shape[2])),p(4===s.rank,(function(){return"Error in avgPool: x must be rank 4 but got rank "+s.rank+"."})),null!=o&&p(w(i),(function(){return"Error in avgPool: pad must be an integer when using, dimRoundingMode "+o+" but got pad "+i+"."}));var l=Jr(s.shape,e,n,r,i,o),c=St.runKernel((function(t){return t.avgPool(s,l)}),{x:s},(function(t){return{x:function(){return function(t,e,n,r,i,o){var a=tn(t,"dy","avgPoolBackprop"),s=tn(e,"input","avgPoolBackprop");p(s.rank===a.rank,(function(){return"Rank of input ("+s.rank+") does not match rank of dy ("+a.rank+")"})),null==i&&(i=[1,1]),p(li(r,i),(function(){return"Error in avgPoolBackprop: Either strides or dilations must be 1. Got strides "+r+" and dilations '"+i+"'"}));var u=s,l=a,c=!1;3===s.rank&&(c=!0,u=s.as4D(1,s.shape[0],s.shape[1],s.shape[2]),l=a.as4D(1,a.shape[0],a.shape[1],a.shape[2])),p(4===l.rank,(function(){return"Error in avgPoolBackprop: dy must be rank 4 but got rank "+l.rank+"."})),p(4===u.rank,(function(){return"Error in avgPoolBackprop: input must be rank 4 but got rank "+u.rank+"."}));var h=Jr(u.shape,n,r,i,o),d=St.runKernel((function(t){return t.avgPoolBackprop(l,u,h)}),{dy4D:l,input4D:u});return c?d.as3D(d.shape[1],d.shape[2],d.shape[3]):d}(t,s,e,n,r,i)}}}));return c=c.cast(a.dtype),u?c.as3D(c.shape[1],c.shape[2],c.shape[3]):c}var pl=fn({maxPool_:function(t,e,n,r,i){return dl(t,e,n,1,r,i)}}),ml=fn({avgPool_:function(t,e,n,r,i){return fl(t,e,n,1,r,i)}}),gl=fn({pool_:function(t,e,n,r,i,o){null==i&&(i=[1,1]),null==o&&(o=1),0===r&&(r="valid");var a=tn(t,"x","maxPool"),s=a,u=!1;3===a.rank&&(u=!0,s=a.as4D(1,a.shape[0],a.shape[1],a.shape[2])),p(li(o,i),(function(){return"Error in pool: Either strides or dilations must be 1. Got strides "+o+" and dilations '"+i+"'"}));var l,c=Jr(s.shape,e,o,i,r),h=[c.dilationHeight,c.dilationWidth];l="same"===r?function(t,e){var n=t.map((function(t,n){return t+(t-1)*(e[n]-1)})).map((function(t){return t-1})),r=n.map((function(t){return Math.floor(t/2)})),i=n.map((function(t,e){return t-r[e]}));return n.map((function(t,e){return[r[e],i[e]]}))}([c.filterHeight,c.filterWidth],h):[[0,0],[0,0]];var d=1===h[0]&&1===h[1],f=function(t,e,n){var r=n.map((function(t){return t[0]})),i=n.map((function(t){return t[1]})),o=t.concat(r,i),a=e.map((function(t,e){return(t-o[e]%t)%t})),s=i.map((function(t,e){return t+a[e]}));return[e.map((function(t,e){return[r[e],s[e]]})),e.map((function(t,e){return[0,a[e]]}))]}([c.inHeight,c.inWidth],h,l),m=f[1],g=d?r:"valid",y=d?s:vr(s,h,f[0]),v=("avg"===n?function(){return fl(y,e,o,1,g)}:function(){return dl(y,e,o,1,g)})(),b=d?v:Jn(v,h,m);return u?b.as3D(b.shape[1],b.shape[2],b.shape[3]):b}}),yl=fn({maxPool3d_:function(t,e,n,r,i,o,a){void 0===o&&(o="NDHWC");var s=tn(t,"x","maxPool3d"),u=s,l=!1;4===s.rank&&(l=!0,u=s.as5D(1,s.shape[0],s.shape[1],s.shape[2],s.shape[3])),null==a&&(a=[1,1,1]),p(5===u.rank,(function(){return"Error in maxPool3d: x must be rank 5 but got rank "+u.rank+"."})),p("NDHWC"===o,(function(){return"Error in maxPool3d: Only NDHWC is currently supported, but got dataFormat of "+o})),p(li(n,a),(function(){return"Error in maxPool3d: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+a+"'"})),null!=i&&p(w(r),(function(){return"Error in maxPool3d: pad must be an integer when using, dimRoundingMode "+i+" but got pad "+r+"."}));var c=ti(u.shape,e,n,a,r,i,o),h=St.runKernel((function(t,e){var n=t.maxPool3d(u,c);return e([u,n]),n}),{x:u},(function(t,o){var s=o[0],u=o[1];return{x:function(){return function(t,e,n,r,i,o,a,s){var u=tn(t,"dy","maxPool3dBackprop"),l=tn(e,"input","maxPool3dBackprop"),c=tn(n,"output","maxPool3dBackprop"),h=u,d=l,f=c,m=!1;4===l.rank&&(m=!0,h=u.as5D(1,u.shape[0],u.shape[1],u.shape[2],u.shape[3]),d=l.as5D(1,l.shape[0],l.shape[1],l.shape[2],l.shape[3]),f=c.as5D(1,c.shape[0],c.shape[1],c.shape[2],c.shape[3])),p(5===h.rank,(function(){return"Error in maxPool3dBackprop: dy must be rank 5 but got rank "+h.rank+"."})),p(5===d.rank,(function(){return"Error in maxPool3dBackprop: input must be rank 5 but got rank "+d.rank+"."})),p(5===f.rank,(function(){return"Error in maxPool3dBackprop: output must be rank 5 but got rank "+f.rank+"."})),null==o&&(o=[1,1,1]),p(li(i,o),(function(){return"Error in maxPool3dBackprop: Either strides or dilations must be 1. Got strides "+i+" and dilations '"+o+"'"})),null!=s&&p(w(a),(function(){return"Error in maxPool3dBackprop: pad must be an integer when using, dimRoundingMode "+s+" but got pad "+a+"."}));var g=ti(d.shape,r,i,o,a,s),y=St.runKernel((function(t){return t.maxPool3dBackprop(h,d,f,g)}),{dy5D:h,input5D:d});return m?y.as4D(y.shape[1],y.shape[2],y.shape[3],y.shape[4]):y}(t,s,u,e,n,a,r,i)}}}));return l?h.as4D(h.shape[1],h.shape[2],h.shape[3],h.shape[4]):h}}),vl=fn({avgPool3d_:function(t,e,n,r,i,o,a){void 0===o&&(o="NDHWC");var s=tn(t,"x","avgPool3d","float32"),u=s,l=!1;4===s.rank&&(l=!0,u=s.as5D(1,s.shape[0],s.shape[1],s.shape[2],s.shape[3])),null==a&&(a=[1,1,1]),p(5===u.rank,(function(){return"Error in avgPool3d: x must be rank 5 but got rank "+u.rank+"."})),p("NDHWC"===o,(function(){return"Error in avgPool3d: Only NDHWC is currently supported, but got dataFormat of "+o})),p(li(n,a),(function(){return"Error in avgPool3d: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+a+"'"})),null!=i&&p(w(r),(function(){return"Error in avgPool3d: pad must be an integer when using, dimRoundingMode "+i+" but got pad "+r+"."}));var c=ti(u.shape,e,n,a,r,i,o),h=St.runKernel((function(t){return t.avgPool3d(u,c)}),{x:u},(function(t){return{x:function(){return function(t,e,n,r,i,o,a){var s=tn(t,"dy","avgPool3dBackprop"),u=tn(e,"input","avgPool3dBackprop"),l=s,c=u,h=!1;4===u.rank&&(h=!0,l=s.as5D(1,s.shape[0],s.shape[1],s.shape[2],s.shape[3]),c=u.as5D(1,u.shape[0],u.shape[1],u.shape[2],u.shape[3])),p(5===l.rank,(function(){return"Error in avgPool3dBackprop: dy must be rank 5 but got rank "+l.rank+"."})),p(5===c.rank,(function(){return"Error in avgPool3dBackprop: input must be rank 5 but got rank "+c.rank+"."})),null==i&&(i=[1,1,1]),p(li(r,i),(function(){return"Error in avgPool3dBackprop: Either strides or dilations must be 1. Got strides "+r+" and dilations '"+i+"'"})),null!=a&&p(w(o),(function(){return"Error in maxPool3dBackprop: pad must be an integer when using, dimRoundingMode "+a+" but got pad "+o+"."}));var d=ti(c.shape,n,r,i,o,a),f=St.runKernel((function(t){return t.avgPool3dBackprop(l,c,d)}),{dy5D:l,input5D:c});return h?f.as4D(f.shape[1],f.shape[2],f.shape[3],f.shape[4]):f}(t,u,e,n,a,r,i)}}}));return h=h.cast(u.dtype),l?h.as4D(h.shape[1],h.shape[2],h.shape[3],h.shape[4]):h}}),bl=fn({slice_:function(t,e,n){var r,i,o=tn(t,"x","slice");if(0===o.rank)throw new Error("Slicing scalar is not possible");(r="number"==typeof e?[e].concat(new Array(o.rank-1).fill(0)):e.length<o.rank?e.concat(new Array(o.rank-e.length).fill(0)):e.slice()).forEach((function(t){p(-1!==t,(function(){return"slice() does not support negative begin indexing."}))})),i=(i=null==n?new Array(o.rank).fill(-1):"number"==typeof n?[n].concat(new Array(o.rank-1).fill(-1)):n.length<o.rank?n.concat(new Array(o.rank-n.length).fill(-1)):n).map((function(t,e){return t>=0?t:(p(-1===t,(function(){return"Negative size values should be exactly -1 but got "+t+" for the slice() size at index "+e+"."})),o.shape[e]-r[e])})),function(t,e,n){p(t.rank===e.length,(function(){return"Error in slice"+t.rank+"D: Length of begin "+e+" must match the rank of the array ("+t.rank+")."})),p(t.rank===n.length,(function(){return"Error in slice"+t.rank+"D: Length of size "+n+" must match the rank of the array ("+t.rank+")."}));for(var r=function(r){p(e[r]+n[r]<=t.shape[r],(function(){return"Error in slice"+t.rank+"D: begin["+r+"] + size["+r+"] ("+(e[r]+n[r])+") would overflow input.shape["+r+"] ("+t.shape[r]+")"}))},i=0;i<t.rank;++i)r(i)}(o,r,i);var a=o.shape;return St.runKernel((function(t){return t.slice(o,r,i)}),{$x:o},(function(t){for(var e=[],n=0;n<t.rank;n++)e.push([r[n],a[n]-r[n]-i[n]]);return{$x:function(){return t.pad(e)}}}))}}),wl=fn({slice1d_:function(t,e,n){var r=tn(t,"x","slice1d");return p(1===r.rank,(function(){return"slice1d expects a rank-1 tensor, but got a rank-"+r.rank+" tensor"})),bl(r,[e],[n])}}),xl=fn({slice2d_:function(t,e,n){var r=tn(t,"x","slice2d");return p(2===r.rank,(function(){return"slice2d expects a rank-2 tensor, but got a rank-"+r.rank+" tensor"})),bl(r,e,n)}}),_l=fn({slice3d_:function(t,e,n){var r=tn(t,"x","slice3d");return p(3===r.rank,(function(){return"slice3d expects a rank-3 tensor, but got a rank-"+r.rank+" tensor"})),bl(r,e,n)}}),Cl=fn({slice4d_:function(t,e,n){var r=tn(t,"x","slice4d");return p(4===r.rank,(function(){return"slice4d expects a rank-4 tensor, but got a rank-"+r.rank+" tensor"})),bl(r,e,n)}});function kl(t,e,n,r,i){return e.rank<n.rank&&(e=e.reshape(an(e.shape,r))),t.rank<n.rank&&(t=t.reshape(an(t.shape,r))),{$x:function(){var r=t.mul(n.equal(e).cast(t.dtype));return null==i?r:r.transpose(i)}}}var Sl=fn({all_:function(t,e,n){void 0===e&&(e=null),void 0===n&&(n=!1);var r=tn(t,"x","all","bool"),i=E(e,r.shape),o=i,a=un(o,r.rank);null!=a&&(r=r.transpose(a),o=cn(o.length,r.rank));var s=St.runKernel((function(t){return t.all(r,o)}),{$x:r});if(n){var u=an(s.shape,i);return s.reshape(u)}return s}}),El=fn({any_:function(t,e,n){void 0===e&&(e=null),void 0===n&&(n=!1);var r=tn(t,"x","any","bool"),i=E(e,r.shape),o=i,a=un(o,r.rank);null!=a&&(r=r.transpose(a),o=cn(o.length,r.rank));var s=St.runKernel((function(t){return t.any(r,o)}),{$x:r});if(n){var u=an(s.shape,i);return s.reshape(u)}return s}}),Ol=fn({argMax_:function(t,e){void 0===e&&(e=0);var n=tn(t,"x","argMax");null==e&&(e=0);var r=E(e,n.shape),i=un(r,n.rank);return null!=i&&(n=n.transpose(i),r=cn(r.length,n.rank)),St.runKernel((function(t,e){var i=t.argMax(n,r[0]);return e([n]),i}),{$x:n},(function(t,e){var n=e[0];return{$x:function(){return Rn(n)}}}))}}),Al=fn({argMin_:function(t,e){void 0===e&&(e=0);var n=tn(t,"x","argMin");null==e&&(e=0);var r=E(e,n.shape),i=un(r,n.rank);return null!=i&&(n=n.transpose(i),r=cn(r.length,n.rank)),St.runKernel((function(t,e){var i=t.argMin(n,r[0]);return e([n]),i}),{$x:n},(function(t,e){var n=e[0];return{$x:function(){return Rn(n)}}}))}}),Nl=fn({logSumExp_:function(t,e,n){void 0===e&&(e=null),void 0===n&&(n=!1);var r=tn(t,"x","logSumExp"),i=E(e,r.shape),o=r.max(i,!0),a=r.sub(o).exp().sum(i).log(),s=o.reshape(a.shape).add(a);if(n){var u=an(s.shape,i);return s.reshape(u)}return s}}),Tl=fn({max_:function(t,e,n){void 0===e&&(e=null),void 0===n&&(n=!1);var r=tn(t,"x","max"),i=r,o=E(e,r.shape),a=o,s=un(a,r.rank);null!=s&&(r=r.transpose(s),a=cn(a.length,r.rank));var u=St.runKernel((function(t,e){var n=t.max(r,a);return e([i,n]),n}),{$x:r},(function(t,e){return kl(t,e[1],e[0],o,s)}));if(n){var l=an(u.shape,o);u=u.reshape(l)}return u}}),Dl=fn({mean_:function(t,e,n){void 0===e&&(e=null),void 0===n&&(n=!1);var r=tn(t,"x","mean"),i=E(e,r.shape),o=v(on(r.shape,i)[1]);return Wr((function(t){var r=bn(o);return{value:(r.dtype===t.dtype?t:t.cast(r.dtype)).div(r).sum(e,n),gradFunc:function(e){var n=t.shape.slice();return i.forEach((function(t){n[t]=1})),e.reshape(n).mul(En(t.shape,"float32")).div(o)}}}))(r)}}),Rl=fn({min_:function(t,e,n){void 0===e&&(e=null),void 0===n&&(n=!1);var r=tn(t,"x","min"),i=r,o=E(e,r.shape),a=o,s=un(a,r.rank);null!=s&&(r=r.transpose(s),a=cn(a.length,r.rank));var u=St.runKernel((function(t,e){var n=t.min(r,a);return e([i,n]),n}),{$x:r},(function(t,e){return kl(t,e[1],e[0],o,s)}));if(n){var l=an(u.shape,o);u=u.reshape(l)}return u}}),Il=fn({moments_:function(t,e,n){void 0===e&&(e=null),void 0===n&&(n=!1);var r=E(e,(t=tn(t,"x","moments")).shape),i=t.mean(r,n),o=i.shape;n||(o=an(i.shape,r));var a=t.toFloat().sub(i.reshape(o)).square();return{mean:i,variance:a.mean(r,n)}}}),Ml=fn({sum_:function(t,e,n){void 0===e&&(e=null),void 0===n&&(n=!1);var r=tn(t,"x","sum");"bool"===r.dtype&&(r=r.toInt());var i=E(e,r.shape);return Wr((function(t){var e=un(i,t.rank),r=i,o=t;null!=e&&(o=t.transpose(e),r=cn(r.length,t.rank));var a=St.runKernel((function(t){return t.sum(o,r)}),{permutedX:o});if(n){var s=an(a.shape,i);a=a.reshape(s)}return{value:a,gradFunc:function(e){var n=t.shape.slice();return i.forEach((function(t){n[t]=1})),e.reshape(n).mul(En(t.shape,"float32"))}}}))(r)}}),Fl=fn({prod_:function(t,e,n){void 0===e&&(e=null),void 0===n&&(n=!1);var r=tn(t,"x","prod");"bool"===r.dtype&&(r=r.toInt());var i=E(e,r.shape),o=un(i,r.rank),a=i,s=r;null!=o&&(s=r.transpose(o),a=cn(a.length,r.rank));var u=St.runKernel((function(t){return t.prod(s,a)}),{permutedX:s});if(n){var l=an(u.shape,i);u=u.reshape(l)}return u}}),Pl=fn({elu_:function(t){var e=tn(t,"x","elu");return St.runKernel((function(t,n){var r=t.elu(e);return n([r]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return St.runKernel((function(e){return e.eluDer(t,n)}),{dy:t,y:n})}}}))}}),jl=fn({leakyRelu_:function(t,e){void 0===e&&(e=.2);var n=tn(t,"x","leakyRelu");return fu(bn(e).mul(n),n)}}),zl=fn({prelu_:function(t,e){var n=tn(t,"x","prelu"),r=tn(e,"alpha","prelu");return St.runKernel((function(t,e){var i=t.prelu(n,r);return e([n,r]),i}),{$x:n,$alpha:r},(function(t,e){var n=e[0],r=e[1],i=n.greater(0);return{$x:function(){return iu(i,t,t.mul(r))},$alpha:function(){var e=iu(i,Rn(t),t.mul(n)),o=Zr(r.shape,t.shape);return o.length>0&&(e=e.sum(o)),e.reshape(r.shape)}}}))}}),Ll=fn({relu_:function(t){var e=tn(t,"x","relu");return"bool"===e.dtype?e.toInt():St.runKernel((function(t,n){var r=t.relu(e);return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return t.mulStrict(n.step().toFloat())}}}))}}),Bl=fn({relu6_:function(t){var e=tn(t,"x","relu6");return"bool"===e.dtype?e.toInt():St.runKernel((function(t,n){var r=t.relu6(e);return n([e]),r}),{$x:e},(function(t,e){var n=e[0],r=n.lessEqual(6).mul(n.step());return{$x:function(){return t.mulStrict(r.toFloat())}}}))}}),Ul=fn({selu_:function(t){var e=tn(t,"x","selu");return St.runKernel((function(t,n){var r=t.selu(e);return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){var e=n.greater(bn(0)),r=bn(1.7580993408473768),i=bn(1.0507009873554805),o=t.mul(i),a=t.mul(r).mul(n.toFloat().exp());return iu(e,o,a)}}}))}}),$l=fn({transpose_:function(t,e){var n=tn(t,"x","transpose");return null==e&&(e=n.shape.map((function(t,e){return e})).reverse()),p(n.rank===e.length,(function(){return"Error in transpose: rank of input "+n.rank+" must match length of perm "+e+"."})),e.forEach((function(t){p(t>=0&&t<n.rank,(function(){return"All entries in 'perm' must be between 0 and "+(n.rank-1)+" but got "+e}))})),n.rank<=1?n.clone():St.runKernel((function(t){return t.transpose(n,e)}),{$x:n},(function(t){var n=ln(e);return{$x:function(){return t.transpose(n)}}}))}}),Vl=fn({localResponseNormalization_:function(t,e,n,r,i){void 0===e&&(e=5),void 0===n&&(n=1),void 0===r&&(r=1),void 0===i&&(i=.5);var o=tn(t,"x","localResponseNormalization");p(4===o.rank||3===o.rank,(function(){return"Error in localResponseNormalization: x must be rank 3 or 4 but got\n               rank "+o.rank+"."})),p(w(e),(function(){return"Error in localResponseNormalization: depthRadius must be an integer but got depthRadius "+e+"."}));var a=o,s=!1;3===o.rank&&(s=!0,a=o.as4D(1,o.shape[0],o.shape[1],o.shape[2]));var u=St.runKernel((function(t,o){var s=t.localResponseNormalization4D(a,e,n,r,i);return o([a,s]),s}),{x4D:a},(function(t,o){var a=o[0],s=o[1];return{x4D:function(){return St.runKernel((function(o){return o.LRNGrad(t,a,s,e,n,r,i)}),{})}}}));return s?u.as3D(u.shape[1],u.shape[2],u.shape[3]):u}}),Wl=fn({norm_:function(t,e,n,r){void 0===e&&(e="euclidean"),void 0===n&&(n=null),void 0===r&&(r=!1);var i=function t(e,n,r){if(void 0===r&&(r=null),0===e.rank)return e.abs();if(1!==e.rank&&null===r)return t(e.reshape([-1]),n,r);if(1===e.rank||"number"==typeof r||Array.isArray(r)&&1===r.length){if(1===n)return e.abs().sum(r);if(n===1/0)return e.abs().max(r);if(n===-1/0)return e.abs().min(r);if("euclidean"===n||2===n)return e.abs().pow(bn(2,"int32")).sum(r).sqrt();throw new Error("Error in norm: invalid ord value: "+n)}if(Array.isArray(r)&&2===r.length){if(1===n)return e.abs().sum(r[0]).max(r[1]-1);if(n===1/0)return e.abs().sum(r[1]).max(r[0]);if(n===-1/0)return e.abs().sum(r[1]).min(r[0]);if("fro"===n||"euclidean"===n)return e.square().sum(r).sqrt();throw new Error("Error in norm: invalid ord value: "+n)}throw new Error("Error in norm: invalid axis: "+r)}(t=tn(t,"x","norm"),e,n),o=i.shape;if(r){var a=E(n,t.shape);o=an(i.shape,a)}return i.reshape(o)}}),ql=fn({basicLSTMCell_:function(t,e,n,r,i,o){var a=tn(t,"forgetBias","basicLSTMCell"),s=tn(e,"lstmKernel","basicLSTMCell"),u=tn(n,"lstmBias","basicLSTMCell"),l=tn(r,"data","basicLSTMCell"),c=tn(i,"c","basicLSTMCell"),h=tn(o,"h","basicLSTMCell"),d=l.concat(h,1).matMul(s).add(u),f=d.shape[1]/4,p=[d.shape[0],f],m=d.slice([0,0],p),g=d.slice([0,f],p),y=d.slice([0,2*f],p),v=d.slice([0,3*f],p),b=m.sigmoid().mulStrict(g.tanh()).addStrict(c.mulStrict(a.add(y).sigmoid())),w=b.tanh().mulStrict(v.sigmoid());return[b,w]}}),Hl=fn({multiRNNCell_:function(t,e,n,r){for(var i=tn(e,"data","multiRNNCell"),o=en(n,"c","multiRNNCell"),a=en(r,"h","multiRNNCell"),s=i,u=[],l=0;l<t.length;l++){var c=t[l](s,o[l],a[l]);u.push(c[0]),u.push(c[1]),s=c[1]}var h=[],d=[];for(l=0;l<u.length;l+=2)h.push(u[l]),d.push(u[l+1]);return[h,d]}}),Gl=fn({movingAverage_:function(t,e,n,r,i){void 0===i&&(i=!0);var o=tn(t,"v","movingAverage"),a=tn(e,"x","movingAverage"),s=tn(n,"decay","movingAverage");bt(o,a),p(b(o.shape,a.shape),(function(){return"Shape mismatch in v and x"}));var u=bn(1),l=u.sub(s),c=a.sub(o).mul(l);if(i){p(null!=r,(function(){return"When using zeroDebias: true, step is required."}));var h=tn(r,"step","movingAverage");c=c.div(u.sub(xu(s,h)))}return o.add(c)}}),Xl=fn({stridedSlice_:function(t,e,n,r,i,o,a,s,u){if(void 0===i&&(i=0),void 0===o&&(o=0),void 0===a&&(a=0),void 0===s&&(s=0),void 0===u&&(u=0),null==r&&(r=new Array(e.length)),0!==a)throw new Error("ellipsis mask is not yet supported");var l=tn(t,"x","stridedSlice"),c=Ir(s),h=l.shape.slice();c.forEach((function(t){e[t]=0,n[t]=1,h.splice(t,0,1)})),l=l.reshape(h);for(var d=0;d<l.rank;d++)e[d]=Fr(i,e,r,l.shape,d),n[d]=Pr(o,n,r,l.shape,d),r[d]=r[d]||1;var f=Ir(u);f.forEach((function(t){n[t]=e[t]+1,r[t]=1}));var p=Mr(e,n,r),m=p.filter((function(t,e){return-1===f.indexOf(e)}));return r.every((function(t){return 1===t}))?bl(l,e,p).reshape(m):St.runKernel((function(t){return t.stridedSlice(l,e,n,r)}),{$x:l}).reshape(m)}}),Kl=fn({topk_:function(t,e,n){void 0===e&&(e=1),void 0===n&&(n=!0);var r=tn(t,"x","topk");if(0===r.rank)throw new Error("topk() expects the input to be of rank 1 or higher");var i=r.shape[r.shape.length-1];if(e>i)throw new Error("'k' passed to topk() must be <= the last dimension ("+i+") but got "+e);var o=St.runKernel((function(t){return t.topk(r,e,n)}),{$x:r});return{values:o[0],indices:o[1]}}}),Yl=fn({scatterND_:function(t,e,n){var r=tn(t,"indices","scatterND","int32"),i=tn(e,"updates","scatterND");return function(t,e,n){if(e.rank<1)throw new Error("tf.scatterND() expects the indices to be rank 1 or higher, but the rank was "+e.rank+".");if(t.rank<1)throw new Error("tf.scatterND() expects the updates to be rank 1 or higher, but the rank was "+t.rank+".");if("int32"!==e.dtype)throw new Error("The dtype of 'indices' should be int32, but got dtype: "+e.dtype);if(n.length<1)throw new Error("Output rank must be greater or equal to 1, but got shape: "+n);if(0===n.length){if(0===e.size)throw new Error("Indices specified for empty output. indices shape: "+e.shape);if(0===t.size)throw new Error("Updates specified for empty output. updates shape: "+t.shape)}!function(t,e,n){var r=e.rank>1?e.shape[e.rank-1]:1,i=e.rank>1?e.rank-1:1,o="Must have updates.shape = indices.shape[:batchDim] + shape[sliceDim:], got updates.shape: "+n.shape+", indices.shape: "+e.shape+", shape: "+t+", sliceDim: "+r+", and batchDim: "+i+".";if(n.rank<i)throw new Error(o+" update.rank < "+i+". ");if(t.length<r+(n.rank-i))throw new Error(o+" Output shape length < "+(r+(n.rank-i)));if(n.rank!==i+t.length-r)throw new Error(o+" update.rank != "+(i+t.length-r));for(var a=0;a<i;++a)if(n.shape[a]!==e.shape[a])throw new Error(o+" updates.shape["+a+"] ("+n.shape[a]+") != indices.shape["+a+"] ("+e.shape[a]+").");for(a=0;a<n.rank-i;++a)if(n.shape[a+i]!==t[a+r])throw new Error(o+" updates.shape["+(a+i)+"] ("+n.shape[a+i]+") != shape["+(a+i)+"] ("+t[a+i]+")")}(n,e,t)}(i,r,n),St.runKernel((function(t){return t.scatterND(r,i,n)}),{$indices:r,$updates:i})}}),Zl=fn({fft_:function(t){p("complex64"===t.dtype,(function(){return"The dtype for tf.spectral.fft() must be complex64 but got "+t.dtype+"."}));var e=t.shape[t.shape.length-1],n=t.as2D(t.size/e,e);return St.runKernel((function(t){return t.fft(n)}),{input:t}).reshape(t.shape)}}),Ql=fn({ifft_:function(t){p("complex64"===t.dtype,(function(){return"The dtype for tf.spectral.ifft() must be complex64 but got "+t.dtype+"."}));var e=t.shape[t.shape.length-1],n=t.as2D(t.size/e,e);return St.runKernel((function(t){return t.ifft(n)}),{input:t}).reshape(t.shape)}}),Jl=fn({rfft_:function(t,e){p("float32"===t.dtype,(function(){return"The dtype for rfft() must be real value but got "+t.dtype}));var n,r=t.shape[t.shape.length-1],i=t.size/r;if(null!=e&&e<r){var o=t.shape.map((function(t){return 0})),a=t.shape.map((function(t){return t}));a[t.shape.length-1]=e,n=t.slice(o,a),r=e}else if(null!=e&&e>r){var s=t.shape.map((function(t){return t}));s[t.shape.length-1]=e-r,n=t.concat(On(s),t.shape.length-1),r=e}else n=t;var u=n.zerosLike(),l=pn(n,u).as2D(i,r),c=Zl(l),h=Math.floor(r/2)+1,d=mn(c),f=gn(c),m=d.split([h,r-h],d.shape.length-1),g=f.split([h,r-h],f.shape.length-1),y=n.shape.slice();return y[n.shape.length-1]=h,pn(m[0],g[0]).reshape(y)}}),tc=fn({irfft_:function(t){var e=t.shape[t.shape.length-1],n=t.size/e;if(e<=2){var r=t.as2D(n,e),i=Ql(r);return mn(i)}var o=[n,2*(e-1)],a=mn(t).as2D(n,e),s=gn(t).as2D(n,e),u=a.slice([0,1],[n,e-2]).reverse(1),l=s.slice([0,1],[n,e-2]).reverse(1).mul(bn(-1)),c=a.concat(u,1),h=s.concat(l,1);return r=pn(c,h).as2D(o[0],o[1]),i=Ql(r),mn(i)}}),ec=Object.freeze({fft:Zl,ifft:Ql,rfft:Jl,irfft:tc}),nc=fn({sparseToDense_:function(t,e,n,r){void 0===r&&(r=0);var i=tn(t,"sparseIndices","sparseToDense","int32"),o=tn(e,"sparseValues","sparseToDense"),a=tn(r,"defaultValue","sparseToDense",o.dtype);return function(t,e,n,r){if("int32"!==t.dtype)throw new Error("tf.sparseToDense() expects the indices to be int32 type, but the dtype was "+t.dtype+".");if(t.rank>2)throw new Error("sparseIndices should be a scalar, vector, or matrix, but got shape "+t.shape+".");var i=t.rank>0?t.shape[0]:1,o=t.rank>1?t.shape[1]:1;if(n.length!==o)throw new Error("outputShape has incorrect number of elements:, "+n.length+", should be: "+o+".");if(0!==e.rank&&(1!==e.rank||e.size!==i))throw new Error("sparseValues has incorrect shape "+e.shape+", should be [] or ["+i+"]");if(e.dtype!==r.dtype)throw new Error("sparseValues.dtype must match defaultValues.dtype")}(i,o,n,a),St.runKernel((function(t){return t.sparseToDense(i,o,n,a)}),{$sparseIndices:i,$sparseValues:o,$defaultValue:a})}}),rc=fn({gatherND_:function(t,e){var n=tn(e,"indices","gatherND","int32"),r=tn(t,"x","gatherND");return St.runKernel((function(t){return t.gatherND(r,n)}),{$x:r,$indices:n})}}),ic=fn({diag_:function(t){var e=tn(t,"x","diag").flatten(),n=t.shape.concat(t.shape);return St.runKernel((function(t){return t.diag(e)}),{$x:e}).reshape(n)}}),oc=fn({dropout_:function(t,e,n,r){var i=tn(t,"x","dropout");if(p("float32"===i.dtype,(function(){return"x has to be a floating point tensor since it's going to be scaled, but got a "+i.dtype+" tensor instead."})),p(e>=0&&e<1,(function(){return"rate must be a float in the range [0, 1), but got "+e+"."})),0===e)return t instanceof st?i.clone():i;var o=function(t,e){if(null==e)return t.shape.slice();if(b(t.shape,e))return e;if(t.shape.length===e.length){for(var n=[],r=0;r<t.shape.length;r++)n.push(null==e[r]&&null!=t.shape[r]?t.shape[r]:e[r]);return n}return e}(i,n),a=1-e,s=gr(o,0,1,"float32",r).add(a).floor().div(a);return i.mul(s)}});function ac(t,e,n){for(var r=1-t%2,i=new Float32Array(t),o=0;o<t;++o){var a=2*Math.PI*o/(t+r-1);i[o]=e-n*Math.cos(a)}return wn(i,"float32")}var sc,uc=fn({hannWindow_:function(t){return ac(t,.5,.5)}}),lc=fn({hammingWindow_:function(t){return ac(t,.54,.46)}}),cc=fn({frame_:function(t,e,n,r,i){void 0===r&&(r=!1),void 0===i&&(i=0);for(var o=0,a=[];o+e<=t.size;)a.push(bl(t,o,e)),o+=n;if(r)for(;o<t.size;){var s=o+e-t.size,u=In([bl(t,o,e-s),An([s],i)]);a.push(u),o+=n}return 0===a.length?xn([],[0,e]):In(a).as2D(a.length,e)}}),hc=fn({stft_:function(t,e,n,r,i){void 0===i&&(i=uc),null==r&&(r=Math.floor(Math.pow(2,Math.ceil(Math.log(e)/Math.log(2)))));for(var o=cc(t,e,n),a=bu(o,i(e)),s=[],u=0;u<o.shape[0];u++)s.push(Jl(a.slice([u,0],[1,e]),r));return In(s)}}),dc=Object.freeze({hannWindow:uc,hammingWindow:lc,frame:cc,stft:hc}),fc=function(t,e,n){return void 0===n&&(n=1),o(this,void 0,void 0,(function(){var r,i,o,s,u,l,c,h,d,f,g,y,v,b;return a(this,(function(a){switch(a.label){case 0:return r=tn(t,"predictions","inTopK"),i=tn(e,"targets","inTopK"),p(r.rank>1,(function(){return"inTopK() expects the predictions to be of rank 2 or higher, but got "+r.rank})),p(r.rank-1===i.rank,(function(){return"predictions rank should be 1 larger than targets rank, but got predictions rank "+r.rank+" and targets rank "+i.rank})),m(r.shape.slice(0,r.shape.length-1),i.shape,"predictions's shape should be align with the targets' shape, except the last dimension."),o=r.shape[r.shape.length-1],p(n>0&&n<=o,(function(){return"'k' passed to inTopK() must be > 0 && <= the predictions last dimension ("+o+"), but got "+n})),[4,r.data()];case 1:return s=a.sent(),[4,i.data()];case 2:for(u=a.sent(),h=(l=[s.length/o,o])[1],d=A("bool",c=l[0]),f=0;f<c;f++){for(y=s.subarray(g=f*h,g+h),v=[],b=0;b<y.length;b++)v.push({value:y[b],index:b});for(v.sort((function(t,e){return e.value-t.value})),d[f]=0,b=0;b<n;b++)if(v[b].index===u[f]){d[f]=1;break}}return t!==r&&r.dispose(),e!==i&&i.dispose(),[2,yn(d,i.shape,"bool")]}}))}))};!function(t){t[t.NONE=0]="NONE",t[t.MEAN=1]="MEAN",t[t.SUM=2]="SUM",t[t.SUM_BY_NONZERO_WEIGHTS=3]="SUM_BY_NONZERO_WEIGHTS"}(sc||(sc={}));var pc=fn({absoluteDifference_:function(t,e,n,r){void 0===r&&(r=sc.SUM_BY_NONZERO_WEIGHTS);var i=tn(t,"labels","absoluteDifference"),o=tn(e,"predictions","absoluteDifference"),a=null;null!=n&&(a=tn(n,"weights","absoluteDifference")),m(i.shape,o.shape,"Error in absoluteDifference: ");var s=i.sub(o).abs();return mc(s,a,r)}}),mc=fn({computeWeightedLoss_:function(t,e,n){void 0===n&&(n=sc.SUM_BY_NONZERO_WEIGHTS);var r=tn(t,"losses","computeWeightedLoss"),i=null;null!=e&&(i=tn(e,"weights","computeWeightedLoss"));var o=null==i?r:r.mul(i);if(n===sc.NONE)return o;if(n===sc.SUM)return o.sum();if(n===sc.MEAN){if(null==i)return o.mean();var a=r.size/i.size,s=o.sum().div(i.sum());return a>1?s.div(bn(a)):s}if(n===sc.SUM_BY_NONZERO_WEIGHTS){if(null==i)return o.sum().div(bn(r.size));var u=i.mul(En(r.shape)).notEqual(bn(0)).sum().toFloat();return o.sum().div(u)}throw Error("Unknown reduction: "+n)}}),gc=fn({cosineDistance_:function(t,e,n,r,i){void 0===i&&(i=sc.SUM_BY_NONZERO_WEIGHTS);var o=tn(t,"labels","cosineDistance"),a=tn(e,"predictions","cosineDistance"),s=null;null!=r&&(s=tn(r,"weights","cosineDistance")),m(o.shape,a.shape,"Error in cosineDistance: ");var u=bn(1).sub(o.mul(a).sum(n,!0));return mc(u,s,i)}}),yc=fn({hingeLoss_:function(t,e,n,r){void 0===r&&(r=sc.SUM_BY_NONZERO_WEIGHTS);var i=tn(t,"labels","hingeLoss"),o=tn(e,"predictions","hingeLoss"),a=null;null!=n&&(a=tn(n,"weights","hingeLoss")),m(i.shape,o.shape,"Error in hingeLoss: ");var s=bn(1);i=bn(2).mul(i).sub(s);var u=s.sub(i.mul(o)).relu();return mc(u,a,r)}}),vc=fn({huberLoss_:function(t,e,n,r,i){void 0===r&&(r=1),void 0===i&&(i=sc.SUM_BY_NONZERO_WEIGHTS);var o=tn(t,"labels","huberLoss"),a=tn(e,"predictions","huberLoss"),s=null;null!=n&&(s=tn(n,"weights","huberLoss")),m(o.shape,a.shape,"Error in huberLoss: ");var u=bn(r),l=a.sub(o).abs(),c=mu(l,u),h=l.sub(c),d=bn(.5).mul(c.square()).add(u.mul(h));return mc(d,s,i)}}),bc=fn({logLoss_:function(t,e,n,r,i){void 0===r&&(r=1e-7),void 0===i&&(i=sc.SUM_BY_NONZERO_WEIGHTS);var o=tn(t,"labels","logLoss"),a=tn(e,"predictions","logLoss"),s=null;null!=n&&(s=tn(n,"weights","logLoss")),m(o.shape,a.shape,"Error in logLoss: ");var u=bn(1),l=bn(r),c=o.mul(a.add(l).log()).neg().sub(u.sub(o).mul(u.sub(a).add(l).log()));return mc(c,s,i)}}),wc=fn({meanSquaredError_:function(t,e,n,r){void 0===r&&(r=sc.SUM_BY_NONZERO_WEIGHTS);var i=tn(t,"labels","meanSquaredError"),o=tn(e,"predictions","meanSquaredError"),a=null;null!=n&&(a=tn(n,"weights","meanSquaredError")),m(i.shape,o.shape,"Error in meanSquaredError: ");var s=i.squaredDifference(o);return mc(s,a,r)}}),xc=fn({sigmoidCrossEntropy_:function(t,e,n,r,i){void 0===r&&(r=0),void 0===i&&(i=sc.SUM_BY_NONZERO_WEIGHTS);var o=tn(t,"multiClassLabels","sigmoidCrossEntropy"),a=tn(e,"logits","sigmoidCrossEntropy"),s=null;if(null!=n&&(s=tn(n,"weights","sigmoidCrossEntropy")),m(o.shape,a.shape,"Error in sigmoidCrossEntropy: "),r>0){var u=bn(r),l=bn(1),c=bn(.5);o=o.mul(l.sub(u)).add(c.mul(u))}var h=function(t,e){var n=tn(t,"labels","sigmoidCrossEntropyWithLogits"),r=tn(e,"logits","sigmoidCrossEntropyWithLogits");m(n.shape,r.shape,"Error in sigmoidCrossEntropyWithLogits: ");var i=r.relu(),o=r.mul(n),a=r.abs().neg().exp().log1p();return i.sub(o).add(a)}(o,a);return mc(h,s,i)}}),_c=fn({softmaxCrossEntropy_:function(t,e,n,r,i){void 0===r&&(r=0),void 0===i&&(i=sc.SUM_BY_NONZERO_WEIGHTS);var o=tn(t,"onehotLabels","softmaxCrossEntropy"),a=tn(e,"logits","softmaxCrossEntropy"),s=null;if(null!=n&&(s=tn(n,"weights","softmaxCrossEntropy")),m(o.shape,a.shape,"Error in softmaxCrossEntropy: "),r>0){var u=bn(r),l=bn(1),c=bn(o.shape[1]);o=o.mul(l.sub(u)).add(u.div(c))}var h=function(t,e,n){if(void 0===n&&(n=-1),-1===n&&(n=e.rank-1),n!==e.rank-1)throw Error("Softmax cross entropy along a non-last dimension is not yet supported. Labels / logits was rank "+e.rank+" and dim was "+n);return Wr((function(t,e,r){var i=e.logSumExp([n],!0),o=e.toFloat().sub(i);return r([t,o]),{value:o.mul(t).neg().sum([n]),gradFunc:function(t,e){var r=e[0],i=e[1],o=an(t.shape,[n]);return[t.reshape(o).mul(r.toFloat().sub(i.exp())),t.reshape(o).mul(i.exp().sub(r.toFloat()))]}}}))(t,e)}(o,a);return mc(h,s,i)}}),Cc=Object.freeze({get Reduction(){return sc},absoluteDifference:pc,computeWeightedLoss:mc,cosineDistance:gc,hingeLoss:yc,huberLoss:vc,logLoss:bc,meanSquaredError:wc,sigmoidCrossEntropy:xc,softmaxCrossEntropy:_c});function kc(t,e){return void 0===e&&(e=!1),St.tidy((function(){if(2!==t.shape.length)throw new Error("qr2d() requires a 2D Tensor, but got a "+t.shape.length+"D Tensor.");for(var n=t.shape[0],r=t.shape[1],i=or(n),o=t.clone(),a=xn([[1]],[1,1]),s=a.clone(),u=n>=r?r:n,l=function(t){var e,u=o,l=s,c=i;e=St.tidy((function(){var e=o.slice([t,t],[n-t,1]),u=e.norm(),l=o.slice([t,t],[1,1]),c=xn([[-1]]).where(l.greater(0),xn([[1]])),h=l.sub(c.mul(u)),d=e.div(h);s=1===d.shape[0]?a.clone():a.concat(d.slice([1,0],[d.shape[0]-1,d.shape[1]]),0);var f=c.matMul(h).div(u).neg(),p=o.slice([t,0],[n-t,r]),m=f.mul(s);if(0===t)o=p.sub(m.matMul(s.transpose().matMul(p)));else{var g=p.sub(m.matMul(s.transpose().matMul(p)));o=o.slice([0,0],[t,r]).concat(g,0)}var y=i.slice([0,t],[n,i.shape[1]-t]);if(0===t)i=y.sub(y.matMul(s).matMul(m.transpose()));else{var v=y.sub(y.matMul(s).matMul(m.transpose()));i=i.slice([0,0],[n,t]).concat(v,1)}return[s,o,i]})),s=e[0],o=e[1],i=e[2],Le([u,l,c])},c=0;c<u;++c)l(c);return!e&&n>r&&(i=i.slice([0,0],[n,r]),o=o.slice([0,0],[r,r])),[i,o]}))}var Sc=fn({gramSchmidt_:function(t){var e;if(Array.isArray(t)){e=!1,p(null!=t&&t.length>0,(function(){return"Gram-Schmidt process: input must not be null, undefined, or empty"}));for(var n=t[0].shape[0],r=function(e){p(t[e].shape[0]===n,(function(){return"Gram-Schmidt: Non-unique lengths found in the input vectors: ("+t[e].shape[0]+" vs. "+n+")"}))},i=1;i<t.length;++i)r(i)}else e=!0,t=zn(t,t.shape[0],0).map((function(t){return br(t,[0])}));p(t.length<=t[0].shape[0],(function(){return"Gram-Schmidt: Number of vectors ("+t.length+") exceeds number of dimensions ("+t[0].shape[0]+")."}));var o=[],a=t,s=function(t){o.push(St.tidy((function(){var e=a[t];if(t>0)for(var n=0;n<t;++n){var r=Ml(o[n].mulStrict(e)).mul(o[n]);e=e.sub(r)}return e.div(Wl(e,"euclidean"))})))};for(i=0;i<t.length;++i)s(i);return e?wr(o,0):o}}),Ec=fn({qr_:function(t,e){if(void 0===e&&(e=!1),t.rank<2)throw new Error("qr() requires input tensor to have a rank >= 2, but got rank "+t.rank);if(2===t.rank)return kc(t,e);var n=t.shape.slice(0,t.shape.length-2).reduce((function(t,e){return t*e})),r=Cr(t.reshape([n,t.shape[t.shape.length-2],t.shape[t.shape.length-1]]),0),i=[],o=[];return r.forEach((function(t){var n=kc(t,e),r=n[1];i.push(n[0]),o.push(r)})),[wr(i,0).reshape(t.shape),wr(o,0).reshape(t.shape)]}}),Oc=Object.freeze({gramSchmidt:Sc,qr:Ec});function Ac(t,e,n,r,i){null==r&&(r=.5),null==i&&(i=Number.NEGATIVE_INFINITY);var o=t.shape[0];return n=Math.min(n,o),p(0<=r&&r<=1,(function(){return"iouThreshold must be in [0, 1], but was '"+r+"'"})),p(2===t.rank,(function(){return"boxes must be a 2D tensor, but was of rank '"+t.rank+"'"})),p(4===t.shape[1],(function(){return"boxes must have 4 columns, but 2nd dimension was "+t.shape[1]})),p(1===e.rank,(function(){return"scores must be a 1D tensor"})),p(e.shape[0]===o,(function(){return"scores has incompatible shape with boxes. Expected "+o+", but was "+e.shape[0]})),{maxOutputSize:n,iouThreshold:r,scoreThreshold:i}}var Nc=fn({resizeBilinear_:function(t,e,n){void 0===n&&(n=!1);var r=tn(t,"images","resizeBilinear");p(3===r.rank||4===r.rank,(function(){return"Error in resizeBilinear: x must be rank 3 or 4, but got rank "+r.rank+"."})),p(2===e.length,(function(){return"Error in resizeBilinear: new shape must 2D, but got shape "+e+"."}));var i=r,o=!1;3===r.rank&&(o=!0,i=r.as4D(1,r.shape[0],r.shape[1],r.shape[2]));var a=e[0],s=e[1],u=St.runKernel((function(t,e){return e([i]),t.resizeBilinear(i,a,s,n)}),{batchImages:i},(function(t,e){return{batchImages:function(){return St.runKernel((function(r){return r.resizeBilinearBackprop(t,e[0],n)}),{})}}}));return o?u.as3D(u.shape[1],u.shape[2],u.shape[3]):u}}),Tc=fn({resizeNearestNeighbor_:function(t,e,n){void 0===n&&(n=!1);var r=tn(t,"images","resizeNearestNeighbor");p(3===r.rank||4===r.rank,(function(){return"Error in resizeNearestNeighbor: x must be rank 3 or 4, but got rank "+r.rank+"."})),p(2===e.length,(function(){return"Error in resizeNearestNeighbor: new shape must 2D, but got shape "+e+"."})),p("float32"===r.dtype||"int32"===r.dtype,(function(){return"`images` must have `int32` or `float32` as dtype"}));var i=r,o=!1;3===r.rank&&(o=!0,i=r.as4D(1,r.shape[0],r.shape[1],r.shape[2]));var a=e[0],s=e[1],u=St.runKernel((function(t,e){return e([i]),t.resizeNearestNeighbor(i,a,s,n)}),{batchImages:i},(function(t,e){return{batchImages:function(){return St.runKernel((function(r){return r.resizeNearestNeighborBackprop(t,e[0],n)}),{})}}}));return o?u.as3D(u.shape[1],u.shape[2],u.shape[3]):u}}),Dc=fn({nonMaxSuppression_:function(t,e,n,r,i){void 0===r&&(r=.5),void 0===i&&(i=Number.NEGATIVE_INFINITY);var o=tn(t,"boxes","nonMaxSuppression"),a=tn(e,"scores","nonMaxSuppression"),s=Ac(o,a,n,r,i);return n=s.maxOutputSize,r=s.iouThreshold,i=s.scoreThreshold,St.runKernel((function(t){return t.nonMaxSuppression(o,a,n,r,i)}),{$boxes:o})}}),Rc=fn({cropAndResize_:function(t,e,n,r,i,o){var a=tn(t,"image","cropAndResize","float32"),s=tn(e,"boxes","cropAndResize","float32"),u=tn(n,"boxInd","cropAndResize","int32");i=i||"bilinear",o=o||0;var l=s.shape[0];return p(4===a.rank,(function(){return"Error in cropAndResize: image must be rank 4,but got rank "+a.rank+"."})),p(2===s.rank&&4===s.shape[1],(function(){return"Error in cropAndResize: boxes must be have size ["+l+",4] but had shape "+s.shape+"."})),p(1===u.rank&&u.shape[0]===l,(function(){return"Error in cropAndResize: boxInd must be have size ["+l+"] but had shape "+s.shape+"."})),p(2===r.length,(function(){return"Error in cropAndResize: cropSize must be of length 2, but got length "+r.length+"."})),p(r[0]>=1&&r[1]>=1,(function(){return"cropSize must be atleast [1,1], but was "+r})),p("bilinear"===i||"nearest"===i,(function(){return"method must be bilinear or nearest, but was "+i})),St.runKernel((function(t,e){return t.cropAndResize(a,s,u,r,i,o)}),{$image:a,$boxes:s})}}),Ic=Object.freeze({resizeBilinear:Nc,resizeNearestNeighbor:Tc,nonMaxSuppression:Dc,nonMaxSuppressionAsync:function(t,e,n,r,i){return void 0===r&&(r=.5),void 0===i&&(i=Number.NEGATIVE_INFINITY),o(this,void 0,void 0,(function(){var o,s,u,l,c;return a(this,(function(a){switch(a.label){case 0:return o=tn(t,"boxes","nonMaxSuppressionAsync"),s=tn(e,"scores","nonMaxSuppressionAsync"),u=Ac(o,s,n,r,i),n=u.maxOutputSize,r=u.iouThreshold,i=u.scoreThreshold,[4,Promise.all([o.data(),s.data()])];case 1:return l=a.sent(),c=bi(l[0],l[1],n,r,i),o!==t&&o.dispose(),s!==e&&s.dispose(),[2,c]}}))}))},cropAndResize:Rc}),Mc=fn({matMul_:function(t){var e,n=t.b,r=t.transposeA,i=void 0!==r&&r,o=t.transposeB,a=void 0!==o&&o,s=t.bias,u=t.activation,l=void 0===u?"linear":u,c=t.preluActivationWeights,h=tn(t.a,"a","fused matMul"),d=tn(n,"b","fused matMul");e=vt(h,d),h=e[0],d=e[1];var f=i?h.shape[h.rank-2]:h.shape[h.rank-1],m=a?d.shape[d.rank-1]:d.shape[d.rank-2],g=i?h.shape[h.rank-1]:h.shape[h.rank-2],y=a?d.shape[d.rank-2]:d.shape[d.rank-1],w=h.shape.slice(0,-2),x=d.shape.slice(0,-2),_=v(w),C=v(x);p(h.rank>=2&&d.rank>=2&&h.rank===d.rank,(function(){return"Error in fused matMul: inputs must have the same rank of at least 2, got ranks "+h.rank+" and "+d.rank+"."})),p(b(w,x),(function(){return"Error in fused matMul: outer dimensions ("+w+") and ("+x+") of Tensors with shapes "+h.shape+" and "+d.shape+" must match."})),p(f===m,(function(){return"Error in fused matMul: inner shapes ("+f+") and ("+m+") of Tensors with shapes "+h.shape+" and "+d.shape+" and transposeA="+i+" and transposeB="+a+" must match."}));var k,S,E=h.shape.slice(0,-2).concat([g,y]),O=i?h.as3D(_,f,g):h.as3D(_,g,f),A=a?d.as3D(C,y,m):d.as3D(C,m,y);null!=s&&Qr(E,(k=vt(k=tn(s,"bias","fused matMul"),h)[0]).shape),null!=c&&(S=tn(c,"prelu weights","fused matMul"));var N={$a:O,$b:A};return null!=s&&(N.$bias=k),null!=c&&(N.$preluActivationWeights=S),St.runKernel((function(t,e){var n=t.fusedBatchMatMul({a:O,b:A,transposeA:i,transposeB:a,bias:k,activation:l,preluActivationWeights:S});return e([O,A,n]),n}),N,(function(t,e){var n,r=e[0],o=e[1],u=e[2];if(null==l||"linear"===l)n=t;else{if("relu"!==l)throw new Error("Gradient for activation "+l+" has not been implemented yet.");n=t.mul(u.step())}var c={};return null!=s&&(c={$bias:function(){var t=n,e=Zr(k.shape,n.shape);return e.length>0&&(t=t.sum(e)),t.reshape(k.shape)}}),Object.assign(i||a?!i&&a?{$a:function(){return n.matMul(o,!1,!1)},$b:function(){return n.matMul(r,!0,!1)}}:i&&!a?{$a:function(){return o.matMul(n,!1,!0)},$b:function(){return r.matMul(n,!1,!1)}}:{$a:function(){return o.matMul(n,!0,!0)},$b:function(){return n.matMul(r,!0,!0)}}:{$a:function(){return n.matMul(o,!1,!0)},$b:function(){return r.matMul(n,!0,!1)}},c)})).reshape(E)}}),Fc=fn({conv2d_:function(t){var e=t.filter,n=t.strides,r=t.pad,i=t.dataFormat,o=void 0===i?"NHWC":i,a=t.dilations,s=void 0===a?[1,1]:a,u=t.dimRoundingMode,l=t.bias,c=t.activation,h=void 0===c?"linear":c,d=t.preluActivationWeights,f=tn(t.x,"x","conv2d"),m=tn(e,"filter","conv2d"),g=f,y=!1;3===f.rank&&(y=!0,g=f.as4D(1,f.shape[0],f.shape[1],f.shape[2])),p(4===g.rank,(function(){return"Error in fused conv2d: input must be rank 4, but got rank "+g.rank+"."})),p(4===m.rank,(function(){return"Error in fused conv2d: filter must be rank 4, but got rank "+m.rank+"."})),null!=u&&p(w(r),(function(){return"Error in fused conv2d: pad must be an integer when using, dimRoundingMode "+u+" but got pad "+r+"."})),p(g.shape[3]===m.shape[2],(function(){return"Error in conv2d: depth of input ("+g.shape[3]+") must match input depth for filter "+m.shape[2]+"."})),p(li(n,s),(function(){return"Error in conv2D: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+s+"'"})),p("NHWC"===o,(function(){return"Error in conv2d: got dataFormat of "+o+" but only NHWC is currently supported."}));var v,b,x=ei(g.shape,m.shape,n,s,r,u);null!=l&&(v=vt(v=tn(l,"bias","fused conv2d"),f)[0],Qr(x.outShape,v.shape)),null!=d&&(b=tn(d,"prelu weights","fused conv2d"));var _={x:g,$filter:m};null!=l&&(_.$bias=v),null!=d&&(_.$preluActivationWeights=b);var C=St.runKernel((function(t,e){var n=t.fusedConv2d({input:g,filter:m,convInfo:x,bias:v,activation:h,preluActivationWeights:b});return e([m,g,n]),n}),_,(function(t,e){var i,o=e[0],a=e[1],u=e[2];if(null==h||"linear"===h)i=t;else{if("relu"!==h)throw new Error("Gradient for activation "+h+" has not been implemented yet.");i=t.mul(u.step())}p(ui(s),(function(){return"Error in gradient of fused conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '"+s+"'"}));var c={};return null!=l&&(c={$bias:function(){var t=i,e=Zr(v.shape,i.shape);return e.length>0&&(t=t.sum(e)),t.reshape(v.shape)}}),Object.assign({x:function(){return Zu(a.shape,i,o,n,r)},$filter:function(){return Yu(a,i,o.shape,n,r)}},c)}));return y?C.as3D(C.shape[1],C.shape[2],C.shape[3]):C}}),Pc=fn({depthwiseConv2d_:function(t){var e=t.filter,n=t.strides,r=t.pad,i=t.dilations,o=void 0===i?[1,1]:i,a=t.dimRoundingMode,s=t.bias,u=t.activation,l=void 0===u?"linear":u,c=t.preluActivationWeights,h=tn(t.x,"x","depthwiseConv2d"),d=tn(e,"filter","depthwiseConv2d"),f=h,m=!1;3===h.rank&&(m=!0,f=h.as4D(1,h.shape[0],h.shape[1],h.shape[2])),p(4===f.rank,(function(){return"Error in fused depthwiseConv2d: input must be rank 4, but got rank "+f.rank+"."})),p(4===d.rank,(function(){return"Error in fused depthwiseConv2d: filter must be rank 4, but got rank "+d.rank+"."})),p(f.shape[3]===d.shape[2],(function(){return"Error in fused depthwiseConv2d: number of input channels ("+f.shape[3]+") must match the inChannels dimension in filter "+d.shape[2]+"."})),null==o&&(o=[1,1]),p(li(n,o),(function(){return"Error in fused depthwiseConv2d: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+o+"'"})),null!=a&&p(w(r),(function(){return"Error in fused depthwiseConv2d: pad must be an integer when using dimRoundingMode "+a+" but got pad "+r+"."}));var g,y,v=ei(f.shape,d.shape,n,o,r,a,!0);null!=s&&(g=vt(g=tn(s,"bias","fused conv2d"),h)[0],Qr(v.outShape,g.shape)),null!=c&&(y=tn(c,"prelu weights","fused depthwiseConv2d"));var b={x:f,$filter:d};null!=s&&(b.$bias=g),null!=c&&(b.$preluActivationWeights=y);var x=St.runKernel((function(t,e){var n=t.fusedDepthwiseConv2D({input:f,filter:d,convInfo:v,bias:g,activation:l,preluActivationWeights:y});return e([f,d,n]),n}),b,(function(t,e){p(ui(o),(function(){return"Error in gradient of fused depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations '"+o+"'"}));var n,r=e[0],i=e[1],a=e[2];if(null==l||"linear"===l)n=t;else{if("relu"!==l)throw new Error("Gradient for activation "+l+" has not been implemented yet.");n=t.mul(a.step())}var u={};return null!=s&&(u={$bias:function(){var t=n,e=Zr(g.shape,n.shape);return e.length>0&&(t=t.sum(e)),t.reshape(g.shape)}}),Object.assign({x:function(){return Ju(r.shape,n,i,v)},$filter:function(){return tl(r,n,i.shape,v)}},u)}));return m?x.as3D(x.shape[1],x.shape[2],x.shape[3]):x}}),jc=Object.freeze({matMul:Mc,conv2d:Fc,depthwiseConv2d:Pc}),zc=Object.freeze({image:Ic,linalg:Oc,losses:Cc,spectral:ec,fused:jc,signal:dc,conv1d:Gu,conv2d:Xu,conv3d:Ku,depthwiseConv2d:Qu,separableConv2d:el,conv2dTranspose:nl,conv3dTranspose:rl,op:fn,batchNormalization2d:Hs,batchNormalization3d:Gs,batchNormalization4d:Xs,batchNormalization:Ks,batchNorm:Ys,batchNorm2d:Zs,batchNorm3d:Qs,batchNorm4d:Js,booleanMaskAsync:Vu,complex:pn,real:mn,imag:gn,concat:In,concat1d:Mn,concat2d:Fn,concat3d:Pn,concat4d:jn,split:zn,matMul:il,dot:ol,outerProduct:al,reverse:sl,reverse1d:ul,reverse2d:ll,reverse3d:cl,reverse4d:hl,maxPool:pl,avgPool:ml,pool:gl,maxPool3d:yl,avgPool3d:vl,slice:bl,slice1d:wl,slice2d:xl,slice3d:_l,slice4d:Cl,abs:os,acos:as,acosh:ss,asin:us,asinh:ls,atan:cs,atanh:hs,ceil:ds,clipByValue:fs,cos:ps,cosh:ms,erf:gs,exp:ys,expm1:vs,floor:bs,log:ws,log1p:xs,logSigmoid:_s,neg:Cs,reciprocal:ks,round:Ss,rsqrt:Es,sigmoid:Os,sign:As,isNaN:Ns,isInf:Ts,isFinite:Ds,sin:Rs,sinh:Is,softplus:Ms,sqrt:Fs,square:Ps,step:js,tan:zs,tanh:Ls,all:Sl,any:El,argMax:Ol,argMin:Al,logSumExp:Nl,max:Tl,mean:Dl,min:Rl,moments:Il,sum:Ml,prod:Fl,equal:Ou,equalStrict:Au,greater:Nu,greaterEqual:Tu,greaterEqualStrict:Du,greaterStrict:Ru,less:Iu,lessEqual:Mu,lessEqualStrict:Fu,lessStrict:Pu,notEqual:ju,notEqualStrict:zu,add:au,addN:su,addStrict:uu,atan2:lu,div:cu,divStrict:hu,floorDiv:du,maximum:fu,maximumStrict:pu,minimum:mu,minimumStrict:gu,mod:yu,modStrict:vu,mul:bu,mulStrict:wu,pow:xu,powStrict:_u,squaredDifference:Cu,squaredDifferenceStrict:ku,sub:Su,subStrict:Eu,elu:Pl,leakyRelu:jl,prelu:zl,relu:Ll,relu6:Bl,selu:Ul,logicalAnd:tu,logicalNot:eu,logicalOr:nu,logicalXor:ru,where:iu,whereAsync:ou,buffer:Zn,print:Qn,batchToSpaceND:Jn,cast:tr,clone:er,cumsum:nr,depthToSpace:rr,expandDims:ir,eye:or,multinomial:ar,oneHot:sr,pad:ur,pad1d:lr,pad2d:cr,pad3d:hr,pad4d:dr,rand:fr,randomNormal:pr,randomGamma:mr,randomUniform:gr,reshape:yr,spaceToBatchND:vr,squeeze:br,stack:wr,tile:xr,truncatedNormal:_r,unstack:Cr,setdiff1dAsync:kr,fill:An,linspace:Nn,ones:En,range:Tn,scalar:bn,tensor:yn,tensor1d:wn,tensor2d:xn,tensor3d:_n,tensor4d:Cn,tensor5d:kn,tensor6d:Sn,zeros:On,onesLike:Dn,zerosLike:Rn,transpose:$l,softmax:Hr,logSoftmax:Gr,localResponseNormalization:Vl,norm:Wl,gather:Uu,unsortedSegmentSum:$u,basicLSTMCell:ql,multiRNNCell:Hl,movingAverage:Gl,stridedSlice:Xl,topk:Kl,scatterND:Yl,fft:Zl,ifft:Ql,rfft:Jl,irfft:tc,sparseToDense:nc,gatherND:rc,diag:ic,dropout:oc,hannWindow:uc,hammingWindow:lc,frame:cc,stft:hc,inTopKAsync:fc});function Lc(t,e,n,r){if("linear"===n)return t.linear(e);if("relu"===n)return t.relu(e);if("elu"===n)return t.elu(e);if("relu6"===n)return t.relu6(e);if("prelu"===n)return t.prelu(e,r);throw new Error("Activation "+n+" has not been implemented for the CPU backend.")}var Bc=function(){function t(){if(this.blockSize=48,this.firstUse=!0,u().get("IS_BROWSER")){var t="undefined"!=typeof OffscreenCanvas?new OffscreenCanvas(300,150):"undefined"!=typeof document?document.createElement("canvas"):null;null!==t&&(this.fromPixels2DContext=t.getContext("2d"))}this.data=new Xr(this,St)}return t.prototype.register=function(t,e,n){if(this.firstUse&&(this.firstUse=!1,u().get("IS_NODE")&&Ze("\n============================\nHi there \ud83d\udc4b. Looks like you are running TensorFlow.js in Node.js. To speed things up dramatically, install our node backend, which binds to TensorFlow C++, by running npm i @tensorflow/tfjs-node, or npm i @tensorflow/tfjs-node-gpu if you have CUDA. Then call require('@tensorflow/tfjs-node'); (-gpu suffix for CUDA) at the start of your program. Visit https://github.com/tensorflow/tfjs-node for more details.\n============================\n")),this.data.has(t))throw new Error("Data buffer is already registered");this.data.set(t,{dtype:n})},t.prototype.write=function(t,e){if(null==e)throw new Error("MathBackendCPU.write(): values can not be null");this.data.get(t).values=e},t.prototype.fromPixels=function(t,e){if(null==t)throw new Error("pixels passed to tf.browser.fromPixels() can not be null");var n,r,i=t.data instanceof Uint8Array,o="undefined"!=typeof ImageData&&t instanceof ImageData,a="undefined"!=typeof HTMLVideoElement&&t instanceof HTMLVideoElement,s="undefined"!=typeof HTMLImageElement&&t instanceof HTMLImageElement,l=a?[t.videoWidth,t.videoHeight]:[t.width,t.height],c=l[0],h=l[1];if(u().get("IS_NODE")&&null==t.getContext)throw new Error("When running in node, pixels must be an HTMLCanvasElement like the one returned by the `canvas` npm package");if(null!=t.getContext)n=t.getContext("2d").getImageData(0,0,c,h).data;else if(o||i)n=t.data;else{if(!s&&!a)throw new Error("pixels passed to tf.browser.fromPixels() must be either an HTMLVideoElement, HTMLImageElement, HTMLCanvasElement, ImageData or {data: Uint32Array, width: number, height: number}, but was "+t.constructor.name);if(null==this.fromPixels2DContext)throw new Error("Can't read pixels from HTMLImageElement outside the browser.");this.fromPixels2DContext.canvas.width=c,this.fromPixels2DContext.canvas.height=h,this.fromPixels2DContext.drawImage(t,0,0,c,h),n=this.fromPixels2DContext.getImageData(0,0,c,h).data}if(4===e)r=new Int32Array(n);else{var d=c*h;r=new Int32Array(d*e);for(var f=0;f<d;f++)for(var p=0;p<e;++p)r[f*e+p]=n[4*f+p]}return _n(r,[h,c,e],"int32")},t.prototype.read=function(t){return o(this,void 0,void 0,(function(){return a(this,(function(e){return[2,this.readSync(t)]}))}))},t.prototype.readSync=function(t){var e=this.data.get(t),n=e.complexTensors;return"complex64"===e.dtype?mi(this.readSync(n.real.dataId),this.readSync(n.imag.dataId)):this.data.get(t).values},t.prototype.bufferSync=function(t){var e=this.readSync(t.dataId),n=e;if("string"===t.dtype)try{n=e.map((function(t){return Y(t)}))}catch(t){throw new Error("Failed to decode encoded string bytes into utf-8")}return Zn(t.shape,t.dtype,n)},t.prototype.disposeData=function(t){if(this.data.has(t)){var e=this.data.get(t).complexTensors;null!=e&&(e.real.dispose(),e.imag.dispose()),this.data.delete(t)}},t.prototype.time=function(t){return o(this,void 0,void 0,(function(){var e;return a(this,(function(n){return e=G(),t(),[2,{kernelMs:G()-e}]}))}))},t.prototype.memory=function(){return{unreliable:!0,reasons:["The reported memory is an upper bound. Due to automatic garbage collection, the true allocated memory may be less."]}},t.prototype.complex=function(t,e){var n=st.make(t.shape,{},"complex64");return this.data.get(n.dataId).complexTensors={real:St.keep(t.clone()),imag:St.keep(e.clone())},n},t.prototype.real=function(t){return this.data.get(t.dataId).complexTensors.real.clone()},t.prototype.imag=function(t){return this.data.get(t.dataId).complexTensors.imag.clone()},t.prototype.assertNotComplex=function(t,e){Array.isArray(t)||(t=[t]),t.forEach((function(t){null!=t&&p("complex64"!==t.dtype,(function(){return e+" does not support complex64 tensors."}))}))},t.prototype.slice=function(t,e,n){if(this.assertNotComplex(t,"slice"),jr(t.shape,e,n)){var r=zr(e,t.strides),i=v(n);return yn(this.readSync(t.dataId).subarray(r,r+i),n,t.dtype)}for(var o=Zn(n,t.dtype),a=this.bufferSync(t),s=0;s<o.size;++s){var u=o.indexToLoc(s).map((function(t,n){return t+e[n]}));o.values[s]=a.get.apply(a,u)}return o.toTensor()},t.prototype.stridedSlice=function(t,e,n,r){this.assertNotComplex(t,"stridedSlice");var i=Mr(e,n,r);if(i.some((function(t){return 0===t})))return yn([],i);for(var o=Zn(i,t.dtype),a=this.bufferSync(t),s=0;s<o.size;s++){for(var u=o.indexToLoc(s),l=new Array(u.length),c=0;c<l.length;c++)l[c]=u[c]*r[c]+e[c];o.set.apply(o,[a.get.apply(a,l)].concat(u))}return o.toTensor()},t.prototype.diag=function(t){for(var e=this.readSync(t.dataId),n=Zn([t.size,t.size],t.dtype),r=n.values,i=0;i<e.length;i++)r[i*t.size+i]=e[i];return n.toTensor()},t.prototype.unstack=function(t,e){for(var n=t.shape[e],r=new Array(t.rank-1),i=0,o=0;o<t.rank;o++)o!==e&&(r[i++]=t.shape[o]);var a=new Array(t.rank).fill(0),s=t.shape.slice();s[e]=1;var u=new Array(n);for(o=0;o<u.length;o++)a[e]=o,u[o]=this.slice(t,a,s).reshape(r);return u},t.prototype.reverse=function(t,e){this.assertNotComplex(t,"reverse");for(var n=Zn(t.shape,t.dtype),r=this.bufferSync(t),i=function(i){var o=n.indexToLoc(i),a=o.slice();e.forEach((function(e){return a[e]=t.shape[e]-1-a[e]})),n.set.apply(n,[r.get.apply(r,a)].concat(o))},o=0;o<n.size;o++)i(o);return n.toTensor()},t.prototype.concat=function(t,e){var n=this;if("complex64"===t[0].dtype){var r=t.map((function(t){return mn(t)})),i=t.map((function(t){return gn(t)}));return pn(this.concat(r,e),this.concat(i,e))}var o=t.map((function(t){var n=v(t.shape.slice(e));return t.as2D(-1,n)})),a=dn(o.map((function(t){return t.shape})),1),s=Zn(a,t[0].dtype).values;if(1===o[0].shape[0]){var u=0;o.forEach((function(t){s.set(n.readSync(t.dataId),u),u+=t.size}))}else{var l=0;o.forEach((function(t){for(var e=n.readSync(t.dataId),r=0,i=0;i<t.shape[0];++i)for(var o=i*a[1]+l,u=0;u<t.shape[1];++u)s[o+u]=e[r++];l+=t.shape[1]}))}var c=dn(t.map((function(t){return t.shape})),e);return yn(s,c,t[0].dtype)},t.prototype.neg=function(t){return this.assertNotComplex(t,"neg"),this.multiply(bn(-1),t)},t.prototype.add=function(t,e){return"complex64"===t.dtype||"complex64"===e.dtype?this.broadcastedBinaryComplexOp(t.cast("complex64"),e.cast("complex64"),(function(t,e,n,r){return{real:t+n,imag:e+r}})):this.broadcastedBinaryOp(t,e,gt(t.dtype,e.dtype),(function(t,e){return t+e}))},t.prototype.addN=function(t){var e=this;this.assertNotComplex(t,"addN");for(var n=t.map((function(t){return e.readSync(t.dataId)})),r=Zn(t[0].shape,t[0].dtype),i=r.values,o=0;o<t.length;o++)for(var a=n[o],s=0;s<i.length;s++)i[s]+=a[s];return r.toTensor()},t.prototype.subtract=function(t,e){return"complex64"===t.dtype||"complex64"===e.dtype?this.broadcastedBinaryComplexOp(t.cast("complex64"),e.cast("complex64"),(function(t,e,n,r){return{real:t-n,imag:e-r}})):this.broadcastedBinaryOp(t,e,gt(t.dtype,e.dtype),(function(t,e){return t-e}))},t.prototype.pow=function(t,e){return this.assertNotComplex([t,e],"pow"),this.broadcastedBinaryOp(t,e,t.dtype,(function(t,e){return Math.pow(t,e)}))},t.prototype.batchMatMul=function(t,e,n,r){this.assertNotComplex([t,e],"matMul");for(var i=n?t.shape[1]:t.shape[2],o=n?t.shape[2]:t.shape[1],a=r?e.shape[1]:e.shape[2],s=t.shape[0],u=this.readSync(t.dataId),l=this.readSync(e.dataId),c=n?[t.strides[0],1,t.strides[1]]:[t.strides[0],t.strides[1],1],h=c[0],d=c[1],f=c[2],p=r?[1,e.strides[1],e.strides[0]]:[e.strides[1],1,e.strides[0]],m=p[0],g=p[1],y=p[2],v=o*a,b=Zn([s,o,a],t.dtype),w=b.values,x=this.blockSize,_=0;_<s;_++)for(var C=0;C<o;C+=x)for(var k=0;k<a;k+=x)for(var S=0;S<i;S+=x)for(var E=Math.min(C+x,o),O=Math.min(k+x,a),A=Math.min(S+x,i),N=C;N<E;N++)for(var T=k;T<O;T++){for(var D=0,R=S;R<A;R++)D+=u[_*h+N*d+R*f]*l[R*m+T*g+_*y];w[_*v+(N*a+T)]+=D}return b.toTensor()},t.prototype.fusedBatchMatMul=function(t){var e=t.bias,n=t.activation,r=t.preluActivationWeights,i=this.batchMatMul(t.a,t.b,t.transposeA,t.transposeB);return e&&(i=this.add(i,e)),n&&(i=Lc(this,i,n,r)),i},t.prototype.multiply=function(t,e){return"complex64"===t.dtype||"complex64"===e.dtype?this.broadcastedBinaryComplexOp(t.cast("complex64"),e.cast("complex64"),(function(t,e,n,r){return{real:t*n-e*r,imag:t*r+e*n}})):this.broadcastedBinaryOp(t,e,gt(t.dtype,e.dtype),(function(t,e){return t*e}))},t.prototype.realDivide=function(t,e){return this.assertNotComplex([t,e],"realDivide"),this.broadcastedBinaryOp(t,e,"float32",(function(t,e){return t/e}))},t.prototype.floorDiv=function(t,e){return this.assertNotComplex([t,e],"floorDiv"),this.broadcastedBinaryOp(t,e,"int32",(function(t,e){return Math.floor(t/e)}))},t.prototype.sum=function(t,e){this.assertNotComplex(t,"sum"),sn("sum",e,t.rank);for(var n=on(t.shape,e),r=n[1],i=On(n[0],gt(t.dtype,"int32")),o=v(r),a=this.readSync(i.dataId),s=this.readSync(t.dataId),u=0;u<a.length;++u){for(var l=u*o,c=0,h=0;h<o;++h)c+=s[l+h];a[u]=c}return i},t.prototype.prod=function(t,e){this.assertNotComplex(t,"sum");for(var n=on(t.shape,e),r=n[1],i=On(n[0],gt(t.dtype,"int32")),o=v(r),a=this.readSync(i.dataId),s=this.readSync(t.dataId),u=0;u<a.length;++u){for(var l=u*o,c=1,h=0;h<o;++h)c*=s[l+h];a[u]=c}return i},t.prototype.unsortedSegmentSum=function(t,e,n){this.assertNotComplex(t,"unsortedSegmentSum");for(var r=[],i=t.rank-e.rank,o=0;o<i;++o)e=e.expandDims(o+1);for(o=0;o<n;++o){var a=bn(o,"int32"),s=Ou(a,e).asType("float32").mul(t).sum(0);r.push(s)}return wr(r)},t.prototype.argMin=function(t,e){this.assertNotComplex(t,"argMin");var n=[e];sn("argMin",n,t.rank);for(var r=on(t.shape,n),i=r[1],o=On(r[0],"int32"),a=v(i),s=this.readSync(o.dataId),u=this.readSync(t.dataId),l=0;l<s.length;++l){for(var c=l*a,h=u[c],d=0,f=0;f<a;++f){var p=u[c+f];p<h&&(h=p,d=f)}s[l]=d}return o},t.prototype.argMax=function(t,e){this.assertNotComplex(t,"argMax");var n=[e];sn("argMax",n,t.rank);for(var r=on(t.shape,n),i=r[1],o=On(r[0],"int32"),a=v(i),s=this.readSync(o.dataId),u=this.readSync(t.dataId),l=0;l<s.length;++l){for(var c=l*a,h=u[c],d=0,f=0;f<a;++f){var p=u[c+f];p>h&&(h=p,d=f)}s[l]=d}return o},t.prototype.cumsum=function(t,e,n,r){if(this.assertNotComplex(t,"cumsum"),e!==t.rank-1)throw new Error("backend.cumsum in CPU expects an inner-most axis="+(t.rank-1)+" but got axis="+e);for(var i=gt(t.dtype,"int32"),o=On(t.shape,i),a=this.readSync(o.dataId),s=this.readSync(t.dataId),u=t.shape[t.rank-1],l=r?function(t,e){return t+u-e-1}:function(t,e){return t+e},c=0;c<s.length;c+=u)for(var h=0;h<u;h++){var d=l(c,h);if(0===h)a[d]=n?0:s[d];else{var f=l(c,h-1);a[d]=n?s[f]+a[f]:s[d]+a[f]}}return o},t.prototype.equal=function(t,e){return this.assertNotComplex([t,e],"equal"),this.broadcastedBinaryOp(t,e,"bool",(function(t,e){return t===e?1:0}))},t.prototype.notEqual=function(t,e){return this.assertNotComplex([t,e],"notEqual"),this.broadcastedBinaryOp(t,e,"bool",(function(t,e){return t!==e?1:0}))},t.prototype.less=function(t,e){return this.assertNotComplex([t,e],"less"),this.broadcastedBinaryOp(t,e,"bool",(function(t,e){return t<e?1:0}))},t.prototype.lessEqual=function(t,e){return this.assertNotComplex([t,e],"lessEqual"),this.broadcastedBinaryOp(t,e,"bool",(function(t,e){return t<=e?1:0}))},t.prototype.greater=function(t,e){return this.assertNotComplex([t,e],"greater"),this.broadcastedBinaryOp(t,e,"bool",(function(t,e){return t>e?1:0}))},t.prototype.greaterEqual=function(t,e){return this.assertNotComplex([t,e],"greaterEqual"),this.broadcastedBinaryOp(t,e,"bool",(function(t,e){return t>=e?1:0}))},t.prototype.logicalNot=function(t){this.assertNotComplex(t,"logicalNot");for(var e=this.readSync(t.dataId),n=new Uint8Array(e.length),r=0;r<e.length;++r)n[r]=e[r]?0:1;return st.make(t.shape,{values:n},"bool")},t.prototype.logicalAnd=function(t,e){return this.assertNotComplex([t,e],"logicalAnd"),this.broadcastedBinaryOp(t,e,"bool",(function(t,e){return t&&e}))},t.prototype.logicalOr=function(t,e){return this.assertNotComplex([t,e],"logicalOr"),this.broadcastedBinaryOp(t,e,"bool",(function(t,e){return t||e}))},t.prototype.select=function(t,e,n){this.assertNotComplex([t,e,n],"select");for(var r=this.readSync(t.dataId),i=this.readSync(e.dataId),o=this.readSync(n.dataId),a=On(e.shape,gt(e.dtype,n.dtype)),s=this.readSync(a.dataId),u=0,l=0===t.rank||t.rank>1||1===e.rank?1:v(e.shape.slice(1)),c=0;c<r.length;c++)for(var h=0;h<l;h++)s[u++]=1===r[c]?i[c]:o[c];return a},t.prototype.where=function(t){this.assertNotComplex([t],"where");var e=this.readSync(t.dataId);return ki(t.shape,e)},t.prototype.topk=function(t,e,n){return this.assertNotComplex(t,"topk"),Ci(this.readSync(t.dataId),t.shape,t.dtype,e)},t.prototype.min=function(t,e){this.assertNotComplex(t,"min"),sn("min",e,t.rank);for(var n=on(t.shape,e),r=n[1],i=On(n[0],t.dtype),o=v(r),a=this.readSync(i.dataId),s=this.readSync(t.dataId),u=0;u<a.length;++u){for(var l=u*o,c=s[l],h=0;h<o;++h){var d=s[l+h];d<c&&(c=d)}a[u]=c}return i},t.prototype.minimum=function(t,e){return this.assertNotComplex([t,e],"minimum"),this.broadcastedBinaryOp(t,e,t.dtype,(function(t,e){return Math.min(t,e)}))},t.prototype.mod=function(t,e){return this.assertNotComplex([t,e],"mod"),this.broadcastedBinaryOp(t,e,t.dtype,(function(t,e){var n=t%e;return t<0&&e<0||t>=0&&e>=0?n:(n+e)%e}))},t.prototype.max=function(t,e){this.assertNotComplex(t,"max"),sn("max",e,t.rank);for(var n=on(t.shape,e),r=n[1],i=On(n[0],t.dtype),o=v(r),a=this.readSync(i.dataId),s=this.readSync(t.dataId),u=0;u<a.length;++u){for(var l=u*o,c=s[l],h=0;h<o;++h){var d=s[l+h];d>c&&(c=d)}a[u]=c}return i},t.prototype.maximum=function(t,e){return this.assertNotComplex([t,e],"maximum"),this.broadcastedBinaryOp(t,e,t.dtype,(function(t,e){return Math.max(t,e)}))},t.prototype.all=function(t,e){this.assertNotComplex(t,"all"),sn("all",e,t.rank);for(var n=on(t.shape,e),r=n[1],i=On(n[0],t.dtype),o=v(r),a=this.readSync(i.dataId),s=this.readSync(t.dataId),u=0;u<a.length;++u){for(var l=u*o,c=s[l],h=0;h<o;++h)c=c&&s[l+h];a[u]=c}return i},t.prototype.any=function(t,e){this.assertNotComplex(t,"any"),sn("any",e,t.rank);for(var n=on(t.shape,e),r=n[1],i=On(n[0],t.dtype),o=v(r),a=this.readSync(i.dataId),s=this.readSync(t.dataId),u=0;u<a.length;++u){for(var l=u*o,c=s[l],h=0;h<o;++h)c=c||s[l+h];a[u]=c}return i},t.prototype.squaredDifference=function(t,e){return this.assertNotComplex([t,e],"squaredDifference"),this.broadcastedBinaryOp(t,e,t.dtype,(function(t,e){var n=t-e;return n*n}))},t.prototype.ceil=function(t){this.assertNotComplex(t,"ceil");for(var e=this.readSync(t.dataId),n=new Float32Array(e.length),r=0;r<e.length;++r)n[r]=Math.ceil(e[r]);return st.make(t.shape,{values:n})},t.prototype.floor=function(t){this.assertNotComplex(t,"floor");for(var e=this.readSync(t.dataId),n=new Float32Array(e.length),r=0;r<e.length;++r)n[r]=Math.floor(e[r]);return st.make(t.shape,{values:n})},t.prototype.sign=function(t){this.assertNotComplex(t,"x");for(var e=this.readSync(t.dataId),n=new Float32Array(e.length),r=0;r<e.length;++r)n[r]=e[r]<0?-1:e[r]>0?1:0;return st.make(t.shape,{values:n})},t.prototype.isNaN=function(t){this.assertNotComplex(t,"x");for(var e=this.readSync(t.dataId),n=new Uint8Array(e.length),r=0;r<e.length;++r)Number.isNaN(e[r])&&(n[r]=1);return st.make(t.shape,{values:n},"bool")},t.prototype.isInf=function(t){this.assertNotComplex(t,"x");for(var e=this.readSync(t.dataId),n=new Uint8Array(e.length),r=0;r<e.length;++r)Math.abs(e[r])===1/0&&(n[r]=1);return st.make(t.shape,{values:n},"bool")},t.prototype.isFinite=function(t){this.assertNotComplex(t,"x");for(var e=this.readSync(t.dataId),n=new Uint8Array(e.length),r=0;r<e.length;++r)Number.isFinite(e[r])&&(n[r]=1);return st.make(t.shape,{values:n},"bool")},t.prototype.round=function(t){this.assertNotComplex(t,"round");for(var e=this.readSync(t.dataId),n=new Float32Array(e.length),r=0;r<e.length;++r){var i=Math.floor(e[r]);n[r]=e[r]-i<.5?Math.floor(e[r]):e[r]-i>.5?Math.ceil(e[r]):i%2==0?i:i+1}return st.make(t.shape,{values:n})},t.prototype.exp=function(t){this.assertNotComplex(t,"exp");for(var e=this.readSync(t.dataId),n=new Float32Array(e.length),r=0;r<e.length;++r)n[r]=Math.exp(e[r]);return st.make(t.shape,{values:n})},t.prototype.expm1=function(t){this.assertNotComplex(t,"expm1");for(var e=this.readSync(t.dataId),n=new Float32Array(e.length),r=0;r<e.length;++r)n[r]=Math.expm1(e[r]);return st.make(t.shape,{values:n})},t.prototype.log=function(t){this.assertNotComplex(t,"log");for(var e=this.readSync(t.dataId),n=new Float32Array(e.length),r=0;r<e.length;++r)n[r]=Math.log(e[r]);return st.make(t.shape,{values:n})},t.prototype.log1p=function(t){this.assertNotComplex(t,"log1p");for(var e=this.readSync(t.dataId),n=new Float32Array(e.length),r=0;r<e.length;++r)n[r]=Math.log1p(e[r]);return st.make(t.shape,{values:n})},t.prototype.sqrt=function(t){this.assertNotComplex(t,"sqrt");for(var e=this.readSync(t.dataId),n=new Float32Array(e.length),r=0;r<e.length;++r)n[r]=Math.sqrt(e[r]);return st.make(t.shape,{values:n})},t.prototype.rsqrt=function(t){this.assertNotComplex(t,"rsqrt");for(var e=this.readSync(t.dataId),n=new Float32Array(e.length),r=0;r<e.length;++r)n[r]=1/Math.sqrt(e[r]);return st.make(t.shape,{values:n})},t.prototype.square=function(t){this.assertNotComplex(t,"square");for(var e=this.readSync(t.dataId),n=new Float32Array(e.length),r=0;r<e.length;++r){var i=e[r];n[r]=i*i}return st.make(t.shape,{values:n})},t.prototype.reciprocal=function(t){this.assertNotComplex(t,"reciprocal");for(var e=this.readSync(t.dataId),n=new Float32Array(e.length),r=0;r<e.length;++r)n[r]=1/e[r];return st.make(t.shape,{values:n})},t.prototype.linear=function(t){return t},t.prototype.relu=function(t){this.assertNotComplex(t,"relu");for(var e=On(t.shape,t.dtype),n=this.readSync(e.dataId),r=this.readSync(t.dataId),i=0;i<r.length;++i)n[i]=Math.max(0,r[i]);return e},t.prototype.relu6=function(t){this.assertNotComplex(t,"relu");for(var e=On(t.shape,t.dtype),n=this.readSync(e.dataId),r=this.readSync(t.dataId),i=0;i<r.length;++i)n[i]=Math.min(Math.max(0,r[i]),6);return e},t.prototype.prelu=function(t,e){return this.assertNotComplex([t,e],"prelu"),this.broadcastedBinaryOp(t,e,t.dtype,(function(t,e){return t<0?e*t:t}))},t.prototype.elu=function(t){this.assertNotComplex(t,"elu");for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r){var i=n[r];e[r]=i>=0?i:Math.exp(i)-1}return st.make(t.shape,{values:e})},t.prototype.eluDer=function(t,e){this.assertNotComplex([t,e],"eluDer");for(var n=new Float32Array(e.size),r=this.readSync(e.dataId),i=this.readSync(t.dataId),o=0;o<r.length;++o){var a=r[o];n[o]=a>=1?i[o]:i[o]*(a+1)}return st.make(e.shape,{values:n})},t.prototype.selu=function(t){this.assertNotComplex(t,"selu");for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r){var i=n[r];e[r]=i>=0?1.0507009873554805*i:1.7580993408473768*(Math.exp(i)-1)}return st.make(t.shape,{values:e})},t.prototype.clip=function(t,e,n){this.assertNotComplex(t,"clip");for(var r=new Float32Array(t.size),i=this.readSync(t.dataId),o=0;o<i.length;++o){var a=i[o];r[o]=a>n?n:a<e?e:a}return st.make(t.shape,{values:r})},t.prototype.abs=function(t){for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r)e[r]=Math.abs(n[r]);return st.make(t.shape,{values:e})},t.prototype.complexAbs=function(t){for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<t.size;++r)e[r]=Math.hypot(n[2*r],n[2*r+1]);return st.make(t.shape,{values:e})},t.prototype.int=function(t){this.assertNotComplex(t,"int");for(var e=new Int32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r)e[r]=n[r];return st.make(t.shape,{values:e},"int32")},t.prototype.sigmoid=function(t){this.assertNotComplex(t,"sigmoid");for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r)e[r]=1/(1+Math.exp(-n[r]));return st.make(t.shape,{values:e})},t.prototype.softplus=function(t){this.assertNotComplex(t,"softplus");for(var e=Math.log(1.1920928955078125e-7)+2,n=new Float32Array(t.size),r=this.readSync(t.dataId),i=0;i<r.length;++i){var o,a=r[i]>-e,s=r[i]<e,u=Math.exp(r[i]);o=s?u:a?r[i]:Math.log(1+u),n[i]=o}return st.make(t.shape,{values:n})},t.prototype.sin=function(t){this.assertNotComplex(t,"sin");for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r)e[r]=Math.sin(n[r]);return st.make(t.shape,{values:e})},t.prototype.cos=function(t){this.assertNotComplex(t,"cos");for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r)e[r]=Math.cos(n[r]);return st.make(t.shape,{values:e})},t.prototype.tan=function(t){this.assertNotComplex(t,"tan");for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r)e[r]=Math.tan(n[r]);return st.make(t.shape,{values:e})},t.prototype.asin=function(t){this.assertNotComplex(t,"asin");for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r)e[r]=Math.asin(n[r]);return st.make(t.shape,{values:e})},t.prototype.acos=function(t){this.assertNotComplex(t,"acos");for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r)e[r]=Math.acos(n[r]);return st.make(t.shape,{values:e})},t.prototype.atan=function(t){this.assertNotComplex(t,"atan");for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r)e[r]=Math.atan(n[r]);return st.make(t.shape,{values:e})},t.prototype.atan2=function(t,e){return this.assertNotComplex([t,e],"atan2"),this.broadcastedBinaryOp(t,e,t.dtype,(function(t,e){return Math.atan2(t,e)}))},t.prototype.sinh=function(t){this.assertNotComplex(t,"sinh");for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r)e[r]=Math.sinh(n[r]);return st.make(t.shape,{values:e})},t.prototype.cosh=function(t){this.assertNotComplex(t,"cosh");for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r)e[r]=Math.cosh(n[r]);return st.make(t.shape,{values:e})},t.prototype.tanh=function(t){this.assertNotComplex(t,"tanh");for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r)e[r]=x(n[r]);return st.make(t.shape,{values:e})},t.prototype.asinh=function(t){this.assertNotComplex(t,"asinh");for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r)e[r]=Math.asinh(n[r]);return st.make(t.shape,{values:e})},t.prototype.acosh=function(t){this.assertNotComplex(t,"acosh");for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r)e[r]=Math.acosh(n[r]);return st.make(t.shape,{values:e})},t.prototype.atanh=function(t){this.assertNotComplex(t,"atanh");for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r)e[r]=Math.atanh(n[r]);return st.make(t.shape,{values:e})},t.prototype.erf=function(t){this.assertNotComplex(t,"erf");for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r){var i=Math.sign(n[r]),o=Math.abs(n[r]),a=1/(1+.3275911*o);e[r]=i*(1-((((1.061405429*a-1.453152027)*a+1.421413741)*a-.284496736)*a+.254829592)*a*Math.exp(-o*o))}return st.make(t.shape,{values:e})},t.prototype.step=function(t,e){void 0===e&&(e=0),this.assertNotComplex(t,"step");for(var n=new Float32Array(t.size),r=this.readSync(t.dataId),i=0;i<r.length;++i){var o=r[i];n[i]=isNaN(o)?NaN:o>0?1:e}return st.make(t.shape,{values:n})},t.prototype.fusedConv2d=function(t){var e=t.bias,n=t.activation,r=t.preluActivationWeights,i=this.conv2d(t.input,t.filter,t.convInfo);return e&&(i=this.add(i,e)),n&&(i=Lc(this,i,n,r)),i},t.prototype.conv2d=function(t,e,n){this.assertNotComplex([t,e],"conv2d");for(var r=n.filterHeight,i=n.filterWidth,o=n.dilationHeight,a=n.dilationWidth,s=n.padInfo.left,u=n.padInfo.top,l="channelsLast"===n.dataFormat,c=Zn(n.outShape,t.dtype),h=t.strides[0],d=l?t.strides[1]:t.strides[2],f=l?t.strides[2]:1,p=l?1:t.strides[1],m=c.strides[0],g=l?c.strides[1]:c.strides[2],y=l?c.strides[2]:1,v=l?1:c.strides[1],b=this.readSync(t.dataId),w=this.readSync(e.dataId),x=c.values,_=0;_<n.batchSize;++_)for(var C=_*h,k=_*m,S=0;S<n.outHeight;++S)for(var E=k+S*g,O=S*n.strideHeight-u,A=0;A<r;A++){var N=O+A*o;if(!(N<0||N>=n.inHeight))for(var T=A*e.strides[0],D=C+N*d,R=0;R<n.outWidth;++R)for(var I=E+R*y,M=R*n.strideWidth-s,F=0;F<i;F++){var P=M+F*a;if(!(P<0||P>=n.inWidth))for(var j=D+P*f,z=T+F*e.strides[1],L=0;L<n.inChannels;++L){for(var B=b[j+L*p],U=0;U<n.outChannels;++U)x[I+U*v]+=B*w[z+U];z+=n.outChannels}}}return c.toTensor()},t.prototype.conv3d=function(t,e,n){for(var r=n.filterDepth,i=n.filterHeight,o=n.filterWidth,a=n.dilationDepth,s=n.dilationHeight,u=n.dilationWidth,l=n.padInfo.front,c=n.padInfo.left,h=n.padInfo.top,d=Zn(n.outShape,t.dtype),f=this.readSync(t.dataId),p=this.readSync(e.dataId),m=d.values,g=0;g<n.batchSize;++g)for(var y=g*t.strides[0],v=g*d.strides[0],b=0;b<n.outDepth;++b)for(var w=v+b*d.strides[1],x=b*n.strideDepth-l,_=0;_<r;_++){var C=x+_*a;if(!(C<0||C>=n.inDepth))for(var k=_*e.strides[0],S=y+C*t.strides[1],E=0;E<n.outHeight;++E)for(var O=w+E*d.strides[2],A=E*n.strideHeight-h,N=0;N<i;N++){var T=A+N*s;if(!(T<0||T>=n.inHeight))for(var D=k+N*e.strides[1],R=S+T*t.strides[2],I=0;I<n.outWidth;++I)for(var M=O+I*n.outChannels,F=I*n.strideWidth-c,P=0;P<o;P++){var j=F+P*u;if(!(j<0||j>=n.inWidth))for(var z=R+j*n.inChannels,L=D+P*e.strides[2],B=0;B<n.inChannels;++B){for(var U=f[z+B],$=0;$<n.outChannels;++$)m[M+$]+=U*p[L+$];L+=n.outChannels}}}}return d.toTensor()},t.prototype.conv2dDerInput=function(t,e,n){this.assertNotComplex([t,e],"conv2dDerInput");for(var r=Zn(n.inShape,"float32"),i=r.values,o=this.readSync(t.dataId),a=this.readSync(e.dataId),s=e.strides,u=s[0],l=s[1],c=s[2],h=n.batchSize,d=n.filterHeight,f=n.filterWidth,p=n.inChannels,m=n.inHeight,g=n.inWidth,y=n.outChannels,v=n.outHeight,b=n.outWidth,w=n.strideHeight,x=n.strideWidth,_=d-1-n.padInfo.top,C=f-1-n.padInfo.left,k="channelsLast"===n.dataFormat,S=r.strides[0],E=k?r.strides[1]:r.strides[2],O=k?r.strides[2]:1,A=k?1:r.strides[1],N=t.strides[0],T=k?t.strides[1]:t.strides[2],D=k?t.strides[2]:1,R=k?1:t.strides[1],I=0;I<h;++I)for(var M=0;M<p;++M)for(var F=0;F<m;++F)for(var P=F-_,j=Math.max(0,Math.ceil(P/w)),z=Math.min(v,(d+P)/w),L=0;L<g;++L){for(var B=L-C,U=Math.max(0,Math.ceil(B/x)),$=Math.min(b,(f+B)/x),V=0,W=j;W<z;++W)for(var q=W*w-P,H=U;H<$;++H)for(var G=N*I+T*W+D*H,X=u*(d-1-q)+l*(f-1-(H*x-B))+c*M,K=0;K<y;++K)V+=o[G+R*K]*a[X+K];i[S*I+E*F+O*L+A*M]=V}return r.toTensor()},t.prototype.conv3dDerInput=function(t,e,n){for(var r=Zn(n.inShape,"float32"),i=r.values,o=r.strides,a=o[0],s=o[1],u=o[2],l=o[3],c=this.readSync(t.dataId),h=t.strides,d=h[0],f=h[1],p=h[2],m=h[3],g=this.readSync(e.dataId),y=e.strides,v=y[0],b=y[1],w=y[2],x=y[3],_=n.batchSize,C=n.filterDepth,k=n.filterHeight,S=n.filterWidth,E=n.inChannels,O=n.inDepth,A=n.inHeight,N=n.inWidth,T=n.outChannels,D=n.outDepth,R=n.outHeight,I=n.outWidth,M=n.strideDepth,F=n.strideHeight,P=n.strideWidth,j=C-1-n.padInfo.front,z=k-1-n.padInfo.top,L=S-1-n.padInfo.left,B=0;B<_;++B)for(var U=0;U<E;++U)for(var $=0;$<O;++$)for(var V=$-j,W=Math.max(0,Math.ceil(V/M)),q=Math.min(D,(C+V)/M),H=0;H<A;++H)for(var G=H-z,X=Math.max(0,Math.ceil(G/F)),K=Math.min(R,(k+G)/F),Y=0;Y<N;++Y){for(var Z=Y-L,Q=Math.max(0,Math.ceil(Z/P)),J=Math.min(I,(S+Z)/P),tt=0,et=W;et<q;++et)for(var nt=et*M-V,rt=X;rt<K;++rt)for(var it=rt*F-G,ot=Q;ot<J;++ot)for(var at=d*B+f*et+p*rt+m*ot,st=v*(C-1-nt)+b*(k-1-it)+w*(S-1-(ot*P-Z))+x*U,ut=0;ut<T;++ut)tt+=c[at+ut]*g[st+ut];i[a*B+s*$+u*H+l*Y+U]=tt}return r.toTensor()},t.prototype.conv2dDerFilter=function(t,e,n){this.assertNotComplex([t,e],"conv2dDerFilter");for(var r=n.strideHeight,i=n.strideWidth,o=n.filterHeight,a=n.filterWidth,s="channelsLast"===n.dataFormat,u=Zn(n.filterShape,"float32"),l=n.padInfo.left,c=n.padInfo.top,h=this.bufferSync(t),d=this.bufferSync(e),f=0;f<o;++f)for(var p=Math.max(0,Math.ceil((c-f)/r)),m=Math.min(n.outHeight,(n.inHeight+c-f)/r),g=0;g<a;++g)for(var y=Math.max(0,Math.ceil((l-g)/i)),v=Math.min(n.outWidth,(n.inWidth+l-g)/i),b=0;b<n.inChannels;++b)for(var w=0;w<n.outChannels;++w){for(var x=0,_=0;_<n.batchSize;++_)for(var C=p;C<m;++C)for(var k=f+C*r-c,S=y;S<v;++S){var E=g+S*i-l;x+=s?h.get(_,k,E,b)*d.get(_,C,S,w):h.get(_,b,k,E)*d.get(_,w,C,S)}u.set(x,f,g,b,w)}return u.toTensor()},t.prototype.conv3dDerFilter=function(t,e,n){for(var r=n.strideDepth,i=n.strideHeight,o=n.strideWidth,a=n.filterDepth,s=n.filterHeight,u=n.filterWidth,l=Zn(n.filterShape,"float32"),c=l.values,h=l.strides,d=h[0],f=h[1],p=h[2],m=h[3],g=this.readSync(e.dataId),y=e.strides,v=y[0],b=y[1],w=y[2],x=y[3],_=this.readSync(t.dataId),C=t.strides,k=C[0],S=C[1],E=C[2],O=C[3],A=n.padInfo.front,N=n.padInfo.left,T=n.padInfo.top,D=0;D<a;++D)for(var R=Math.max(0,Math.ceil((A-D)/r)),I=Math.min(n.outDepth,(n.inDepth+A-D)/r),M=D*d,F=0;F<s;++F)for(var P=Math.max(0,Math.ceil((T-F)/i)),j=Math.min(n.outHeight,(n.inHeight+T-F)/i),z=F*f+M,L=0;L<u;++L)for(var B=Math.max(0,Math.ceil((N-L)/o)),U=Math.min(n.outWidth,(n.inWidth+N-L)/o),$=L*p+z,V=0;V<n.inChannels;++V)for(var W=V*m+$,q=0;q<n.outChannels;++q){for(var H=0,G=0;G<n.batchSize;++G)for(var X=G*k,K=G*v,Y=R;Y<I;++Y)for(var Z=(D+Y*r-A)*S+X,Q=Y*b+K,J=P;J<j;++J)for(var tt=(F+J*i-T)*E+Z,et=J*w+Q,nt=B;nt<U;++nt)H+=_[(L+nt*o-N)*O+tt+V]*g[nt*x+et+q];c[W+q]=H}return l.toTensor()},t.prototype.fusedDepthwiseConv2D=function(t){var e=t.bias,n=t.activation,r=t.preluActivationWeights,i=this.depthwiseConv2D(t.input,t.filter,t.convInfo);return e&&(i=this.add(i,e)),n&&(i=Lc(this,i,n,r)),i},t.prototype.depthwiseConv2D=function(t,e,n){this.assertNotComplex([t,e],"depthwiseConv2D");for(var r=n.filterHeight,i=n.filterWidth,o=n.dilationHeight,a=n.dilationWidth,s=n.padInfo.left,u=n.padInfo.top,l=n.outChannels/n.inChannels,c=Zn(n.outShape,t.dtype),h=this.readSync(t.dataId),d=this.readSync(e.dataId),f=c.values,p=0;p<n.batchSize;++p)for(var m=p*t.strides[0],g=p*c.strides[0],y=0;y<n.outHeight;++y)for(var v=g+y*c.strides[1],b=y*n.strideHeight-s,w=0;w<r;++w){var x=b+w*o;if(!(x<0||x>=n.inHeight))for(var _=w*e.strides[0],C=m+x*t.strides[1],k=0;k<n.outWidth;++k)for(var S=v+k*c.strides[2],E=k*n.strideWidth-u,O=0;O<i;++O){var A=E+O*a;if(!(A<0||A>=n.inWidth))for(var N=C+A*n.inChannels,T=S,D=_+O*e.strides[1],R=0;R<n.inChannels;++R){for(var I=h[N+R],M=0;M<l;++M)f[T+M]+=I*d[D+M];T+=l,D+=l}}}return c.toTensor()},t.prototype.depthwiseConv2DDerInput=function(t,e,n){this.assertNotComplex([t,e],"depthwiseConv2DDerInput");for(var r=Zn(n.inShape,"float32"),i=r.values,o=r.strides,a=o[0],s=o[1],u=o[2],l=this.readSync(t.dataId),c=t.strides,h=c[0],d=c[1],f=c[2],p=this.readSync(e.dataId),m=e.strides,g=m[0],y=m[1],v=m[2],b=n.batchSize,w=n.filterHeight,x=n.filterWidth,_=n.inChannels,C=n.inHeight,k=n.inWidth,S=n.outHeight,E=n.outWidth,O=n.strideHeight,A=n.strideWidth,N=w-1-n.padInfo.top,T=x-1-n.padInfo.left,D=n.outChannels/_,R=0;R<b;++R)for(var I=0;I<_;++I)for(var M=0;M<C;++M)for(var F=M-N,P=Math.max(0,Math.ceil(F/O)),j=Math.min(S,(w+F)/O),z=0;z<k;++z){for(var L=z-T,B=Math.max(0,Math.ceil(L/A)),U=Math.min(E,(x+L)/A),$=0,V=P;V<j;++V)for(var W=V*O-F,q=B;q<U;++q)for(var H=h*R+d*V+f*q,G=g*(w-1-W)+y*(x-1-(q*A-L))+v*I,X=0;X<D;++X)$+=l[H+(I*D+X)]*p[G+X];i[a*R+s*M+u*z+I]=$}return r.toTensor()},t.prototype.depthwiseConv2DDerFilter=function(t,e,n){this.assertNotComplex([t,e],"depthwiseConv2DDerFilter");for(var r=n.strideHeight,i=n.strideWidth,o=n.filterHeight,a=n.filterWidth,s=Zn(n.filterShape,"float32"),u=n.padInfo.left,l=n.padInfo.top,c=n.outChannels/n.inChannels,h=this.bufferSync(t),d=this.bufferSync(e),f=0;f<o;++f)for(var p=Math.max(0,Math.ceil((l-f)/r)),m=Math.min(n.outHeight,(n.inHeight+l-f)/r),g=0;g<a;++g)for(var y=Math.max(0,Math.ceil((u-g)/i)),v=Math.min(n.outWidth,(n.inWidth+u-g)/i),b=0;b<n.outChannels;++b){for(var w=Math.trunc(b/c),x=b%c,_=0,C=0;C<n.batchSize;++C)for(var k=p;k<m;++k)for(var S=f+k*r-l,E=y;E<v;++E)_+=h.get(C,S,g+E*i-u,w)*d.get(C,k,E,b);s.set(_,f,g,w,x)}return s.toTensor()},t.prototype.tile=function(t,e){return this.assertNotComplex(t,"tile"),_i(this.bufferSync(t),e)},t.prototype.pad=function(t,e,n){this.assertNotComplex(t,"pad");var r=e.map((function(e,n){return e[0]+t.shape[n]+e[1]})),i=e.map((function(t){return t[0]})),o=this.bufferSync(t),a=Zn(r,t.dtype);0!==n&&a.values.fill(n);for(var s=0;s<t.size;s++){var u=o.indexToLoc(s),l=u.map((function(t,e){return t+i[e]}));a.set.apply(a,[o.get.apply(o,u)].concat(l))}return a.toTensor()},t.prototype.transpose=function(t,e){this.assertNotComplex(t,"transpose");for(var n=new Array(t.rank),r=0;r<n.length;r++)n[r]=t.shape[e[r]];var i=this.readSync(t.dataId),o=Zn(n,t.dtype),a=this.bufferSync(t);for(r=0;r<t.size;++r){for(var s=a.indexToLoc(r),u=new Array(s.length),l=0;l<u.length;l++)u[l]=s[e[l]];var c=o.locToIndex(u);o.values[c]=i[r]}return o.toTensor()},t.prototype.gather=function(t,e,n){this.assertNotComplex([t,e],"gather");var r=t.shape.slice(),i=this.readSync(e.dataId);r[n]=i.length;for(var o=Zn(r,t.dtype),a=this.bufferSync(t),s=0;s<o.size;++s){var u=o.indexToLoc(s),l=u.slice();l[n]=i[u[n]];var c=a.locToIndex(l);o.values[s]=a.values[c]}return o.toTensor()},t.prototype.batchToSpaceND=function(t,e,n){this.assertNotComplex([t],"batchToSpaceND");var r=e.reduce((function(t,e){return t*e})),i=Sr(t.shape,e,r),o=Er(i.length,e.length),a=Or(t.shape,e,r),s=Ar(n,e.length),u=Nr(a,n,e.length);return t.reshape(i).transpose(o).reshape(a).slice(s,u)},t.prototype.spaceToBatchND=function(t,e,n){this.assertNotComplex([t],"spaceToBatchND");var r=e.reduce((function(t,e){return t*e})),i=[[0,0]];i.push.apply(i,n);for(var o=1+e.length;o<t.shape.length;++o)i.push([0,0]);var a=t.pad(i),s=Sr(a.shape,e,r,!1),u=Er(s.length,e.length,!1),l=Or(a.shape,e,r,!1);return a.reshape(s).transpose(u).reshape(l)},t.prototype.pool=function(t,e,n){this.assertNotComplex(t,"pool");for(var r=e.strideHeight,i=e.strideWidth,o=e.dilationHeight,a=e.dilationWidth,s=e.effectiveFilterHeight,u=e.effectiveFilterWidth,l=e.padInfo.top,c=e.padInfo.left,h="max"===n?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,d=this.readSync(t.dataId),f=Zn(e.outShape,t.dtype),p=f.values,m=e.outShape[1]*e.outShape[2]*e.outShape[3],g=e.outShape[2]*e.outShape[3],y=e.outShape[3],v=0;v<e.batchSize;++v)for(var b=v*m,w=v*t.strides[0],x=0;x<e.inChannels;++x)for(var _=0;_<e.outHeight;++_)for(var C=_*r-l,k=Math.max(0,C),S=Math.min(e.inHeight,s+C),E=b+_*g,O=0;O<e.outWidth;++O){for(var A=O*i-c,N=Math.max(0,A),T=Math.min(e.inWidth,u+A),D=h,R=0,I=0,M=k;M<S;M+=o){for(var F=w+M*t.strides[1],P=N;P<T;P+=a){var j=d[F+P*t.strides[2]+x];"max"===n&&j>D?D=j:"avg"===n&&(R+=j,I++)}if(isNaN(D))break}p[E+O*y+x]="avg"===n?R/I:D}return f.toTensor()},t.prototype.maxPool=function(t,e){return this.pool(t,e,"max")},t.prototype.maxPoolPositions=function(t,e){for(var n=Zn(e.outShape,"int32"),r=e.strideHeight,i=e.strideWidth,o=e.dilationHeight,a=e.dilationWidth,s=e.effectiveFilterHeight,u=e.effectiveFilterWidth,l=e.padInfo.top,c=e.padInfo.left,h=this.bufferSync(t),d=0;d<e.batchSize;++d)for(var f=0;f<e.inChannels;++f)for(var p=0;p<e.outHeight;++p){for(var m=p*r-l,g=m;g<0;)g+=o;for(var y=Math.min(e.inHeight,s+m),v=0;v<e.outWidth;++v){for(var b=v*i-c,w=b;w<0;)w+=a;for(var x=Math.min(e.inWidth,u+b),_=Number.NEGATIVE_INFINITY,C=-1,k=g;k<y;k+=o)for(var S=k-m,E=w;E<x;E+=a){var O=E-b,A=h.get(d,k,E,f);A>_&&(_=A,C=S*u+O)}n.set(C,d,p,v,f)}}return n.toTensor()},t.prototype.maxPoolBackprop=function(t,e,n,r){this.assertNotComplex([e,n],"maxPoolBackprop");for(var i=this.maxPoolPositions(e,r),o=r.strideHeight,a=r.strideWidth,s=r.dilationHeight,u=r.dilationWidth,l=r.effectiveFilterHeight,c=r.effectiveFilterWidth,h=c-1-r.padInfo.left,d=l-1-r.padInfo.top,f=Zn(e.shape,"float32"),p=this.bufferSync(i),m=this.bufferSync(t),g=0;g<r.batchSize;++g)for(var y=0;y<r.inChannels;++y)for(var v=0;v<r.inHeight;++v)for(var b=0;b<r.inWidth;++b){for(var w=v-d,x=b-h,_=0,C=0;C<l;C+=s){var k=(w+C)/o;if(!(k<0||k>=r.outHeight||Math.floor(k)!==k))for(var S=0;S<c;S+=u){var E=(x+S)/a;if(!(E<0||E>=r.outWidth||Math.floor(E)!==E)){var O=l*c-1-p.get(g,k,E,y)===C*c+S?1:0;0!==O&&(_+=m.get(g,k,E,y)*O)}}}f.set(_,g,v,b,y)}return f.toTensor()},t.prototype.avgPoolBackprop=function(t,e,n){this.assertNotComplex([t,e],"avgPoolBackprop");for(var r=n.strideHeight,i=n.strideWidth,o=n.filterHeight,a=n.filterWidth,s=n.dilationHeight,u=n.dilationWidth,l=n.effectiveFilterHeight,c=n.effectiveFilterWidth,h=c-1-n.padInfo.left,d=l-1-n.padInfo.top,f=Zn(e.shape,"float32"),p=1/(o*a),m=this.bufferSync(t),g=0;g<n.batchSize;++g)for(var y=0;y<n.inChannels;++y)for(var v=0;v<n.inHeight;++v)for(var b=0;b<n.inWidth;++b){for(var w=v-d,x=b-h,_=0,C=0;C<l;C+=s){var k=(w+C)/r;if(!(k<0||k>=n.outHeight||Math.floor(k)!==k))for(var S=0;S<c;S+=u){var E=(x+S)/i;E<0||E>=n.outWidth||Math.floor(E)!==E||(_+=m.get(g,k,E,y))}}f.set(_*p,g,v,b,y)}return f.toTensor()},t.prototype.pool3d=function(t,e,n){this.assertNotComplex(t,"pool3d");for(var r=e.strideDepth,i=e.strideHeight,o=e.strideWidth,a=e.dilationDepth,s=e.dilationHeight,u=e.dilationWidth,l=e.effectiveFilterDepth,c=e.effectiveFilterHeight,h=e.effectiveFilterWidth,d=e.padInfo.front,f=e.padInfo.top,p=e.padInfo.left,m="max"===n?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,g=this.readSync(t.dataId),y=Zn(e.outShape,t.dtype),v=y.values,b=e.outShape[1]*e.outShape[2]*e.outShape[3]*e.outShape[4],w=e.outShape[2]*e.outShape[3]*e.outShape[4],x=e.outShape[3]*e.outShape[4],_=e.outShape[4],C=0;C<e.batchSize;++C)for(var k=C*b,S=C*t.strides[0],E=0;E<e.inChannels;++E)for(var O=0;O<e.outDepth;++O){for(var A=O*r-d,N=A;N<0;)N+=a;for(var T=Math.min(e.inDepth,l+A),D=k+O*w,R=0;R<e.outHeight;++R){for(var I=R*i-f,M=I;M<0;)M+=s;for(var F=Math.min(e.inHeight,c+I),P=D+R*x,j=0;j<e.outWidth;++j){for(var z=j*o-p,L=z;L<0;)L+=u;for(var B=Math.min(e.inWidth,h+z),U=P+j*_,$=m,V=0,W=0,q=N;q<T;q+=a){for(var H=S+q*t.strides[1],G=M;G<F;G+=s){for(var X=H+G*t.strides[2],K=L;K<B;K+=u){var Y=g[X+K*t.strides[3]+E];if("max"===n&&Y>$?$=Y:"avg"===n&&(V+=Y,W++),isNaN($))break}if(isNaN($))break}if(isNaN($))break}v[U+E]="avg"===n?V/W:$}}}return y.toTensor()},t.prototype.avgPool3d=function(t,e){return this.assertNotComplex(t,"avgPool3d"),this.pool3d(t,e,"avg").toFloat()},t.prototype.avgPool3dBackprop=function(t,e,n){this.assertNotComplex([t,e],"avgPool3dBackprop");for(var r=n.strideDepth,i=n.strideHeight,o=n.strideWidth,a=n.filterDepth,s=n.filterHeight,u=n.filterWidth,l=n.dilationDepth,c=n.dilationHeight,h=n.dilationWidth,d=n.effectiveFilterDepth,f=n.effectiveFilterHeight,p=n.effectiveFilterWidth,m=d-1-n.padInfo.front,g=p-1-n.padInfo.left,y=f-1-n.padInfo.top,v=Zn(e.shape,"float32"),b=1/(a*s*u),w=this.bufferSync(t),x=0;x<n.batchSize;++x)for(var _=0;_<n.inChannels;++_)for(var C=0;C<n.inDepth;++C)for(var k=0;k<n.inHeight;++k)for(var S=0;S<n.inWidth;++S){for(var E=C-m,O=k-y,A=S-g,N=0,T=0;T<d;T+=l){var D=(E+T)/r;if(!(D<0||D>=n.outDepth||Math.floor(D)!==D))for(var R=0;R<f;R+=c){var I=(O+R)/i;if(!(I<0||I>=n.outHeight||Math.floor(I)!==I))for(var M=0;M<p;M+=h){var F=(A+M)/o;F<0||F>=n.outWidth||Math.floor(F)!==F||(N+=w.get(x,D,I,F,_))}}}v.set(N*b,x,C,k,S,_)}return v.toTensor()},t.prototype.maxPool3d=function(t,e){return this.assertNotComplex(t,"maxPool3d"),this.pool3d(t,e,"max").toFloat()},t.prototype.maxPool3dPositions=function(t,e){for(var n=Zn(e.outShape,"int32"),r=e.strideDepth,i=e.strideHeight,o=e.strideWidth,a=e.dilationDepth,s=e.dilationHeight,u=e.dilationWidth,l=e.effectiveFilterDepth,c=e.effectiveFilterHeight,h=e.effectiveFilterWidth,d=e.padInfo.front,f=e.padInfo.top,p=e.padInfo.left,m=this.bufferSync(t),g=0;g<e.batchSize;++g)for(var y=0;y<e.inChannels;++y)for(var v=0;v<e.outDepth;++v){for(var b=v*r-d,w=b;w<0;)w+=a;for(var x=Math.min(e.inDepth,l+b),_=0;_<e.outHeight;++_){for(var C=_*i-f,k=C;k<0;)k+=s;for(var S=Math.min(e.inHeight,c+C),E=0;E<e.outWidth;++E){for(var O=E*o-p,A=O;A<0;)A+=u;for(var N=Math.min(e.inWidth,h+O),T=Number.NEGATIVE_INFINITY,D=-1,R=w;R<x;R+=a)for(var I=R-b,M=k;M<S;M+=s)for(var F=M-C,P=A;P<N;P+=u){var j=P-O,z=m.get(g,R,M,P,y);z>=T&&(T=z,D=I*c*h+F*c+j)}n.set(D,g,v,_,E,y)}}}return n.toTensor()},t.prototype.maxPool3dBackprop=function(t,e,n,r){this.assertNotComplex([e,n],"maxPool3dBackprop");for(var i=this.maxPool3dPositions(e,r),o=r.strideDepth,a=r.strideHeight,s=r.strideWidth,u=r.dilationDepth,l=r.dilationHeight,c=r.dilationWidth,h=r.effectiveFilterDepth,d=r.effectiveFilterHeight,f=r.effectiveFilterWidth,p=h-1-r.padInfo.front,m=f-1-r.padInfo.left,g=d-1-r.padInfo.top,y=Zn(e.shape,"float32"),v=this.bufferSync(i),b=this.bufferSync(t),w=0;w<r.batchSize;++w)for(var x=0;x<r.inChannels;++x)for(var _=0;_<r.inDepth;++_)for(var C=0;C<r.inHeight;++C)for(var k=0;k<r.inWidth;++k){for(var S=_-p,E=C-g,O=k-m,A=0,N=0;N<h;N+=u){var T=(S+N)/o;if(!(T<0||T>=r.outDepth||Math.floor(T)!==T))for(var D=0;D<d;D+=l){var R=(E+D)/a;if(!(R<0||R>=r.outHeight||Math.floor(R)!==R))for(var I=0;I<f;I+=c){var M=(O+I)/s;if(!(M<0||M>=r.outWidth||Math.floor(M)!==M)){var F=h*d*f-1-v.get(w,T,R,M,x)===N*d*f+D*f+I?1:0;0!==F&&(A+=b.get(w,T,R,M,x)*F)}}}}y.set(A,w,_,C,k,x)}return y.toTensor()},t.prototype.cast=function(t,e){return hi(t,e,this)},t.prototype.reshape=function(t,e){return di(t,e)},t.prototype.avgPool=function(t,e){return this.assertNotComplex(t,"avgPool"),this.pool(t,e,"avg").toFloat()},t.prototype.resizeBilinear=function(t,e,n,r){this.assertNotComplex(t,"resizeBilinear");for(var i=t.shape,o=i[0],a=i[1],s=i[2],u=i[3],l=this.readSync(t.dataId),c=new Float32Array(v([o,e,n,u])),h=[r&&e>1?a-1:a,r&&n>1?s-1:s],d=[r&&e>1?e-1:e,r&&n>1?n-1:n],f=0,p=h[0]/d[0],m=h[1]/d[1],g=0;g<o;g++)for(var y=0;y<e;y++)for(var b=p*y,w=Math.floor(b),x=b-w,_=Math.min(a-1,Math.ceil(b)),C=g*t.strides[0]+w*t.strides[1],k=g*t.strides[0]+_*t.strides[1],S=0;S<n;S++)for(var E=m*S,O=Math.floor(E),A=E-O,N=Math.min(s-1,Math.ceil(E)),T=C+O*t.strides[2],D=k+O*t.strides[2],R=C+ +N*t.strides[2],I=k+N*t.strides[2],M=0;M<u;M++){var F=l[T+M],P=l[D+M],j=F+(l[R+M]-F)*A;c[f++]=j+(P+(l[I+M]-P)*A-j)*x}return yn(c,[o,e,n,u])},t.prototype.resizeBilinearBackprop=function(t,e,n){this.assertNotComplex([t,e],"resizeBilinearBackprop");for(var r=e.shape,i=r[0],o=r[1],a=r[2],s=r[3],u=t.shape,l=u[1],c=u[2],h=new Float32Array(i*o*a*s),d=[n&&l>1?o-1:o,n&&c>1?a-1:a],f=[n&&l>1?l-1:l,n&&c>1?c-1:c],p=d[0]/f[0],m=d[1]/f[1],g=this.readSync(t.dataId),y=0,v=0;v<i;v++)for(var b=v*e.strides[0],w=0;w<l;w++)for(var x=w*p,_=Math.floor(x),C=Math.min(Math.ceil(x),o-1),k=b+_*e.strides[1],S=b+C*e.strides[1],E=x-_,O=1-E,A=0;A<c;A++)for(var N=A*m,T=Math.floor(N),D=Math.min(Math.ceil(N),a-1),R=N-T,I=1-R,M=k+T*e.strides[2],F=k+D*e.strides[2],P=S+T*e.strides[2],j=S+D*e.strides[2],z=O*I,L=O*R,B=E*I,U=E*R,$=0;$<s;$++){var V=g[y++];h[M+$]+=V*z,h[F+$]+=V*L,h[P+$]+=V*B,h[j+$]+=V*U}return Cn(h,[i,a,o,s],e.dtype)},t.prototype.resizeNearestNeighbor=function(t,e,n,r){this.assertNotComplex(t,"resizeNearestNeighbor");for(var i=t.shape,o=i[0],a=i[1],s=i[2],u=i[3],l=this.readSync(t.dataId),c=new Float32Array(o*e*n*u),h=[r&&e>1?a-1:a,r&&n>1?s-1:s],d=[r&&e>1?e-1:e,r&&n>1?n-1:n],f=h[0]/d[0],p=h[1]/d[1],m=0,g=0;g<o;g++)for(var y=g*t.strides[0],v=0;v<e;v++)for(var b=f*v,w=y+Math.min(a-1,r?Math.round(b):Math.floor(b))*t.strides[1],x=0;x<n;x++)for(var _=p*x,C=w+Math.min(s-1,r?Math.round(_):Math.floor(_))*t.strides[2],k=0;k<u;k++)c[m++]=l[C+k];return yn(c,[o,e,n,u],t.dtype)},t.prototype.resizeNearestNeighborBackprop=function(t,e,n){this.assertNotComplex([t,e],"resizeNearestNeighborBackprop");for(var r=e.shape,i=r[0],o=r[1],a=r[2],s=r[3],u=t.shape,l=u[1],c=u[2],h=new Float32Array(i*o*a*s),d=this.readSync(t.dataId),f=[n&&l>1?o-1:o,n&&c>1?a-1:a],p=[n&&l>1?l-1:l,n&&c>1?c-1:c],m=f[0]/p[0],g=f[1]/p[1],y=1/m,v=1/g,b=2*Math.ceil(y)+2,w=2*Math.ceil(v)+2,x=0;x<i;x++)for(var _=x*e.strides[0],C=0;C<o;C++)for(var k=_+C*e.strides[1],S=Math.floor(C*y),E=Math.floor(S-b/2),O=0;O<a;O++)for(var A=k+O*e.strides[2],N=Math.floor(O*v),T=Math.floor(N-w/2),D=0;D<s;D++){for(var R=0,I=0;I<b;I++){var M=I+E;if(!(M<0||M>=l)){var F=_+M*t.strides[1],P=M*m;if(C===Math.min(o-1,n?Math.round(P):Math.floor(P)))for(var j=0;j<w;j++){var z=j+T;if(!(z<0||z>=c)){var L=F+z*t.strides[2],B=z*g;O===Math.min(a-1,n?Math.round(B):Math.floor(B))&&(R+=d[L+D])}}}}h[A+D]=R}return Cn(h,e.shape,e.dtype)},t.prototype.batchNormalization=function(t,e,n,r,i,o){this.assertNotComplex([t,e,n,i,o],"batchNorm");for(var a=this.readSync(t.dataId),s=this.readSync(e.dataId),u=this.readSync(n.dataId),l=i?this.readSync(i.dataId):new Float32Array([1]),c=o?this.readSync(o.dataId):new Float32Array([0]),h=new Float32Array(a.length),d=c.length,f=l.length,p=u.length,m=s.length,g=0,y=0,v=0,b=0,w=0;w<a.length;++w)h[w]=c[g++]+(a[w]-s[y++])*l[v++]/Math.sqrt(u[b++]+r),g>=d&&(g=0),y>=m&&(y=0),v>=f&&(v=0),b>=p&&(b=0);return Cn(h,t.shape)},t.prototype.localResponseNormalization4D=function(t,e,n,r,i){this.assertNotComplex(t,"localResponseNormalization4D");var o=t.shape[3],a=o-1,s=this.readSync(t.dataId),u=t.size,l=new Float32Array(u);function c(t){for(var n=t%o,r=t-n+Math.max(0,n-e),i=t-n+Math.min(n+e,a),u=0;r<=i;r++){var l=s[r];u+=l*l}return u}for(var h=0;h<u;h++){var d=c(h),f=s[h]*Math.pow(n+r*d,-i);l[h]=f}return Cn(l,t.shape)},t.prototype.LRNGrad=function(t,e,n,r,i,o,a){this.assertNotComplex(t,"LRNGrad");for(var s=t.shape[3],u=this.readSync(t.dataId),l=this.readSync(e.dataId),c=this.readSync(n.dataId),h=new Float32Array(t.size),d=t.size,f=0;f<d;f++){for(var p=f%s,m=f-p+Math.max(0,p-r),g=f-p+Math.min(s,p+r+1),y=0,v=m;v<g;v++)y+=Math.pow(l[v],2);for(y=o*y+i,v=m;v<g;v++){var b=-2*o*a*l[v]*c[f]/y;f===v&&(b+=Math.pow(y,-a)),h[v]+=b*=u[f]}}return Cn(h,t.shape)},t.prototype.multinomial=function(t,e,n,r){this.assertNotComplex(t,"multinomial");for(var i=e?t:Hr(t),o=i.shape[0],a=i.shape[1],s=On([o,n],"int32"),u=this.readSync(s.dataId),l=this.readSync(i.dataId),c=0;c<o;++c){var h=c*a,d=new Float32Array(a-1);d[0]=l[h];for(var f=1;f<d.length;++f)d[f]=d[f-1]+l[h+f];for(var p=Gn(r.toString()),m=c*n,g=0;g<n;++g){var y=p();u[m+g]=d.length;for(var v=0;v<d.length;v++)if(y<d[v]){u[m+g]=v;break}}}return s},t.prototype.oneHot=function(t,e,n,r){this.assertNotComplex(t,"oneHot");var i=new Float32Array(t.size*e);i.fill(r);for(var o=this.readSync(t.dataId),a=0;a<t.size;++a)o[a]>=0&&o[a]<e&&(i[a*e+o[a]]=n);return xn(i,[t.size,e],"int32")},t.prototype.nonMaxSuppression=function(t,e,n,r,i){return this.assertNotComplex(t,"nonMaxSuppression"),bi(this.readSync(t.dataId),this.readSync(e.dataId),n,r,i)},t.prototype.fft=function(t){return this.fftBatch(t,!1)},t.prototype.ifft=function(t){return this.fftBatch(t,!0)},t.prototype.fftBatch=function(t,e){for(var n=t.shape[0],r=t.shape[1],i=Zn(t.shape,"float32"),o=Zn(t.shape,"float32"),a=mn(t).as2D(n,r),s=gn(t).as2D(n,r),u=0;u<n;u++)for(var l=a.slice([u,0],[1,r]),c=s.slice([u,0],[1,r]),h=pn(l,c),d=this.readSync(this.fftImpl(h,e).dataId),f=0;f<r;f++){var p=gi(d,f);i.values[u*r+f]=p.real,o.values[u*r+f]=p.imag}return pn(i.toTensor(),o.toTensor()).as2D(n,r)},t.prototype.fftImpl=function(t,e){var n=t.as1D(),r=n.size;if(this.isExponentOf2(r)){var i=this.fftRadix2(n,r,e).as2D(t.shape[0],t.shape[1]);return e&&(i=pn(mn(i).div(bn(r)),gn(i).div(bn(r)))),i}var o=this.readSync(t.dataId),a=function(t){for(var e=new Float32Array(t.length/2),n=new Float32Array(t.length/2),r=0;r<t.length;r+=2)e[r/2]=t[r],n[r/2]=t[r+1];return{real:e,imag:n}}(this.fourierTransformByMatmul(o,r,e));return pn(a.real,a.imag).as2D(t.shape[0],t.shape[1])},t.prototype.isExponentOf2=function(t){return 0==(t&t-1)},t.prototype.fftRadix2=function(t,e,n){if(1===e)return t;var r=this.readSync(t.dataId),i=e/2,o=function(t){for(var e=Math.ceil(t.length/4),n=new Float32Array(e),r=new Float32Array(e),i=0;i<t.length;i+=4)n[Math.floor(i/4)]=t[i],r[Math.floor(i/4)]=t[i+1];return{real:n,imag:r}}(r),a=pn(o.real,o.imag).as1D(),s=function(t){for(var e=Math.floor(t.length/4),n=new Float32Array(e),r=new Float32Array(e),i=2;i<t.length;i+=4)n[Math.floor(i/4)]=t[i],r[Math.floor(i/4)]=t[i+1];return{real:n,imag:r}}(r),u=pn(s.real,s.imag).as1D();a=this.fftRadix2(a,i,n),u=this.fftRadix2(u,i,n);var l=function(t,e){for(var n=new Float32Array(t/2),r=new Float32Array(t/2),i=0;i<Math.ceil(t/2);i++){var o=(e?2:-2)*Math.PI*(i/t);n[i]=Math.cos(o),r[i]=Math.sin(o)}return{real:n,imag:r}}(e,n),c=pn(l.real,l.imag).mul(u),h=a.add(c),d=a.sub(c),f=mn(h).concat(mn(d)),p=gn(h).concat(gn(d));return pn(f,p).as1D()},t.prototype.fourierTransformByMatmul=function(t,e,n){for(var r=new Float32Array(2*e),i=0;i<e;i++){for(var o=0,a=0,s=0;s<e;s++){var u=vi(i*s,e,n),l=gi(t,s);o+=l.real*u.real-l.imag*u.imag,a+=l.real*u.imag+l.imag*u.real}n&&(o/=e,a/=e),yi(r,o,a,i)}return r},t.prototype.depthToSpace=function(t,e,n){p("NHWC"===n,(function(){return"Only NHWC dataFormat supported on CPU for depthToSpace. Got "+n})),p(e>1,(function(){return"blockSize should be > 1 for depthToSpace, but was: "+e}));for(var r=t.shape[0],i=t.shape[1],o=t.shape[2],a=t.shape[3],s=i*e,u=o*e,l=a/(e*e),c=this.readSync(t.dataId),h=new Float32Array(r*s*u*l),d=0,f=0;f<r;++f)for(var m=0;m<s;++m)for(var g=Math.floor(m/e),y=m%e,v=0;v<u;++v)for(var b=Math.floor(v/e),w=(y*e+v%e)*l,x=0;x<l;++x)h[d++]=c[x+w+a*(b+o*(g+i*f))];return Cn(h,[r,s,u,l])},t.prototype.broadcastedBinaryOp=function(t,e,n,r){var i=Qr(t.shape,e.shape),o=Zn(i,n),a=this.readSync(t.dataId),s=this.readSync(e.dataId),u=Yr(t.shape,i),l=Yr(e.shape,i),c=o.values;if(u.length+l.length===0)for(var h=0;h<c.length;++h)c[h]=r(a[h%a.length],s[h%s.length]);else{var d=this.bufferSync(t),f=this.bufferSync(e),p=function(n){var i=o.indexToLoc(n),h=i.slice(-t.rank);u.forEach((function(t){return h[t]=0}));var p=d.locToIndex(h),m=i.slice(-e.rank);l.forEach((function(t){return m[t]=0}));var g=f.locToIndex(m);c[n]=r(a[p],s[g])};for(h=0;h<c.length;++h)p(h)}return o.toTensor()},t.prototype.broadcastedBinaryComplexOp=function(t,e,n){var r=Qr(t.shape,e.shape),i=Zn(r,"float32"),o=Zn(r,"float32"),a=this.readSync(t.dataId),s=this.readSync(e.dataId),u=Yr(t.shape,r),l=Yr(e.shape,r),c=i.values,h=o.values;if(u.length+l.length===0)for(var d=0;d<c.length;d++){var f=d%a.length,p=d%s.length,m=n(a[2*f],a[2*f+1],s[2*p],s[2*p+1]);c[d]=m.real,h[d]=m.imag}else{var g=this.bufferSync(this.data.get(t.dataId).complexTensors.real),y=this.bufferSync(this.data.get(e.dataId).complexTensors.real),v=function(r){var o=i.indexToLoc(r),d=o.slice(-t.rank);u.forEach((function(t){return d[t]=0}));var f=g.locToIndex(d),p=o.slice(-e.rank);l.forEach((function(t){return p[t]=0}));var m=y.locToIndex(p),v=n(a[2*f],a[2*f+1],s[2*m],s[2*m+1]);c[r]=v.real,h[r]=v.imag};for(d=0;d<c.length;d++)v(d)}return this.complex(i.toTensor(),o.toTensor())},t.prototype.split=function(t,e,n){return xi(t,e,n)},t.prototype.dispose=function(){},t.prototype.floatPrecision=function(){return 32},t.prototype.epsilon=function(){return 1e-7},t.prototype.cropAndResize=function(t,e,n,r,i,o){for(var a=t.shape,s=a[0],u=a[1],l=a[2],c=a[3],h=e.shape[0],d=r[0],f=r[1],p=Zn([h,d,f,c],t.dtype),m=this.readSync(e.dataId),g=this.readSync(n.dataId),y=this.readSync(t.dataId),v=t.strides,b=p.strides,w=0;w<h;w++){var x=4*w,_=m[x],C=m[x+1],k=m[x+2],S=m[x+3],E=g[w];if(!(E>=s))for(var O=d>1?(k-_)*(u-1)/(d-1):0,A=f>1?(S-C)*(l-1)/(f-1):0,N=0;N<d;N++){var T=d>1?_*(u-1)+N*O:.5*(_+k)*(u-1);if(T<0||T>u-1)for(var D=0;D<f;D++)for(var R=0;R<c;R++){var I=R+D*b[2]+N*b[1]+w*b[0];p.values[I]=o}else if("bilinear"===i){var M=Math.floor(T),F=Math.ceil(T),P=T-M;for(D=0;D<f;D++)if((q=f>1?C*(l-1)+D*A:.5*(C+S)*(l-1))<0||q>l-1)for(R=0;R<c;R++)p.values[I=R+D*b[2]+N*b[1]+w*b[0]]=o;else{var j=Math.floor(q),z=Math.ceil(q),L=q-j;for(R=0;R<c;R++){var B=y[I=R+j*v[2]+M*v[1]+E*v[0]],U=y[I=R+z*v[2]+M*v[1]+E*v[0]],$=y[I=R+j*v[2]+F*v[1]+E*v[0]],V=B+(U-B)*L,W=$+(y[I=R+z*v[2]+F*v[1]+E*v[0]]-$)*L;p.values[I=R+D*b[2]+N*b[1]+w*b[0]]=V+(W-V)*P}}}else for(D=0;D<f;++D){var q;if((q=f>1?C*(l-1)+D*A:.5*(C+S)*(l-1))<0||q>l-1)for(R=0;R<c;R++)p.values[I=R+D*b[2]+N*b[1]+w*b[0]]=o;else{var H=Math.round(q),G=Math.round(T);for(R=0;R<c;R++)p.values[R+D*b[2]+N*b[1]+w*b[0]]=y[R+H*v[2]+G*v[1]+E*v[0]]}}}}return p.toTensor()},t.prototype.sparseToDense=function(t,e,n,r){var i=Rr(0,t,n);return this.scatter(t,e,n,i.outputSize,i.sliceSize,i.numUpdates,i.sliceRank,i.strides,r,!1)},t.prototype.gatherND=function(t,e){var n=e.shape,r=n[n.length-1],i=Tr(t,e),o=i[0],a=i[1],s=i[2],u=i[3];if(0===a)return yn([],o,t.dtype);for(var l=new rt([a,s],t.dtype),c=this.readSync(e.dataId),h=this.readSync(t.dataId),d=0;d<a;d++){for(var f=[],p=0,m=0;m<r;m++){var g=c[d*r+m];p+=g*u[m],f.push(g)}if(p<0||p>=t.size/s)throw new Error("Invalid indices: "+f+" does not index into "+t.shape);for(var y=0;y<s;y++)l.values[d*s+y]=h[p*s+y]}return l.toTensor().reshape(o)},t.prototype.scatterND=function(t,e,n){var r=Rr(0,t,n),i=r.sliceRank,o=r.numUpdates,a=r.sliceSize,s=r.strides,u=r.outputSize,l=bn(0);return this.scatter(t,e,n,u,a,o,i,s,l,!0)},t.prototype.fill=function(t,e,n){var r=N(n=n||L(e),v(t));return r.fill(e),st.make(t,{values:r},n)},t.prototype.onesLike=function(t){if("string"===t.dtype)throw new Error("onesLike is not supported for string tensors");return this.fill(t.shape,1,t.dtype)},t.prototype.zerosLike=function(t){var e=N(t.dtype,v(t.shape));return st.make(t.shape,{values:e},t.dtype)},t.prototype.linspace=function(t,e,n){return fi(t,e,n)},t.prototype.scatter=function(t,e,n,r,i,o,a,s,u,l){var c=[r/i,i],h=this.readSync(t.dataId),d=this.readSync(e.dataId);if(0===r)return yn([],n,e.dtype);var f=new rt(c,e.dtype);f.values.fill(this.readSync(u.dataId)[0]);for(var p=0;p<o;p++){for(var m=[],g=0,y=0;y<a;y++){var v=h[p*a+y];m.push(v),g+=v*s[y]}if(g<0||g>=r/i)throw new Error("Invalid indices: "+m+" does not index into "+n);for(var b=0;b<i;b++)l?f.values[g*i+b]+=d[p*i+b]:f.values[g*i+b]=0===e.rank?d[0]:d[p*i+b]}return f.toTensor().reshape(n)},t}();St.registerBackend("cpu",(function(){return new Bc}),1);var Uc=function(){function t(){}return t.prototype.fetch=function(t,e){return fetch(t,e)},t.prototype.now=function(){return performance.now()},t.prototype.encode=function(t,e){if("utf-8"!==e&&"utf8"!==e)throw new Error("Browser's encoder only supports utf-8, but got "+e);return null==this.textEncoder&&(this.textEncoder=new TextEncoder),this.textEncoder.encode(t)},t.prototype.decode=function(t,e){return new TextDecoder(e).decode(t)},t}();u().get("IS_BROWSER")&&u().setPlatform("browser",new Uc);var $c,Vc=function(){function t(){this.util=n(3),this.textEncoder=new this.util.TextEncoder}return t.prototype.fetch=function(t,e){return null!=u().global.fetch?u().global.fetch(t,e):(null==$c&&($c=n(2)),$c(t,e))},t.prototype.now=function(){var t=process.hrtime();return 1e3*t[0]+t[1]/1e6},t.prototype.encode=function(t,e){if("utf-8"!==e&&"utf8"!==e)throw new Error("Node built-in encoder only supports utf-8, but got "+e);return this.textEncoder.encode(t)},t.prototype.decode=function(t,e){return 0===t.length?"":new this.util.TextDecoder(e).decode(t)},t}();u().get("IS_NODE")&&u().setPlatform("node",new Vc);var Wc={float32:4,int32:4,uint16:2,uint8:1,bool:1};function qc(t,e){for(var n={},r=0,i=function(e){var i=e.name,o=e.dtype,a=e.shape,s=v(a),u=void 0;if("quantization"in e){var l=e.quantization;if("uint8"!==l.dtype&&"uint16"!==l.dtype)throw new Error("Weight "+e.name+" has unknown quantization dtype "+l.dtype+". Supported quantization dtypes are: 'uint8' and 'uint16'.");var c=Wc[l.dtype],h=t.slice(r,r+s*c),d="uint8"===l.dtype?new Uint8Array(h):new Uint16Array(h);if("float32"===o)u=Float32Array.from(d,(function(t){return t*l.scale+l.min}));else{if("int32"!==o)throw new Error("Unsupported dtype in weight '"+i+"': "+o);u=Int32Array.from(d,(function(t){return Math.round(t*l.scale+l.min)}))}r+=s*c}else if("string"===o){var f=v(e.shape);u=[];for(var p=0;p<f;p++){var m=new Uint32Array(t.slice(r,r+4))[0];r+=4;var g=new Uint8Array(t.slice(r,r+m));u.push(g),r+=m}}else{var y=Wc[o];if(h=t.slice(r,r+s*y),"float32"===o)u=new Float32Array(h);else if("int32"===o)u=new Int32Array(h);else{if("bool"!==o)throw new Error("Unsupported dtype in weight '"+i+"': "+o);u=new Uint8Array(h)}r+=s*y}n[i]=yn(u,a,o)},o=0,a=e;o<a.length;o++)i(a[o]);return n}function Hc(t){if(null===t)throw new Error("Invalid input value: "+JSON.stringify(t));var e=0,n=[];t.forEach((function(t){if(e+=t.byteLength,n.push(t.byteLength===t.buffer.byteLength?t:new t.constructor(t)),!(t instanceof Float32Array||t instanceof Int32Array||t instanceof Uint8Array))throw new Error("Unsupported TypedArray subtype: "+t.constructor.name)}));var r=new Uint8Array(e),i=0;return n.forEach((function(t){r.set(new Uint8Array(t.buffer),i),i+=t.byteLength})),r.buffer}var Gc="undefined"!=typeof Buffer&&("undefined"==typeof Blob||"undefined"==typeof atob||"undefined"==typeof btoa);function Xc(t){return Gc?Buffer.byteLength(t):new Blob([t]).size}function Kc(t){var e=0;t.forEach((function(t){e+=t.byteLength}));var n=new Uint8Array(e),r=0;return t.forEach((function(t){n.set(new Uint8Array(t),r),r+=t.byteLength})),n.buffer}function Yc(t){for(t=t.trim();t.endsWith("/");)t=t.slice(0,t.length-1);var e=t.split("/");return e[e.length-1]}function Zc(t){if(t.modelTopology instanceof ArrayBuffer)throw new Error("Expected JSON model topology, received ArrayBuffer.");return{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:null==t.modelTopology?0:Xc(JSON.stringify(t.modelTopology)),weightSpecsBytes:null==t.weightSpecs?0:Xc(JSON.stringify(t.weightSpecs)),weightDataBytes:null==t.weightData?0:t.weightData.byteLength}}var Qc=function(){function t(){this.saveRouters=[],this.loadRouters=[]}return t.getInstance=function(){return null==t.instance&&(t.instance=new t),t.instance},t.registerSaveRouter=function(e){t.getInstance().saveRouters.push(e)},t.registerLoadRouter=function(e){t.getInstance().loadRouters.push(e)},t.getSaveHandlers=function(e){return t.getHandlers(e,"save")},t.getLoadHandlers=function(e,n){return t.getHandlers(e,"load",n)},t.getHandlers=function(e,n,r){var i=[];return("load"===n?t.getInstance().loadRouters:t.getInstance().saveRouters).forEach((function(t){var n=t(e,r);null!==n&&i.push(n)})),i},t}(),Jc="://",th=function(){function t(){this.managers={}}return t.getInstance=function(){return null==t.instance&&(t.instance=new t),t.instance},t.registerManager=function(e,n){p(null!=e,(function(){return"scheme must not be undefined or null."})),e.endsWith(Jc)&&(e=e.slice(0,e.indexOf(Jc))),p(e.length>0,(function(){return"scheme must not be an empty string."}));var r=t.getInstance();p(null==r.managers[e],(function(){return"A model store manager is already registered for scheme '"+e+"'."})),r.managers[e]=n},t.getManager=function(t){var e=this.getInstance().managers[t];if(null==e)throw new Error("Cannot find model manager for scheme '"+t+"'");return e},t.getSchemes=function(){return Object.keys(this.getInstance().managers)},t}();function eh(t){if(-1===t.indexOf(Jc))throw new Error("The url string provided does not contain a scheme. Supported schemes are: "+th.getSchemes().join(","));return{scheme:t.split(Jc)[0],path:t.split(Jc)[1]}}function nh(t,e,n){return void 0===n&&(n=!1),o(this,void 0,void 0,(function(){var r,i,o,s,u,l,c,h,d;return a(this,(function(a){switch(a.label){case 0:return p(t!==e,(function(){return"Old path and new path are the same: '"+t+"'"})),p((r=Qc.getLoadHandlers(t)).length>0,(function(){return"Copying failed because no load handler is found for source URL "+t+"."})),p(r.length<2,(function(){return"Copying failed because more than one ("+r.length+") load handlers for source URL "+t+"."})),i=r[0],p((o=Qc.getSaveHandlers(e)).length>0,(function(){return"Copying failed because no save handler is found for destination URL "+e+"."})),p(o.length<2,(function(){return"Copying failed because more than one ("+r.length+") save handlers for destination URL "+e+"."})),s=o[0],u=eh(t).scheme,l=eh(t).path,c=u===eh(t).scheme,[4,i.load()];case 1:return h=a.sent(),n&&c?[4,th.getManager(u).removeModel(l)]:[3,3];case 2:a.sent(),a.label=3;case 3:return[4,s.save(h)];case 4:return d=a.sent(),!n||c?[3,6]:[4,th.getManager(u).removeModel(l)];case 5:a.sent(),a.label=6;case 6:return[2,d.modelArtifactsInfo]}}))}))}var rh="models_store",ih="model_info_store";function oh(){if(!u().getBool("IS_BROWSER"))throw new Error("Failed to obtain IndexedDB factory because the current environmentis not a web browser.");var t=window,e=t.indexedDB||t.mozIndexedDB||t.webkitIndexedDB||t.msIndexedDB||t.shimIndexedDB;if(null==e)throw new Error("The current browser does not appear to support IndexedDB.");return e}function ah(t){var e=t.result;e.createObjectStore(rh,{keyPath:"modelPath"}),e.createObjectStore(ih,{keyPath:"modelPath"})}var sh=function(){function t(t){if(this.indexedDB=oh(),null==t||!t)throw new Error("For IndexedDB, modelPath must not be null, undefined or empty.");this.modelPath=t}return t.prototype.save=function(t){return o(this,void 0,void 0,(function(){return a(this,(function(e){if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");return[2,this.databaseAction(this.modelPath,t)]}))}))},t.prototype.load=function(){return o(this,void 0,void 0,(function(){return a(this,(function(t){return[2,this.databaseAction(this.modelPath)]}))}))},t.prototype.databaseAction=function(t,e){var n=this;return new Promise((function(t,r){var i=n.indexedDB.open("tensorflowjs",1);i.onupgradeneeded=function(){return ah(i)},i.onsuccess=function(){var o=i.result;if(null==e){var a=o.transaction(rh,"readonly"),s=a.objectStore(rh).get(n.modelPath);s.onsuccess=function(){if(null==s.result)return o.close(),r(new Error("Cannot find model with path '"+n.modelPath+"' in IndexedDB."));t(s.result.modelArtifacts)},s.onerror=function(t){return o.close(),r(s.error)},a.oncomplete=function(){return o.close()}}else{var u,l=Zc(e),c=o.transaction(ih,"readwrite"),h=c.objectStore(ih),d=h.put({modelPath:n.modelPath,modelArtifactsInfo:l});d.onsuccess=function(){var i=(u=o.transaction(rh,"readwrite")).objectStore(rh).put({modelPath:n.modelPath,modelArtifacts:e,modelArtifactsInfo:l});i.onsuccess=function(){return t({modelArtifactsInfo:l})},i.onerror=function(t){var e=(h=c.objectStore(ih)).delete(n.modelPath);e.onsuccess=function(){return o.close(),r(i.error)},e.onerror=function(t){return o.close(),r(i.error)}}},d.onerror=function(t){return o.close(),r(d.error)},c.oncomplete=function(){null==u?o.close():u.oncomplete=function(){return o.close()}}}},i.onerror=function(t){return r(i.error)}}))},t.URL_SCHEME="indexeddb://",t}(),uh=function(t){return u().getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(sh.URL_SCHEME)?(e=t.slice(sh.URL_SCHEME.length),new sh(e)):null;var e};Qc.registerSaveRouter(uh),Qc.registerLoadRouter(uh);var lh=function(){function t(){this.indexedDB=oh()}return t.prototype.listModels=function(){return o(this,void 0,void 0,(function(){var t=this;return a(this,(function(e){return[2,new Promise((function(e,n){var r=t.indexedDB.open("tensorflowjs",1);r.onupgradeneeded=function(){return ah(r)},r.onsuccess=function(){var t=r.result,i=t.transaction(ih,"readonly"),o=i.objectStore(ih).getAll();o.onsuccess=function(){for(var t={},n=0,r=o.result;n<r.length;n++){var i=r[n];t[i.modelPath]=i.modelArtifactsInfo}e(t)},o.onerror=function(e){return t.close(),n(o.error)},i.oncomplete=function(){return t.close()}},r.onerror=function(t){return n(r.error)}}))]}))}))},t.prototype.removeModel=function(t){return o(this,void 0,void 0,(function(){var e=this;return a(this,(function(n){var r;return t=(r=t).startsWith(sh.URL_SCHEME)?r.slice(sh.URL_SCHEME.length):r,[2,new Promise((function(n,r){var i=e.indexedDB.open("tensorflowjs",1);i.onupgradeneeded=function(){return ah(i)},i.onsuccess=function(){var e,o=i.result,a=o.transaction(ih,"readwrite"),s=a.objectStore(ih),u=s.get(t);u.onsuccess=function(){if(null==u.result)return o.close(),r(new Error("Cannot find model with path '"+t+"' in IndexedDB."));var i=s.delete(t),a=function(){var i=(e=o.transaction(rh,"readwrite")).objectStore(rh).delete(t);i.onsuccess=function(){return n(u.result.modelArtifactsInfo)},i.onerror=function(t){return r(u.error)}};i.onsuccess=a,i.onerror=function(t){return a(),o.close(),r(u.error)}},u.onerror=function(t){return o.close(),r(u.error)},a.oncomplete=function(){null==e?o.close():e.oncomplete=function(){return o.close()}}},i.onerror=function(t){return r(i.error)}}))]}))}))},t}();if(u().getBool("IS_BROWSER"))try{th.registerManager(sh.URL_SCHEME,new lh)}catch(r){}var ch="/",hh="tensorflowjs_models",dh="info",fh="model_topology",ph="weight_specs",mh="weight_data",gh="model_metadata";function yh(t){return{info:[hh,t,dh].join(ch),topology:[hh,t,fh].join(ch),weightSpecs:[hh,t,ph].join(ch),weightData:[hh,t,mh].join(ch),modelMetadata:[hh,t,gh].join(ch)}}function vh(t){var e=t.split(ch);if(e.length<3)throw new Error("Invalid key format: "+t);return e.slice(1,e.length-1).join(ch)}var bh=function(){function t(t){if(!u().getBool("IS_BROWSER")||void 0===window.localStorage)throw new Error("The current environment does not support local storage.");if(this.LS=window.localStorage,null==t||!t)throw new Error("For local storage, modelPath must not be null, undefined or empty.");this.modelPath=t,this.keys=yh(this.modelPath)}return t.prototype.save=function(t){return o(this,void 0,void 0,(function(){var e,n,r;return a(this,(function(i){if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");e=JSON.stringify(t.modelTopology),n=JSON.stringify(t.weightSpecs),r=Zc(t);try{return this.LS.setItem(this.keys.info,JSON.stringify(r)),this.LS.setItem(this.keys.topology,e),this.LS.setItem(this.keys.weightSpecs,n),this.LS.setItem(this.keys.weightData,(o=t.weightData,Gc?Buffer.from(o).toString("base64"):btoa(String.fromCharCode.apply(null,new Uint8Array(o))))),this.LS.setItem(this.keys.modelMetadata,JSON.stringify({format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy})),[2,{modelArtifactsInfo:r}]}catch(t){throw this.LS.removeItem(this.keys.info),this.LS.removeItem(this.keys.topology),this.LS.removeItem(this.keys.weightSpecs),this.LS.removeItem(this.keys.weightData),this.LS.removeItem(this.keys.modelMetadata),new Error("Failed to save model '"+this.modelPath+"' to local storage: size quota being exceeded is a possible cause of this failure: modelTopologyBytes="+r.modelTopologyBytes+", weightSpecsBytes="+r.weightSpecsBytes+", weightDataBytes="+r.weightDataBytes+".")}var o;return[2]}))}))},t.prototype.load=function(){return o(this,void 0,void 0,(function(){var t,e,n,r,i,o,s;return a(this,(function(a){if(null==(t=JSON.parse(this.LS.getItem(this.keys.info))))throw new Error("In local storage, there is no model with name '"+this.modelPath+"'");if("JSON"!==t.modelTopologyType)throw new Error("BrowserLocalStorage does not support loading non-JSON model topology yet.");if(e={},null==(n=JSON.parse(this.LS.getItem(this.keys.topology))))throw new Error("In local storage, the topology of model '"+this.modelPath+"' is missing.");if(e.modelTopology=n,null==(r=JSON.parse(this.LS.getItem(this.keys.weightSpecs))))throw new Error("In local storage, the weight specs of model '"+this.modelPath+"' are missing.");if(e.weightSpecs=r,null!=(i=this.LS.getItem(this.keys.modelMetadata))&&(o=JSON.parse(i),e.format=o.format,e.generatedBy=o.generatedBy,e.convertedBy=o.convertedBy),null==(s=this.LS.getItem(this.keys.weightData)))throw new Error("In local storage, the binary weight values of model '"+this.modelPath+"' are missing.");return e.weightData=function(t){if(Gc){var e=Buffer.from(t,"base64");return e.buffer.slice(e.byteOffset,e.byteOffset+e.byteLength)}for(var n=atob(t),r=new Uint8Array(n.length),i=0;i<n.length;++i)r.set([n.charCodeAt(i)],i);return r.buffer}(s),[2,e]}))}))},t.URL_SCHEME="localstorage://",t}(),wh=function(t){return u().getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(bh.URL_SCHEME)?(e=t.slice(bh.URL_SCHEME.length),new bh(e)):null;var e};Qc.registerSaveRouter(wh),Qc.registerLoadRouter(wh);var xh=function(){function t(){p(u().getBool("IS_BROWSER"),(function(){return"Current environment is not a web browser"})),p(void 0!==window.localStorage,(function(){return"Current browser does not appear to support localStorage"})),this.LS=window.localStorage}return t.prototype.listModels=function(){return o(this,void 0,void 0,(function(){var t,e,n,r,i,o;return a(this,(function(a){for(t={},e=hh+ch,n=ch+dh,r=0;r<this.LS.length;++r)(i=this.LS.key(r)).startsWith(e)&&i.endsWith(n)&&(o=vh(i),t[o]=JSON.parse(this.LS.getItem(i)));return[2,t]}))}))},t.prototype.removeModel=function(t){return o(this,void 0,void 0,(function(){var e,n;return a(this,(function(r){var i;if(t=(i=t).startsWith(bh.URL_SCHEME)?i.slice(bh.URL_SCHEME.length):i,e=yh(t),null==this.LS.getItem(e.info))throw new Error("Cannot find model at path '"+t+"'");return n=JSON.parse(this.LS.getItem(e.info)),this.LS.removeItem(e.info),this.LS.removeItem(e.topology),this.LS.removeItem(e.weightSpecs),this.LS.removeItem(e.weightData),[2,n]}))}))},t}();if(u().getBool("IS_BROWSER"))try{th.registerManager(bh.URL_SCHEME,new xh)}catch(r){}function _h(t){return new Promise((function(t){return setTimeout(t)})).then(t)}var Ch=function(){function t(e){if(!u().getBool("IS_BROWSER"))throw new Error("browserDownloads() cannot proceed because the current environment is not a browser.");e.startsWith(t.URL_SCHEME)&&(e=e.slice(t.URL_SCHEME.length)),null!=e&&0!==e.length||(e="model"),this.modelTopologyFileName=e+".json",this.weightDataFileName=e+".weights.bin"}return t.prototype.save=function(t){return o(this,void 0,void 0,(function(){var e,n,r,i;return a(this,(function(o){switch(o.label){case 0:if("undefined"==typeof document)throw new Error("Browser downloads are not supported in this environment since `document` is not present");if(e=window.URL.createObjectURL(new Blob([t.weightData],{type:"application/octet-stream"})),!(t.modelTopology instanceof ArrayBuffer))return[3,1];throw new Error("BrowserDownloads.save() does not support saving model topology in binary formats yet.");case 1:return n=window.URL.createObjectURL(new Blob([JSON.stringify({modelTopology:t.modelTopology,format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,weightsManifest:[{paths:["./"+this.weightDataFileName],weights:t.weightSpecs}]})],{type:"application/json"})),(r=null==this.jsonAnchor?document.createElement("a"):this.jsonAnchor).download=this.modelTopologyFileName,r.href=n,[4,_h((function(){return r.dispatchEvent(new MouseEvent("click"))}))];case 2:return o.sent(),null==t.weightData?[3,4]:((i=null==this.weightDataAnchor?document.createElement("a"):this.weightDataAnchor).download=this.weightDataFileName,i.href=e,[4,_h((function(){return i.dispatchEvent(new MouseEvent("click"))}))]);case 3:o.sent(),o.label=4;case 4:return[2,{modelArtifactsInfo:Zc(t)}]}}))}))},t.URL_SCHEME="downloads://",t}(),kh=function(){function t(t){if(null==t||t.length<1)throw new Error("When calling browserFiles, at least 1 file is required, but received "+t);this.files=t}return t.prototype.load=function(){return o(this,void 0,void 0,(function(){var t,e,n=this;return a(this,(function(r){return t=this.files[0],e=this.files.slice(1),[2,new Promise((function(r,i){var o=new FileReader;o.onload=function(o){var a=JSON.parse(o.target.result),s=a.modelTopology;if(null!=s){0===e.length&&r({modelTopology:s});var u=a.weightsManifest;if(null!=u){var l;try{l=n.checkManifestAndWeightFiles(u,e)}catch(t){return void i(t)}var c=[],h=[],d=[];u.forEach((function(t){t.paths.forEach((function(t){h.push(t),d.push(null)})),c.push.apply(c,t.weights)})),u.forEach((function(t){t.paths.forEach((function(t){var e=new FileReader;e.onload=function(e){var n=e.target.result,i=h.indexOf(t);d[i]=n,-1===d.indexOf(null)&&r({modelTopology:s,weightSpecs:c,weightData:Kc(d)})},e.onerror=function(e){return i("Failed to weights data from file of path '"+t+"'.")},e.readAsArrayBuffer(l[t])}))}))}else i(new Error("weightManifest field is missing from file "+t.name))}else i(new Error("modelTopology field is missing from file "+t.name))},o.onerror=function(e){return i("Failed to read model topology and weights manifest JSON from file '"+t.name+"'. BrowserFiles supports loading Keras-style tf.Model artifacts only.")},o.readAsText(t)}))]}))}))},t.prototype.checkManifestAndWeightFiles=function(t,e){for(var n=[],r=e.map((function(t){return Yc(t.name)})),i={},o=0,a=t;o<a.length;o++)a[o].paths.forEach((function(t){var o=Yc(t);if(-1!==n.indexOf(o))throw new Error("Duplicate file basename found in weights manifest: '"+o+"'");if(n.push(o),-1===r.indexOf(o))throw new Error("Weight file with basename '"+o+"' is not provided.");i[t]=e[r.indexOf(o)]}));if(n.length!==e.length)throw new Error("Mismatch in the number of files in weights manifest ("+n.length+") and the number of weight files provided ("+e.length+").");return i},t}();function Sh(t,e,n,r){!function(t){p(null!=t&&Array.isArray(t)&&t.length>0,(function(){return"promises must be a none empty array"}))}(t),function(t,e){p(t>=0&&t<=1,(function(){return"Progress fraction must be in range [0, 1], but got startFraction "+t})),p(e>=0&&e<=1,(function(){return"Progress fraction must be in range [0, 1], but got endFraction "+e})),p(e>=t,(function(){return"startFraction must be no more than endFraction, but got startFraction "+t+" and endFraction "+e}))}(n=null==n?0:n,r=null==r?1:r);var i=0;return Promise.all(t.map((function(o){return o.then((function(o){var a=n+ ++i/t.length*(r-n);return e(a),o})),o})))}function Eh(t,e){return o(this,void 0,void 0,(function(){var n,r,i,o,s,l,c,h,d;return a(this,(function(a){switch(a.label){case 0:return null==e&&(e={}),n=null==e.fetchFunc?u().platform.fetch:e.fetchFunc,r=t.map((function(t){return n(t,e.requestInit,{isBinary:!0})})),i=0,o=.5,null!=e.onProgress?[3,2]:[4,Promise.all(r)];case 1:return s=a.sent(),[3,4];case 2:return[4,Sh(r,e.onProgress,i,o)];case 3:s=a.sent(),a.label=4;case 4:return l=s.map((function(t){return t.arrayBuffer()})),c=.5,h=1,null!=e.onProgress?[3,6]:[4,Promise.all(l)];case 5:return d=a.sent(),[3,8];case 6:return[4,Sh(l,e.onProgress,c,h)];case 7:d=a.sent(),a.label=8;case 8:return[2,d]}}))}))}function Oh(t){var e=this;return function(n,r,i){return void 0===r&&(r=""),o(e,void 0,void 0,(function(){var e,o,s,u,l,c,h,d,f,p;return a(this,(function(a){switch(a.label){case 0:if(e=n.map((function(){return!1})),o={},s=null!=i?i.map((function(){return!1})):[],u=[],n.forEach((function(t,n){var r=0;t.weights.forEach((function(t){var a=Wc["quantization"in t?t.quantization.dtype:t.dtype]*v(t.shape),l=function(){e[n]=!0,null==o[n]&&(o[n]=[]),o[n].push({manifestEntry:t,groupOffset:r,sizeBytes:a})};null!=i?i.forEach((function(e,n){e===t.name&&(l(),s[n]=!0)})):l(),u.push(t.name),r+=a}))})),!s.every((function(t){return t})))throw l=i.filter((function(t,e){return!s[e]})),new Error("Could not find weights in manifest with names: "+l.join(", ")+". \nManifest JSON has weights with names: "+u.join(", ")+".");return c=e.reduce((function(t,e,n){return e&&t.push(n),t}),[]),h=[],c.forEach((function(t){n[t].paths.forEach((function(t){var e=r+(r.endsWith("/")?"":"/")+t;h.push(e)}))})),[4,t(h)];case 1:return d=a.sent(),f={},p=0,c.forEach((function(t){for(var e=n[t].paths.length,r=0,i=0;i<e;i++)r+=d[p+i].byteLength;for(var a=new ArrayBuffer(r),s=new Uint8Array(a),u=0,l=0;l<e;l++){var c=new Uint8Array(d[p+l]);s.set(c,u),u+=c.byteLength}o[t].forEach((function(t){var e=qc(a.slice(t.groupOffset,t.groupOffset+t.sizeBytes),[t.manifestEntry]);for(var n in e)f[n]=e[n]})),p+=e})),[2,f]}}))}))}}Qc.registerSaveRouter((function(t){return u().getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(Ch.URL_SCHEME)?(void 0===(e=t.slice(Ch.URL_SCHEME.length))&&(e="model"),new Ch(e)):null;var e}));var Ah=function(){function t(t,e){if(this.DEFAULT_METHOD="POST",null==e&&(e={}),this.weightPathPrefix=e.weightPathPrefix,this.onProgress=e.onProgress,null!=e.fetchFunc?(p("function"==typeof e.fetchFunc,(function(){return"Must pass a function that matches the signature of `fetch` (see https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API)"})),this.fetch=e.fetchFunc):this.fetch=u().platform.fetch,p(null!=t&&t.length>0,(function(){return"URL path for http must not be null, undefined or empty."})),Array.isArray(t)&&p(2===t.length,(function(){return"URL paths for http must have a length of 2, (actual length is "+t.length+")."})),this.path=t,null!=e.requestInit&&null!=e.requestInit.body)throw new Error("requestInit is expected to have no pre-existing body, but has one.");this.requestInit=e.requestInit||{}}return t.prototype.save=function(t){return o(this,void 0,void 0,(function(){var e,n;return a(this,(function(r){switch(r.label){case 0:if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserHTTPRequest.save() does not support saving model topology in binary formats yet.");return(e=Object.assign({method:this.DEFAULT_METHOD},this.requestInit)).body=new FormData,e.body.append("model.json",new Blob([JSON.stringify({modelTopology:t.modelTopology,format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,userDefinedMetadata:t.userDefinedMetadata,weightsManifest:[{paths:["./model.weights.bin"],weights:t.weightSpecs}]})],{type:"application/json"}),"model.json"),null!=t.weightData&&e.body.append("model.weights.bin",new Blob([t.weightData],{type:"application/octet-stream"}),"model.weights.bin"),[4,this.fetch(this.path,e)];case 1:if((n=r.sent()).ok)return[2,{modelArtifactsInfo:Zc(t),responses:[n]}];throw new Error("BrowserHTTPRequest.save() failed due to HTTP response status "+n.status+".")}}))}))},t.prototype.load=function(){return o(this,void 0,void 0,(function(){var t,e,n,r,i,o,s,u;return a(this,(function(a){switch(a.label){case 0:return[4,this.fetch(this.path,this.requestInit)];case 1:if(!(t=a.sent()).ok)throw new Error("Request to "+this.path+" failed with status code "+t.status+". Please verify this URL points to the model JSON of the model to load.");a.label=2;case 2:return a.trys.push([2,4,,5]),[4,t.json()];case 3:return e=a.sent(),[3,5];case 4:throw a.sent(),n="Failed to parse model JSON of response from "+this.path+".",this.path.endsWith(".pb")?n+=" Your path contains a .pb file extension. Support for .pb models have been removed in TensorFlow.js 1.0 in favor of .json models. You can re-convert your Python TensorFlow model using the TensorFlow.js 1.0 conversion scripts or you can convert your.pb models with the 'pb2json'NPM script in the tensorflow/tfjs-converter repository.":n+=" Please make sure the server is serving valid JSON for this request.",new Error(n);case 5:if(i=e.weightsManifest,null==(r=e.modelTopology)&&null==i)throw new Error("The JSON from HTTP path "+this.path+" contains neither model topology or manifest for weights.");return null==i?[3,7]:[4,this.loadWeights(i)];case 6:u=a.sent(),o=u[0],s=u[1],a.label=7;case 7:return[2,{modelTopology:r,weightSpecs:o,weightData:s}]}}))}))},t.prototype.loadWeights=function(t){return o(this,void 0,void 0,(function(){var e,n,r,i,o,s,u,l,c,h;return a(this,(function(a){switch(a.label){case 0:for(e=Array.isArray(this.path)?this.path[1]:this.path,n=function(t){var e=t.lastIndexOf("/"),n=t.lastIndexOf("?");return[t.substring(0,e)+"/",n>e?t.substring(n):""]}(e),r=n[0],i=n[1],o=this.weightPathPrefix||r,s=[],u=0,l=t;u<l.length;u++)s.push.apply(s,l[u].weights);return c=[],t.forEach((function(t){t.paths.forEach((function(t){c.push(o+t+i)}))})),[4,Eh(c,{requestInit:this.requestInit,fetchFunc:this.fetch,onProgress:this.onProgress})];case 1:return h=a.sent(),[2,[s,Kc(h)]]}}))}))},t.URL_SCHEME_REGEX=/^https?:\/\//,t}();function Nh(t){return null!=t.match(Ah.URL_SCHEME_REGEX)}var Th=function(t,e){return"undefined"==typeof fetch?null:(Array.isArray(t)?t.every((function(t){return Nh(t)})):Nh(t))?Dh(t,{onProgress:e}):null};function Dh(t,e){return new Ah(t,e)}Qc.registerSaveRouter(Th),Qc.registerLoadRouter(Th);var Rh=function(){function t(t){this.modelArtifacts=t}return t.prototype.load=function(){return o(this,void 0,void 0,(function(){return a(this,(function(t){return[2,this.modelArtifacts]}))}))},t}(),Ih=function(){function t(t){this.saveHandler=t}return t.prototype.save=function(t){return o(this,void 0,void 0,(function(){return a(this,(function(e){return[2,this.saveHandler(t)]}))}))},t}(),Mh=Object.freeze({browserFiles:function(t){return new kh(t)},browserHTTPRequest:function(t,e){return Dh(t,e)},concatenateArrayBuffers:Kc,decodeWeights:qc,encodeWeights:function(t,e){return o(this,void 0,void 0,(function(){var n,r,i,s,u,l=this;return a(this,(function(c){switch(c.label){case 0:for(n=[],r=[],i=Array.isArray(t)?t.map((function(t){return t.name})):Object.keys(t),s=function(s){var u=i[s],c=Array.isArray(t)?t[s].tensor:t[u];if("float32"!==c.dtype&&"int32"!==c.dtype&&"bool"!==c.dtype&&"string"!==c.dtype)throw new Error("Unsupported dtype in weight '"+u+"': "+c.dtype);var h={name:u,shape:c.shape,dtype:c.dtype};if("string"===c.dtype){var d=new Promise((function(t){return o(l,void 0,void 0,(function(){var e,n,r,i,o,s,u;return a(this,(function(a){switch(a.label){case 0:return[4,c.bytes()];case 1:for(e=a.sent(),n=e.reduce((function(t,e){return t+e.length}),0)+4*e.length,r=new Uint8Array(n),i=0,o=0;o<e.length;o++)s=e[o],u=new Uint8Array(new Uint32Array([s.length]).buffer),r.set(u,i),r.set(s,i+=4),i+=s.length;return t(r),[2]}}))}))}));r.push(d)}else r.push(c.data());null!=e&&(h.group=e),n.push(h)},u=0;u<i.length;++u)s(u);return[4,Promise.all(r)];case 1:return[2,{data:Hc(c.sent()),specs:n}]}}))}))},fromMemory:function(t,e,n,r){return 1===arguments.length?null!=t.modelTopology||null!=t.weightSpecs?new Rh(t):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new Rh({modelTopology:t})):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new Rh({modelTopology:t,weightSpecs:e,weightData:n,trainingConfig:r}))},getLoadHandlers:function(t,e){return Qc.getLoadHandlers(t,e)},getModelArtifactsInfoForJSON:Zc,getSaveHandlers:function(t){return Qc.getSaveHandlers(t)},http:Dh,isHTTPScheme:Nh,loadWeights:function(t,e,n,r){return void 0===e&&(e=""),o(this,void 0,void 0,(function(){return a(this,(function(i){return[2,Oh((function(t){return Eh(t,{requestInit:r})}))(t,e,n)]}))}))},registerLoadRouter:function(t){return Qc.registerLoadRouter(t)},registerSaveRouter:function(t){return Qc.registerSaveRouter(t)},weightsLoaderFactory:Oh,withSaveHandler:function(t){return new Ih(t)},copyModel:function(t,e){return o(this,void 0,void 0,(function(){return a(this,(function(n){return[2,nh(t,e,!1)]}))}))},listModels:function(){return o(this,void 0,void 0,(function(){var t,e,n,r,i,o,s;return a(this,(function(a){switch(a.label){case 0:t=th.getSchemes(),e={},n=0,r=t,a.label=1;case 1:return n<r.length?[4,th.getManager(i=r[n]).listModels()]:[3,4];case 2:for(s in o=a.sent())e[i+Jc+s]=o[s];a.label=3;case 3:return n++,[3,1];case 4:return[2,e]}}))}))},moveModel:function(t,e){return o(this,void 0,void 0,(function(){return a(this,(function(n){return[2,nh(t,e,!0)]}))}))},removeModel:function(t){return o(this,void 0,void 0,(function(){var e;return a(this,(function(n){return e=eh(t),[2,th.getManager(e.scheme).removeModel(e.path)]}))}))}}),Fh=fn({confusionMatrix_:function(t,e,n){var r=tn(t,"labels","confusionMatrix"),i=tn(e,"predictions","confusionMatrix");p(null==n||n>0&&Number.isInteger(n),(function(){return"If provided, numClasses must be a positive integer, but got "+n})),p(1===r.rank,(function(){return"Expected the rank of labels to be 1, but got "+r.rank})),p(1===i.rank,(function(){return"Expected the rank of predictions to be 1, but got "+i.rank})),p(r.shape[0]===i.shape[0],(function(){return"Mismatch in the number of examples: "+r.shape[0]+" vs. "+i.shape[0]+". Labels and predictions should have the same number of elements."})),p(n>0&&Number.isInteger(n),(function(){return"numClasses is required to be a positive integer, but got "+n}));var o=sr(r.asType("int32"),n),a=sr(i.asType("int32"),n);return o.transpose().matMul(a).asType("int32")}}),Ph=Object.freeze({confusionMatrix:Fh}),jh=fn({fromPixels_:function(t,e){if(void 0===e&&(e=3),e>4)throw new Error("Cannot construct Tensor with more than 4 channels from pixels.");var n="undefined"!=typeof HTMLVideoElement&&t instanceof HTMLVideoElement;if(n&&n&&t.readyState<2)throw new Error("The video element has not loaded data yet. Please wait for `loadeddata` event on the <video> element.");return St.fromPixels(t,e)}}),zh=Object.freeze({toPixels:function(t,e){return o(this,void 0,void 0,(function(){var n,r,i,o,s,u,l,c,h,d,f,p,m,g,y,v,b,w,x,_,C;return a(this,(function(a){switch(a.label){case 0:if(n=tn(t,"img","toPixels"),t instanceof st||(n=n.toInt()),2!==n.rank&&3!==n.rank)throw new Error("toPixels only supports rank 2 or 3 tensors, got rank "+n.rank+".");if(r=n.shape.slice(0,2),i=r[0],o=r[1],(s=2===n.rank?1:n.shape[2])>4||2===s)throw new Error("toPixels only supports depth of size 1, 3 or 4 but got "+s);return[4,n.data()];case 1:return u=a.sent(),l=n.min(),c=n.max(),[4,Promise.all([l.data(),c.data()])];case 2:if(h=a.sent(),d=h[0][0],f=h[1][0],l.dispose(),c.dispose(),"float32"===n.dtype){if(d<0||f>1)throw new Error("Tensor values for a float32 Tensor must be in the range [0 - 1] but got range ["+d+" - "+f+"].")}else{if("int32"!==n.dtype)throw new Error("Unsupported type for toPixels: "+n.dtype+". Please use float32 or int32 tensors.");if(d<0||f>255)throw new Error("Tensor values for a int32 Tensor must be in the range [0 - 255] but got range ["+d+" - "+f+"].")}for(p="float32"===n.dtype?255:1,m=new Uint8ClampedArray(o*i*4),g=0;g<i*o;++g)y=void 0,v=void 0,b=void 0,w=void 0,1===s?(y=u[g]*p,v=u[g]*p,b=u[g]*p,w=255):3===s?(y=u[3*g]*p,v=u[3*g+1]*p,b=u[3*g+2]*p,w=255):4===s&&(y=u[4*g]*p,v=u[4*g+1]*p,b=u[4*g+2]*p,w=u[4*g+3]*p),m[0+(x=4*g)]=Math.round(y),m[x+1]=Math.round(v),m[x+2]=Math.round(b),m[x+3]=Math.round(w);return null!=e&&(e.width=o,e.height=i,_=e.getContext("2d"),C=new ImageData(m,o,i),_.putImageData(C,0,0)),n!==t&&n.dispose(),[2,m]}}))}))},fromPixels:jh}),Lh=function(){function t(){}return t.prototype.getClassName=function(){return this.constructor.className},t.fromConfig=function(t,e){return new t(e)},t}(),Bh=function(){function t(){this.classNameMap={}}return t.getMap=function(){return null==t.instance&&(t.instance=new t),t.instance},t.register=function(e){t.getMap().classNameMap[e.className]=[e,e.fromConfig]},t}();function Uh(t){p(null!=t.className,(function(){return"Class being registered does not have the static className property defined."})),p("string"==typeof t.className,(function(){return"className is required to be a string, but got type "+typeof t.className})),p(t.className.length>0,(function(){return"Class being registered has an empty-string as its className, which is disallowed."})),Bh.register(t)}var $h=Object.freeze({Serializable:Lh,SerializationMap:Bh,registerClass:Uh});function Vh(){return 32===St.backend.floatPrecision()?.001:.1}function Wh(t,e,n){var r=!0;if((I(t)||I(e))&&(r=!1),I(t)&&I(e)&&(r=!0),r){var i=t.constructor.name,o=e.constructor.name;if(i!==o)throw new Error("Arrays are of different type. Actual: "+i+". Expected: "+o)}if(Array.isArray(t)&&Array.isArray(e)){var a=Qe(t),s=Qe(e);if(!b(a,s))throw new Error("Arrays have different shapes. Actual: ["+a+"]. Expected: ["+s+"]")}var u=I(t)?t:y(t),l=I(e)?e:y(e);if(u.length!==l.length)throw new Error("Arrays have different lengths actual: "+u.length+" vs expected: "+l.length+".\nActual:   "+u+".\nExpected: "+l+".");for(var c=0;c<l.length;++c){var h=u[c],d=l[c];if(!n(h,d))throw new Error("Arrays differ: actual["+c+"] = "+h+", expected["+c+"] = "+d+".\nActual:   "+u+".\nExpected: "+l+".")}}function qh(t,e,n){return!isFinite(t)&&!isFinite(e)||!(isNaN(t)||isNaN(e)||Math.abs(t-e)>n)}var Hh=Object.freeze({TEST_EPSILON_FLOAT16:.1,expectArraysClose:function(t,e,n){return null==n&&(n=Vh()),Wh(t,e,(function(t,e){return qh(t,e,n)}))},testEpsilon:Vh,expectPromiseToFail:function(t,e){t().then((function(){return e.fail()}),(function(){return e()}))},expectArraysEqual:function(t,e){var n="string"==typeof e||"number"==typeof e||"boolean"==typeof e?[e]:e;return P(t)||P(t[0])||P(e)||P(e[0])?Wh(t,n,(function(t,e){return t==e})):Wh(t,e,(function(t,e){return qh(t,e,0)}))},expectNumbersClose:function(t,e,n){if(null==n&&(n=Vh()),!qh(t,e,n))throw new Error("Numbers differ: actual === "+t+", expected === "+e)},expectValuesInRange:function(t,e,n){for(var r=0;r<t.length;r++)if(t[r]<e||t[r]>n)throw new Error("Value out of range:"+t[r]+" low: "+e+", high: "+n)},expectArrayBuffersEqual:function(t,e){expect(new Float32Array(t)).toEqual(new Float32Array(e))}}),Gh="1.2.11",Xh=Object.freeze({gpgpu_util:ta,webgl_util:Ae,forceHalfFloat:function(){u().set("WEBGL_FORCE_F16_TEXTURES",!0)},MathBackendWebGL:is,setWebGLContext:Rt,GPGPUContext:ea}),Kh=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.minimize=function(t,e,n){void 0===e&&(e=!1);var r=this.computeGradients(t,n),i=r.value,o=r.grads;if(null!=n){var a=n.map((function(t){return{name:t.name,tensor:o[t.name]}}));this.applyGradients(a)}else this.applyGradients(o);return Le(o),e?i:(i.dispose(),null)},Object.defineProperty(e.prototype,"iterations",{get:function(){return null==this.iterations_&&(this.iterations_=0),this.iterations_},enumerable:!0,configurable:!0}),e.prototype.incrementIterations=function(){this.iterations_=this.iterations+1},e.prototype.computeGradients=function(t,e){return Vr(t,e)},e.prototype.dispose=function(){null!=this.iterations_&&Le(this.iterations_)},e.prototype.saveIterations=function(){return o(this,void 0,void 0,(function(){return a(this,(function(t){return null==this.iterations_&&(this.iterations_=0),[2,{name:"iter",tensor:bn(this.iterations_,"int32")}]}))}))},e.prototype.getWeights=function(){return o(this,void 0,void 0,(function(){return a(this,(function(t){throw new Error("getWeights() is not implemented for this optimizer yet.")}))}))},e.prototype.setWeights=function(t){return o(this,void 0,void 0,(function(){return a(this,(function(t){throw new Error("setWeights() is not implemented for this optimizer class "+this.getClassName())}))}))},e.prototype.extractIterations=function(t){return o(this,void 0,void 0,(function(){var e;return a(this,(function(n){switch(n.label){case 0:return e=this,[4,t[0].tensor.data()];case 1:return e.iterations_=n.sent()[0],[2,t.slice(1)]}}))}))},e}(Lh);Object.defineProperty(Kh,Symbol.hasInstance,{value:function(t){return null!=t.minimize&&null!=t.computeGradients&&null!=t.applyGradients}});var Yh=function(t){function e(e,n,r){void 0===r&&(r=null);var i=t.call(this)||this;return i.learningRate=e,i.rho=n,i.epsilon=r,i.accumulatedGrads=[],i.accumulatedUpdates=[],null==r&&(i.epsilon=St.backend.epsilon()),i}return i(e,t),e.prototype.applyGradients=function(t){var e=this;(Array.isArray(t)?t.map((function(t){return t.name})):Object.keys(t)).forEach((function(n,r){var i=St.registeredVariables[n];null==e.accumulatedGrads[r]&&(e.accumulatedGrads[r]={originalName:n+"/accum_grad",variable:ze((function(){return Rn(i).variable(!1)}))}),null==e.accumulatedUpdates[r]&&(e.accumulatedUpdates[r]={originalName:n+"/accum_var",variable:ze((function(){return Rn(i).variable(!1)}))});var o=Array.isArray(t)?t[r].tensor:t[n];if(null!=o){var a=e.accumulatedGrads[r].variable,s=e.accumulatedUpdates[r].variable;ze((function(){var t=a.mul(e.rho).add(o.square().mul(1-e.rho)),n=s.add(e.epsilon).sqrt().div(a.add(e.epsilon).sqrt()).mul(o),r=s.mul(e.rho).add(n.square().mul(1-e.rho));a.assign(t),s.assign(r);var u=n.mul(-e.learningRate).add(i);i.assign(u)}))}})),this.incrementIterations()},e.prototype.dispose=function(){null!=this.accumulatedUpdates&&(Le(this.accumulatedGrads.map((function(t){return t.variable}))),Le(this.accumulatedUpdates.map((function(t){return t.variable}))))},e.prototype.getWeights=function(){return o(this,void 0,void 0,(function(){var t;return a(this,(function(e){switch(e.label){case 0:return t=this.accumulatedGrads.concat(this.accumulatedUpdates),[4,this.saveIterations()];case 1:return[2,[e.sent()].concat(t.map((function(t){return{name:t.originalName,tensor:t.variable}})))]}}))}))},e.prototype.setWeights=function(t){return o(this,void 0,void 0,(function(){var e;return a(this,(function(n){switch(n.label){case 0:return[4,this.extractIterations(t)];case 1:return t=n.sent(),this.accumulatedGrads=t.slice(0,e=t.length/2).map((function(t){return{originalName:t.name,variable:t.tensor.variable(!1)}})),this.accumulatedUpdates=t.slice(e,2*e).map((function(t){return{originalName:t.name,variable:t.tensor.variable(!1)}})),[2]}}))}))},e.prototype.getConfig=function(){return{learningRate:this.learningRate,rho:this.rho,epsilon:this.epsilon}},e.fromConfig=function(t,e){return new t(e.learningRate,e.rho,e.epsilon)},e.className="Adadelta",e}(Kh);Uh(Yh);var Zh=function(t){function e(e,n){void 0===n&&(n=.1);var r=t.call(this)||this;return r.learningRate=e,r.initialAccumulatorValue=n,r.accumulatedGrads=[],r}return i(e,t),e.prototype.applyGradients=function(t){var e=this;(Array.isArray(t)?t.map((function(t){return t.name})):Object.keys(t)).forEach((function(n,r){var i=St.registeredVariables[n];null==e.accumulatedGrads[r]&&(e.accumulatedGrads[r]={originalName:n+"/accumulator",variable:ze((function(){return An(i.shape,e.initialAccumulatorValue).variable(!1)}))});var o=Array.isArray(t)?t[r].tensor:t[n];if(null!=o){var a=e.accumulatedGrads[r].variable;ze((function(){var t=a.add(o.square());a.assign(t);var n=o.div(t.add(St.backend.epsilon()).sqrt()).mul(-e.learningRate).add(i);i.assign(n)}))}})),this.incrementIterations()},e.prototype.dispose=function(){null!=this.accumulatedGrads&&Le(this.accumulatedGrads.map((function(t){return t.variable})))},e.prototype.getWeights=function(){return o(this,void 0,void 0,(function(){return a(this,(function(t){switch(t.label){case 0:return[4,this.saveIterations()];case 1:return[2,[t.sent()].concat(this.accumulatedGrads.map((function(t){return{name:t.originalName,tensor:t.variable}})))]}}))}))},e.prototype.setWeights=function(t){return o(this,void 0,void 0,(function(){return a(this,(function(e){switch(e.label){case 0:return[4,this.extractIterations(t)];case 1:return t=e.sent(),this.accumulatedGrads=t.map((function(t){return{originalName:t.name,variable:t.tensor.variable(!1)}})),[2]}}))}))},e.prototype.getConfig=function(){return{learningRate:this.learningRate,initialAccumulatorValue:this.initialAccumulatorValue}},e.fromConfig=function(t,e){return new t(e.learningRate,e.initialAccumulatorValue)},e.className="Adagrad",e}(Kh);Uh(Zh);var Qh=function(t){function e(e,n,r,i){void 0===i&&(i=null);var o=t.call(this)||this;return o.learningRate=e,o.beta1=n,o.beta2=r,o.epsilon=i,o.accumulatedFirstMoment=[],o.accumulatedSecondMoment=[],ze((function(){o.accBeta1=bn(n).variable(),o.accBeta2=bn(r).variable()})),null==i&&(o.epsilon=St.backend.epsilon()),o}return i(e,t),e.prototype.applyGradients=function(t){var e=this,n=Array.isArray(t)?t.map((function(t){return t.name})):Object.keys(t);ze((function(){var r=Su(1,e.accBeta1),i=Su(1,e.accBeta2);n.forEach((function(n,o){var a=St.registeredVariables[n];null==e.accumulatedFirstMoment[o]&&(e.accumulatedFirstMoment[o]={originalName:n+"/m",variable:ze((function(){return Rn(a).variable(!1)}))}),null==e.accumulatedSecondMoment[o]&&(e.accumulatedSecondMoment[o]={originalName:n+"/v",variable:ze((function(){return Rn(a).variable(!1)}))});var s=Array.isArray(t)?t[o].tensor:t[n];if(null!=s){var u=e.accumulatedFirstMoment[o].variable,l=e.accumulatedSecondMoment[o].variable,c=u.mul(e.beta1).add(s.mul(1-e.beta1)),h=l.mul(e.beta2).add(s.square().mul(1-e.beta2)),d=c.div(r),f=h.div(i);u.assign(c),l.assign(h);var p=d.div(f.sqrt().add(e.epsilon)).mul(-e.learningRate).add(a);a.assign(p)}})),e.accBeta1.assign(e.accBeta1.mul(e.beta1)),e.accBeta2.assign(e.accBeta2.mul(e.beta2))})),this.incrementIterations()},e.prototype.dispose=function(){this.accBeta1.dispose(),this.accBeta2.dispose(),null!=this.accumulatedFirstMoment&&Le(this.accumulatedFirstMoment.map((function(t){return t.variable}))),null!=this.accumulatedSecondMoment&&Le(this.accumulatedSecondMoment.map((function(t){return t.variable})))},e.prototype.getWeights=function(){return o(this,void 0,void 0,(function(){var t;return a(this,(function(e){switch(e.label){case 0:return t=this.accumulatedFirstMoment.concat(this.accumulatedSecondMoment),[4,this.saveIterations()];case 1:return[2,[e.sent()].concat(t.map((function(t){return{name:t.originalName,tensor:t.variable}})))]}}))}))},e.prototype.setWeights=function(t){return o(this,void 0,void 0,(function(){var e,n=this;return a(this,(function(r){switch(r.label){case 0:return[4,this.extractIterations(t)];case 1:return t=r.sent(),ze((function(){n.accBeta1.assign(xu(n.beta1,n.iterations_+1)),n.accBeta2.assign(xu(n.beta2,n.iterations_+1))})),this.accumulatedFirstMoment=t.slice(0,e=t.length/2).map((function(t){return{originalName:t.name,variable:t.tensor.variable(!1)}})),this.accumulatedSecondMoment=t.slice(e,2*e).map((function(t){return{originalName:t.name,variable:t.tensor.variable(!1)}})),[2]}}))}))},e.prototype.getConfig=function(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon}},e.fromConfig=function(t,e){return new t(e.learningRate,e.beta1,e.beta2,e.epsilon)},e.className="Adam",e}(Kh);Uh(Qh);var Jh=function(t){function e(e,n,r,i,o){void 0===i&&(i=null),void 0===o&&(o=0);var a=t.call(this)||this;return a.learningRate=e,a.beta1=n,a.beta2=r,a.epsilon=i,a.decay=o,a.accumulatedFirstMoment=[],a.accumulatedWeightedInfNorm=[],ze((function(){a.iteration=bn(0).variable(),a.accBeta1=bn(n).variable()})),null==i&&(a.epsilon=St.backend.epsilon()),a}return i(e,t),e.prototype.applyGradients=function(t){var e=this,n=Array.isArray(t)?t.map((function(t){return t.name})):Object.keys(t);ze((function(){var r=Su(1,e.accBeta1),i=cu(-e.learningRate,e.iteration.mul(e.decay).add(1));n.forEach((function(n,o){var a=St.registeredVariables[n];null==e.accumulatedFirstMoment[o]&&(e.accumulatedFirstMoment[o]={originalName:n+"/m",variable:Rn(a).variable(!1)}),null==e.accumulatedWeightedInfNorm[o]&&(e.accumulatedWeightedInfNorm[o]={originalName:n+"/v",variable:Rn(a).variable(!1)});var s=Array.isArray(t)?t[o].tensor:t[n];if(null!=s){var u=e.accumulatedFirstMoment[o].variable,l=e.accumulatedWeightedInfNorm[o].variable,c=u.mul(e.beta1).add(s.mul(1-e.beta1)),h=l.mul(e.beta2),d=s.abs(),f=h.maximum(d);u.assign(c),l.assign(f);var p=i.div(r).mul(c.div(f.add(e.epsilon))).add(a);a.assign(p)}})),e.iteration.assign(e.iteration.add(1)),e.accBeta1.assign(e.accBeta1.mul(e.beta1))})),this.incrementIterations()},e.prototype.dispose=function(){this.accBeta1.dispose(),this.iteration.dispose(),null!=this.accumulatedFirstMoment&&Le(this.accumulatedFirstMoment.map((function(t){return t.variable}))),null!=this.accumulatedWeightedInfNorm&&Le(this.accumulatedWeightedInfNorm.map((function(t){return t.variable})))},e.prototype.getWeights=function(){return o(this,void 0,void 0,(function(){return a(this,(function(t){throw new Error("getWeights() is not implemented for Adamax yet.")}))}))},e.prototype.setWeights=function(t){return o(this,void 0,void 0,(function(){return a(this,(function(t){throw new Error("setWeights() is not implemented for Adamax yet.")}))}))},e.prototype.getConfig=function(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon,decay:this.decay}},e.fromConfig=function(t,e){return new t(e.learningRate,e.beta1,e.beta2,e.epsilon,e.decay)},e.className="Adamax",e}(Kh);Uh(Jh);var td=function(t){function e(e){var n=t.call(this)||this;return n.learningRate=e,n.setLearningRate(e),n}return i(e,t),e.prototype.applyGradients=function(t){var e=this;(Array.isArray(t)?t.map((function(t){return t.name})):Object.keys(t)).forEach((function(n,r){var i=Array.isArray(t)?t[r].tensor:t[n];if(null!=i){var o=St.registeredVariables[n];ze((function(){var t=e.c.mul(i).add(o);o.assign(t)}))}})),this.incrementIterations()},e.prototype.setLearningRate=function(t){this.learningRate=t,null!=this.c&&this.c.dispose(),this.c=Be(bn(-t))},e.prototype.dispose=function(){this.c.dispose()},e.prototype.getWeights=function(){return o(this,void 0,void 0,(function(){return a(this,(function(t){switch(t.label){case 0:return[4,this.saveIterations()];case 1:return[2,[t.sent()]]}}))}))},e.prototype.setWeights=function(t){return o(this,void 0,void 0,(function(){return a(this,(function(e){switch(e.label){case 0:return[4,this.extractIterations(t)];case 1:if(0!==(t=e.sent()).length)throw new Error("SGD optimizer does not have settable weights.");return[2]}}))}))},e.prototype.getConfig=function(){return{learningRate:this.learningRate}},e.fromConfig=function(t,e){return new t(e.learningRate)},e.className="SGD",e}(Kh);Uh(td);var ed=function(t){function e(e,n,r){void 0===r&&(r=!1);var i=t.call(this,e)||this;return i.learningRate=e,i.momentum=n,i.useNesterov=r,i.accumulations=[],i.m=bn(i.momentum),i}return i(e,t),e.prototype.applyGradients=function(t){var e=this;(Array.isArray(t)?t.map((function(t){return t.name})):Object.keys(t)).forEach((function(n,r){var i=St.registeredVariables[n];null==e.accumulations[r]&&(e.accumulations[r]={originalName:n+"/momentum",variable:ze((function(){return Rn(i).variable(!1)}))});var o=e.accumulations[r].variable,a=Array.isArray(t)?t[r].tensor:t[n];null!=a&&ze((function(){var t,n=e.m.mul(o).add(a);t=e.useNesterov?e.c.mul(a.add(n.mul(e.m))).add(i):e.c.mul(n).add(i),o.assign(n),i.assign(t)}))})),this.incrementIterations()},e.prototype.dispose=function(){this.m.dispose(),null!=this.accumulations&&Le(this.accumulations.map((function(t){return t.variable})))},e.prototype.setMomentum=function(t){this.momentum=t},e.prototype.getWeights=function(){return o(this,void 0,void 0,(function(){return a(this,(function(t){switch(t.label){case 0:return[4,this.saveIterations()];case 1:return[2,[t.sent()].concat(this.accumulations.map((function(t){return{name:t.originalName,tensor:t.variable}})))]}}))}))},e.prototype.setWeights=function(t){return o(this,void 0,void 0,(function(){return a(this,(function(e){switch(e.label){case 0:return[4,this.extractIterations(t)];case 1:return t=e.sent(),this.accumulations=t.map((function(t){return{originalName:t.name,variable:t.tensor.variable(!1)}})),[2]}}))}))},e.prototype.getConfig=function(){return{learningRate:this.learningRate,momentum:this.momentum,useNesterov:this.useNesterov}},e.fromConfig=function(t,e){return new t(e.learningRate,e.momentum,e.useNesterov)},e.className="Momentum",e}(td);Uh(ed);var nd=function(t){function e(e,n,r,i,o){void 0===n&&(n=.9),void 0===r&&(r=0),void 0===i&&(i=null),void 0===o&&(o=!1);var a=t.call(this)||this;return a.learningRate=e,a.decay=n,a.momentum=r,a.epsilon=i,a.accumulatedMeanSquares=[],a.accumulatedMoments=[],a.accumulatedMeanGrads=[],a.centered=o,null==i&&(a.epsilon=St.backend.epsilon()),a}return i(e,t),e.prototype.applyGradients=function(t){var e=this;(Array.isArray(t)?t.map((function(t){return t.name})):Object.keys(t)).forEach((function(n,r){var i=St.registeredVariables[n];null==e.accumulatedMeanSquares[r]&&(e.accumulatedMeanSquares[r]={originalName:n+"/rms",variable:ze((function(){return Rn(i).variable(!1)}))}),null==e.accumulatedMoments[r]&&(e.accumulatedMoments[r]={originalName:n+"/momentum",variable:ze((function(){return Rn(i).variable(!1)}))}),null==e.accumulatedMeanGrads[r]&&e.centered&&(e.accumulatedMeanGrads[r]={originalName:n+"/mg",variable:ze((function(){return Rn(i).variable(!1)}))});var o=Array.isArray(t)?t[r].tensor:t[n];if(null!=o){var a=e.accumulatedMeanSquares[r].variable,s=e.accumulatedMoments[r].variable;ze((function(){var t=a.mul(e.decay).add(o.square().mul(1-e.decay));if(e.centered){var n=e.accumulatedMeanGrads[r].variable,u=n.mul(e.decay).add(o.mul(1-e.decay)),l=s.mul(e.momentum).add(o.mul(e.learningRate).div(t.sub(u.square().add(e.epsilon)).sqrt()));a.assign(t),n.assign(u),s.assign(l);var c=i.sub(l);i.assign(c)}else{var h=a.mul(e.decay).add(o.square().mul(1-e.decay));l=s.mul(e.momentum).add(o.mul(e.learningRate).div(h.add(e.epsilon).sqrt())),a.assign(h),s.assign(l),c=i.sub(l),i.assign(c)}}))}})),this.incrementIterations()},e.prototype.dispose=function(){null!=this.accumulatedMeanSquares&&Le(this.accumulatedMeanSquares.map((function(t){return t.variable}))),null!=this.accumulatedMeanGrads&&this.centered&&Le(this.accumulatedMeanGrads.map((function(t){return t.variable}))),null!=this.accumulatedMoments&&Le(this.accumulatedMoments.map((function(t){return t.variable})))},e.prototype.getWeights=function(){return o(this,void 0,void 0,(function(){var t;return a(this,(function(e){switch(e.label){case 0:return t=this.accumulatedMeanSquares.concat(this.accumulatedMoments),this.centered&&t.push.apply(t,this.accumulatedMeanGrads),[4,this.saveIterations()];case 1:return[2,[e.sent()].concat(t.map((function(t){return{name:t.originalName,tensor:t.variable}})))]}}))}))},e.prototype.setWeights=function(t){return o(this,void 0,void 0,(function(){var e;return a(this,(function(n){switch(n.label){case 0:return[4,this.extractIterations(t)];case 1:return t=n.sent(),this.accumulatedMeanSquares=t.slice(0,e=this.centered?t.length/3:t.length/2).map((function(t){return{originalName:t.name,variable:t.tensor.variable(!1)}})),this.accumulatedMoments=t.slice(e,2*e).map((function(t){return{originalName:t.name,variable:t.tensor.variable(!1)}})),this.centered&&(this.accumulatedMeanGrads=t.slice(2*e,3*e).map((function(t){return{originalName:t.name,variable:t.tensor.variable(!1)}}))),[2]}}))}))},e.prototype.getConfig=function(){return{learningRate:this.learningRate,decay:this.decay,momentum:this.momentum,epsilon:this.epsilon,centered:this.centered}},e.fromConfig=function(t,e){return new t(e.learningRate,e.decay,e.momentum,e.epsilon,e.centered)},e.className="RMSProp",e}(Kh);Uh(nd);var rd=function(){function t(){}return t.sgd=function(t){return new td(t)},t.momentum=function(t,e,n){return void 0===n&&(n=!1),new ed(t,e,n)},t.rmsprop=function(t,e,n,r,i){return void 0===e&&(e=.9),void 0===n&&(n=0),void 0===r&&(r=null),void 0===i&&(i=!1),new nd(t,e,n,r,i)},t.adam=function(t,e,n,r){return void 0===t&&(t=.001),void 0===e&&(e=.9),void 0===n&&(n=.999),void 0===r&&(r=null),new Qh(t,e,n,r)},t.adadelta=function(t,e,n){return void 0===t&&(t=.001),void 0===e&&(e=.95),void 0===n&&(n=null),new Yh(t,e,n)},t.adamax=function(t,e,n,r,i){return void 0===t&&(t=.002),void 0===e&&(e=.9),void 0===n&&(n=.999),void 0===r&&(r=null),void 0===i&&(i=0),new Jh(t,e,n,r,i)},t.adagrad=function(t,e){return void 0===e&&(e=.1),new Zh(t,e)},t}(),id={sgd:rd.sgd,momentum:rd.momentum,adadelta:rd.adadelta,adagrad:rd.adagrad,rmsprop:rd.rmsprop,adamax:rd.adamax,adam:rd.adam},od="undefined"!=typeof requestAnimationFrame?requestAnimationFrame:"undefined"!=typeof setImmediate?setImmediate:function(t){return t()};function ad(){return new Promise((function(t){return od((function(){return t()}))}))}ot=zc},"Rz+p":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t){return(0,i.default)(t)};var r,i=(r=n("MAmL"))&&r.__esModule?r:{default:r};t.exports=e.default},SDpH:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.StyleSheet=c;var r,i=(r=n("MgzW"))&&r.__esModule?r:{default:r};function o(t){return t[t.length-1]}function a(t){if(t.sheet)return t.sheet;for(var e=0;e<document.styleSheets.length;e++)if(document.styleSheets[e].ownerNode===t)return document.styleSheets[e]}var s="undefined"!=typeof window,u=function(){if(s){var t=document.createElement("div");return t.innerHTML="\x3c!--[if lt IE 10]><i></i><![endif]--\x3e",1===t.getElementsByTagName("i").length}}();function l(){var t=document.createElement("style");return t.type="text/css",t.setAttribute("data-glamor",""),t.appendChild(document.createTextNode("")),(document.head||document.getElementsByTagName("head")[0]).appendChild(t),t}function c(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.speedy,n=void 0===e||e,r=t.maxLength,i=void 0===r?s&&u?4e3:65e3:r;this.isSpeedy=n,this.sheet=void 0,this.tags=[],this.maxLength=i,this.ctr=0}(0,i.default)(c.prototype,{getSheet:function(){return a(o(this.tags))},inject:function(){var t=this;if(this.injected)throw new Error("already injected stylesheet!");s?this.tags[0]=l():this.sheet={cssRules:[],insertRule:function(e){t.sheet.cssRules.push({cssText:e})}},this.injected=!0},speedy:function(t){if(0!==this.ctr)throw new Error("cannot change speedy mode after inserting any rule to sheet. Either call speedy("+t+") earlier in your app, or call flush() before speedy("+t+")");this.isSpeedy=!!t},_insert:function(t){try{var e=this.getSheet();e.insertRule(t,-1!==t.indexOf("@import")?0:e.cssRules.length)}catch(n){}},insert:function(t){if(s)if(this.isSpeedy&&this.getSheet().insertRule)this._insert(t);else if(-1!==t.indexOf("@import")){var e=o(this.tags);e.insertBefore(document.createTextNode(t),e.firstChild)}else o(this.tags).appendChild(document.createTextNode(t));else this.sheet.insertRule(t,-1!==t.indexOf("@import")?0:this.sheet.cssRules.length);return this.ctr++,s&&this.ctr%this.maxLength==0&&this.tags.push(l()),this.ctr-1},delete:function(t){return this.replace(t,"")},flush:function(){s?(this.tags.forEach((function(t){return t.parentNode.removeChild(t)})),this.tags=[],this.sheet=null,this.ctr=0):this.sheet.cssRules=[],this.injected=!1},rules:function(){if(!s)return this.sheet.cssRules;var t=[];return this.tags.forEach((function(e){return t.splice.apply(t,[t.length,0].concat(function(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}(Array.from(a(e).cssRules))))})),t}})},SFYy:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t){return t.charAt(0).toUpperCase()+t.slice(1)},t.exports=e.default},VMJL:function(t,e,n){const r=n("xfvg"),i=n("dtu/"),o=n("7sNm"),a=n("Dknc"),s=n("JCZO"),u=n("bdwG");t.exports=(t,e,n,l)=>{switch(e){case"===":return"object"==typeof t&&(t=t.version),"object"==typeof n&&(n=n.version),t===n;case"!==":return"object"==typeof t&&(t=t.version),"object"==typeof n&&(n=n.version),t!==n;case"":case"=":case"==":return r(t,n,l);case"!=":return i(t,n,l);case">":return o(t,n,l);case">=":return a(t,n,l);case"<":return s(t,n,l);case"<=":return u(t,n,l);default:throw new TypeError("Invalid operator: "+e)}}},Vinz:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=n("rWgG"),i=n("/TIM"),o=n("Ad6o"),a=n("jke5");e.table=function(t,e,n={}){if(e&&null==e.headers)throw new Error('Data to render must have a "headers" property');if(e&&null==e.values)throw new Error('Data to render must have a "values" property');const u=a.getDrawArea(t),l=Object.assign({},s,n);let c=i.select(u).select("table.tf-table");const h=o.css({fontSize:l.fontSize||".875rem",width:"100%",maxWidth:"64rem",marginRight:"auto",marginLeft:"auto"});if(0===c.size()&&(c=i.select(u).append("table"),c.attr("class",` ${h} tf-table`),c.append("thead").append("tr"),c.append("tbody")),1!==c.size())throw new Error("Error inserting table");const d=o.css({fontWeight:"600",borderBottomStyle:"solid",borderBottomWidth:"1px",borderColor:"rgba( 0, 0, 0, .2 )",textAlign:"left",paddingBottom:"1rem",paddingRight:"1rem",backgroundColor:"#fff"}),f=c.select("thead").select("tr").selectAll("th").data(e.headers),p=f.enter().append("th").attr("class",""+d);f.merge(p).html(t=>t),f.exit().remove();const m=r.format(",.4~f"),g=c.select("tbody").selectAll("tr").data(e.values),y=g.enter().append("tr"),v=o.css({padding:"0.25rem",borderBottomStyle:"solid",borderBottomWidth:"1px",borderColor:"rgba( 0, 0, 0, .2 )"}),b=g.merge(y).selectAll("td").data(t=>t),w=b.enter().append("td").attr("class",""+v);b.merge(w).html(t=>"number"==typeof t?m(t):t),b.exit().remove(),g.exit().remove()};const s={fontSize:14}},VmpX:function(t,e,n){const r=n("0eLh");t.exports=(t,e,n)=>r(t,e,">",n)},YJ14:function(t,e,n){const r=n("3wIk");t.exports=(t,e)=>new r(t,e).minor},YYB2:function(t,e,n){"use strict";function r(t,e){if(!t)throw new Error("string"==typeof e?e:e())}function i(t,e){if(t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0}Object.defineProperty(e,"__esModule",{value:!0}),e.assert=r,e.assertShapesMatch=function(t,e,n=""){r(i(t,e),n+` Shapes ${t} and ${e} must match`)},e.arraysEqual=i,e.DECIMAL_PLACES_TO_CHECK=4},Ybu3:function(t,e,n){const{MAX_LENGTH:r}=n("/kWe"),{re:i,t:o}=n("IsDc"),a=n("3wIk");t.exports=(t,e)=>{if(e&&"object"==typeof e||(e={loose:!!e,includePrerelease:!1}),t instanceof a)return t;if("string"!=typeof t)return null;if(t.length>r)return null;if(!(e.loose?i[o.LOOSE]:i[o.FULL]).test(t))return null;try{return new a(t,e)}catch(n){return null}}},Yn5A:function(t,e,n){const r=n("Ybu3"),i=n("xfvg");t.exports=(t,e)=>{if(i(t,e))return null;{const n=r(t),i=r(e),o=n.prerelease.length||i.prerelease.length,a=o?"pre":"",s=o?"prerelease":"";for(const t in n)if(("major"===t||"minor"===t||"patch"===t)&&n[t]!==i[t])return a+t;return s}}},Z6Kp:function(t,e,n){"use strict";var r=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(e){o(e)}}function s(t){try{u(r.throw(t))}catch(e){o(e)}}function u(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(a,s)}u((r=r.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0});const i=n("h1ZQ"),o=n("jke5"),a=n("Vinz"),s=n("Ewl0"),u=n("QUk2");function l(t){let e;return e=Array.isArray(t.outputShape[0])?`[${t.outputShape.map(t=>c(t)).join(", ")}]`:c(t.outputShape),{name:t.name,trainable:t.trainable,parameters:t.countParams(),outputShape:e}}function c(t){const e=t.slice();return 0===e.length?"Scalar":(null===e[0]&&(e[0]="batch"),`[${e.join(",")}]`)}e.modelSummary=function(t,e){return r(this,void 0,void 0,(function*(){const n=o.getDrawArea(t),r=function(t){return{layers:t.layers.map(l)}}(e).layers.map(t=>[t.name,t.outputShape,t.parameters,t.trainable]);a.table(n,{headers:["Layer Name","Output Shape","# Of Params","Trainable"],values:r})}))},e.layer=function(t,e){return r(this,void 0,void 0,(function*(){const n=o.getDrawArea(t),l=yield function(t){return r(this,void 0,void 0,(function*(){const e=t.getWeights(),n=t.weights,r=e.map(u.tensorStats),i=yield Promise.all(r),o=e.map(t=>t.shape);return e.map((t,e)=>({name:n[e].name,stats:i[e],shape:c(o[e]),weight:t}))}))}(e),h=s.subSurface(n,"layer-weights-info"),d=l.map(t=>[t.name,t.shape,t.stats.min,t.stats.max,t.weight.size,t.stats.numZeros,t.stats.numNans,t.stats.numInfs]);a.table(h,{headers:["Weight Name","Shape","Min","Max","# Params","# Zeros","# NaNs","# Infinity"],values:d});const f=s.subSurface(n,"select-layer"),p=s.subSurface(n,"param-distribution");!function(t,e,n){const r=`\n    <select>\n      ${t.map(t=>`<option value=${t}>${t}</option>`)}\n    </select>\n  `;e.innerHTML=`<div><button>Show Values Distribution for:</button>${r}</div>`;const i=e.querySelector("button"),o=e.querySelector("select");i.addEventListener("click",()=>{n(o.selectedOptions[0].label)})}(l.map(t=>t.name),f,t=>r(this,void 0,void 0,(function*(){const e=l.filter(e=>e.name===t)[0],n=yield e.weight.data();i.histogram(p,n,{height:150,width:460,stats:!1})})))}))}},ZYJ9:function(t,e,n){"use strict";var r=/("(?:[^\\"]|\\.)*")|[:,]/g;t.exports=function(t,e){var n,i,o;return e=e||{},n=JSON.stringify([1],void 0,void 0===e.indent?2:e.indent).slice(2,-3),i=""===n?1/0:void 0===e.maxLength?80:e.maxLength,o=e.replacer,function t(e,a,s){var u,l,c,h,d,f,p,m,g,y,v,b;if(e&&"function"==typeof e.toJSON&&(e=e.toJSON()),void 0===(v=JSON.stringify(e,o)))return v;if(v.length<=(p=i-a.length-s)&&(g=v.replace(r,(function(t,e){return e||t+" "}))).length<=p)return g;if(null!=o&&(e=JSON.parse(v),o=void 0),"object"==typeof e&&null!==e){if(m=a+n,c=[],l=0,Array.isArray(e))for(y="[",u="]",p=e.length;l<p;l++)c.push(t(e[l],m,l===p-1?0:1)||"null");else for(y="{",u="}",p=(f=Object.keys(e)).length;l<p;l++)h=f[l],d=JSON.stringify(h)+": ",void 0!==(b=t(e[h],m,d.length+(l===p-1?0:1)))&&c.push(d+b);if(c.length>0)return[y,n+c.join(",\n"+m),u].join("\n"+a)}return v}(t,"",0)}},a2uh:function(t,e,n){"use strict";var r=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(e){o(e)}}function s(t){try{u(r.throw(t))}catch(e){o(e)}}function u(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(a,s)}u((r=r.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0});const i=n("jke5"),o=n("Vinz");e.showPerClassAccuracy=function(t,e,n){return r(this,void 0,void 0,(function*(){const r=i.getDrawArea(t),a=[];for(let t=0;t<e.length;t++){const r=n?n[t]:t.toString(),i=e[t];a.push([r,i.accuracy,i.count])}return o.table(r,{headers:["Class","Accuracy","# Samples"],values:a})}))}},a9XK:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.version="1.4.3"},aUsF:function(t,e,n){"use strict";t.exports=function t(e,n){if(e===n)return!0;if(e&&n&&"object"==typeof e&&"object"==typeof n){if(e.constructor!==n.constructor)return!1;var r,i,o;if(Array.isArray(e)){if((r=e.length)!=n.length)return!1;for(i=r;0!=i--;)if(!t(e[i],n[i]))return!1;return!0}if(e.constructor===RegExp)return e.source===n.source&&e.flags===n.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===n.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===n.toString();if((r=(o=Object.keys(e)).length)!==Object.keys(n).length)return!1;for(i=r;0!=i--;)if(!Object.prototype.hasOwnProperty.call(n,o[i]))return!1;for(i=r;0!=i--;){var a=o[i];if(!t(e[a],n[a]))return!1}return!0}return e!=e&&n!=n}},bdwG:function(t,e,n){const r=n("8GxW");t.exports=(t,e,n)=>r(t,e,n)<=0},bniK:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r={animationIterationCount:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridRow:!0,gridRowStart:!0,gridRowEnd:!0,gridColumn:!0,gridColumnStart:!0,gridColumnEnd:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},i=["Webkit","ms","Moz","O"];Object.keys(r).forEach((function(t){i.forEach((function(e){r[function(t,e){return t+e.charAt(0).toUpperCase()+e.substring(1)}(e,t)]=r[t]}))})),e.default={isUnitlessNumber:r,shorthandPropertyExpansions:{background:{backgroundAttachment:!0,backgroundColor:!0,backgroundImage:!0,backgroundPositionX:!0,backgroundPositionY:!0,backgroundRepeat:!0},backgroundPosition:{backgroundPositionX:!0,backgroundPositionY:!0},border:{borderWidth:!0,borderStyle:!0,borderColor:!0},borderBottom:{borderBottomWidth:!0,borderBottomStyle:!0,borderBottomColor:!0},borderLeft:{borderLeftWidth:!0,borderLeftStyle:!0,borderLeftColor:!0},borderRight:{borderRightWidth:!0,borderRightStyle:!0,borderRightColor:!0},borderTop:{borderTopWidth:!0,borderTopStyle:!0,borderTopColor:!0},font:{fontStyle:!0,fontVariant:!0,fontWeight:!0,fontSize:!0,lineHeight:!0,fontFamily:!0},outline:{outlineWidth:!0,outlineStyle:!0,outlineColor:!0}}}},c0yS:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e,n,a){if("string"==typeof e&&s.hasOwnProperty(t)){var l=function(t,e){if((0,i.default)(t))return t;for(var n=t.split(/,(?![^()]*(?:\([^()]*\))?\))/g),o=0,a=n.length;o<a;++o){var s=n[o],l=[s];for(var c in e){var h=(0,r.default)(c);if(s.indexOf(h)>-1&&"order"!==h)for(var d=e[c],f=0,p=d.length;f<p;++f)l.unshift(s.replace(h,u[d[f]]+h))}n[o]=l.join(",")}return n.join(",")}(e,a),c=l.split(/,(?![^()]*(?:\([^()]*\))?\))/g).filter((function(t){return!/-moz-|-ms-/.test(t)})).join(",");if(t.indexOf("Webkit")>-1)return c;var h=l.split(/,(?![^()]*(?:\([^()]*\))?\))/g).filter((function(t){return!/-webkit-|-ms-/.test(t)})).join(",");return t.indexOf("Moz")>-1?h:(n["Webkit"+(0,o.default)(t)]=c,n["Moz"+(0,o.default)(t)]=h,l)}};var r=a(n("Rz+p")),i=a(n("sUt/")),o=a(n("SFYy"));function a(t){return t&&t.__esModule?t:{default:t}}var s={transition:!0,transitionProperty:!0,WebkitTransition:!0,WebkitTransitionProperty:!0,MozTransition:!0,MozTransitionProperty:!0},u={Webkit:"-webkit-",Moz:"-moz-",ms:"-ms-"};t.exports=e.default},d43V:function(t,e,n){const r=n("3wIk"),i=n("ex/Z");t.exports=(t,e,n)=>{let o=null,a=null,s=null;try{s=new i(e,n)}catch(u){return null}return t.forEach(t=>{s.test(t)&&(o&&-1!==a.compare(t)||(o=t,a=new r(o,n)))}),o}},dfBD:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=n("tNsn"),i=n("3zff"),o=n("vWdZ"),a=n("h1ZQ"),s=n("zhpP"),u=n("CEZr"),l=n("Vinz"),c=n("4PpC"),h=n("Z6Kp"),d=n("a2uh"),f=n("2tTC"),p=n("QUk2"),m=n("a9XK");e.version_vis=m.version,e.render={barchart:r.barchart,table:l.table,histogram:a.histogram,linechart:s.linechart,scatterplot:u.scatterplot,confusionMatrix:i.confusionMatrix,heatmap:o.heatmap},e.metrics={accuracy:p.accuracy,perClassAccuracy:p.perClassAccuracy,confusionMatrix:p.confusionMatrix},e.show={history:c.history,fitCallbacks:c.fitCallbacks,perClassAccuracy:d.showPerClassAccuracy,valuesDistribution:f.valuesDistribution,layer:h.layer,modelSummary:h.modelSummary};var g=n("LwnN");e.visor=g.visor,function(t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}(n("t+T0"))},djh3:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e,n){if(t.hasOwnProperty(e))for(var r=t[e],o=0,a=r.length;o<a;++o)n[r[o]+(0,i.default)(e)]=n[e]};var r,i=(r=n("SFYy"))&&r.__esModule?r:{default:r};t.exports=e.default},"dtu/":function(t,e,n){const r=n("8GxW");t.exports=(t,e,n)=>0!==r(t,e,n)},e575:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=["Webkit"],i=["Moz"],o=["ms"],a=["Webkit","Moz"],s=["Webkit","ms"],u=["Webkit","Moz","ms"];e.default={plugins:[],prefixMap:{appearance:a,userSelect:u,textEmphasisPosition:r,textEmphasis:r,textEmphasisStyle:r,textEmphasisColor:r,boxDecorationBreak:r,clipPath:r,maskImage:r,maskMode:r,maskRepeat:r,maskPosition:r,maskClip:r,maskOrigin:r,maskSize:r,maskComposite:r,mask:r,maskBorderSource:r,maskBorderMode:r,maskBorderSlice:r,maskBorderWidth:r,maskBorderOutset:r,maskBorderRepeat:r,maskBorder:r,maskType:r,textDecorationStyle:r,textDecorationSkip:r,textDecorationLine:r,textDecorationColor:r,filter:r,fontFeatureSettings:r,breakAfter:u,breakBefore:u,breakInside:u,columnCount:a,columnFill:a,columnGap:a,columnRule:a,columnRuleColor:a,columnRuleStyle:a,columnRuleWidth:a,columns:a,columnSpan:a,columnWidth:a,writingMode:s,flex:r,flexBasis:r,flexDirection:r,flexGrow:r,flexFlow:r,flexShrink:r,flexWrap:r,alignContent:r,alignItems:r,alignSelf:r,justifyContent:r,order:r,transform:r,transformOrigin:r,transformOriginX:r,transformOriginY:r,backfaceVisibility:r,perspective:r,perspectiveOrigin:r,transformStyle:r,transformOriginZ:r,animation:r,animationDelay:r,animationDirection:r,animationFillMode:r,animationDuration:r,animationIterationCount:r,animationName:r,animationPlayState:r,animationTimingFunction:r,backdropFilter:r,fontKerning:r,scrollSnapType:s,scrollSnapPointsX:s,scrollSnapPointsY:s,scrollSnapDestination:s,scrollSnapCoordinate:s,shapeImageThreshold:r,shapeImageMargin:r,shapeImageOutside:r,hyphens:u,flowInto:s,flowFrom:s,regionFragment:s,textAlignLast:i,tabSize:i,wrapFlow:o,wrapThrough:o,wrapMargin:o,gridTemplateColumns:o,gridTemplateRows:o,gridTemplateAreas:o,gridTemplate:o,gridAutoColumns:o,gridAutoRows:o,gridAutoFlow:o,grid:o,gridRowStart:o,gridColumnStart:o,gridRowEnd:o,gridRow:o,gridColumn:o,gridColumnEnd:o,gridColumnGap:o,gridRowGap:o,gridArea:o,gridGap:o,textSizeAdjust:s,borderImage:r,borderImageOutset:r,borderImageRepeat:r,borderImageSlice:r,borderImageSource:r,borderImageWidth:r,transitionDelay:r,transitionDuration:r,transitionProperty:r,transitionTimingFunction:r}},t.exports=e.default},eQf7:function(t,e,n){const r=n("3wIk");t.exports=(t,e,n,i)=>{"string"==typeof n&&(i=n,n=void 0);try{return new r(t,n).inc(e,i).version}catch(o){return null}}},eXNJ:function(t,e,n){const r=n("3wIk"),i=n("Ybu3"),{re:o,t:a}=n("IsDc");t.exports=(t,e)=>{if(t instanceof r)return t;if("number"==typeof t&&(t=String(t)),"string"!=typeof t)return null;let n=null;if((e=e||{}).rtl){let e;for(;(e=o[a.COERCERTL].exec(t))&&(!n||n.index+n[0].length!==t.length);)n&&e.index+e[0].length===n.index+n[0].length||(n=e),o[a.COERCERTL].lastIndex=e.index+e[1].length+e[2].length;o[a.COERCERTL].lastIndex=-1}else n=t.match(o[a.COERCE]);return null===n?null:i(`${n[2]}.${n[3]||"0"}.${n[4]||"0"}`,e)}},etOl:function(t,e,n){"use strict";n.r(e),n.d(e,"vega",(function(){return QZ})),n.d(e,"vegaLite",(function(){return JZ})),n.d(e,"DEFAULT_ACTIONS",(function(){return eQ})),n.d(e,"guessMode",(function(){return sQ})),n.d(e,"default",(function(){return uQ}));var r={};n.r(r),n.d(r,"JsonPatchError",(function(){return R})),n.d(r,"deepClone",(function(){return I})),n.d(r,"getValueByPointer",(function(){return P})),n.d(r,"applyOperation",(function(){return j})),n.d(r,"applyPatch",(function(){return z})),n.d(r,"applyReducer",(function(){return L})),n.d(r,"validator",(function(){return B})),n.d(r,"validate",(function(){return U})),n.d(r,"_areEquals",(function(){return $}));var i={};n.r(i),n.d(i,"unobserve",(function(){return H})),n.d(i,"observe",(function(){return G})),n.d(i,"generate",(function(){return X})),n.d(i,"compare",(function(){return Y}));var o={};n.r(o),n.d(o,"aggregate",(function(){return hl})),n.d(o,"bin",(function(){return dl})),n.d(o,"collect",(function(){return pl})),n.d(o,"compare",(function(){return ml})),n.d(o,"countpattern",(function(){return yl})),n.d(o,"cross",(function(){return vl})),n.d(o,"density",(function(){return wl})),n.d(o,"dotbin",(function(){return kl})),n.d(o,"expression",(function(){return Sl})),n.d(o,"extent",(function(){return Ol})),n.d(o,"facet",(function(){return Nl})),n.d(o,"field",(function(){return Tl})),n.d(o,"filter",(function(){return Rl})),n.d(o,"flatten",(function(){return Il})),n.d(o,"fold",(function(){return Ml})),n.d(o,"formula",(function(){return Fl})),n.d(o,"generate",(function(){return Pl})),n.d(o,"impute",(function(){return Ll})),n.d(o,"joinaggregate",(function(){return Bl})),n.d(o,"kde",(function(){return Ul})),n.d(o,"key",(function(){return $l})),n.d(o,"load",(function(){return Wl})),n.d(o,"lookup",(function(){return Hl})),n.d(o,"multiextent",(function(){return Gl})),n.d(o,"multivalues",(function(){return Kl})),n.d(o,"params",(function(){return Zl})),n.d(o,"pivot",(function(){return Ql})),n.d(o,"prefacet",(function(){return Jl})),n.d(o,"project",(function(){return tc})),n.d(o,"proxy",(function(){return ec})),n.d(o,"quantile",(function(){return rc})),n.d(o,"relay",(function(){return ic})),n.d(o,"sample",(function(){return oc})),n.d(o,"sequence",(function(){return ac})),n.d(o,"sieve",(function(){return sc})),n.d(o,"subflow",(function(){return Al})),n.d(o,"timeunit",(function(){return uc})),n.d(o,"tupleindex",(function(){return cc})),n.d(o,"values",(function(){return hc})),n.d(o,"window",(function(){return gc}));var a={};n.r(a),n.d(a,"interpolate",(function(){return Dg})),n.d(a,"interpolateArray",(function(){return Cg})),n.d(a,"interpolateBasis",(function(){return hg})),n.d(a,"interpolateBasisClosed",(function(){return dg})),n.d(a,"interpolateDate",(function(){return Sg})),n.d(a,"interpolateDiscrete",(function(){return Ty})),n.d(a,"interpolateHue",(function(){return Dy})),n.d(a,"interpolateNumber",(function(){return Eg})),n.d(a,"interpolateNumberArray",(function(){return xg})),n.d(a,"interpolateObject",(function(){return Og})),n.d(a,"interpolateRound",(function(){return Rg})),n.d(a,"interpolateString",(function(){return Tg})),n.d(a,"interpolateTransformCss",(function(){return Py})),n.d(a,"interpolateTransformSvg",(function(){return jy})),n.d(a,"interpolateZoom",(function(){return By})),n.d(a,"interpolateRgb",(function(){return yg})),n.d(a,"interpolateRgbBasis",(function(){return bg})),n.d(a,"interpolateRgbBasisClosed",(function(){return wg})),n.d(a,"interpolateHsl",(function(){return $y})),n.d(a,"interpolateHslLong",(function(){return Vy})),n.d(a,"interpolateLab",(function(){return rv})),n.d(a,"interpolateHcl",(function(){return ov})),n.d(a,"interpolateHclLong",(function(){return av})),n.d(a,"interpolateCubehelix",(function(){return mv})),n.d(a,"interpolateCubehelixLong",(function(){return gv})),n.d(a,"piecewise",(function(){return dy})),n.d(a,"quantize",(function(){return yv}));var s={};n.r(s),n.d(s,"bound",(function(){return Eb})),n.d(s,"identifier",(function(){return Ab})),n.d(s,"mark",(function(){return Nb})),n.d(s,"overlap",(function(){return Tb})),n.d(s,"render",(function(){return jb})),n.d(s,"viewlayout",(function(){return iw}));var u={};n.r(u),n.d(u,"axisticks",(function(){return ow})),n.d(u,"datajoin",(function(){return aw})),n.d(u,"encode",(function(){return uw})),n.d(u,"legendentries",(function(){return lw})),n.d(u,"linkpath",(function(){return pw})),n.d(u,"pie",(function(){return ww})),n.d(u,"scale",(function(){return Cw})),n.d(u,"sortitems",(function(){return Ow})),n.d(u,"stack",(function(){return Nw}));var l={};n.r(l),n.d(l,"contour",(function(){return Yw})),n.d(l,"geojson",(function(){return Zw})),n.d(l,"geopath",(function(){return ck})),n.d(l,"geopoint",(function(){return hk})),n.d(l,"geoshape",(function(){return dk})),n.d(l,"graticule",(function(){return mk})),n.d(l,"heatmap",(function(){return gk})),n.d(l,"isocontour",(function(){return Bw})),n.d(l,"kde2d",(function(){return Gw})),n.d(l,"projection",(function(){return vk}));var c={};n.r(c),n.d(c,"force",(function(){return hS}));var h={};n.r(h),n.d(h,"nest",(function(){return CS})),n.d(h,"pack",(function(){return KS})),n.d(h,"partition",(function(){return JS})),n.d(h,"stratify",(function(){return oE})),n.d(h,"tree",(function(){return yE})),n.d(h,"treelinks",(function(){return vE})),n.d(h,"treemap",(function(){return EE}));var d={};n.r(d),n.d(d,"loess",(function(){return AE})),n.d(d,"regression",(function(){return TE}));var f={};n.r(f),n.d(f,"voronoi",(function(){return QE}));var p={};n.r(p),n.d(p,"wordcloud",(function(){return cO}));var m={};n.r(m),n.d(m,"crossfilter",(function(){return yO})),n.d(m,"resolvefilter",(function(){return vO}));var g={};n.r(g),n.d(g,"version",(function(){return bO.a})),n.d(g,"bandwidthNRD",(function(){return yu})),n.d(g,"bin",(function(){return vu})),n.d(g,"bootstrapCI",(function(){return xu})),n.d(g,"dotbin",(function(){return _u})),n.d(g,"quantiles",(function(){return mu})),n.d(g,"quartiles",(function(){return gu})),n.d(g,"random",(function(){return bu})),n.d(g,"setRandom",(function(){return wu})),n.d(g,"randomLCG",(function(){return Cu})),n.d(g,"randomInteger",(function(){return ku})),n.d(g,"randomKDE",(function(){return Iu})),n.d(g,"randomLogNormal",(function(){return zu})),n.d(g,"sampleLogNormal",(function(){return Mu})),n.d(g,"densityLogNormal",(function(){return Fu})),n.d(g,"cumulativeLogNormal",(function(){return Pu})),n.d(g,"quantileLogNormal",(function(){return ju})),n.d(g,"randomMixture",(function(){return Lu})),n.d(g,"randomNormal",(function(){return Ru})),n.d(g,"sampleNormal",(function(){return Au})),n.d(g,"densityNormal",(function(){return Nu})),n.d(g,"cumulativeNormal",(function(){return Tu})),n.d(g,"quantileNormal",(function(){return Du})),n.d(g,"randomUniform",(function(){return Wu})),n.d(g,"sampleUniform",(function(){return Bu})),n.d(g,"densityUniform",(function(){return Uu})),n.d(g,"cumulativeUniform",(function(){return $u})),n.d(g,"quantileUniform",(function(){return Vu})),n.d(g,"regressionLinear",(function(){return Ku})),n.d(g,"regressionLog",(function(){return Yu})),n.d(g,"regressionExp",(function(){return Zu})),n.d(g,"regressionPow",(function(){return Qu})),n.d(g,"regressionQuad",(function(){return Ju})),n.d(g,"regressionPoly",(function(){return tl})),n.d(g,"regressionLoess",(function(){return rl})),n.d(g,"sampleCurve",(function(){return sl})),n.d(g,"TIME_UNITS",(function(){return Ii})),n.d(g,"YEAR",(function(){return _i})),n.d(g,"QUARTER",(function(){return Ci})),n.d(g,"MONTH",(function(){return ki})),n.d(g,"WEEK",(function(){return Si})),n.d(g,"DATE",(function(){return Ei})),n.d(g,"DAY",(function(){return Oi})),n.d(g,"DAYOFYEAR",(function(){return Ai})),n.d(g,"HOURS",(function(){return Ni})),n.d(g,"MINUTES",(function(){return Ti})),n.d(g,"SECONDS",(function(){return Di})),n.d(g,"MILLISECONDS",(function(){return Ri})),n.d(g,"timeUnitSpecifier",(function(){return ji})),n.d(g,"timeUnits",(function(){return Fi})),n.d(g,"dayofyear",(function(){return Ji})),n.d(g,"week",(function(){return to})),n.d(g,"utcdayofyear",(function(){return oo})),n.d(g,"utcweek",(function(){return ao})),n.d(g,"timeFloor",(function(){return go})),n.d(g,"utcFloor",(function(){return bo})),n.d(g,"timeInterval",(function(){return Fo})),n.d(g,"timeOffset",(function(){return zo})),n.d(g,"timeSequence",(function(){return Uo})),n.d(g,"utcInterval",(function(){return Po})),n.d(g,"utcOffset",(function(){return Lo})),n.d(g,"utcSequence",(function(){return $o})),n.d(g,"timeBin",(function(){return Jo})),n.d(g,"accessor",(function(){return tt})),n.d(g,"accessorName",(function(){return et})),n.d(g,"accessorFields",(function(){return nt})),n.d(g,"id",(function(){return ct})),n.d(g,"identity",(function(){return ht})),n.d(g,"zero",(function(){return dt})),n.d(g,"one",(function(){return ft})),n.d(g,"truthy",(function(){return pt})),n.d(g,"falsy",(function(){return mt})),n.d(g,"logger",(function(){return _t})),n.d(g,"None",(function(){return yt})),n.d(g,"Error",(function(){return vt})),n.d(g,"Warn",(function(){return bt})),n.d(g,"Info",(function(){return wt})),n.d(g,"Debug",(function(){return xt})),n.d(g,"mergeConfig",(function(){return Et})),n.d(g,"writeConfig",(function(){return Ot})),n.d(g,"panLinear",(function(){return jt})),n.d(g,"panLog",(function(){return zt})),n.d(g,"panPow",(function(){return Lt})),n.d(g,"panSymlog",(function(){return Bt})),n.d(g,"zoomLinear",(function(){return $t})),n.d(g,"zoomLog",(function(){return Vt})),n.d(g,"zoomPow",(function(){return Wt})),n.d(g,"zoomSymlog",(function(){return qt})),n.d(g,"quarter",(function(){return Ht})),n.d(g,"utcquarter",(function(){return Gt})),n.d(g,"array",(function(){return Xt})),n.d(g,"clampRange",(function(){return Kt})),n.d(g,"compare",(function(){return Zt})),n.d(g,"constant",(function(){return ne})),n.d(g,"debounce",(function(){return re})),n.d(g,"error",(function(){return at})),n.d(g,"extend",(function(){return ie})),n.d(g,"extent",(function(){return oe})),n.d(g,"extentIndex",(function(){return ae})),n.d(g,"fastmap",(function(){return ce})),n.d(g,"field",(function(){return ut})),n.d(g,"flush",(function(){return he})),n.d(g,"hasOwnProperty",(function(){return ue})),n.d(g,"inherits",(function(){return de})),n.d(g,"inrange",(function(){return fe})),n.d(g,"isArray",(function(){return Ct})),n.d(g,"isBoolean",(function(){return pe})),n.d(g,"isDate",(function(){return me})),n.d(g,"isFunction",(function(){return Yt})),n.d(g,"isNumber",(function(){return ge})),n.d(g,"isObject",(function(){return kt})),n.d(g,"isRegExp",(function(){return ye})),n.d(g,"isString",(function(){return ve})),n.d(g,"key",(function(){return be})),n.d(g,"lerp",(function(){return we})),n.d(g,"lruCache",(function(){return xe})),n.d(g,"merge",(function(){return _e})),n.d(g,"pad",(function(){return ke})),n.d(g,"peek",(function(){return Nt})),n.d(g,"repeat",(function(){return Ce})),n.d(g,"span",(function(){return Se})),n.d(g,"splitAccessPath",(function(){return st})),n.d(g,"stringValue",(function(){return Ee})),n.d(g,"toBoolean",(function(){return Oe})),n.d(g,"toDate",(function(){return Ne})),n.d(g,"toNumber",(function(){return Tt})),n.d(g,"toString",(function(){return Te})),n.d(g,"toSet",(function(){return De})),n.d(g,"truncate",(function(){return Re})),n.d(g,"visitArray",(function(){return Ie})),n.d(g,"loader",(function(){return Ds})),n.d(g,"read",(function(){return Ts})),n.d(g,"inferType",(function(){return Er})),n.d(g,"inferTypes",(function(){return Or})),n.d(g,"typeParsers",(function(){return Cr})),n.d(g,"format",(function(){return Hr})),n.d(g,"formats",(function(){return Gr})),n.d(g,"responseType",(function(){return Xr})),n.d(g,"Bounds",(function(){return mA})),n.d(g,"Gradient",(function(){return kO})),n.d(g,"GroupItem",(function(){return vA})),n.d(g,"ResourceLoader",(function(){return bA})),n.d(g,"Item",(function(){return yA})),n.d(g,"Scenegraph",(function(){return lT})),n.d(g,"Handler",(function(){return vT})),n.d(g,"Renderer",(function(){return xT})),n.d(g,"CanvasHandler",(function(){return RT})),n.d(g,"CanvasRenderer",(function(){return zT})),n.d(g,"SVGHandler",(function(){return UT})),n.d(g,"SVGRenderer",(function(){return iD})),n.d(g,"SVGStringRenderer",(function(){return vD})),n.d(g,"RenderType",(function(){return _D})),n.d(g,"renderModule",(function(){return kD})),n.d(g,"intersect",(function(){return SD})),n.d(g,"Marks",(function(){return nT})),n.d(g,"boundClip",(function(){return TD})),n.d(g,"boundContext",(function(){return AA})),n.d(g,"boundStroke",(function(){return EA})),n.d(g,"boundItem",(function(){return rT})),n.d(g,"boundMark",(function(){return oT})),n.d(g,"pathCurves",(function(){return EO})),n.d(g,"pathSymbols",(function(){return VO})),n.d(g,"pathRectangle",(function(){return ZO})),n.d(g,"pathTrail",(function(){return QO})),n.d(g,"pathParse",(function(){return NO})),n.d(g,"pathRender",(function(){return BO})),n.d(g,"point",(function(){return yT})),n.d(g,"domCreate",(function(){return dT})),n.d(g,"domFind",(function(){return fT})),n.d(g,"domChild",(function(){return pT})),n.d(g,"domClear",(function(){return mT})),n.d(g,"openTag",(function(){return JT})),n.d(g,"closeTag",(function(){return tD})),n.d(g,"font",(function(){return YN})),n.d(g,"fontFamily",(function(){return KN})),n.d(g,"fontSize",(function(){return WN})),n.d(g,"lineHeight",(function(){return qN})),n.d(g,"multiLineOffset",(function(){return GN})),n.d(g,"textMetrics",(function(){return zN})),n.d(g,"sceneEqual",(function(){return DD})),n.d(g,"pathEqual",(function(){return RD})),n.d(g,"sceneToJSON",(function(){return sT})),n.d(g,"sceneFromJSON",(function(){return uT})),n.d(g,"intersectPath",(function(){return LA})),n.d(g,"intersectPoint",(function(){return BA})),n.d(g,"intersectRule",(function(){return $A})),n.d(g,"intersectBoxLine",(function(){return VA})),n.d(g,"sceneZOrder",(function(){return QA})),n.d(g,"sceneVisit",(function(){return JA})),n.d(g,"scenePickVisit",(function(){return tN})),n.d(g,"resetSVGClipId",(function(){return fA})),n.d(g,"resetSVGDefIds",(function(){return ID})),n.d(g,"Dataflow",(function(){return Ws})),n.d(g,"EventStream",(function(){return hr})),n.d(g,"Parameters",(function(){return or})),n.d(g,"Pulse",(function(){return Ps})),n.d(g,"MultiPulse",(function(){return Bs})),n.d(g,"Operator",(function(){return ur})),n.d(g,"Transform",(function(){return Hs})),n.d(g,"changeset",(function(){return ir})),n.d(g,"ingest",(function(){return Qn})),n.d(g,"isTuple",(function(){return Kn})),n.d(g,"definition",(function(){return Xs})),n.d(g,"transform",(function(){return Ks})),n.d(g,"transforms",(function(){return Gs})),n.d(g,"tupleid",(function(){return Yn})),n.d(g,"scale",(function(){return yy})),n.d(g,"scheme",(function(){return Ov})),n.d(g,"interpolate",(function(){return Cv})),n.d(g,"interpolateColors",(function(){return wv})),n.d(g,"interpolateRange",(function(){return bv})),n.d(g,"quantizeInterpolator",(function(){return xv})),n.d(g,"projection",(function(){return sk})),n.d(g,"View",(function(){return lF})),n.d(g,"formatLocale",(function(){return xi})),n.d(g,"timeFormatLocale",(function(){return Ss})),n.d(g,"locale",(function(){return Os})),n.d(g,"defaultLocale",(function(){return As})),n.d(g,"resetDefaultLocale",(function(){return Ns})),n.d(g,"expressionFunction",(function(){return $M})),n.d(g,"parse",(function(){return xz})),n.d(g,"runtimeContext",(function(){return QM}));var y={};n.r(y),n.d(y,"invalidSpec",(function(){return YB})),n.d(y,"FIT_NON_SINGLE",(function(){return ZB})),n.d(y,"containerSizeNonSingle",(function(){return QB})),n.d(y,"containerSizeNotCompatibleWithAutosize",(function(){return JB})),n.d(y,"droppingFit",(function(){return tU})),n.d(y,"cannotProjectOnChannelWithoutField",(function(){return eU})),n.d(y,"cannotProjectAggregate",(function(){return nU})),n.d(y,"nearestNotSupportForContinuous",(function(){return rU})),n.d(y,"selectionNotSupported",(function(){return iU})),n.d(y,"selectionNotFound",(function(){return oU})),n.d(y,"SCALE_BINDINGS_CONTINUOUS",(function(){return aU})),n.d(y,"LEGEND_BINDINGS_PROJECT_LENGTH",(function(){return sU})),n.d(y,"noSameUnitLookup",(function(){return uU})),n.d(y,"noSuchRepeatedValue",(function(){return lU})),n.d(y,"columnsNotSupportByRowCol",(function(){return cU})),n.d(y,"CONCAT_CANNOT_SHARE_AXIS",(function(){return hU})),n.d(y,"unrecognizedParse",(function(){return dU})),n.d(y,"differentParse",(function(){return fU})),n.d(y,"invalidTransformIgnored",(function(){return pU})),n.d(y,"NO_FIELDS_NEEDS_AS",(function(){return mU})),n.d(y,"customFormatTypeNotAllowed",(function(){return gU})),n.d(y,"encodingOverridden",(function(){return yU})),n.d(y,"projectionOverridden",(function(){return vU})),n.d(y,"REPLACE_ANGLE_WITH_THETA",(function(){return bU})),n.d(y,"primitiveChannelDef",(function(){return wU})),n.d(y,"invalidFieldType",(function(){return xU})),n.d(y,"invalidFieldTypeForCountAggregate",(function(){return _U})),n.d(y,"invalidAggregate",(function(){return CU})),n.d(y,"missingFieldType",(function(){return kU})),n.d(y,"droppingColor",(function(){return SU})),n.d(y,"emptyFieldDef",(function(){return EU})),n.d(y,"latLongDeprecated",(function(){return OU})),n.d(y,"LINE_WITH_VARYING_SIZE",(function(){return AU})),n.d(y,"incompatibleChannel",(function(){return NU})),n.d(y,"invalidEncodingChannel",(function(){return TU})),n.d(y,"facetChannelShouldBeDiscrete",(function(){return DU})),n.d(y,"facetChannelDropped",(function(){return RU})),n.d(y,"discreteChannelCannotEncode",(function(){return IU})),n.d(y,"lineWithRange",(function(){return MU})),n.d(y,"orientOverridden",(function(){return FU})),n.d(y,"CANNOT_UNION_CUSTOM_DOMAIN_WITH_FIELD_DOMAIN",(function(){return PU})),n.d(y,"RANGE_STEP_DEPRECATED",(function(){return jU})),n.d(y,"cannotUseScalePropertyWithNonColor",(function(){return zU})),n.d(y,"unaggregateDomainHasNoEffectForRawField",(function(){return LU})),n.d(y,"unaggregateDomainWithNonSharedDomainOp",(function(){return BU})),n.d(y,"unaggregatedDomainWithLogScale",(function(){return UU})),n.d(y,"cannotApplySizeToNonOrientedMark",(function(){return $U})),n.d(y,"scaleTypeNotWorkWithChannel",(function(){return VU})),n.d(y,"scaleTypeNotWorkWithFieldDef",(function(){return WU})),n.d(y,"scalePropertyNotWorkWithScaleType",(function(){return qU})),n.d(y,"scaleTypeNotWorkWithMark",(function(){return HU})),n.d(y,"stepDropped",(function(){return GU})),n.d(y,"mergeConflictingProperty",(function(){return XU})),n.d(y,"mergeConflictingDomainProperty",(function(){return KU})),n.d(y,"independentScaleMeansIndependentGuide",(function(){return YU})),n.d(y,"domainSortDropped",(function(){return ZU})),n.d(y,"MORE_THAN_ONE_SORT",(function(){return QU})),n.d(y,"FACETED_INDEPENDENT_DIFFERENT_SOURCES",(function(){return JU})),n.d(y,"FACETED_INDEPENDENT_SAME_FIELDS_DIFFERENT_SOURCES",(function(){return t$})),n.d(y,"FACETED_INDEPENDENT_SAME_SOURCE",(function(){return e$})),n.d(y,"INVALID_CHANNEL_FOR_AXIS",(function(){return n$})),n.d(y,"cannotStackRangedMark",(function(){return r$})),n.d(y,"cannotStackNonLinearScale",(function(){return i$})),n.d(y,"stackNonSummativeAggregate",(function(){return o$})),n.d(y,"invalidTimeUnit",(function(){return a$})),n.d(y,"droppedDay",(function(){return s$})),n.d(y,"errorBarCenterAndExtentAreNotNeeded",(function(){return u$})),n.d(y,"errorBarCenterIsUsedWithWrongExtent",(function(){return l$})),n.d(y,"errorBarContinuousAxisHasCustomizedAggregate",(function(){return c$})),n.d(y,"errorBarCenterIsNotNeeded",(function(){return h$})),n.d(y,"errorBand1DNotSupport",(function(){return d$})),n.d(y,"channelRequiredForBinned",(function(){return f$})),n.d(y,"domainRequiredForThresholdScale",(function(){return p$}));var v={};n.r(v),n.d(v,"compile",(function(){return SZ})),n.d(v,"extractTransforms",(function(){return OZ})),n.d(v,"normalize",(function(){return kH})),n.d(v,"version",(function(){return AZ}));var b={};n.r(b),n.d(b,"dark",(function(){return RZ})),n.d(b,"excel",(function(){return IZ})),n.d(b,"fivethirtyeight",(function(){return MZ})),n.d(b,"ggplot2",(function(){return FZ})),n.d(b,"latimes",(function(){return zZ})),n.d(b,"quartz",(function(){return LZ})),n.d(b,"vox",(function(){return BZ})),n.d(b,"urbaninstitute",(function(){return $Z})),n.d(b,"googlecharts",(function(){return VZ})),n.d(b,"version",(function(){return WZ}));var w,x=n("mrSG"),_=(w=function(t,e){return(w=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}w(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),C=Object.prototype.hasOwnProperty;function k(t,e){return C.call(t,e)}function S(t){if(Array.isArray(t)){for(var e=new Array(t.length),n=0;n<e.length;n++)e[n]=""+n;return e}if(Object.keys)return Object.keys(t);for(var r in e=[],t)k(t,r)&&e.push(r);return e}function E(t){switch(typeof t){case"object":return JSON.parse(JSON.stringify(t));case"undefined":return null;default:return t}}function O(t){for(var e,n=0,r=t.length;n<r;){if(!((e=t.charCodeAt(n))>=48&&e<=57))return!1;n++}return!0}function A(t){return-1===t.indexOf("/")&&-1===t.indexOf("~")?t:t.replace(/~/g,"~0").replace(/\//g,"~1")}function N(t){return t.replace(/~1/g,"/").replace(/~0/g,"~")}function T(t,e){var n=[t];for(var r in e){var i="object"==typeof e[r]?JSON.stringify(e[r],null,2):e[r];void 0!==i&&n.push(r+": "+i)}return n.join("\n")}var D=function(t){function e(e,n,r,i,o){var a=this.constructor,s=t.call(this,T(e,{name:n,index:r,operation:i,tree:o}))||this;return s.name=n,s.index=r,s.operation=i,s.tree=o,Object.setPrototypeOf(s,a.prototype),s.message=T(e,{name:n,index:r,operation:i,tree:o}),s}return _(e,t),e}(Error),R=D,I=E,M={add:function(t,e,n){return t[e]=this.value,{newDocument:n}},remove:function(t,e,n){var r=t[e];return delete t[e],{newDocument:n,removed:r}},replace:function(t,e,n){var r=t[e];return t[e]=this.value,{newDocument:n,removed:r}},move:function(t,e,n){var r=P(n,this.path);r&&(r=E(r));var i=j(n,{op:"remove",path:this.from}).removed;return j(n,{op:"add",path:this.path,value:i}),{newDocument:n,removed:r}},copy:function(t,e,n){var r=P(n,this.from);return j(n,{op:"add",path:this.path,value:E(r)}),{newDocument:n}},test:function(t,e,n){return{newDocument:n,test:$(t[e],this.value)}},_get:function(t,e,n){return this.value=t[e],{newDocument:n}}},F={add:function(t,e,n){return O(e)?t.splice(e,0,this.value):t[e]=this.value,{newDocument:n,index:e}},remove:function(t,e,n){return{newDocument:n,removed:t.splice(e,1)[0]}},replace:function(t,e,n){var r=t[e];return t[e]=this.value,{newDocument:n,removed:r}},move:M.move,copy:M.copy,test:M.test,_get:M._get};function P(t,e){if(""==e)return t;var n={op:"_get",path:e};return j(t,n),n.value}function j(t,e,n,r,i,o){if(void 0===n&&(n=!1),void 0===r&&(r=!0),void 0===i&&(i=!0),void 0===o&&(o=0),n&&("function"==typeof n?n(e,0,t,e.path):B(e,0)),""===e.path){var a={newDocument:t};if("add"===e.op)return a.newDocument=e.value,a;if("replace"===e.op)return a.newDocument=e.value,a.removed=t,a;if("move"===e.op||"copy"===e.op)return a.newDocument=P(t,e.from),"move"===e.op&&(a.removed=t),a;if("test"===e.op){if(a.test=$(t,e.value),!1===a.test)throw new R("Test operation failed","TEST_OPERATION_FAILED",o,e,t);return a.newDocument=t,a}if("remove"===e.op)return a.removed=t,a.newDocument=null,a;if("_get"===e.op)return e.value=t,a;if(n)throw new R("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",o,e,t);return a}r||(t=E(t));var s=(e.path||"").split("/"),u=t,l=1,c=s.length,h=void 0,d=void 0,f=void 0;for(f="function"==typeof n?n:B;;){if(d=s[l],i&&"__proto__"==d)throw new TypeError("JSON-Patch: modifying `__proto__` prop is banned for security reasons, if this was on purpose, please set `banPrototypeModifications` flag false and pass it to this function. More info in fast-json-patch README");if(n&&void 0===h&&(void 0===u[d]?h=s.slice(0,l).join("/"):l==c-1&&(h=e.path),void 0!==h&&f(e,0,t,h)),l++,Array.isArray(u)){if("-"===d)d=u.length;else{if(n&&!O(d))throw new R("Expected an unsigned base-10 integer value, making the new referenced value the array element with the zero-based index","OPERATION_PATH_ILLEGAL_ARRAY_INDEX",o,e,t);O(d)&&(d=~~d)}if(l>=c){if(n&&"add"===e.op&&d>u.length)throw new R("The specified index MUST NOT be greater than the number of elements in the array","OPERATION_VALUE_OUT_OF_BOUNDS",o,e,t);if(!1===(a=F[e.op].call(e,u,d,t)).test)throw new R("Test operation failed","TEST_OPERATION_FAILED",o,e,t);return a}}else if(d&&-1!=d.indexOf("~")&&(d=N(d)),l>=c){if(!1===(a=M[e.op].call(e,u,d,t)).test)throw new R("Test operation failed","TEST_OPERATION_FAILED",o,e,t);return a}u=u[d]}}function z(t,e,n,r,i){if(void 0===r&&(r=!0),void 0===i&&(i=!0),n&&!Array.isArray(e))throw new R("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");r||(t=E(t));for(var o=new Array(e.length),a=0,s=e.length;a<s;a++)o[a]=j(t,e[a],n,!0,i,a),t=o[a].newDocument;return o.newDocument=t,o}function L(t,e,n){var r=j(t,e);if(!1===r.test)throw new R("Test operation failed","TEST_OPERATION_FAILED",n,e,t);return r.newDocument}function B(t,e,n,r){if("object"!=typeof t||null===t||Array.isArray(t))throw new R("Operation is not an object","OPERATION_NOT_AN_OBJECT",e,t,n);if(!M[t.op])throw new R("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",e,t,n);if("string"!=typeof t.path)throw new R("Operation `path` property is not a string","OPERATION_PATH_INVALID",e,t,n);if(0!==t.path.indexOf("/")&&t.path.length>0)throw new R('Operation `path` property must start with "/"',"OPERATION_PATH_INVALID",e,t,n);if(("move"===t.op||"copy"===t.op)&&"string"!=typeof t.from)throw new R("Operation `from` property is not present (applicable in `move` and `copy` operations)","OPERATION_FROM_REQUIRED",e,t,n);if(("add"===t.op||"replace"===t.op||"test"===t.op)&&void 0===t.value)throw new R("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_REQUIRED",e,t,n);if(("add"===t.op||"replace"===t.op||"test"===t.op)&&function t(e){if(void 0===e)return!0;if(e)if(Array.isArray(e)){for(var n=0,r=e.length;n<r;n++)if(t(e[n]))return!0}else if("object"==typeof e){var i=S(e),o=i.length;for(n=0;n<o;n++)if(t(e[i[n]]))return!0}return!1}(t.value))throw new R("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_CANNOT_CONTAIN_UNDEFINED",e,t,n);if(n)if("add"==t.op){var i=t.path.split("/").length,o=r.split("/").length;if(i!==o+1&&i!==o)throw new R("Cannot perform an `add` operation at the desired path","OPERATION_PATH_CANNOT_ADD",e,t,n)}else if("replace"===t.op||"remove"===t.op||"_get"===t.op){if(t.path!==r)throw new R("Cannot perform the operation at a path that does not exist","OPERATION_PATH_UNRESOLVABLE",e,t,n)}else if("move"===t.op||"copy"===t.op){var a=U([{op:"_get",path:t.from,value:void 0}],n);if(a&&"OPERATION_PATH_UNRESOLVABLE"===a.name)throw new R("Cannot perform the operation from a path that does not exist","OPERATION_FROM_UNRESOLVABLE",e,t,n)}}function U(t,e,n){try{if(!Array.isArray(t))throw new R("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");if(e)z(E(e),E(t),n||!0);else{n=n||B;for(var r=0;r<t.length;r++)n(t[r],r,e,void 0)}}catch(i){if(i instanceof R)return i;throw i}}function $(t,e){if(t===e)return!0;if(t&&e&&"object"==typeof t&&"object"==typeof e){var n,r,i,o=Array.isArray(t),a=Array.isArray(e);if(o&&a){if((r=t.length)!=e.length)return!1;for(n=r;0!=n--;)if(!$(t[n],e[n]))return!1;return!0}if(o!=a)return!1;var s=Object.keys(t);if((r=s.length)!==Object.keys(e).length)return!1;for(n=r;0!=n--;)if(!e.hasOwnProperty(s[n]))return!1;for(n=r;0!=n--;)if(!$(t[i=s[n]],e[i]))return!1;return!0}return t!=t&&e!=e}var V=new WeakMap,W=function(){return function(t){this.observers=new Map,this.obj=t}}(),q=function(){return function(t,e){this.callback=t,this.observer=e}}();function H(t,e){e.unobserve()}function G(t,e){var n,r=function(t){return V.get(t)}(t);if(r){var i=function(t,e){return t.observers.get(e)}(r,e);n=i&&i.observer}else r=new W(t),V.set(t,r);if(n)return n;if(n={},r.value=E(t),e){n.callback=e,n.next=null;var o=function(){X(n)},a=function(){clearTimeout(n.next),n.next=setTimeout(o)};"undefined"!=typeof window&&(window.addEventListener("mouseup",a),window.addEventListener("keyup",a),window.addEventListener("mousedown",a),window.addEventListener("keydown",a),window.addEventListener("change",a))}return n.patches=[],n.object=t,n.unobserve=function(){X(n),clearTimeout(n.next),function(t,e){t.observers.delete(e.callback)}(r,n),"undefined"!=typeof window&&(window.removeEventListener("mouseup",a),window.removeEventListener("keyup",a),window.removeEventListener("mousedown",a),window.removeEventListener("keydown",a),window.removeEventListener("change",a))},r.observers.set(e,new q(e,n)),n}function X(t,e){void 0===e&&(e=!1);var n=V.get(t.object);K(n.value,t.object,t.patches,"",e),t.patches.length&&z(n.value,t.patches);var r=t.patches;return r.length>0&&(t.patches=[],t.callback&&t.callback(r)),r}function K(t,e,n,r,i){if(e!==t){"function"==typeof e.toJSON&&(e=e.toJSON());for(var o=S(e),a=S(t),s=!1,u=a.length-1;u>=0;u--){var l=t[h=a[u]];if(!k(e,h)||void 0===e[h]&&void 0!==l&&!1===Array.isArray(e))Array.isArray(t)===Array.isArray(e)?(i&&n.push({op:"test",path:r+"/"+A(h),value:E(l)}),n.push({op:"remove",path:r+"/"+A(h)}),s=!0):(i&&n.push({op:"test",path:r,value:t}),n.push({op:"replace",path:r,value:e}));else{var c=e[h];"object"==typeof l&&null!=l&&"object"==typeof c&&null!=c?K(l,c,n,r+"/"+A(h),i):l!==c&&(i&&n.push({op:"test",path:r+"/"+A(h),value:E(l)}),n.push({op:"replace",path:r+"/"+A(h),value:E(c)}))}}if(s||o.length!=a.length)for(u=0;u<o.length;u++){var h;k(t,h=o[u])||void 0===e[h]||n.push({op:"add",path:r+"/"+A(h),value:E(e[h])})}}}function Y(t,e,n){void 0===n&&(n=!1);var r=[];return K(t,e,r,"",n),r}Object.assign({},r,i,{JsonPatchError:D,deepClone:E,escapePathComponent:A,unescapePathComponent:N});var Z=n("ZYJ9"),Q=n.n(Z),J=n("3cPs"),tt=function(t,e,n){return t.fields=e||[],t.fname=n,t};function et(t){return null==t?null:t.fname}function nt(t){return null==t?null:t.fields}var rt=function(t){return 1===t.length?it(t[0]):ot(t)};const it=t=>function(e){return e[t]},ot=t=>{const e=t.length;return function(n){for(let r=0;r<e;++r)n=n[t[r]];return n}};var at=function(t){throw Error(t)},st=function(t){var e,n,r,i=[],o=null,a=0,s=t.length,u="";function l(){i.push(u+t.substring(e,n)),u="",e=n+1}for(t+="",e=n=0;n<s;++n)if("\\"===(r=t[n]))u+=t.substring(e,n),u+=t.substring(++n,++n),e=n;else if(r===o)l(),o=null,a=-1;else{if(o)continue;e===a&&'"'===r||e===a&&"'"===r?(e=n+1,o=r):"."!==r||a?"["===r?(n>e&&l(),a=e=n+1):"]"===r&&(a||at("Access path missing open bracket: "+t),a>0&&l(),a=0,e=n+1):n>e?l():e=n+1}return a&&at("Access path missing closing bracket: "+t),o&&at("Access path missing closing quote: "+t),n>e&&(n++,l()),i},ut=function(t,e,n){const r=st(t);return t=1===r.length?r[0]:t,tt((n&&n.get||rt)(r),[t],e||t)},lt=[],ct=ut("id"),ht=tt((function(t){return t}),lt,"identity"),dt=tt((function(){return 0}),lt,"zero"),ft=tt((function(){return 1}),lt,"one"),pt=tt((function(){return!0}),lt,"true"),mt=tt((function(){return!1}),lt,"false");function gt(t,e,n){var r=[e].concat([].slice.call(n));console[t].apply(console,r)}var yt=0,vt=1,bt=2,wt=3,xt=4,_t=function(t,e){var n=t||yt;return{level:function(t){return arguments.length?(n=+t,this):n},error:function(){return n>=vt&&gt(e||"error","ERROR",arguments),this},warn:function(){return n>=bt&&gt(e||"warn","WARN",arguments),this},info:function(){return n>=wt&&gt(e||"log","INFO",arguments),this},debug:function(){return n>=xt&&gt(e||"log","DEBUG",arguments),this}}},Ct=Array.isArray,kt=function(t){return t===Object(t)};const St=t=>"__proto__"!==t;function Et(...t){return t.reduce((t,e)=>{for(var n in e)"signals"===n?t.signals=At(t.signals,e.signals):Ot(t,n,e[n],"legend"===n?{layout:1}:"style"===n||null);return t},{})}function Ot(t,e,n,r){var i,o;if(St(e))if(kt(n)&&!Ct(n))for(i in o=kt(t[e])?t[e]:t[e]={},n)r&&(!0===r||r[i])?Ot(o,i,n[i]):St(i)&&(o[i]=n[i]);else t[e]=n}function At(t,e){if(null==t)return e;const n={},r=[];function i(t){n[t.name]||(n[t.name]=1,r.push(t))}return e.forEach(i),t.forEach(i),r}var Nt=function(t){return t[t.length-1]},Tt=function(t){return null==t||""===t?null:+t};function Dt(t){return function(e){return t*Math.exp(e)}}function Rt(t){return function(e){return Math.log(t*e)}}function It(t){return function(e){return Math.sign(e)*Math.log1p(Math.abs(e/t))}}function Mt(t){return function(e){return Math.sign(e)*Math.expm1(Math.abs(e))*t}}function Ft(t){return function(e){return e<0?-Math.pow(-e,t):Math.pow(e,t)}}function Pt(t,e,n,r){var i=n(t[0]),o=n(Nt(t)),a=(o-i)*e;return[r(i-a),r(o-a)]}function jt(t,e){return Pt(t,e,Tt,ht)}function zt(t,e){var n=Math.sign(t[0]);return Pt(t,e,Rt(n),Dt(n))}function Lt(t,e,n){return Pt(t,e,Ft(n),Ft(1/n))}function Bt(t,e,n){return Pt(t,e,It(n),Mt(n))}function Ut(t,e,n,r,i){var o=r(t[0]),a=r(Nt(t)),s=null!=e?r(e):(o+a)/2;return[i(s+(o-s)*n),i(s+(a-s)*n)]}function $t(t,e,n){return Ut(t,e,n,Tt,ht)}function Vt(t,e,n){var r=Math.sign(t[0]);return Ut(t,e,n,Rt(r),Dt(r))}function Wt(t,e,n,r){return Ut(t,e,n,Ft(r),Ft(1/r))}function qt(t,e,n,r){return Ut(t,e,n,It(r),Mt(r))}function Ht(t){return 1+~~(new Date(t).getMonth()/3)}function Gt(t){return 1+~~(new Date(t).getUTCMonth()/3)}var Xt=function(t){return null!=t?Ct(t)?t:[t]:[]},Kt=function(t,e,n){var r,i=t[0],o=t[1];return o<i&&(r=o,o=i,i=r),(r=o-i)>=n-e?[e,n]:[i=Math.min(Math.max(i,e),n-r),i+r]},Yt=function(t){return"function"==typeof t},Zt=function(t,e,n){n=n||{},e=Xt(e)||[];const r=[],i=[],o={},a=n.comparator||Jt;return Xt(t).forEach((t,a)=>{null!=t&&(r.push("descending"===e[a]?-1:1),i.push(t=Yt(t)?t:ut(t,null,n)),(nt(t)||[]).forEach(t=>o[t]=1))}),0===i.length?null:tt(a(i,r),Object.keys(o))};const Qt=(t,e)=>(t<e||null==t)&&null!=e?-1:(t>e||null==e)&&null!=t?1:(e=e instanceof Date?+e:e,(t=t instanceof Date?+t:t)!==t&&e==e?-1:e!=e&&t==t?1:0),Jt=(t,e)=>1===t.length?te(t[0],e[0]):ee(t,e,t.length),te=(t,e)=>function(n,r){return Qt(t(n),t(r))*e},ee=(t,e,n)=>(e.push(0),function(r,i){let o,a=0,s=-1;for(;0===a&&++s<n;)o=t[s],a=Qt(o(r),o(i));return a*e[s]});var ne=function(t){return Yt(t)?t:function(){return t}},re=function(t,e){var n,r;function i(){e(r),n=r=null}return function(e){r=e,n&&clearTimeout(n),n=setTimeout(i,t)}},ie=function(t){for(var e,n,r=1,i=arguments.length;r<i;++r)for(n in e=arguments[r])t[n]=e[n];return t},oe=function(t,e){var n,r,i,o,a=0;if(t&&(n=t.length))if(null==e){for(r=t[a];a<n&&(null==r||r!=r);r=t[++a]);for(i=o=r;a<n;++a)null!=(r=t[a])&&(r<i&&(i=r),r>o&&(o=r))}else{for(r=e(t[a]);a<n&&(null==r||r!=r);r=e(t[++a]));for(i=o=r;a<n;++a)null!=(r=e(t[a]))&&(r<i&&(i=r),r>o&&(o=r))}return[i,o]},ae=function(t,e){var n,r,i,o,a,s=-1,u=t.length;if(null==e){for(;++s<u;)if(null!=(r=t[s])&&r>=r){n=i=r;break}if(s===u)return[-1,-1];for(o=a=s;++s<u;)null!=(r=t[s])&&(n>r&&(n=r,o=s),i<r&&(i=r,a=s))}else{for(;++s<u;)if(null!=(r=e(t[s],s,t))&&r>=r){n=i=r;break}if(s===u)return[-1,-1];for(o=a=s;++s<u;)null!=(r=e(t[s],s,t))&&(n>r&&(n=r,o=s),i<r&&(i=r,a=s))}return[o,a]};const se=Object.prototype.hasOwnProperty;var ue=function(t,e){return se.call(t,e)},le={},ce=function(t){var e,n,r={};function i(t){return ue(r,t)&&r[t]!==le}return e={size:0,empty:0,object:r,has:i,get:t=>i(t)?r[t]:void 0,set(t,n){return i(t)||(++e.size,r[t]===le&&--e.empty),r[t]=n,this},delete(t){return i(t)&&(--e.size,++e.empty,r[t]=le),this},clear(){e.size=e.empty=0,e.object=r={}},test(t){return arguments.length?(n=t,e):n},clean(){var t,i,o={},a=0;for(t in r)(i=r[t])===le||n&&n(i)||(o[t]=i,++a);e.size=a,e.empty=0,e.object=r=o}},t&&Object.keys(t).forEach((function(n){e.set(n,t[n])})),e},he=function(t,e,n,r,i,o){if(!n&&0!==n)return o;var a,s,u=t[0],l=Nt(t),c=+n;return l<u&&(a=u,u=l,l=a),(a=Math.abs(e-u))<(s=Math.abs(l-e))&&a<=c?r:s<=c?i:o},de=function(t,e){var n=t.prototype=Object.create(e.prototype);return n.constructor=t,n},fe=function(t,e,n,r){var i,o=e[0],a=e[e.length-1];return o>a&&(i=o,o=a,a=i),r=void 0===r||r,((n=void 0===n||n)?o<=t:o<t)&&(r?t<=a:t<a)},pe=function(t){return"boolean"==typeof t},me=function(t){return"[object Date]"===Object.prototype.toString.call(t)},ge=function(t){return"number"==typeof t},ye=function(t){return"[object RegExp]"===Object.prototype.toString.call(t)},ve=function(t){return"string"==typeof t},be=function(t,e,n){t&&(t=e?Xt(t).map(t=>t.replace(/\\(.)/g,"$1")):Xt(t));const r=t&&t.length,i=n&&n.get||rt,o=t=>i(e?[t]:st(t));let a;if(r)if(1===r){const e=o(t[0]);a=function(t){return""+e(t)}}else{const e=t.map(o);a=function(t){let n=""+e[0](t),i=0;for(;++i<r;)n+="|"+e[i](t);return n}}else a=function(){return""};return tt(a,t,"key")},we=function(t,e){const n=t[0],r=Nt(t),i=+e;return i?1===i?r:n+i*(r-n):n},xe=function(t){let e,n,r;t=+t||1e4;const i=()=>{e={},n={},r=0},o=(i,o)=>(++r>t&&(n=e,e={},r=1),e[i]=o);return i(),{clear:i,has:t=>ue(e,t)||ue(n,t),get:t=>ue(e,t)?e[t]:ue(n,t)?o(t,n[t]):void 0,set:(t,n)=>ue(e,t)?e[t]=n:o(t,n)}},_e=function(t,e,n,r){var i=e.length,o=n.length;if(!o)return e;if(!i)return n;for(var a=r||new e.constructor(i+o),s=0,u=0,l=0;s<i&&u<o;++l)a[l]=t(e[s],n[u])>0?n[u++]:e[s++];for(;s<i;++s,++l)a[l]=e[s];for(;u<o;++u,++l)a[l]=n[u];return a},Ce=function(t,e){for(var n="";--e>=0;)n+=t;return n},ke=function(t,e,n,r){var i=n||" ",o=t+"",a=e-o.length;return a<=0?o:"left"===r?Ce(i,a)+o:"center"===r?Ce(i,~~(a/2))+o+Ce(i,Math.ceil(a/2)):o+Ce(i,a)},Se=function(t){return t&&Nt(t)-t[0]||0};function Ee(t){return Ct(t)?"["+t.map(Ee)+"]":kt(t)||ve(t)?JSON.stringify(t).replace("\u2028","\\u2028").replace("\u2029","\\u2029"):t}var Oe=function(t){return null==t||""===t?null:!(!t||"false"===t||"0"===t||!t)};function Ae(t){return ge(t)||me(t)?t:Date.parse(t)}var Ne=function(t,e){return e=e||Ae,null==t||""===t?null:e(t)},Te=function(t){return null==t||""===t?null:t+""},De=function(t){for(var e={},n=0,r=t.length;n<r;++n)e[t[n]]=!0;return e},Re=function(t,e,n,r){var i=null!=r?r:"\u2026",o=t+"",a=o.length,s=Math.max(0,e-i.length);return a<=e?o:"left"===n?i+o.slice(a-s):"center"===n?o.slice(0,Math.ceil(s/2))+i+o.slice(a-~~(s/2)):o.slice(0,s)+i},Ie=function(t,e,n){if(t)if(e)for(var r,i=0,o=t.length;i<o;++i)(r=e(t[i]))&&n(r,i,t);else t.forEach(n)},Me=function(t,e,n){return t.fields=e||[],t.fname=n,t};function Fe(t){return null==t?null:t.fname}function Pe(t){return null==t?null:t.fields}var je=function(t){return 1===t.length?ze(t[0]):Le(t)};const ze=t=>function(e){return e[t]},Le=t=>{const e=t.length;return function(n){for(let r=0;r<e;++r)n=n[t[r]];return n}};var Be=function(t){throw Error(t)},Ue=function(t){let e,n,r,i=[],o=null,a=0,s=t.length,u="";function l(){i.push(u+t.substring(e,n)),u="",e=n+1}for(t+="",e=n=0;n<s;++n)if(r=t[n],"\\"===r)u+=t.substring(e,n),u+=t.substring(++n,++n),e=n;else if(r===o)l(),o=null,a=-1;else{if(o)continue;e===a&&'"'===r||e===a&&"'"===r?(e=n+1,o=r):"."!==r||a?"["===r?(n>e&&l(),a=e=n+1):"]"===r&&(a||Be("Access path missing open bracket: "+t),a>0&&l(),a=0,e=n+1):n>e?l():e=n+1}return a&&Be("Access path missing closing bracket: "+t),o&&Be("Access path missing closing quote: "+t),n>e&&(n++,l()),i},$e=function(t,e,n){const r=Ue(t);return t=1===r.length?r[0]:t,Me((n&&n.get||je)(r),[t],e||t)};const Ve=$e("id"),We=Me((function(t){return t}),[],"identity"),qe=Me((function(){return 0}),[],"zero"),He=Me((function(){return 1}),[],"one"),Ge=Me((function(){return!0}),[],"true"),Xe=Me((function(){return!1}),[],"false");function Ke(t,e,n){const r=[e].concat([].slice.call(n));console[t].apply(console,r)}var Ye=Array.isArray,Ze=function(t){return t===Object(t)};const Qe=t=>"__proto__"!==t;function Je(t,e,n,r){if(!Qe(e))return;let i,o;if(Ze(n)&&!Ye(n))for(i in o=Ze(t[e])?t[e]:t[e]={},n)r&&(!0===r||r[i])?Je(o,i,n[i]):Qe(i)&&(o[i]=n[i]);else t[e]=n}function tn(t,e){if(null==t)return e;const n={},r=[];function i(t){n[t.name]||(n[t.name]=1,r.push(t))}return e.forEach(i),t.forEach(i),r}var en=function(t){return t[t.length-1]},nn=function(t){return null==t||""===t?null:+t};const rn=t=>e=>t*Math.exp(e),on=t=>e=>Math.log(t*e),an=t=>e=>Math.sign(e)*Math.log1p(Math.abs(e/t)),sn=t=>e=>Math.sign(e)*Math.expm1(Math.abs(e))*t,un=t=>e=>e<0?-Math.pow(-e,t):Math.pow(e,t);function ln(t,e,n,r){const i=n(t[0]),o=n(en(t)),a=(o-i)*e;return[r(i-a),r(o-a)]}function cn(t,e,n,r,i){const o=r(t[0]),a=r(en(t)),s=null!=e?r(e):(o+a)/2;return[i(s+(o-s)*n),i(s+(a-s)*n)]}function hn(t,e,n){return cn(t,e,n,nn,We)}function dn(t,e,n){const r=Math.sign(t[0]);return cn(t,e,n,on(r),rn(r))}function fn(t,e,n,r){return cn(t,e,n,un(r),un(1/r))}function pn(t,e,n,r){return cn(t,e,n,an(r),sn(r))}var mn=function(t){return null!=t?Ye(t)?t:[t]:[]},gn=function(t){return"function"==typeof t},yn=function(t,e,n){n=n||{},e=mn(e)||[];const r=[],i=[],o={},a=n.comparator||bn;return mn(t).forEach((t,a)=>{null!=t&&(r.push("descending"===e[a]?-1:1),i.push(t=gn(t)?t:$e(t,null,n)),(Pe(t)||[]).forEach(t=>o[t]=1))}),0===i.length?null:Me(a(i,r),Object.keys(o))};const vn=(t,e)=>(t<e||null==t)&&null!=e?-1:(t>e||null==e)&&null!=t?1:(e=e instanceof Date?+e:e,(t=t instanceof Date?+t:t)!==t&&e==e?-1:e!=e&&t==t?1:0),bn=(t,e)=>1===t.length?wn(t[0],e[0]):xn(t,e,t.length),wn=(t,e)=>function(n,r){return vn(t(n),t(r))*e},xn=(t,e,n)=>(e.push(0),function(r,i){let o,a=0,s=-1;for(;0===a&&++s<n;)o=t[s],a=vn(o(r),o(i));return a*e[s]});var _n=function(t){return gn(t)?t:()=>t},Cn=function(t,e){let n;return r=>{n&&clearTimeout(n),n=setTimeout(()=>(e(r),n=null),t)}},kn=function(t){for(let e,n,r=1,i=arguments.length;r<i;++r)for(n in e=arguments[r],e)t[n]=e[n];return t},Sn=function(t,e){let n,r,i,o,a=0;if(t&&(n=t.length))if(null==e){for(r=t[a];a<n&&(null==r||r!=r);r=t[++a]);for(i=o=r;a<n;++a)r=t[a],null!=r&&(r<i&&(i=r),r>o&&(o=r))}else{for(r=e(t[a]);a<n&&(null==r||r!=r);r=e(t[++a]));for(i=o=r;a<n;++a)r=e(t[a]),null!=r&&(r<i&&(i=r),r>o&&(o=r))}return[i,o]};const En=Object.prototype.hasOwnProperty;var On=function(t,e){return En.call(t,e)};const An={};var Nn=function(t){let e,n,r={};function i(t){return On(r,t)&&r[t]!==An}return e={size:0,empty:0,object:r,has:i,get:t=>i(t)?r[t]:void 0,set(t,n){return i(t)||(++e.size,r[t]===An&&--e.empty),r[t]=n,this},delete(t){return i(t)&&(--e.size,++e.empty,r[t]=An),this},clear(){e.size=e.empty=0,e.object=r={}},test(t){return arguments.length?(n=t,e):n},clean(){let t,i,o={},a=0;for(t in r)i=r[t],i===An||n&&n(i)||(o[t]=i,++a);e.size=a,e.empty=0,e.object=r=o}},t&&Object.keys(t).forEach((function(n){e.set(n,t[n])})),e},Tn=function(t,e,n){const r=t.prototype=Object.create(e.prototype);return r.constructor=t,kn(r,n)},Dn=function(t,e,n,r){let i,o=e[0],a=e[e.length-1];return o>a&&(i=o,o=a,a=i),r=void 0===r||r,((n=void 0===n||n)?o<=t:o<t)&&(r?t<=a:t<a)},Rn=function(t){return"[object Date]"===Object.prototype.toString.call(t)},In=function(t){return"number"==typeof t},Mn=function(t){return"string"==typeof t},Fn=function(t,e,n){t&&(t=e?mn(t).map(t=>t.replace(/\\(.)/g,"$1")):mn(t));const r=t&&t.length,i=n&&n.get||je,o=t=>i(e?[t]:Ue(t));let a;if(r)if(1===r){const e=o(t[0]);a=function(t){return""+e(t)}}else{const e=t.map(o);a=function(t){let n=""+e[0](t),i=0;for(;++i<r;)n+="|"+e[i](t);return n}}else a=function(){return""};return Me(a,t,"key")},Pn=function(t,e){let n="";for(;--e>=0;)n+=t;return n},jn=function(t){return t&&en(t)-t[0]||0};function zn(t){return Ye(t)?"["+t.map(zn)+"]":Ze(t)||Mn(t)?JSON.stringify(t).replace("\u2028","\\u2028").replace("\u2029","\\u2029"):t}var Ln=function(t){return null==t||""===t?null:!(!t||"false"===t||"0"===t||!t)};const Bn=t=>In(t)||Rn(t)?t:Date.parse(t);var Un=function(t,e){return e=e||Bn,null==t||""===t?null:e(t)},$n=function(t){return null==t||""===t?null:t+""},Vn=function(t){const e={},n=t.length;for(let r=0;r<n;++r)e[t[r]]=!0;return e},Wn=function(t,e,n){if(t)if(e){let r,i=0,o=t.length;for(;i<o;++i)(r=e(t[i]))&&n(r,i,t)}else t.forEach(n)};function qn(t){const e=t||We,n=[],r={};return n.add=t=>{const i=e(t);return r[i]||(r[i]=1,n.push(t)),n},n.remove=t=>{const i=e(t);if(r[i]){r[i]=0;const e=n.indexOf(t);e>=0&&n.splice(e,1)}return n},n}var Hn=async function(t,e){try{await e(t)}catch(n){t.error(n)}};const Gn=Symbol("vega_id");let Xn=1;function Kn(t){return!(!t||!Yn(t))}function Yn(t){return t[Gn]}function Zn(t,e){return t[Gn]=e,t}function Qn(t){const e=t===Object(t)?t:{data:t};return Yn(e)?e:Zn(e,Xn++)}function Jn(t){return tr(t,Qn({}))}function tr(t,e){for(const n in t)e[n]=t[n];return e}function er(t,e){return Zn(e,Yn(t))}function nr(t,e){return t?e?(n,r)=>t(n,r)||Yn(e(n))-Yn(e(r)):(e,n)=>t(e,n)||Yn(e)-Yn(n):null}function rr(t){return t&&t.constructor===ir}function ir(){let t=[],e=[],n=[],r=[],i=[],o=null,a=!1;return{constructor:ir,insert(e){let n=mn(e),r=0,i=n.length;for(;r<i;++r)t.push(n[r]);return this},remove(t){let n=gn(t)?r:e,i=mn(t),o=0,a=i.length;for(;o<a;++o)n.push(i[o]);return this},modify(t,e,r){let o={field:e,value:_n(r)};return gn(t)?(o.filter=t,i.push(o)):(o.tuple=t,n.push(o)),this},encode(t,e){return gn(t)?i.push({filter:t,field:e}):n.push({tuple:t,field:e}),this},clean(t){return o=t,this},reflow(){return a=!0,this},pulse(s,u){let l,c,h,d,f,p,m={},g={};for(l=0,c=u.length;l<c;++l)m[Yn(u[l])]=1;for(l=0,c=e.length;l<c;++l)f=e[l],m[Yn(f)]=-1;for(l=0,c=r.length;l<c;++l)d=r[l],u.forEach(t=>{d(t)&&(m[Yn(t)]=-1)});for(l=0,c=t.length;l<c;++l)f=t[l],p=Yn(f),m[p]?m[p]=1:s.add.push(Qn(t[l]));for(l=0,c=u.length;l<c;++l)f=u[l],m[Yn(f)]<0&&s.rem.push(f);function y(t,e,n){n?t[e]=n(t):s.encode=e,a||(g[Yn(t)]=t)}for(l=0,c=n.length;l<c;++l)h=n[l],f=h.tuple,d=h.field,p=m[Yn(f)],p>0&&(y(f,d,h.value),s.modifies(d));for(l=0,c=i.length;l<c;++l)h=i[l],d=h.filter,u.forEach(t=>{d(t)&&m[Yn(t)]>0&&y(t,h.field,h.value)}),s.modifies(h.field);if(a)s.mod=e.length||r.length?u.filter(t=>m[Yn(t)]>0):u.slice();else for(p in g)s.mod.push(g[p]);return(o||null==o&&(e.length||r.length))&&s.clean(!0),s}}}function or(){Object.defineProperty(this,"_:mod:_",{writable:!0,value:{}})}or.prototype={set(t,e,n,r){const i=this,o=i[t],a=i["_:mod:_"];return null!=e&&e>=0?(o[e]!==n||r)&&(o[e]=n,a[e+":"+t]=-1,a[t]=-1):(o!==n||r)&&(i[t]=n,a[t]=Ye(n)?1+n.length:-1),i},modified(t,e){let n,r=this["_:mod:_"];if(!arguments.length){for(n in r)if(r[n])return!0;return!1}if(Ye(t)){for(n=0;n<t.length;++n)if(r[t[n]])return!0;return!1}return null!=e&&e>=0?e+1<r[t]||!!r[e+":"+t]:!!r[t]},clear(){return this["_:mod:_"]={},this}};let ar=0;const sr=new or;function ur(t,e,n,r){this.id=++ar,this.value=t,this.stamp=-1,this.rank=-1,this.qrank=-1,this.flags=0,e&&(this._update=e),n&&this.parameters(n,r)}function lr(t){return function(e){const n=this.flags;return 0===arguments.length?!!(n&t):(this.flags=e?n|t:n&~t,this)}}ur.prototype={targets(){return this._targets||(this._targets=qn(Ve))},set(t){return this.value!==t?(this.value=t,1):0},skip:lr(1),modified:lr(2),parameters(t,e,n){e=!1!==e;let r,i,o,a,s=this._argval=this._argval||new or,u=this._argops=this._argops||[],l=[];const c=(t,n,r)=>{r instanceof ur?(r!==this&&(e&&r.targets().add(this),l.push(r)),u.push({op:r,name:t,index:n})):s.set(t,n,r)};for(r in t)if(i=t[r],"pulse"===r)mn(i).forEach(t=>{t instanceof ur?t!==this&&(t.targets().add(this),l.push(t)):Be("Pulse parameters must be operator instances.")}),this.source=i;else if(Ye(i))for(s.set(r,-1,Array(o=i.length)),a=0;a<o;++a)c(r,a,i[a]);else c(r,-1,i);return this.marshall().clear(),n&&(u.initonly=!0),l},marshall(t){let e,n,r,i,o,a=this._argval||sr,s=this._argops;if(s){for(n=0,r=s.length;n<r;++n)e=s[n],i=e.op,o=i.modified()&&i.stamp===t,a.set(e.name,e.index,i.value,o);if(s.initonly){for(n=0;n<r;++n)e=s[n],e.op.targets().remove(this);this._argops=null,this._update=null}}return a},detach(){let t,e,n,r,i=this._argops;if(i)for(t=0,e=i.length;t<e;++t)n=i[t],r=n.op,r._targets&&r._targets.remove(this)},evaluate(t){const e=this._update;if(e){const n=this.marshall(t.stamp),r=e.call(this,n,t);if(n.clear(),r!==this.value)this.value=r;else if(!this.modified())return t.StopPropagation}},run(t){if(t.stamp<this.stamp)return t.StopPropagation;let e;return this.skip()?(this.skip(!1),e=0):e=this.evaluate(t),this.pulse=e||t}};let cr=0;function hr(t,e,n){this.id=++cr,this.value=null,n&&(this.receive=n),t&&(this._filter=t),e&&(this._apply=e)}function dr(t,e,n){return new hr(t,e,n)}hr.prototype={_filter:Ge,_apply:We,targets(){return this._targets||(this._targets=qn(Ve))},consume(t){return arguments.length?(this._consume=!!t,this):!!this._consume},receive(t){if(this._filter(t)){let e=this.value=this._apply(t),n=this._targets,r=n?n.length:0,i=0;for(;i<r;++i)n[i].receive(e);this._consume&&(t.preventDefault(),t.stopPropagation())}},filter(t){const e=dr(t);return this.targets().add(e),e},apply(t){const e=dr(null,t);return this.targets().add(e),e},merge(){const t=dr();this.targets().add(t);for(let e=0,n=arguments.length;e<n;++e)arguments[e].targets().add(t);return t},throttle(t){let e=-1;return this.filter(()=>{const n=Date.now();return n-e>t?(e=n,1):0})},debounce(t){const e=dr();return this.targets().add(dr(null,null,Cn(t,t=>{const n=t.dataflow;e.receive(t),n&&n.run&&n.run()}))),e},between(t,e){let n=!1;return t.targets().add(dr(null,null,()=>n=!0)),e.targets().add(dr(null,null,()=>n=!1)),this.filter(()=>n)},detach(){}};const fr=/^([A-Za-z]+:)?\/\//,pr=/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp|file|data):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i,mr=/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205f\u3000]/g;async function gr(t,e){const n=await this.sanitize(t,e),r=n.href;return n.localFile?this.file(r):this.http(r,e)}async function yr(t,e){e=kn({},this.options,e);const n=this.fileAccess,r={href:null};let i,o,a;const s=pr.test(t.replace(mr,""));null!=t&&"string"==typeof t&&s||Be("Sanitize failure, invalid URI: "+zn(t));const u=fr.test(t);return(a=e.baseURL)&&!u&&(t.startsWith("/")||"/"===a[a.length-1]||(t="/"+t),t=a+t),o=(i=t.startsWith("file://"))||"file"===e.mode||"http"!==e.mode&&!u&&n,i?t=t.slice("file://".length):t.startsWith("//")&&("file"===e.defaultProtocol?(t=t.slice(2),o=!0):t=(e.defaultProtocol||"http")+":"+t),Object.defineProperty(r,"localFile",{value:!!o}),r.href=t,e.target&&(r.target=e.target+""),e.rel&&(r.rel=e.rel+""),"image"===e.context&&e.crossOrigin&&(r.crossOrigin=e.crossOrigin+""),r}function vr(t){return t?e=>new Promise((n,r)=>{t.readFile(e,(t,e)=>{t?r(t):n(e)})}):br}async function br(){Be("No file system access.")}function wr(t){return t?async function(e,n){const r=kn({},this.options.http,n),i=n&&n.response,o=await t(e,r);return o.ok?gn(o[i])?o[i]():o.text():Be(o.status+""+o.statusText)}:xr}async function xr(){Be("No HTTP fetch method available.")}const _r=t=>!(Number.isNaN(+t)||t instanceof Date),Cr={boolean:Ln,integer:nn,number:nn,date:Un,string:$n,unknown:We},kr=[t=>"true"===t||"false"===t||!0===t||!1===t,t=>_r(t)&&Number.isInteger(+t),_r,t=>!Number.isNaN(Date.parse(t))],Sr=["boolean","integer","number","date"];function Er(t,e){if(!t||!t.length)return"unknown";const n=t.length,r=kr.length,i=kr.map((t,e)=>e+1);for(let a,s,u=0,l=0;u<n;++u)for(s=e?t[u][e]:t[u],a=0;a<r;++a)if(i[a]&&null!=(o=s)&&o==o&&!kr[a](s)&&(i[a]=0,++l,l===kr.length))return"string";var o;return Sr[i.reduce((t,e)=>0===t?e:t,0)-1]}function Or(t,e){return e.reduce((function(e,n){return e[n]=Er(t,n),e}),{})}var Ar={},Nr={};function Tr(t){return new Function("d","return {"+t.map((function(t,e){return JSON.stringify(t)+": d["+e+'] || ""'})).join(",")+"}")}function Dr(t){var e=Object.create(null),n=[];return t.forEach((function(t){for(var r in t)r in e||n.push(e[r]=r)})),n}function Rr(t,e){var n=t+"",r=n.length;return r<e?new Array(e-r+1).join(0)+n:n}function Ir(t){const e=function(e,n){const r={delimiter:t};return Mr(e,n?kn(n,r):r)};return e.responseType="text",e}function Mr(t,e){return e.header&&(t=e.header.map(zn).join(e.delimiter)+"\n"+t),function(t){var e=new RegExp('["'+t+"\n\r]"),n=t.charCodeAt(0);function r(t,e){var r,i=[],o=t.length,a=0,s=0,u=o<=0,l=!1;function c(){if(u)return Nr;if(l)return l=!1,Ar;var e,r,i=a;if(34===t.charCodeAt(i)){for(;a++<o&&34!==t.charCodeAt(a)||34===t.charCodeAt(++a););return(e=a)>=o?u=!0:10===(r=t.charCodeAt(a++))?l=!0:13===r&&(l=!0,10===t.charCodeAt(a)&&++a),t.slice(i+1,e-1).replace(/""/g,'"')}for(;a<o;){if(10===(r=t.charCodeAt(e=a++)))l=!0;else if(13===r)l=!0,10===t.charCodeAt(a)&&++a;else if(r!==n)continue;return t.slice(i,e)}return u=!0,t.slice(i,o)}for(10===t.charCodeAt(o-1)&&--o,13===t.charCodeAt(o-1)&&--o;(r=c())!==Nr;){for(var h=[];r!==Ar&&r!==Nr;)h.push(r),r=c();e&&null==(h=e(h,s++))||i.push(h)}return i}function i(e,n){return e.map((function(e){return n.map((function(t){return a(e[t])})).join(t)}))}function o(e){return e.map(a).join(t)}function a(t){return null==t?"":t instanceof Date?(i=(n=t).getUTCHours(),o=n.getUTCMinutes(),a=n.getUTCSeconds(),s=n.getUTCMilliseconds(),isNaN(n)?"Invalid Date":((r=n.getUTCFullYear())<0?"-"+Rr(-r,6):r>9999?"+"+Rr(r,6):Rr(r,4))+"-"+Rr(n.getUTCMonth()+1,2)+"-"+Rr(n.getUTCDate(),2)+(s?"T"+Rr(i,2)+":"+Rr(o,2)+":"+Rr(a,2)+"."+Rr(s,3)+"Z":a?"T"+Rr(i,2)+":"+Rr(o,2)+":"+Rr(a,2)+"Z":o||i?"T"+Rr(i,2)+":"+Rr(o,2)+"Z":"")):e.test(t+="")?'"'+t.replace(/"/g,'""')+'"':t;var n,r,i,o,a,s}return{parse:function(t,e){var n,i,o=r(t,(function(t,r){if(n)return n(t,r-1);i=t,n=e?function(t,e){var n=Tr(t);return function(r,i){return e(n(r),i,t)}}(t,e):Tr(t)}));return o.columns=i||[],o},parseRows:r,format:function(e,n){return null==n&&(n=Dr(e)),[n.map(a).join(t)].concat(i(e,n)).join("\n")},formatBody:function(t,e){return null==e&&(e=Dr(t)),i(t,e).join("\n")},formatRows:function(t){return t.map(o).join("\n")},formatRow:o,formatValue:a}}(e.delimiter).parse(t+"")}function Fr(t,e){const n=e&&e.property?$e(e.property):We;return!Ze(t)||(r=t,"function"==typeof Buffer&&gn(Buffer.isBuffer)&&Buffer.isBuffer(r))?n(JSON.parse(t)):function(t,e){return t}(n(t));var r}Mr.responseType="text",Fr.responseType="json";var Pr=function(t){return t},jr=function(t,e){return"string"==typeof e&&(e=t.objects[e]),"GeometryCollection"===e.type?{type:"FeatureCollection",features:e.geometries.map((function(e){return zr(t,e)}))}:zr(t,e)};function zr(t,e){var n=e.id,r=e.bbox,i=null==e.properties?{}:e.properties,o=Lr(t,e);return null==n&&null==r?{type:"Feature",properties:i,geometry:o}:null==r?{type:"Feature",id:n,properties:i,geometry:o}:{type:"Feature",id:n,bbox:r,properties:i,geometry:o}}function Lr(t,e){var n=function(t){if(null==t)return Pr;var e,n,r=t.scale[0],i=t.scale[1],o=t.translate[0],a=t.translate[1];return function(t,s){s||(e=n=0);var u=2,l=t.length,c=new Array(l);for(c[0]=(e+=t[0])*r+o,c[1]=(n+=t[1])*i+a;u<l;)c[u]=t[u],++u;return c}}(t.transform),r=t.arcs;function i(t,e){e.length&&e.pop();for(var i=r[t<0?~t:t],o=0,a=i.length;o<a;++o)e.push(n(i[o],o));t<0&&function(t,e){for(var n,r=t.length,i=r-e;i<--r;)n=t[i],t[i++]=t[r],t[r]=n}(e,a)}function o(t){return n(t)}function a(t){for(var e=[],n=0,r=t.length;n<r;++n)i(t[n],e);return e.length<2&&e.push(e[0]),e}function s(t){for(var e=a(t);e.length<4;)e.push(e[0]);return e}function u(t){return t.map(s)}return function t(e){var n,r=e.type;switch(r){case"GeometryCollection":return{type:r,geometries:e.geometries.map(t)};case"Point":n=o(e.coordinates);break;case"MultiPoint":n=e.coordinates.map(o);break;case"LineString":n=a(e.arcs);break;case"MultiLineString":n=e.arcs.map(a);break;case"Polygon":n=u(e.arcs);break;case"MultiPolygon":n=e.arcs.map(u);break;default:return null}return{type:r,coordinates:n}}(e)}var Br=function(t,e){var n={},r={},i={},o=[],a=-1;function s(t,e){for(var r in t){var i=t[r];delete e[i.start],delete i.start,delete i.end,i.forEach((function(t){n[t<0?~t:t]=1})),o.push(i)}}return e.forEach((function(n,r){var i,o=t.arcs[n<0?~n:n];o.length<3&&!o[1][0]&&!o[1][1]&&(i=e[++a],e[a]=n,e[r]=i)})),e.forEach((function(e){var n,o,a=function(e){var n,r=t.arcs[e<0?~e:e],i=r[0];return t.transform?(n=[0,0],r.forEach((function(t){n[0]+=t[0],n[1]+=t[1]}))):n=r[r.length-1],e<0?[n,i]:[i,n]}(e),s=a[0],u=a[1];if(n=i[s])if(delete i[n.end],n.push(e),n.end=u,o=r[u]){delete r[o.start];var l=o===n?n:n.concat(o);r[l.start=n.start]=i[l.end=o.end]=l}else r[n.start]=i[n.end]=n;else if(n=r[u])if(delete r[n.start],n.unshift(e),n.start=s,o=i[s]){delete i[o.end];var c=o===n?n:o.concat(n);r[c.start=o.start]=i[c.end=n.end]=c}else r[n.start]=i[n.end]=n;else r[(n=[e]).start=s]=i[n.end=u]=n})),s(i,r),s(r,i),e.forEach((function(t){n[t<0?~t:t]||o.push([t])})),o},Ur=function(t){return Lr(t,$r.apply(this,arguments))};function $r(t,e,n){var r,i,o;if(arguments.length>1)r=Vr(0,e,n);else for(i=0,r=new Array(o=t.arcs.length);i<o;++i)r[i]=i;return{type:"MultiLineString",arcs:Br(t,r)}}function Vr(t,e,n){var r,i=[],o=[];function a(t){var e=t<0?~t:t;(o[e]||(o[e]=[])).push({i:t,g:r})}function s(t){t.forEach(a)}function u(t){t.forEach(s)}return function t(e){switch(r=e,e.type){case"GeometryCollection":e.geometries.forEach(t);break;case"LineString":s(e.arcs);break;case"MultiLineString":case"Polygon":u(e.arcs);break;case"MultiPolygon":!function(t){t.forEach(u)}(e.arcs)}}(e),o.forEach(null==n?function(t){i.push(t[0].i)}:function(t){n(t[0].g,t[t.length-1].g)&&i.push(t[0].i)}),i}const Wr={interior:(t,e)=>t!==e,exterior:(t,e)=>t===e};function qr(t,e){let n,r,i,o;return t=Fr(t,e),e&&e.feature?(n=jr,i=e.feature):e&&e.mesh?(n=Ur,i=e.mesh,o=Wr[e.filter]):Be("Missing TopoJSON feature or mesh parameter."),r=(r=t.objects[i])?n(t,r,o):Be("Invalid TopoJSON object: "+i),r&&r.features||[r]}qr.responseType="json";const Hr={dsv:Mr,csv:Ir(","),tsv:Ir("\t"),json:Fr,topojson:qr};function Gr(t,e){return arguments.length>1?(Hr[t]=e,this):On(Hr,t)?Hr[t]:null}function Xr(t){const e=Gr(t);return e&&e.responseType||"text"}var Kr=function(t){const e={};return n=>e[n]||(e[n]=t(n))},Yr=Math.sqrt(50),Zr=Math.sqrt(10),Qr=Math.sqrt(2),Jr=function(t,e,n){var r,i,o,a,s=-1;if(n=+n,(t=+t)==(e=+e)&&n>0)return[t];if((r=e<t)&&(i=t,t=e,e=i),0===(a=ti(t,e,n))||!isFinite(a))return[];if(a>0)for(t=Math.ceil(t/a),e=Math.floor(e/a),o=new Array(i=Math.ceil(e-t+1));++s<i;)o[s]=(t+s)*a;else for(a=-a,t=Math.ceil(t*a),e=Math.floor(e*a),o=new Array(i=Math.ceil(e-t+1));++s<i;)o[s]=(t+s)/a;return r&&o.reverse(),o};function ti(t,e,n){var r=(e-t)/Math.max(0,n),i=Math.floor(Math.log(r)/Math.LN10),o=r/Math.pow(10,i);return i>=0?(o>=Yr?10:o>=Zr?5:o>=Qr?2:1)*Math.pow(10,i):-Math.pow(10,-i)/(o>=Yr?10:o>=Zr?5:o>=Qr?2:1)}function ei(t,e,n){var r=Math.abs(e-t)/Math.max(0,n),i=Math.pow(10,Math.floor(Math.log(r)/Math.LN10)),o=r/i;return o>=Yr?i*=10:o>=Zr?i*=5:o>=Qr&&(i*=2),e<t?-i:i}var ni=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function ri(t){if(!(e=ni.exec(t)))throw new Error("invalid format: "+t);var e;return new ii({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}function ii(t){this.fill=void 0===t.fill?" ":t.fill+"",this.align=void 0===t.align?">":t.align+"",this.sign=void 0===t.sign?"-":t.sign+"",this.symbol=void 0===t.symbol?"":t.symbol+"",this.zero=!!t.zero,this.width=void 0===t.width?void 0:+t.width,this.comma=!!t.comma,this.precision=void 0===t.precision?void 0:+t.precision,this.trim=!!t.trim,this.type=void 0===t.type?"":t.type+""}ri.prototype=ii.prototype,ii.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(void 0===this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(void 0===this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};var oi,ai,si,ui,li=function(t,e){if((n=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var n,r=t.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+t.slice(n+1)]},ci=function(t){return(t=li(Math.abs(t)))?t[1]:NaN},hi=function(t,e){var n=li(t,e);if(!n)return t+"";var r=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")},di={"%":function(t,e){return(100*t).toFixed(e)},b:function(t){return Math.round(t).toString(2)},c:function(t){return t+""},d:function(t){return Math.round(t).toString(10)},e:function(t,e){return t.toExponential(e)},f:function(t,e){return t.toFixed(e)},g:function(t,e){return t.toPrecision(e)},o:function(t){return Math.round(t).toString(8)},p:function(t,e){return hi(100*t,e)},r:hi,s:function(t,e){var n=li(t,e);if(!n)return t+"";var r=n[0],i=n[1],o=i-(oi=3*Math.max(-8,Math.min(8,Math.floor(i/3))))+1,a=r.length;return o===a?r:o>a?r+new Array(o-a+1).join("0"):o>0?r.slice(0,o)+"."+r.slice(o):"0."+new Array(1-o).join("0")+li(t,Math.max(0,e+o-1))[0]},X:function(t){return Math.round(t).toString(16).toUpperCase()},x:function(t){return Math.round(t).toString(16)}},fi=function(t){return t},pi=Array.prototype.map,mi=["y","z","a","f","p","n","\xb5","m","","k","M","G","T","P","E","Z","Y"],gi=function(t){var e,n,r=void 0===t.grouping||void 0===t.thousands?fi:(e=pi.call(t.grouping,Number),n=t.thousands+"",function(t,r){for(var i=t.length,o=[],a=0,s=e[0],u=0;i>0&&s>0&&(u+s+1>r&&(s=Math.max(1,r-u)),o.push(t.substring(i-=s,i+s)),!((u+=s+1)>r));)s=e[a=(a+1)%e.length];return o.reverse().join(n)}),i=void 0===t.currency?"":t.currency[0]+"",o=void 0===t.currency?"":t.currency[1]+"",a=void 0===t.decimal?".":t.decimal+"",s=void 0===t.numerals?fi:function(t){return function(e){return e.replace(/[0-9]/g,(function(e){return t[+e]}))}}(pi.call(t.numerals,String)),u=void 0===t.percent?"%":t.percent+"",l=void 0===t.minus?"-":t.minus+"",c=void 0===t.nan?"NaN":t.nan+"";function h(t){var e=(t=ri(t)).fill,n=t.align,h=t.sign,d=t.symbol,f=t.zero,p=t.width,m=t.comma,g=t.precision,y=t.trim,v=t.type;"n"===v?(m=!0,v="g"):di[v]||(void 0===g&&(g=12),y=!0,v="g"),(f||"0"===e&&"="===n)&&(f=!0,e="0",n="=");var b="$"===d?i:"#"===d&&/[boxX]/.test(v)?"0"+v.toLowerCase():"",w="$"===d?o:/[%p]/.test(v)?u:"",x=di[v],_=/[defgprs%]/.test(v);function C(t){var i,o,u,d=b,C=w;if("c"===v)C=x(t)+C,t="";else{var k=(t=+t)<0||1/t<0;if(t=isNaN(t)?c:x(Math.abs(t),g),y&&(t=function(t){t:for(var e,n=t.length,r=1,i=-1;r<n;++r)switch(t[r]){case".":i=e=r;break;case"0":0===i&&(i=r),e=r;break;default:if(!+t[r])break t;i>0&&(i=0)}return i>0?t.slice(0,i)+t.slice(e+1):t}(t)),k&&0==+t&&"+"!==h&&(k=!1),d=(k?"("===h?h:l:"-"===h||"("===h?"":h)+d,C=("s"===v?mi[8+oi/3]:"")+C+(k&&"("===h?")":""),_)for(i=-1,o=t.length;++i<o;)if(48>(u=t.charCodeAt(i))||u>57){C=(46===u?a+t.slice(i+1):t.slice(i))+C,t=t.slice(0,i);break}}m&&!f&&(t=r(t,1/0));var S=d.length+t.length+C.length,E=S<p?new Array(p-S+1).join(e):"";switch(m&&f&&(t=r(E+t,E.length?p-C.length:1/0),E=""),n){case"<":t=d+t+C+E;break;case"=":t=d+E+t+C;break;case"^":t=E.slice(0,S=E.length>>1)+d+t+C+E.slice(S);break;default:t=E+d+t+C}return s(t)}return g=void 0===g?6:/[gprs]/.test(v)?Math.max(1,Math.min(21,g)):Math.max(0,Math.min(20,g)),C.toString=function(){return t+""},C}return{format:h,formatPrefix:function(t,e){var n=h(((t=ri(t)).type="f",t)),r=3*Math.max(-8,Math.min(8,Math.floor(ci(e)/3))),i=Math.pow(10,-r),o=mi[8+r/3];return function(t){return n(i*t)+o}}}};function yi(t){const e=Kr(t.format),n=t.formatPrefix;return{format:e,formatPrefix:n,formatFloat(t){const n=ri(t||",");if(null==n.precision){switch(n.precision=12,n.type){case"%":n.precision-=2;break;case"e":n.precision-=1}return function(t,e){return n=>{let r,i,o=t(n),a=o.indexOf(e);if(a<0)return o;for(r=function(t,e){let n,r=t.lastIndexOf("e");if(r>0)return r;for(r=t.length;--r>e;)if(n=t.charCodeAt(r),n>=48&&n<=57)return r+1}(o,a),i=r<o.length?o.slice(r):"";--r>a;)if("0"!==o[r]){++r;break}return o.slice(0,r)+i}}(e(n),e(".1f")(1)[1])}return e(n)},formatSpan(t,r,i,o){o=ri(null==o?",f":o);const a=ei(t,r,i),s=Math.max(Math.abs(t),Math.abs(r));let u;if(null==o.precision)switch(o.type){case"s":return isNaN(u=function(t,e){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(ci(e)/3)))-ci(Math.abs(t)))}(a,s))||(o.precision=u),n(o,s);case"":case"e":case"g":case"p":case"r":isNaN(u=function(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,ci(e)-ci(t))+1}(a,s))||(o.precision=u-("e"===o.type));break;case"f":case"%":isNaN(u=function(t){return Math.max(0,-ci(Math.abs(t)))}(a))||(o.precision=u-2*("%"===o.type))}return e(o)}}}let vi;function bi(){return vi=yi({format:si,formatPrefix:ui})}function wi(t){return yi(gi(t))}function xi(t){return arguments.length?vi=wi(t):vi}ai=gi({decimal:".",thousands:",",grouping:[3],currency:["$",""],minus:"-"}),si=ai.format,ui=ai.formatPrefix,bi();const _i="year",Ci="quarter",ki="month",Si="week",Ei="date",Oi="day",Ai="dayofyear",Ni="hours",Ti="minutes",Di="seconds",Ri="milliseconds",Ii=[_i,Ci,ki,Si,Ei,Oi,Ai,Ni,Ti,Di,Ri],Mi=Ii.reduce((t,e,n)=>(t[e]=1+n,t),{});function Fi(t){const e=mn(t).slice(),n={};return e.length||Be("Missing time unit."),e.forEach(t=>{On(Mi,t)?n[t]=1:Be(`Invalid time unit: ${t}.`)}),(n[Si]||n[Oi]?1:0)+(n[Ci]||n[ki]||n[Ei]?1:0)+(n[Ai]?1:0)>1&&Be("Incompatible time units: "+t),e.sort((t,e)=>Mi[t]-Mi[e]),e}const Pi={[_i]:"%Y ",[Ci]:"Q%q ",[ki]:"%b ",[Ei]:"%d ",[Si]:"W%U ",[Oi]:"%a ",[Ai]:"%j ",[Ni]:"%H:00",[Ti]:"00:%M",[Di]:":%S",[Ri]:".%L",[`${_i}-${ki}`]:"%Y-%m ",[`${_i}-${ki}-${Ei}`]:"%Y-%m-%d ",[`${Ni}-${Ti}`]:"%H:%M"};function ji(t,e){const n=kn({},Pi,e),r=Fi(t),i=r.length;let o,a,s="",u=0;for(u=0;u<i;)for(o=r.length;o>u;--o)if(a=r.slice(u,o).join("-"),null!=n[a]){s+=n[a],u=o;break}return s.trim()}var zi=new Date,Li=new Date;function Bi(t,e,n,r){function i(e){return t(e=0===arguments.length?new Date:new Date(+e)),e}return i.floor=function(e){return t(e=new Date(+e)),e},i.ceil=function(n){return t(n=new Date(n-1)),e(n,1),t(n),n},i.round=function(t){var e=i(t),n=i.ceil(t);return t-e<n-t?e:n},i.offset=function(t,n){return e(t=new Date(+t),null==n?1:Math.floor(n)),t},i.range=function(n,r,o){var a,s=[];if(n=i.ceil(n),o=null==o?1:Math.floor(o),!(n<r&&o>0))return s;do{s.push(a=new Date(+n)),e(n,o),t(n)}while(a<n&&n<r);return s},i.filter=function(n){return Bi((function(e){if(e>=e)for(;t(e),!n(e);)e.setTime(e-1)}),(function(t,r){if(t>=t)if(r<0)for(;++r<=0;)for(;e(t,-1),!n(t););else for(;--r>=0;)for(;e(t,1),!n(t););}))},n&&(i.count=function(e,r){return zi.setTime(+e),Li.setTime(+r),t(zi),t(Li),Math.floor(n(zi,Li))},i.every=function(t){return t=Math.floor(t),isFinite(t)&&t>0?t>1?i.filter(r?function(e){return r(e)%t==0}:function(e){return i.count(0,e)%t==0}):i:null}),i}var Ui=Bi((function(t){t.setHours(0,0,0,0)}),(function(t,e){t.setDate(t.getDate()+e)}),(function(t,e){return(e-t-6e4*(e.getTimezoneOffset()-t.getTimezoneOffset()))/864e5}),(function(t){return t.getDate()-1}));function $i(t){return Bi((function(e){e.setDate(e.getDate()-(e.getDay()+7-t)%7),e.setHours(0,0,0,0)}),(function(t,e){t.setDate(t.getDate()+7*e)}),(function(t,e){return(e-t-6e4*(e.getTimezoneOffset()-t.getTimezoneOffset()))/6048e5}))}var Vi=$i(0),Wi=$i(1),qi=($i(2),$i(3),$i(4)),Hi=($i(5),$i(6),Bi((function(t){t.setUTCHours(0,0,0,0)}),(function(t,e){t.setUTCDate(t.getUTCDate()+e)}),(function(t,e){return(e-t)/864e5}),(function(t){return t.getUTCDate()-1})));function Gi(t){return Bi((function(e){e.setUTCDate(e.getUTCDate()-(e.getUTCDay()+7-t)%7),e.setUTCHours(0,0,0,0)}),(function(t,e){t.setUTCDate(t.getUTCDate()+7*e)}),(function(t,e){return(e-t)/6048e5}))}var Xi=Gi(0),Ki=Gi(1),Yi=(Gi(2),Gi(3),Gi(4));Gi(5),Gi(6);const Zi=new Date;function Qi(t){return Zi.setFullYear(t),Zi.setMonth(0),Zi.setDate(1),Zi.setHours(0,0,0,0),Zi}function Ji(t){return eo(new Date(t))}function to(t){return no(new Date(t))}function eo(t){return Ui.count(Qi(t.getFullYear())-1,t)}function no(t){return Vi.count(Qi(t.getFullYear())-1,t)}function ro(t){return Qi(t).getDay()}function io(t,e,n,r,i,o,a){if(0<=t&&t<100){const s=new Date(-1,e,n,r,i,o,a);return s.setFullYear(t),s}return new Date(t,e,n,r,i,o,a)}function oo(t){return so(new Date(t))}function ao(t){return uo(new Date(t))}function so(t){const e=Date.UTC(t.getUTCFullYear(),0,1);return Hi.count(e-1,t)}function uo(t){const e=Date.UTC(t.getUTCFullYear(),0,1);return Xi.count(e-1,t)}function lo(t){return Zi.setTime(Date.UTC(t,0,1)),Zi.getUTCDay()}function co(t,e,n,r,i,o,a){if(0<=t&&t<100){const t=new Date(Date.UTC(-1,e,n,r,i,o,a));return t.setUTCFullYear(n.y),t}return new Date(Date.UTC(t,e,n,r,i,o,a))}function ho(t,e,n,r,i){const o=e||1,a=en(t),s=(t,e,i)=>function(t,e,n,r){const i=n<=1?t:r?(e,i)=>r+n*Math.floor((t(e,i)-r)/n):(e,r)=>n*Math.floor(t(e,r)/n);return e?(t,n)=>e(i(t,n),n):i}(n[i=i||t],r[i],t===a&&o,e),u=new Date,l=Vn(t),c=l[_i]?s(_i):_n(2012),h=l[ki]?s(ki):l[Ci]?s(Ci):qe,d=l[Si]&&l[Oi]?s(Oi,1,Si+Oi):l[Si]?s(Si,1):l[Oi]?s(Oi,1):l[Ei]?s(Ei,1):l[Ai]?s(Ai,1):He,f=l[Ni]?s(Ni):qe,p=l[Ti]?s(Ti):qe,m=l[Di]?s(Di):qe,g=l[Ri]?s(Ri):qe;return function(t){u.setTime(+t);const e=c(u);return i(e,h(u),d(u,e),f(u),p(u),m(u),g(u))}}function fo(t,e,n){return e+7*t-(n+6)%7}const po={[_i]:t=>t.getFullYear(),[Ci]:t=>Math.floor(t.getMonth()/3),[ki]:t=>t.getMonth(),[Ei]:t=>t.getDate(),[Ni]:t=>t.getHours(),[Ti]:t=>t.getMinutes(),[Di]:t=>t.getSeconds(),[Ri]:t=>t.getMilliseconds(),[Ai]:t=>eo(t),[Si]:t=>no(t),[Si+Oi]:(t,e)=>fo(no(t),t.getDay(),ro(e)),[Oi]:(t,e)=>fo(1,t.getDay(),ro(e))},mo={[Ci]:t=>3*t,[Si]:(t,e)=>fo(t,0,ro(e))};function go(t,e){return ho(t,e||1,po,mo,io)}const yo={[_i]:t=>t.getUTCFullYear(),[Ci]:t=>Math.floor(t.getUTCMonth()/3),[ki]:t=>t.getUTCMonth(),[Ei]:t=>t.getUTCDate(),[Ni]:t=>t.getUTCHours(),[Ti]:t=>t.getUTCMinutes(),[Di]:t=>t.getUTCSeconds(),[Ri]:t=>t.getUTCMilliseconds(),[Ai]:t=>so(t),[Si]:t=>uo(t),[Oi]:(t,e)=>fo(1,t.getUTCDay(),lo(e)),[Si+Oi]:(t,e)=>fo(uo(t),t.getUTCDay(),lo(e))},vo={[Ci]:t=>3*t,[Si]:(t,e)=>fo(t,0,lo(e))};function bo(t,e){return ho(t,e||1,yo,vo,co)}var wo=Bi((function(t){t.setMonth(0,1),t.setHours(0,0,0,0)}),(function(t,e){t.setFullYear(t.getFullYear()+e)}),(function(t,e){return e.getFullYear()-t.getFullYear()}),(function(t){return t.getFullYear()}));wo.every=function(t){return isFinite(t=Math.floor(t))&&t>0?Bi((function(e){e.setFullYear(Math.floor(e.getFullYear()/t)*t),e.setMonth(0,1),e.setHours(0,0,0,0)}),(function(e,n){e.setFullYear(e.getFullYear()+n*t)})):null};var xo=wo,_o=Bi((function(t){t.setDate(1),t.setHours(0,0,0,0)}),(function(t,e){t.setMonth(t.getMonth()+e)}),(function(t,e){return e.getMonth()-t.getMonth()+12*(e.getFullYear()-t.getFullYear())}),(function(t){return t.getMonth()})),Co=Bi((function(t){t.setTime(t-t.getMilliseconds()-1e3*t.getSeconds()-6e4*t.getMinutes())}),(function(t,e){t.setTime(+t+36e5*e)}),(function(t,e){return(e-t)/36e5}),(function(t){return t.getHours()})),ko=Bi((function(t){t.setTime(t-t.getMilliseconds()-1e3*t.getSeconds())}),(function(t,e){t.setTime(+t+6e4*e)}),(function(t,e){return(e-t)/6e4}),(function(t){return t.getMinutes()})),So=Bi((function(t){t.setTime(t-t.getMilliseconds())}),(function(t,e){t.setTime(+t+1e3*e)}),(function(t,e){return(e-t)/1e3}),(function(t){return t.getUTCSeconds()})),Eo=Bi((function(){}),(function(t,e){t.setTime(+t+e)}),(function(t,e){return e-t}));Eo.every=function(t){return t=Math.floor(t),isFinite(t)&&t>0?t>1?Bi((function(e){e.setTime(Math.floor(e/t)*t)}),(function(e,n){e.setTime(+e+n*t)}),(function(e,n){return(n-e)/t})):Eo:null};var Oo=Eo,Ao=Bi((function(t){t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)}),(function(t,e){t.setUTCFullYear(t.getUTCFullYear()+e)}),(function(t,e){return e.getUTCFullYear()-t.getUTCFullYear()}),(function(t){return t.getUTCFullYear()}));Ao.every=function(t){return isFinite(t=Math.floor(t))&&t>0?Bi((function(e){e.setUTCFullYear(Math.floor(e.getUTCFullYear()/t)*t),e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)}),(function(e,n){e.setUTCFullYear(e.getUTCFullYear()+n*t)})):null};var No=Ao,To=Bi((function(t){t.setUTCDate(1),t.setUTCHours(0,0,0,0)}),(function(t,e){t.setUTCMonth(t.getUTCMonth()+e)}),(function(t,e){return e.getUTCMonth()-t.getUTCMonth()+12*(e.getUTCFullYear()-t.getUTCFullYear())}),(function(t){return t.getUTCMonth()})),Do=Bi((function(t){t.setUTCMinutes(0,0,0)}),(function(t,e){t.setTime(+t+36e5*e)}),(function(t,e){return(e-t)/36e5}),(function(t){return t.getUTCHours()})),Ro=Bi((function(t){t.setUTCSeconds(0,0)}),(function(t,e){t.setTime(+t+6e4*e)}),(function(t,e){return(e-t)/6e4}),(function(t){return t.getUTCMinutes()}));const Io={[_i]:xo,[Ci]:_o.every(3),[ki]:_o,[Si]:Vi,[Ei]:Ui,[Oi]:Ui,[Ai]:Ui,[Ni]:Co,[Ti]:ko,[Di]:So,[Ri]:Oo},Mo={[_i]:No,[Ci]:To.every(3),[ki]:To,[Si]:Xi,[Ei]:Hi,[Oi]:Hi,[Ai]:Hi,[Ni]:Do,[Ti]:Ro,[Di]:So,[Ri]:Oo};function Fo(t){return Io[t]}function Po(t){return Mo[t]}function jo(t,e,n){return t?t.offset(e,n):void 0}function zo(t,e,n){return jo(Fo(t),e,n)}function Lo(t,e,n){return jo(Po(t),e,n)}function Bo(t,e,n,r){return t?t.range(e,n,r):void 0}function Uo(t,e,n,r){return Bo(Fo(t),e,n,r)}function $o(t,e,n,r){return Bo(Po(t),e,n,r)}var Vo=function(t,e){return t<e?-1:t>e?1:t>=e?0:NaN},Wo=function(t){var e;return 1===t.length&&(e=t,t=function(t,n){return Vo(e(t),n)}),{left:function(e,n,r,i){for(null==r&&(r=0),null==i&&(i=e.length);r<i;){var o=r+i>>>1;t(e[o],n)<0?r=o+1:i=o}return r},right:function(e,n,r,i){for(null==r&&(r=0),null==i&&(i=e.length);r<i;){var o=r+i>>>1;t(e[o],n)>0?i=o:r=o+1}return r}}};const qo=[_i,ki,Ei,Ni,Ti,Di,Ri],Ho=qo.slice(0,-1),Go=Ho.slice(0,-1),Xo=Go.slice(0,-1),Ko=Xo.slice(0,-1),Yo=[_i,ki],Zo=[_i],Qo=[[Ho,1,1e3],[Ho,5,5e3],[Ho,15,15e3],[Ho,30,3e4],[Go,1,6e4],[Go,5,3e5],[Go,15,9e5],[Go,30,18e5],[Xo,1,36e5],[Xo,3,108e5],[Xo,6,216e5],[Xo,12,432e5],[Ko,1,864e5],[[_i,Si],1,6048e5],[Yo,1,2592e6],[Yo,3,7776e6],[Zo,1,31536e6]];var Jo=function(t){const e=t.extent,n=t.maxbins||40,r=Math.abs(jn(e))/n;let i,o,a=Wo(t=>t[2]).right(Qo,r);return a===Qo.length?(i=Zo,o=ei(e[0]/31536e6,e[1]/31536e6,n)):a?(a=Qo[r/Qo[a-1][2]<Qo[a][2]/r?a-1:a],i=a[0],o=a[1]):(i=qo,o=Math.max(ei(e[0],e[1],n),1)),{units:i,step:o}};function ta(t){if(0<=t.y&&t.y<100){var e=new Date(-1,t.m,t.d,t.H,t.M,t.S,t.L);return e.setFullYear(t.y),e}return new Date(t.y,t.m,t.d,t.H,t.M,t.S,t.L)}function ea(t){if(0<=t.y&&t.y<100){var e=new Date(Date.UTC(-1,t.m,t.d,t.H,t.M,t.S,t.L));return e.setUTCFullYear(t.y),e}return new Date(Date.UTC(t.y,t.m,t.d,t.H,t.M,t.S,t.L))}function na(t,e,n){return{y:t,m:e,d:n,H:0,M:0,S:0,L:0}}function ra(t){var e=t.dateTime,n=t.date,r=t.time,i=t.periods,o=t.days,a=t.shortDays,s=t.months,u=t.shortMonths,l=ma(i),c=ga(i),h=ma(o),d=ga(o),f=ma(a),p=ga(a),m=ma(s),g=ga(s),y=ma(u),v=ga(u),b={a:function(t){return a[t.getDay()]},A:function(t){return o[t.getDay()]},b:function(t){return u[t.getMonth()]},B:function(t){return s[t.getMonth()]},c:null,d:ja,e:ja,f:$a,H:za,I:La,j:Ba,L:Ua,m:Va,M:Wa,p:function(t){return i[+(t.getHours()>=12)]},q:function(t){return 1+~~(t.getMonth()/3)},Q:vs,s:bs,S:qa,u:Ha,U:Ga,V:Xa,w:Ka,W:Ya,x:null,X:null,y:Za,Y:Qa,Z:Ja,"%":ys},w={a:function(t){return a[t.getUTCDay()]},A:function(t){return o[t.getUTCDay()]},b:function(t){return u[t.getUTCMonth()]},B:function(t){return s[t.getUTCMonth()]},c:null,d:ts,e:ts,f:os,H:es,I:ns,j:rs,L:is,m:as,M:ss,p:function(t){return i[+(t.getUTCHours()>=12)]},q:function(t){return 1+~~(t.getUTCMonth()/3)},Q:vs,s:bs,S:us,u:ls,U:cs,V:hs,w:ds,W:fs,x:null,X:null,y:ps,Y:ms,Z:gs,"%":ys},x={a:function(t,e,n){var r=f.exec(e.slice(n));return r?(t.w=p[r[0].toLowerCase()],n+r[0].length):-1},A:function(t,e,n){var r=h.exec(e.slice(n));return r?(t.w=d[r[0].toLowerCase()],n+r[0].length):-1},b:function(t,e,n){var r=y.exec(e.slice(n));return r?(t.m=v[r[0].toLowerCase()],n+r[0].length):-1},B:function(t,e,n){var r=m.exec(e.slice(n));return r?(t.m=g[r[0].toLowerCase()],n+r[0].length):-1},c:function(t,n,r){return k(t,e,n,r)},d:Oa,e:Oa,f:Ia,H:Na,I:Na,j:Aa,L:Ra,m:Ea,M:Ta,p:function(t,e,n){var r=l.exec(e.slice(n));return r?(t.p=c[r[0].toLowerCase()],n+r[0].length):-1},q:Sa,Q:Fa,s:Pa,S:Da,u:va,U:ba,V:wa,w:ya,W:xa,x:function(t,e,r){return k(t,n,e,r)},X:function(t,e,n){return k(t,r,e,n)},y:Ca,Y:_a,Z:ka,"%":Ma};function _(t,e){return function(n){var r,i,o,a=[],s=-1,u=0,l=t.length;for(n instanceof Date||(n=new Date(+n));++s<l;)37===t.charCodeAt(s)&&(a.push(t.slice(u,s)),null!=(i=la[r=t.charAt(++s)])?r=t.charAt(++s):i="e"===r?" ":"0",(o=e[r])&&(r=o(n,i)),a.push(r),u=s+1);return a.push(t.slice(u,s)),a.join("")}}function C(t,e){return function(n){var r,i,o=na(1900,void 0,1);if(k(o,t,n+="",0)!=n.length)return null;if("Q"in o)return new Date(o.Q);if("s"in o)return new Date(1e3*o.s+("L"in o?o.L:0));if(e&&!("Z"in o)&&(o.Z=0),"p"in o&&(o.H=o.H%12+12*o.p),void 0===o.m&&(o.m="q"in o?o.q:0),"V"in o){if(o.V<1||o.V>53)return null;"w"in o||(o.w=1),"Z"in o?(i=(r=ea(na(o.y,0,1))).getUTCDay(),r=i>4||0===i?Ki.ceil(r):Ki(r),r=Hi.offset(r,7*(o.V-1)),o.y=r.getUTCFullYear(),o.m=r.getUTCMonth(),o.d=r.getUTCDate()+(o.w+6)%7):(i=(r=ta(na(o.y,0,1))).getDay(),r=i>4||0===i?Wi.ceil(r):Wi(r),r=Ui.offset(r,7*(o.V-1)),o.y=r.getFullYear(),o.m=r.getMonth(),o.d=r.getDate()+(o.w+6)%7)}else("W"in o||"U"in o)&&("w"in o||(o.w="u"in o?o.u%7:"W"in o?1:0),i="Z"in o?ea(na(o.y,0,1)).getUTCDay():ta(na(o.y,0,1)).getDay(),o.m=0,o.d="W"in o?(o.w+6)%7+7*o.W-(i+5)%7:o.w+7*o.U-(i+6)%7);return"Z"in o?(o.H+=o.Z/100|0,o.M+=o.Z%100,ea(o)):ta(o)}}function k(t,e,n,r){for(var i,o,a=0,s=e.length,u=n.length;a<s;){if(r>=u)return-1;if(37===(i=e.charCodeAt(a++))){if(i=e.charAt(a++),!(o=x[i in la?e.charAt(a++):i])||(r=o(t,n,r))<0)return-1}else if(i!=n.charCodeAt(r++))return-1}return r}return b.x=_(n,b),b.X=_(r,b),b.c=_(e,b),w.x=_(n,w),w.X=_(r,w),w.c=_(e,w),{format:function(t){var e=_(t+="",b);return e.toString=function(){return t},e},parse:function(t){var e=C(t+="",!1);return e.toString=function(){return t},e},utcFormat:function(t){var e=_(t+="",w);return e.toString=function(){return t},e},utcParse:function(t){var e=C(t+="",!0);return e.toString=function(){return t},e}}}var ia,oa,aa,sa,ua,la={"-":"",_:" ",0:"0"},ca=/^\s*\d+/,ha=/^%/,da=/[\\^$*+?|[\]().{}]/g;function fa(t,e,n){var r=t<0?"-":"",i=(r?-t:t)+"",o=i.length;return r+(o<n?new Array(n-o+1).join(e)+i:i)}function pa(t){return t.replace(da,"\\$&")}function ma(t){return new RegExp("^(?:"+t.map(pa).join("|")+")","i")}function ga(t){for(var e={},n=-1,r=t.length;++n<r;)e[t[n].toLowerCase()]=n;return e}function ya(t,e,n){var r=ca.exec(e.slice(n,n+1));return r?(t.w=+r[0],n+r[0].length):-1}function va(t,e,n){var r=ca.exec(e.slice(n,n+1));return r?(t.u=+r[0],n+r[0].length):-1}function ba(t,e,n){var r=ca.exec(e.slice(n,n+2));return r?(t.U=+r[0],n+r[0].length):-1}function wa(t,e,n){var r=ca.exec(e.slice(n,n+2));return r?(t.V=+r[0],n+r[0].length):-1}function xa(t,e,n){var r=ca.exec(e.slice(n,n+2));return r?(t.W=+r[0],n+r[0].length):-1}function _a(t,e,n){var r=ca.exec(e.slice(n,n+4));return r?(t.y=+r[0],n+r[0].length):-1}function Ca(t,e,n){var r=ca.exec(e.slice(n,n+2));return r?(t.y=+r[0]+(+r[0]>68?1900:2e3),n+r[0].length):-1}function ka(t,e,n){var r=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(e.slice(n,n+6));return r?(t.Z=r[1]?0:-(r[2]+(r[3]||"00")),n+r[0].length):-1}function Sa(t,e,n){var r=ca.exec(e.slice(n,n+1));return r?(t.q=3*r[0]-3,n+r[0].length):-1}function Ea(t,e,n){var r=ca.exec(e.slice(n,n+2));return r?(t.m=r[0]-1,n+r[0].length):-1}function Oa(t,e,n){var r=ca.exec(e.slice(n,n+2));return r?(t.d=+r[0],n+r[0].length):-1}function Aa(t,e,n){var r=ca.exec(e.slice(n,n+3));return r?(t.m=0,t.d=+r[0],n+r[0].length):-1}function Na(t,e,n){var r=ca.exec(e.slice(n,n+2));return r?(t.H=+r[0],n+r[0].length):-1}function Ta(t,e,n){var r=ca.exec(e.slice(n,n+2));return r?(t.M=+r[0],n+r[0].length):-1}function Da(t,e,n){var r=ca.exec(e.slice(n,n+2));return r?(t.S=+r[0],n+r[0].length):-1}function Ra(t,e,n){var r=ca.exec(e.slice(n,n+3));return r?(t.L=+r[0],n+r[0].length):-1}function Ia(t,e,n){var r=ca.exec(e.slice(n,n+6));return r?(t.L=Math.floor(r[0]/1e3),n+r[0].length):-1}function Ma(t,e,n){var r=ha.exec(e.slice(n,n+1));return r?n+r[0].length:-1}function Fa(t,e,n){var r=ca.exec(e.slice(n));return r?(t.Q=+r[0],n+r[0].length):-1}function Pa(t,e,n){var r=ca.exec(e.slice(n));return r?(t.s=+r[0],n+r[0].length):-1}function ja(t,e){return fa(t.getDate(),e,2)}function za(t,e){return fa(t.getHours(),e,2)}function La(t,e){return fa(t.getHours()%12||12,e,2)}function Ba(t,e){return fa(1+Ui.count(xo(t),t),e,3)}function Ua(t,e){return fa(t.getMilliseconds(),e,3)}function $a(t,e){return Ua(t,e)+"000"}function Va(t,e){return fa(t.getMonth()+1,e,2)}function Wa(t,e){return fa(t.getMinutes(),e,2)}function qa(t,e){return fa(t.getSeconds(),e,2)}function Ha(t){var e=t.getDay();return 0===e?7:e}function Ga(t,e){return fa(Vi.count(xo(t)-1,t),e,2)}function Xa(t,e){var n=t.getDay();return t=n>=4||0===n?qi(t):qi.ceil(t),fa(qi.count(xo(t),t)+(4===xo(t).getDay()),e,2)}function Ka(t){return t.getDay()}function Ya(t,e){return fa(Wi.count(xo(t)-1,t),e,2)}function Za(t,e){return fa(t.getFullYear()%100,e,2)}function Qa(t,e){return fa(t.getFullYear()%1e4,e,4)}function Ja(t){var e=t.getTimezoneOffset();return(e>0?"-":(e*=-1,"+"))+fa(e/60|0,"0",2)+fa(e%60,"0",2)}function ts(t,e){return fa(t.getUTCDate(),e,2)}function es(t,e){return fa(t.getUTCHours(),e,2)}function ns(t,e){return fa(t.getUTCHours()%12||12,e,2)}function rs(t,e){return fa(1+Hi.count(No(t),t),e,3)}function is(t,e){return fa(t.getUTCMilliseconds(),e,3)}function os(t,e){return is(t,e)+"000"}function as(t,e){return fa(t.getUTCMonth()+1,e,2)}function ss(t,e){return fa(t.getUTCMinutes(),e,2)}function us(t,e){return fa(t.getUTCSeconds(),e,2)}function ls(t){var e=t.getUTCDay();return 0===e?7:e}function cs(t,e){return fa(Xi.count(No(t)-1,t),e,2)}function hs(t,e){var n=t.getUTCDay();return t=n>=4||0===n?Yi(t):Yi.ceil(t),fa(Yi.count(No(t),t)+(4===No(t).getUTCDay()),e,2)}function ds(t){return t.getUTCDay()}function fs(t,e){return fa(Ki.count(No(t)-1,t),e,2)}function ps(t,e){return fa(t.getUTCFullYear()%100,e,2)}function ms(t,e){return fa(t.getUTCFullYear()%1e4,e,4)}function gs(){return"+0000"}function ys(){return"%"}function vs(t){return+t}function bs(t){return Math.floor(+t/1e3)}function ws(t,e,n){Ze(n=n||{})||Be("Invalid time multi-format specifier: "+n);const r=e(Di),i=e(Ti),o=e(Ni),a=e(Ei),s=e(Si),u=e(ki),l=e(Ci),c=e(_i),h=t(n[Ri]||".%L"),d=t(n[Di]||":%S"),f=t(n[Ti]||"%I:%M"),p=t(n[Ni]||"%I %p"),m=t(n[Ei]||n[Oi]||"%a %d"),g=t(n[Si]||"%b %d"),y=t(n[ki]||"%B"),v=t(n[Ci]||"%B"),b=t(n[_i]||"%Y");return t=>(r(t)<t?h:i(t)<t?d:o(t)<t?f:a(t)<t?p:u(t)<t?s(t)<t?m:g:c(t)<t?l(t)<t?y:v:b)(t)}function xs(t){const e=Kr(t.format),n=Kr(t.utcFormat);return{timeFormat:t=>Mn(t)?e(t):ws(e,Fo,t),utcFormat:t=>Mn(t)?n(t):ws(n,Po,t),timeParse:Kr(t.parse),utcParse:Kr(t.utcParse)}}let _s;function Cs(){return _s=xs({format:oa,parse:aa,utcFormat:sa,utcParse:ua})}function ks(t){return xs(ra(t))}function Ss(t){return arguments.length?_s=ks(t):_s}ia=ra({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]}),oa=ia.format,aa=ia.parse,sa=ia.utcFormat,ua=ia.utcParse,Cs();const Es=(t,e)=>kn({},t,e);function Os(t,e){const n=t?wi(t):xi(),r=e?ks(e):Ss();return Es(n,r)}function As(t,e){const n=arguments.length;return n&&2!==n&&Be("defaultLocale expects either zero or two arguments."),n?Es(xi(t),Ss(e)):Es(xi(),Ss())}function Ns(){return bi(),Cs(),As()}var Ts=function(t,e,n,r){const i=Gr((e=e||{}).type||"json");return i||Be("Unknown data format type: "+e.type),t=i(t,e),e.parse&&function(t,e,n,r){if(!t.length)return;const i=Ss();n=n||i.timeParse,r=r||i.utcParse;let o,a,s,u,l,c,h,d=t.columns||Object.keys(t[0]);for("auto"===e&&(e=Or(t,d)),d=Object.keys(e),o=d.map(t=>{let i,o,a=e[t];if(a&&(a.startsWith("date:")||a.startsWith("utc:")))return i=a.split(/:(.+)?/,2),o=i[1],("'"===o[0]&&"'"===o[o.length-1]||'"'===o[0]&&'"'===o[o.length-1])&&(o=o.slice(1,-1)),("utc"===i[0]?r:n)(o);if(!Cr[a])throw Error("Illegal format pattern: "+t+":"+a);return Cr[a]}),u=0,c=t.length,h=d.length;u<c;++u)for(a=t[u],l=0;l<h;++l)s=d[l],a[s]=o[l](a[s])}(t,e.parse,n,r),On(t,"columns")&&delete t.columns,t},Ds=function(t,e){return e=>({options:e||{},sanitize:yr,load:gr,fileAccess:!1,file:vr(null),http:wr(t)})}("undefined"!=typeof fetch&&fetch);const Rs={skip:!0};function Is(t,e,n,r,i,o){let a,s,u=kn({},o,Rs);gn(n)||(n=_n(n)),void 0===r?a=e=>t.touch(n(e)):gn(r)?(s=new ur(null,r,i,!1),a=e=>{s.evaluate(e);const r=n(e),i=s.value;rr(i)?t.pulse(r,i,o):t.update(r,i,u)}):a=e=>t.update(n(e),r,u),e.apply(a)}function Ms(t,e,n,r,i,o){if(void 0===r)e.targets().add(n);else{const a=o||{},s=new ur(null,function(t,e){return e=gn(e)?e:_n(e),t?function(n,r){const i=e(n,r);return t.skip()||(t.skip(i!==this.value).value=i),i}:e}(n,r),i,!1);s.modified(a.force),s.rank=e.rank,e.targets().add(s),n&&(s.skip(!0),s.value=n.value,s.targets().add(n),t.connect(n,[s]))}}const Fs={};function Ps(t,e,n){this.dataflow=t,this.stamp=null==e?-1:e,this.add=[],this.rem=[],this.mod=[],this.fields=null,this.encode=n||null}function js(t,e){const n=[];return Wn(t,e,t=>n.push(t)),n}function zs(t,e){const n={};return t.visit(e,(function(t){n[Yn(t)]=1})),t=>n[Yn(t)]?null:t}function Ls(t,e){return t?(n,r)=>t(n,r)&&e(n,r):e}function Bs(t,e,n,r){let i,o,a,s,u,l=this,c=0;for(this.dataflow=t,this.stamp=e,this.fields=null,this.encode=r||null,this.pulses=n,a=0,s=n.length;a<s;++a)if(i=n[a],i.stamp===e){if(i.fields)for(u in o=l.fields||(l.fields={}),i.fields)o[u]=1;i.changed(l.ADD)&&(c|=l.ADD),i.changed(l.REM)&&(c|=l.REM),i.changed(l.MOD)&&(c|=l.MOD)}this.changes=c}function Us(t){return t.error("Dataflow already running. Use runAsync() to chain invocations."),t}Ps.prototype={StopPropagation:Fs,ADD:1,REM:2,MOD:4,ADD_REM:3,ADD_MOD:5,ALL:7,REFLOW:8,SOURCE:16,NO_SOURCE:32,NO_FIELDS:64,fork(t){return new Ps(this.dataflow).init(this,t)},clone(){const t=this.fork(7);return t.add=t.add.slice(),t.rem=t.rem.slice(),t.mod=t.mod.slice(),t.source&&(t.source=t.source.slice()),t.materialize(23)},addAll(){let t=this;return!t.source||t.add===t.rem||!t.rem.length&&t.source.length===t.add.length||(t=new Ps(this.dataflow).init(this),t.add=t.source,t.rem=[]),t},init(t,e){const n=this;return n.stamp=t.stamp,n.encode=t.encode,!t.fields||64&e||(n.fields=t.fields),1&e?(n.addF=t.addF,n.add=t.add):(n.addF=null,n.add=[]),2&e?(n.remF=t.remF,n.rem=t.rem):(n.remF=null,n.rem=[]),4&e?(n.modF=t.modF,n.mod=t.mod):(n.modF=null,n.mod=[]),32&e?(n.srcF=null,n.source=null):(n.srcF=t.srcF,n.source=t.source,t.cleans&&(n.cleans=t.cleans)),n},runAfter(t){this.dataflow.runAfter(t)},changed(t){const e=t||7;return 1&e&&this.add.length||2&e&&this.rem.length||4&e&&this.mod.length},reflow(t){if(t)return this.fork(7).reflow();const e=this.add.length,n=this.source&&this.source.length;return n&&n!==e&&(this.mod=this.source,e&&this.filter(4,zs(this,1))),this},clean(t){return arguments.length?(this.cleans=!!t,this):this.cleans},modifies(t){const e=this.fields||(this.fields={});return Ye(t)?t.forEach(t=>e[t]=!0):e[t]=!0,this},modified(t,e){const n=this.fields;return!(!e&&!this.mod.length||!n)&&(arguments.length?Ye(t)?t.some(t=>n[t]):n[t]:!!n)},filter(t,e){const n=this;return 1&t&&(n.addF=Ls(n.addF,e)),2&t&&(n.remF=Ls(n.remF,e)),4&t&&(n.modF=Ls(n.modF,e)),16&t&&(n.srcF=Ls(n.srcF,e)),n},materialize(t){const e=this;return 1&(t=t||7)&&e.addF&&(e.add=js(e.add,e.addF),e.addF=null),2&t&&e.remF&&(e.rem=js(e.rem,e.remF),e.remF=null),4&t&&e.modF&&(e.mod=js(e.mod,e.modF),e.modF=null),16&t&&e.srcF&&(e.source=e.source.filter(e.srcF),e.srcF=null),e},visit(t,e){let n,r,i=this,o=e;return 16&t?(Wn(i.source,i.srcF,o),i):(1&t&&Wn(i.add,i.addF,o),2&t&&Wn(i.rem,i.remF,o),4&t&&Wn(i.mod,i.modF,o),8&t&&(n=i.source)&&(r=i.add.length+i.mod.length,r===n.length||Wn(n,r?zs(i,5):i.srcF,o)),i)}},Tn(Bs,Ps,{fork(t){const e=new Ps(this.dataflow).init(this,t&this.NO_FIELDS);return void 0!==t&&(t&e.ADD&&this.visit(e.ADD,t=>e.add.push(t)),t&e.REM&&this.visit(e.REM,t=>e.rem.push(t)),t&e.MOD&&this.visit(e.MOD,t=>e.mod.push(t))),e},changed(t){return this.changes&t},modified(t){const e=this,n=e.fields;return n&&e.changes&e.MOD?Ye(t)?t.some((function(t){return n[t]})):n[t]:0},filter(){Be("MultiPulse does not support filtering.")},materialize(){Be("MultiPulse does not support materialization.")},visit(t,e){let n=this,r=n.pulses,i=r.length,o=0;if(t&n.SOURCE)for(;o<i;++o)r[o].visit(t,e);else for(;o<i;++o)r[o].stamp===n.stamp&&r[o].visit(t,e);return n}});const $s={skip:!1,force:!1};function Vs(t,e,n,r){let i,o,a;for(i=t[n];n>e&&(a=n-1>>1,o=t[a],r(i,o)<0);)t[n]=o,n=a;return t[n]=i}function Ws(){this.logger(function(t,e){let n=0;return{level(t){return arguments.length?(n=+t,this):n},error(){return n>=1&&Ke("error","ERROR",arguments),this},warn(){return n>=2&&Ke("warn","WARN",arguments),this},info(){return n>=3&&Ke("log","INFO",arguments),this},debug(){return n>=4&&Ke("log","DEBUG",arguments),this}}}()),this.logLevel(1),this._clock=0,this._rank=0,this._locale=As();try{this._loader=Ds()}catch(t){}this._touched=qn(Ve),this._input={},this._pulse=null,this._heap=function(t){let e=[];return{clear:()=>e=[],size:()=>e.length,peek:()=>e[0],push:n=>(e.push(n),Vs(e,0,e.length-1,t)),pop:()=>{let n,r=e.pop();return e.length?(n=e[0],e[0]=r,function(t,e,n){let r,i=e,o=t.length,a=t[e],s=1+(e<<1);for(;s<o;)r=s+1,r<o&&n(t[s],t[r])>=0&&(s=r),t[e]=t[s],s=1+((e=s)<<1);t[e]=a,Vs(t,i,e,n)}(e,0,t)):n=r,n}}}((t,e)=>t.qrank-e.qrank),this._postrun=[]}function qs(t){return function(){return this._log[t].apply(this,arguments)}}function Hs(t,e){ur.call(this,t,null,e)}Ws.prototype={stamp(){return this._clock},loader(t){return arguments.length?(this._loader=t,this):this._loader},locale(t){return arguments.length?(this._locale=t,this):this._locale},logger(t){return arguments.length?(this._log=t,this):this._log},error:qs("error"),warn:qs("warn"),info:qs("info"),debug:qs("debug"),logLevel:qs("level"),cleanThreshold:1e4,add:function(t,e,n,r){let i,o=1;return t instanceof ur?i=t:t&&t.prototype instanceof ur?i=new t:gn(t)?i=new ur(null,t):(o=0,i=new ur(t,e)),this.rank(i),o&&(r=n,n=e),n&&this.connect(i,i.parameters(n,r)),this.touch(i),i},connect:function(t,e){let n,r,i=t.rank;for(n=0,r=e.length;n<r;++n)if(i<e[n].rank)return void this.rerank(t)},rank:function(t){t.rank=++this._rank},rerank:function(t){let e,n,r,i=[t];for(;i.length;)if(this.rank(e=i.pop()),n=e._targets)for(r=n.length;--r>=0;)i.push(e=n[r]),e===t&&Be("Cycle detected in dataflow graph.")},pulse:function(t,e,n){this.touch(t,n||$s);const r=new Ps(this,this._clock+(this._pulse?0:1)),i=t.pulse&&t.pulse.source||[];return r.target=t,this._input[t.id]=e.pulse(r,i),this},touch:function(t,e){const n=e||$s;return this._pulse?this._enqueue(t):this._touched.add(t),n.skip&&t.skip(!0),this},update:function(t,e,n){const r=n||$s;return(t.set(e)||r.force)&&this.touch(t,r),this},changeset:ir,ingest:function(t,e,n){return e=this.parse(e,n),this.pulse(t,this.changeset().insert(e))},parse:function(t,e){const n=this.locale();return Ts(t,e,n.timeParse,n.utcParse)},preload:async function(t,e,n){const r=this,i=r._pending||function(t){let e,n=new Promise(t=>e=t);return n.requests=0,n.done=()=>{0==--n.requests&&(t._pending=null,e(t))},t._pending=n}(r);i.requests+=1;const o=await r.request(e,n);return r.pulse(t,r.changeset().remove(Ge).insert(o.data||[])),i.done(),o},request:async function(t,e){const n=this;let r,i=0;try{r=await n.loader().load(t,{context:"dataflow",response:Xr(e&&e.type)});try{r=n.parse(r,e)}catch(o){i=-2,n.warn("Data ingestion failed",t,o)}}catch(o){i=-1,n.warn("Loading failed",t,o)}return{data:r,status:i}},events:function(t,e,n,r){let i,o=this,a=dr(n,r),s=function(t){t.dataflow=o;try{a.receive(t)}catch(e){o.error(e)}finally{o.run()}};i="string"==typeof t&&"undefined"!=typeof document?document.querySelectorAll(t):mn(t);for(let u=0,l=i.length;u<l;++u)i[u].addEventListener(e,s);return a},on:function(t,e,n,r,i){return(t instanceof ur?Ms:Is)(this,t,e,n,r,i),this},evaluate:async function(t,e,n){const r=this,i=[];if(r._pulse)return Us(r);if(r._pending&&await r._pending,e&&await Hn(r,e),!r._touched.length)return r.debug("Dataflow invoked, but nothing to do."),r;const o=++r._clock;r._pulse=new Ps(r,o,t),r._touched.forEach(t=>r._enqueue(t,!0)),r._touched=qn(Ve);let a,s,u,l=0;try{for(;r._heap.size()>0;)a=r._heap.pop(),a.rank===a.qrank?(s=a.run(r._getPulse(a,t)),s.then?s=await s:s.async&&(i.push(s.async),s=Fs),s!==Fs&&a._targets&&a._targets.forEach(t=>r._enqueue(t)),++l):r._enqueue(a,!0)}catch(c){r._heap.clear(),u=c}if(r._input={},r._pulse=null,r.debug(`Pulse ${o}: ${l} operators`),u&&(r._postrun=[],r.error(u)),r._postrun.length){const t=r._postrun.sort((t,e)=>e.priority-t.priority);r._postrun=[];for(let e=0;e<t.length;++e)await Hn(r,t[e].callback)}return n&&await Hn(r,n),i.length&&Promise.all(i).then(t=>r.runAsync(null,()=>{t.forEach(t=>{try{t(r)}catch(c){r.error(c)}})})),r},run:function(t,e,n){return this._pulse?Us(this):(this.evaluate(t,e,n),this)},runAsync:async function(t,e,n){for(;this._running;)await this._running;const r=()=>this._running=null;return(this._running=this.evaluate(t,e,n)).then(r,r),this._running},runAfter:function(t,e,n){if(this._pulse||e)this._postrun.push({priority:n||0,callback:t});else try{t(this)}catch(r){this.error(r)}},_enqueue:function(t,e){const n=t.stamp<this._clock;n&&(t.stamp=this._clock),(n||e)&&(t.qrank=t.rank,this._heap.push(t))},_getPulse:function(t,e){const n=t.source,r=this._clock;return n&&Ye(n)?new Bs(this,r,n.map(t=>t.pulse),e):this._input[t.id]||function(t,e){return e&&e.stamp===t.stamp?e:(t=t.fork(),e&&e!==Fs&&(t.source=e.source),t)}(this._pulse,n&&n.pulse)}},Tn(Hs,ur,{run(t){if(t.stamp<this.stamp)return t.StopPropagation;let e;return this.skip()?this.skip(!1):e=this.evaluate(t),e=e||t,e.then?e=e.then(t=>this.pulse=t):e!==t.StopPropagation&&(this.pulse=e),e},evaluate(t){const e=this.marshall(t.stamp),n=this.transform(e,t);return e.clear(),n},transform(){}});const Gs={};function Xs(t){const e=Ks(t);return e&&e.Definition||null}function Ks(t){return t=t&&t.toLowerCase(),On(Gs,t)?Gs[t]:null}function Ys(t){return t&&t.length?1===t.length?t[0]:(e=t,t=>{let n=e.length,r=1,i=String(e[0](t));for(;r<n;++r)i+="|"+e[r](t);return i}):function(){return""};var e}function Zs(t,e,n){return n||t+(e?"_"+e:"")}const Qs=()=>{},Js={init:Qs,add:Qs,rem:Qs,idx:0},tu={values:{init:t=>t.cell.store=!0,value:t=>t.cell.data.values(),idx:-1},count:{value:t=>t.cell.num},__count__:{value:t=>t.missing+t.valid},missing:{value:t=>t.missing},valid:{value:t=>t.valid},sum:{init:t=>t.sum=0,value:t=>t.sum,add:(t,e)=>t.sum+=+e,rem:(t,e)=>t.sum-=e},product:{init:t=>t.product=1,value:t=>t.valid?t.product:void 0,add:(t,e)=>t.product*=e,rem:(t,e)=>t.product/=e},mean:{init:t=>t.mean=0,value:t=>t.valid?t.mean:void 0,add:(t,e)=>(t.mean_d=e-t.mean,t.mean+=t.mean_d/t.valid),rem:(t,e)=>(t.mean_d=e-t.mean,t.mean-=t.valid?t.mean_d/t.valid:t.mean)},average:{value:t=>t.valid?t.mean:void 0,req:["mean"],idx:1},variance:{init:t=>t.dev=0,value:t=>t.valid>1?t.dev/(t.valid-1):void 0,add:(t,e)=>t.dev+=t.mean_d*(e-t.mean),rem:(t,e)=>t.dev-=t.mean_d*(e-t.mean),req:["mean"],idx:1},variancep:{value:t=>t.valid>1?t.dev/t.valid:void 0,req:["variance"],idx:2},stdev:{value:t=>t.valid>1?Math.sqrt(t.dev/(t.valid-1)):void 0,req:["variance"],idx:2},stdevp:{value:t=>t.valid>1?Math.sqrt(t.dev/t.valid):void 0,req:["variance"],idx:2},stderr:{value:t=>t.valid>1?Math.sqrt(t.dev/(t.valid*(t.valid-1))):void 0,req:["variance"],idx:2},distinct:{value:t=>t.cell.data.distinct(t.get),req:["values"],idx:3},ci0:{value:t=>t.cell.data.ci0(t.get),req:["values"],idx:3},ci1:{value:t=>t.cell.data.ci1(t.get),req:["values"],idx:3},median:{value:t=>t.cell.data.q2(t.get),req:["values"],idx:3},q1:{value:t=>t.cell.data.q1(t.get),req:["values"],idx:3},q3:{value:t=>t.cell.data.q3(t.get),req:["values"],idx:3},min:{init:t=>t.min=void 0,value:t=>t.min=Number.isNaN(t.min)?t.cell.data.min(t.get):t.min,add:(t,e)=>{(e<t.min||void 0===t.min)&&(t.min=e)},rem:(t,e)=>{e<=t.min&&(t.min=NaN)},req:["values"],idx:4},max:{init:t=>t.max=void 0,value:t=>t.max=Number.isNaN(t.max)?t.cell.data.max(t.get):t.max,add:(t,e)=>{(e>t.max||void 0===t.max)&&(t.max=e)},rem:(t,e)=>{e>=t.max&&(t.max=NaN)},req:["values"],idx:4},argmin:{init:t=>t.argmin=void 0,value:t=>t.argmin||t.cell.data.argmin(t.get),add:(t,e,n)=>{e<t.min&&(t.argmin=n)},rem:(t,e)=>{e<=t.min&&(t.argmin=void 0)},req:["min","values"],idx:3},argmax:{init:t=>t.argmax=void 0,value:t=>t.argmax||t.cell.data.argmax(t.get),add:(t,e,n)=>{e>t.max&&(t.argmax=n)},rem:(t,e)=>{e>=t.max&&(t.argmax=void 0)},req:["max","values"],idx:3}},eu=Object.keys(tu);function nu(t,e){return tu[t](e)}function ru(t,e){return t.idx-e.idx}function iu(){this.valid=0,this.missing=0,this._ops.forEach(t=>t.init(this))}function ou(t,e){null!=t&&""!==t?t==t&&(++this.valid,this._ops.forEach(n=>n.add(this,t,e))):++this.missing}function au(t,e){null!=t&&""!==t?t==t&&(--this.valid,this._ops.forEach(n=>n.rem(this,t,e))):--this.missing}function su(t){return this._out.forEach(e=>t[e.out]=e.value(this)),t}function uu(t,e){const n=e||We,r=function(t){const e={};t.forEach(t=>e[t.name]=t);const n=t=>{t.req&&t.req.forEach(t=>{e[t]||n(e[t]=tu[t]())})};return t.forEach(n),Object.values(e).sort(ru)}(t),i=t.slice().sort(ru);function o(t){this._ops=r,this._out=i,this.cell=t,this.init()}return o.prototype.init=iu,o.prototype.add=ou,o.prototype.rem=au,o.prototype.set=su,o.prototype.get=n,o.fields=t.map(t=>t.out),o}eu.forEach(t=>{tu[t]=function(t,e){return n=>kn({name:t,out:n||t},Js,e)}(t,tu[t])});var lu=function*(t,e){if(null==e)for(let n of t)null!=n&&""!==n&&(n=+n)>=n&&(yield n);else{let n=-1;for(let r of t)r=e(r,++n,t),null!=r&&""!==r&&(r=+r)>=r&&(yield r)}};function cu(t,e){let n;if(void 0===e)for(const r of t)null!=r&&(n<r||void 0===n&&r>=r)&&(n=r);else{let r=-1;for(let i of t)null!=(i=e(i,++r,t))&&(n<i||void 0===n&&i>=i)&&(n=i)}return n}function hu(t,e){let n;if(void 0===e)for(const r of t)null!=r&&(n>r||void 0===n&&r>=r)&&(n=r);else{let r=-1;for(let i of t)null!=(i=e(i,++r,t))&&(n>i||void 0===n&&i>=i)&&(n=i)}return n}function du(t,e,n){const r=t[e];t[e]=t[n],t[n]=r}var fu=function(t){return null===t?NaN:+t};function pu(t,e,n){if(r=(t=Float64Array.from(function*(t,e){if(void 0===e)for(let n of t)null!=n&&(n=+n)>=n&&(yield n);else{let n=-1;for(let r of t)null!=(r=e(r,++n,t))&&(r=+r)>=r&&(yield r)}}(t,n))).length){if((e=+e)<=0||r<2)return hu(t);if(e>=1)return cu(t);var r,i=(r-1)*e,o=Math.floor(i),a=cu(function t(e,n,r=0,i=e.length-1,o=Vo){for(;i>r;){if(i-r>600){const a=i-r+1,s=n-r+1,u=Math.log(a),l=.5*Math.exp(2*u/3),c=.5*Math.sqrt(u*l*(a-l)/a)*(s-a/2<0?-1:1);t(e,n,Math.max(r,Math.floor(n-s*l/a+c)),Math.min(i,Math.floor(n+(a-s)*l/a+c)),o)}const a=e[n];let s=r,u=i;for(du(e,r,n),o(e[i],a)>0&&du(e,r,i);s<u;){for(du(e,s,u),++s,--u;o(e[s],a)<0;)++s;for(;o(e[u],a)>0;)--u}0===o(e[r],a)?du(e,r,u):(++u,du(e,u,i)),u<=n&&(r=u+1),n<=u&&(i=u-1)}return e}(t,o).subarray(0,o+1));return a+(hu(t.subarray(o+1))-a)*(i-o)}}var mu=function(t,e,n){const r=Float64Array.from(lu(t,n));return r.sort(Vo),e.map(t=>function(t,e,n=fu){if(r=t.length){if((e=+e)<=0||r<2)return+n(t[0],0,t);if(e>=1)return+n(t[r-1],r-1,t);var r,i=(r-1)*e,o=Math.floor(i),a=+n(t[o],o,t);return a+(+n(t[o+1],o+1,t)-a)*(i-o)}}(r,t))},gu=function(t,e){return mu(t,[.25,.5,.75],e)},yu=function(t,e){let n=t.length,r=function(t,e){const n=function(t,e){let n,r=0,i=0,o=0;if(void 0===e)for(let a of t)null!=a&&(a=+a)>=a&&(n=a-i,i+=n/++r,o+=n*(a-i));else{let a=-1;for(let s of t)null!=(s=e(s,++a,t))&&(s=+s)>=s&&(n=s-i,i+=n/++r,o+=n*(s-i))}if(r>1)return o/(r-1)}(t,e);return n?Math.sqrt(n):n}(t,e),i=gu(t,e);return r=Math.min(r,(i[2]-i[0])/1.34)||r||Math.abs(i[0])||1,1.06*r*Math.pow(n,-.2)},vu=function(t){let e,n,r,i,o,a,s,u,l=t.maxbins||20,c=t.base||10,h=Math.log(c),d=t.divide||[5,2],f=t.extent[0],p=t.extent[1],m=t.span||p-f||Math.abs(f)||1;if(t.step)e=t.step;else if(t.steps){for(o=m/l,a=0,s=t.steps.length;a<s&&t.steps[a]<o;++a);e=t.steps[Math.max(0,a-1)]}else{for(n=Math.ceil(Math.log(l)/h),r=t.minstep||0,e=Math.max(r,Math.pow(c,Math.round(Math.log(m)/h)-n));Math.ceil(m/e)>l;)e*=c;for(a=0,s=d.length;a<s;++a)o=e/d[a],o>=r&&m/o<=l&&(e=o)}return o=Math.log(e),i=o>=0?0:1+~~(-o/h),u=Math.pow(c,-i-1),(t.nice||void 0===t.nice)&&(o=Math.floor(f/e+u)*e,f=f<o?o-e:o,p=Math.ceil(p/e)*e),{start:f,stop:p===f?f+e:p,step:e}},bu=Math.random;function wu(t){bu=t}var xu=function(t,e,n,r){if(!t.length)return[void 0,void 0];let i,o,a,s,u=Float64Array.from(lu(t,r)),l=u.length,c=e;for(a=0,s=Array(c);a<c;++a){for(i=0,o=0;o<l;++o)i+=u[~~(bu()*l)];s[a]=i/l}return s.sort(Vo),[pu(s,n/2),pu(s,1-n/2)]},_u=function(t,e,n,r){r=r||(t=>t);let i,o=0,a=1,s=t.length,u=new Float64Array(s),l=r(t[0]),c=l,h=l+e;for(;a<s;++a){if(i=r(t[a]),i>=h){for(c=(l+c)/2;o<a;++o)u[o]=c;h=i+e,l=i}c=i}for(c=(l+c)/2;o<a;++o)u[o]=c;return n?function(t,e){let n,r,i=t.length,o=0,a=1;for(;t[o]===t[a];)++a;for(;a<i;){for(n=a+1;t[a]===t[n];)++n;if(t[a]-t[a-1]<e){for(r=a+(o+n-a-a>>1);r<a;)t[r++]=t[a];for(;r>a;)t[r--]=t[o]}o=a,a=n}return t}(u,e+e/4):u},Cu=function(t){return function(){return(t=(1103515245*t+12345)%2147483647)/2147483647}},ku=function(t,e){let n,r,i;null==e&&(e=t,t=0);const o={min(t){return arguments.length?(n=t||0,i=r-n,o):n},max(t){return arguments.length?(r=t||0,i=r-n,o):r},sample:()=>n+Math.floor(i*bu()),pdf:t=>t===Math.floor(t)&&t>=n&&t<r?1/i:0,cdf(t){const e=Math.floor(t);return e<n?0:e>=r?1:(e-n+1)/i},icdf:t=>t>=0&&t<=1?n-1+Math.floor(t*i):NaN};return o.min(t).max(e)};const Su=Math.sqrt(2*Math.PI),Eu=Math.SQRT2;let Ou=NaN;function Au(t,e){t=t||0,e=null==e?1:e;let n,r,i=0,o=0;if(Ou==Ou)i=Ou,Ou=NaN;else{do{i=2*bu()-1,o=2*bu()-1,n=i*i+o*o}while(0===n||n>1);r=Math.sqrt(-2*Math.log(n)/n),i*=r,Ou=o*r}return t+i*e}function Nu(t,e,n){const r=(t-(e||0))/(n=null==n?1:n);return Math.exp(-.5*r*r)/(n*Su)}function Tu(t,e,n){let r,i=(t-(e=e||0))/(n=null==n?1:n),o=Math.abs(i);if(o>37)r=0;else{let t,e=Math.exp(-o*o/2);o<7.07106781186547?(t=.0352624965998911*o+.700383064443688,t=t*o+6.37396220353165,t=t*o+33.912866078383,t=t*o+112.079291497871,t=t*o+221.213596169931,t=t*o+220.206867912376,r=e*t,t=.0883883476483184*o+1.75566716318264,t=t*o+16.064177579207,t=t*o+86.7807322029461,t=t*o+296.564248779674,t=t*o+637.333633378831,t=t*o+793.826512519948,t=t*o+440.413735824752,r/=t):(t=o+.65,t=o+4/t,t=o+3/t,t=o+2/t,t=o+1/t,r=e/t/2.506628274631)}return i>0?1-r:r}function Du(t,e,n){return t<0||t>1?NaN:(e||0)+(null==n?1:n)*Eu*function(t){let e,n=-Math.log((1-t)*(1+t));return n<6.25?(n-=3.125,e=-364441206401782e-35,e=e*n-16850591381820166e-35,e=128584807152564e-32+e*n,e=11157877678025181e-33+e*n,e=e*n-1333171662854621e-31,e=20972767875968562e-33+e*n,e=6637638134358324e-30+e*n,e=e*n-4054566272975207e-29,e=e*n-8151934197605472e-29,e=26335093153082323e-28+e*n,e=e*n-12975133253453532e-27,e=e*n-5415412054294628e-26,e=1.0512122733215323e-9+e*n,e=e*n-4.112633980346984e-9,e=e*n-2.9070369957882005e-8,e=4.2347877827932404e-7+e*n,e=e*n-13654692000834679e-22,e=e*n-13882523362786469e-21,e=.00018673420803405714+e*n,e=e*n-.000740702534166267,e=e*n-.006033670871430149,e=.24015818242558962+e*n,e=1.6536545626831027+e*n):n<16?(n=Math.sqrt(n)-3.25,e=2.2137376921775787e-9,e=9.075656193888539e-8+e*n,e=e*n-2.7517406297064545e-7,e=1.8239629214389228e-8+e*n,e=15027403968909828e-22+e*n,e=e*n-4013867526981546e-21,e=29234449089955446e-22+e*n,e=12475304481671779e-21+e*n,e=e*n-47318229009055734e-21,e=6828485145957318e-20+e*n,e=24031110387097894e-21+e*n,e=e*n-.0003550375203628475,e=.0009532893797373805+e*n,e=e*n-.0016882755560235047,e=.002491442096107851+e*n,e=e*n-.003751208507569241,e=.005370914553590064+e*n,e=1.0052589676941592+e*n,e=3.0838856104922208+e*n):Number.isFinite(n)?(n=Math.sqrt(n)-5,e=-27109920616438573e-27,e=e*n-2.555641816996525e-10,e=1.5076572693500548e-9+e*n,e=e*n-3.789465440126737e-9,e=7.61570120807834e-9+e*n,e=e*n-1.496002662714924e-8,e=2.914795345090108e-8+e*n,e=e*n-6.771199775845234e-8,e=2.2900482228026655e-7+e*n,e=e*n-9.9298272942317e-7,e=4526062597223154e-21+e*n,e=e*n-1968177810553167e-20,e=7599527703001776e-20+e*n,e=e*n-.00021503011930044477,e=e*n-.00013871931833623122,e=1.0103004648645344+e*n,e=4.849906401408584+e*n):e=1/0,e*t}(2*t-1)}var Ru=function(t,e){let n,r;const i={mean(t){return arguments.length?(n=t||0,i):n},stdev(t){return arguments.length?(r=null==t?1:t,i):r},sample:()=>Au(n,r),pdf:t=>Nu(t,n,r),cdf:t=>Tu(t,n,r),icdf:t=>Du(t,n,r)};return i.mean(t).stdev(e)},Iu=function(t,e){const n=Ru();let r=0;const i={data(n){return arguments.length?(t=n,r=n?n.length:0,i.bandwidth(e)):t},bandwidth(n){return arguments.length?(!(e=n)&&t&&(e=yu(t)),i):e},sample:()=>t[~~(bu()*r)]+e*n.sample(),pdf(i){let o=0,a=0;for(;a<r;++a)o+=n.pdf((i-t[a])/e);return o/e/r},cdf(i){let o=0,a=0;for(;a<r;++a)o+=n.cdf((i-t[a])/e);return o/r},icdf(){throw Error("KDE icdf not supported.")}};return i.data(t)};function Mu(t,e){return t=t||0,e=null==e?1:e,Math.exp(t+Au()*e)}function Fu(t,e,n){if(t<=0)return 0;e=e||0,n=null==n?1:n;const r=(Math.log(t)-e)/n;return Math.exp(-.5*r*r)/(n*Su*t)}function Pu(t,e,n){return Tu(Math.log(t),e,n)}function ju(t,e,n){return Math.exp(Du(t,e,n))}var zu=function(t,e){let n,r;const i={mean(t){return arguments.length?(n=t||0,i):n},stdev(t){return arguments.length?(r=null==t?1:t,i):r},sample:()=>Mu(n,r),pdf:t=>Fu(t,n,r),cdf:t=>Pu(t,n,r),icdf:t=>ju(t,n,r)};return i.mean(t).stdev(e)},Lu=function(t,e){let n,r=0;const i={weights(t){return arguments.length?(n=function(t){let e,n=[],i=0;for(e=0;e<r;++e)i+=n[e]=null==t[e]?1:+t[e];for(e=0;e<r;++e)n[e]/=i;return n}(e=t||[]),i):e},distributions(n){return arguments.length?(n?(r=n.length,t=n):(r=0,t=[]),i.weights(e)):t},sample(){let e=bu(),i=t[r-1],o=n[0],a=0;for(;a<r-1;o+=n[++a])if(e<o){i=t[a];break}return i.sample()},pdf(e){let i=0,o=0;for(;o<r;++o)i+=n[o]*t[o].pdf(e);return i},cdf(e){let i=0,o=0;for(;o<r;++o)i+=n[o]*t[o].cdf(e);return i},icdf(){throw Error("Mixture icdf not supported.")}};return i.distributions(t).weights(e)};function Bu(t,e){return null==e&&(e=null==t?1:t,t=0),t+(e-t)*bu()}function Uu(t,e,n){return null==n&&(n=null==e?1:e,e=0),t>=e&&t<=n?1/(n-e):0}function $u(t,e,n){return null==n&&(n=null==e?1:e,e=0),t<e?0:t>n?1:(t-e)/(n-e)}function Vu(t,e,n){return null==n&&(n=null==e?1:e,e=0),t>=0&&t<=1?e+t*(n-e):NaN}var Wu=function(t,e){let n,r;const i={min(t){return arguments.length?(n=t||0,i):n},max(t){return arguments.length?(r=null==t?1:t,i):r},sample:()=>Bu(n,r),pdf:t=>Uu(t,n,r),cdf:t=>$u(t,n,r),icdf:t=>Vu(t,n,r)};return null==e&&(e=null==t?1:t,t=0),i.min(t).max(e)},qu=function(t,e,n,r){const i=r-t*t,o=Math.abs(i)<1e-24?0:(n-t*e)/i;return[e-o*t,o]};function Hu(t,e,n,r){t=t.filter(t=>{let r=e(t),i=n(t);return null!=r&&(r=+r)>=r&&null!=i&&(i=+i)>=i}),r&&t.sort((t,n)=>e(t)-e(n));const i=t.length,o=new Float64Array(i),a=new Float64Array(i);let s,u,l,c=0,h=0,d=0;for(l of t)o[c]=s=+e(l),a[c]=u=+n(l),++c,h+=(s-h)/c,d+=(u-d)/c;for(c=0;c<i;++c)o[c]-=h,a[c]-=d;return[o,a,h,d]}function Gu(t,e,n,r){let i,o,a=-1;for(let s of t)i=e(s),o=n(s),null!=i&&(i=+i)>=i&&null!=o&&(o=+o)>=o&&r(i,o,++a)}var Xu=function(t,e,n,r,i){let o=0,a=0;return Gu(t,e,n,(t,e)=>{const n=e-i(t),s=e-r;o+=n*n,a+=s*s}),1-o/a},Ku=function(t,e,n){let r=0,i=0,o=0,a=0,s=0;Gu(t,e,n,(t,e)=>{++s,r+=(t-r)/s,i+=(e-i)/s,o+=(t*e-o)/s,a+=(t*t-a)/s});const u=qu(r,i,o,a),l=t=>u[0]+u[1]*t;return{coef:u,predict:l,rSquared:Xu(t,e,n,i,l)}},Yu=function(t,e,n){let r=0,i=0,o=0,a=0,s=0;Gu(t,e,n,(t,e)=>{++s,t=Math.log(t),r+=(t-r)/s,i+=(e-i)/s,o+=(t*e-o)/s,a+=(t*t-a)/s});const u=qu(r,i,o,a),l=t=>u[0]+u[1]*Math.log(t);return{coef:u,predict:l,rSquared:Xu(t,e,n,i,l)}},Zu=function(t,e,n){const[r,i,o,a]=Hu(t,e,n);let s,u,l,c=0,h=0,d=0,f=0,p=0;Gu(t,e,n,(t,e)=>{s=r[p++],u=Math.log(e),l=s*e,c+=(e*u-c)/p,h+=(l-h)/p,d+=(l*u-d)/p,f+=(s*l-f)/p});const[m,g]=qu(h/a,c/a,d/a,f/a),y=t=>Math.exp(m+g*(t-o));return{coef:[Math.exp(m-g*o),g],predict:y,rSquared:Xu(t,e,n,a,y)}},Qu=function(t,e,n){let r=0,i=0,o=0,a=0,s=0,u=0;Gu(t,e,n,(t,e)=>{const n=Math.log(t),l=Math.log(e);++u,r+=(n-r)/u,i+=(l-i)/u,o+=(n*l-o)/u,a+=(n*n-a)/u,s+=(e-s)/u});const l=qu(r,i,o,a),c=t=>l[0]*Math.pow(t,l[1]);return l[0]=Math.exp(l[0]),{coef:l,predict:c,rSquared:Xu(t,e,n,s,c)}},Ju=function(t,e,n){const[r,i,o,a]=Hu(t,e,n),s=r.length;let u,l,c,h,d=0,f=0,p=0,m=0,g=0;for(u=0;u<s;)l=r[u],c=i[u++],h=l*l,d+=(h-d)/u,f+=(h*l-f)/u,p+=(h*h-p)/u,m+=(l*c-m)/u,g+=(h*c-g)/u;const y=p-d*d,v=d*y-f*f,b=(g*d-m*f)/v,w=(m*y-g*f)/v,x=-b*d,_=t=>b*(t-=o)*t+w*t+x+a;return{coef:[x-w*o+b*o*o+a,w-2*b*o,b],predict:_,rSquared:Xu(t,e,n,a,_)}},tl=function(t,e,n,r){if(1===r)return Ku(t,e,n);if(2===r)return Ju(t,e,n);const[i,o,a,s]=Hu(t,e,n),u=i.length,l=[],c=[],h=r+1;let d,f,p,m,g;for(d=0;d<h;++d){for(p=0,m=0;p<u;++p)m+=Math.pow(i[p],d)*o[p];for(l.push(m),g=new Float64Array(h),f=0;f<h;++f){for(p=0,m=0;p<u;++p)m+=Math.pow(i[p],d+f);g[f]=m}c.push(g)}c.push(l);const y=function(t){const e=t.length-1,n=[];let r,i,o,a,s;for(r=0;r<e;++r){for(a=r,i=r+1;i<e;++i)Math.abs(t[r][i])>Math.abs(t[r][a])&&(a=i);for(o=r;o<e+1;++o)s=t[o][r],t[o][r]=t[o][a],t[o][a]=s;for(i=r+1;i<e;++i)for(o=e;o>=r;o--)t[o][i]-=t[o][r]*t[r][i]/t[r][r]}for(i=e-1;i>=0;--i){for(s=0,o=i+1;o<e;++o)s+=t[o][i]*n[o];n[i]=(t[e][i]-s)/t[i][i]}return n}(c),v=t=>{let e=s+y[0]+y[1]*(t-=a)+y[2]*t*t;for(d=3;d<h;++d)e+=y[d]*Math.pow(t,d);return e};return{coef:el(h,y,-a,s),predict:v,rSquared:Xu(t,e,n,s,v)}};function el(t,e,n,r){const i=Array(t);let o,a,s,u;for(o=0;o<t;++o)i[o]=0;for(o=t-1;o>=0;--o)for(s=e[o],u=1,i[o]+=s,a=1;a<=o;++a)u*=(o+1-a)/a,i[o-a]+=s*Math.pow(n,a)*u;return i[0]+=r,i}var nl=function(t,e){return pu(t,.5,e)},rl=function(t,e,n,r){const[i,o,a,s]=Hu(t,e,n,!0),u=i.length,l=Math.max(2,~~(r*u)),c=new Float64Array(u),h=new Float64Array(u),d=new Float64Array(u).fill(1);for(let f=-1;++f<=2;){const t=[0,l-1];for(let n=0;n<u;++n){const e=i[n],r=t[0],a=t[1];let s=0,u=0,l=0,f=0,p=0,m=1/Math.abs(i[e-i[r]>i[a]-e?r:a]-e||1);for(let t=r;t<=a;++t){const n=i[t],r=o[t],a=il(Math.abs(e-n)*m)*d[t],c=n*a;s+=a,u+=c,l+=r*a,f+=r*c,p+=n*c}const[g,y]=qu(u/s,l/s,f/s,p/s);c[n]=g+y*e,h[n]=Math.abs(o[n]-c[n]),ol(i,n+1,t)}if(2===f)break;const e=nl(h);if(Math.abs(e)<1e-12)break;for(let n,r,i=0;i<u;++i)n=h[i]/(6*e),d[i]=n>=1?1e-12:(r=1-n*n)*r}return function(t,e,n,r){const i=t.length,o=[];let a,s=0,u=0,l=[];for(;s<i;++s)a=t[s]+n,l[0]===a?l[1]+=(e[s]-l[1])/++u:(u=0,l[1]+=r,l=[a,e[s]],o.push(l));return l[1]+=r,o}(i,c,a,s)};function il(t){return(t=1-t*t*t)*t*t}function ol(t,e,n){let r=t[e],i=n[0],o=n[1]+1;if(!(o>=t.length))for(;e>i&&t[o]-r<=r-t[i];)n[0]=++i,n[1]=o,++o}const al=.1*Math.PI/180;var sl=function(t,e,n,r){n=n||25,r=Math.max(n,r||200);const i=e=>[e,t(e)],o=e[0],a=e[1],s=a-o,u=s/r,l=[i(o)],c=[];if(n===r){for(let t=1;t<r;++t)l.push(i(o+t/n*s));return l.push(i(a)),l}c.push(i(a));for(let f=n;--f>0;)c.push(i(o+f/n*s));let h=l[0],d=c[c.length-1];for(;d;){const t=i((h[0]+d[0])/2);t[0]-h[0]>=u&&ul(h,t,d)>al?c.push(t):(h=d,l.push(d),c.pop()),d=c[c.length-1]}return l};function ul(t,e,n){const r=Math.atan2(n[1]-t[1],n[0]-t[0]),i=Math.atan2(e[1]-t[1],e[0]-t[0]);return Math.abs(r-i)}function ll(t){this._key=t?$e(t):Yn,this.reset()}const cl=ll.prototype;function hl(t){Hs.call(this,null,t),this._adds=[],this._mods=[],this._alen=0,this._mlen=0,this._drop=!0,this._cross=!1,this._dims=[],this._dnames=[],this._measures=[],this._countOnly=!1,this._counts=null,this._prev=null,this._inputs=null,this._outputs=null}function dl(t){Hs.call(this,null,t)}cl.reset=function(){this._add=[],this._rem=[],this._ext=null,this._get=null,this._q=null},cl.add=function(t){this._add.push(t)},cl.rem=function(t){this._rem.push(t)},cl.values=function(){if(this._get=null,0===this._rem.length)return this._add;let t,e,n,r=this._add,i=this._rem,o=this._key,a=r.length,s=i.length,u=Array(a-s),l={};for(t=0;t<s;++t)l[o(i[t])]=1;for(t=0,e=0;t<a;++t)l[o(n=r[t])]?l[o(n)]=0:u[e++]=n;return this._rem=[],this._add=u},cl.distinct=function(t){let e,n=this.values(),r=n.length,i={},o=0;for(;--r>=0;)e=t(n[r])+"",On(i,e)||(i[e]=1,++o);return o},cl.extent=function(t){if(this._get!==t||!this._ext){const e=this.values(),n=function(t,e){let n,r,i,o,a,s=-1,u=t.length;if(null==e){for(;++s<u;)if(r=t[s],null!=r&&r>=r){n=i=r;break}if(s===u)return[-1,-1];for(o=a=s;++s<u;)r=t[s],null!=r&&(n>r&&(n=r,o=s),i<r&&(i=r,a=s))}else{for(;++s<u;)if(r=e(t[s],s,t),null!=r&&r>=r){n=i=r;break}if(s===u)return[-1,-1];for(o=a=s;++s<u;)r=e(t[s],s,t),null!=r&&(n>r&&(n=r,o=s),i<r&&(i=r,a=s))}return[o,a]}(e,t);this._ext=[e[n[0]],e[n[1]]],this._get=t}return this._ext},cl.argmin=function(t){return this.extent(t)[0]||{}},cl.argmax=function(t){return this.extent(t)[1]||{}},cl.min=function(t){const e=this.extent(t)[0];return null!=e?t(e):void 0},cl.max=function(t){const e=this.extent(t)[1];return null!=e?t(e):void 0},cl.quartile=function(t){return this._get===t&&this._q||(this._q=gu(this.values(),t),this._get=t),this._q},cl.q1=function(t){return this.quartile(t)[0]},cl.q2=function(t){return this.quartile(t)[1]},cl.q3=function(t){return this.quartile(t)[2]},cl.ci=function(t){return this._get===t&&this._ci||(this._ci=xu(this.values(),1e3,.05,t),this._get=t),this._ci},cl.ci0=function(t){return this.ci(t)[0]},cl.ci1=function(t){return this.ci(t)[1]},hl.Definition={type:"Aggregate",metadata:{generates:!0,changes:!0},params:[{name:"groupby",type:"field",array:!0},{name:"ops",type:"enum",array:!0,values:eu},{name:"fields",type:"field",null:!0,array:!0},{name:"as",type:"string",null:!0,array:!0},{name:"drop",type:"boolean",default:!0},{name:"cross",type:"boolean",default:!1},{name:"key",type:"field"}]},Tn(hl,Hs,{transform(t,e){const n=this,r=e.fork(e.NO_SOURCE|e.NO_FIELDS),i=t.modified();return n.stamp=r.stamp,n.value&&(i||e.modified(n._inputs,!0))?(n._prev=n.value,n.value=i?n.init(t):{},e.visit(e.SOURCE,t=>n.add(t))):(n.value=n.value||n.init(t),e.visit(e.REM,t=>n.rem(t)),e.visit(e.ADD,t=>n.add(t))),r.modifies(n._outputs),n._drop=!1!==t.drop,t.cross&&n._dims.length>1&&(n._drop=!1,n.cross()),e.clean()&&n._drop&&r.clean(!0).runAfter(()=>this.clean()),n.changes(r)},cross(){const t=this,e=t.value,n=t._dnames,r=n.map(()=>({})),i=n.length;function o(t){let e,o,a,s;for(e in t)for(a=t[e].tuple,o=0;o<i;++o)r[o][s=a[n[o]]]=s}o(t._prev),o(e),function o(a,s,u){const l=n[u],c=r[u++];for(const n in c){const r=a?a+"|"+n:n;s[l]=c[n],u<i?o(r,s,u):e[r]||t.cell(r,s)}}("",{},0)},init(t){const e=this._inputs=[],n=this._outputs=[],r={};function i(t){let n,i=mn(Pe(t)),o=0,a=i.length;for(;o<a;++o)r[n=i[o]]||(r[n]=1,e.push(n))}this._dims=mn(t.groupby),this._dnames=this._dims.map((function(t){var e=Fe(t);return i(t),n.push(e),e})),this.cellkey=t.key?t.key:Ys(this._dims),this._countOnly=!0,this._counts=[],this._measures=[];let o,a,s,u,l,c,h=t.fields||[null],d=t.ops||["count"],f=t.as||[],p=h.length,m={};for(p!==d.length&&Be("Unmatched number of fields and aggregate ops."),c=0;c<p;++c)o=h[c],a=d[c],null==o&&"count"!==a&&Be("Null aggregate field specified."),u=Fe(o),l=Zs(a,u,f[c]),n.push(l),"count"!==a?(s=m[u],s||(i(o),s=m[u]=[],s.field=o,this._measures.push(s)),"count"!==a&&(this._countOnly=!1),s.push(nu(a,l))):this._counts.push(l);return this._measures=this._measures.map((function(t){return uu(t,t.field)})),{}},cellkey:Ys(),cell(t,e){let n=this.value[t];return n?0===n.num&&this._drop&&n.stamp<this.stamp?(n.stamp=this.stamp,this._adds[this._alen++]=n):n.stamp<this.stamp&&(n.stamp=this.stamp,this._mods[this._mlen++]=n):(n=this.value[t]=this.newcell(t,e),this._adds[this._alen++]=n),n},newcell(t,e){const n={key:t,num:0,agg:null,tuple:this.newtuple(e,this._prev&&this._prev[t]),stamp:this.stamp,store:!1};if(!this._countOnly){const t=this._measures,e=t.length;n.agg=Array(e);for(let r=0;r<e;++r)n.agg[r]=new t[r](n)}return n.store&&(n.data=new ll),n},newtuple(t,e){const n=this._dnames,r=this._dims,i=r.length,o={};for(let a=0;a<i;++a)o[n[a]]=r[a](t);return e?er(e.tuple,o):Qn(o)},clean(){const t=this.value;for(const e in t)0===t[e].num&&delete t[e]},add(t){const e=this.cellkey(t),n=this.cell(e,t);if(n.num+=1,this._countOnly)return;n.store&&n.data.add(t);const r=n.agg;for(let i=0,o=r.length;i<o;++i)r[i].add(r[i].get(t),t)},rem(t){const e=this.cellkey(t),n=this.cell(e,t);if(n.num-=1,this._countOnly)return;n.store&&n.data.rem(t);const r=n.agg;for(let i=0,o=r.length;i<o;++i)r[i].rem(r[i].get(t),t)},celltuple(t){const e=t.tuple,n=this._counts;t.store&&t.data.values();for(let r=0,i=n.length;r<i;++r)e[n[r]]=t.num;if(!this._countOnly){const n=t.agg;for(let t=0,r=n.length;t<r;++t)n[t].set(e)}return e},changes(t){const e=this._adds,n=this._mods,r=this._prev,i=this._drop,o=t.add,a=t.rem,s=t.mod;let u,l,c,h;if(r)for(l in r)u=r[l],i&&!u.num||a.push(u.tuple);for(c=0,h=this._alen;c<h;++c)o.push(this.celltuple(e[c])),e[c]=null;for(c=0,h=this._mlen;c<h;++c)u=n[c],(0===u.num&&i?a:s).push(this.celltuple(u)),n[c]=null;return this._alen=this._mlen=0,this._prev=null,t}}),dl.Definition={type:"Bin",metadata:{modifies:!0},params:[{name:"field",type:"field",required:!0},{name:"interval",type:"boolean",default:!0},{name:"anchor",type:"number"},{name:"maxbins",type:"number",default:20},{name:"base",type:"number",default:10},{name:"divide",type:"number",array:!0,default:[5,2]},{name:"extent",type:"number",array:!0,length:2,required:!0},{name:"span",type:"number"},{name:"step",type:"number"},{name:"steps",type:"number",array:!0},{name:"minstep",type:"number",default:0},{name:"nice",type:"boolean",default:!0},{name:"name",type:"string"},{name:"as",type:"string",array:!0,length:2,default:["bin0","bin1"]}]},Tn(dl,Hs,{transform(t,e){const n=!1!==t.interval,r=this._bins(t),i=r.start,o=r.step,a=t.as||["bin0","bin1"],s=a[0],u=a[1];let l;return l=t.modified()?(e=e.reflow(!0)).SOURCE:e.modified(Pe(t.field))?e.ADD_MOD:e.ADD,e.visit(l,n?t=>{const e=r(t);t[s]=e,t[u]=null==e?null:i+o*(1+(e-i)/o)}:t=>t[s]=r(t)),e.modifies(n?a:s)},_bins(t){if(this.value&&!t.modified())return this.value;let e,n,r=t.field,i=vu(t),o=i.step,a=i.start,s=a+Math.ceil((i.stop-a)/o)*o;null!=(e=t.anchor)&&(n=e-(a+o*Math.floor((e-a)/o)),a+=n,s+=n);const u=function(t){let e=nn(r(t));return null==e?null:e<a?-1/0:e>s?1/0:(e=Math.max(a,Math.min(e,s-o)),a+o*Math.floor(1e-14+(e-a)/o))};return u.start=a,u.stop=i.stop,u.step=o,this.value=Me(u,Pe(r),t.name||"bin_"+Fe(r))}});var fl=function(t,e,n){let r=t,i=e||[],o=n||[],a={},s=0;return{add:t=>o.push(t),remove:t=>a[r(t)]=++s,size:()=>i.length,data:(t,e)=>(s&&(i=i.filter(t=>!a[r(t)]),a={},s=0),e&&t&&i.sort(t),o.length&&(i=t?function(t,e,n,r){const i=e.length,o=n.length;if(!o)return e;if(!i)return n;let a=new e.constructor(i+o),s=0,u=0,l=0;for(;s<i&&u<o;++l)a[l]=t(e[s],n[u])>0?n[u++]:e[s++];for(;s<i;++s,++l)a[l]=e[s];for(;u<o;++u,++l)a[l]=n[u];return a}(t,i,o.sort(t)):i.concat(o),o=[]),i)}};function pl(t){Hs.call(this,[],t)}function ml(t){ur.call(this,null,gl,t)}function gl(t){return this.value&&!t.modified()?this.value:yn(t.fields,t.orders)}function yl(t){Hs.call(this,null,t)}function vl(t){Hs.call(this,null,t)}pl.Definition={type:"Collect",metadata:{source:!0},params:[{name:"sort",type:"compare"}]},Tn(pl,Hs,{transform(t,e){const n=e.fork(e.ALL),r=fl(Yn,this.value,n.materialize(n.ADD).add),i=t.sort,o=e.changed()||i&&(t.modified("sort")||e.modified(i.fields));return n.visit(n.REM,r.remove),this.modified(o),this.value=n.source=r.data(nr(i),o),e.source&&e.source.root&&(this.value.root=e.source.root),n}}),Tn(ml,ur),yl.Definition={type:"CountPattern",metadata:{generates:!0,changes:!0},params:[{name:"field",type:"field",required:!0},{name:"case",type:"enum",values:["upper","lower","mixed"],default:"mixed"},{name:"pattern",type:"string",default:'[\\w"]+'},{name:"stopwords",type:"string",default:""},{name:"as",type:"string",array:!0,length:2,default:["text","count"]}]},Tn(yl,Hs,{transform(t,e){const n=e=>n=>{for(var r,i=function(t,e,n){switch(e){case"upper":t=t.toUpperCase();break;case"lower":t=t.toLowerCase()}return t.match(n)}(s(n),t.case,o)||[],u=0,l=i.length;u<l;++u)a.test(r=i[u])||e(r)},r=this._parameterCheck(t,e),i=this._counts,o=this._match,a=this._stop,s=t.field,u=t.as||["text","count"],l=n(t=>i[t]=1+(i[t]||0)),c=n(t=>i[t]-=1);return r?e.visit(e.SOURCE,l):(e.visit(e.ADD,l),e.visit(e.REM,c)),this._finish(e,u)},_parameterCheck(t,e){let n=!1;return!t.modified("stopwords")&&this._stop||(this._stop=new RegExp("^"+(t.stopwords||"")+"$","i"),n=!0),!t.modified("pattern")&&this._match||(this._match=new RegExp(t.pattern||"[\\w']+","g"),n=!0),(t.modified("field")||e.modified(t.field.fields))&&(n=!0),n&&(this._counts={}),n},_finish(t,e){let n,r,i,o=this._counts,a=this._tuples||(this._tuples={}),s=e[0],u=e[1],l=t.fork(t.NO_SOURCE|t.NO_FIELDS);for(n in o)r=a[n],i=o[n]||0,!r&&i?(a[n]=r=Qn({}),r[s]=n,r[u]=i,l.add.push(r)):0===i?(r&&l.rem.push(r),o[n]=null,a[n]=null):r[u]!==i&&(r[u]=i,l.mod.push(r));return l.modifies(e)}}),vl.Definition={type:"Cross",metadata:{generates:!0},params:[{name:"filter",type:"expr"},{name:"as",type:"string",array:!0,length:2,default:["a","b"]}]},Tn(vl,Hs,{transform(t,e){let n=e.fork(e.NO_SOURCE),r=this.value,i=t.as||["a","b"],o=i[0],a=i[1];return!r||e.changed(e.ADD_REM)||t.modified("as")||t.modified("filter")?(r&&(n.rem=r),r=e.materialize(e.SOURCE).source,n.add=this.value=function(t,e,n,r){for(var i,o,a=[],s={},u=t.length,l=0;l<u;++l)for(s[e]=o=t[l],i=0;i<u;++i)s[n]=t[i],r(s)&&(a.push(Qn(s)),(s={})[e]=o);return a}(r,o,a,t.filter||Ge)):n.mod=r,n.source=this.value,n.modifies(i)}});const bl={kde:Iu,mixture:Lu,normal:Ru,lognormal:zu,uniform:Wu};function wl(t){Hs.call(this,null,t)}var xl=[{key:{function:"normal"},params:[{name:"mean",type:"number",default:0},{name:"stdev",type:"number",default:1}]},{key:{function:"lognormal"},params:[{name:"mean",type:"number",default:0},{name:"stdev",type:"number",default:1}]},{key:{function:"uniform"},params:[{name:"min",type:"number",default:0},{name:"max",type:"number",default:1}]},{key:{function:"kde"},params:[{name:"field",type:"field",required:!0},{name:"from",type:"data"},{name:"bandwidth",type:"number",default:0}]}];function _l(t,e){return t?t.map((t,n)=>e[n]||Fe(t)):null}function Cl(t,e,n){let r,i,o,a,s,u,l=[],c=t=>t(a);if(null==e)l.push(t.map(n));else for(r={},i=0,o=t.length;i<o;++i)a=t[i],s=e.map(c),u=r[s],u||(r[s]=u=[],u.dims=s,l.push(u)),u.push(n(a));return l}function kl(t){Hs.call(this,null,t)}function Sl(t){ur.call(this,null,El,t),this.modified(!0)}function El(t){const e=t.expr;return this.value&&!t.modified("expr")?this.value:Me(n=>e(n,t),Pe(e),Fe(e))}function Ol(t){Hs.call(this,[void 0,void 0],t)}function Al(t,e){ur.call(this,t),this.parent=e,this.count=0}function Nl(t){Hs.call(this,{},t),this._keys=Nn();const e=this._targets=[];e.active=0,e.forEach=t=>{for(let n=0,r=e.active;n<r;++n)t(e[n],n,e)}}function Tl(t){ur.call(this,null,Dl,t)}function Dl(t){return this.value&&!t.modified()?this.value:Ye(t.name)?mn(t.name).map(t=>$e(t)):$e(t.name,t.as)}function Rl(t){Hs.call(this,Nn(),t)}function Il(t){Hs.call(this,[],t)}function Ml(t){Hs.call(this,[],t)}function Fl(t){Hs.call(this,null,t)}function Pl(t){Hs.call(this,[],t)}wl.Definition={type:"Density",metadata:{generates:!0},params:[{name:"extent",type:"number",array:!0,length:2},{name:"steps",type:"number"},{name:"minsteps",type:"number",default:25},{name:"maxsteps",type:"number",default:200},{name:"method",type:"string",default:"pdf",values:["pdf","cdf"]},{name:"distribution",type:"param",params:xl.concat({key:{function:"mixture"},params:[{name:"distributions",type:"param",array:!0,params:xl},{name:"weights",type:"number",array:!0}]})},{name:"as",type:"string",array:!0,default:["value","density"]}]},Tn(wl,Hs,{transform(t,e){const n=e.fork(e.NO_SOURCE|e.NO_FIELDS);if(!this.value||e.changed()||t.modified()){let r=function t(e,n){const r=e.function;On(bl,r)||Be("Unknown distribution function: "+r);const i=bl[r]();for(const o in e)"field"===o?i.data((e.from||n()).map(e[o])):"distributions"===o?i[o](e[o].map(e=>t(e,n))):"function"==typeof i[o]&&i[o](e[o]);return i}(t.distribution,function(t){return()=>t.materialize(t.SOURCE).source}(e)),i=t.steps||t.minsteps||25,o=t.steps||t.maxsteps||200,a=t.method||"pdf";"pdf"!==a&&"cdf"!==a&&Be("Invalid density method: "+a),t.extent||r.data||Be("Missing density extent parameter."),a=r[a];const s=t.as||["value","density"],u=t.extent||Sn(r.data()),l=sl(a,u,i,o).map(t=>{const e={};return e[s[0]]=t[0],e[s[1]]=t[1],Qn(e)});this.value&&(n.rem=this.value),this.value=n.add=n.source=l}return n}}),kl.Definition={type:"DotBin",metadata:{modifies:!0},params:[{name:"field",type:"field",required:!0},{name:"groupby",type:"field",array:!0},{name:"step",type:"number"},{name:"smooth",type:"boolean",default:!1},{name:"as",type:"string",default:"bin"}]},Tn(kl,Hs,{transform(t,e){if(this.value&&!t.modified()&&!e.changed())return e;const n=e.materialize(e.SOURCE).source,r=Cl(e.source,t.groupby,We),i=t.smooth||!1,o=t.field,a=t.step||((t,e)=>jn(Sn(t,e))/30)(n,o),s=nr((t,e)=>o(t)-o(e)),u=t.as||"bin",l=r.length;let c,h=1/0,d=-1/0,f=0;for(;f<l;++f){const t=r[f].sort(s);c=-1;for(const e of _u(t,a,i,o))e<h&&(h=e),e>d&&(d=e),t[++c][u]=e}return this.value={start:h,stop:d,step:a},e.reflow(!0).modifies(u)}}),Tn(Sl,ur),Ol.Definition={type:"Extent",metadata:{},params:[{name:"field",type:"field",required:!0}]},Tn(Ol,Hs,{transform(t,e){let n,r=this.value,i=t.field,o=r[0],a=r[1];if(n=e.changed()||e.modified(i.fields)||t.modified("field"),(n||null==o)&&(o=1/0,a=-1/0),e.visit(n?e.SOURCE:e.ADD,t=>{let e=nn(i(t));null!=e&&(e<o&&(o=e),e>a&&(a=e))}),!Number.isFinite(o)||!Number.isFinite(a)){let t=Fe(i);t&&(t=` for field "${t}"`),e.dataflow.warn(`Infinite extent${t}: [${o}, ${a}]`),o=a=void 0}this.value=[o,a]}}),Tn(Al,ur,{connect(t){return this.detachSubflow=t.detachSubflow,this.targets().add(t),t.source=this},add(t){this.count+=1,this.value.add.push(t)},rem(t){this.count-=1,this.value.rem.push(t)},mod(t){this.value.mod.push(t)},init(t){this.value.init(t,t.NO_SOURCE)},evaluate(){return this.value}}),Tn(Nl,Hs,{activate(t){this._targets[this._targets.active++]=t},subflow(t,e,n,r){let i,o,a=this.value,s=On(a,t)&&a[t];return s?s.value.stamp<n.stamp&&(s.init(n),this.activate(s)):(o=r||(o=this._group[t])&&o.tuple,i=n.dataflow,s=new Al(n.fork(n.NO_SOURCE),this),i.add(s).connect(e(i,t,o)),a[t]=s,this.activate(s)),s},clean(){const t=this.value;for(const e in t)if(0===t[e].count){const n=t[e].detachSubflow;n&&n(),delete t[e]}},initTargets(){const t=this._targets,e=t.length;for(let n=0;n<e&&null!=t[n];++n)t[n]=null;t.active=0},transform(t,e){const n=e.dataflow,r=t.key,i=t.subflow,o=this._keys,a=t.modified("key"),s=t=>this.subflow(t,i,e);return this._group=t.group||{},this.initTargets(),e.visit(e.REM,t=>{const e=Yn(t),n=o.get(e);void 0!==n&&(o.delete(e),s(n).rem(t))}),e.visit(e.ADD,t=>{const e=r(t);o.set(Yn(t),e),s(e).add(t)}),a||e.modified(r.fields)?e.visit(e.MOD,t=>{const e=Yn(t),n=o.get(e),i=r(t);n===i?s(i).mod(t):(o.set(e,i),s(n).rem(t),s(i).add(t))}):e.changed(e.MOD)&&e.visit(e.MOD,t=>{s(o.get(Yn(t))).mod(t)}),a&&e.visit(e.REFLOW,t=>{const e=Yn(t),n=o.get(e),i=r(t);n!==i&&(o.set(e,i),s(n).rem(t),s(i).add(t))}),e.clean()?n.runAfter(()=>{this.clean(),o.clean()}):o.empty>n.cleanThreshold&&n.runAfter(o.clean),e}}),Tn(Tl,ur),Rl.Definition={type:"Filter",metadata:{changes:!0},params:[{name:"expr",type:"expr",required:!0}]},Tn(Rl,Hs,{transform(t,e){let n=e.dataflow,r=this.value,i=e.fork(),o=i.add,a=i.rem,s=i.mod,u=t.expr,l=!0;function c(e){const n=Yn(e),i=u(e,t),c=r.get(n);i&&c?(r.delete(n),o.push(e)):i||c?l&&i&&!c&&s.push(e):(r.set(n,1),a.push(e))}return e.visit(e.REM,t=>{var e=Yn(t);r.has(e)?r.delete(e):a.push(t)}),e.visit(e.ADD,e=>{u(e,t)?o.push(e):r.set(Yn(e),1)}),e.visit(e.MOD,c),t.modified()&&(l=!1,e.visit(e.REFLOW,c)),r.empty>n.cleanThreshold&&n.runAfter(r.clean),i}}),Il.Definition={type:"Flatten",metadata:{generates:!0},params:[{name:"fields",type:"field",array:!0,required:!0},{name:"index",type:"string"},{name:"as",type:"string",array:!0}]},Tn(Il,Hs,{transform(t,e){const n=e.fork(e.NO_SOURCE),r=t.fields,i=_l(r,t.as||[]),o=t.index||null,a=i.length;return n.rem=this.value,e.visit(e.SOURCE,t=>{let e,s,u,l=r.map(e=>e(t)),c=l.reduce((t,e)=>Math.max(t,e.length),0),h=0;for(;h<c;++h){for(s=Jn(t),e=0;e<a;++e)s[i[e]]=null==(u=l[e][h])?null:u;o&&(s[o]=h),n.add.push(s)}}),this.value=n.source=n.add,o&&n.modifies(o),n.modifies(i)}}),Ml.Definition={type:"Fold",metadata:{generates:!0},params:[{name:"fields",type:"field",array:!0,required:!0},{name:"as",type:"string",array:!0,length:2,default:["key","value"]}]},Tn(Ml,Hs,{transform(t,e){const n=e.fork(e.NO_SOURCE),r=t.fields,i=r.map(Fe),o=t.as||["key","value"],a=o[0],s=o[1],u=r.length;return n.rem=this.value,e.visit(e.SOURCE,t=>{for(let e,o=0;o<u;++o)e=Jn(t),e[a]=i[o],e[s]=r[o](t),n.add.push(e)}),this.value=n.source=n.add,n.modifies(o)}}),Fl.Definition={type:"Formula",metadata:{modifies:!0},params:[{name:"expr",type:"expr",required:!0},{name:"as",type:"string",required:!0},{name:"initonly",type:"boolean"}]},Tn(Fl,Hs,{transform(t,e){const n=t.expr,r=t.as,i=t.modified(),o=t.initonly?e.ADD:i?e.SOURCE:e.modified(n.fields)||e.modified(r)?e.ADD_MOD:e.ADD;return i&&(e=e.materialize().reflow(!0)),t.initonly||e.modifies(r),e.visit(o,e=>e[r]=n(e,t))}}),Tn(Pl,Hs,{transform(t,e){let n,r,i,o=this.value,a=e.fork(e.ALL),s=t.size-o.length,u=t.generator;if(s>0){for(n=[];--s>=0;)n.push(i=Qn(u(t))),o.push(i);a.add=a.add.length?a.materialize(a.ADD).add.concat(n):n}else r=o.slice(0,-s),a.rem=a.rem.length?a.materialize(a.REM).rem.concat(r):r,o=o.slice(-s);return a.source=this.value=o,a}});const jl={value:"value",median:nl,mean:function(t,e){let n=0,r=0;if(void 0===e)for(let i of t)null!=i&&(i=+i)>=i&&(++n,r+=i);else{let i=-1;for(let o of t)null!=(o=e(o,++i,t))&&(o=+o)>=o&&(++n,r+=o)}if(n)return r/n},min:hu,max:cu},zl=[];function Ll(t){Hs.call(this,[],t)}function Bl(t){hl.call(this,t)}function Ul(t){Hs.call(this,null,t)}function $l(t){ur.call(this,null,Vl,t)}function Vl(t){return this.value&&!t.modified()?this.value:Fn(t.fields,t.flat)}function Wl(t){Hs.call(this,[],t),this._pending=null}function ql(t,e,n){n.forEach(Qn);const r=e.fork(e.NO_FIELDS&e.NO_SOURCE);return r.rem=t.value,t.value=r.source=r.add=n,t._pending=null,r.rem.length&&r.clean(!0),r}function Hl(t){Hs.call(this,{},t)}function Gl(t){ur.call(this,null,Xl,t)}function Xl(t){if(this.value&&!t.modified())return this.value;let e,n,r,i=1/0,o=-1/0,a=t.extents;for(e=0,n=a.length;e<n;++e)r=a[e],r[0]<i&&(i=r[0]),r[1]>o&&(o=r[1]);return[i,o]}function Kl(t){ur.call(this,null,Yl,t)}function Yl(t){return this.value&&!t.modified()?this.value:t.values.reduce((t,e)=>t.concat(e),[])}function Zl(t){Hs.call(this,null,t)}function Ql(t){hl.call(this,t)}function Jl(t){Nl.call(this,t)}function tc(t){Hs.call(this,null,t)}function ec(t){Hs.call(this,null,t)}Ll.Definition={type:"Impute",metadata:{changes:!0},params:[{name:"field",type:"field",required:!0},{name:"key",type:"field",required:!0},{name:"keyvals",array:!0},{name:"groupby",type:"field",array:!0},{name:"method",type:"enum",default:"value",values:["value","mean","median","max","min"]},{name:"value",default:0}]},Tn(Ll,Hs,{transform(t,e){var n,r,i,o,a,s,u,l,c,h,d=e.fork(e.ALL),f=function(t){var e,n=t.method||jl.value;if(null!=jl[n])return n===jl.value?(e=void 0!==t.value?t.value:0,()=>e):jl[n];Be("Unrecognized imputation method: "+n)}(t),p=function(t){var e=t.field;return t=>t?e(t):NaN}(t),m=Fe(t.field),g=Fe(t.key),y=(t.groupby||[]).map(Fe),v=function(t,e,n,r){var i,o,a,s,u,l,c,h,d=t=>t(h),f=[],p=r?r.slice():[],m={},g={};for(p.forEach((t,e)=>m[t]=e+1),s=0,c=t.length;s<c;++s)l=n(h=t[s]),u=m[l]||(m[l]=p.push(l)),(a=g[o=(i=e?e.map(d):zl)+""])||(a=g[o]=[],f.push(a),a.values=i),a[u-1]=h;return f.domain=p,f}(e.source,t.groupby,t.key,t.keyvals),b=[],w=this.value,x=v.domain.length;for(a=0,l=v.length;a<l;++a)for(i=(n=v[a]).values,r=NaN,u=0;u<x;++u)if(null==n[u]){for(o=v.domain[u],h={_impute:!0},s=0,c=i.length;s<c;++s)h[y[s]]=i[s];h[g]=o,h[m]=Number.isNaN(r)?r=f(n,p):r,b.push(Qn(h))}return b.length&&(d.add=d.materialize(d.ADD).add.concat(b)),w.length&&(d.rem=d.materialize(d.REM).rem.concat(w)),this.value=b,d}}),Bl.Definition={type:"JoinAggregate",metadata:{modifies:!0},params:[{name:"groupby",type:"field",array:!0},{name:"fields",type:"field",null:!0,array:!0},{name:"ops",type:"enum",array:!0,values:eu},{name:"as",type:"string",null:!0,array:!0},{name:"key",type:"field"}]},Tn(Bl,hl,{transform(t,e){let n,r=this,i=t.modified();return r.value&&(i||e.modified(r._inputs,!0))?(n=r.value=i?r.init(t):{},e.visit(e.SOURCE,t=>r.add(t))):(n=r.value=r.value||this.init(t),e.visit(e.REM,t=>r.rem(t)),e.visit(e.ADD,t=>r.add(t))),r.changes(),e.visit(e.SOURCE,t=>{kn(t,n[r.cellkey(t)].tuple)}),e.reflow(i).modifies(this._outputs)},changes(){let t,e,n=this._adds,r=this._mods;for(t=0,e=this._alen;t<e;++t)this.celltuple(n[t]),n[t]=null;for(t=0,e=this._mlen;t<e;++t)this.celltuple(r[t]),r[t]=null;this._alen=this._mlen=0}}),Ul.Definition={type:"KDE",metadata:{generates:!0},params:[{name:"groupby",type:"field",array:!0},{name:"field",type:"field",required:!0},{name:"cumulative",type:"boolean",default:!1},{name:"counts",type:"boolean",default:!1},{name:"bandwidth",type:"number",default:0},{name:"extent",type:"number",array:!0,length:2},{name:"resolve",type:"enum",values:["shared","independent"],default:"independent"},{name:"steps",type:"number"},{name:"minsteps",type:"number",default:25},{name:"maxsteps",type:"number",default:200},{name:"as",type:"string",array:!0,default:["value","density"]}]},Tn(Ul,Hs,{transform(t,e){const n=e.fork(e.NO_SOURCE|e.NO_FIELDS);if(!this.value||e.changed()||t.modified()){const r=e.materialize(e.SOURCE).source,i=Cl(r,t.groupby,t.field),o=(t.groupby||[]).map(Fe),a=t.bandwidth,s=t.cumulative?"cdf":"pdf",u=t.as||["value","density"],l=[];let c=t.extent,h=t.steps||t.minsteps||25,d=t.steps||t.maxsteps||200;"pdf"!==s&&"cdf"!==s&&Be("Invalid density method: "+s),"shared"===t.resolve&&(c||(c=Sn(r,t.field)),h=d=t.steps||d),i.forEach(e=>{const n=Iu(e,a)[s],r=t.counts?e.length:1,i=c||Sn(e);sl(n,i,h,d).forEach(t=>{const n={};for(let r=0;r<o.length;++r)n[o[r]]=e.dims[r];n[u[0]]=t[0],n[u[1]]=t[1]*r,l.push(Qn(n))})}),this.value&&(n.rem=this.value),this.value=n.add=n.source=l}return n}}),Tn($l,ur),Tn(Wl,Hs,{transform(t,e){const n=e.dataflow;return this._pending?ql(this,e,this._pending):function(t){return t.modified("async")&&!(t.modified("values")||t.modified("url")||t.modified("format"))}(t)?e.StopPropagation:t.values?ql(this,e,n.parse(t.values,t.format)):t.async?{async:n.request(t.url,t.format).then(t=>(this._pending=mn(t.data),t=>t.touch(this)))}:n.request(t.url,t.format).then(t=>ql(this,e,mn(t.data)))}}),Hl.Definition={type:"Lookup",metadata:{modifies:!0},params:[{name:"index",type:"index",params:[{name:"from",type:"data",required:!0},{name:"key",type:"field",required:!0}]},{name:"values",type:"field",array:!0},{name:"fields",type:"field",array:!0,required:!0},{name:"as",type:"string",array:!0},{name:"default",default:null}]},Tn(Hl,Hs,{transform(t,e){let n,r,i,o=e,a=t.as,s=t.fields,u=t.index,l=t.values,c=null==t.default?null:t.default,h=t.modified(),d=h?e.SOURCE:e.ADD,f=s.length;return l?(r=l.length,f>1&&!a&&Be('Multi-field lookup requires explicit "as" parameter.'),a&&a.length!==f*r&&Be('The "as" parameter has too few output field names.'),a=a||l.map(Fe),n=function(t){for(var e,n,i=0,o=0;i<f;++i)if(null==(n=u.get(s[i](t))))for(e=0;e<r;++e,++o)t[a[o]]=c;else for(e=0;e<r;++e,++o)t[a[o]]=l[e](n)}):(a||Be("Missing output field names."),n=function(t){for(var e,n=0;n<f;++n)e=u.get(s[n](t)),t[a[n]]=null==e?c:e}),h?o=e.reflow(!0):(i=s.some(t=>e.modified(t.fields)),d|=i?e.MOD:0),e.visit(d,n),o.modifies(a)}}),Tn(Gl,ur),Tn(Kl,ur),Tn(Zl,Hs,{transform(t,e){return this.modified(t.modified()),this.value=t,e.fork(e.NO_SOURCE|e.NO_FIELDS)}}),Ql.Definition={type:"Pivot",metadata:{generates:!0,changes:!0},params:[{name:"groupby",type:"field",array:!0},{name:"field",type:"field",required:!0},{name:"value",type:"field",required:!0},{name:"op",type:"enum",values:eu,default:"sum"},{name:"limit",type:"number",default:0},{name:"key",type:"field"}]},Tn(Ql,hl,{_transform:hl.prototype.transform,transform(t,e){return this._transform(function(t,e){const n=t.field,r=t.value,i=("count"===t.op?"__count__":t.op)||"sum",o=Pe(n).concat(Pe(r)),a=function(t,e,n){const r={},i=[];return n.visit(n.SOURCE,e=>{const n=t(e);r[n]||(r[n]=1,i.push(n))}),i.sort(vn),e?i.slice(0,e):i}(n,t.limit||0,e);return e.changed()&&t.set("__pivot__",null,null,!0),{key:t.key,groupby:t.groupby,ops:a.map((function(){return i})),fields:a.map((function(t){return function(t,e,n,r){return Me(r=>e(r)===t?n(r):NaN,r,t+"")}(t,n,r,o)})),as:a.map((function(t){return t+""})),modified:t.modified.bind(t)}}(t,e),e)}}),Tn(Jl,Nl,{transform(t,e){const n=t.subflow,r=t.field,i=t=>this.subflow(Yn(t),n,e,t);return(t.modified("field")||r&&e.modified(Pe(r)))&&Be("PreFacet does not support field modification."),this.initTargets(),r?(e.visit(e.MOD,t=>{const e=i(t);r(t).forEach(t=>e.mod(t))}),e.visit(e.ADD,t=>{const e=i(t);r(t).forEach(t=>e.add(Qn(t)))}),e.visit(e.REM,t=>{const e=i(t);r(t).forEach(t=>e.rem(t))})):(e.visit(e.MOD,t=>i(t).mod(t)),e.visit(e.ADD,t=>i(t).add(t)),e.visit(e.REM,t=>i(t).rem(t))),e.clean()&&e.runAfter(()=>this.clean()),e}}),tc.Definition={type:"Project",metadata:{generates:!0,changes:!0},params:[{name:"fields",type:"field",array:!0},{name:"as",type:"string",null:!0,array:!0}]},Tn(tc,Hs,{transform(t,e){let n,r,i=t.fields,o=_l(t.fields,t.as||[]),a=i?(t,e)=>function(t,e,n,r){for(let i=0,o=n.length;i<o;++i)e[r[i]]=n[i](t);return e}(t,e,i,o):tr;return this.value?r=this.value:(e=e.addAll(),r=this.value={}),n=e.fork(e.NO_SOURCE),e.visit(e.REM,t=>{const e=Yn(t);n.rem.push(r[e]),r[e]=null}),e.visit(e.ADD,t=>{const e=a(t,Qn({}));r[Yn(t)]=e,n.add.push(e)}),e.visit(e.MOD,t=>{n.mod.push(a(t,r[Yn(t)]))}),n}}),Tn(ec,Hs,{transform(t,e){return this.value=t.value,t.modified("value")?e.fork(e.NO_SOURCE|e.NO_FIELDS):e.StopPropagation}});var nc=function(t,e,n){t=+t,e=+e,n=(i=arguments.length)<2?(e=t,t=0,1):i<3?1:+n;for(var r=-1,i=0|Math.max(0,Math.ceil((e-t)/n)),o=new Array(i);++r<i;)o[r]=t+r*n;return o};function rc(t){Hs.call(this,null,t)}function ic(t){Hs.call(this,null,t)}function oc(t){Hs.call(this,[],t),this.count=0}function ac(t){Hs.call(this,null,t)}function sc(t){Hs.call(this,null,t),this.modified(!0)}function uc(t){Hs.call(this,null,t)}rc.Definition={type:"Quantile",metadata:{generates:!0,changes:!0},params:[{name:"groupby",type:"field",array:!0},{name:"field",type:"field",required:!0},{name:"probs",type:"number",array:!0},{name:"step",type:"number",default:.01},{name:"as",type:"string",array:!0,default:["prob","value"]}]},Tn(rc,Hs,{transform(t,e){const n=e.fork(e.NO_SOURCE|e.NO_FIELDS),r=t.as||["prob","value"];if(this.value&&!t.modified()&&!e.changed())return n.source=this.value,n;const i=Cl(e.materialize(e.SOURCE).source,t.groupby,t.field),o=(t.groupby||[]).map(Fe),a=[],s=t.step||.01,u=t.probs||nc(s/2,1-1e-14,s),l=u.length;return i.forEach(t=>{const e=mu(t,u);for(let n=0;n<l;++n){const i={};for(let e=0;e<o.length;++e)i[o[e]]=t.dims[e];i[r[0]]=u[n],i[r[1]]=e[n],a.push(Qn(i))}}),this.value&&(n.rem=this.value),this.value=n.add=n.source=a,n}}),Tn(ic,Hs,{transform(t,e){let n,r;return this.value?r=this.value:(n=e=e.addAll(),r=this.value={}),t.derive&&(n=e.fork(e.NO_SOURCE),e.visit(e.REM,t=>{const e=Yn(t);n.rem.push(r[e]),r[e]=null}),e.visit(e.ADD,t=>{const e=Jn(t);r[Yn(t)]=e,n.add.push(e)}),e.visit(e.MOD,t=>{const e=r[Yn(t)];for(const r in t)e[r]=t[r],n.modifies(r);n.mod.push(e)})),n}}),oc.Definition={type:"Sample",metadata:{},params:[{name:"size",type:"number",default:1e3}]},Tn(oc,Hs,{transform(t,e){let n=e.fork(e.NO_SOURCE),r=t.modified("size"),i=t.size,o=this.value,a=this.count,s=0,u=o.reduce((t,e)=>(t[Yn(e)]=1,t),{});function l(t){let e,r;o.length<i?o.push(t):(r=~~((a+1)*bu()),r<o.length&&r>=s&&(e=o[r],u[Yn(e)]&&n.rem.push(e),o[r]=t)),++a}if(e.rem.length&&(e.visit(e.REM,t=>{const e=Yn(t);u[e]&&(u[e]=-1,n.rem.push(t)),--a}),o=o.filter(t=>-1!==u[Yn(t)])),(e.rem.length||r)&&o.length<i&&e.source&&(s=a=o.length,e.visit(e.SOURCE,t=>{u[Yn(t)]||l(t)}),s=-1),r&&o.length>i){const t=o.length-i;for(let e=0;e<t;++e)u[Yn(o[e])]=-1,n.rem.push(o[e]);o=o.slice(t)}return e.mod.length&&e.visit(e.MOD,t=>{u[Yn(t)]&&n.mod.push(t)}),e.add.length&&e.visit(e.ADD,l),(e.add.length||s<0)&&(n.add=o.filter(t=>!u[Yn(t)])),this.count=a,this.value=n.source=o,n}}),ac.Definition={type:"Sequence",metadata:{generates:!0,changes:!0},params:[{name:"start",type:"number",required:!0},{name:"stop",type:"number",required:!0},{name:"step",type:"number",default:1},{name:"as",type:"string",default:"data"}]},Tn(ac,Hs,{transform(t,e){if(this.value&&!t.modified())return;const n=e.materialize().fork(e.MOD),r=t.as||"data";return n.rem=this.value?e.rem.concat(this.value):e.rem,this.value=nc(t.start,t.stop,t.step||1).map(t=>{const e={};return e[r]=t,Qn(e)}),n.add=e.add.concat(this.value),n}}),Tn(sc,Hs,{transform(t,e){return this.value=e.source,e.changed()?e.fork(e.NO_SOURCE|e.NO_FIELDS):e.StopPropagation}});const lc=["unit0","unit1"];function cc(t){Hs.call(this,Nn(),t)}function hc(t){Hs.call(this,null,t)}uc.Definition={type:"TimeUnit",metadata:{modifies:!0},params:[{name:"field",type:"field",required:!0},{name:"interval",type:"boolean",default:!0},{name:"units",type:"enum",values:Ii,array:!0},{name:"step",type:"number",default:1},{name:"maxbins",type:"number",default:40},{name:"extent",type:"date",array:!0},{name:"timezone",type:"enum",default:"local",values:["local","utc"]},{name:"as",type:"string",array:!0,length:2,default:lc}]},Tn(uc,Hs,{transform(t,e){let n=t.field,r=!1!==t.interval,i="utc"===t.timezone,o=this._floor(t,e),a=(i?Po:Fo)(o.unit).offset,s=t.as||lc,u=s[0],l=s[1],c=o.start||1/0,h=o.stop||-1/0,d=o.step,f=e.ADD;return(t.modified()||e.modified(Pe(n)))&&(f=(e=e.reflow(!0)).SOURCE,c=1/0,h=-1/0),e.visit(f,t=>{let e,i,s=n(t);null==s?(t[u]=null,r&&(t[l]=null)):(t[u]=e=i=o(s),r&&(t[l]=i=a(e,d)),e<c&&(c=e),i>h&&(h=i))}),o.start=c,o.stop=h,e.modifies(r?s:u)},_floor(t,e){const n="utc"===t.timezone;let{units:r,step:i}=t.units?{units:t.units,step:t.step||1}:Jo({extent:t.extent||Sn(e.materialize(e.SOURCE).source,t.field),maxbins:t.maxbins});r=Fi(r);const o=this.value||{},a=(n?bo:go)(r,i);return a.unit=en(r),a.units=r,a.step=i,a.start=o.start,a.stop=o.stop,this.value=a}}),Tn(cc,Hs,{transform(t,e){const n=e.dataflow,r=t.field,i=this.value,o=t=>i.set(r(t),t);let a=!0;return t.modified("field")||e.modified(r.fields)?(i.clear(),e.visit(e.SOURCE,o)):e.changed()?(e.visit(e.REM,t=>i.delete(r(t))),e.visit(e.ADD,o)):a=!1,this.modified(a),i.empty>n.cleanThreshold&&n.runAfter(i.clean),e.fork()}}),Tn(hc,Hs,{transform(t,e){(!this.value||t.modified("field")||t.modified("sort")||e.changed()||t.sort&&e.modified(t.sort.fields))&&(this.value=(t.sort?e.source.slice().sort(nr(t.sort)):e.source).map(t.field))}});const dc={row_number:function(){return{next:t=>t.index+1}},rank:function(){let t;return{init:()=>t=1,next:e=>{let n=e.index,r=e.data;return n&&e.compare(r[n-1],r[n])?t=n+1:t}}},dense_rank:function(){let t;return{init:()=>t=1,next:e=>{let n=e.index,r=e.data;return n&&e.compare(r[n-1],r[n])?++t:t}}},percent_rank:function(){let t=dc.rank(),e=t.next;return{init:t.init,next:t=>(e(t)-1)/(t.data.length-1)}},cume_dist:function(){let t;return{init:()=>t=0,next:e=>{let n=e.index,r=e.data,i=e.compare;if(t<n){for(;n+1<r.length&&!i(r[n],r[n+1]);)++n;t=n}return(1+t)/r.length}}},ntile:function(t,e){(e=+e)>0||Be("ntile num must be greater than zero.");let n=dc.cume_dist(),r=n.next;return{init:n.init,next:t=>Math.ceil(e*r(t))}},lag:function(t,e){return e=+e||1,{next:n=>{let r=n.index-e;return r>=0?t(n.data[r]):null}}},lead:function(t,e){return e=+e||1,{next:n=>{let r=n.index+e,i=n.data;return r<i.length?t(i[r]):null}}},first_value:function(t){return{next:e=>t(e.data[e.i0])}},last_value:function(t){return{next:e=>t(e.data[e.i1-1])}},nth_value:function(t,e){return(e=+e)>0||Be("nth_value nth must be greater than zero."),{next:n=>{let r=n.i0+(e-1);return r<n.i1?t(n.data[r]):null}}},prev_value:function(t){let e;return{init:()=>e=null,next:n=>{let r=t(n.data[n.index]);return null!=r?e=r:e}}},next_value:function(t){let e,n;return{init:()=>(e=null,n=-1),next:r=>{let i=r.data;return r.index<=n?e:(n=function(t,e,n){for(let r=e.length;n<r;++n)if(null!=t(e[n]))return n;return-1}(t,i,r.index))<0?(n=i.length,e=null):e=t(i[n])}}}},fc=Object.keys(dc);function pc(t){let e=mn(t.ops),n=mn(t.fields),r=mn(t.params),i=mn(t.as),o=this.outputs=[],a=this.windows=[],s={},u={},l=!0,c=[],h=[];function d(t){mn(Pe(t)).forEach(t=>s[t]=1)}d(t.sort),e.forEach((function(t,e){let s=n[e],f=Fe(s),p=Zs(t,f,i[e]);if(d(s),o.push(p),On(dc,t))a.push(function(t,e,n,r){let i=dc[t](e,n);return{init:i.init||qe,update:function(t,e){e[r]=i.next(t)}}}(t,n[e],r[e],p));else{if(null==s&&"count"!==t&&Be("Null aggregate field specified."),"count"===t)return void c.push(p);l=!1;let e=u[f];e||(e=u[f]=[],e.field=s,h.push(e)),e.push(nu(t,p))}})),(c.length||h.length)&&(this.cell=function(t,e,n){t=t.map(t=>uu(t,t.field));let r={num:0,agg:null,store:!1,count:e};if(!n)for(var i=t.length,o=r.agg=Array(i),a=0;a<i;++a)o[a]=new t[a](r);if(r.store)var s=r.data=new ll;return r.add=function(t){if(r.num+=1,!n){s&&s.add(t);for(let e=0;e<i;++e)o[e].add(o[e].get(t),t)}},r.rem=function(t){if(r.num-=1,!n){s&&s.rem(t);for(let e=0;e<i;++e)o[e].rem(o[e].get(t),t)}},r.set=function(t){let i,a;for(s&&s.values(),i=0,a=e.length;i<a;++i)t[e[i]]=r.num;if(!n)for(i=0,a=o.length;i<a;++i)o[i].set(t)},r.init=function(){r.num=0,s&&s.reset();for(let t=0;t<i;++t)o[t].init()},r}(h,c,l)),this.inputs=Object.keys(s)}const mc=pc.prototype;function gc(t){Hs.call(this,{},t),this._mlen=0,this._mods=[]}function yc(t,e,n,r){const i=r.sort,o=i&&!r.ignorePeers,a=r.frame||[null,0],s=t.data(n),u=s.length,l=o?Wo(i):null,c={i0:0,i1:0,p0:0,p1:0,index:0,data:s,compare:i||_n(-1)};e.init();for(let h=0;h<u;++h)vc(c,a,h,u),o&&bc(c,l),e.update(c,s[h])}function vc(t,e,n,r){t.p0=t.i0,t.p1=t.i1,t.i0=null==e[0]?0:Math.max(0,n-Math.abs(e[0])),t.i1=null==e[1]?r:Math.min(r,n+Math.abs(e[1])+1),t.index=n}function bc(t,e){const n=t.i0,r=t.i1-1,i=t.compare,o=t.data,a=o.length-1;n>0&&!i(o[n],o[n-1])&&(t.i0=e.left(o,o[n])),r<a&&!i(o[r],o[r+1])&&(t.i1=e.right(o,o[r]))}mc.init=function(){this.windows.forEach(t=>t.init()),this.cell&&this.cell.init()},mc.update=function(t,e){let n,r=this.cell,i=this.windows,o=t.data,a=i&&i.length;if(r){for(n=t.p0;n<t.i0;++n)r.rem(o[n]);for(n=t.p1;n<t.i1;++n)r.add(o[n]);r.set(e)}for(n=0;n<a;++n)i[n].update(t,e)},gc.Definition={type:"Window",metadata:{modifies:!0},params:[{name:"sort",type:"compare"},{name:"groupby",type:"field",array:!0},{name:"ops",type:"enum",array:!0,values:fc.concat(eu)},{name:"params",type:"number",null:!0,array:!0},{name:"fields",type:"field",null:!0,array:!0},{name:"as",type:"string",null:!0,array:!0},{name:"frame",type:"number",null:!0,array:!0,length:2,default:[null,0]},{name:"ignorePeers",type:"boolean",default:!1}]},Tn(gc,Hs,{transform(t,e){this.stamp=e.stamp;const n=t.modified(),r=nr(t.sort),i=Ys(t.groupby),o=t=>this.group(i(t));let a=this.state;a&&!n||(a=this.state=new pc(t)),n||e.modified(a.inputs)?(this.value={},e.visit(e.SOURCE,t=>o(t).add(t))):(e.visit(e.REM,t=>o(t).remove(t)),e.visit(e.ADD,t=>o(t).add(t)));for(let s=0,u=this._mlen;s<u;++s)yc(this._mods[s],a,r,t);return this._mlen=0,this._mods=[],e.reflow(n).modifies(a.outputs)},group(t){let e=this.value[t];return e||(e=this.value[t]=fl(Yn),e.stamp=-1),e.stamp<this.stamp&&(e.stamp=this.stamp,this._mods[this._mlen++]=e),e}});const wc="top",xc="left",_c="right",Cc="end",kc="row";var Sc=0;function Ec(t){return t&&t.gradient}function Oc(t,e,n){let r=t.id,i=t.gradient,o="radial"===i?"p_":"";return r||(r=t.id="gradient_"+Sc++,"radial"===i?(t.x1=Ac(t.x1,.5),t.y1=Ac(t.y1,.5),t.r1=Ac(t.r1,0),t.x2=Ac(t.x2,.5),t.y2=Ac(t.y2,.5),t.r2=Ac(t.r2,.5),o="p_"):(t.x1=Ac(t.x1,0),t.y1=Ac(t.y1,0),t.x2=Ac(t.x2,1),t.y2=Ac(t.y2,0))),e[r]=t,"url("+(n||"")+"#"+o+r+")"}function Ac(t,e){return null!=t?t:e}function Nc(t,e,n){t._context.bezierCurveTo((2*t._x0+t._x1)/3,(2*t._y0+t._y1)/3,(t._x0+2*t._x1)/3,(t._y0+2*t._y1)/3,(t._x0+4*t._x1+e)/6,(t._y0+4*t._y1+n)/6)}function Tc(t){this._context=t}Tc.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:Nc(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:Nc(this,t,e)}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}};var Dc=function(t){return new Tc(t)},Rc=function(){};function Ic(t){this._context=t}Ic.prototype={areaStart:Rc,areaEnd:Rc,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x2,this._y2),this._context.closePath();break;case 2:this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break;case 3:this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4)}},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._x2=t,this._y2=e;break;case 1:this._point=2,this._x3=t,this._y3=e;break;case 2:this._point=3,this._x4=t,this._y4=e,this._context.moveTo((this._x0+4*this._x1+t)/6,(this._y0+4*this._y1+e)/6);break;default:Nc(this,t,e)}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}};var Mc=function(t){return new Ic(t)};function Fc(t){this._context=t}Fc.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var n=(this._x0+4*this._x1+t)/6,r=(this._y0+4*this._y1+e)/6;this._line?this._context.lineTo(n,r):this._context.moveTo(n,r);break;case 3:this._point=4;default:Nc(this,t,e)}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}};var Pc=function(t){return new Fc(t)};function jc(t,e){this._basis=new Tc(t),this._beta=e}jc.prototype={lineStart:function(){this._x=[],this._y=[],this._basis.lineStart()},lineEnd:function(){var t=this._x,e=this._y,n=t.length-1;if(n>0)for(var r,i=t[0],o=e[0],a=t[n]-i,s=e[n]-o,u=-1;++u<=n;)this._basis.point(this._beta*t[u]+(1-this._beta)*(i+(r=u/n)*a),this._beta*e[u]+(1-this._beta)*(o+r*s));this._x=this._y=null,this._basis.lineEnd()},point:function(t,e){this._x.push(+t),this._y.push(+e)}};var zc=function t(e){function n(t){return 1===e?new Tc(t):new jc(t,e)}return n.beta=function(e){return t(+e)},n}(.85);function Lc(t,e,n){t._context.bezierCurveTo(t._x1+t._k*(t._x2-t._x0),t._y1+t._k*(t._y2-t._y0),t._x2+t._k*(t._x1-e),t._y2+t._k*(t._y1-n),t._x2,t._y2)}function Bc(t,e){this._context=t,this._k=(1-e)/6}Bc.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:Lc(this,this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2,this._x1=t,this._y1=e;break;case 2:this._point=3;default:Lc(this,t,e)}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};var Uc=function t(e){function n(t){return new Bc(t,e)}return n.tension=function(e){return t(+e)},n}(0);function $c(t,e){this._context=t,this._k=(1-e)/6}$c.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:Lc(this,t,e)}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};var Vc=function t(e){function n(t){return new $c(t,e)}return n.tension=function(e){return t(+e)},n}(0);function Wc(t,e){this._context=t,this._k=(1-e)/6}Wc.prototype={areaStart:Rc,areaEnd:Rc,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5)}},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._x3=t,this._y3=e;break;case 1:this._point=2,this._context.moveTo(this._x4=t,this._y4=e);break;case 2:this._point=3,this._x5=t,this._y5=e;break;default:Lc(this,t,e)}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};var qc=function t(e){function n(t){return new Wc(t,e)}return n.tension=function(e){return t(+e)},n}(0),Hc=Math.abs,Gc=Math.atan2,Xc=Math.cos,Kc=Math.max,Yc=Math.min,Zc=Math.sin,Qc=Math.sqrt,Jc=Math.PI,th=Jc/2,eh=2*Jc;function nh(t){return t>1?0:t<-1?Jc:Math.acos(t)}function rh(t){return t>=1?th:t<=-1?-th:Math.asin(t)}function ih(t,e,n){var r=t._x1,i=t._y1,o=t._x2,a=t._y2;if(t._l01_a>1e-12){var s=2*t._l01_2a+3*t._l01_a*t._l12_a+t._l12_2a,u=3*t._l01_a*(t._l01_a+t._l12_a);r=(r*s-t._x0*t._l12_2a+t._x2*t._l01_2a)/u,i=(i*s-t._y0*t._l12_2a+t._y2*t._l01_2a)/u}if(t._l23_a>1e-12){var l=2*t._l23_2a+3*t._l23_a*t._l12_a+t._l12_2a,c=3*t._l23_a*(t._l23_a+t._l12_a);o=(o*l+t._x1*t._l23_2a-e*t._l12_2a)/c,a=(a*l+t._y1*t._l23_2a-n*t._l12_2a)/c}t._context.bezierCurveTo(r,i,o,a,t._x2,t._y2)}function oh(t,e){this._context=t,this._alpha=e}oh.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){if(t=+t,e=+e,this._point){var n=this._x2-t,r=this._y2-e;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3;default:ih(this,t,e)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};var ah=function t(e){function n(t){return e?new oh(t,e):new Bc(t,0)}return n.alpha=function(e){return t(+e)},n}(.5);function sh(t,e){this._context=t,this._alpha=e}sh.prototype={areaStart:Rc,areaEnd:Rc,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5)}},point:function(t,e){if(t=+t,e=+e,this._point){var n=this._x2-t,r=this._y2-e;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._x3=t,this._y3=e;break;case 1:this._point=2,this._context.moveTo(this._x4=t,this._y4=e);break;case 2:this._point=3,this._x5=t,this._y5=e;break;default:ih(this,t,e)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};var uh=function t(e){function n(t){return e?new sh(t,e):new Wc(t,0)}return n.alpha=function(e){return t(+e)},n}(.5);function lh(t,e){this._context=t,this._alpha=e}lh.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){if(t=+t,e=+e,this._point){var n=this._x2-t,r=this._y2-e;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:ih(this,t,e)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};var ch=function t(e){function n(t){return e?new lh(t,e):new $c(t,0)}return n.alpha=function(e){return t(+e)},n}(.5);function hh(t){this._context=t}hh.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:this._context.lineTo(t,e)}}};var dh=function(t){return new hh(t)};function fh(t){this._context=t}fh.prototype={areaStart:Rc,areaEnd:Rc,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(t,e){t=+t,e=+e,this._point?this._context.lineTo(t,e):(this._point=1,this._context.moveTo(t,e))}};var ph=function(t){return new fh(t)};function mh(t){return t<0?-1:1}function gh(t,e,n){var r=t._x1-t._x0,i=e-t._x1,o=(t._y1-t._y0)/(r||i<0&&-0),a=(n-t._y1)/(i||r<0&&-0),s=(o*i+a*r)/(r+i);return(mh(o)+mh(a))*Math.min(Math.abs(o),Math.abs(a),.5*Math.abs(s))||0}function yh(t,e){var n=t._x1-t._x0;return n?(3*(t._y1-t._y0)/n-e)/2:e}function vh(t,e,n){var r=t._x0,i=t._x1,o=t._y1,a=(i-r)/3;t._context.bezierCurveTo(r+a,t._y0+a*e,i-a,o-a*n,i,o)}function bh(t){this._context=t}function wh(t){this._context=new xh(t)}function xh(t){this._context=t}function _h(t){return new bh(t)}function Ch(t){return new wh(t)}function kh(t){this._context=t}function Sh(t){var e,n,r=t.length-1,i=new Array(r),o=new Array(r),a=new Array(r);for(i[0]=0,o[0]=2,a[0]=t[0]+2*t[1],e=1;e<r-1;++e)i[e]=1,o[e]=4,a[e]=4*t[e]+2*t[e+1];for(i[r-1]=2,o[r-1]=7,a[r-1]=8*t[r-1]+t[r],e=1;e<r;++e)o[e]-=n=i[e]/o[e-1],a[e]-=n*a[e-1];for(i[r-1]=a[r-1]/o[r-1],e=r-2;e>=0;--e)i[e]=(a[e]-i[e+1])/o[e];for(o[r-1]=(t[r]+i[r-1])/2,e=0;e<r-1;++e)o[e]=2*t[e+1]-i[e+1];return[i,o]}bh.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:vh(this,this._t0,yh(this,this._t0))}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){var n=NaN;if(e=+e,(t=+t)!==this._x1||e!==this._y1){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,vh(this,yh(this,n=gh(this,t,e)),n);break;default:vh(this,this._t0,n=gh(this,t,e))}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e,this._t0=n}}},(wh.prototype=Object.create(bh.prototype)).point=function(t,e){bh.prototype.point.call(this,e,t)},xh.prototype={moveTo:function(t,e){this._context.moveTo(e,t)},closePath:function(){this._context.closePath()},lineTo:function(t,e){this._context.lineTo(e,t)},bezierCurveTo:function(t,e,n,r,i,o){this._context.bezierCurveTo(e,t,r,n,o,i)}},kh.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var t=this._x,e=this._y,n=t.length;if(n)if(this._line?this._context.lineTo(t[0],e[0]):this._context.moveTo(t[0],e[0]),2===n)this._context.lineTo(t[1],e[1]);else for(var r=Sh(t),i=Sh(e),o=0,a=1;a<n;++o,++a)this._context.bezierCurveTo(r[0][o],i[0][o],r[1][o],i[1][o],t[a],e[a]);(this._line||0!==this._line&&1===n)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(t,e){this._x.push(+t),this._y.push(+e)}};var Eh=function(t){return new kh(t)};function Oh(t,e){this._context=t,this._t=e}Oh.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&2===this._point&&this._context.lineTo(this._x,this._y),(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:if(this._t<=0)this._context.lineTo(this._x,e),this._context.lineTo(t,e);else{var n=this._x*(1-this._t)+t*this._t;this._context.lineTo(n,this._y),this._context.lineTo(n,e)}}this._x=t,this._y=e}};var Ah=function(t){return new Oh(t,.5)};function Nh(t){return new Oh(t,0)}function Th(t){return new Oh(t,1)}const Dh={basis:{curve:Dc},"basis-closed":{curve:Mc},"basis-open":{curve:Pc},bundle:{curve:zc,tension:"beta",value:.85},cardinal:{curve:Uc,tension:"tension",value:0},"cardinal-open":{curve:Vc,tension:"tension",value:0},"cardinal-closed":{curve:qc,tension:"tension",value:0},"catmull-rom":{curve:ah,tension:"alpha",value:.5},"catmull-rom-closed":{curve:uh,tension:"alpha",value:.5},"catmull-rom-open":{curve:ch,tension:"alpha",value:.5},linear:{curve:dh},"linear-closed":{curve:ph},monotone:{horizontal:Ch,vertical:_h},natural:{curve:Eh},step:{curve:Ah},"step-after":{curve:Th},"step-before":{curve:Nh}};function Rh(t,e,n){var r=On(Dh,t)&&Dh[t],i=null;return r&&(i=r.curve||r[e||"vertical"],r.tension&&null!=n&&(i=i[r.tension](n))),i}const Ih={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7},Mh=[/([MLHVCSQTAZmlhvcsqtaz])/g,/###/,/(\.\d+)(\.\d)/g,/(\d)([-+])/g,/\s|,|###/];var Fh=function(t){let e,n,r,i,o,a,s,u,l,c,h,d=[];for(e=t.slice().replace(Mh[0],"###$1").split(Mh[1]).slice(1),u=0,c=e.length;u<c;++u){for(n=e[u],r=n.slice(1).trim().replace(Mh[2],"$1###$2").replace(Mh[3],"$1###$2").split(Mh[4]),a=n.charAt(0),i=[a],l=0,h=r.length;l<h;++l)(o=+r[l])===o&&i.push(o);if(s=Ih[a.toLowerCase()],i.length-1>s){let t=1,e=i.length;for(d.push([a].concat(i.slice(t,t+=s))),a="M"===a?"L":"m"===a?"l":a;t<e;t+=s)d.push([a].concat(i.slice(t,t+s)))}else d.push(i)}return d};const Ph=Math.PI/180,jh=Math.PI/2,zh=2*Math.PI,Lh=Math.sqrt(3)/2;var Bh={},Uh={},$h=[].join;function Vh(t){var e=$h.call(t);if(Uh[e])return Uh[e];var n=t[0],r=t[1],i=t[2],o=t[3],a=t[4],s=t[5],u=t[6],l=t[7],c=l*a,h=-u*s,d=u*a,f=l*s,p=Math.cos(i),m=Math.sin(i),g=Math.cos(o),y=Math.sin(o),v=.5*(o-i),b=Math.sin(.5*v),w=8/3*b*b/Math.sin(v),x=n+p-w*m,_=r+m+w*p,C=n+g,k=r+y,S=C+w*y,E=k-w*g;return Uh[e]=[c*x+h*_,d*x+f*_,c*S+h*E,d*S+f*E,c*C+h*k,d*C+f*k]}var Wh=["l",0,0,0,0,0,0,0];function qh(t,e,n){var r=Wh[0]=t[0];if("a"===r||"A"===r)Wh[1]=e*t[1],Wh[2]=n*t[2],Wh[3]=t[3],Wh[4]=t[4],Wh[5]=t[5],Wh[6]=e*t[6],Wh[7]=n*t[7];else if("h"===r||"H"===r)Wh[1]=e*t[1];else if("v"===r||"V"===r)Wh[1]=n*t[1];else for(var i=1,o=t.length;i<o;++i)Wh[i]=(i%2==1?e:n)*t[i];return Wh}var Hh=function(t,e,n,r,i,o){var a,s,u,l,c,h=null,d=0,f=0,p=0,m=0;null==n&&(n=0),null==r&&(r=0),null==i&&(i=1),null==o&&(o=i),t.beginPath&&t.beginPath();for(var g=0,y=e.length;g<y;++g){switch(a=e[g],1===i&&1===o||(a=qh(a,i,o)),a[0]){case"l":t.lineTo((d+=a[1])+n,(f+=a[2])+r);break;case"L":t.lineTo((d=a[1])+n,(f=a[2])+r);break;case"h":t.lineTo((d+=a[1])+n,f+r);break;case"H":t.lineTo((d=a[1])+n,f+r);break;case"v":t.lineTo(d+n,(f+=a[1])+r);break;case"V":t.lineTo(d+n,(f=a[1])+r);break;case"m":t.moveTo((d+=a[1])+n,(f+=a[2])+r);break;case"M":t.moveTo((d=a[1])+n,(f=a[2])+r);break;case"c":t.bezierCurveTo(d+a[1]+n,f+a[2]+r,(p=d+a[3])+n,(m=f+a[4])+r,(s=d+a[5])+n,(u=f+a[6])+r),d=s,f=u;break;case"C":t.bezierCurveTo(a[1]+n,a[2]+r,(p=a[3])+n,(m=a[4])+r,(d=a[5])+n,(f=a[6])+r);break;case"s":t.bezierCurveTo((p=2*d-p)+n,(m=2*f-m)+r,d+a[1]+n,f+a[2]+r,(s=d+a[3])+n,(u=f+a[4])+r),p=d+a[1],m=f+a[2],d=s,f=u;break;case"S":t.bezierCurveTo((p=2*d-p)+n,(m=2*f-m)+r,a[1]+n,a[2]+r,(s=a[3])+n,(u=a[4])+r),d=s,f=u,p=a[1],m=a[2];break;case"q":t.quadraticCurveTo((p=d+a[1])+n,(m=f+a[2])+r,(s=d+a[3])+n,(u=f+a[4])+r),d=s,f=u;break;case"Q":t.quadraticCurveTo(a[1]+n,a[2]+r,(s=a[3])+n,(u=a[4])+r),d=s,f=u,p=a[1],m=a[2];break;case"t":s=d+a[1],u=f+a[2],null===h[0].match(/[QqTt]/)?(p=d,m=f):"t"===h[0]?(p=2*d-l,m=2*f-c):"q"===h[0]&&(p=2*d-p,m=2*f-m),l=p,c=m,t.quadraticCurveTo(p+n,m+r,s+n,u+r),p=(d=s)+a[1],m=(f=u)+a[2];break;case"T":t.quadraticCurveTo((p=2*d-p)+n,(m=2*f-m)+r,(s=a[1])+n,(u=a[2])+r),d=s,f=u;break;case"a":Gh(t,d+n,f+r,[a[1],a[2],a[3],a[4],a[5],a[6]+d+n,a[7]+f+r]),d+=a[6],f+=a[7];break;case"A":Gh(t,d+n,f+r,[a[1],a[2],a[3],a[4],a[5],a[6]+n,a[7]+r]),d=a[6],f=a[7];break;case"z":case"Z":t.closePath()}h=a}};function Gh(t,e,n,r){for(var i=function(t,e,n,r,i,o,a,s,u){var l=$h.call(arguments);if(Bh[l])return Bh[l];var c=a*Ph,h=Math.sin(c),d=Math.cos(c),f=d*(s-t)*.5+h*(u-e)*.5,p=d*(u-e)*.5-h*(s-t)*.5,m=f*f/((n=Math.abs(n))*n)+p*p/((r=Math.abs(r))*r);m>1&&(n*=m=Math.sqrt(m),r*=m);var g=d/n,y=h/n,v=-h/r,b=d/r,w=g*s+y*u,x=v*s+b*u,_=g*t+y*e,C=v*t+b*e,k=(_-w)*(_-w)+(C-x)*(C-x),S=1/k-.25;S<0&&(S=0);var E=Math.sqrt(S);o==i&&(E=-E);var O=.5*(w+_)-E*(C-x),A=.5*(x+C)+E*(_-w),N=Math.atan2(x-A,w-O),T=Math.atan2(C-A,_-O),D=T-N;D<0&&1===o?D+=zh:D>0&&0===o&&(D-=zh);for(var R=Math.ceil(Math.abs(D/(jh+.001))),I=[],M=0;M<R;++M){var F=N+M*D/R,P=N+(M+1)*D/R;I[M]=[O,A,F,P,n,r,h,d]}return Bh[l]=I}(r[5],r[6],r[0],r[1],r[3],r[4],r[2],e,n),o=0;o<i.length;++o){var a=Vh(i[o]);t.bezierCurveTo(a[0],a[1],a[2],a[3],a[4],a[5])}}var Xh=.5773502691896257,Kh={circle:{draw:function(t,e){var n=Math.sqrt(e)/2;t.moveTo(n,0),t.arc(0,0,n,0,zh)}},cross:{draw:function(t,e){var n=Math.sqrt(e)/2,r=n/2.5;t.moveTo(-n,-r),t.lineTo(-n,r),t.lineTo(-r,r),t.lineTo(-r,n),t.lineTo(r,n),t.lineTo(r,r),t.lineTo(n,r),t.lineTo(n,-r),t.lineTo(r,-r),t.lineTo(r,-n),t.lineTo(-r,-n),t.lineTo(-r,-r),t.closePath()}},diamond:{draw:function(t,e){var n=Math.sqrt(e)/2;t.moveTo(-n,0),t.lineTo(0,-n),t.lineTo(n,0),t.lineTo(0,n),t.closePath()}},square:{draw:function(t,e){var n=Math.sqrt(e),r=-n/2;t.rect(r,r,n,n)}},arrow:{draw:function(t,e){var n=Math.sqrt(e)/2,r=n/7,i=n/2.5,o=n/8;t.moveTo(-r,n),t.lineTo(r,n),t.lineTo(r,-o),t.lineTo(i,-o),t.lineTo(0,-n),t.lineTo(-i,-o),t.lineTo(-r,-o),t.closePath()}},wedge:{draw:function(t,e){var n=Math.sqrt(e)/2,r=Lh*n,i=r-n*Xh,o=n/4;t.moveTo(0,-r-i),t.lineTo(-o,r-i),t.lineTo(o,r-i),t.closePath()}},triangle:{draw:function(t,e){var n=Math.sqrt(e)/2,r=Lh*n,i=r-n*Xh;t.moveTo(0,-r-i),t.lineTo(-n,r-i),t.lineTo(n,r-i),t.closePath()}},"triangle-up":{draw:function(t,e){var n=Math.sqrt(e)/2,r=Lh*n;t.moveTo(0,-r),t.lineTo(-n,r),t.lineTo(n,r),t.closePath()}},"triangle-down":{draw:function(t,e){var n=Math.sqrt(e)/2,r=Lh*n;t.moveTo(0,r),t.lineTo(-n,-r),t.lineTo(n,-r),t.closePath()}},"triangle-right":{draw:function(t,e){var n=Math.sqrt(e)/2,r=Lh*n;t.moveTo(r,0),t.lineTo(-r,-n),t.lineTo(-r,n),t.closePath()}},"triangle-left":{draw:function(t,e){var n=Math.sqrt(e)/2,r=Lh*n;t.moveTo(-r,0),t.lineTo(r,-n),t.lineTo(r,n),t.closePath()}},stroke:{draw:function(t,e){var n=Math.sqrt(e)/2;t.moveTo(-n,0),t.lineTo(n,0)}}},Yh={},Zh=Math.PI,Qh=2*Zh,Jh=Qh-1e-6;function td(){this._x0=this._y0=this._x1=this._y1=null,this._=""}function ed(){return new td}td.prototype=ed.prototype={constructor:td,moveTo:function(t,e){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+e)},closePath:function(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")},lineTo:function(t,e){this._+="L"+(this._x1=+t)+","+(this._y1=+e)},quadraticCurveTo:function(t,e,n,r){this._+="Q"+ +t+","+ +e+","+(this._x1=+n)+","+(this._y1=+r)},bezierCurveTo:function(t,e,n,r,i,o){this._+="C"+ +t+","+ +e+","+ +n+","+ +r+","+(this._x1=+i)+","+(this._y1=+o)},arcTo:function(t,e,n,r,i){var o=this._x1,a=this._y1,s=(n=+n)-(t=+t),u=(r=+r)-(e=+e),l=o-t,c=a-e,h=l*l+c*c;if((i=+i)<0)throw new Error("negative radius: "+i);if(null===this._x1)this._+="M"+(this._x1=t)+","+(this._y1=e);else if(h>1e-6)if(Math.abs(c*s-u*l)>1e-6&&i){var d=n-o,f=r-a,p=s*s+u*u,m=d*d+f*f,g=Math.sqrt(p),y=Math.sqrt(h),v=i*Math.tan((Zh-Math.acos((p+h-m)/(2*g*y)))/2),b=v/y,w=v/g;Math.abs(b-1)>1e-6&&(this._+="L"+(t+b*l)+","+(e+b*c)),this._+="A"+i+","+i+",0,0,"+ +(c*d>l*f)+","+(this._x1=t+w*s)+","+(this._y1=e+w*u)}else this._+="L"+(this._x1=t)+","+(this._y1=e)},arc:function(t,e,n,r,i,o){t=+t,e=+e,o=!!o;var a=(n=+n)*Math.cos(r),s=n*Math.sin(r),u=t+a,l=e+s,c=1^o,h=o?r-i:i-r;if(n<0)throw new Error("negative radius: "+n);null===this._x1?this._+="M"+u+","+l:(Math.abs(this._x1-u)>1e-6||Math.abs(this._y1-l)>1e-6)&&(this._+="L"+u+","+l),n&&(h<0&&(h=h%Qh+Qh),h>Jh?this._+="A"+n+","+n+",0,1,"+c+","+(t-a)+","+(e-s)+"A"+n+","+n+",0,1,"+c+","+(this._x1=u)+","+(this._y1=l):h>1e-6&&(this._+="A"+n+","+n+",0,"+ +(h>=Zh)+","+c+","+(this._x1=t+n*Math.cos(i))+","+(this._y1=e+n*Math.sin(i))))},rect:function(t,e,n,r){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+e)+"h"+ +n+"v"+ +r+"h"+-n+"Z"},toString:function(){return this._}};var nd=ed;const rd=.448084975506;function id(t){return t.x}function od(t){return t.y}function ad(t){return t.width}function sd(t){return t.height}function ud(t){return"function"==typeof t?t:()=>+t}function ld(t,e,n){return Math.max(e,Math.min(t,n))}var cd=function(t){return function(){return t}};function hd(t){return t.innerRadius}function dd(t){return t.outerRadius}function fd(t){return t.startAngle}function pd(t){return t.endAngle}function md(t){return t&&t.padAngle}function gd(t,e,n,r,i,o,a,s){var u=n-t,l=r-e,c=a-i,h=s-o,d=h*u-c*l;if(!(d*d<1e-12))return[t+(d=(c*(e-o)-h*(t-i))/d)*u,e+d*l]}function yd(t,e,n,r,i,o,a){var s=t-n,u=e-r,l=(a?o:-o)/Qc(s*s+u*u),c=l*u,h=-l*s,d=t+c,f=e+h,p=n+c,m=r+h,g=(d+p)/2,y=(f+m)/2,v=p-d,b=m-f,w=v*v+b*b,x=i-o,_=d*m-p*f,C=(b<0?-1:1)*Qc(Kc(0,x*x*w-_*_)),k=(_*b-v*C)/w,S=(-_*v-b*C)/w,E=(_*b+v*C)/w,O=(-_*v+b*C)/w,A=k-g,N=S-y,T=E-g,D=O-y;return A*A+N*N>T*T+D*D&&(k=E,S=O),{cx:k,cy:S,x01:-c,y01:-h,x11:k*(i/x-1),y11:S*(i/x-1)}}var vd=function(){var t=hd,e=dd,n=cd(0),r=null,i=fd,o=pd,a=md,s=null;function u(){var u,l,c=+t.apply(this,arguments),h=+e.apply(this,arguments),d=i.apply(this,arguments)-th,f=o.apply(this,arguments)-th,p=Hc(f-d),m=f>d;if(s||(s=u=nd()),h<c&&(l=h,h=c,c=l),h>1e-12)if(p>eh-1e-12)s.moveTo(h*Xc(d),h*Zc(d)),s.arc(0,0,h,d,f,!m),c>1e-12&&(s.moveTo(c*Xc(f),c*Zc(f)),s.arc(0,0,c,f,d,m));else{var g,y,v=d,b=f,w=d,x=f,_=p,C=p,k=a.apply(this,arguments)/2,S=k>1e-12&&(r?+r.apply(this,arguments):Qc(c*c+h*h)),E=Yc(Hc(h-c)/2,+n.apply(this,arguments)),O=E,A=E;if(S>1e-12){var N=rh(S/c*Zc(k)),T=rh(S/h*Zc(k));(_-=2*N)>1e-12?(w+=N*=m?1:-1,x-=N):(_=0,w=x=(d+f)/2),(C-=2*T)>1e-12?(v+=T*=m?1:-1,b-=T):(C=0,v=b=(d+f)/2)}var D=h*Xc(v),R=h*Zc(v),I=c*Xc(x),M=c*Zc(x);if(E>1e-12){var F,P=h*Xc(b),j=h*Zc(b),z=c*Xc(w),L=c*Zc(w);if(p<Jc&&(F=gd(D,R,z,L,P,j,I,M))){var B=D-F[0],U=R-F[1],$=P-F[0],V=j-F[1],W=1/Zc(nh((B*$+U*V)/(Qc(B*B+U*U)*Qc($*$+V*V)))/2),q=Qc(F[0]*F[0]+F[1]*F[1]);O=Yc(E,(c-q)/(W-1)),A=Yc(E,(h-q)/(W+1))}}C>1e-12?A>1e-12?(g=yd(z,L,D,R,h,A,m),y=yd(P,j,I,M,h,A,m),s.moveTo(g.cx+g.x01,g.cy+g.y01),A<E?s.arc(g.cx,g.cy,A,Gc(g.y01,g.x01),Gc(y.y01,y.x01),!m):(s.arc(g.cx,g.cy,A,Gc(g.y01,g.x01),Gc(g.y11,g.x11),!m),s.arc(0,0,h,Gc(g.cy+g.y11,g.cx+g.x11),Gc(y.cy+y.y11,y.cx+y.x11),!m),s.arc(y.cx,y.cy,A,Gc(y.y11,y.x11),Gc(y.y01,y.x01),!m))):(s.moveTo(D,R),s.arc(0,0,h,v,b,!m)):s.moveTo(D,R),c>1e-12&&_>1e-12?O>1e-12?(g=yd(I,M,P,j,c,-O,m),y=yd(D,R,z,L,c,-O,m),s.lineTo(g.cx+g.x01,g.cy+g.y01),O<E?s.arc(g.cx,g.cy,O,Gc(g.y01,g.x01),Gc(y.y01,y.x01),!m):(s.arc(g.cx,g.cy,O,Gc(g.y01,g.x01),Gc(g.y11,g.x11),!m),s.arc(0,0,c,Gc(g.cy+g.y11,g.cx+g.x11),Gc(y.cy+y.y11,y.cx+y.x11),m),s.arc(y.cx,y.cy,O,Gc(y.y11,y.x11),Gc(y.y01,y.x01),!m))):s.arc(0,0,c,x,w,m):s.lineTo(I,M)}else s.moveTo(0,0);if(s.closePath(),u)return s=null,u+""||null}return u.centroid=function(){var n=(+t.apply(this,arguments)+ +e.apply(this,arguments))/2,r=(+i.apply(this,arguments)+ +o.apply(this,arguments))/2-Jc/2;return[Xc(r)*n,Zc(r)*n]},u.innerRadius=function(e){return arguments.length?(t="function"==typeof e?e:cd(+e),u):t},u.outerRadius=function(t){return arguments.length?(e="function"==typeof t?t:cd(+t),u):e},u.cornerRadius=function(t){return arguments.length?(n="function"==typeof t?t:cd(+t),u):n},u.padRadius=function(t){return arguments.length?(r=null==t?null:"function"==typeof t?t:cd(+t),u):r},u.startAngle=function(t){return arguments.length?(i="function"==typeof t?t:cd(+t),u):i},u.endAngle=function(t){return arguments.length?(o="function"==typeof t?t:cd(+t),u):o},u.padAngle=function(t){return arguments.length?(a="function"==typeof t?t:cd(+t),u):a},u.context=function(t){return arguments.length?(s=null==t?null:t,u):s},u};function bd(t){return t[0]}function wd(t){return t[1]}var xd=function(){var t=bd,e=wd,n=cd(!0),r=null,i=dh,o=null;function a(a){var s,u,l,c=a.length,h=!1;for(null==r&&(o=i(l=nd())),s=0;s<=c;++s)!(s<c&&n(u=a[s],s,a))===h&&((h=!h)?o.lineStart():o.lineEnd()),h&&o.point(+t(u,s,a),+e(u,s,a));if(l)return o=null,l+""||null}return a.x=function(e){return arguments.length?(t="function"==typeof e?e:cd(+e),a):t},a.y=function(t){return arguments.length?(e="function"==typeof t?t:cd(+t),a):e},a.defined=function(t){return arguments.length?(n="function"==typeof t?t:cd(!!t),a):n},a.curve=function(t){return arguments.length?(i=t,null!=r&&(o=i(r)),a):i},a.context=function(t){return arguments.length?(null==t?r=o=null:o=i(r=t),a):r},a},_d=function(){var t=bd,e=null,n=cd(0),r=wd,i=cd(!0),o=null,a=dh,s=null;function u(u){var l,c,h,d,f,p=u.length,m=!1,g=new Array(p),y=new Array(p);for(null==o&&(s=a(f=nd())),l=0;l<=p;++l){if(!(l<p&&i(d=u[l],l,u))===m)if(m=!m)c=l,s.areaStart(),s.lineStart();else{for(s.lineEnd(),s.lineStart(),h=l-1;h>=c;--h)s.point(g[h],y[h]);s.lineEnd(),s.areaEnd()}m&&(g[l]=+t(d,l,u),y[l]=+n(d,l,u),s.point(e?+e(d,l,u):g[l],r?+r(d,l,u):y[l]))}if(f)return s=null,f+""||null}function l(){return xd().defined(i).curve(a).context(o)}return u.x=function(n){return arguments.length?(t="function"==typeof n?n:cd(+n),e=null,u):t},u.x0=function(e){return arguments.length?(t="function"==typeof e?e:cd(+e),u):t},u.x1=function(t){return arguments.length?(e=null==t?null:"function"==typeof t?t:cd(+t),u):e},u.y=function(t){return arguments.length?(n="function"==typeof t?t:cd(+t),r=null,u):n},u.y0=function(t){return arguments.length?(n="function"==typeof t?t:cd(+t),u):n},u.y1=function(t){return arguments.length?(r=null==t?null:"function"==typeof t?t:cd(+t),u):r},u.lineX0=u.lineY0=function(){return l().x(t).y(n)},u.lineY1=function(){return l().x(t).y(r)},u.lineX1=function(){return l().x(e).y(n)},u.defined=function(t){return arguments.length?(i="function"==typeof t?t:cd(!!t),u):i},u.curve=function(t){return arguments.length?(a=t,null!=o&&(s=a(o)),u):a},u.context=function(t){return arguments.length?(null==t?o=s=null:s=a(o=t),u):o},u},Cd={draw:function(t,e){var n=Math.sqrt(e/Jc);t.moveTo(n,0),t.arc(0,0,n,0,eh)}},kd=(Math.sqrt(1/3),Math.sin(Jc/10),Math.sin(7*Jc/10),Math.sin(eh/10),Math.cos(eh/10),Math.sqrt(3),Math.sqrt(3),Math.sqrt(12),function(){var t=cd(Cd),e=cd(64),n=null;function r(){var r;if(n||(n=r=nd()),t.apply(this,arguments).draw(n,+e.apply(this,arguments)),r)return n=null,r+""||null}return r.type=function(e){return arguments.length?(t="function"==typeof e?e:cd(e),r):t},r.size=function(t){return arguments.length?(e="function"==typeof t?t:cd(+t),r):e},r.context=function(t){return arguments.length?(n=null==t?null:t,r):n},r});function Sd(t,e){return null!=t?t:e}const Ed=t=>t.x||0,Od=t=>t.y||0,Ad=t=>!(!1===t.defined),Nd=vd().startAngle(t=>t.startAngle||0).endAngle(t=>t.endAngle||0).padAngle(t=>t.padAngle||0).innerRadius(t=>t.innerRadius||0).outerRadius(t=>t.outerRadius||0).cornerRadius(t=>t.cornerRadius||0),Td=_d().x(Ed).y1(Od).y0(t=>(t.y||0)+(t.height||0)).defined(Ad),Dd=_d().y(Od).x1(Ed).x0(t=>(t.x||0)+(t.width||0)).defined(Ad),Rd=xd().x(Ed).y(Od).defined(Ad),Id=function(){var t=id,e=od,n=ad,r=sd,i=ud(0),o=i,a=i,s=i,u=null;function l(l,c,h){var d,f=null!=c?c:+t.call(this,l),p=null!=h?h:+e.call(this,l),m=+n.call(this,l),g=+r.call(this,l),y=Math.min(m,g)/2,v=ld(+i.call(this,l),0,y),b=ld(+o.call(this,l),0,y),w=ld(+a.call(this,l),0,y),x=ld(+s.call(this,l),0,y);if(u||(u=d=nd()),v<=0&&b<=0&&w<=0&&x<=0)u.rect(f,p,m,g);else{var _=f+m,C=p+g;u.moveTo(f+v,p),u.lineTo(_-b,p),u.bezierCurveTo(_-rd*b,p,_,p+rd*b,_,p+b),u.lineTo(_,C-x),u.bezierCurveTo(_,C-rd*x,_-rd*x,C,_-x,C),u.lineTo(f+w,C),u.bezierCurveTo(f+rd*w,C,f,C-rd*w,f,C-w),u.lineTo(f,p+v),u.bezierCurveTo(f,p+rd*v,f+rd*v,p,f+v,p),u.closePath()}if(d)return u=null,d+""||null}return l.x=function(e){return arguments.length?(t=ud(e),l):t},l.y=function(t){return arguments.length?(e=ud(t),l):e},l.width=function(t){return arguments.length?(n=ud(t),l):n},l.height=function(t){return arguments.length?(r=ud(t),l):r},l.cornerRadius=function(t,e,n,r){return arguments.length?(i=ud(t),o=null!=e?ud(e):i,s=null!=n?ud(n):i,a=null!=r?ud(r):o,l):i},l.context=function(t){return arguments.length?(u=null==t?null:t,l):u},l}().x(Ed).y(Od).width(t=>t.width||0).height(t=>t.height||0).cornerRadius(t=>Sd(t.cornerRadiusTopLeft,t.cornerRadius)||0,t=>Sd(t.cornerRadiusTopRight,t.cornerRadius)||0,t=>Sd(t.cornerRadiusBottomRight,t.cornerRadius)||0,t=>Sd(t.cornerRadiusBottomLeft,t.cornerRadius)||0),Md=kd().type(t=>{return On(Kh,e=t.shape||"circle")?Kh[e]:function(t){if(!On(Yh,t)){var e=Fh(t);Yh[t]={draw:function(t,n){Hh(t,e,0,0,Math.sqrt(n)/2)}}}return Yh[t]}(e);var e}).size(t=>Sd(t.size,64)),Fd=function(){var t,e,n,r,i,o,a,s,u=null;function l(t,e,n){var r=n/2;if(i){var l=a-e,c=t-o;if(l||c){var h=Math.sqrt(l*l+c*c),d=(l/=h)*s,f=(c/=h)*s,p=Math.atan2(c,l);u.moveTo(o-d,a-f),u.lineTo(t-l*r,e-c*r),u.arc(t,e,r,p-Math.PI,p),u.lineTo(o+d,a+f),u.arc(o,a,s,p,p+Math.PI)}else u.arc(t,e,r,0,zh);u.closePath()}else i=1;o=t,a=e,s=r}function c(o){var a,s,c,h=o.length,d=!1;for(null==u&&(u=c=nd()),a=0;a<=h;++a)!(a<h&&r(s=o[a],a,o))===d&&(d=!d)&&(i=0),d&&l(+t(s,a,o),+e(s,a,o),+n(s,a,o));if(c)return u=null,c+""||null}return c.x=function(e){return arguments.length?(t=e,c):t},c.y=function(t){return arguments.length?(e=t,c):e},c.size=function(t){return arguments.length?(n=t,c):n},c.defined=function(t){return arguments.length?(r=t,c):r},c.context=function(t){return arguments.length?(u=null==t?null:t,c):u},c}().x(Ed).y(Od).defined(Ad).size(t=>t.size||1);function Pd(t){return t.cornerRadius||t.cornerRadiusTopLeft||t.cornerRadiusTopRight||t.cornerRadiusBottomRight||t.cornerRadiusBottomLeft}function jd(t,e,n,r){return Id.context(t)(e,n,r)}var zd=1,Ld=function(t,e,n){var r=e.clip,i=t._defs,o=e.clip_id||(e.clip_id="clip"+zd++),a=i.clipping[o]||(i.clipping[o]={id:o});return gn(r)?a.path=r(null):Pd(n)?a.path=jd(null,n,0,0):(a.width=n.width||0,a.height=n.height||0),"url(#"+o+")"};function Bd(t){this.clear(),t&&this.union(t)}function Ud(t){this.mark=t,this.bounds=this.bounds||new Bd}function $d(t){Ud.call(this,t),this.items=this.items||[]}function Vd(t,e){if("undefined"!=typeof document&&document.createElement){const n=document.createElement("canvas");if(n&&n.getContext)return n.width=t,n.height=e,n}return null}Bd.prototype={clone(){return new Bd(this)},clear(){return this.x1=+Number.MAX_VALUE,this.y1=+Number.MAX_VALUE,this.x2=-Number.MAX_VALUE,this.y2=-Number.MAX_VALUE,this},empty(){return this.x1===+Number.MAX_VALUE&&this.y1===+Number.MAX_VALUE&&this.x2===-Number.MAX_VALUE&&this.y2===-Number.MAX_VALUE},equals(t){return this.x1===t.x1&&this.y1===t.y1&&this.x2===t.x2&&this.y2===t.y2},set(t,e,n,r){return n<t?(this.x2=t,this.x1=n):(this.x1=t,this.x2=n),r<e?(this.y2=e,this.y1=r):(this.y1=e,this.y2=r),this},add(t,e){return t<this.x1&&(this.x1=t),e<this.y1&&(this.y1=e),t>this.x2&&(this.x2=t),e>this.y2&&(this.y2=e),this},expand(t){return this.x1-=t,this.y1-=t,this.x2+=t,this.y2+=t,this},round(){return this.x1=Math.floor(this.x1),this.y1=Math.floor(this.y1),this.x2=Math.ceil(this.x2),this.y2=Math.ceil(this.y2),this},scale(t){return this.x1*=t,this.y1*=t,this.x2*=t,this.y2*=t,this},translate(t,e){return this.x1+=t,this.x2+=t,this.y1+=e,this.y2+=e,this},rotate(t,e,n){const r=this.rotatedPoints(t,e,n);return this.clear().add(r[0],r[1]).add(r[2],r[3]).add(r[4],r[5]).add(r[6],r[7])},rotatedPoints(t,e,n){var{x1:r,y1:i,x2:o,y2:a}=this,s=Math.cos(t),u=Math.sin(t),l=e-e*s+n*u,c=n-e*u-n*s;return[s*r-u*i+l,u*r+s*i+c,s*r-u*a+l,u*r+s*a+c,s*o-u*i+l,u*o+s*i+c,s*o-u*a+l,u*o+s*a+c]},union(t){return t.x1<this.x1&&(this.x1=t.x1),t.y1<this.y1&&(this.y1=t.y1),t.x2>this.x2&&(this.x2=t.x2),t.y2>this.y2&&(this.y2=t.y2),this},intersect(t){return t.x1>this.x1&&(this.x1=t.x1),t.y1>this.y1&&(this.y1=t.y1),t.x2<this.x2&&(this.x2=t.x2),t.y2<this.y2&&(this.y2=t.y2),this},encloses(t){return t&&this.x1<=t.x1&&this.x2>=t.x2&&this.y1<=t.y1&&this.y2>=t.y2},alignsWith(t){return t&&(this.x1==t.x1||this.x2==t.x2||this.y1==t.y1||this.y2==t.y2)},intersects(t){return t&&!(this.x2<t.x1||this.x1>t.x2||this.y2<t.y1||this.y1>t.y2)},contains(t,e){return!(t<this.x1||t>this.x2||e<this.y1||e>this.y2)},width(){return this.x2-this.x1},height(){return this.y2-this.y1}},Tn($d,Ud);const Wd=()=>"undefined"!=typeof Image?Image:null;function qd(t){this._pending=0,this._loader=t||Ds()}function Hd(t){t._pending+=1}function Gd(t){t._pending-=1}qd.prototype={pending(){return this._pending},sanitizeURL(t){var e=this;return Hd(e),e._loader.sanitize(t,{context:"href"}).then((function(t){return Gd(e),t})).catch((function(){return Gd(e),null}))},loadImage(t){const e=this,n=Wd();return Hd(e),e._loader.sanitize(t,{context:"image"}).then((function(t){const r=t.href;if(!r||!n)throw{url:r};const i=new n,o=On(t,"crossOrigin")?t.crossOrigin:"anonymous";return null!=o&&(i.crossOrigin=o),i.onload=()=>Gd(e),i.onerror=()=>Gd(e),i.src=r,i})).catch((function(t){return Gd(e),{complete:!1,width:0,height:0,src:t&&t.url||""}}))},ready(){var t=this;return new Promise((function(e){!function n(r){t.pending()?setTimeout((function(){n(!0)}),10):e(r)}(!1)}))}};var Xd=function(t,e,n){if(e.stroke&&0!==e.opacity&&0!==e.strokeOpacity){const r=null!=e.strokeWidth?+e.strokeWidth:1;t.expand(r+(n?function(t,e){return t.strokeJoin&&"miter"!==t.strokeJoin?0:e}(e,r):0))}return t};const Kd=zh-1e-8;let Yd,Zd,Qd,Jd,tf,ef,nf,rf;const of=(t,e)=>Yd.add(t,e),af=(t,e)=>of(Zd=t,Qd=e),sf=t=>of(t,Yd.y1),uf=t=>of(Yd.x1,t),lf=(t,e)=>tf*t+nf*e,cf=(t,e)=>ef*t+rf*e,hf=(t,e)=>of(lf(t,e),cf(t,e)),df=(t,e)=>af(lf(t,e),cf(t,e));var ff=function(t,e){return Yd=t,e?(Jd=e*Ph,tf=rf=Math.cos(Jd),ef=Math.sin(Jd),nf=-ef):(tf=rf=1,Jd=ef=nf=0),pf};const pf={beginPath(){},closePath(){},moveTo:df,lineTo:df,rect(t,e,n,r){Jd?(hf(t+n,e),hf(t+n,e+r),hf(t,e+r),df(t,e)):(of(t+n,e+r),af(t,e))},quadraticCurveTo(t,e,n,r){const i=lf(t,e),o=cf(t,e),a=lf(n,r),s=cf(n,r);mf(Zd,i,a,sf),mf(Qd,o,s,uf),af(a,s)},bezierCurveTo(t,e,n,r,i,o){const a=lf(t,e),s=cf(t,e),u=lf(n,r),l=cf(n,r),c=lf(i,o),h=cf(i,o);gf(Zd,a,u,c,sf),gf(Qd,s,l,h,uf),af(c,h)},arc(t,e,n,r,i,o){if(r+=Jd,i+=Jd,Zd=n*Math.cos(i)+t,Qd=n*Math.sin(i)+e,Math.abs(i-r)>Kd)of(t-n,e-n),of(t+n,e+n);else{const a=r=>of(n*Math.cos(r)+t,n*Math.sin(r)+e);let s,u;if(a(r),a(i),i!==r)if((r%=zh)<0&&(r+=zh),(i%=zh)<0&&(i+=zh),i<r&&(o=!o,s=r,r=i,i=s),o)for(i-=zh,s=r-r%jh,u=0;u<4&&s>i;++u,s-=jh)a(s);else for(s=r-r%jh+jh,u=0;u<4&&s<i;++u,s+=jh)a(s)}}};function mf(t,e,n,r){const i=(t-e)/(t+n-2*e);0<i&&i<1&&r(t+(e-t)*i)}function gf(t,e,n,r,i){const o=r-t+3*e-3*n,a=t+n-2*e,s=t-e;let u,l=0,c=0;Math.abs(o)>1e-14?(u=a*a+s*o,u>=0&&(u=Math.sqrt(u),l=(-a+u)/o,c=(-a-u)/o)):l=.5*s/a,0<l&&l<1&&i(yf(l,t,e,n,r)),0<c&&c<1&&i(yf(c,t,e,n,r))}function yf(t,e,n,r,i){const o=1-t,a=o*o,s=t*t;return a*o*e+3*a*t*n+3*o*s*r+s*t*i}var vf=(vf=Vd(1,1))?vf.getContext("2d"):null;const bf=new Bd;function wf(t){return function(e,n){if(!vf)return!0;t(vf,e),bf.clear().union(e.bounds).intersect(n).round();const{x1:r,y1:i,x2:o,y2:a}=bf;for(let t=i;t<=a;++t)for(let e=r;e<=o;++e)if(vf.isPointInPath(e,t))return!0;return!1}}function xf(t,e){return e.contains(t.x||0,t.y||0)}function _f(t,e){const n=t.x||0,r=t.y||0;return e.intersects(bf.set(n,r,n+(t.width||0),r+(t.height||0)))}function Cf(t,e,n,r,i){const{x1:o,y1:a,x2:s,y2:u}=t,l=r-e,c=i-n;let h,d,f,p,m=0,g=1;for(p=0;p<4;++p){if(0===p&&(h=-l,d=-(o-e)),1===p&&(h=l,d=s-e),2===p&&(h=-c,d=-(a-n)),3===p&&(h=c,d=u-n),Math.abs(h)<1e-10&&d<0)return!1;if(f=d/h,h<0){if(f>g)return!1;f>m&&(m=f)}else if(h>0){if(f<m)return!1;f<g&&(g=f)}}return!0}var kf=function(t,e){t.globalCompositeOperation=e.blend||"source-over"},Sf=function(t,e){return null==t?e:t};function Ef(t,e){const n=e.length;for(let r=0;r<n;++r)t.addColorStop(e[r].offset,e[r].color);return t}var Of=function(t,e,n){return Ec(n)?function(t,e,n){const r=n.width(),i=n.height();let o;if("radial"===e.gradient)o=t.createRadialGradient(n.x1+Sf(e.x1,.5)*r,n.y1+Sf(e.y1,.5)*i,Math.max(r,i)*Sf(e.r1,0),n.x1+Sf(e.x2,.5)*r,n.y1+Sf(e.y2,.5)*i,Math.max(r,i)*Sf(e.r2,.5));else{const a=Sf(e.x1,0),s=Sf(e.y1,0),u=Sf(e.x2,1),l=Sf(e.y2,0);if(a!==u&&s!==l&&r!==i){const n=Vd(Math.ceil(r),Math.ceil(i)),o=n.getContext("2d");return o.scale(r,i),o.fillStyle=Ef(o.createLinearGradient(a,s,u,l),e.stops),o.fillRect(0,0,r,i),t.createPattern(n,"no-repeat")}o=t.createLinearGradient(n.x1+a*r,n.y1+s*i,n.x1+u*r,n.y1+l*i)}return Ef(o,e.stops)}(t,n,e.bounds):n},Af=function(t,e,n){return(n*=null==e.fillOpacity?1:e.fillOpacity)>0&&(t.globalAlpha=n,t.fillStyle=Of(t,e,e.fill),!0)},Nf=[],Tf=function(t,e,n){var r=null!=(r=e.strokeWidth)?r:1;return!(r<=0)&&(n*=null==e.strokeOpacity?1:e.strokeOpacity)>0&&(t.globalAlpha=n,t.strokeStyle=Of(t,e,e.stroke),t.lineWidth=r,t.lineCap=e.strokeCap||"butt",t.lineJoin=e.strokeJoin||"miter",t.miterLimit=e.strokeMiterLimit||10,t.setLineDash&&(t.setLineDash(e.strokeDash||Nf),t.lineDashOffset=e.strokeDashOffset||0),!0)};function Df(t,e){return t.zindex-e.zindex||t.index-e.index}function Rf(t){if(!t.zdirty)return t.zitems;var e,n,r,i=t.items,o=[];for(n=0,r=i.length;n<r;++n)(e=i[n]).index=n,e.zindex&&o.push(e);return t.zdirty=!1,t.zitems=o.sort(Df)}function If(t,e){var n,r,i=t.items;if(i&&i.length){var o=Rf(t);if(o&&o.length){for(n=0,r=i.length;n<r;++n)i[n].zindex||e(i[n]);i=o}for(n=0,r=i.length;n<r;++n)e(i[n])}}function Mf(t,e){var n,r,i=t.items;if(!i||!i.length)return null;var o=Rf(t);for(o&&o.length&&(i=o),r=i.length;--r>=0;)if(n=e(i[r]))return n;if(i===o)for(r=(i=t.items).length;--r>=0;)if(!i[r].zindex&&(n=e(i[r])))return n;return null}function Ff(t){return function(e,n,r){If(n,(function(n){r&&!r.intersects(n.bounds)||Pf(t,e,n,n)}))}}function Pf(t,e,n,r){var i=null==n.opacity?1:n.opacity;0!==i&&(t(e,r)||(kf(e,n),n.fill&&Af(e,n,i)&&e.fill(),n.stroke&&Tf(e,n,i)&&e.stroke()))}function jf(t){return t=t||Ge,function(e,n,r,i,o,a){return r*=e.pixelRatio,i*=e.pixelRatio,Mf(n,(function(n){var s=n.bounds;if((!s||s.contains(o,a))&&s)return t(e,n,r,i,o,a)?n:void 0}))}}function zf(t,e){return function(n,r,i,o){var a,s,u=Array.isArray(r)?r[0]:r,l=null==e?u.fill:e,c=u.stroke&&n.isPointInStroke;return c&&(s=u.strokeCap,n.lineWidth=null!=(a=u.strokeWidth)?a:1,n.lineCap=null!=s?s:"butt"),!t(n,r)&&(l&&n.isPointInPath(i,o)||c&&n.isPointInStroke(i,o))}}function Lf(t){return jf(zf(t))}function Bf(t,e){return"translate("+t+","+e+")"}function Uf(t){return"rotate("+t+")"}function $f(t){return Bf(t.x||0,t.y||0)}var Vf=function(t,e,n){function r(t,n){var r=n.x||0,i=n.y||0,o=n.angle||0;t.translate(r,i),o&&t.rotate(o*=Ph),t.beginPath(),e(t,n),o&&t.rotate(-o),t.translate(-r,-i)}return{type:t,tag:"path",nested:!1,attr:function(t,n){t("transform",function(t){return Bf(t.x||0,t.y||0)+(t.angle?" "+Uf(t.angle):"")}(n)),t("d",e(null,n))},bound:function(t,n){return e(ff(t,n.angle),n),Xd(t,n).translate(n.x||0,n.y||0)},draw:Ff(r),pick:Lf(r),isect:n||wf(r)}},Wf=Vf("arc",(function(t,e){return Nd.context(t)(e)})),qf=function(t,e,n){function r(t,n){t.beginPath(),e(t,n)}var i,o=zf(r);return{type:t,tag:"path",nested:!0,attr:function(t,n){var r=n.mark.items;r.length&&t("d",e(null,r))},bound:function(t,n){var r=n.items;return 0===r.length?t:(e(ff(t),r),Xd(t,r[0]))},draw:(i=r,function(t,e,n){!e.items.length||n&&!n.intersects(e.bounds)||Pf(i,t,e.items[0],e.items)}),pick:function(t,e,n,r,i,a){var s=e.items,u=e.bounds;return!s||!s.length||u&&!u.contains(i,a)?null:o(t,s,n*=t.pixelRatio,r*=t.pixelRatio)?s[0]:null},isect:xf,tip:n}},Hf=qf("area",(function(t,e){const n=e[0];return("horizontal"===n.orient?Dd:Td).curve(Rh(n.interpolate||"linear",n.orient,n.tension)).context(t)(e)}),(function(t,e){for(var n,r,i="horizontal"===t[0].orient?e[1]:e[0],o="horizontal"===t[0].orient?"y":"x",a=t.length,s=1/0;--a>=0;)!1!==t[a].defined&&(r=Math.abs(t[a][o]-i))<s&&(s=r,n=t[a]);return n}));function Gf(t,e){t.beginPath(),Pd(e)?jd(t,e,0,0):t.rect(0,0,e.width||0,e.height||0),t.clip()}function Xf(t){const e=Sf(t.strokeWidth,1);return null!=t.strokeOffset?t.strokeOffset:t.stroke&&e>.5&&e<1.5?.5-Math.abs(e-1):0}function Kf(t,e){const n=Xf(e);t("d",jd(null,e,n,n))}function Yf(t,e,n,r){const i=Xf(e);t.beginPath(),jd(t,e,(n||0)+i,(r||0)+i)}const Zf=zf(Yf),Qf=zf(Yf,!1),Jf=zf(Yf,!0);var tp={type:"group",tag:"g",nested:!1,attr:function(t,e){t("transform",$f(e))},bound:function(t,e){if(!e.clip&&e.items){const n=e.items,r=n.length;for(let e=0;e<r;++e)t.union(n[e].bounds)}return(e.clip||e.width||e.height)&&!e.noBound&&t.add(0,0).add(e.width||0,e.height||0),Xd(t,e),t.translate(e.x||0,e.y||0)},draw:function(t,e,n){If(e,e=>{const r=e.x||0,i=e.y||0,o=e.strokeForeground,a=null==e.opacity?1:e.opacity;(e.stroke||e.fill)&&a&&(Yf(t,e,r,i),kf(t,e),e.fill&&Af(t,e,a)&&t.fill(),e.stroke&&!o&&Tf(t,e,a)&&t.stroke()),t.save(),t.translate(r,i),e.clip&&Gf(t,e),n&&n.translate(-r,-i),If(e,e=>{this.draw(t,e,n)}),n&&n.translate(r,i),t.restore(),o&&e.stroke&&a&&(Yf(t,e,r,i),kf(t,e),Tf(t,e,a)&&t.stroke())})},pick:function(t,e,n,r,i,o){if(e.bounds&&!e.bounds.contains(i,o)||!e.items)return null;const a=n*t.pixelRatio,s=r*t.pixelRatio;return Mf(e,u=>{let l,c,h,d,f,p,m,g,y;if(g=u.bounds,(!g||g.contains(i,o))&&(d=u.x||0,f=u.y||0,p=d+(u.width||0),m=f+(u.height||0),y=u.clip,!y||!(i<d||i>p||o<f||o>m)))return t.save(),t.translate(d,f),d=i-d,f=o-f,y&&Pd(u)&&!Jf(t,u,a,s)?(t.restore(),null):(c=u.strokeForeground,h=!1!==e.interactive,h&&c&&u.stroke&&Qf(t,u,a,s)?(t.restore(),u):(l=Mf(u,t=>function(t,e,n){return(!1!==t.interactive||"group"===t.marktype)&&t.bounds&&t.bounds.contains(e,n)}(t,d,f)?this.pick(t,n,r,d,f):null),!l&&h&&(u.fill||!c&&u.stroke)&&Zf(t,u,a,s)&&(l=u),t.restore(),l||null))})},isect:_f,content:function(t,e,n){t("clip-path",e.clip?Ld(n,e,e):null)},background:function(t,e){t("class","background"),t("aria-hidden",!0),Kf(t,e)},foreground:function(t,e){t("class","foreground"),t("aria-hidden",!0),e.strokeForeground?Kf(t,e):t("d","")}},ep={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",version:"1.1"};function np(t,e){var n=t.image;return(!n||t.url&&t.url!==n.url)&&(n={complete:!1,width:0,height:0},e.loadImage(t.url).then(e=>{t.image=e,t.image.url=t.url})),n}function rp(t,e){return null!=t.width?t.width:e&&e.width?!1!==t.aspect&&t.height?t.height*e.width/e.height:e.width:0}function ip(t,e){return null!=t.height?t.height:e&&e.height?!1!==t.aspect&&t.width?t.width*e.height/e.width:e.height:0}function op(t,e){return"center"===t?e/2:"right"===t?e:0}function ap(t,e){return"middle"===t?e/2:"bottom"===t?e:0}var sp={type:"image",tag:"image",nested:!1,attr:function(t,e,n){const r=np(e,n),i=rp(e,r),o=ip(e,r),a=(e.x||0)-op(e.align,i),s=(e.y||0)-ap(e.baseline,o);t("href",!r.src&&r.toDataURL?r.toDataURL():r.src||"",ep["xmlns:xlink"],"xlink:href"),t("transform",Bf(a,s)),t("width",i),t("height",o),t("preserveAspectRatio",!1===e.aspect?"none":"xMidYMid")},bound:function(t,e){const n=e.image,r=rp(e,n),i=ip(e,n),o=(e.x||0)-op(e.align,r),a=(e.y||0)-ap(e.baseline,i);return t.set(o,a,o+r,a+i)},draw:function(t,e,n){If(e,e=>{if(n&&!n.intersects(e.bounds))return;let r,i,o,a,s=np(e,this),u=rp(e,s),l=ip(e,s),c=(e.x||0)-op(e.align,u),h=(e.y||0)-ap(e.baseline,l);!1!==e.aspect&&(i=s.width/s.height,o=e.width/e.height,i==i&&o==o&&i!==o&&(o<i?(a=u/i,h+=(l-a)/2,l=a):(a=l*i,c+=(u-a)/2,u=a))),(s.complete||s.toDataURL)&&(kf(t,e),t.globalAlpha=null!=(r=e.opacity)?r:1,t.imageSmoothingEnabled=!1!==e.smooth,t.drawImage(s,c,h,u,l))})},pick:jf(),isect:Ge,get:np,xOffset:op,yOffset:ap},up=qf("line",(function(t,e){const n=e[0];return Rd.curve(Rh(n.interpolate||"linear",n.orient,n.tension)).context(t)(e)}),(function(t,e){for(var n,r,i=Math.pow(t[0].strokeWidth||1,2),o=t.length;--o>=0;)if(!1!==t[o].defined&&(n=t[o].x-e[0])*n+(r=t[o].y-e[1])*r<i)return t[o];return null}));function lp(t,e){var n=e.path;if(null==n)return!0;var r=e.x||0,i=e.y||0,o=e.scaleX||1,a=e.scaleY||1,s=(e.angle||0)*Ph,u=e.pathCache;u&&u.path===n||((e.pathCache=u=Fh(n)).path=n),s&&t.rotate&&t.translate?(t.translate(r,i),t.rotate(s),Hh(t,u,0,0,o,a),t.rotate(-s),t.translate(-r,-i)):Hh(t,u,r,i,o,a)}var cp={type:"path",tag:"path",nested:!1,attr:function(t,e){1===(e.scaleX||1)&&1===(e.scaleY||1)||t("vector-effect","non-scaling-stroke"),t("transform",function(t){return Bf(t.x||0,t.y||0)+(t.angle?" "+Uf(t.angle):"")+(t.scaleX||t.scaleY?" scale("+(t.scaleX||1)+","+(t.scaleY||1)+")":"")}(e)),t("d",e.path)},bound:function(t,e){return lp(ff(t,e.angle),e)?t.set(0,0,0,0):Xd(t,e,!0)},draw:Ff(lp),pick:Lf(lp),isect:wf(lp)};function hp(t,e){t.beginPath(),jd(t,e)}var dp={type:"rect",tag:"path",nested:!1,attr:function(t,e){t("d",jd(null,e))},bound:function(t,e){var n,r;return Xd(t.set(n=e.x||0,r=e.y||0,n+e.width||0,r+e.height||0),e)},draw:Ff(hp),pick:Lf(hp),isect:_f};function fp(t,e,n){var r,i,o,a;return!(!e.stroke||!Tf(t,e,n)||(r=e.x||0,i=e.y||0,o=null!=e.x2?e.x2:r,a=null!=e.y2?e.y2:i,t.beginPath(),t.moveTo(r,i),t.lineTo(o,a),0))}var pp={type:"rule",tag:"line",nested:!1,attr:function(t,e){t("transform",$f(e)),t("x2",null!=e.x2?e.x2-(e.x||0):0),t("y2",null!=e.y2?e.y2-(e.y||0):0)},bound:function(t,e){var n,r;return Xd(t.set(n=e.x||0,r=e.y||0,null!=e.x2?e.x2:n,null!=e.y2?e.y2:r),e)},draw:function(t,e,n){If(e,(function(e){if(!n||n.intersects(e.bounds)){var r=null==e.opacity?1:e.opacity;r&&fp(t,e,r)&&(kf(t,e),t.stroke())}}))},pick:jf((function(t,e,n,r){return!!t.isPointInStroke&&fp(t,e,1)&&t.isPointInStroke(n,r)})),isect:function(t,e){const n=t.x||0,r=t.y||0;return Cf(e,n,r,null!=t.x2?t.x2:n,null!=t.y2?t.y2:r)}},mp=Vf("shape",(function(t,e){return(e.mark.shape||e.shape).context(t)(e)})),gp=Vf("symbol",(function(t,e){return Md.context(t)(e)}),xf);const yp=function(t){let e,n,r;t=+t||1e4;const i=()=>{e={},n={},r=0},o=(i,o)=>(++r>t&&(n=e,e={},r=1),e[i]=o);return i(),{clear:i,has:t=>On(e,t)||On(n,t),get:t=>On(e,t)?e[t]:On(n,t)?o(t,n[t]):void 0,set:(t,n)=>On(e,t)?e[t]=n:o(t,n)}}();var vp={height:kp,measureWidth:_p,estimateWidth:wp,width:wp,canvas:bp};function bp(t){vp.width=t&&vf?_p:wp}function wp(t,e){return xp(Ap(t,e),kp(t))}function xp(t,e){return~~(.8*t.length*e)}function _p(t,e){return kp(t)<=0||!(e=Ap(t,e))?0:Cp(e,Tp(t))}function Cp(t,e){const n=`(${e}) ${t}`;let r=yp.get(n);return void 0===r&&(vf.font=e,r=vf.measureText(t).width,yp.set(n,r)),r}function kp(t){return null!=t.fontSize?+t.fontSize||0:11}function Sp(t){return null!=t.lineHeight?t.lineHeight:kp(t)+2}function Ep(t){return e=t.lineBreak&&t.text&&!Ye(t.text)?t.text.split(t.lineBreak):t.text,Ye(e)?e.length>1?e:e[0]:e;var e}function Op(t){const e=Ep(t);return(Ye(e)?e.length-1:0)*Sp(t)}function Ap(t,e){const n=null==e?"":(e+"").trim();return t.limit>0&&n.length?function(t,e){var n=+t.limit,r=function(t){if(vp.width===_p){const e=Tp(t);return t=>Cp(t,e)}{const e=kp(t);return t=>xp(t,e)}}(t);if(r(e)<n)return e;var i,o=t.ellipsis||"\u2026",a="rtl"===t.dir,s=0,u=e.length;if(n-=r(o),a){for(;s<u;)r(e.slice(i=s+u>>>1))>n?s=i+1:u=i;return o+e.slice(s)}for(;s<u;)r(e.slice(0,i=1+(s+u>>>1)))<n?s=i:u=i-1;return e.slice(0,s)+o}(t,n):n}function Np(t,e){var n=t.font;return(e&&n?String(n).replace(/"/g,"'"):n)||"sans-serif"}function Tp(t,e){return(t.fontStyle?t.fontStyle+" ":"")+(t.fontVariant?t.fontVariant+" ":"")+(t.fontWeight?t.fontWeight+" ":"")+kp(t)+"px "+Np(t,e)}function Dp(t){var e=t.baseline,n=kp(t);return Math.round("top"===e?.79*n:"middle"===e?.3*n:"bottom"===e?-.21*n:"line-top"===e?.29*n+.5*Sp(t):"line-bottom"===e?.29*n-.5*Sp(t):0)}bp(!0);var Rp={left:"start",center:"middle",right:"end"},Ip=new Bd;function Mp(t){var e,n=t.x||0,r=t.y||0,i=t.radius||0;return i&&(e=(t.theta||0)-jh,n+=i*Math.cos(e),r+=i*Math.sin(e)),Ip.x1=n,Ip.y1=r,Ip}function Fp(t,e,n){var r,i=vp.height(e),o=e.align,a=Mp(e),s=a.x1,u=a.y1,l=e.dx||0,c=(e.dy||0)+Dp(e)-Math.round(.8*i),h=Ep(e);if(Ye(h)?(i+=Sp(e)*(h.length-1),r=h.reduce((t,n)=>Math.max(t,vp.width(e,n)),0)):r=vp.width(e,h),"center"===o?l-=r/2:"right"===o&&(l-=r),t.set(l+=s,c+=u,l+r,c+i),e.angle&&!n)t.rotate(e.angle*Ph,s,u);else if(2===n)return t.rotatedPoints(e.angle*Ph,s,u);return t}var Pp={arc:Wf,area:Hf,group:tp,image:sp,line:up,path:cp,rect:dp,rule:pp,shape:mp,symbol:gp,text:{type:"text",tag:"text",nested:!1,attr:function(t,e){var n,r=e.dx||0,i=(e.dy||0)+Dp(e),o=Mp(e),a=o.x1,s=o.y1,u=e.angle||0;t("text-anchor",Rp[e.align]||"start"),u?(n=Bf(a,s)+" "+Uf(u),(r||i)&&(n+=" "+Bf(r,i))):n=Bf(a+r,s+i),t("transform",n)},bound:Fp,draw:function(t,e,n){If(e,(function(e){var r,i,o,a,s,u,l,c=null==e.opacity?1:e.opacity;if(!(n&&!n.intersects(e.bounds)||0===c||e.fontSize<=0||null==e.text||0===e.text.length)){if(t.font=Tp(e),t.textAlign=e.align||"left",i=(r=Mp(e)).x1,o=r.y1,e.angle&&(t.save(),t.translate(i,o),t.rotate(e.angle*Ph),i=o=0),i+=e.dx||0,o+=(e.dy||0)+Dp(e),u=Ep(e),kf(t,e),Ye(u))for(s=Sp(e),a=0;a<u.length;++a)l=Ap(e,u[a]),e.fill&&Af(t,e,c)&&t.fillText(l,i,o),e.stroke&&Tf(t,e,c)&&t.strokeText(l,i,o),o+=s;else l=Ap(e,u),e.fill&&Af(t,e,c)&&t.fillText(l,i,o),e.stroke&&Tf(t,e,c)&&t.strokeText(l,i,o);e.angle&&t.restore()}}))},pick:jf((function(t,e,n,r,i,o){if(e.fontSize<=0)return!1;if(!e.angle)return!0;var a=Mp(e),s=a.x1,u=a.y1,l=Fp(Ip,e,1),c=-e.angle*Ph,h=Math.cos(c),d=Math.sin(c);return l.contains(h*i-d*o+(s-h*s+d*u),d*i+h*o+(u-d*s-h*u))})),isect:function(t,e){var n=Fp(Ip,t,2);return Cf(e,n[0],n[1],n[2],n[3])||Cf(e,n[0],n[1],n[4],n[5])||Cf(e,n[4],n[5],n[6],n[7])||Cf(e,n[2],n[3],n[6],n[7])}},trail:qf("trail",(function(t,e){return Fd.context(t)(e)}),(function(t,e){for(var n,r,i=t.length;--i>=0;)if(!1!==t[i].defined&&(n=t[i].x-e[0])*n+(r=t[i].y-e[1])*r<(n=t[i].size||1)*n)return t[i];return null}))},jp=function(t,e,n){var r=Pp[t.mark.marktype];return r.nested&&(t=t.mark),(e||r.bound)(t.bounds||(t.bounds=new Bd),t,n)},zp={mark:null},Lp=["marktype","name","role","interactive","clip","items","zindex","x","y","width","height","align","baseline","fill","fillOpacity","opacity","blend","stroke","strokeOpacity","strokeWidth","strokeCap","strokeDash","strokeDashOffset","strokeForeground","strokeOffset","startAngle","endAngle","innerRadius","outerRadius","cornerRadius","padAngle","cornerRadiusTopLeft","cornerRadiusTopRight","cornerRadiusBottomLeft","cornerRadiusBottomRight","interpolate","tension","orient","defined","url","aspect","smooth","path","scaleX","scaleY","x2","y2","size","shape","text","angle","theta","radius","dir","dx","dy","ellipsis","limit","lineBreak","lineHeight","font","fontSize","fontWeight","fontStyle","fontVariant","description","aria","ariaRole","ariaRoleDescription"];function Bp(t){return function t(e){var n,r,i,o=e.marktype,a=e.items;if(a)for(r=0,i=a.length;r<i;++r)a[r][n=o?"mark":"group"]=e,a[r].zindex&&(a[r][n].zdirty=!0),"group"===(o||n)&&t(a[r]);return o&&function(t,e,n){var r,i,o,a,s=Pp[t.marktype],u=s.bound,l=t.items,c=l&&l.length;if(s.nested)return c?o=l[0]:(zp.mark=t,o=zp),a=jp(o,u,void 0),e&&e.union(a)||a;if(e=e||t.bounds&&t.bounds.clear()||new Bd,c)for(r=0,i=l.length;r<i;++r)e.union(jp(l[r],u,void 0));t.bounds=e}(e),e}("string"==typeof t?JSON.parse(t):t)}function Up(t){arguments.length?this.root=Bp(t):(this.root=$p({marktype:"group",name:"root",role:"frame"}),this.root.items=[new $d(this.root)])}function $p(t,e){const n={bounds:new Bd,clip:!!t.clip,group:e,interactive:!1!==t.interactive,items:[],marktype:t.marktype,name:t.name||void 0,role:t.role||void 0,zindex:t.zindex||0};return null!=t.aria&&(n.aria=t.aria),t.description&&(n.description=t.description),n}function Vp(t,e,n){return!t&&"undefined"!=typeof document&&document.createElement&&(t=document),t?n?t.createElementNS(n,e):t.createElement(e):null}function Wp(t,e){e=e.toLowerCase();for(var n=t.childNodes,r=0,i=n.length;r<i;++r)if(n[r].tagName.toLowerCase()===e)return n[r]}function qp(t,e,n,r){var i,o=t.childNodes[e];return o&&o.tagName.toLowerCase()===n.toLowerCase()||(i=o||null,o=Vp(t.ownerDocument,n,r),t.insertBefore(o,i)),o}function Hp(t,e){for(var n=t.childNodes,r=n.length;r>e;)t.removeChild(n[--r]);return t}function Gp(t){return"mark-"+t.marktype+(t.role?" role-"+t.role:"")+(t.name?" "+t.name:"")}Up.prototype={toJSON(t){return function(t,e){return JSON.stringify(t,Lp,e)}(this.root,t||0)},mark(t,e,n){var r=$p(t,e=e||this.root.items[0]);return e.items[n]=r,r.zindex&&(r.group.zdirty=!0),r}};var Xp=function(t,e){var n=e.getBoundingClientRect();return[t.clientX-n.left-(e.clientLeft||0),t.clientY-n.top-(e.clientTop||0)]};function Kp(t,e){this._active=null,this._handlers={},this._loader=t||Ds(),this._tooltip=e||Yp}function Yp(t,e,n,r){t.element().setAttribute("title",r||"")}function Zp(t){this._el=null,this._bgcolor=null,this._loader=new qd(t)}Kp.prototype={initialize(t,e,n){return this._el=t,this._obj=n||null,this.origin(e)},element(){return this._el},canvas(){return this._el&&this._el.firstChild},origin(t){return arguments.length?(this._origin=t||[0,0],this):this._origin.slice()},scene(t){return arguments.length?(this._scene=t,this):this._scene},on(){},off(){},_handlerIndex(t,e,n){for(let r=t?t.length:0;--r>=0;)if(t[r].type===e&&(!n||t[r].handler===n))return r;return-1},handlers(t){const e=this._handlers,n=[];if(t)n.push.apply(n,e[this.eventName(t)]);else for(const r in e)n.push.apply(n,e[r]);return n},eventName(t){const e=t.indexOf(".");return e<0?t:t.slice(0,e)},handleHref(t,e,n){this._loader.sanitize(n,{context:"href"}).then(e=>{const n=new MouseEvent(t.type,t),r=Vp(null,"a");for(const t in e)r.setAttribute(t,e[t]);r.dispatchEvent(n)}).catch((function(){}))},handleTooltip(t,e,n){e&&null!=e.tooltip&&(e=function(t,e,n,r){var i,o,a=t&&t.mark;if(a&&(i=Pp[a.marktype]).tip){for((o=Xp(e,n))[0]-=r[0],o[1]-=r[1];t=t.mark.group;)o[0]-=t.x||0,o[1]-=t.y||0;t=i.tip(a.items,o)}return t}(e,t,this.canvas(),this._origin),this._tooltip.call(this._obj,this,t,e,n&&e&&e.tooltip||null))},getItemBoundingClientRect(t){const e=this.canvas();if(!e)return;const n=e.getBoundingClientRect(),r=this._origin,i=t.bounds,o=i.width(),a=i.height();let s=i.x1+r[0]+n.left,u=i.y1+r[1]+n.top;for(;t.mark&&(t=t.mark.group);)s+=t.x||0,u+=t.y||0;return{x:s,y:u,width:o,height:a,left:s,top:u,right:s+o,bottom:u+a}}},Zp.prototype={initialize(t,e,n,r,i){return this._el=t,this.resize(e,n,r,i)},element(){return this._el},canvas(){return this._el&&this._el.firstChild},background(t){return 0===arguments.length?this._bgcolor:(this._bgcolor=t,this)},resize(t,e,n,r){return this._width=t,this._height=e,this._origin=n||[0,0],this._scale=r||1,this},dirty(){},render(t){var e=this;return e._call=function(){e._render(t)},e._call(),e._call=null,e},_render(){},renderAsync(t){var e=this.render(t);return this._ready?this._ready.then((function(){return e})):Promise.resolve(e)},_load(t,e){var n=this,r=n._loader[t](e);if(!n._ready){var i=n._call;n._ready=n._loader.ready().then((function(t){t&&i(),n._ready=null}))}return r},sanitizeURL(t){return this._load("sanitizeURL",t)},loadImage(t){return this._load("loadImage",t)}};const Qp="dragleave",Jp="mousedown",tm="mousemove",em="mouseout",nm="click",rm=tm,im=em,om=nm;function am(t,e){Kp.call(this,t,e),this._down=null,this._touch=null,this._first=!0,this._events={}}function sm(t,e){(t=>"touchstart"===t||"touchmove"===t||"touchend"===t?["touchstart","touchmove","touchend"]:[t])(e).forEach(e=>function(t,e){const n=t.canvas();n&&!t._events[e]&&(t._events[e]=1,n.addEventListener(e,t[e]?n=>t[e](n):n=>t.fire(e,n)))}(t,e))}function um(t,e,n){return function(r){const i=this._active,o=this.pickEvent(r);o===i||(i&&i.exit||this.fire(n,r),this._active=o,this.fire(e,r)),this.fire(t,r)}}function lm(t){return function(e){this.fire(t,e),this._active=null}}Tn(am,Kp,{initialize(t,e,n){return this._canvas=t&&Wp(t,"canvas"),[nm,Jp,tm,em,Qp].forEach(t=>sm(this,t)),Kp.prototype.initialize.call(this,t,e,n)},canvas(){return this._canvas},context(){return this._canvas.getContext("2d")},events:["keydown","keypress","keyup","dragenter",Qp,"dragover",Jp,"mouseup",tm,em,"mouseover",nm,"dblclick","wheel","mousewheel","touchstart","touchmove","touchend"],DOMMouseScroll(t){this.fire("mousewheel",t)},mousemove:um(tm,"mouseover",em),dragover:um("dragover","dragenter",Qp),mouseout:lm(em),dragleave:lm(Qp),mousedown(t){this._down=this._active,this.fire(Jp,t)},click(t){this._down===this._active&&(this.fire(nm,t),this._down=null)},touchstart(t){this._touch=this.pickEvent(t.changedTouches[0]),this._first&&(this._active=this._touch,this._first=!1),this.fire("touchstart",t,!0)},touchmove(t){this.fire("touchmove",t,!0)},touchend(t){this.fire("touchend",t,!0),this._touch=null},fire(t,e,n){const r=n?this._touch:this._active,i=this._handlers[t];if(e.vegaType=t,t===om&&r&&r.href?this.handleHref(e,r,r.href):t!==rm&&t!==im||this.handleTooltip(e,r,t!==im),i)for(let o=0,a=i.length;o<a;++o)i[o].handler.call(this._obj,e,r)},on(t,e){const n=this.eventName(t),r=this._handlers;return this._handlerIndex(r[n],t,e)<0&&(sm(this,t),(r[n]||(r[n]=[])).push({type:t,handler:e})),this},off(t,e){const n=this.eventName(t),r=this._handlers[n],i=this._handlerIndex(r,t,e);return i>=0&&r.splice(i,1),this},pickEvent(t){const e=Xp(t,this._canvas),n=this._origin;return this.pick(this._scene,e[0],e[1],e[0]-n[0],e[1]-n[1])},pick(t,e,n,r,i){const o=this.context();return Pp[t.marktype].pick.call(this,o,t,e,n,r,i)}});var cm="undefined"!=typeof window&&window.devicePixelRatio||1;function hm(t){Zp.call(this,t),this._options={},this._redraw=!1,this._dirty=new Bd,this._tempb=new Bd}const dm=Zp.prototype;function fm(t,e){Kp.call(this,t,e);const n=this;n._hrefHandler=pm(n,(t,e)=>{e&&e.href&&n.handleHref(t,e,e.href)}),n._tooltipHandler=pm(n,(t,e)=>{n.handleTooltip(t,e,t.type!==im)})}Tn(hm,Zp,{initialize(t,e,n,r,i,o){return this._options=o||{},this._canvas=this._options.externalContext?null:Vd(1,1),t&&this._canvas&&(Hp(t,0).appendChild(this._canvas),this._canvas.setAttribute("class","marks")),dm.initialize.call(this,t,e,n,r,i)},resize(t,e,n,r){if(dm.resize.call(this,t,e,n,r),this._canvas)!function(t,e,n,r,i,o){const a="undefined"!=typeof HTMLElement&&t instanceof HTMLElement&&null!=t.parentNode,s=t.getContext("2d"),u=a?cm:i;t.width=e*u,t.height=n*u;for(const l in o)s[l]=o[l];a&&1!==u&&(t.style.width=e+"px",t.style.height=n+"px"),s.pixelRatio=u,s.setTransform(u,0,0,u,u*r[0],u*r[1])}(this._canvas,this._width,this._height,this._origin,this._scale,this._options.context);else{const t=this._options.externalContext;t||Be("CanvasRenderer is missing a valid canvas or context"),t.scale(this._scale,this._scale),t.translate(this._origin[0],this._origin[1])}return this._redraw=!0,this},canvas(){return this._canvas},context(){return this._options.externalContext||(this._canvas?this._canvas.getContext("2d"):null)},dirty(t){let e=this._tempb.clear().union(t.bounds),n=t.mark.group;for(;n;)e.translate(n.x||0,n.y||0),n=n.mark.group;this._dirty.union(e)},_render(t){const e=this.context(),n=this._origin,r=this._width,i=this._height,o=this._dirty,a=(s=n,u=r,l=i,(new Bd).set(0,0,u,l).translate(-s[0],-s[1]));var s,u,l;e.save();const c=this._redraw||o.empty()?(this._redraw=!1,a.expand(1)):function(t,e,n){return e.expand(1).round(),t.pixelRatio%1&&e.scale(t.pixelRatio).round().scale(1/t.pixelRatio),e.translate(-n[0]%1,-n[1]%1),t.beginPath(),t.rect(e.x1,e.y1,e.width(),e.height()),t.clip(),e}(e,a.intersect(o),n);return this.clear(-n[0],-n[1],r,i),this.draw(e,t,c),e.restore(),o.clear(),this},draw(t,e,n){const r=Pp[e.marktype];e.clip&&function(t,e){var n=e.clip;t.save(),gn(n)?(t.beginPath(),n(t),t.clip()):Gf(t,e.group)}(t,e),r.draw.call(this,t,e,n),e.clip&&t.restore()},clear(t,e,n,r){const i=this._options,o=this.context();"pdf"===i.type||i.externalContext||o.clearRect(t,e,n,r),null!=this._bgcolor&&(o.fillStyle=this._bgcolor,o.fillRect(t,e,n,r))}});const pm=(t,e)=>n=>{let r=n.target.__data__;r=Array.isArray(r)?r[0]:r,n.vegaType=n.type,e.call(t._obj,n,r)};Tn(fm,Kp,{initialize(t,e,n){let r=this._svg;return r&&(r.removeEventListener(om,this._hrefHandler),r.removeEventListener(rm,this._tooltipHandler),r.removeEventListener(im,this._tooltipHandler)),this._svg=r=t&&Wp(t,"svg"),r&&(r.addEventListener(om,this._hrefHandler),r.addEventListener(rm,this._tooltipHandler),r.addEventListener(im,this._tooltipHandler)),Kp.prototype.initialize.call(this,t,e,n)},canvas(){return this._svg},on(t,e){const n=this.eventName(t),r=this._handlers;if(this._handlerIndex(r[n],t,e)<0){const i={type:t,handler:e,listener:pm(this,e)};(r[n]||(r[n]=[])).push(i),this._svg&&this._svg.addEventListener(n,i.listener)}return this},off(t,e){const n=this.eventName(t),r=this._handlers[n],i=this._handlerIndex(r,t,e);return i>=0&&(this._svg&&this._svg.removeEventListener(n,r[i].listener),r.splice(i,1)),this}});var mm=function(t,e,n){const r=t-e+2*n;return t?r>0?r:1:0};const gm="log",ym="time",vm="utc",bm="continuous";var wm=Wo(Vo),xm=wm.right,_m=wm.left,Cm=xm;function km(t,e){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(e).domain(t)}return this}function Sm(t,e){switch(arguments.length){case 0:break;case 1:"function"==typeof t?this.interpolator(t):this.range(t);break;default:this.domain(t),"function"==typeof e?this.interpolator(e):this.range(e)}return this}const Em=Symbol("implicit");function Om(){var t=new Map,e=[],n=[],r=Em;function i(i){var o=i+"",a=t.get(o);if(!a){if(r!==Em)return r;t.set(o,a=e.push(i))}return n[(a-1)%n.length]}return i.domain=function(n){if(!arguments.length)return e.slice();e=[],t=new Map;for(const r of n){const n=r+"";t.has(n)||t.set(n,e.push(r))}return i},i.range=function(t){return arguments.length?(n=Array.from(t),i):n.slice()},i.unknown=function(t){return arguments.length?(r=t,i):r},i.copy=function(){return Om(e,n).unknown(r)},km.apply(i,arguments),i}function Am(){let t,e,n=Om().unknown(void 0),r=n.domain,i=n.range,o=[0,1],a=!1,s=0,u=0,l=.5;function c(){let n=r().length,c=o[1]<o[0],h=o[c-0],d=o[1-c],f=mm(n,s,u);t=(d-h)/(f||1),a&&(t=Math.floor(t)),h+=(d-h-t*(n-s))*l,e=t*(1-s),a&&(h=Math.round(h),e=Math.round(e));const p=nc(n).map((function(e){return h+t*e}));return i(c?p.reverse():p)}return delete n.unknown,n.domain=function(t){return arguments.length?(r(t),c()):r()},n.range=function(t){return arguments.length?(o=[+t[0],+t[1]],c()):o.slice()},n.rangeRound=function(t){return o=[+t[0],+t[1]],a=!0,c()},n.bandwidth=function(){return e},n.step=function(){return t},n.round=function(t){return arguments.length?(a=!!t,c()):a},n.padding=function(t){return arguments.length?(u=Math.max(0,Math.min(1,t)),s=u,c()):s},n.paddingInner=function(t){return arguments.length?(s=Math.max(0,Math.min(1,t)),c()):s},n.paddingOuter=function(t){return arguments.length?(u=Math.max(0,Math.min(1,t)),c()):u},n.align=function(t){return arguments.length?(l=Math.max(0,Math.min(1,t)),c()):l},n.invertRange=function(t){if(null==t[0]||null==t[1])return;let n,a,s,u=+t[0],l=+t[1],c=o[1]<o[0],h=c?i().reverse():i(),d=h.length-1;return u!=u||l!=l||(l<u&&(s=u,u=l,l=s),l<h[0]||u>o[1-c])?void 0:(n=Math.max(0,xm(h,u)-1),a=u===l?n:xm(h,l)-1,u-h[n]>e+1e-10&&++n,c&&(s=n,n=d-a,a=d-s),n>a?void 0:r().slice(n,a+1))},n.invert=function(t){const e=n.invertRange([t,t]);return e?e[0]:e},n.copy=function(){return Am().domain(r()).range(o).round(a).paddingInner(s).paddingOuter(u).align(l)},c()}var Nm=n("rWgG"),Tm=function(t,e,n,r){var i,o=ei(t,e,n);switch((r=Object(Nm.formatSpecifier)(null==r?",f":r)).type){case"s":var a=Math.max(Math.abs(t),Math.abs(e));return null!=r.precision||isNaN(i=Object(Nm.precisionPrefix)(o,a))||(r.precision=i),Object(Nm.formatPrefix)(r,a);case"":case"e":case"g":case"p":case"r":null!=r.precision||isNaN(i=Object(Nm.precisionRound)(o,Math.max(Math.abs(t),Math.abs(e))))||(r.precision=i-("e"===r.type));break;case"f":case"%":null!=r.precision||isNaN(i=Object(Nm.precisionFixed)(o))||(r.precision=i-2*("%"===r.type))}return Object(Nm.format)(r)},Dm=Array.prototype.map;function Rm(t){return Dm.call(t,nn)}const Im=Array.prototype.slice;var Mm=function(t,e,n){t.prototype=e.prototype=n,n.constructor=t};function Fm(t,e){var n=Object.create(t.prototype);for(var r in e)n[r]=e[r];return n}function Pm(){}var jm="\\s*([+-]?\\d+)\\s*",zm="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",Lm="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Bm=/^#([0-9a-f]{3,8})$/,Um=new RegExp("^rgb\\("+[jm,jm,jm]+"\\)$"),$m=new RegExp("^rgb\\("+[Lm,Lm,Lm]+"\\)$"),Vm=new RegExp("^rgba\\("+[jm,jm,jm,zm]+"\\)$"),Wm=new RegExp("^rgba\\("+[Lm,Lm,Lm,zm]+"\\)$"),qm=new RegExp("^hsl\\("+[zm,Lm,Lm]+"\\)$"),Hm=new RegExp("^hsla\\("+[zm,Lm,Lm,zm]+"\\)$"),Gm={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function Xm(){return this.rgb().formatHex()}function Km(){return this.rgb().formatRgb()}function Ym(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=Bm.exec(t))?(n=e[1].length,e=parseInt(e[1],16),6===n?Zm(e):3===n?new eg(e>>8&15|e>>4&240,e>>4&15|240&e,(15&e)<<4|15&e,1):8===n?Qm(e>>24&255,e>>16&255,e>>8&255,(255&e)/255):4===n?Qm(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|240&e,((15&e)<<4|15&e)/255):null):(e=Um.exec(t))?new eg(e[1],e[2],e[3],1):(e=$m.exec(t))?new eg(255*e[1]/100,255*e[2]/100,255*e[3]/100,1):(e=Vm.exec(t))?Qm(e[1],e[2],e[3],e[4]):(e=Wm.exec(t))?Qm(255*e[1]/100,255*e[2]/100,255*e[3]/100,e[4]):(e=qm.exec(t))?og(e[1],e[2]/100,e[3]/100,1):(e=Hm.exec(t))?og(e[1],e[2]/100,e[3]/100,e[4]):Gm.hasOwnProperty(t)?Zm(Gm[t]):"transparent"===t?new eg(NaN,NaN,NaN,0):null}function Zm(t){return new eg(t>>16&255,t>>8&255,255&t,1)}function Qm(t,e,n,r){return r<=0&&(t=e=n=NaN),new eg(t,e,n,r)}function Jm(t){return t instanceof Pm||(t=Ym(t)),t?new eg((t=t.rgb()).r,t.g,t.b,t.opacity):new eg}function tg(t,e,n,r){return 1===arguments.length?Jm(t):new eg(t,e,n,null==r?1:r)}function eg(t,e,n,r){this.r=+t,this.g=+e,this.b=+n,this.opacity=+r}function ng(){return"#"+ig(this.r)+ig(this.g)+ig(this.b)}function rg(){var t=this.opacity;return(1===(t=isNaN(t)?1:Math.max(0,Math.min(1,t)))?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(1===t?")":", "+t+")")}function ig(t){return((t=Math.max(0,Math.min(255,Math.round(t)||0)))<16?"0":"")+t.toString(16)}function og(t,e,n,r){return r<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new ug(t,e,n,r)}function ag(t){if(t instanceof ug)return new ug(t.h,t.s,t.l,t.opacity);if(t instanceof Pm||(t=Ym(t)),!t)return new ug;if(t instanceof ug)return t;var e=(t=t.rgb()).r/255,n=t.g/255,r=t.b/255,i=Math.min(e,n,r),o=Math.max(e,n,r),a=NaN,s=o-i,u=(o+i)/2;return s?(a=e===o?(n-r)/s+6*(n<r):n===o?(r-e)/s+2:(e-n)/s+4,s/=u<.5?o+i:2-o-i,a*=60):s=u>0&&u<1?0:a,new ug(a,s,u,t.opacity)}function sg(t,e,n,r){return 1===arguments.length?ag(t):new ug(t,e,n,null==r?1:r)}function ug(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}function lg(t,e,n){return 255*(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)}function cg(t,e,n,r,i){var o=t*t,a=o*t;return((1-3*t+3*o-a)*e+(4-6*o+3*a)*n+(1+3*t+3*o-3*a)*r+a*i)/6}Mm(Pm,Ym,{copy:function(t){return Object.assign(new this.constructor,this,t)},displayable:function(){return this.rgb().displayable()},hex:Xm,formatHex:Xm,formatHsl:function(){return ag(this).formatHsl()},formatRgb:Km,toString:Km}),Mm(eg,tg,Fm(Pm,{brighter:function(t){return t=null==t?1/.7:Math.pow(1/.7,t),new eg(this.r*t,this.g*t,this.b*t,this.opacity)},darker:function(t){return t=null==t?.7:Math.pow(.7,t),new eg(this.r*t,this.g*t,this.b*t,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:ng,formatHex:ng,formatRgb:rg,toString:rg})),Mm(ug,sg,Fm(Pm,{brighter:function(t){return t=null==t?1/.7:Math.pow(1/.7,t),new ug(this.h,this.s,this.l*t,this.opacity)},darker:function(t){return t=null==t?.7:Math.pow(.7,t),new ug(this.h,this.s,this.l*t,this.opacity)},rgb:function(){var t=this.h%360+360*(this.h<0),e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*e,i=2*n-r;return new eg(lg(t>=240?t-240:t+120,i,r),lg(t,i,r),lg(t<120?t+240:t-120,i,r),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var t=this.opacity;return(1===(t=isNaN(t)?1:Math.max(0,Math.min(1,t)))?"hsl(":"hsla(")+(this.h||0)+", "+100*(this.s||0)+"%, "+100*(this.l||0)+"%"+(1===t?")":", "+t+")")}}));var hg=function(t){var e=t.length-1;return function(n){var r=n<=0?n=0:n>=1?(n=1,e-1):Math.floor(n*e),i=t[r],o=t[r+1];return cg((n-r/e)*e,r>0?t[r-1]:2*i-o,i,o,r<e-1?t[r+2]:2*o-i)}},dg=function(t){var e=t.length;return function(n){var r=Math.floor(((n%=1)<0?++n:n)*e);return cg((n-r/e)*e,t[(r+e-1)%e],t[r%e],t[(r+1)%e],t[(r+2)%e])}},fg=function(t){return function(){return t}};function pg(t,e){return function(n){return t+n*e}}function mg(t,e){var n=e-t;return n?pg(t,n>180||n<-180?n-360*Math.round(n/360):n):fg(isNaN(t)?e:t)}function gg(t,e){var n=e-t;return n?pg(t,n):fg(isNaN(t)?e:t)}var yg=function t(e){var n=function(t){return 1==(t=+t)?gg:function(e,n){return n-e?function(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(r){return Math.pow(t+r*e,n)}}(e,n,t):fg(isNaN(e)?n:e)}}(e);function r(t,e){var r=n((t=tg(t)).r,(e=tg(e)).r),i=n(t.g,e.g),o=n(t.b,e.b),a=gg(t.opacity,e.opacity);return function(e){return t.r=r(e),t.g=i(e),t.b=o(e),t.opacity=a(e),t+""}}return r.gamma=t,r}(1);function vg(t){return function(e){var n,r,i=e.length,o=new Array(i),a=new Array(i),s=new Array(i);for(n=0;n<i;++n)r=tg(e[n]),o[n]=r.r||0,a[n]=r.g||0,s[n]=r.b||0;return o=t(o),a=t(a),s=t(s),r.opacity=1,function(t){return r.r=o(t),r.g=a(t),r.b=s(t),r+""}}}var bg=vg(hg),wg=vg(dg),xg=function(t,e){e||(e=[]);var n,r=t?Math.min(e.length,t.length):0,i=e.slice();return function(o){for(n=0;n<r;++n)i[n]=t[n]*(1-o)+e[n]*o;return i}};function _g(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}var Cg=function(t,e){return(_g(e)?xg:kg)(t,e)};function kg(t,e){var n,r=e?e.length:0,i=t?Math.min(r,t.length):0,o=new Array(i),a=new Array(r);for(n=0;n<i;++n)o[n]=Dg(t[n],e[n]);for(;n<r;++n)a[n]=e[n];return function(t){for(n=0;n<i;++n)a[n]=o[n](t);return a}}var Sg=function(t,e){var n=new Date;return t=+t,e=+e,function(r){return n.setTime(t*(1-r)+e*r),n}},Eg=function(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}},Og=function(t,e){var n,r={},i={};for(n in null!==t&&"object"==typeof t||(t={}),null!==e&&"object"==typeof e||(e={}),e)n in t?r[n]=Dg(t[n],e[n]):i[n]=e[n];return function(t){for(n in r)i[n]=r[n](t);return i}},Ag=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Ng=new RegExp(Ag.source,"g"),Tg=function(t,e){var n,r,i,o=Ag.lastIndex=Ng.lastIndex=0,a=-1,s=[],u=[];for(t+="",e+="";(n=Ag.exec(t))&&(r=Ng.exec(e));)(i=r.index)>o&&(i=e.slice(o,i),s[a]?s[a]+=i:s[++a]=i),(n=n[0])===(r=r[0])?s[a]?s[a]+=r:s[++a]=r:(s[++a]=null,u.push({i:a,x:Eg(n,r)})),o=Ng.lastIndex;return o<e.length&&(i=e.slice(o),s[a]?s[a]+=i:s[++a]=i),s.length<2?u[0]?function(t){return function(e){return t(e)+""}}(u[0].x):function(t){return function(){return t}}(e):(e=u.length,function(t){for(var n,r=0;r<e;++r)s[(n=u[r]).i]=n.x(t);return s.join("")})},Dg=function(t,e){var n,r=typeof e;return null==e||"boolean"===r?fg(e):("number"===r?Eg:"string"===r?(n=Ym(e))?(e=n,yg):Tg:e instanceof Ym?yg:e instanceof Date?Sg:_g(e)?xg:Array.isArray(e)?kg:"function"!=typeof e.valueOf&&"function"!=typeof e.toString||isNaN(e)?Og:Eg)(t,e)},Rg=function(t,e){return t=+t,e=+e,function(n){return Math.round(t*(1-n)+e*n)}},Ig=function(t){return+t},Mg=[0,1];function Fg(t){return t}function Pg(t,e){return(e-=t=+t)?function(n){return(n-t)/e}:(n=isNaN(e)?NaN:.5,function(){return n});var n}function jg(t,e,n){var r=t[0],i=t[1],o=e[0],a=e[1];return i<r?(r=Pg(i,r),o=n(a,o)):(r=Pg(r,i),o=n(o,a)),function(t){return o(r(t))}}function zg(t,e,n){var r=Math.min(t.length,e.length)-1,i=new Array(r),o=new Array(r),a=-1;for(t[r]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++a<r;)i[a]=Pg(t[a],t[a+1]),o[a]=n(e[a],e[a+1]);return function(e){var n=Cm(t,e,1,r)-1;return o[n](i[n](e))}}function Lg(t,e){return e.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown())}function Bg(){var t,e,n,r,i,o,a=Mg,s=Mg,u=Dg,l=Fg;function c(){var t,e,n,u=Math.min(a.length,s.length);return l!==Fg&&((t=a[0])>(e=a[u-1])&&(n=t,t=e,e=n),l=function(n){return Math.max(t,Math.min(e,n))}),r=u>2?zg:jg,i=o=null,h}function h(e){return isNaN(e=+e)?n:(i||(i=r(a.map(t),s,u)))(t(l(e)))}return h.invert=function(n){return l(e((o||(o=r(s,a.map(t),Eg)))(n)))},h.domain=function(t){return arguments.length?(a=Array.from(t,Ig),c()):a.slice()},h.range=function(t){return arguments.length?(s=Array.from(t),c()):s.slice()},h.rangeRound=function(t){return s=Array.from(t),u=Rg,c()},h.clamp=function(t){return arguments.length?(l=!!t||Fg,c()):l!==Fg},h.interpolate=function(t){return arguments.length?(u=t,c()):u},h.unknown=function(t){return arguments.length?(n=t,h):n},function(n,r){return t=n,e=r,c()}}function Ug(){return Bg()(Fg,Fg)}function $g(t){var e=t.domain;return t.ticks=function(t){var n=e();return Jr(n[0],n[n.length-1],null==t?10:t)},t.tickFormat=function(t,n){var r=e();return Tm(r[0],r[r.length-1],null==t?10:t,n)},t.nice=function(n){null==n&&(n=10);var r,i=e(),o=0,a=i.length-1,s=i[o],u=i[a];return u<s&&(r=s,s=u,u=r,r=o,o=a,a=r),(r=ti(s,u,n))>0?r=ti(s=Math.floor(s/r)*r,u=Math.ceil(u/r)*r,n):r<0&&(r=ti(s=Math.ceil(s*r)/r,u=Math.floor(u*r)/r,n)),r>0?(i[o]=Math.floor(s/r)*r,i[a]=Math.ceil(u/r)*r,e(i)):r<0&&(i[o]=Math.ceil(s*r)/r,i[a]=Math.floor(u*r)/r,e(i)),t},t}var Vg=function(t,e){var n,r=0,i=(t=t.slice()).length-1,o=t[r],a=t[i];return a<o&&(n=r,r=i,i=n,n=o,o=a,a=n),t[r]=e.floor(o),t[i]=e.ceil(a),t};function Wg(t){return Math.log(t)}function qg(t){return Math.exp(t)}function Hg(t){return-Math.log(-t)}function Gg(t){return-Math.exp(-t)}function Xg(t){return isFinite(t)?+("1e"+t):t<0?0:t}function Kg(t){return function(e){return-t(-e)}}function Yg(t){var e,n,r=t(Wg,qg),i=r.domain,o=10;function a(){return e=function(t){return t===Math.E?Math.log:10===t&&Math.log10||2===t&&Math.log2||(t=Math.log(t),function(e){return Math.log(e)/t})}(o),n=function(t){return 10===t?Xg:t===Math.E?Math.exp:function(e){return Math.pow(t,e)}}(o),i()[0]<0?(e=Kg(e),n=Kg(n),t(Hg,Gg)):t(Wg,qg),r}return r.base=function(t){return arguments.length?(o=+t,a()):o},r.domain=function(t){return arguments.length?(i(t),a()):i()},r.ticks=function(t){var r,a=i(),s=a[0],u=a[a.length-1];(r=u<s)&&(d=s,s=u,u=d);var l,c,h,d=e(s),f=e(u),p=null==t?10:+t,m=[];if(!(o%1)&&f-d<p){if(d=Math.floor(d),f=Math.ceil(f),s>0){for(;d<=f;++d)for(c=1,l=n(d);c<o;++c)if(!((h=l*c)<s)){if(h>u)break;m.push(h)}}else for(;d<=f;++d)for(c=o-1,l=n(d);c>=1;--c)if(!((h=l*c)<s)){if(h>u)break;m.push(h)}2*m.length<p&&(m=Jr(s,u,p))}else m=Jr(d,f,Math.min(f-d,p)).map(n);return r?m.reverse():m},r.tickFormat=function(t,i){if(null==i&&(i=10===o?".0e":","),"function"!=typeof i&&(i=Object(Nm.format)(i)),t===1/0)return i;null==t&&(t=10);var a=Math.max(1,o*t/r.ticks().length);return function(t){var r=t/n(Math.round(e(t)));return r*o<o-.5&&(r*=o),r<=a?i(t):""}},r.nice=function(){return i(Vg(i(),{floor:function(t){return n(Math.floor(e(t)))},ceil:function(t){return n(Math.ceil(e(t)))}}))},r}function Zg(t){return function(e){return e<0?-Math.pow(-e,t):Math.pow(e,t)}}function Qg(t){return t<0?-Math.sqrt(-t):Math.sqrt(t)}function Jg(t){return t<0?-t*t:t*t}function ty(t){var e=t(Fg,Fg),n=1;function r(){return 1===n?t(Fg,Fg):.5===n?t(Qg,Jg):t(Zg(n),Zg(1/n))}return e.exponent=function(t){return arguments.length?(n=+t,r()):n},$g(e)}function ey(){var t=ty(Bg());return t.copy=function(){return Lg(t,ey()).exponent(t.exponent())},km.apply(t,arguments),t}function ny(t){return function(e){return Math.sign(e)*Math.log1p(Math.abs(e/t))}}function ry(t){return function(e){return Math.sign(e)*Math.expm1(Math.abs(e))*t}}function iy(t){var e=1,n=t(ny(e),ry(e));return n.constant=function(n){return arguments.length?t(ny(e=+n),ry(e)):e},$g(n)}function oy(t){return new Date(t)}function ay(t){return t instanceof Date?+t:+new Date(+t)}function sy(t,e,n,r,i,o,a,s,u){var l=Ug(),c=l.invert,h=l.domain,d=u(".%L"),f=u(":%S"),p=u("%I:%M"),m=u("%I %p"),g=u("%a %d"),y=u("%b %d"),v=u("%B"),b=u("%Y"),w=[[a,1,1e3],[a,5,5e3],[a,15,15e3],[a,30,3e4],[o,1,6e4],[o,5,3e5],[o,15,9e5],[o,30,18e5],[i,1,36e5],[i,3,108e5],[i,6,216e5],[i,12,432e5],[r,1,864e5],[r,2,1728e5],[n,1,6048e5],[e,1,2592e6],[e,3,7776e6],[t,1,31536e6]];function x(s){return(a(s)<s?d:o(s)<s?f:i(s)<s?p:r(s)<s?m:e(s)<s?n(s)<s?g:y:t(s)<s?v:b)(s)}function _(e,n,r){if(null==e&&(e=10),"number"==typeof e){var i,o=Math.abs(r-n)/e,a=Wo((function(t){return t[2]})).right(w,o);return a===w.length?(i=ei(n/31536e6,r/31536e6,e),e=t):a?(i=(a=w[o/w[a-1][2]<w[a][2]/o?a-1:a])[1],e=a[0]):(i=Math.max(ei(n,r,e),1),e=s),e.every(i)}return e}return l.invert=function(t){return new Date(c(t))},l.domain=function(t){return arguments.length?h(Array.from(t,ay)):h().map(oy)},l.ticks=function(t){var e,n=h(),r=n[0],i=n[n.length-1],o=i<r;return o&&(e=r,r=i,i=e),e=(e=_(t,r,i))?e.range(r,i+1):[],o?e.reverse():e},l.tickFormat=function(t,e){return null==e?x:u(e)},l.nice=function(t){var e=h();return(t=_(t,e[0],e[e.length-1]))?h(Vg(e,t)):l},l.copy=function(){return Lg(l,sy(t,e,n,r,i,o,a,s,u))},l}function uy(){var t,e,n,r,i,o=0,a=1,s=Fg,u=!1;function l(e){return isNaN(e=+e)?i:s(0===n?.5:(e=(r(e)-t)*n,u?Math.max(0,Math.min(1,e)):e))}function c(t){return function(e){var n,r;return arguments.length?([n,r]=e,s=t(n,r),l):[s(0),s(1)]}}return l.domain=function(i){return arguments.length?([o,a]=i,t=r(o=+o),e=r(a=+a),n=t===e?0:1/(e-t),l):[o,a]},l.clamp=function(t){return arguments.length?(u=!!t,l):u},l.interpolator=function(t){return arguments.length?(s=t,l):s},l.range=c(Dg),l.rangeRound=c(Rg),l.unknown=function(t){return arguments.length?(i=t,l):i},function(i){return r=i,t=i(o),e=i(a),n=t===e?0:1/(e-t),l}}function ly(t,e){return e.domain(t.domain()).interpolator(t.interpolator()).clamp(t.clamp()).unknown(t.unknown())}function cy(){var t=$g(uy()(Fg));return t.copy=function(){return ly(t,cy())},Sm.apply(t,arguments)}function hy(){var t=ty(uy());return t.copy=function(){return ly(t,hy()).exponent(t.exponent())},Sm.apply(t,arguments)}function dy(t,e){for(var n=0,r=e.length-1,i=e[0],o=new Array(r<0?0:r);n<r;)o[n]=t(i,i=e[++n]);return function(t){var e=Math.max(0,Math.min(r-1,Math.floor(t*=r)));return o[e](t-e)}}function fy(){var t,e,n,r,i,o,a,s=0,u=.5,l=1,c=1,h=Fg,d=!1;function f(t){return isNaN(t=+t)?a:(t=.5+((t=+o(t))-e)*(c*t<c*e?r:i),h(d?Math.max(0,Math.min(1,t)):t))}function p(t){return function(e){var n,r,i;return arguments.length?([n,r,i]=e,h=dy(t,[n,r,i]),f):[h(0),h(.5),h(1)]}}return f.domain=function(a){return arguments.length?([s,u,l]=a,t=o(s=+s),e=o(u=+u),n=o(l=+l),r=t===e?0:.5/(e-t),i=e===n?0:.5/(n-e),c=e<t?-1:1,f):[s,u,l]},f.clamp=function(t){return arguments.length?(d=!!t,f):d},f.interpolator=function(t){return arguments.length?(h=t,f):h},f.range=p(Dg),f.rangeRound=p(Rg),f.unknown=function(t){return arguments.length?(a=t,f):a},function(a){return o=a,t=a(s),e=a(u),n=a(l),r=t===e?0:.5/(e-t),i=e===n?0:.5/(n-e),c=e<t?-1:1,f}}function py(){var t=ty(fy());return t.copy=function(){return ly(t,py()).exponent(t.exponent())},Sm.apply(t,arguments)}const my={};function gy(t,e,n){const r=function(){const n=e();return n.invertRange||(n.invertRange=n.invert?(r=n,function(t){let e,n=t[0],i=t[1];return i<n&&(e=n,n=i,i=e),[r.invert(n),r.invert(i)]}):n.invertExtent?function(t){return function(e){let n,r,i,o,a=t.range(),s=e[0],u=e[1],l=-1;for(u<s&&(r=s,s=u,u=r),i=0,o=a.length;i<o;++i)a[i]>=s&&a[i]<=u&&(l<0&&(l=i),n=i);if(!(l<0))return s=t.invertExtent(a[l]),u=t.invertExtent(a[n]),[void 0===s[0]?s[1]:s[0],void 0===u[1]?u[0]:u[1]]}}(n):void 0),n.type=t,n;var r};return r.metadata=Vn(mn(n)),r}function yy(t,e,n){return arguments.length>1?(my[t]=gy(t,e,n),this):vy(t)?my[t]:void 0}function vy(t){return On(my,t)}function by(t,e){const n=my[t];return n&&n.metadata[e]}function wy(t){return by(t,bm)}function xy(t){return by(t,"discrete")}function _y(t){return by(t,"discretizing")}function Cy(t){return by(t,gm)}function ky(t){return by(t,"interpolating")}function Sy(t){return by(t,"quantile")}yy("identity",(function t(e){var n;function r(t){return isNaN(t=+t)?n:t}return r.invert=r,r.domain=r.range=function(t){return arguments.length?(e=Array.from(t,Ig),r):e.slice()},r.unknown=function(t){return arguments.length?(n=t,r):n},r.copy=function(){return t(e).unknown(n)},e=arguments.length?Array.from(e,Ig):[0,1],$g(r)})),yy("linear",(function t(){var e=Ug();return e.copy=function(){return Lg(e,t())},km.apply(e,arguments),$g(e)}),bm),yy(gm,(function t(){var e=Yg(Bg()).domain([1,10]);return e.copy=function(){return Lg(e,t()).base(e.base())},km.apply(e,arguments),e}),[bm,gm]),yy("pow",ey,bm),yy("sqrt",(function(){return ey.apply(null,arguments).exponent(.5)}),bm),yy("symlog",(function t(){var e=iy(Bg());return e.copy=function(){return Lg(e,t()).constant(e.constant())},km.apply(e,arguments)}),bm),yy(ym,(function(){return km.apply(sy(xo,_o,Vi,Ui,Co,ko,So,Oo,oa).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}),[bm,"temporal"]),yy(vm,(function(){return km.apply(sy(No,To,Xi,Hi,Do,Ro,So,Oo,sa).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}),[bm,"temporal"]),yy("sequential",cy,[bm,"interpolating"]),yy("sequential-linear",cy,[bm,"interpolating"]),yy("sequential-log",(function t(){var e=Yg(uy()).domain([1,10]);return e.copy=function(){return ly(e,t()).base(e.base())},Sm.apply(e,arguments)}),[bm,"interpolating",gm]),yy("sequential-pow",hy,[bm,"interpolating"]),yy("sequential-sqrt",(function(){return hy.apply(null,arguments).exponent(.5)}),[bm,"interpolating"]),yy("sequential-symlog",(function t(){var e=iy(uy());return e.copy=function(){return ly(e,t()).constant(e.constant())},Sm.apply(e,arguments)}),[bm,"interpolating"]),yy("diverging-linear",(function t(){var e=$g(fy()(Fg));return e.copy=function(){return ly(e,t())},Sm.apply(e,arguments)}),[bm,"interpolating"]),yy("diverging-log",(function t(){var e=Yg(fy()).domain([.1,1,10]);return e.copy=function(){return ly(e,t()).base(e.base())},Sm.apply(e,arguments)}),[bm,"interpolating",gm]),yy("diverging-pow",py,[bm,"interpolating"]),yy("diverging-sqrt",(function(){return py.apply(null,arguments).exponent(.5)}),[bm,"interpolating"]),yy("diverging-symlog",(function t(){var e=iy(fy());return e.copy=function(){return ly(e,t()).constant(e.constant())},Sm.apply(e,arguments)}),[bm,"interpolating"]),yy("quantile",(function t(){var e,n=[],r=[],i=[];function o(){var t=0,e=Math.max(1,r.length);for(i=new Array(e-1);++t<e;)i[t-1]=pu(n,t/e);return a}function a(t){return isNaN(t=+t)?e:r[Cm(i,t)]}return a.invertExtent=function(t){var e=r.indexOf(t);return e<0?[NaN,NaN]:[e>0?i[e-1]:n[0],e<i.length?i[e]:n[n.length-1]]},a.domain=function(t){if(!arguments.length)return n.slice();n=[];for(let e of t)null==e||isNaN(e=+e)||n.push(e);return n.sort(Vo),o()},a.range=function(t){return arguments.length?(r=Array.from(t),o()):r.slice()},a.unknown=function(t){return arguments.length?(e=t,a):e},a.quantiles=function(){return i.slice()},a.copy=function(){return t().domain(n).range(r).unknown(e)},km.apply(a,arguments)}),["discretizing","quantile"]),yy("quantize",(function t(){var e,n=0,r=1,i=1,o=[.5],a=[0,1];function s(t){return t<=t?a[Cm(o,t,0,i)]:e}function u(){var t=-1;for(o=new Array(i);++t<i;)o[t]=((t+1)*r-(t-i)*n)/(i+1);return s}return s.domain=function(t){return arguments.length?([n,r]=t,n=+n,r=+r,u()):[n,r]},s.range=function(t){return arguments.length?(i=(a=Array.from(t)).length-1,u()):a.slice()},s.invertExtent=function(t){var e=a.indexOf(t);return e<0?[NaN,NaN]:e<1?[n,o[0]]:e>=i?[o[i-1],r]:[o[e-1],o[e]]},s.unknown=function(t){return arguments.length?(e=t,s):s},s.thresholds=function(){return o.slice()},s.copy=function(){return t().domain([n,r]).range(a).unknown(e)},km.apply($g(s),arguments)}),"discretizing"),yy("threshold",(function t(){var e,n=[.5],r=[0,1],i=1;function o(t){return t<=t?r[Cm(n,t,0,i)]:e}return o.domain=function(t){return arguments.length?(n=Array.from(t),i=Math.min(n.length,r.length-1),o):n.slice()},o.range=function(t){return arguments.length?(r=Array.from(t),i=Math.min(n.length,r.length-1),o):r.slice()},o.invertExtent=function(t){var e=r.indexOf(t);return[n[e-1],n[e]]},o.unknown=function(t){return arguments.length?(e=t,o):e},o.copy=function(){return t().domain(n).range(r).unknown(e)},km.apply(o,arguments)}),"discretizing"),yy("bin-ordinal",(function t(){let e=[],n=[];function r(t){return null==t||t!=t?void 0:n[(Cm(e,t)-1)%n.length]}return r.domain=function(t){return arguments.length?(e=Rm(t),r):e.slice()},r.range=function(t){return arguments.length?(n=Im.call(t),r):n.slice()},r.tickFormat=function(t,n){return Tm(e[0],en(e),null==t?10:t,n)},r.copy=function(){return t().domain(r.domain()).range(r.range())},r}),["discrete","discretizing"]),yy("ordinal",Om,"discrete"),yy("band",Am,"discrete"),yy("point",(function(){return function t(e){const n=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,e.copy=function(){return t(n())},e}(Am().paddingInner(1))}),"discrete");var Ey,Oy,Ay,Ny,Ty=function(t){var e=t.length;return function(n){return t[Math.max(0,Math.min(e-1,Math.floor(n*e)))]}},Dy=function(t,e){var n=mg(+t,+e);return function(t){var e=n(t);return e-360*Math.floor(e/360)}},Ry=180/Math.PI,Iy={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1},My=function(t,e,n,r,i,o){var a,s,u;return(a=Math.sqrt(t*t+e*e))&&(t/=a,e/=a),(u=t*n+e*r)&&(n-=t*u,r-=e*u),(s=Math.sqrt(n*n+r*r))&&(n/=s,r/=s,u/=s),t*r<e*n&&(t=-t,e=-e,u=-u,a=-a),{translateX:i,translateY:o,rotate:Math.atan2(e,t)*Ry,skewX:Math.atan(u)*Ry,scaleX:a,scaleY:s}};function Fy(t,e,n,r){function i(t){return t.length?t.pop()+" ":""}return function(o,a){var s=[],u=[];return o=t(o),a=t(a),function(t,r,i,o,a,s){if(t!==i||r!==o){var u=a.push("translate(",null,e,null,n);s.push({i:u-4,x:Eg(t,i)},{i:u-2,x:Eg(r,o)})}else(i||o)&&a.push("translate("+i+e+o+n)}(o.translateX,o.translateY,a.translateX,a.translateY,s,u),function(t,e,n,o){t!==e?(t-e>180?e+=360:e-t>180&&(t+=360),o.push({i:n.push(i(n)+"rotate(",null,r)-2,x:Eg(t,e)})):e&&n.push(i(n)+"rotate("+e+r)}(o.rotate,a.rotate,s,u),function(t,e,n,o){t!==e?o.push({i:n.push(i(n)+"skewX(",null,r)-2,x:Eg(t,e)}):e&&n.push(i(n)+"skewX("+e+r)}(o.skewX,a.skewX,s,u),function(t,e,n,r,o,a){if(t!==n||e!==r){var s=o.push(i(o)+"scale(",null,",",null,")");a.push({i:s-4,x:Eg(t,n)},{i:s-2,x:Eg(e,r)})}else 1===n&&1===r||o.push(i(o)+"scale("+n+","+r+")")}(o.scaleX,o.scaleY,a.scaleX,a.scaleY,s,u),o=a=null,function(t){for(var e,n=-1,r=u.length;++n<r;)s[(e=u[n]).i]=e.x(t);return s.join("")}}}var Py=Fy((function(t){return"none"===t?Iy:(Ey||(Ey=document.createElement("DIV"),Oy=document.documentElement,Ay=document.defaultView),Ey.style.transform=t,t=Ay.getComputedStyle(Oy.appendChild(Ey),null).getPropertyValue("transform"),Oy.removeChild(Ey),t=t.slice(7,-1).split(","),My(+t[0],+t[1],+t[2],+t[3],+t[4],+t[5]))}),"px, ","px)","deg)"),jy=Fy((function(t){return null==t?Iy:(Ny||(Ny=document.createElementNS("http://www.w3.org/2000/svg","g")),Ny.setAttribute("transform",t),(t=Ny.transform.baseVal.consolidate())?My((t=t.matrix).a,t.b,t.c,t.d,t.e,t.f):Iy)}),", ",")",")"),zy=Math.SQRT2;function Ly(t){return((t=Math.exp(t))+1/t)/2}var By=function(t,e){var n,r,i=t[0],o=t[1],a=t[2],s=e[2],u=e[0]-i,l=e[1]-o,c=u*u+l*l;if(c<1e-12)r=Math.log(s/a)/zy,n=function(t){return[i+t*u,o+t*l,a*Math.exp(zy*t*r)]};else{var h=Math.sqrt(c),d=(s*s-a*a+4*c)/(2*a*2*h),f=(s*s-a*a-4*c)/(2*s*2*h),p=Math.log(Math.sqrt(d*d+1)-d),m=Math.log(Math.sqrt(f*f+1)-f);r=(m-p)/zy,n=function(t){var e,n=t*r,s=Ly(p),c=a/(2*h)*(s*(e=zy*n+p,((e=Math.exp(2*e))-1)/(e+1))-function(t){return((t=Math.exp(t))-1/t)/2}(p));return[i+c*u,o+c*l,a*s/Ly(zy*n+p)]}}return n.duration=1e3*r,n};function Uy(t){return function(e,n){var r=t((e=sg(e)).h,(n=sg(n)).h),i=gg(e.s,n.s),o=gg(e.l,n.l),a=gg(e.opacity,n.opacity);return function(t){return e.h=r(t),e.s=i(t),e.l=o(t),e.opacity=a(t),e+""}}}var $y=Uy(mg),Vy=Uy(gg),Wy=Math.PI/180,qy=180/Math.PI;function Hy(t){if(t instanceof Xy)return new Xy(t.l,t.a,t.b,t.opacity);if(t instanceof ev)return nv(t);t instanceof eg||(t=Jm(t));var e,n,r=Qy(t.r),i=Qy(t.g),o=Qy(t.b),a=Ky((.2225045*r+.7168786*i+.0606169*o)/1);return r===i&&i===o?e=n=a:(e=Ky((.4360747*r+.3850649*i+.1430804*o)/.96422),n=Ky((.0139322*r+.0971045*i+.7141733*o)/.82521)),new Xy(116*a-16,500*(e-a),200*(a-n),t.opacity)}function Gy(t,e,n,r){return 1===arguments.length?Hy(t):new Xy(t,e,n,null==r?1:r)}function Xy(t,e,n,r){this.l=+t,this.a=+e,this.b=+n,this.opacity=+r}function Ky(t){return t>6/29*(6/29)*(6/29)?Math.pow(t,1/3):t/(6/29*3*(6/29))+4/29}function Yy(t){return t>6/29?t*t*t:6/29*3*(6/29)*(t-4/29)}function Zy(t){return 255*(t<=.0031308?12.92*t:1.055*Math.pow(t,1/2.4)-.055)}function Qy(t){return(t/=255)<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}function Jy(t){if(t instanceof ev)return new ev(t.h,t.c,t.l,t.opacity);if(t instanceof Xy||(t=Hy(t)),0===t.a&&0===t.b)return new ev(NaN,0<t.l&&t.l<100?0:NaN,t.l,t.opacity);var e=Math.atan2(t.b,t.a)*qy;return new ev(e<0?e+360:e,Math.sqrt(t.a*t.a+t.b*t.b),t.l,t.opacity)}function tv(t,e,n,r){return 1===arguments.length?Jy(t):new ev(t,e,n,null==r?1:r)}function ev(t,e,n,r){this.h=+t,this.c=+e,this.l=+n,this.opacity=+r}function nv(t){if(isNaN(t.h))return new Xy(t.l,0,0,t.opacity);var e=t.h*Wy;return new Xy(t.l,Math.cos(e)*t.c,Math.sin(e)*t.c,t.opacity)}function rv(t,e){var n=gg((t=Gy(t)).l,(e=Gy(e)).l),r=gg(t.a,e.a),i=gg(t.b,e.b),o=gg(t.opacity,e.opacity);return function(e){return t.l=n(e),t.a=r(e),t.b=i(e),t.opacity=o(e),t+""}}function iv(t){return function(e,n){var r=t((e=tv(e)).h,(n=tv(n)).h),i=gg(e.c,n.c),o=gg(e.l,n.l),a=gg(e.opacity,n.opacity);return function(t){return e.h=r(t),e.c=i(t),e.l=o(t),e.opacity=a(t),e+""}}}Mm(Xy,Gy,Fm(Pm,{brighter:function(t){return new Xy(this.l+18*(null==t?1:t),this.a,this.b,this.opacity)},darker:function(t){return new Xy(this.l-18*(null==t?1:t),this.a,this.b,this.opacity)},rgb:function(){var t=(this.l+16)/116,e=isNaN(this.a)?t:t+this.a/500,n=isNaN(this.b)?t:t-this.b/200;return new eg(Zy(3.1338561*(e=.96422*Yy(e))-1.6168667*(t=1*Yy(t))-.4906146*(n=.82521*Yy(n))),Zy(-.9787684*e+1.9161415*t+.033454*n),Zy(.0719453*e-.2289914*t+1.4052427*n),this.opacity)}})),Mm(ev,tv,Fm(Pm,{brighter:function(t){return new ev(this.h,this.c,this.l+18*(null==t?1:t),this.opacity)},darker:function(t){return new ev(this.h,this.c,this.l-18*(null==t?1:t),this.opacity)},rgb:function(){return nv(this).rgb()}}));var ov=iv(mg),av=iv(gg),sv=1.97294,uv=-.90649*sv,lv=1.78277*sv,cv=-.6557636667999999;function hv(t){if(t instanceof fv)return new fv(t.h,t.s,t.l,t.opacity);t instanceof eg||(t=Jm(t));var e=t.g/255,n=t.b/255,r=(cv*n+uv*(t.r/255)-lv*e)/(cv+uv-lv),i=n-r,o=(sv*(e-r)- -.29227*i)/-.90649,a=Math.sqrt(o*o+i*i)/(sv*r*(1-r)),s=a?Math.atan2(o,i)*qy-120:NaN;return new fv(s<0?s+360:s,a,r,t.opacity)}function dv(t,e,n,r){return 1===arguments.length?hv(t):new fv(t,e,n,null==r?1:r)}function fv(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}function pv(t){return function e(n){function r(e,r){var i=t((e=dv(e)).h,(r=dv(r)).h),o=gg(e.s,r.s),a=gg(e.l,r.l),s=gg(e.opacity,r.opacity);return function(t){return e.h=i(t),e.s=o(t),e.l=a(Math.pow(t,n)),e.opacity=s(t),e+""}}return n=+n,r.gamma=e,r}(1)}Mm(fv,dv,Fm(Pm,{brighter:function(t){return t=null==t?1/.7:Math.pow(1/.7,t),new fv(this.h,this.s,this.l*t,this.opacity)},darker:function(t){return t=null==t?.7:Math.pow(.7,t),new fv(this.h,this.s,this.l*t,this.opacity)},rgb:function(){var t=isNaN(this.h)?0:(this.h+120)*Wy,e=+this.l,n=isNaN(this.s)?0:this.s*e*(1-e),r=Math.cos(t),i=Math.sin(t);return new eg(255*(e+n*(-.14861*r+1.78277*i)),255*(e+n*(-.29227*r+-.90649*i)),255*(e+n*(sv*r)),this.opacity)}}));var mv=pv(mg),gv=pv(gg),yv=function(t,e){for(var n=new Array(e),r=0;r<e;++r)n[r]=t(r/(e-1));return n};const vv=["clamp","base","constant","exponent"];function bv(t,e){const n=e[0],r=en(e)-n;return function(e){return t(n+e*r)}}function wv(t,e,n){return dy(Cv(e||"rgb",n),t)}function xv(t,e){const n=new Array(e),r=e+1;for(let i=0;i<e;)n[i]=t(++i/r);return n}function _v(t,e,n){let r,i,o,a=n-e;return a&&Number.isFinite(a)?(r=(i=t.type).indexOf("-"),i=r<0?i:i.slice(r+1),o=yy(i)().domain([e,n]).range([0,1]),vv.forEach(e=>t[e]?o[e](t[e]()):0),o):_n(.5)}function Cv(t,e){const n=a[function(t){return"interpolate"+t.toLowerCase().split("-").map((function(t){return t[0].toUpperCase()+t.slice(1)})).join("")}(t)];return null!=e&&n&&n.gamma?n.gamma(e):n}function kv(t){const e=t.length/6|0,n=new Array(e);for(let r=0;r<e;)n[r]="#"+t.slice(6*r,6*++r);return n}function Sv(t,e){for(const n in t)Ov(n,e(t[n]))}const Ev={};function Ov(t,e){return t=t&&t.toLowerCase(),arguments.length>1?(Ev[t]=e,this):Ev[t]}Sv({category10:"1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf",category20:"1f77b4aec7e8ff7f0effbb782ca02c98df8ad62728ff98969467bdc5b0d58c564bc49c94e377c2f7b6d27f7f7fc7c7c7bcbd22dbdb8d17becf9edae5",category20b:"393b795254a36b6ecf9c9ede6379398ca252b5cf6bcedb9c8c6d31bd9e39e7ba52e7cb94843c39ad494ad6616be7969c7b4173a55194ce6dbdde9ed6",category20c:"3182bd6baed69ecae1c6dbefe6550dfd8d3cfdae6bfdd0a231a35474c476a1d99bc7e9c0756bb19e9ac8bcbddcdadaeb636363969696bdbdbdd9d9d9",tableau10:"4c78a8f58518e4575672b7b254a24beeca3bb279a2ff9da69d755dbab0ac",tableau20:"4c78a89ecae9f58518ffbf7954a24b88d27ab79a20f2cf5b43989483bcb6e45756ff9d9879706ebab0acd67195fcbfd2b279a2d6a5c99e765fd8b5a5",accent:"7fc97fbeaed4fdc086ffff99386cb0f0027fbf5b17666666",dark2:"1b9e77d95f027570b3e7298a66a61ee6ab02a6761d666666",paired:"a6cee31f78b4b2df8a33a02cfb9a99e31a1cfdbf6fff7f00cab2d66a3d9affff99b15928",pastel1:"fbb4aeb3cde3ccebc5decbe4fed9a6ffffcce5d8bdfddaecf2f2f2",pastel2:"b3e2cdfdcdaccbd5e8f4cae4e6f5c9fff2aef1e2cccccccc",set1:"e41a1c377eb84daf4a984ea3ff7f00ffff33a65628f781bf999999",set2:"66c2a5fc8d628da0cbe78ac3a6d854ffd92fe5c494b3b3b3",set3:"8dd3c7ffffb3bebadafb807280b1d3fdb462b3de69fccde5d9d9d9bc80bdccebc5ffed6f"},kv),Sv({blues:"cfe1f2bed8eca8cee58fc1de74b2d75ba3cf4592c63181bd206fb2125ca40a4a90",greens:"d3eecdc0e6baabdda594d3917bc77d60ba6c46ab5e329a512089430e7735036429",greys:"e2e2e2d4d4d4c4c4c4b1b1b19d9d9d8888887575756262624d4d4d3535351e1e1e",oranges:"fdd8b3fdc998fdb87bfda55efc9244f87f2cf06b18e4580bd14904b93d029f3303",purples:"e2e1efd4d4e8c4c5e0b4b3d6a3a0cc928ec3827cb97566ae684ea25c3696501f8c",reds:"fdc9b4fcb49afc9e80fc8767fa7051f6573fec3f2fdc2a25c81b1db21218970b13",blueGreen:"d5efedc1e8e0a7ddd18bd2be70c6a958ba9144ad77319c5d2089460e7736036429",bluePurple:"ccddecbad0e4a8c2dd9ab0d4919cc98d85be8b6db28a55a6873c99822287730f71",greenBlue:"d3eecec5e8c3b1e1bb9bd8bb82cec269c2ca51b2cd3c9fc7288abd1675b10b60a1",orangeRed:"fddcaffdcf9bfdc18afdad77fb9562f67d53ee6545e24932d32d1ebf130da70403",purpleBlue:"dbdaebc8cee4b1c3de97b7d87bacd15b9fc93a90c01e7fb70b70ab056199045281",purpleBlueGreen:"dbd8eac8cee4b0c3de93b7d872acd1549fc83892bb1c88a3097f8702736b016353",purpleRed:"dcc9e2d3b3d7ce9eccd186c0da6bb2e14da0e23189d91e6fc61159ab07498f023a",redPurple:"fccfccfcbec0faa9b8f98faff571a5ec539ddb3695c41b8aa908808d0179700174",yellowGreen:"e4f4acd1eca0b9e2949ed68880c97c62bb6e47aa5e3297502083440e723b036034",yellowOrangeBrown:"feeaa1fedd84fecc63feb746fca031f68921eb7215db5e0bc54c05ab3d038f3204",yellowOrangeRed:"fee087fed16ffebd59fea849fd903efc7335f9522bee3423de1b20ca0b22af0225",blueOrange:"134b852f78b35da2cb9dcae1d2e5eff2f0ebfce0bafbbf74e8932fc5690d994a07",brownBlueGreen:"704108a0651ac79548e3c78af3e6c6eef1eac9e9e48ed1c74da79e187a72025147",purpleGreen:"5b1667834792a67fb6c9aed3e6d6e8eff0efd9efd5aedda971bb75368e490e5e29",purpleOrange:"4114696647968f83b7b9b4d6dadbebf3eeeafce0bafbbf74e8932fc5690d994a07",redBlue:"8c0d25bf363adf745ef4ae91fbdbc9f2efeed2e5ef9dcae15da2cb2f78b3134b85",redGrey:"8c0d25bf363adf745ef4ae91fcdccbfaf4f1e2e2e2c0c0c0969696646464343434",yellowGreenBlue:"eff9bddbf1b4bde5b594d5b969c5be45b4c22c9ec02182b82163aa23479c1c3185",redYellowBlue:"a50026d4322cf16e43fcac64fedd90faf8c1dcf1ecabd6e875abd04a74b4313695",redYellowGreen:"a50026d4322cf16e43fcac63fedd8df9f7aed7ee8ea4d86e64bc6122964f006837",pinkYellowGreen:"8e0152c0267edd72adf0b3d6faddedf5f3efe1f2cab6de8780bb474f9125276419",spectral:"9e0142d13c4bf0704afcac63fedd8dfbf8b0e0f3a1a9dda269bda94288b55e4fa2",viridis:"440154470e61481a6c482575472f7d443a834144873d4e8a39568c35608d31688e2d708e2a788e27818e23888e21918d1f988b1fa08822a8842ab07f35b77943bf7154c56866cc5d7ad1518fd744a5db36bcdf27d2e21be9e51afde725",magma:"0000040404130b0924150e3720114b2c11603b0f704a107957157e651a80721f817f24828c29819a2e80a8327db6377ac43c75d1426fde4968e95462f1605df76f5cfa7f5efc8f65fe9f6dfeaf78febf84fece91fddea0fcedaffcfdbf",inferno:"0000040403130c0826170c3b240c4f330a5f420a68500d6c5d126e6b176e781c6d86216b932667a12b62ae305cbb3755c73e4cd24644dd513ae65c30ed6925f3771af8850ffb9506fca50afcb519fac62df6d645f2e661f3f484fcffa4",plasma:"0d088723069033059742039d5002a25d01a66a00a87801a88405a7900da49c179ea72198b12a90ba3488c33d80cb4779d35171da5a69e16462e76e5bed7953f2834cf68f44fa9a3dfca636fdb32ffec029fcce25f9dc24f5ea27f0f921",rainbow:"6e40aa883eb1a43db3bf3cafd83fa4ee4395fe4b83ff576eff6659ff7847ff8c38f3a130e2b72fcfcc36bee044aff05b8ff4576ff65b52f6673af27828ea8d1ddfa319d0b81cbecb23abd82f96e03d82e14c6edb5a5dd0664dbf6e40aa",sinebow:"ff4040fc582af47218e78d0bd5a703bfbf00a7d5038de70b72f41858fc2a40ff402afc5818f4720be78d03d5a700bfbf03a7d50b8de71872f42a58fc4040ff582afc7218f48d0be7a703d5bf00bfd503a7e70b8df41872fc2a58ff4040",browns:"eedbbdecca96e9b97ae4a865dc9856d18954c7784cc0673fb85536ad44339f3632",tealBlues:"bce4d89dd3d181c3cb65b3c245a2b9368fae347da0306a932c5985",teals:"bbdfdfa2d4d58ac9c975bcbb61b0af4da5a43799982b8b8c1e7f7f127273006667",warmGreys:"dcd4d0cec5c1c0b8b4b3aaa7a59c9998908c8b827f7e7673726866665c5a59504e",goldGreen:"f4d166d5ca60b6c35c98bb597cb25760a6564b9c533f8f4f33834a257740146c36",goldOrange:"f4d166f8be5cf8aa4cf5983bf3852aef701be2621fd65322c54923b142239e3a26",goldRed:"f4d166f6be59f9aa51fc964ef6834bee734ae56249db5247cf4244c43141b71d3e",lightGreyRed:"efe9e6e1dad7d5cbc8c8bdb9bbaea9cd967ddc7b43e15f19df4011dc000b",lightGreyTeal:"e4eaead6dcddc8ced2b7c2c7a6b4bc64b0bf22a6c32295c11f85be1876bc",lightMulti:"e0f1f2c4e9d0b0de9fd0e181f6e072f6c053f3993ef77440ef4a3c",lightOrange:"f2e7daf7d5baf9c499fab184fa9c73f68967ef7860e8645bde515bd43d5b",lightTealBlue:"e3e9e0c0dccf9aceca7abfc859afc0389fb9328dad2f7ca0276b95255988",darkBlue:"3232322d46681a5c930074af008cbf05a7ce25c0dd38daed50f3faffffff",darkGold:"3c3c3c584b37725e348c7631ae8b2bcfa424ecc31ef9de30fff184ffffff",darkGreen:"3a3a3a215748006f4d048942489e4276b340a6c63dd2d836ffeb2cffffaa",darkMulti:"3737371f5287197d8c29a86995ce3fffe800ffffff",darkRed:"3434347036339e3c38cc4037e75d1eec8620eeab29f0ce32ffeb2c"},t=>wv(kv(t)));const Av=t=>Ye(t)?t.map(t=>String(t)):String(t),Nv=(t,e)=>t[1]-e[1],Tv=(t,e)=>e[1]-t[1];function Dv(t,e,n){let r;return In(e)&&(t.bins&&(e=Math.max(e,t.bins.length)),null!=n&&(e=Math.min(e,Math.floor(jn(t.domain())/n||1)))),Ze(e)&&(r=e.step,e=e.interval),Mn(e)&&(e=t.type===ym?Fo(e):t.type==vm?Po(e):Be("Only time and utc scales accept interval strings."),r&&(e=e.every(r))),e}function Rv(t,e,n){let r=t.range(),i=r[0],o=en(r),a=Nv;if(i>o&&(r=o,o=i,i=r,a=Tv),i=Math.floor(i),o=Math.ceil(o),e=e.map(e=>[e,t(e)]).filter(t=>i<=t[1]&&t[1]<=o).sort(a).map(t=>t[0]),n>0&&e.length>1){const t=[e[0],en(e)];for(;e.length>n&&e.length>=3;)e=e.filter((t,e)=>!(e%2));e.length<3&&(e=t)}return e}function Iv(t,e){return t.bins?Rv(t,t.bins):t.ticks?t.ticks(e):t.domain()}function Mv(t,e,n,r,i,o){const a=e.type;let s=Av;if(a===ym||i===ym)s=t.timeFormat(r);else if(a===vm||i===vm)s=t.utcFormat(r);else if(Cy(a)){const i=t.formatFloat(r);if(o||e.bins)s=i;else{const t=Fv(e,n,!1);s=e=>t(e)?i(e):""}}else if(e.tickFormat){const i=e.domain();s=t.formatSpan(i[0],i[i.length-1],n,r)}else r&&(s=t.format(r));return s}function Fv(t,e,n){const r=Iv(t,e),i=t.base(),o=Math.log(i),a=Math.max(1,i*e/r.length),s=t=>{let e=t/Math.pow(i,Math.round(Math.log(t)/o));return e*i<i-.5&&(e*=i),e<=a};return n?r.filter(s):s}const Pv={quantile:"quantiles",quantize:"thresholds",threshold:"domain"},jv={quantile:"quantiles",quantize:"domain"};function zv(t,e){return t.bins?function(t){const e=t.slice(0,-1);return e.max=en(t),e}(t.bins):t.type===gm?Fv(t,e,!0):Pv[t.type]?function(t){const e=[-1/0].concat(t);return e.max=1/0,e}(t[Pv[t.type]]()):Iv(t,e)}function Lv(t,e,n,r,i,o,a){const s=jv[e.type]&&o!==ym&&o!==vm?function(t,e,n){let r,i=e[jv[e.type]](),o=i.length,a=o>1?i[1]-i[0]:i[0];for(r=1;r<o;++r)a=Math.min(a,i[r]-i[r-1]);return t.formatSpan(0,a,30,n)}(t,e,i):Mv(t,e,n,i,o,a);return"symbol"===r&&(t=>Pv[t.type]||t.bins)(e)?Bv(s):"discrete"===r?$v(s):Vv(s)}const Bv=t=>(e,n,r)=>{const i=Uv(r[n+1],Uv(r.max,1/0)),o=Wv(e,t),a=Wv(i,t);return o&&a?o+" \u2013 "+a:a?"< "+a:"\u2265 "+o},Uv=(t,e)=>null!=t?t:e,$v=t=>(e,n)=>n?t(e):null,Vv=t=>e=>t(e),Wv=(t,e)=>Number.isFinite(t)?e(t):null;function qv(t,e,n){n=n||{};const r=Math.max(3,n.maxlen||7),i=function(t,e,n,r){const i=r||e.type;return Mn(n)&&by(i,"temporal")&&(n=n.replace(/%a/g,"%A").replace(/%b/g,"%B")),n||i!==ym?n||i!==vm?Lv(t,e,5,null,n,r,!0):t.utcFormat("%A, %d %B %Y, %X UTC"):t.timeFormat("%A, %d %B %Y, %X")}(t,e,n.format,n.formatType);if(_y(e.type)){const t=zv(e).slice(1).map(i),n=t.length;return`${n} boundar${1===n?"y":"ies"}: ${t.join(", ")}`}if(xy(e.type)){const t=e.domain(),n=t.length;return`${n} value${1===n?"":"s"}: ${n>r?t.slice(0,r-2).map(i).join(", ")+", ending with "+t.slice(-1).map(i):t.map(i).join(", ")}`}{const t=e.domain();return`values from ${i(t[0])} to ${i(en(t))}`}}const Hv=(t,e,n)=>({role:t,"aria-roledescription":e,"aria-label":n||void 0}),Gv=Vn(["axis-domain","axis-grid","axis-label","axis-tick","axis-title","legend-band","legend-entry","legend-gradient","legend-label","legend-title","legend-symbol","title"]),Xv={axis:{desc:"axis",caption:function(t){const e=t.datum,n=t.orient,r=e.title?Jv(t):null,i=t.context,o=i.scales[e.scale].value,a=i.dataflow.locale(),s=o.type;return("left"===n||"right"===n?"Y":"X")+"-axis"+(r?` titled '${r}'`:"")+` for a ${xy(s)?"discrete":s} scale with `+qv(a,o,t)}},legend:{desc:"legend",caption:function(t){const e=t.datum,n=e.title?Jv(t):null,r=((e.type||"")+" legend").trim(),i=e.scales,o=Object.keys(i),a=t.context,s=a.scales[i[o[0]]].value,u=a.dataflow.locale();return((l=r).length?l[0].toUpperCase()+l.slice(1):l)+(n?` titled '${n}'`:"")+" for "+function(t){return(t=t.map(t=>t+("fill"===t||"stroke"===t?" color":""))).length<2?t[0]:t.slice(0,-1).join(", ")+" and "+en(t)}(o)+" with "+qv(u,s,t);var l}},"title-text":{desc:"title",caption:t=>`Title text '${Qv(t)}'`},"title-subtitle":{desc:"subtitle",caption:t=>`Subtitle text '${Qv(t)}'`}},Kv={ariaRole:"role",ariaRoleDescription:"aria-roledescription",description:"aria-label"};function Yv(t,e){const n=!1===e.aria;if(t("aria-hidden",n||void 0),n||null==e.description)for(const r in Kv)t(Kv[r],void 0);else{const n=e.mark.marktype;t("aria-label",e.description),t("role",e.ariaRole||("group"===n?"graphics-object":"graphics-symbol")),t("aria-roledescription",e.ariaRoleDescription||n+" mark")}}function Zv(t){return!1===t.aria?{"aria-hidden":!0}:Gv[t.role]?null:Xv[t.role]?function(t,e){try{const n=t.items[0],r=e.caption||(()=>"");return Hv(e.role||"graphics-symbol",e.desc,n.description||r(n))}catch(n){return null}}(t,Xv[t.role]):function(t){const e=t.marktype,n="group"===e||"text"===e||t.items.some(t=>null!=t.description&&!1!==t.aria);return Hv(n?"graphics-object":"graphics-symbol",e+" mark container",t.description)}(t)}function Qv(t){return mn(t.text).join(" ")}function Jv(t){try{return mn(en(t.items).items[0].text).join(" ")}catch(e){return null}}const tb=t=>(t+"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;");function eb(){let t="",e="",n="";const r=[],i=()=>e=n="",o=(t,n)=>{var r;return null!=n&&(e+=` ${t}="${r=n,tb(r).replace(/"/g,"&quot;").replace(/\t/g,"&#x9;").replace(/\n/g,"&#xA;").replace(/\r/g,"&#xD;")}"`),a},a={open(s,...u){(o=>{e&&(t+=`${e}>${n}`,i()),r.push(o)})(s),e="<"+s;for(const t of u)for(const e in t)o(e,t[e]);return a},close(){const o=r.pop();return t+=e?e+(n?`>${n}</${o}>`:"/>"):`</${o}>`,i(),a},attr:o,text:t=>(n+=tb(t),a),toString:()=>t};return a}const nb={fill:"fill",fillOpacity:"fill-opacity",stroke:"stroke",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",strokeCap:"stroke-linecap",strokeJoin:"stroke-linejoin",strokeDash:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",strokeMiterLimit:"stroke-miterlimit",opacity:"opacity",blend:"mix-blend-mode"},rb={fill:"none","stroke-miterlimit":10},ib=ep.xmlns;function ob(t){Zp.call(this,t),this._dirtyID=0,this._dirty=[],this._svg=null,this._root=null,this._defs=null}const ab=Zp.prototype;function sb(t,e){for(;t&&t.dirty!==e;t=t.mark.group){if(t.dirty=e,!t.mark||t.mark.dirty===e)return;t.mark.dirty=e}}function ub(t,e,n){let r,i,o;if("radial"===e.gradient){let r=qp(t,n++,"pattern",ib);gb(r,{id:"p_"+e.id,viewBox:"0,0,1,1",width:"100%",height:"100%",preserveAspectRatio:"xMidYMid slice"}),r=qp(r,0,"rect",ib),gb(r,{width:1,height:1,fill:`url(${vb()}#${e.id})`}),gb(t=qp(t,n++,"radialGradient",ib),{id:e.id,fx:e.x1,fy:e.y1,fr:e.r1,cx:e.x2,cy:e.y2,r:e.r2})}else gb(t=qp(t,n++,"linearGradient",ib),{id:e.id,x1:e.x1,x2:e.x2,y1:e.y1,y2:e.y2});for(r=0,i=e.stops.length;r<i;++r)o=qp(t,r,"stop",ib),o.setAttribute("offset",e.stops[r].offset),o.setAttribute("stop-color",e.stops[r].color);return Hp(t,r),n}function lb(t,e,n){let r;return(t=qp(t,n,"clipPath",ib)).setAttribute("id",e.id),e.path?(r=qp(t,0,"path",ib),r.setAttribute("d",e.path)):(r=qp(t,0,"rect",ib),gb(r,{x:0,y:0,width:e.width,height:e.height})),Hp(t,1),n+1}function cb(t,e,n,r,i){let o,a=t._svg;if(!a&&(o=e.ownerDocument,a=Vp(o,r,ib),t._svg=a,t.mark&&(a.__data__=t,a.__values__={fill:"default"},"g"===r))){const e=Vp(o,"path",ib);a.appendChild(e),e.__data__=t;const n=Vp(o,"g",ib);a.appendChild(n),n.__data__=t;const r=Vp(o,"path",ib);a.appendChild(r),r.__data__=t,r.__values__={fill:"default"}}return(a.ownerSVGElement!==i||function(t,e){return t.parentNode&&t.parentNode.childNodes.length>1&&t.previousSibling!=e}(a,n))&&e.insertBefore(a,n?n.nextSibling:e.firstChild),a}Tn(ob,Zp,{initialize(t,e,n,r,i){return this._defs={},this._clearDefs(),t&&(this._svg=qp(t,0,"svg",ib),gb(this._svg,ep),this._svg.setAttribute("class","marks"),Hp(t,1),this._root=qp(this._svg,0,"g",ib),gb(this._root,rb),Hp(this._svg,1)),this.background(this._bgcolor),ab.initialize.call(this,t,e,n,r,i)},background(t){return arguments.length&&this._svg&&this._svg.style.setProperty("background-color",t),ab.background.apply(this,arguments)},resize(t,e,n,r){return ab.resize.call(this,t,e,n,r),this._svg&&(gb(this._svg,{width:this._width*this._scale,height:this._height*this._scale,viewBox:`0 0 ${this._width} ${this._height}`}),this._root.setAttribute("transform",`translate(${this._origin})`)),this._dirty=[],this},canvas(){return this._svg},svg(){const t=this._svg,e=this._bgcolor;if(!t)return null;let n;e&&(t.removeAttribute("style"),n=qp(t,0,"rect",ib),gb(n,{width:this._width,height:this._height,fill:e}));const r=(t=>function t(e,n){if(e.open(n.tagName),n.hasAttributes()){const t=n.attributes,r=t.length;for(let n=0;n<r;++n)e.attr(t[n].name,t[n].value)}if(n.hasChildNodes()){const r=n.childNodes,i=r.length;for(let n=0;n<i;n++){const i=r[n];3===i.nodeType?e.text(i.nodeValue):t(e,i)}}return e.close()}(eb(),t)+"")(t);return e&&(t.removeChild(n),this._svg.style.setProperty("background-color",e)),r},_render(t){return this._dirtyCheck()&&(this._dirtyAll&&this._clearDefs(),this.mark(this._root,t),Hp(this._root,1)),this.defs(),this._dirty=[],++this._dirtyID,this},dirty(t){t.dirty!==this._dirtyID&&(t.dirty=this._dirtyID,this._dirty.push(t))},isDirty(t){return this._dirtyAll||!t._svg||t.dirty===this._dirtyID},_dirtyCheck(){this._dirtyAll=!0;const t=this._dirty;if(!t.length||!this._dirtyID)return!0;let e,n,r,i,o,a,s,u=++this._dirtyID;for(o=0,a=t.length;o<a;++o)e=t[o],n=e.mark,n.marktype!==r&&(r=n.marktype,i=Pp[r]),n.zdirty&&n.dirty!==u&&(this._dirtyAll=!1,sb(e,u),n.items.forEach((function(t){t.dirty=u}))),n.zdirty||(e.exit?(i.nested&&n.items.length?(s=n.items[0],s._svg&&this._update(i,s._svg,s)):e._svg&&(s=e._svg.parentNode,s&&s.removeChild(e._svg)),e._svg=null):(e=i.nested?n.items[0]:e,e._update!==u&&(e._svg&&e._svg.ownerSVGElement?this._update(i,e._svg,e):(this._dirtyAll=!1,sb(e,u)),e._update=u)));return!this._dirtyAll},mark(t,e,n){if(!this.isDirty(e))return e._svg;let r,i=this._svg,o=Pp[e.marktype],a=!1===e.interactive?"none":null,s="g"===o.tag,u=null,l=0;r=cb(e,t,n,"g",i),r.setAttribute("class",Gp(e));const c=Zv(e);for(const d in c)yb(r,d,c[d]);s||yb(r,"pointer-events",a),yb(r,"clip-path",e.clip?Ld(this,e,e.group):null);const h=t=>{const e=this.isDirty(t),n=cb(t,r,u,o.tag,i);e&&(this._update(o,n,t),s&&function(t,e,n){e=e.lastChild.previousSibling;let r,i=0;If(n,n=>{r=t.mark(e,n,r),++i}),Hp(e,1+i)}(this,n,t)),u=n,++l};return o.nested?e.items.length&&h(e.items[0]):If(e,h),Hp(r,l),r},_update(t,e,n){hb=e,db=e.__values__,Yv(pb,n),t.attr(pb,n,this);const r=fb[t.type];r&&r.call(this,t,e,n),hb&&this.style(hb,n)},style(t,e){if(null!=e)for(const n in nb){let r="font"===n?Np(e):e[n];if(r===db[n])continue;const i=nb[n];null==r?t.removeAttribute(i):(Ec(r)&&(r=Oc(r,this._defs.gradient,vb())),t.setAttribute(i,r+"")),db[n]=r}},defs(){const t=this._svg,e=this._defs;let n=e.el,r=0;for(const i in e.gradient)n||(e.el=n=qp(t,1,"defs",ib)),r=ub(n,e.gradient[i],r);for(const i in e.clipping)n||(e.el=n=qp(t,1,"defs",ib)),r=lb(n,e.clipping[i],r);n&&(0===r?(t.removeChild(n),e.el=null):Hp(n,r))},_clearDefs(){const t=this._defs;t.gradient={},t.clipping={}}});let hb=null,db=null;const fb={group(t,e,n){const r=hb=e.childNodes[2];db=r.__values__,t.foreground(pb,n,this),db=e.__values__,hb=e.childNodes[1],t.content(pb,n,this);const i=hb=e.childNodes[0];t.background(pb,n,this);const o=!1===n.mark.interactive?"none":null;if(o!==db.events&&(yb(r,"pointer-events",o),yb(i,"pointer-events",o),db.events=o),n.strokeForeground&&n.stroke){const t=n.fill;yb(r,"display",null),this.style(i,n),yb(i,"stroke",null),t&&(n.fill=null),db=r.__values__,this.style(r,n),t&&(n.fill=t),hb=null}else yb(r,"display","none")},image(t,e,n){!1===n.smooth?(mb(e,"image-rendering","optimizeSpeed"),mb(e,"image-rendering","pixelated")):mb(e,"image-rendering",null)},text(t,e,n){let r,i,o,a,s=Ep(n);Ye(s)?(i=s.map(t=>Ap(n,t)),r=i.join("\n"),r!==db.text&&(Hp(e,0),o=e.ownerDocument,a=Sp(n),i.forEach((t,r)=>{const i=Vp(o,"tspan",ib);i.__data__=n,i.textContent=t,r&&(i.setAttribute("x",0),i.setAttribute("dy",a)),e.appendChild(i)}),db.text=r)):(i=Ap(n,s),i!==db.text&&(e.textContent=i,db.text=i)),yb(e,"font-family",Np(n)),yb(e,"font-size",kp(n)+"px"),yb(e,"font-style",n.fontStyle),yb(e,"font-variant",n.fontVariant),yb(e,"font-weight",n.fontWeight)}};function pb(t,e,n){e!==db[t]&&(n?function(t,e,n,r){null!=n?t.setAttributeNS(r,e,n):t.removeAttributeNS(r,e)}(hb,t,e,n):yb(hb,t,e),db[t]=e)}function mb(t,e,n){n!==db[e]&&(null==n?t.style.removeProperty(e):t.style.setProperty(e,n+""),db[e]=n)}function gb(t,e){for(const n in e)yb(t,n,e[n])}function yb(t,e,n){null!=n?t.setAttribute(e,n):t.removeAttribute(e)}function vb(){let t;return"undefined"==typeof window?"":(t=window.location).hash?t.href.slice(0,-t.hash.length):t.href}function bb(t){Zp.call(this,t),this._text=null,this._defs={gradient:{},clipping:{}}}Tn(bb,Zp,{svg(){return this._text},_render(t){const e=eb();e.open("svg",kn({},ep,{class:"marks",width:this._width*this._scale,height:this._height*this._scale,viewBox:`0 0 ${this._width} ${this._height}`}));const n=this._bgcolor;return n&&"transparent"!==n&&"none"!==n&&e.open("rect",{width:this._width,height:this._height,fill:n}).close(),e.open("g",rb,{transform:"translate("+this._origin+")"}),this.mark(e,t),e.close(),this.defs(e),this._text=e.close()+"",this},mark(t,e){const n=Pp[e.marktype],r=n.tag,i=[Yv,n.attr];t.open("g",{class:Gp(e),"clip-path":e.clip?Ld(this,e,e.group):null},Zv(e),{"pointer-events":"g"!==r&&!1===e.interactive?"none":null});const o=o=>{const a=this.href(o);if(a&&t.open("a",a),t.open(r,this.attr(e,o,i,"g"!==r?r:null)),"text"===r){const e=Ep(o);if(Ye(e)){const n={x:0,dy:Sp(o)};for(let r=0;r<e.length;++r)t.open("tspan",r?n:null).text(Ap(o,e[r])).close()}else t.text(Ap(o,e))}else if("g"===r){const r=o.strokeForeground,i=o.fill,a=o.stroke;r&&a&&(o.stroke=null),t.open("path",this.attr(e,o,n.background,"bgrect")).close(),t.open("g",this.attr(e,o,n.content)),If(o,e=>this.mark(t,e)),t.close(),r&&a?(i&&(o.fill=null),o.stroke=a,t.open("path",this.attr(e,o,n.foreground,"bgrect")).close(),i&&(o.fill=i)):t.open("path",this.attr(e,o,n.foreground,"bgfore")).close()}t.close(),a&&t.close()};return n.nested?e.items&&e.items.length&&o(e.items[0]):If(e,o),t.close()},href(t){let e,n=t.href;if(n){if(e=this._hrefs&&this._hrefs[n])return e;this.sanitizeURL(n).then(t=>{t["xlink:href"]=t.href,t.href=null,(this._hrefs||(this._hrefs={}))[n]=t})}return null},attr(t,e,n,r){const i={},o=(t,e,n,r)=>{i[r||t]=e};return Array.isArray(n)?n.forEach(t=>t(o,e,this)):n(o,e,this),r&&function(t,e,n,r,i){if(null==e)return t;if("bgrect"===r&&!1===n.interactive&&(t["pointer-events"]="none"),"bgfore"===r&&(!1===n.interactive&&(t["pointer-events"]="none"),t.display="none",null!==e.fill))return t;"image"===r&&!1===e.smooth&&(t.style="image-rendering: optimizeSpeed; image-rendering: pixelated;"),"text"===r&&(t["font-family"]=Np(e),t["font-size"]=kp(e)+"px",t["font-style"]=e.fontStyle,t["font-variant"]=e.fontVariant,t["font-weight"]=e.fontWeight);for(const o in nb){let n=e[o];const r=nb[o];("transparent"!==n||"fill"!==r&&"stroke"!==r)&&null!=n&&(Ec(n)&&(n=Oc(n,i.gradient,"")),t[r]=n)}}(i,e,t,r,this._defs),i},defs(t){const e=this._defs.gradient,n=this._defs.clipping;if(0!==Object.keys(e).length+Object.keys(n).length){t.open("defs");for(const n in e){const r=e[n],i=r.stops;"radial"===r.gradient?(t.open("pattern",{id:"p_"+n,viewBox:"0,0,1,1",width:"100%",height:"100%",preserveAspectRatio:"xMidYMid slice"}),t.open("rect",{width:"1",height:"1",fill:"url(#"+n+")"}).close(),t.close(),t.open("radialGradient",{id:n,fx:r.x1,fy:r.y1,fr:r.r1,cx:r.x2,cy:r.y2,r:r.r2})):t.open("linearGradient",{id:n,x1:r.x1,x2:r.x2,y1:r.y1,y2:r.y2});for(let e=0;e<i.length;++e)t.open("stop",{offset:i[e].offset,"stop-color":i[e].color}).close();t.close()}for(const e in n){const r=n[e];t.open("clipPath",{id:e}),r.path?t.open("path",{d:r.path}).close():t.open("rect",{x:0,y:0,width:r.width,height:r.height}).close(),t.close()}t.close()}}});var wb={};function xb(t,e){return t=String(t||"").toLowerCase(),arguments.length>1?(wb[t]=e,this):wb[t]}function _b(t,e,n,r){if(function(t,e,n){return t.bounds&&e.intersects(t.bounds)&&("group"===t.marktype||!1!==t.interactive&&(!n||n(t)))}(t,e,n)){const i=t.items,o=t.marktype,a=i.length;let s=0;if("group"===o)for(;s<a;++s)Cb(i[s],e,n,r);else for(const t=Pp[o].isect;s<a;++s){let n=i[s];kb(n,e,t)&&r.push(n)}}return r}function Cb(t,e,n,r){n&&n(t.mark)&&kb(t,e,Pp.group.isect)&&r.push(t);const i=t.items,o=i&&i.length;if(o){const a=t.x||0,s=t.y||0;e.translate(-a,-s);for(let t=0;t<o;++t)_b(i[t],e,n,r);e.translate(a,s)}return r}function kb(t,e,n){const r=t.bounds;return e.encloses(r)||e.intersects(r)&&n(t,e)}wb.canvas=wb.png={renderer:hm,headless:hm,handler:am},wb.svg={renderer:ob,headless:bb,handler:fm},wb.none={};const Sb=new Bd;function Eb(t){Hs.call(this,null,t)}function Ob(t,e,n){return e(t.bounds.clear(),t,n)}function Ab(t){Hs.call(this,0,t)}function Nb(t){Hs.call(this,null,t)}function Tb(t){Hs.call(this,null,t)}Tn(Eb,Hs,{transform(t,e){const n=e.dataflow,r=t.mark,i=r.marktype,o=Pp[i],a=o.bound;let s,u=r.bounds;if(o.nested)r.items.length&&n.dirty(r.items[0]),u=Ob(r,a),r.items.forEach((function(t){t.bounds.clear().union(u)}));else if("group"===i||t.modified())switch(e.visit(e.MOD,t=>n.dirty(t)),u.clear(),r.items.forEach(t=>u.union(Ob(t,a))),r.role){case"axis":case"legend":case"title":e.reflow()}else s=e.changed(e.REM),e.visit(e.ADD,t=>{u.union(Ob(t,a))}),e.visit(e.MOD,t=>{s=s||u.alignsWith(t.bounds),n.dirty(t),u.union(Ob(t,a))}),s&&(u.clear(),r.items.forEach(t=>u.union(t.bounds)));return function(t){const e=t.clip;if(gn(e))e(ff(Sb.clear()));else{if(!e)return;Sb.set(0,0,t.group.width,t.group.height)}t.bounds.intersect(Sb)}(r),e.modifies("bounds")}}),Ab.Definition={type:"Identifier",metadata:{modifies:!0},params:[{name:"as",type:"string",required:!0}]},Tn(Ab,Hs,{transform(t,e){const n=(i=e.dataflow)._signals[":vega_identifier:"]||(i._signals[":vega_identifier:"]=i.add(0)),r=t.as;var i;let o=n.value;return e.visit(e.ADD,t=>t[r]=t[r]||++o),n.set(this.value=o),e}}),Tn(Nb,Hs,{transform(t,e){let n=this.value;n||(n=e.dataflow.scenegraph().mark(t.markdef,function(t){const e=t.groups,n=t.parent;return e&&1===e.size?e.get(Object.keys(e.object)[0]):e&&n?e.lookup(n):null}(t),t.index),n.group.context=t.context,t.context.group||(t.context.group=n.group),n.source=this.source,n.clip=t.clip,n.interactive=t.interactive,this.value=n);const r="group"===n.marktype?$d:Ud;return e.visit(e.ADD,t=>r.call(t,n)),(t.modified("clip")||t.modified("interactive"))&&(n.clip=t.clip,n.interactive=!!t.interactive,n.zdirty=!0,e.reflow()),n.items=e.source,e}});const Db={parity:t=>t.filter((t,e)=>e%2?t.opacity=0:1),greedy:(t,e)=>{let n;return t.filter((t,r)=>r&&Rb(n.bounds,t.bounds,e)?t.opacity=0:(n=t,1))}},Rb=(t,e,n)=>n>Math.max(e.x1-t.x2,t.x1-e.x2,e.y1-t.y2,t.y1-e.y2),Ib=(t,e)=>{for(var n,r=1,i=t.length,o=t[0].bounds;r<i;o=n,++r)if(Rb(o,n=t[r].bounds,e))return!0},Mb=t=>{var e=t.bounds;return e.width()>1&&e.height()>1},Fb=t=>(t.forEach(t=>t.opacity=1),t),Pb=(t,e)=>t.reflow(e.modified()).modifies("opacity");function jb(t){Hs.call(this,null,t)}Tn(Tb,Hs,{transform(t,e){let n,r,i,o=Db[t.method]||Db.parity,a=e.materialize(e.SOURCE).source,s=t.separation||0;if(a&&a.length){if(!t.method)return t.modified("method")&&(Fb(a),e=Pb(e,t)),e;if(a=a.filter(Mb),a.length){if(t.sort&&(a=a.slice().sort(t.sort)),n=Fb(a),e=Pb(e,t),n.length>=3&&Ib(n,s)){do{n=o(n,s)}while(n.length>=3&&Ib(n,s));n.length<3&&!en(a).opacity&&(n.length>1&&(en(n).opacity=0),en(a).opacity=1)}var u,l,c,h;return t.boundScale&&t.boundTolerance>=0&&(u=t.boundOrient,l=+t.boundTolerance,c=t.boundScale.range(),h=new Bd,u===wc||"bottom"===u?h.set(c[0],-1/0,c[1],1/0):h.set(-1/0,c[0],1/0,c[1]),h.expand(l||1),r=t=>h.encloses(t.bounds),a.forEach(t=>{r(t)||(t.opacity=0)})),i=n[0].mark.bounds.clear(),a.forEach(t=>{t.opacity&&i.union(t.bounds)}),e}}}}),Tn(jb,Hs,{transform(t,e){const n=e.dataflow;if(e.visit(e.ALL,t=>n.dirty(t)),e.fields&&e.fields.zindex){var r=e.source&&e.source[0];r&&(r.mark.zdirty=!0)}}});const zb=new Bd;function Lb(t,e,n){return t[e]===n?0:(t[e]=n,1)}function Bb(t){var e=t.items[0].orient;return e===xc||e===_c}function Ub(t,e,n,r){var i,o,a=e.items[0],s=a.datum,u=null!=a.translate?a.translate:.5,l=a.orient,c=function(t){var e=+t.grid;return[t.ticks?e++:-1,t.labels?e++:-1,e+ +t.domain]}(s),h=a.range,d=a.offset,f=a.position,p=a.minExtent,m=a.maxExtent,g=s.title&&a.items[c[2]].items[0],y=a.titlePadding,v=a.bounds,b=g&&Op(g),w=0,x=0;switch(zb.clear().union(v),v.clear(),(i=c[0])>-1&&v.union(a.items[i].bounds),(i=c[1])>-1&&v.union(a.items[i].bounds),l){case wc:w=f||0,x=-d,o=Math.max(p,Math.min(m,-v.y1)),v.add(0,-o).add(h,0),g&&$b(t,g,o,y,b,0,-1,v);break;case xc:w=-d,x=f||0,o=Math.max(p,Math.min(m,-v.x1)),v.add(-o,0).add(0,h),g&&$b(t,g,o,y,b,1,-1,v);break;case _c:w=n+d,x=f||0,o=Math.max(p,Math.min(m,v.x2)),v.add(0,0).add(o,h),g&&$b(t,g,o,y,b,1,1,v);break;case"bottom":w=f||0,x=r+d,o=Math.max(p,Math.min(m,v.y2)),v.add(0,0).add(h,o),g&&$b(t,g,o,y,0,0,1,v);break;default:w=a.x,x=a.y}return Xd(v.translate(w,x),a),Lb(a,"x",w+u)|Lb(a,"y",x+u)&&(a.bounds=zb,t.dirty(a),a.bounds=v,t.dirty(a)),a.mark.bounds.clear().union(v)}function $b(t,e,n,r,i,o,a,s){const u=e.bounds;if(e.auto){const s=a*(n+i+r);let l=0,c=0;t.dirty(e),o?l=(e.x||0)-(e.x=s):c=(e.y||0)-(e.y=s),e.mark.bounds.clear().union(u.translate(-l,-c)),t.dirty(e)}s.union(u)}const Vb=(t,e)=>Math.floor(Math.min(t,e)),Wb=(t,e)=>Math.ceil(Math.max(t,e));function qb(t){return(new Bd).set(0,0,t.width||0,t.height||0)}function Hb(t){var e=t.bounds.clone();return e.empty()?e.set(0,0,0,0):e.translate(-(t.x||0),-(t.y||0))}function Gb(t,e,n){var r=Ze(t)?t[e]:t;return null!=r?r:void 0!==n?n:0}function Xb(t){return t<0?Math.ceil(-t):0}function Kb(t,e,n){var r,i,o,a,s,u,l,c,h,d,f,p=!n.nodirty,m="flush"===n.bounds?qb:Hb,g=zb.set(0,0,0,0),y=Gb(n.align,"column"),v=Gb(n.align,kc),b=Gb(n.padding,"column"),w=Gb(n.padding,kc),x=n.columns||e.length,_=x<=0?1:Math.ceil(e.length/x),C=e.length,k=Array(C),S=Array(x),E=0,O=Array(C),A=Array(_),N=0,T=Array(C),D=Array(C),R=Array(C);for(i=0;i<x;++i)S[i]=0;for(i=0;i<_;++i)A[i]=0;for(i=0;i<C;++i)s=R[i]=m(u=e[i]),u.x=u.x||0,T[i]=0,u.y=u.y||0,D[i]=0,o=i%x,a=~~(i/x),E=Math.max(E,l=Math.ceil(s.x2)),N=Math.max(N,c=Math.ceil(s.y2)),S[o]=Math.max(S[o],l),A[a]=Math.max(A[a],c),k[i]=b+Xb(s.x1),O[i]=w+Xb(s.y1),p&&t.dirty(e[i]);for(i=0;i<C;++i)i%x==0&&(k[i]=0),i<x&&(O[i]=0);if("each"===y)for(o=1;o<x;++o){for(f=0,i=o;i<C;i+=x)f<k[i]&&(f=k[i]);for(i=o;i<C;i+=x)k[i]=f+S[o-1]}else if("all"===y){for(f=0,i=0;i<C;++i)i%x&&f<k[i]&&(f=k[i]);for(i=0;i<C;++i)i%x&&(k[i]=f+E)}else for(y=!1,o=1;o<x;++o)for(i=o;i<C;i+=x)k[i]+=S[o-1];if("each"===v)for(a=1;a<_;++a){for(f=0,r=(i=a*x)+x;i<r;++i)f<O[i]&&(f=O[i]);for(i=a*x;i<r;++i)O[i]=f+A[a-1]}else if("all"===v){for(f=0,i=x;i<C;++i)f<O[i]&&(f=O[i]);for(i=x;i<C;++i)O[i]=f+N}else for(v=!1,a=1;a<_;++a)for(r=(i=a*x)+x;i<r;++i)O[i]+=A[a-1];for(h=0,i=0;i<C;++i)T[i]+=(h=k[i]+(i%x?h:0))-e[i].x;for(o=0;o<x;++o)for(d=0,i=o;i<C;i+=x)D[i]+=(d+=O[i])-e[i].y;if(y&&Gb(n.center,"column")&&_>1)for(i=0;i<C;++i)(h=(s="all"===y?E:S[i%x])-R[i].x2-e[i].x-T[i])>0&&(T[i]+=h/2);if(v&&Gb(n.center,kc)&&1!==x)for(i=0;i<C;++i)(d=(s="all"===v?N:A[~~(i/x)])-R[i].y2-e[i].y-D[i])>0&&(D[i]+=d/2);for(i=0;i<C;++i)g.union(R[i].translate(T[i],D[i]));switch(h=Gb(n.anchor,"x"),d=Gb(n.anchor,"y"),Gb(n.anchor,"column")){case Cc:h-=g.width();break;case"middle":h-=g.width()/2}switch(Gb(n.anchor,kc)){case Cc:d-=g.height();break;case"middle":d-=g.height()/2}for(h=Math.round(h),d=Math.round(d),g.clear(),i=0;i<C;++i)e[i].mark.bounds.clear();for(i=0;i<C;++i)(u=e[i]).x+=T[i]+=h,u.y+=D[i]+=d,g.union(u.mark.bounds.union(u.bounds.translate(T[i],D[i]))),p&&t.dirty(u);return g}function Yb(t,e){return"x1"===e?t.x||0:"y1"===e?t.y||0:"x2"===e?(t.x||0)+(t.width||0):"y2"===e?(t.y||0)+(t.height||0):void 0}function Zb(t,e){return t.bounds[e]}function Qb(t,e,n,r,i,o,a,s,u,l,c,h,d,f){var p,m,g,y,v,b,w,x,_,C=n.length,k=0,S=0;if(!C)return k;for(p=c;p<C;p+=h)n[p]&&(k=a(k,u(n[p],l)));if(!e.length)return k;for(e.length>i&&(t.warn("Grid headers exceed limit: "+i),e=e.slice(0,i)),k+=o,m=0,y=e.length;m<y;++m)t.dirty(e[m]),e[m].mark.bounds.clear();for(p=c,m=0,y=e.length;m<y;++m,p+=h){for(v=(b=e[m]).mark.bounds,g=p;g>=0&&null==(w=n[g]);g-=d);s?(x=null==f?w.x:Math.round(w.bounds.x1+f*w.bounds.width()),_=k):(x=k,_=null==f?w.y:Math.round(w.bounds.y1+f*w.bounds.height())),v.union(b.bounds.translate(x-(b.x||0),_-(b.y||0))),b.x=x,b.y=_,t.dirty(b),S=a(S,v[l])}return S}function Jb(t,e,n,r,i,o){if(e){t.dirty(e);var a=n,s=n;r?a=Math.round(i.x1+o*i.width()):s=Math.round(i.y1+o*i.height()),e.bounds.translate(a-(e.x||0),s-(e.y||0)),e.mark.bounds.clear().union(e.bounds),e.x=a,e.y=s,t.dirty(e)}}function tw(t,e,n,r,i,o,a){const s=function(t,e){const n=t[e]||{};return(e,r)=>null!=n[e]?n[e]:null!=t[e]?t[e]:r}(n,e),u=(h=t,d=s("offset",0),f=-1/0,h.forEach(t=>{null!=t.offset&&(f=Math.max(f,t.offset))}),f>-1/0?f:d),l=s("anchor","start"),c=l===Cc?1:"middle"===l?.5:0;var h,d,f;const p={align:"each",bounds:s("bounds","flush"),columns:"vertical"===s("direction")?1:t.length,padding:s("margin",8),center:s("center"),nodirty:!0};switch(e){case xc:p.anchor={x:Math.floor(r.x1)-u,column:Cc,y:c*(a||r.height()+2*r.y1),row:l};break;case _c:p.anchor={x:Math.ceil(r.x2)+u,y:c*(a||r.height()+2*r.y1),row:l};break;case wc:p.anchor={y:Math.floor(i.y1)-u,row:Cc,x:c*(o||i.width()+2*i.x1),column:l};break;case"bottom":p.anchor={y:Math.ceil(i.y2)+u,x:c*(o||i.width()+2*i.x1),column:l};break;case"top-left":p.anchor={x:u,y:u};break;case"top-right":p.anchor={x:o-u,y:u,column:Cc};break;case"bottom-left":p.anchor={x:u,y:a-u,row:Cc};break;case"bottom-right":p.anchor={x:o-u,y:a-u,column:Cc,row:Cc}}return p}function ew(t,e){var n,r,i,o,a=e.items[0],s=a.datum,u=a.orient,l=a.bounds,c=a.x,h=a.y;return a._bounds?a._bounds.clear().union(l):a._bounds=l.clone(),l.clear(),function(t,e,n){var r=e.padding,i=r-n.x,o=r-n.y;if(e.datum.title){var a=e.items[1].items[0],s=a.anchor,u=e.titlePadding||0,l=r-a.x,c=r-a.y;switch(a.orient){case xc:i+=Math.ceil(a.bounds.width())+u;break;case _c:case"bottom":break;default:o+=a.bounds.height()+u}switch((i||o)&&rw(t,n,i,o),a.orient){case xc:c+=nw(e,n,a,s,1,1);break;case _c:l+=nw(e,n,a,Cc,0,0)+u,c+=nw(e,n,a,s,1,1);break;case"bottom":l+=nw(e,n,a,s,0,0),c+=nw(e,n,a,Cc,-1,0,1)+u;break;default:l+=nw(e,n,a,s,0,0)}(l||c)&&rw(t,a,l,c),(l=Math.round(a.bounds.x1-r))<0&&(rw(t,n,-l,0),rw(t,a,-l,0))}else(i||o)&&rw(t,n,i,o)}(t,a,a.items[0].items[0]),l=function(t,e){return t.items.forEach(t=>e.union(t.bounds)),e.x1=t.padding,e.y1=t.padding,e}(a,l),n=2*a.padding,r=2*a.padding,l.empty()||(n=Math.ceil(l.width()+n),r=Math.ceil(l.height()+r)),"symbol"===s.type&&(o=(i=a.items[0].items[0].items[0].items).reduce((t,e)=>(t[e.column]=Math.max(e.bounds.x2-e.x,t[e.column]||0),t),{}),i.forEach(t=>{t.width=o[t.column],t.height=t.bounds.y2-t.y})),"none"!==u&&(a.x=c=0,a.y=h=0),a.width=n,a.height=r,Xd(l.set(c,h,c+n,h+r),a),a.mark.bounds.clear().union(l),a}function nw(t,e,n,r,i,o,a){const s=n.datum.vgrad,u=("symbol"===t.datum.type||!o&&s||a?e:e.items[0]).bounds[i?"y2":"x2"]-t.padding,l=s&&o?u:0,c=s&&o?0:u,h=i<=0?0:Op(n);return Math.round("start"===r?l:r===Cc?c-h:.5*(u-h))}function rw(t,e,n,r){e.x+=n,e.y+=r,e.bounds.translate(n,r),e.mark.bounds.translate(n,r),t.dirty(e)}function iw(t){Hs.call(this,null,t)}function ow(t){Hs.call(this,null,t)}function aw(t){Hs.call(this,null,t)}function sw(){return Qn({})}function uw(t){Hs.call(this,null,t)}function lw(t){Hs.call(this,[],t)}Tn(iw,Hs,{transform(t,e){const n=e.dataflow;return t.mark.items.forEach(e=>{t.layout&&function(t,e,n){var r,i,o,a,s,u,l,c=function(t){for(var e,n,r=t.items,i=r.length,o=0,a={marks:[],rowheaders:[],rowfooters:[],colheaders:[],colfooters:[],rowtitle:null,coltitle:null};o<i;++o)if(n=(e=r[o]).items,"group"===e.marktype)switch(e.role){case"axis":case"legend":case"title":break;case"row-header":a.rowheaders.push(...n);break;case"row-footer":a.rowfooters.push(...n);break;case"column-header":a.colheaders.push(...n);break;case"column-footer":a.colfooters.push(...n);break;case"row-title":a.rowtitle=n[0];break;case"column-title":a.coltitle=n[0];break;default:a.marks.push(...n)}return a}(e),h=c.marks,d="flush"===n.bounds?Yb:Zb,f=n.offset,p=n.columns||h.length,m=p<=0?1:Math.ceil(h.length/p),g=m*p;const y=Kb(t,h,n);y.empty()&&y.set(0,0,0,0),c.rowheaders&&(u=Gb(n.headerBand,kc,null),r=Qb(t,c.rowheaders,h,0,m,-Gb(f,"rowHeader"),Vb,0,d,"x1",0,p,1,u)),c.colheaders&&(u=Gb(n.headerBand,"column",null),i=Qb(t,c.colheaders,h,0,p,-Gb(f,"columnHeader"),Vb,1,d,"y1",0,1,p,u)),c.rowfooters&&(u=Gb(n.footerBand,kc,null),o=Qb(t,c.rowfooters,h,0,m,Gb(f,"rowFooter"),Wb,0,d,"x2",p-1,p,1,u)),c.colfooters&&(u=Gb(n.footerBand,"column",null),a=Qb(t,c.colfooters,h,0,p,Gb(f,"columnFooter"),Wb,1,d,"y2",g-p,1,p,u)),c.rowtitle&&(s=Gb(n.titleAnchor,kc),l=Gb(f,"rowTitle"),l=s===Cc?o+l:r-l,u=Gb(n.titleBand,kc,.5),Jb(t,c.rowtitle,l,0,y,u)),c.coltitle&&(s=Gb(n.titleAnchor,"column"),l=Gb(f,"columnTitle"),l=s===Cc?a+l:i-l,u=Gb(n.titleBand,"column",.5),Jb(t,c.coltitle,l,1,y,u))}(n,e,t.layout),function(t,e,n){var r,i,o,a,s,u=e.items,l=Math.max(0,e.width||0),c=Math.max(0,e.height||0),h=(new Bd).set(0,0,l,c),d=h.clone(),f=h.clone(),p=[];for(a=0,s=u.length;a<s;++a)switch((i=u[a]).role){case"axis":(Bb(i)?d:f).union(Ub(t,i,l,c));break;case"title":r=i;break;case"legend":p.push(ew(t,i));break;case"frame":case"scope":case"row-header":case"row-footer":case"row-title":case"column-header":case"column-footer":case"column-title":d.union(i.bounds),f.union(i.bounds);break;default:h.union(i.bounds)}if(p.length){const e={};p.forEach(t=>{"none"!==(o=t.orient||_c)&&(e[o]||(e[o]=[])).push(t)});for(let r in e){const i=e[r];Kb(t,i,tw(i,r,n.legends,d,f,l,c))}p.forEach(e=>{const r=e.bounds;if(r.equals(e._bounds)||(e.bounds=e._bounds,t.dirty(e),e.bounds=r,t.dirty(e)),n.autosize&&"fit"===n.autosize.type)switch(e.orient){case xc:case _c:h.add(r.x1,0).add(r.x2,0);break;case wc:case"bottom":h.add(0,r.y1).add(0,r.y2)}else h.union(r)})}h.union(d).union(f),r&&h.union(function(t,e,n,r,i){var o,a=e.items[0],s=a.orient,u=a.anchor,l=a.offset,c=a.padding,h=a.items[0].items[0],d=a.items[1]&&a.items[1].items[0],f=s===xc||s===_c?r:n,p=0,m=0,g=0,y=0,v=0;if("group"!==a.frame?s===xc?(p=i.y2,f=i.y1):s===_c?(p=i.y1,f=i.y2):(p=i.x1,f=i.x2):s===xc&&(p=r,f=0),o="start"===u?p:u===Cc?f:(p+f)/2,d&&d.text){switch(s){case wc:case"bottom":v=h.bounds.height()+c;break;case xc:y=h.bounds.width()+c;break;case _c:y=-h.bounds.width()-c}zb.clear().union(d.bounds),zb.translate(y-(d.x||0),v-(d.y||0)),Lb(d,"x",y)|Lb(d,"y",v)&&(t.dirty(d),d.bounds.clear().union(zb),d.mark.bounds.clear().union(zb),t.dirty(d)),zb.clear().union(d.bounds)}else zb.clear();switch(zb.union(h.bounds),s){case wc:m=o,g=i.y1-zb.height()-l;break;case xc:m=i.x1-zb.width()-l,g=o;break;case _c:m=i.x2+zb.width()+l,g=o;break;case"bottom":m=o,g=i.y2+l;break;default:m=a.x,g=a.y}return Lb(a,"x",m)|Lb(a,"y",g)&&(zb.translate(m,g),t.dirty(a),a.bounds.clear().union(zb),e.bounds.clear().union(zb),t.dirty(a)),a.bounds}(t,r,l,c,h)),e.clip&&h.set(0,0,e.width||0,e.height||0),function(t,e,n,r){const i=r.autosize||{},o=i.type;if(t._autosize<1||!o)return;let a=t._width,s=t._height,u=Math.max(0,e.width||0),l=Math.max(0,Math.ceil(-n.x1)),c=Math.max(0,Math.ceil(n.x2-u)),h=Math.max(0,e.height||0),d=Math.max(0,Math.ceil(-n.y1)),f=Math.max(0,Math.ceil(n.y2-h));if("padding"===i.contains){const e=t.padding();a-=e.left+e.right,s-=e.top+e.bottom}"none"===o?(l=0,d=0,u=a,h=s):"fit"===o?(u=Math.max(0,a-l-c),h=Math.max(0,s-d-f)):"fit-x"===o?(u=Math.max(0,a-l-c),s=h+d+f):"fit-y"===o?(a=u+l+c,h=Math.max(0,s-d-f)):"pad"===o&&(a=u+l+c,s=h+d+f),t._resizeView(a,s,u,h,[l,d],i.resize)}(t,e,h,n)}(n,e,t)}),(r=t.mark.group)&&"legend-entry"!==r.mark.role?e.reflow():e;var r}}),Tn(ow,Hs,{transform(t,e){if(this.value&&!t.modified())return e.StopPropagation;var n=e.dataflow.locale(),r=e.fork(e.NO_SOURCE|e.NO_FIELDS),i=this.value,o=t.scale,a=Dv(o,null==t.count?t.values?t.values.length:10:t.count,t.minstep),s=t.format||Mv(n,o,a,t.formatSpecifier,t.formatType,!!t.values),u=t.values?Rv(o,t.values,a):Iv(o,a);return i&&(r.rem=i),i=u.map((t,e)=>Qn({index:e/(u.length-1||1),value:t,label:s(t)})),t.extra&&i.length&&i.push(Qn({index:-1,extra:{value:i[0].value},label:""})),r.source=i,r.add=i,this.value=i,r}}),Tn(aw,Hs,{transform(t,e){var n=e.dataflow,r=e.fork(e.NO_SOURCE|e.NO_FIELDS),i=t.item||sw,o=t.key||Yn,a=this.value;return Ye(r.encode)&&(r.encode=null),a&&(t.modified("key")||e.modified(o))&&Be("DataJoin does not support modified key function or fields."),a||(e=e.addAll(),this.value=a=function(t){const e=Nn().test(t=>t.exit);return e.lookup=n=>e.get(t(n)),e}(o)),e.visit(e.ADD,t=>{const e=o(t);let n=a.get(e);n?n.exit?(a.empty--,r.add.push(n)):r.mod.push(n):(n=i(t),a.set(e,n),r.add.push(n)),n.datum=t,n.exit=!1}),e.visit(e.MOD,t=>{const e=o(t),n=a.get(e);n&&(n.datum=t,r.mod.push(n))}),e.visit(e.REM,t=>{const e=o(t),n=a.get(e);t!==n.datum||n.exit||(r.rem.push(n),n.exit=!0,++a.empty)}),e.changed(e.ADD_MOD)&&r.modifies("datum"),(e.clean()||t.clean&&a.empty>n.cleanThreshold)&&n.runAfter(a.clean),r}}),Tn(uw,Hs,{transform(t,e){var n=e.fork(e.ADD_REM),r=t.mod||!1,i=t.encoders,o=e.encode;if(Ye(o)){if(!n.changed()&&!o.every((function(t){return i[t]})))return e.StopPropagation;o=o[0],n.encode=null}var a="enter"===o,s=i.update||Xe,u=i.enter||Xe,l=i.exit||Xe,c=(o&&!a?i[o]:s)||Xe;if(e.changed(e.ADD)&&(e.visit(e.ADD,(function(e){u(e,t),s(e,t)})),n.modifies(u.output),n.modifies(s.output),c!==Xe&&c!==s&&(e.visit(e.ADD,(function(e){c(e,t)})),n.modifies(c.output))),e.changed(e.REM)&&l!==Xe&&(e.visit(e.REM,(function(e){l(e,t)})),n.modifies(l.output)),a||c!==Xe){var h=e.MOD|(t.modified()?e.REFLOW:0);a?(e.visit(h,(function(e){var i=u(e,t)||r;(c(e,t)||i)&&n.mod.push(e)})),n.mod.length&&n.modifies(u.output)):e.visit(h,(function(e){(c(e,t)||r)&&n.mod.push(e)})),n.mod.length&&n.modifies(c.output)}return n.changed()?n:e.StopPropagation}}),Tn(lw,Hs,{transform(t,e){if(null!=this.value&&!t.modified())return e.StopPropagation;var n,r,i,o,a,s=e.dataflow.locale(),u=e.fork(e.NO_SOURCE|e.NO_FIELDS),l=this.value,c=t.type||"symbol",h=t.scale,d=+t.limit,f=Dv(h,null==t.count?5:t.count,t.minstep),p=t.format||Lv(s,h,f,c,t.formatSpecifier,t.formatType,!!t.values||"symbol"===c),m=t.values||zv(h,f);return l&&(u.rem=l),"symbol"===c?(d&&m.length>d?(e.dataflow.warn("Symbol legend count exceeds limit, filtering items."),l=m.slice(0,d-1),a=!0):l=m,gn(i=t.size)?(t.values||0!==h(l[0])||(l=l.slice(1)),o=l.reduce((function(e,n){return Math.max(e,i(n,t))}),0)):i=_n(o=i||8),l=l.map((e,n)=>Qn({index:n,label:p(e,n,l),value:e,offset:o,size:i(e,t)})),a&&l.push(Qn({index:l.length,label:`\u2026${m.length-l.length} entries`,value:a=m[l.length],offset:o,size:i(a,t)}))):"gradient"===c?(n=h.domain(),r=_v(h,n[0],en(n)),m.length<3&&!t.values&&n[0]!==en(n)&&(m=[n[0],en(n)]),l=m.map((t,e)=>Qn({index:e,label:p(t,e,m),value:t,perc:r(t)}))):(i=m.length-1,r=function(t){let e=t.domain(),n=e.length-1,r=+e[0],i=+en(e),o=i-r;if("threshold"===t.type){const t=n?o/n:.1;r-=t,i+=t,o=i-r}return t=>(t-r)/o}(h),l=m.map((t,e)=>Qn({index:e,label:p(t,e,m),value:t,perc:e?r(t):0,perc2:e===i?1:r(m[e+1])}))),u.source=l,u.add=l,this.value=l,u}});const cw=t=>t.source.x,hw=t=>t.source.y,dw=t=>t.target.x,fw=t=>t.target.y;function pw(t){Hs.call(this,{},t)}pw.Definition={type:"LinkPath",metadata:{modifies:!0},params:[{name:"sourceX",type:"field",default:"source.x"},{name:"sourceY",type:"field",default:"source.y"},{name:"targetX",type:"field",default:"target.x"},{name:"targetY",type:"field",default:"target.y"},{name:"orient",type:"enum",default:"vertical",values:["horizontal","vertical","radial"]},{name:"shape",type:"enum",default:"line",values:["line","arc","curve","diagonal","orthogonal"]},{name:"require",type:"signal"},{name:"as",type:"string",default:"path"}]},Tn(pw,Hs,{transform(t,e){var n=t.sourceX||cw,r=t.sourceY||hw,i=t.targetX||dw,o=t.targetY||fw,a=t.as||"path",s=t.shape||"line",u=vw.get(s+"-"+(t.orient||"vertical"))||vw.get(s);return u||Be("LinkPath unsupported type: "+t.shape+(t.orient?"-"+t.orient:"")),e.visit(e.SOURCE,t=>{t[a]=u(n(t),r(t),i(t),o(t))}),e.reflow(t.modified()).modifies(a)}});const mw=(t,e,n,r)=>"M"+t+","+e+"L"+n+","+r,gw=(t,e,n,r)=>{var i=n-t,o=r-e,a=Math.sqrt(i*i+o*o)/2;return"M"+t+","+e+"A"+a+","+a+" "+180*Math.atan2(o,i)/Math.PI+" 0 1 "+n+","+r},yw=(t,e,n,r)=>{const i=n-t,o=r-e,a=.2*(i+o),s=.2*(o-i);return"M"+t+","+e+"C"+(t+a)+","+(e+s)+" "+(n+s)+","+(r-a)+" "+n+","+r},vw=Nn({line:mw,"line-radial":(t,e,n,r)=>mw(e*Math.cos(t),e*Math.sin(t),r*Math.cos(n),r*Math.sin(n)),arc:gw,"arc-radial":(t,e,n,r)=>gw(e*Math.cos(t),e*Math.sin(t),r*Math.cos(n),r*Math.sin(n)),curve:yw,"curve-radial":(t,e,n,r)=>yw(e*Math.cos(t),e*Math.sin(t),r*Math.cos(n),r*Math.sin(n)),"orthogonal-horizontal":(t,e,n,r)=>"M"+t+","+e+"V"+r+"H"+n,"orthogonal-vertical":(t,e,n,r)=>"M"+t+","+e+"H"+n+"V"+r,"orthogonal-radial":(t,e,n,r)=>{const i=Math.cos(t),o=Math.sin(t),a=Math.cos(n),s=Math.sin(n);return"M"+e*i+","+e*o+"A"+e+","+e+" 0 0,"+((Math.abs(n-t)>Math.PI?n<=t:n>t)?1:0)+" "+e*a+","+e*s+"L"+r*a+","+r*s},"diagonal-horizontal":(t,e,n,r)=>{const i=(t+n)/2;return"M"+t+","+e+"C"+i+","+e+" "+i+","+r+" "+n+","+r},"diagonal-vertical":(t,e,n,r)=>{const i=(e+r)/2;return"M"+t+","+e+"C"+t+","+i+" "+n+","+i+" "+n+","+r},"diagonal-radial":(t,e,n,r)=>{const i=Math.cos(t),o=Math.sin(t),a=Math.cos(n),s=Math.sin(n),u=(e+r)/2;return"M"+e*i+","+e*o+"C"+u*i+","+u*o+" "+u*a+","+u*s+" "+r*a+","+r*s}});function bw(t,e){let n=0;if(void 0===e)for(let r of t)(r=+r)&&(n+=r);else{let r=-1;for(let i of t)(i=+e(i,++r,t))&&(n+=i)}return n}function ww(t){Hs.call(this,null,t)}function xw(t){return wy(t)&&"sequential"!==t}ww.Definition={type:"Pie",metadata:{modifies:!0},params:[{name:"field",type:"field"},{name:"startAngle",type:"number",default:0},{name:"endAngle",type:"number",default:6.283185307179586},{name:"sort",type:"boolean",default:!1},{name:"as",type:"string",array:!0,length:2,default:["startAngle","endAngle"]}]},Tn(ww,Hs,{transform(t,e){var n,r,i,o=t.as||["startAngle","endAngle"],a=o[0],s=o[1],u=t.startAngle||0,l=null!=t.endAngle?t.endAngle:2*Math.PI,c=e.source,h=c.map(t.field||He),d=h.length,f=u,p=(l-u)/bw(h),m=nc(d);for(t.sort&&m.sort((t,e)=>h[t]-h[e]),n=0;n<d;++n)i=h[m[n]],(r=c[m[n]])[a]=f,r[s]=f+=i*p;return this.value=h,e.reflow(t.modified()).modifies(o)}});const _w=Vn(["set","modified","clear","type","scheme","schemeExtent","schemeCount","domain","domainMin","domainMid","domainMax","domainRaw","domainImplicit","nice","zero","bins","range","rangeStep","round","reverse","interpolate","interpolateGamma"]);function Cw(t){Hs.call(this,null,t),this.modified(!0)}function kw(t,e,n){return Cy(t)&&Math.abs(e.reduce((function(t,e){return t+(e<0?-1:e>0?1:0)}),0))!==e.length&&n.warn("Log scale domain includes zero: "+zn(e)),e}function Sw(t,e,n){return gn(t)&&(e||n)?bv(t,Ew(e||[0,1],n)):t}function Ew(t,e){return e?t.slice().reverse():t}function Ow(t){Hs.call(this,null,t)}Tn(Cw,Hs,{transform(t,e){var n=e.dataflow,r=this.value,i=function(t){var e,n=t.type,r="";return"sequential"===n?"sequential-linear":(function(t){const e=t.type;return wy(e)&&e!==ym&&e!==vm&&(t.scheme||t.range&&t.range.length&&t.range.every(Mn))}(t)&&(r=2===(e=t.rawDomain?t.rawDomain.length:t.domain?t.domain.length+ +(null!=t.domainMid):0)?"sequential-":3===e?"diverging-":""),(r+n||"linear").toLowerCase())}(t);for(i in r&&i===r.type||(this.value=r=yy(i)()),t)if(!_w[i]){if("padding"===i&&xw(r.type))continue;gn(r[i])?r[i](t[i]):n.warn("Unsupported scale property: "+i)}return function(t,e,n){var r=t.type,i=e.round||!1,o=e.range;if(null!=e.rangeStep)o=function(t,e,n){return"band"!==t&&"point"!==t&&Be("Only band and point scales support rangeStep."),[0,e.rangeStep*mm(n,"point"===t?1:(null!=e.paddingInner?e.paddingInner:e.padding)||0,(null!=e.paddingOuter?e.paddingOuter:e.padding)||0)]}(r,e,n);else if(e.scheme&&(o=function(t,e,n){var r,i=e.schemeExtent;return Ye(e.scheme)?r=wv(e.scheme,e.interpolate,e.interpolateGamma):(r=Ov(e.scheme.toLowerCase()))||Be("Unrecognized scheme name: "+e.scheme),n="threshold"===t?n+1:"bin-ordinal"===t?n-1:"quantile"===t||"quantize"===t?+e.schemeCount||5:n,ky(t)?Sw(r,i,e.reverse):gn(r)?xv(Sw(r,i),n):"ordinal"===t?r:r.slice(0,n)}(r,e,n),gn(o))){if(t.interpolator)return t.interpolator(o);Be(`Scale type ${r} does not support interpolating color schemes.`)}if(o&&ky(r))return t.interpolator(wv(Ew(o,e.reverse),e.interpolate,e.interpolateGamma));o&&e.interpolate&&t.interpolate?t.interpolate(Cv(e.interpolate,e.interpolateGamma)):gn(t.round)?t.round(i):gn(t.rangeRound)&&t.interpolate(i?Rg:Dg),o&&t.range(Ew(o,e.reverse))}(r,t,function(t,e,n){let r=e.bins;if(r&&!Ye(r)){let e=t.domain(),n=e[0],i=en(e),o=null==r.start?n:r.start,a=null==r.stop?i:r.stop,s=r.step;s||Be("Scale bins parameter missing step property."),o<n&&(o=s*Math.ceil(n/s)),a>i&&(a=s*Math.floor(i/s)),r=nc(o,a+s/2,s)}return r?t.bins=r:t.bins&&delete t.bins,"bin-ordinal"===t.type&&(r?e.domain||e.domainRaw||(t.domain(r),n=r.length):t.bins=t.domain()),n}(r,t,function(t,e,n){var r=function(t,e,n){return e?(t.domain(kw(t.type,e,n)),e.length):-1}(t,e.domainRaw,n);if(r>-1)return r;var i,o,a=e.domain,s=t.type,u=e.zero||void 0===e.zero&&function(t){const e=t.type;return!t.bins&&("linear"===e||"pow"===e||"sqrt"===e)}(t);if(!a)return 0;if(xw(s)&&e.padding&&a[0]!==en(a)&&(a=function(t,e,n,r,i,o){var a=Math.abs(en(n)-n[0]),s=a/(a-2*r),u=t===gm?dn(e,null,s):"sqrt"===t?fn(e,null,s,.5):"pow"===t?fn(e,null,s,i||1):"symlog"===t?pn(e,null,s,o||1):hn(e,null,s);return(e=e.slice())[0]=u[0],e[e.length-1]=u[1],e}(s,a,e.range,e.padding,e.exponent,e.constant)),(u||null!=e.domainMin||null!=e.domainMax||null!=e.domainMid)&&(i=(a=a.slice()).length-1||1,u&&(a[0]>0&&(a[0]=0),a[i]<0&&(a[i]=0)),null!=e.domainMin&&(a[0]=e.domainMin),null!=e.domainMax&&(a[i]=e.domainMax),null!=e.domainMid)){const t=(o=e.domainMid)>a[i]?i+1:o<a[0]?0:i;t!==i&&n.warn("Scale domainMid exceeds domain min or max.",o),a.splice(t,0,o)}return t.domain(kw(s,a,n)),"ordinal"===s&&t.unknown(e.domainImplicit?Em:void 0),e.nice&&t.nice&&t.nice(!0!==e.nice&&Dv(t,e.nice)||null),a.length}(r,t,n))),e.fork(e.NO_SOURCE|e.NO_FIELDS)}}),Tn(Ow,Hs,{transform(t,e){const n=t.modified("sort")||e.changed(e.ADD)||e.modified(t.sort.fields)||e.modified("datum");return n&&e.source.sort(nr(t.sort)),this.modified(n),e}});const Aw=["y0","y1"];function Nw(t){Hs.call(this,null,t)}function Tw(t,e,n,r,i){for(var o,a=(e-t.sum)/2,s=t.length,u=0;u<s;++u)(o=t[u])[r]=a,o[i]=a+=Math.abs(n(o))}function Dw(t,e,n,r,i){for(var o,a=1/t.sum,s=0,u=t.length,l=0,c=0;l<u;++l)(o=t[l])[r]=s,o[i]=s=a*(c+=Math.abs(n(o)))}function Rw(t,e,n,r,i){for(var o,a,s=0,u=0,l=t.length,c=0;c<l;++c)(o=+n(a=t[c]))<0?(a[r]=u,a[i]=u+=o):(a[r]=s,a[i]=s+=o)}function Iw(){}Nw.Definition={type:"Stack",metadata:{modifies:!0},params:[{name:"field",type:"field"},{name:"groupby",type:"field",array:!0},{name:"sort",type:"compare"},{name:"offset",type:"enum",default:"zero",values:["zero","center","normalize"]},{name:"as",type:"string",array:!0,length:2,default:Aw}]},Tn(Nw,Hs,{transform(t,e){var n,r,i,o,a=t.as||Aw,s=a[0],u=a[1],l=nr(t.sort),c=t.field||He,h="center"===t.offset?Tw:"normalize"===t.offset?Dw:Rw;for(n=function(t,e,n,r){var i,o,a,s,u,l,c,h,d,f=[],p=t=>t(u);if(null==e)f.push(t.slice());else for(i={},o=0,a=t.length;o<a;++o)u=t[o],(c=i[l=e.map(p)])||(i[l]=c=[],f.push(c)),c.push(u);for(l=0,d=0,s=f.length;l<s;++l){for(o=0,h=0,a=(c=f[l]).length;o<a;++o)h+=Math.abs(r(c[o]));c.sum=h,h>d&&(d=h),n&&c.sort(n)}return f.max=d,f}(e.source,t.groupby,l,c),r=0,i=n.length,o=n.max;r<i;++r)h(n[r],o,c,s,u);return e.reflow(t.modified()).modifies(a)}});const Mw=[[],[[[1,1.5],[.5,1]]],[[[1.5,1],[1,1.5]]],[[[1.5,1],[.5,1]]],[[[1,.5],[1.5,1]]],[[[1,1.5],[.5,1]],[[1,.5],[1.5,1]]],[[[1,.5],[1,1.5]]],[[[1,.5],[.5,1]]],[[[.5,1],[1,.5]]],[[[1,1.5],[1,.5]]],[[[.5,1],[1,.5]],[[1.5,1],[1,1.5]]],[[[1.5,1],[1,.5]]],[[[.5,1],[1.5,1]]],[[[1,1.5],[1.5,1]]],[[[.5,1],[1,1.5]]],[]];var Fw=function(){var t=1,e=1,n=a;function r(t,e){return e.map(e=>i(t,e))}function i(r,i){var a=[],s=[];return function(n,r,i){var a,s,u,l,c,h=new Array,d=new Array;for(a=s=-1,Mw[(u=n[0]>=r)<<1].forEach(f);++a<t-1;)Mw[u|(u=n[a+1]>=r)<<1].forEach(f);for(Mw[u<<0].forEach(f);++s<e-1;){for(a=-1,Mw[(u=n[s*t+t]>=r)<<1|(l=n[s*t]>=r)<<2].forEach(f);++a<t-1;)c=l,Mw[u|(u=n[s*t+t+a+1]>=r)<<1|(l=n[s*t+a+1]>=r)<<2|c<<3].forEach(f);Mw[u|l<<3].forEach(f)}for(a=-1,Mw[(l=n[s*t]>=r)<<2].forEach(f);++a<t-1;)c=l,Mw[(l=n[s*t+a+1]>=r)<<2|c<<3].forEach(f);function f(t){var e,n,r=[t[0][0]+a,t[0][1]+s],u=[t[1][0]+a,t[1][1]+s],l=o(r),c=o(u);(e=d[l])?(n=h[c])?(delete d[e.end],delete h[n.start],e===n?(e.ring.push(u),i(e.ring)):h[e.start]=d[n.end]={start:e.start,end:n.end,ring:e.ring.concat(n.ring)}):(delete d[e.end],e.ring.push(u),d[e.end=c]=e):(e=h[c])?(n=d[l])?(delete h[e.start],delete d[n.end],e===n?(e.ring.push(u),i(e.ring)):h[n.start]=d[e.end]={start:n.start,end:e.end,ring:n.ring.concat(e.ring)}):(delete h[e.start],e.ring.unshift(r),h[e.start=l]=e):h[l]=d[c]={start:l,end:c,ring:[r,u]}}Mw[l<<3].forEach(f)}(r,i,(function(t){n(t,r,i),function(t){for(var e=0,n=t.length,r=t[n-1][1]*t[0][0]-t[n-1][0]*t[0][1];++e<n;)r+=t[e-1][1]*t[e][0]-t[e-1][0]*t[e][1];return r}(t)>0?a.push([t]):s.push(t)})),s.forEach((function(t){for(var e,n=0,r=a.length;n<r;++n)if(-1!==Pw((e=a[n])[0],t))return void e.push(t)})),{type:"MultiPolygon",value:i,coordinates:a}}function o(e){return 2*e[0]+e[1]*(t+1)*4}function a(n,r,i){n.forEach((function(n){var o,a=n[0],s=n[1],u=0|a,l=0|s,c=r[l*t+u];a>0&&a<t&&u===a&&(n[0]=a+(i-(o=r[l*t+u-1]))/(c-o)-.5),s>0&&s<e&&l===s&&(n[1]=s+(i-(o=r[(l-1)*t+u]))/(c-o)-.5)}))}return r.contour=i,r.size=function(n){if(!arguments.length)return[t,e];var i=Math.floor(n[0]),o=Math.floor(n[1]);return i>=0&&o>=0||Be("invalid size"),t=i,e=o,r},r.smooth=function(t){return arguments.length?(n=t?a:Iw,r):n===a},r};function Pw(t,e){for(var n,r=-1,i=e.length;++r<i;)if(n=jw(t,e[r]))return n;return 0}function jw(t,e){for(var n=e[0],r=e[1],i=-1,o=0,a=t.length,s=a-1;o<a;s=o++){var u=t[o],l=u[0],c=u[1],h=t[s],d=h[0],f=h[1];if(zw(u,h,e))return 0;c>r!=f>r&&n<(d-l)*(r-c)/(f-c)+l&&(i=-i)}return i}function zw(t,e,n){var r,i,o,a;return function(t,e,n){return(e[0]-t[0])*(n[1]-t[1])==(n[0]-t[0])*(e[1]-t[1])}(t,e,n)&&(i=t[r=+(t[0]===e[0])],a=e[r],i<=(o=n[r])&&o<=a||a<=o&&o<=i)}var Lw=function(t,e,n){return function(r){var i=Sn(r),o=n?Math.min(i[0],0):i[0],a=i[1],s=a-o,u=e?ei(o,a,t):s/(t+1);return nc(u,a,u)}};function Bw(t){Hs.call(this,null,t)}function Uw(t,e,n,r,i){const o=t.x1||0,a=t.y1||0,s=e*n<0;function u(t){t.forEach(l)}function l(t){s&&t.reverse(),t.forEach(c)}function c(t){t[0]=(t[0]-o)*e+r,t[1]=(t[1]-a)*n+i}return function(t){return t.coordinates.forEach(u),t}}function $w(t,e,n){const r=t>=0?t:yu(e,n);return Math.round((Math.sqrt(4*r*r+1)-1)/2)}function Vw(t){return gn(t)?t:_n(+t)}Bw.Definition={type:"Isocontour",metadata:{generates:!0},params:[{name:"field",type:"field"},{name:"thresholds",type:"number",array:!0},{name:"levels",type:"number"},{name:"nice",type:"boolean",default:!1},{name:"resolve",type:"enum",values:["shared","independent"],default:"independent"},{name:"zero",type:"boolean",default:!0},{name:"smooth",type:"boolean",default:!0},{name:"scale",type:"number",expr:!0},{name:"translate",type:"number",array:!0,expr:!0},{name:"as",type:"string",null:!0,default:"contour"}]},Tn(Bw,Hs,{transform(t,e){if(this.value&&!e.changed()&&!t.modified())return e.StopPropagation;var n=e.fork(e.NO_SOURCE|e.NO_FIELDS),r=e.materialize(e.SOURCE).source,i=t.field||We,o=Fw().smooth(!1!==t.smooth),a=t.thresholds||function(t,e,n){const r=Lw(n.levels||10,n.nice,!1!==n.zero);return"shared"!==n.resolve?r:r(t.map(t=>cu(e(t).values)))}(r,i,t),s=null===t.as?null:t.as||"contour",u=[];return r.forEach(e=>{const n=i(e),r=o.size([n.width,n.height])(n.values,Ye(a)?a:a(n.values));!function(t,e,n,r){let i=r.scale||e.scale,o=r.translate||e.translate;if(gn(i)&&(i=i(n,r)),gn(o)&&(o=o(n,r)),(1===i||null==i)&&!o)return;const a=(In(i)?i:i[0])||1,s=(In(i)?i:i[1])||1;t.forEach(Uw(e,a,s,o&&o[0]||0,o&&o[1]||0))}(r,n,e,t),r.forEach(t=>{u.push(tr(e,Qn(null!=s?{[s]:t}:t)))})}),this.value&&(n.rem=this.value),this.value=n.source=n.add=u,n}});var Ww=function(){var t=t=>t[0],e=t=>t[1],n=He,r=[-1,-1],i=960,o=500,a=2;function s(s,u){const l=$w(r[0],s,t)>>a,c=$w(r[1],s,e)>>a,h=l?l+2:0,d=c?c+2:0,f=2*h+(i>>a),p=2*d+(o>>a),m=new Float32Array(f*p),g=new Float32Array(f*p);let y=m;s.forEach(r=>{const i=h+(+t(r)>>a),o=d+(+e(r)>>a);i>=0&&i<f&&o>=0&&o<p&&(m[i+o*f]+=+n(r))}),l>0&&c>0?(qw(f,p,m,g,l),Hw(f,p,g,m,c),qw(f,p,m,g,l),Hw(f,p,g,m,c),qw(f,p,m,g,l),Hw(f,p,g,m,c)):l>0?(qw(f,p,m,g,l),qw(f,p,g,m,l),qw(f,p,m,g,l),y=g):c>0&&(Hw(f,p,m,g,c),Hw(f,p,g,m,c),Hw(f,p,m,g,c),y=g);let v=u?Math.pow(2,-2*a):1/bw(y);for(let t=0,e=f*p;t<e;++t)y[t]*=v;return{values:y,scale:1<<a,width:f,height:p,x1:h,y1:d,x2:h+(i>>a),y2:d+(o>>a)}}return s.x=function(e){return arguments.length?(t=Vw(e),s):t},s.y=function(t){return arguments.length?(e=Vw(t),s):e},s.weight=function(t){return arguments.length?(n=Vw(t),s):n},s.size=function(t){if(!arguments.length)return[i,o];var e=+t[0],n=+t[1];return e>=0&&n>=0||Be("invalid size"),i=e,o=n,s},s.cellSize=function(t){return arguments.length?((t=+t)>=1||Be("invalid cell size"),a=Math.floor(Math.log(t)/Math.LN2),s):1<<a},s.bandwidth=function(t){return arguments.length?(1===(t=mn(t)).length&&(t=[+t[0],+t[0]]),2!==t.length&&Be("invalid bandwidth"),r=t,s):r},s};function qw(t,e,n,r,i){const o=1+(i<<1);for(let a=0;a<e;++a)for(let e=0,s=0;e<t+i;++e)e<t&&(s+=n[e+a*t]),e>=i&&(e>=o&&(s-=n[e-o+a*t]),r[e-i+a*t]=s/Math.min(e+1,t-1+o-e,o))}function Hw(t,e,n,r,i){const o=1+(i<<1);for(let a=0;a<t;++a)for(let s=0,u=0;s<e+i;++s)s<e&&(u+=n[a+s*t]),s>=i&&(s>=o&&(u-=n[a+(s-o)*t]),r[a+(s-i)*t]=u/Math.min(s+1,e-1+o-s,o))}function Gw(t){Hs.call(this,null,t)}Gw.Definition={type:"KDE2D",metadata:{generates:!0},params:[{name:"size",type:"number",array:!0,length:2,required:!0},{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"weight",type:"field"},{name:"groupby",type:"field",array:!0},{name:"cellSize",type:"number"},{name:"bandwidth",type:"number",array:!0,length:2},{name:"counts",type:"boolean",default:!1},{name:"as",type:"string",default:"grid"}]};const Xw=["x","y","weight","size","cellSize","bandwidth"];function Kw(t,e){return Xw.forEach(n=>null!=e[n]?t[n](e[n]):0),t}function Yw(t){Hs.call(this,null,t)}function Zw(t){Hs.call(this,null,t)}Tn(Gw,Hs,{transform(t,e){if(this.value&&!e.changed()&&!t.modified())return e.StopPropagation;var n,r=e.fork(e.NO_SOURCE|e.NO_FIELDS),i=function(t,e){var n,r,i,o,a,s,u=[],l=t=>t(o);if(null==e)u.push(t);else for(n={},r=0,i=t.length;r<i;++r)o=t[r],(s=n[a=e.map(l)])||(n[a]=s=[],s.dims=a,u.push(s)),s.push(o);return u}(e.materialize(e.SOURCE).source,t.groupby),o=(t.groupby||[]).map(Fe),a=Kw(Ww(),t),s=t.as||"grid";return n=i.map(e=>Qn(function(t,e){for(let n=0;n<o.length;++n)t[o[n]]=e[n];return t}({[s]:a(e,t.counts)},e.dims))),this.value&&(r.rem=this.value),this.value=r.source=r.add=n,r}}),Yw.Definition={type:"Contour",metadata:{generates:!0},params:[{name:"size",type:"number",array:!0,length:2,required:!0},{name:"values",type:"number",array:!0},{name:"x",type:"field"},{name:"y",type:"field"},{name:"weight",type:"field"},{name:"cellSize",type:"number"},{name:"bandwidth",type:"number"},{name:"count",type:"number"},{name:"nice",type:"boolean",default:!1},{name:"thresholds",type:"number",array:!0},{name:"smooth",type:"boolean",default:!0}]},Tn(Yw,Hs,{transform(t,e){if(this.value&&!e.changed()&&!t.modified())return e.StopPropagation;var n,r,i=e.fork(e.NO_SOURCE|e.NO_FIELDS),o=Fw().smooth(!1!==t.smooth),a=t.values,s=t.thresholds||Lw(t.count||10,t.nice,!!a),u=t.size;return a||(a=e.materialize(e.SOURCE).source,r=Uw(n=Kw(Ww(),t)(a,!0),n.scale||1,n.scale||1,0,0),u=[n.width,n.height],a=n.values),s=Ye(s)?s:s(a),a=o.size(u)(a,s),r&&a.forEach(r),this.value&&(i.rem=this.value),this.value=i.source=i.add=(a||[]).map(Qn),i}}),Zw.Definition={type:"GeoJSON",metadata:{},params:[{name:"fields",type:"field",array:!0,length:2},{name:"geojson",type:"field"}]},Tn(Zw,Hs,{transform(t,e){var n,r=this._features,i=this._points,o=t.fields,a=o&&o[0],s=o&&o[1],u=t.geojson||!o&&We,l=e.ADD;n=t.modified()||e.changed(e.REM)||e.modified(Pe(u))||a&&e.modified(Pe(a))||s&&e.modified(Pe(s)),this.value&&!n||(l=e.SOURCE,this._features=r=[],this._points=i=[]),u&&e.visit(l,t=>r.push(u(t))),a&&s&&(e.visit(l,t=>{var e=a(t),n=s(t);null!=e&&null!=n&&(e=+e)===e&&(n=+n)===n&&i.push([e,n])}),r=r.concat({type:"Feature",geometry:{type:"MultiPoint",coordinates:i}})),this.value={type:"FeatureCollection",features:r}}});var Qw=function(t){return t};function Jw(t,e){t&&ex.hasOwnProperty(t.type)&&ex[t.type](t,e)}var tx={Feature:function(t,e){Jw(t.geometry,e)},FeatureCollection:function(t,e){for(var n=t.features,r=-1,i=n.length;++r<i;)Jw(n[r].geometry,e)}},ex={Sphere:function(t,e){e.sphere()},Point:function(t,e){e.point((t=t.coordinates)[0],t[1],t[2])},MultiPoint:function(t,e){for(var n=t.coordinates,r=-1,i=n.length;++r<i;)e.point((t=n[r])[0],t[1],t[2])},LineString:function(t,e){nx(t.coordinates,e,0)},MultiLineString:function(t,e){for(var n=t.coordinates,r=-1,i=n.length;++r<i;)nx(n[r],e,0)},Polygon:function(t,e){rx(t.coordinates,e)},MultiPolygon:function(t,e){for(var n=t.coordinates,r=-1,i=n.length;++r<i;)rx(n[r],e)},GeometryCollection:function(t,e){for(var n=t.geometries,r=-1,i=n.length;++r<i;)Jw(n[r],e)}};function nx(t,e,n){var r,i=-1,o=t.length-n;for(e.lineStart();++i<o;)e.point((r=t[i])[0],r[1],r[2]);e.lineEnd()}function rx(t,e){var n=-1,r=t.length;for(e.polygonStart();++n<r;)nx(t[n],e,1);e.polygonEnd()}var ix=function(t,e){t&&tx.hasOwnProperty(t.type)?tx[t.type](t,e):Jw(t,e)},ox=function(){return new ax};function ax(){this.reset()}ax.prototype={constructor:ax,reset:function(){this.s=this.t=0},add:function(t){ux(sx,t,this.t),ux(this,sx.s,this.s),this.s?this.t+=sx.t:this.s=sx.t},valueOf:function(){return this.s}};var sx=new ax;function ux(t,e,n){var r=t.s=e+n,i=r-e;t.t=e-(r-i)+(n-i)}var lx=Math.PI,cx=lx/2,hx=lx/4,dx=2*lx,fx=180/lx,px=lx/180,mx=Math.abs,gx=Math.atan,yx=Math.atan2,vx=Math.cos,bx=Math.ceil,wx=Math.exp,xx=(Math,Math.log),_x=Math.pow,Cx=Math.sin,kx=Math.sign||function(t){return t>0?1:t<0?-1:0},Sx=Math.sqrt,Ex=Math.tan;function Ox(t){return t>1?0:t<-1?lx:Math.acos(t)}function Ax(t){return t>1?cx:t<-1?-cx:Math.asin(t)}function Nx(){}var Tx,Dx,Rx,Ix,Mx=ox(),Fx=ox(),Px={point:Nx,lineStart:Nx,lineEnd:Nx,polygonStart:function(){Px.lineStart=jx,Px.lineEnd=Bx},polygonEnd:function(){Px.lineStart=Px.lineEnd=Px.point=Nx,Mx.add(mx(Fx)),Fx.reset()},result:function(){var t=Mx/2;return Mx.reset(),t}};function jx(){Px.point=zx}function zx(t,e){Px.point=Lx,Tx=Rx=t,Dx=Ix=e}function Lx(t,e){Fx.add(Ix*t-Rx*e),Rx=t,Ix=e}function Bx(){Lx(Tx,Dx)}var Ux,$x,Vx,Wx,qx=Px,Hx=1/0,Gx=Hx,Xx=-Hx,Kx=Xx,Yx={point:function(t,e){t<Hx&&(Hx=t),t>Xx&&(Xx=t),e<Gx&&(Gx=e),e>Kx&&(Kx=e)},lineStart:Nx,lineEnd:Nx,polygonStart:Nx,polygonEnd:Nx,result:function(){var t=[[Hx,Gx],[Xx,Kx]];return Xx=Kx=-(Gx=Hx=1/0),t}},Zx=0,Qx=0,Jx=0,t_=0,e_=0,n_=0,r_=0,i_=0,o_=0,a_={point:s_,lineStart:u_,lineEnd:h_,polygonStart:function(){a_.lineStart=d_,a_.lineEnd=f_},polygonEnd:function(){a_.point=s_,a_.lineStart=u_,a_.lineEnd=h_},result:function(){var t=o_?[r_/o_,i_/o_]:n_?[t_/n_,e_/n_]:Jx?[Zx/Jx,Qx/Jx]:[NaN,NaN];return Zx=Qx=Jx=t_=e_=n_=r_=i_=o_=0,t}};function s_(t,e){Zx+=t,Qx+=e,++Jx}function u_(){a_.point=l_}function l_(t,e){a_.point=c_,s_(Vx=t,Wx=e)}function c_(t,e){var n=t-Vx,r=e-Wx,i=Sx(n*n+r*r);t_+=i*(Vx+t)/2,e_+=i*(Wx+e)/2,n_+=i,s_(Vx=t,Wx=e)}function h_(){a_.point=s_}function d_(){a_.point=p_}function f_(){m_(Ux,$x)}function p_(t,e){a_.point=m_,s_(Ux=Vx=t,$x=Wx=e)}function m_(t,e){var n=t-Vx,r=e-Wx,i=Sx(n*n+r*r);t_+=i*(Vx+t)/2,e_+=i*(Wx+e)/2,n_+=i,r_+=(i=Wx*t-Vx*e)*(Vx+t),i_+=i*(Wx+e),o_+=3*i,s_(Vx=t,Wx=e)}var g_=a_;function y_(t){this._context=t}y_.prototype={_radius:4.5,pointRadius:function(t){return this._radius=t,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){0===this._line&&this._context.closePath(),this._point=NaN},point:function(t,e){switch(this._point){case 0:this._context.moveTo(t,e),this._point=1;break;case 1:this._context.lineTo(t,e);break;default:this._context.moveTo(t+this._radius,e),this._context.arc(t,e,this._radius,0,dx)}},result:Nx};var v_,b_,w_,x_,__,C_=ox(),k_={point:Nx,lineStart:function(){k_.point=S_},lineEnd:function(){v_&&E_(b_,w_),k_.point=Nx},polygonStart:function(){v_=!0},polygonEnd:function(){v_=null},result:function(){var t=+C_;return C_.reset(),t}};function S_(t,e){k_.point=E_,b_=x_=t,w_=__=e}function E_(t,e){C_.add(Sx((x_-=t)*x_+(__-=e)*__)),x_=t,__=e}var O_=k_;function A_(){this._string=[]}function N_(t){return"m0,"+t+"a"+t+","+t+" 0 1,1 0,"+-2*t+"a"+t+","+t+" 0 1,1 0,"+2*t+"z"}A_.prototype={_radius:4.5,_circle:N_(4.5),pointRadius:function(t){return(t=+t)!==this._radius&&(this._radius=t,this._circle=null),this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){0===this._line&&this._string.push("Z"),this._point=NaN},point:function(t,e){switch(this._point){case 0:this._string.push("M",t,",",e),this._point=1;break;case 1:this._string.push("L",t,",",e);break;default:null==this._circle&&(this._circle=N_(this._radius)),this._string.push("M",t,",",e,this._circle)}},result:function(){if(this._string.length){var t=this._string.join("");return this._string=[],t}return null}};var T_=function(t,e){var n,r,i=4.5;function o(t){return t&&("function"==typeof i&&r.pointRadius(+i.apply(this,arguments)),ix(t,n(r))),r.result()}return o.area=function(t){return ix(t,n(qx)),qx.result()},o.measure=function(t){return ix(t,n(O_)),O_.result()},o.bounds=function(t){return ix(t,n(Yx)),Yx.result()},o.centroid=function(t){return ix(t,n(g_)),g_.result()},o.projection=function(e){return arguments.length?(n=null==e?(t=null,Qw):(t=e).stream,o):t},o.context=function(t){return arguments.length?(r=null==t?(e=null,new A_):new y_(e=t),"function"!=typeof i&&r.pointRadius(i),o):e},o.pointRadius=function(t){return arguments.length?(i="function"==typeof t?t:(r.pointRadius(+t),+t),o):i},o.projection(t).context(e)},D_=function(){var t,e=[];return{point:function(e,n,r){t.push([e,n,r])},lineStart:function(){e.push(t=[])},lineEnd:Nx,rejoin:function(){e.length>1&&e.push(e.pop().concat(e.shift()))},result:function(){var n=e;return e=[],t=null,n}}},R_=function(t,e){return mx(t[0]-e[0])<1e-6&&mx(t[1]-e[1])<1e-6};function I_(t,e,n,r){this.x=t,this.z=e,this.o=n,this.e=r,this.v=!1,this.n=this.p=null}var M_=function(t,e,n,r,i){var o,a,s=[],u=[];if(t.forEach((function(t){if(!((e=t.length-1)<=0)){var e,n,r=t[0],a=t[e];if(R_(r,a)){if(!r[2]&&!a[2]){for(i.lineStart(),o=0;o<e;++o)i.point((r=t[o])[0],r[1]);return void i.lineEnd()}a[0]+=2e-6}s.push(n=new I_(r,t,null,!0)),u.push(n.o=new I_(r,null,n,!1)),s.push(n=new I_(a,t,null,!1)),u.push(n.o=new I_(a,null,n,!0))}})),s.length){for(u.sort(e),F_(s),F_(u),o=0,a=u.length;o<a;++o)u[o].e=n=!n;for(var l,c,h=s[0];;){for(var d=h,f=!0;d.v;)if((d=d.n)===h)return;l=d.z,i.lineStart();do{if(d.v=d.o.v=!0,d.e){if(f)for(o=0,a=l.length;o<a;++o)i.point((c=l[o])[0],c[1]);else r(d.x,d.n.x,1,i);d=d.n}else{if(f)for(o=(l=d.p.z).length-1;o>=0;--o)i.point((c=l[o])[0],c[1]);else r(d.x,d.p.x,-1,i);d=d.p}l=(d=d.o).z,f=!f}while(!d.v);i.lineEnd()}}};function F_(t){if(e=t.length){for(var e,n,r=0,i=t[0];++r<e;)i.n=n=t[r],n.p=i,i=n;i.n=n=t[0],n.p=i}}function P_(t){return[yx(t[1],t[0]),Ax(t[2])]}function j_(t){var e=t[0],n=t[1],r=vx(n);return[r*vx(e),r*Cx(e),Cx(n)]}function z_(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function L_(t,e){return[t[1]*e[2]-t[2]*e[1],t[2]*e[0]-t[0]*e[2],t[0]*e[1]-t[1]*e[0]]}function B_(t,e){t[0]+=e[0],t[1]+=e[1],t[2]+=e[2]}function U_(t,e){return[t[0]*e,t[1]*e,t[2]*e]}function $_(t){var e=Sx(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]);t[0]/=e,t[1]/=e,t[2]/=e}var V_=ox();function W_(t){return mx(t[0])<=lx?t[0]:kx(t[0])*((mx(t[0])+lx)%dx-lx)}var q_,H_,G_=function(t,e){return t<e?-1:t>e?1:t>=e?0:NaN};1===(q_=G_).length&&(H_=q_,q_=function(t,e){return G_(H_(t),e)});var X_=function(t,e,n){t=+t,e=+e,n=(i=arguments.length)<2?(e=t,t=0,1):i<3?1:+n;for(var r=-1,i=0|Math.max(0,Math.ceil((e-t)/n)),o=new Array(i);++r<i;)o[r]=t+r*n;return o};Math.sqrt(50),Math.sqrt(10),Math.sqrt(2);var K_=function(t){for(var e,n,r,i=t.length,o=-1,a=0;++o<i;)a+=t[o].length;for(n=new Array(a);--i>=0;)for(e=(r=t[i]).length;--e>=0;)n[--a]=r[e];return n},Y_=function(t,e,n,r){return function(i){var o,a,s,u=e(i),l=D_(),c=e(l),h=!1,d={point:f,lineStart:m,lineEnd:g,polygonStart:function(){d.point=y,d.lineStart=v,d.lineEnd=b,a=[],o=[]},polygonEnd:function(){d.point=f,d.lineStart=m,d.lineEnd=g,a=K_(a);var t=function(t,e){var n=W_(e),r=e[1],i=Cx(r),o=[Cx(n),-vx(n),0],a=0,s=0;V_.reset(),1===i?r=cx+1e-6:-1===i&&(r=-cx-1e-6);for(var u=0,l=t.length;u<l;++u)if(h=(c=t[u]).length)for(var c,h,d=c[h-1],f=W_(d),p=d[1]/2+hx,m=Cx(p),g=vx(p),y=0;y<h;++y,f=b,m=x,g=_,d=v){var v=c[y],b=W_(v),w=v[1]/2+hx,x=Cx(w),_=vx(w),C=b-f,k=C>=0?1:-1,S=k*C,E=S>lx,O=m*x;if(V_.add(yx(O*k*Cx(S),g*_+O*vx(S))),a+=E?C+k*dx:C,E^f>=n^b>=n){var A=L_(j_(d),j_(v));$_(A);var N=L_(o,A);$_(N);var T=(E^C>=0?-1:1)*Ax(N[2]);(r>T||r===T&&(A[0]||A[1]))&&(s+=E^C>=0?1:-1)}}return(a<-1e-6||a<1e-6&&V_<-1e-6)^1&s}(o,r);a.length?(h||(i.polygonStart(),h=!0),M_(a,Q_,t,n,i)):t&&(h||(i.polygonStart(),h=!0),i.lineStart(),n(null,null,1,i),i.lineEnd()),h&&(i.polygonEnd(),h=!1),a=o=null},sphere:function(){i.polygonStart(),i.lineStart(),n(null,null,1,i),i.lineEnd(),i.polygonEnd()}};function f(e,n){t(e,n)&&i.point(e,n)}function p(t,e){u.point(t,e)}function m(){d.point=p,u.lineStart()}function g(){d.point=f,u.lineEnd()}function y(t,e){s.push([t,e]),c.point(t,e)}function v(){c.lineStart(),s=[]}function b(){y(s[0][0],s[0][1]),c.lineEnd();var t,e,n,r,u=c.clean(),d=l.result(),f=d.length;if(s.pop(),o.push(s),s=null,f)if(1&u){if((e=(n=d[0]).length-1)>0){for(h||(i.polygonStart(),h=!0),i.lineStart(),t=0;t<e;++t)i.point((r=n[t])[0],r[1]);i.lineEnd()}}else f>1&&2&u&&d.push(d.pop().concat(d.shift())),a.push(d.filter(Z_))}return d}};function Z_(t){return t.length>1}function Q_(t,e){return((t=t.x)[0]<0?t[1]-cx-1e-6:cx-t[1])-((e=e.x)[0]<0?e[1]-cx-1e-6:cx-e[1])}var J_=Y_((function(){return!0}),(function(t){var e,n=NaN,r=NaN,i=NaN;return{lineStart:function(){t.lineStart(),e=1},point:function(o,a){var s=o>0?lx:-lx,u=mx(o-n);mx(u-lx)<1e-6?(t.point(n,r=(r+a)/2>0?cx:-cx),t.point(i,r),t.lineEnd(),t.lineStart(),t.point(s,r),t.point(o,r),e=0):i!==s&&u>=lx&&(mx(n-i)<1e-6&&(n-=1e-6*i),mx(o-s)<1e-6&&(o-=1e-6*s),r=function(t,e,n,r){var i,o,a=Cx(t-n);return mx(a)>1e-6?gx((Cx(e)*(o=vx(r))*Cx(n)-Cx(r)*(i=vx(e))*Cx(t))/(i*o*a)):(e+r)/2}(n,r,o,a),t.point(i,r),t.lineEnd(),t.lineStart(),t.point(s,r),e=0),t.point(n=o,r=a),i=s},lineEnd:function(){t.lineEnd(),n=r=NaN},clean:function(){return 2-e}}}),(function(t,e,n,r){var i;if(null==t)r.point(-lx,i=n*cx),r.point(0,i),r.point(lx,i),r.point(lx,0),r.point(lx,-i),r.point(0,-i),r.point(-lx,-i),r.point(-lx,0),r.point(-lx,i);else if(mx(t[0]-e[0])>1e-6){var o=t[0]<e[0]?lx:-lx;r.point(-o,i=n*o/2),r.point(0,i),r.point(o,i)}else r.point(e[0],e[1])}),[-lx,-cx]),tC=function(t,e){function n(n,r){return n=t(n,r),e(n[0],n[1])}return t.invert&&e.invert&&(n.invert=function(n,r){return(n=e.invert(n,r))&&t.invert(n[0],n[1])}),n};function eC(t,e){return[mx(t)>lx?t+Math.round(-t/dx)*dx:t,e]}function nC(t,e,n){return(t%=dx)?e||n?tC(iC(t),oC(e,n)):iC(t):e||n?oC(e,n):eC}function rC(t){return function(e,n){return[(e+=t)>lx?e-dx:e<-lx?e+dx:e,n]}}function iC(t){var e=rC(t);return e.invert=rC(-t),e}function oC(t,e){var n=vx(t),r=Cx(t),i=vx(e),o=Cx(e);function a(t,e){var a=vx(e),s=vx(t)*a,u=Cx(t)*a,l=Cx(e),c=l*n+s*r;return[yx(u*i-c*o,s*n-l*r),Ax(c*i+u*o)]}return a.invert=function(t,e){var a=vx(e),s=vx(t)*a,u=Cx(t)*a,l=Cx(e),c=l*i-u*o;return[yx(u*i+l*o,s*n+c*r),Ax(c*n-s*r)]},a}function aC(t,e){(e=j_(e))[0]-=t,$_(e);var n=Ox(-e[1]);return((-e[2]<0?-n:n)+dx-1e-6)%dx}eC.invert=eC;var sC=function(t){var e=vx(t),n=6*px,r=e>0,i=mx(e)>1e-6;function o(t,n){return vx(t)*vx(n)>e}function a(t,n,r){var i=[1,0,0],o=L_(j_(t),j_(n)),a=z_(o,o),s=o[0],u=a-s*s;if(!u)return!r&&t;var l=e*a/u,c=-e*s/u,h=L_(i,o),d=U_(i,l);B_(d,U_(o,c));var f=h,p=z_(d,f),m=z_(f,f),g=p*p-m*(z_(d,d)-1);if(!(g<0)){var y=Sx(g),v=U_(f,(-p-y)/m);if(B_(v,d),v=P_(v),!r)return v;var b,w=t[0],x=n[0],_=t[1],C=n[1];x<w&&(b=w,w=x,x=b);var k=x-w,S=mx(k-lx)<1e-6;if(!S&&C<_&&(b=_,_=C,C=b),S||k<1e-6?S?_+C>0^v[1]<(mx(v[0]-w)<1e-6?_:C):_<=v[1]&&v[1]<=C:k>lx^(w<=v[0]&&v[0]<=x)){var E=U_(f,(-p+y)/m);return B_(E,d),[v,P_(E)]}}}function s(e,n){var i=r?t:lx-t,o=0;return e<-i?o|=1:e>i&&(o|=2),n<-i?o|=4:n>i&&(o|=8),o}return Y_(o,(function(t){var e,n,u,l,c;return{lineStart:function(){l=u=!1,c=1},point:function(h,d){var f,p=[h,d],m=o(h,d),g=r?m?0:s(h,d):m?s(h+(h<0?lx:-lx),d):0;if(!e&&(l=u=m)&&t.lineStart(),m!==u&&(!(f=a(e,p))||R_(e,f)||R_(p,f))&&(p[2]=1),m!==u)c=0,m?(t.lineStart(),f=a(p,e),t.point(f[0],f[1])):(f=a(e,p),t.point(f[0],f[1],2),t.lineEnd()),e=f;else if(i&&e&&r^m){var y;g&n||!(y=a(p,e,!0))||(c=0,r?(t.lineStart(),t.point(y[0][0],y[0][1]),t.point(y[1][0],y[1][1]),t.lineEnd()):(t.point(y[1][0],y[1][1]),t.lineEnd(),t.lineStart(),t.point(y[0][0],y[0][1],3)))}!m||e&&R_(e,p)||t.point(p[0],p[1]),e=p,u=m,n=g},lineEnd:function(){u&&t.lineEnd(),e=null},clean:function(){return c|(l&&u)<<1}}}),(function(e,r,i,o){!function(t,e,n,r,i,o){if(n){var a=vx(e),s=Cx(e),u=r*n;null==i?(i=e+r*dx,o=e-u/2):(i=aC(a,i),o=aC(a,o),(r>0?i<o:i>o)&&(i+=r*dx));for(var l,c=i;r>0?c>o:c<o;c-=u)l=P_([a,-s*vx(c),-s*Cx(c)]),t.point(l[0],l[1])}}(o,t,n,i,e,r)}),r?[0,-t]:[-lx,t-lx])};function uC(t,e,n,r){function i(i,o){return t<=i&&i<=n&&e<=o&&o<=r}function o(i,o,s,l){var c=0,h=0;if(null==i||(c=a(i,s))!==(h=a(o,s))||u(i,o)<0^s>0)do{l.point(0===c||3===c?t:n,c>1?r:e)}while((c=(c+s+4)%4)!==h);else l.point(o[0],o[1])}function a(r,i){return mx(r[0]-t)<1e-6?i>0?0:3:mx(r[0]-n)<1e-6?i>0?2:1:mx(r[1]-e)<1e-6?i>0?1:0:i>0?3:2}function s(t,e){return u(t.x,e.x)}function u(t,e){var n=a(t,1),r=a(e,1);return n!==r?n-r:0===n?e[1]-t[1]:1===n?t[0]-e[0]:2===n?t[1]-e[1]:e[0]-t[0]}return function(a){var u,l,c,h,d,f,p,m,g,y,v,b=a,w=D_(),x={point:_,lineStart:function(){x.point=C,l&&l.push(c=[]),y=!0,g=!1,p=m=NaN},lineEnd:function(){u&&(C(h,d),f&&g&&w.rejoin(),u.push(w.result())),x.point=_,g&&b.lineEnd()},polygonStart:function(){b=w,u=[],l=[],v=!0},polygonEnd:function(){var e=function(){for(var e=0,n=0,i=l.length;n<i;++n)for(var o,a,s=l[n],u=1,c=s.length,h=s[0],d=h[0],f=h[1];u<c;++u)o=d,a=f,d=(h=s[u])[0],f=h[1],a<=r?f>r&&(d-o)*(r-a)>(f-a)*(t-o)&&++e:f<=r&&(d-o)*(r-a)<(f-a)*(t-o)&&--e;return e}(),n=v&&e,i=(u=K_(u)).length;(n||i)&&(a.polygonStart(),n&&(a.lineStart(),o(null,null,1,a),a.lineEnd()),i&&M_(u,s,e,o,a),a.polygonEnd()),b=a,u=l=c=null}};function _(t,e){i(t,e)&&b.point(t,e)}function C(o,a){var s=i(o,a);if(l&&c.push([o,a]),y)h=o,d=a,f=s,y=!1,s&&(b.lineStart(),b.point(o,a));else if(s&&g)b.point(o,a);else{var u=[p=Math.max(-1e9,Math.min(1e9,p)),m=Math.max(-1e9,Math.min(1e9,m))],w=[o=Math.max(-1e9,Math.min(1e9,o)),a=Math.max(-1e9,Math.min(1e9,a))];!function(t,e,n,r,i,o){var a,s=t[0],u=t[1],l=0,c=1,h=e[0]-s,d=e[1]-u;if(a=n-s,h||!(a>0)){if(a/=h,h<0){if(a<l)return;a<c&&(c=a)}else if(h>0){if(a>c)return;a>l&&(l=a)}if(a=i-s,h||!(a<0)){if(a/=h,h<0){if(a>c)return;a>l&&(l=a)}else if(h>0){if(a<l)return;a<c&&(c=a)}if(a=r-u,d||!(a>0)){if(a/=d,d<0){if(a<l)return;a<c&&(c=a)}else if(d>0){if(a>c)return;a>l&&(l=a)}if(a=o-u,d||!(a<0)){if(a/=d,d<0){if(a>c)return;a>l&&(l=a)}else if(d>0){if(a<l)return;a<c&&(c=a)}return l>0&&(t[0]=s+l*h,t[1]=u+l*d),c<1&&(e[0]=s+c*h,e[1]=u+c*d),!0}}}}}(u,w,t,e,n,r)?s&&(b.lineStart(),b.point(o,a),v=!1):(g||(b.lineStart(),b.point(u[0],u[1])),b.point(w[0],w[1]),s||b.lineEnd(),v=!1)}p=o,m=a,g=s}return x}}function lC(t){return function(e){var n=new cC;for(var r in t)n[r]=t[r];return n.stream=e,n}}function cC(){}function hC(t,e,n){var r=t.clipExtent&&t.clipExtent();return t.scale(150).translate([0,0]),null!=r&&t.clipExtent(null),ix(n,t.stream(Yx)),e(Yx.result()),null!=r&&t.clipExtent(r),t}function dC(t,e,n){return hC(t,(function(n){var r=e[1][0]-e[0][0],i=e[1][1]-e[0][1],o=Math.min(r/(n[1][0]-n[0][0]),i/(n[1][1]-n[0][1])),a=+e[0][0]+(r-o*(n[1][0]+n[0][0]))/2,s=+e[0][1]+(i-o*(n[1][1]+n[0][1]))/2;t.scale(150*o).translate([a,s])}),n)}function fC(t,e,n){return dC(t,[[0,0],e],n)}function pC(t,e,n){return hC(t,(function(n){var r=+e,i=r/(n[1][0]-n[0][0]),o=(r-i*(n[1][0]+n[0][0]))/2,a=-i*n[0][1];t.scale(150*i).translate([o,a])}),n)}function mC(t,e,n){return hC(t,(function(n){var r=+e,i=r/(n[1][1]-n[0][1]),o=-i*n[0][0],a=(r-i*(n[1][1]+n[0][1]))/2;t.scale(150*i).translate([o,a])}),n)}cC.prototype={constructor:cC,point:function(t,e){this.stream.point(t,e)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};var gC=vx(30*px),yC=function(t,e){return+e?function(t,e){function n(r,i,o,a,s,u,l,c,h,d,f,p,m,g){var y=l-r,v=c-i,b=y*y+v*v;if(b>4*e&&m--){var w=a+d,x=s+f,_=u+p,C=Sx(w*w+x*x+_*_),k=Ax(_/=C),S=mx(mx(_)-1)<1e-6||mx(o-h)<1e-6?(o+h)/2:yx(x,w),E=t(S,k),O=E[0],A=E[1],N=O-r,T=A-i,D=v*N-y*T;(D*D/b>e||mx((y*N+v*T)/b-.5)>.3||a*d+s*f+u*p<gC)&&(n(r,i,o,a,s,u,O,A,S,w/=C,x/=C,_,m,g),g.point(O,A),n(O,A,S,w,x,_,l,c,h,d,f,p,m,g))}}return function(e){var r,i,o,a,s,u,l,c,h,d,f,p,m={point:g,lineStart:y,lineEnd:b,polygonStart:function(){e.polygonStart(),m.lineStart=w},polygonEnd:function(){e.polygonEnd(),m.lineStart=y}};function g(n,r){n=t(n,r),e.point(n[0],n[1])}function y(){c=NaN,m.point=v,e.lineStart()}function v(r,i){var o=j_([r,i]),a=t(r,i);n(c,h,l,d,f,p,c=a[0],h=a[1],l=r,d=o[0],f=o[1],p=o[2],16,e),e.point(c,h)}function b(){m.point=g,e.lineEnd()}function w(){y(),m.point=x,m.lineEnd=_}function x(t,e){v(r=t,e),i=c,o=h,a=d,s=f,u=p,m.point=v}function _(){n(c,h,l,d,f,p,i,o,r,a,s,u,16,e),m.lineEnd=b,b()}return m}}(t,e):function(t){return lC({point:function(e,n){e=t(e,n),this.stream.point(e[0],e[1])}})}(t)},vC=lC({point:function(t,e){this.stream.point(t*px,e*px)}});function bC(t,e,n,r,i){function o(o,a){return[e+t*(o*=r),n-t*(a*=i)]}return o.invert=function(o,a){return[(o-e)/t*r,(n-a)/t*i]},o}function wC(t,e,n,r,i,o){var a=vx(o),s=Cx(o),u=a*t,l=s*t,c=a/t,h=s/t,d=(s*n-a*e)/t,f=(s*e+a*n)/t;function p(t,o){return[u*(t*=r)-l*(o*=i)+e,n-l*t-u*o]}return p.invert=function(t,e){return[r*(c*t-h*e+d),i*(f-h*t-c*e)]},p}function xC(t){return _C((function(){return t}))()}function _C(t){var e,n,r,i,o,a,s,u,l,c,h=150,d=480,f=250,p=0,m=0,g=0,y=0,v=0,b=0,w=1,x=1,_=null,C=J_,k=null,S=Qw,E=.5;function O(t){return u(t[0]*px,t[1]*px)}function A(t){return(t=u.invert(t[0],t[1]))&&[t[0]*fx,t[1]*fx]}function N(){var t=wC(h,0,0,w,x,b).apply(null,e(p,m)),r=(b?wC:bC)(h,d-t[0],f-t[1],w,x,b);return n=nC(g,y,v),s=tC(e,r),u=tC(n,s),a=yC(s,E),T()}function T(){return l=c=null,O}return O.stream=function(t){return l&&c===t?l:l=vC(function(t){return lC({point:function(e,n){var r=t(e,n);return this.stream.point(r[0],r[1])}})}(n)(C(a(S(c=t)))))},O.preclip=function(t){return arguments.length?(C=t,_=void 0,T()):C},O.postclip=function(t){return arguments.length?(S=t,k=r=i=o=null,T()):S},O.clipAngle=function(t){return arguments.length?(C=+t?sC(_=t*px):(_=null,J_),T()):_*fx},O.clipExtent=function(t){return arguments.length?(S=null==t?(k=r=i=o=null,Qw):uC(k=+t[0][0],r=+t[0][1],i=+t[1][0],o=+t[1][1]),T()):null==k?null:[[k,r],[i,o]]},O.scale=function(t){return arguments.length?(h=+t,N()):h},O.translate=function(t){return arguments.length?(d=+t[0],f=+t[1],N()):[d,f]},O.center=function(t){return arguments.length?(p=t[0]%360*px,m=t[1]%360*px,N()):[p*fx,m*fx]},O.rotate=function(t){return arguments.length?(g=t[0]%360*px,y=t[1]%360*px,v=t.length>2?t[2]%360*px:0,N()):[g*fx,y*fx,v*fx]},O.angle=function(t){return arguments.length?(b=t%360*px,N()):b*fx},O.reflectX=function(t){return arguments.length?(w=t?-1:1,N()):w<0},O.reflectY=function(t){return arguments.length?(x=t?-1:1,N()):x<0},O.precision=function(t){return arguments.length?(a=yC(s,E=t*t),T()):Sx(E)},O.fitExtent=function(t,e){return dC(O,t,e)},O.fitSize=function(t,e){return fC(O,t,e)},O.fitWidth=function(t,e){return pC(O,t,e)},O.fitHeight=function(t,e){return mC(O,t,e)},function(){return e=t.apply(this,arguments),O.invert=e.invert&&A,N()}}function CC(t){var e=0,n=lx/3,r=_C(t),i=r(e,n);return i.parallels=function(t){return arguments.length?r(e=t[0]*px,n=t[1]*px):[e*fx,n*fx]},i}function kC(t,e){var n=Cx(t),r=(n+Cx(e))/2;if(mx(r)<1e-6)return function(t){var e=vx(t);function n(t,n){return[t*e,Cx(n)/e]}return n.invert=function(t,n){return[t/e,Ax(n*e)]},n}(t);var i=1+n*(2*r-n),o=Sx(i)/r;function a(t,e){var n=Sx(i-2*r*Cx(e))/r;return[n*Cx(t*=r),o-n*vx(t)]}return a.invert=function(t,e){var n=o-e,a=yx(t,mx(n))*kx(n);return n*r<0&&(a-=lx*kx(t)*kx(n)),[a/r,Ax((i-(t*t+n*n)*r*r)/(2*r))]},a}var SC=function(){return CC(kC).scale(155.424).center([0,33.6442])},EC=function(){return SC().parallels([29.5,45.5]).scale(1070).translate([480,250]).rotate([96,0]).center([-.6,38.7])};function OC(t){return function(e,n){var r=vx(e),i=vx(n),o=t(r*i);return[o*i*Cx(e),o*Cx(n)]}}function AC(t){return function(e,n){var r=Sx(e*e+n*n),i=t(r),o=Cx(i),a=vx(i);return[yx(e*o,r*a),Ax(r&&n*o/r)]}}var NC=OC((function(t){return Sx(2/(1+t))}));NC.invert=AC((function(t){return 2*Ax(t/2)}));var TC=OC((function(t){return(t=Ox(t))&&t/Cx(t)}));function DC(t,e){return[t,xx(Ex((cx+e)/2))]}function RC(t){var e,n,r,i=xC(t),o=i.center,a=i.scale,s=i.translate,u=i.clipExtent,l=null;function c(){var o=lx*a(),s=i(function(t){function e(e){return(e=t(e[0]*px,e[1]*px))[0]*=fx,e[1]*=fx,e}return t=nC(t[0]*px,t[1]*px,t.length>2?t[2]*px:0),e.invert=function(e){return(e=t.invert(e[0]*px,e[1]*px))[0]*=fx,e[1]*=fx,e},e}(i.rotate()).invert([0,0]));return u(null==l?[[s[0]-o,s[1]-o],[s[0]+o,s[1]+o]]:t===DC?[[Math.max(s[0]-o,l),e],[Math.min(s[0]+o,n),r]]:[[l,Math.max(s[1]-o,e)],[n,Math.min(s[1]+o,r)]])}return i.scale=function(t){return arguments.length?(a(t),c()):a()},i.translate=function(t){return arguments.length?(s(t),c()):s()},i.center=function(t){return arguments.length?(o(t),c()):o()},i.clipExtent=function(t){return arguments.length?(null==t?l=e=n=r=null:(l=+t[0][0],e=+t[0][1],n=+t[1][0],r=+t[1][1]),c()):null==l?null:[[l,e],[n,r]]},c()}function IC(t){return Ex((cx+t)/2)}function MC(t,e){var n=vx(t),r=t===e?Cx(t):xx(n/vx(e))/xx(IC(e)/IC(t)),i=n*_x(IC(t),r)/r;if(!r)return DC;function o(t,e){i>0?e<1e-6-cx&&(e=1e-6-cx):e>cx-1e-6&&(e=cx-1e-6);var n=i/_x(IC(e),r);return[n*Cx(r*t),i-n*vx(r*t)]}return o.invert=function(t,e){var n=i-e,o=kx(r)*Sx(t*t+n*n),a=yx(t,mx(n))*kx(n);return n*r<0&&(a-=lx*kx(t)*kx(n)),[a/r,2*gx(_x(i/o,1/r))-cx]},o}function FC(t,e){return[t,e]}function PC(t,e){var n=vx(t),r=t===e?Cx(t):(n-vx(e))/(e-t),i=n/r+t;if(mx(r)<1e-6)return FC;function o(t,e){var n=i-e,o=r*t;return[n*Cx(o),i-n*vx(o)]}return o.invert=function(t,e){var n=i-e,o=yx(t,mx(n))*kx(n);return n*r<0&&(o-=lx*kx(t)*kx(n)),[o/r,i-kx(r)*Sx(t*t+n*n)]},o}TC.invert=AC((function(t){return t})),DC.invert=function(t,e){return[t,2*gx(wx(e))-cx]},FC.invert=FC;var jC=1.340264,zC=-.081106,LC=893e-6,BC=.003796,UC=Sx(3)/2;function $C(t,e){var n=Ax(UC*Cx(e)),r=n*n,i=r*r*r;return[t*vx(n)/(UC*(jC+3*zC*r+i*(7*LC+9*BC*r))),n*(jC+zC*r+i*(LC+BC*r))]}function VC(t,e){var n=vx(e),r=vx(t)*n;return[n*Cx(t)/r,Cx(e)/r]}function WC(t,e){var n=e*e,r=n*n;return[t*(.8707-.131979*n+r*(r*(.003971*n-.001529*r)-.013791)),e*(1.007226+n*(.015085+r*(.028874*n-.044475-.005916*r)))]}function qC(t,e){return[vx(e)*Cx(t),Cx(e)]}function HC(t,e){var n=vx(e),r=1+vx(t)*n;return[n*Cx(t)/r,Cx(e)/r]}function GC(t,e){return[xx(Ex((cx+e)/2)),-t]}$C.invert=function(t,e){for(var n,r=e,i=r*r,o=i*i*i,a=0;a<12&&(o=(i=(r-=n=(r*(jC+zC*i+o*(LC+BC*i))-e)/(jC+3*zC*i+o*(7*LC+9*BC*i)))*r)*i*i,!(mx(n)<1e-12));++a);return[UC*t*(jC+3*zC*i+o*(7*LC+9*BC*i))/vx(r),Ax(Cx(r)/UC)]},VC.invert=AC(gx),WC.invert=function(t,e){var n,r=e,i=25;do{var o=r*r,a=o*o;r-=n=(r*(1.007226+o*(.015085+a*(.028874*o-.044475-.005916*a)))-e)/(1.007226+o*(.045255+a*(.259866*o-.311325-.005916*11*a)))}while(mx(n)>1e-6&&--i>0);return[t/(.8707+(o=r*r)*(o*(o*o*o*(.003971-.001529*o)-.013791)-.131979)),r]},qC.invert=AC(Ax),HC.invert=AC((function(t){return 2*gx(t)})),GC.invert=function(t,e){return[-e,2*gx(wx(t))-cx]};var XC=Math.abs,KC=(Math,Math,Math,Math.cos),YC=(Math,Math,Math,Math,Math,Math,Math,Math,Math.sin),ZC=(Math,Math.PI),QC=ZC/2,JC=(Math,ek(2));function tk(t){return t>1?QC:t<-1?-QC:Math.asin(t)}function ek(t){return t>0?Math.sqrt(t):0}function nk(t,e){var n,r=t*YC(e),i=30;do{e-=n=(e+YC(e)-r)/(1+KC(e))}while(XC(n)>1e-6&&--i>0);return e/2}ek(ZC);var rk=function(t,e,n){function r(r,i){return[t*r*KC(i=nk(n,i)),e*YC(i)]}return r.invert=function(r,i){return i=tk(i/e),[r/(t*KC(i)),tk((2*i+YC(2*i))/n)]},r}(JC/QC,JC,ZC);const ik=T_(),ok=["clipAngle","clipExtent","scale","translate","center","rotate","parallels","precision","reflectX","reflectY","coefficient","distance","fraction","lobes","parallel","radius","ratio","spacing","tilt"];function ak(t,e){return function n(){const r=e();return r.type=t,r.path=T_().projection(r),r.copy=r.copy||function(){const t=n();return ok.forEach((function(e){r[e]&&t[e](r[e]())})),t.path.pointRadius(r.path.pointRadius()),t},r}}function sk(t,e){if(!t||"string"!=typeof t)throw new Error("Projection type must be a name string.");return t=t.toLowerCase(),arguments.length>1?(lk[t]=ak(t,e),this):lk[t]||null}function uk(t){return t&&t.path||ik}const lk={albers:EC,albersusa:function(){var t,e,n,r,i,o,a=EC(),s=SC().rotate([154,0]).center([-2,58.5]).parallels([55,65]),u=SC().rotate([157,0]).center([-3,19.9]).parallels([8,18]),l={point:function(t,e){o=[t,e]}};function c(t){var e=t[0],a=t[1];return o=null,n.point(e,a),o||(r.point(e,a),o)||(i.point(e,a),o)}function h(){return t=e=null,c}return c.invert=function(t){var e=a.scale(),n=a.translate(),r=(t[0]-n[0])/e,i=(t[1]-n[1])/e;return(i>=.12&&i<.234&&r>=-.425&&r<-.214?s:i>=.166&&i<.234&&r>=-.214&&r<-.115?u:a).invert(t)},c.stream=function(n){return t&&e===n?t:(r=[a.stream(e=n),s.stream(n),u.stream(n)],i=r.length,t={point:function(t,e){for(var n=-1;++n<i;)r[n].point(t,e)},sphere:function(){for(var t=-1;++t<i;)r[t].sphere()},lineStart:function(){for(var t=-1;++t<i;)r[t].lineStart()},lineEnd:function(){for(var t=-1;++t<i;)r[t].lineEnd()},polygonStart:function(){for(var t=-1;++t<i;)r[t].polygonStart()},polygonEnd:function(){for(var t=-1;++t<i;)r[t].polygonEnd()}});var r,i},c.precision=function(t){return arguments.length?(a.precision(t),s.precision(t),u.precision(t),h()):a.precision()},c.scale=function(t){return arguments.length?(a.scale(t),s.scale(.35*t),u.scale(t),c.translate(a.translate())):a.scale()},c.translate=function(t){if(!arguments.length)return a.translate();var e=a.scale(),o=+t[0],c=+t[1];return n=a.translate(t).clipExtent([[o-.455*e,c-.238*e],[o+.455*e,c+.238*e]]).stream(l),r=s.translate([o-.307*e,c+.201*e]).clipExtent([[o-.425*e+1e-6,c+.12*e+1e-6],[o-.214*e-1e-6,c+.234*e-1e-6]]).stream(l),i=u.translate([o-.205*e,c+.212*e]).clipExtent([[o-.214*e+1e-6,c+.166*e+1e-6],[o-.115*e-1e-6,c+.234*e-1e-6]]).stream(l),h()},c.fitExtent=function(t,e){return dC(c,t,e)},c.fitSize=function(t,e){return fC(c,t,e)},c.fitWidth=function(t,e){return pC(c,t,e)},c.fitHeight=function(t,e){return mC(c,t,e)},c.scale(1070)},azimuthalequalarea:function(){return xC(NC).scale(124.75).clipAngle(179.999)},azimuthalequidistant:function(){return xC(TC).scale(79.4188).clipAngle(179.999)},conicconformal:function(){return CC(MC).scale(109.5).parallels([30,30])},conicequalarea:SC,conicequidistant:function(){return CC(PC).scale(131.154).center([0,13.9389])},equalEarth:function(){return xC($C).scale(177.158)},equirectangular:function(){return xC(FC).scale(152.63)},gnomonic:function(){return xC(VC).scale(144.049).clipAngle(60)},identity:function(){var t,e,n,r,i,o,a,s=1,u=0,l=0,c=1,h=1,d=0,f=null,p=1,m=1,g=lC({point:function(t,e){var n=b([t,e]);this.stream.point(n[0],n[1])}}),y=Qw;function v(){return p=s*c,m=s*h,o=a=null,b}function b(n){var r=n[0]*p,i=n[1]*m;if(d){var o=i*t-r*e;r=r*t+i*e,i=o}return[r+u,i+l]}return b.invert=function(n){var r=n[0]-u,i=n[1]-l;if(d){var o=i*t+r*e;r=r*t-i*e,i=o}return[r/p,i/m]},b.stream=function(t){return o&&a===t?o:o=g(y(a=t))},b.postclip=function(t){return arguments.length?(y=t,f=n=r=i=null,v()):y},b.clipExtent=function(t){return arguments.length?(y=null==t?(f=n=r=i=null,Qw):uC(f=+t[0][0],n=+t[0][1],r=+t[1][0],i=+t[1][1]),v()):null==f?null:[[f,n],[r,i]]},b.scale=function(t){return arguments.length?(s=+t,v()):s},b.translate=function(t){return arguments.length?(u=+t[0],l=+t[1],v()):[u,l]},b.angle=function(n){return arguments.length?(e=Cx(d=n%360*px),t=vx(d),v()):d*fx},b.reflectX=function(t){return arguments.length?(c=t?-1:1,v()):c<0},b.reflectY=function(t){return arguments.length?(h=t?-1:1,v()):h<0},b.fitExtent=function(t,e){return dC(b,t,e)},b.fitSize=function(t,e){return fC(b,t,e)},b.fitWidth=function(t,e){return pC(b,t,e)},b.fitHeight=function(t,e){return mC(b,t,e)},b},mercator:function(){return RC(DC).scale(961/dx)},mollweide:function(){return xC(rk).scale(169.529)},naturalEarth1:function(){return xC(WC).scale(175.295)},orthographic:function(){return xC(qC).scale(249.5).clipAngle(90.000001)},stereographic:function(){return xC(HC).scale(250).clipAngle(142)},transversemercator:function(){var t=RC(GC),e=t.center,n=t.rotate;return t.center=function(t){return arguments.length?e([-t[1],t[0]]):[(t=e())[1],-t[0]]},t.rotate=function(t){return arguments.length?n([t[0],t[1],t.length>2?t[2]+90:90]):[(t=n())[0],t[1],t[2]-90]},n([0,0,90]).scale(159.155)}};for(const cQ in lk)sk(cQ,lk[cQ]);function ck(t){Hs.call(this,null,t)}function hk(t){Hs.call(this,null,t)}function dk(t){Hs.call(this,null,t)}function fk(t,e,n){var r=X_(t,e-1e-6,n).concat(e);return function(t){return r.map((function(e){return[t,e]}))}}function pk(t,e,n){var r=X_(t,e-1e-6,n).concat(e);return function(t){return r.map((function(e){return[e,t]}))}}function mk(t){Hs.call(this,[],t),this.generator=function(){var t,e,n,r,i,o,a,s,u,l,c,h,d=10,f=d,p=90,m=360,g=2.5;function y(){return{type:"MultiLineString",coordinates:v()}}function v(){return X_(bx(r/p)*p,n,p).map(c).concat(X_(bx(s/m)*m,a,m).map(h)).concat(X_(bx(e/d)*d,t,d).filter((function(t){return mx(t%p)>1e-6})).map(u)).concat(X_(bx(o/f)*f,i,f).filter((function(t){return mx(t%m)>1e-6})).map(l))}return y.lines=function(){return v().map((function(t){return{type:"LineString",coordinates:t}}))},y.outline=function(){return{type:"Polygon",coordinates:[c(r).concat(h(a).slice(1),c(n).reverse().slice(1),h(s).reverse().slice(1))]}},y.extent=function(t){return arguments.length?y.extentMajor(t).extentMinor(t):y.extentMinor()},y.extentMajor=function(t){return arguments.length?(s=+t[0][1],a=+t[1][1],(r=+t[0][0])>(n=+t[1][0])&&(t=r,r=n,n=t),s>a&&(t=s,s=a,a=t),y.precision(g)):[[r,s],[n,a]]},y.extentMinor=function(n){return arguments.length?(o=+n[0][1],i=+n[1][1],(e=+n[0][0])>(t=+n[1][0])&&(n=e,e=t,t=n),o>i&&(n=o,o=i,i=n),y.precision(g)):[[e,o],[t,i]]},y.step=function(t){return arguments.length?y.stepMajor(t).stepMinor(t):y.stepMinor()},y.stepMajor=function(t){return arguments.length?(p=+t[0],m=+t[1],y):[p,m]},y.stepMinor=function(t){return arguments.length?(d=+t[0],f=+t[1],y):[d,f]},y.precision=function(d){return arguments.length?(g=+d,u=fk(o,i,90),l=pk(e,t,g),c=fk(s,a,90),h=pk(r,n,g),y):g},y.extentMajor([[-180,-89.999999],[180,89.999999]]).extentMinor([[-180,-80.000001],[180,80.000001]])}()}function gk(t){Hs.call(this,null,t)}function yk(t){if(!gn(t))return!1;const e=Vn(Pe(t));return e.$x||e.$y||e.$value||e.$max}function vk(t){Hs.call(this,null,t),this.modified(!0)}function bk(t,e,n){gn(t[e])&&t[e](n)}function wk(t,e,n,r){if(isNaN(e)||isNaN(n))return t;var i,o,a,s,u,l,c,h,d,f=t._root,p={data:r},m=t._x0,g=t._y0,y=t._x1,v=t._y1;if(!f)return t._root=p,t;for(;f.length;)if((l=e>=(o=(m+y)/2))?m=o:y=o,(c=n>=(a=(g+v)/2))?g=a:v=a,i=f,!(f=f[h=c<<1|l]))return i[h]=p,t;if(s=+t._x.call(null,f.data),u=+t._y.call(null,f.data),e===s&&n===u)return p.next=f,i?i[h]=p:t._root=p,t;do{i=i?i[h]=new Array(4):t._root=new Array(4),(l=e>=(o=(m+y)/2))?m=o:y=o,(c=n>=(a=(g+v)/2))?g=a:v=a}while((h=c<<1|l)==(d=(u>=a)<<1|s>=o));return i[d]=f,i[h]=p,t}ck.Definition={type:"GeoPath",metadata:{modifies:!0},params:[{name:"projection",type:"projection"},{name:"field",type:"field"},{name:"pointRadius",type:"number",expr:!0},{name:"as",type:"string",default:"path"}]},Tn(ck,Hs,{transform(t,e){var n=e.fork(e.ALL),r=this.value,i=t.field||We,o=t.as||"path",a=n.SOURCE;!r||t.modified()?(this.value=r=uk(t.projection),n.materialize().reflow()):a=i===We||e.modified(i.fields)?n.ADD_MOD:n.ADD;var s=function(t,e){var n=t.pointRadius();return t.context(null),null!=e&&t.pointRadius(e),n}(r,t.pointRadius);return n.visit(a,t=>t[o]=r(i(t))),r.pointRadius(s),n.modifies(o)}}),hk.Definition={type:"GeoPoint",metadata:{modifies:!0},params:[{name:"projection",type:"projection",required:!0},{name:"fields",type:"field",array:!0,required:!0,length:2},{name:"as",type:"string",array:!0,length:2,default:["x","y"]}]},Tn(hk,Hs,{transform(t,e){var n,r=t.projection,i=t.fields[0],o=t.fields[1],a=t.as||["x","y"],s=a[0],u=a[1];function l(t){var e=r([i(t),o(t)]);e?(t[s]=e[0],t[u]=e[1]):(t[s]=void 0,t[u]=void 0)}return t.modified()?e=e.materialize().reflow(!0).visit(e.SOURCE,l):(n=e.modified(i.fields)||e.modified(o.fields),e.visit(n?e.ADD_MOD:e.ADD,l)),e.modifies(a)}}),dk.Definition={type:"GeoShape",metadata:{modifies:!0,nomod:!0},params:[{name:"projection",type:"projection"},{name:"field",type:"field",default:"datum"},{name:"pointRadius",type:"number",expr:!0},{name:"as",type:"string",default:"shape"}]},Tn(dk,Hs,{transform(t,e){var n=e.fork(e.ALL),r=this.value,i=t.as||"shape",o=n.ADD;return r&&!t.modified()||(this.value=r=function(t,e,n){var r=null==n?n=>t(e(n)):r=>{var i=t.pointRadius(),o=t.pointRadius(n)(e(r));return t.pointRadius(i),o};return r.context=e=>(t.context(e),r),r}(uk(t.projection),t.field||$e("datum"),t.pointRadius),n.materialize().reflow(),o=n.SOURCE),n.visit(o,t=>t[i]=r),n.modifies(i)}}),mk.Definition={type:"Graticule",metadata:{changes:!0,generates:!0},params:[{name:"extent",type:"array",array:!0,length:2,content:{type:"number",array:!0,length:2}},{name:"extentMajor",type:"array",array:!0,length:2,content:{type:"number",array:!0,length:2}},{name:"extentMinor",type:"array",array:!0,length:2,content:{type:"number",array:!0,length:2}},{name:"step",type:"number",array:!0,length:2},{name:"stepMajor",type:"number",array:!0,length:2,default:[90,360]},{name:"stepMinor",type:"number",array:!0,length:2,default:[10,10]},{name:"precision",type:"number",default:2.5}]},Tn(mk,Hs,{transform(t,e){var n,r=this.value,i=this.generator;if(!r.length||t.modified())for(var o in t)gn(i[o])&&i[o](t[o]);return n=i(),r.length?e.mod.push(er(r[0],n)):e.add.push(Qn(n)),r[0]=n,e}}),gk.Definition={type:"heatmap",metadata:{modifies:!0},params:[{name:"field",type:"field"},{name:"color",type:"string",expr:!0},{name:"opacity",type:"number",expr:!0},{name:"resolve",type:"enum",values:["shared","independent"],default:"independent"},{name:"as",type:"string",default:"image"}]},Tn(gk,Hs,{transform(t,e){if(!e.changed()&&!t.modified())return e.StopPropagation;var n=e.materialize(e.SOURCE).source,r="shared"===t.resolve,i=t.field||We,o=function(t,e){let n;return gn(t)?(n=n=>t(n,e),n.dep=yk(t)):t?n=_n(t):(n=t=>t.$value/t.$max||0,n.dep=!0),n}(t.opacity,t),a=function(t,e){let n;return gn(t)?(n=n=>tg(t(n,e)),n.dep=yk(t)):n=_n(tg(t||"#888")),n}(t.color,t),s=t.as||"image",u={$x:0,$y:0,$value:0,$max:r?cu(n.map(t=>cu(i(t).values))):0};return n.forEach(t=>{const e=i(t),n=kn({},t,u);r||(n.$max=cu(e.values||[])),t[s]=function(t,e,n,r){const i=t.width,o=t.x1||0,a=t.y1||0,s=t.x2||i,u=t.y2||t.height,l=t.values,c=l?t=>l[t]:qe,h=Vd(s-o,u-a),d=h.getContext("2d"),f=d.getImageData(0,0,s-o,u-a),p=f.data;for(let m=a,g=0;m<u;++m){e.$y=m-a;for(let t=o,a=m*i;t<s;++t,g+=4){e.$x=t-o,e.$value=c(t+a);const i=n(e);p[g+0]=i.r,p[g+1]=i.g,p[g+2]=i.b,p[g+3]=~~(255*r(e))}}return d.putImageData(f,0,0),h}(e,n,a.dep?a:_n(a(n)),o.dep?o:_n(o(n)))}),e.reflow(!0).modifies(s)}}),Tn(vk,Hs,{transform(t,e){let n=this.value;return!n||t.modified("type")?(this.value=((i=sk(((r=t.type)||"mercator").toLowerCase()))||Be("Unrecognized projection type: "+r),n=i()),ok.forEach((function(e){null!=t[e]&&bk(n,e,t[e])}))):ok.forEach((function(e){t.modified(e)&&bk(n,e,t[e])})),null!=t.pointRadius&&n.path.pointRadius(t.pointRadius),t.fit&&function(t,e){var n=function(t){return 1===(t=mn(t)).length?t[0]:{type:"FeatureCollection",features:t.reduce((t,e)=>t.concat(function(t){return"FeatureCollection"===t.type?t.features:mn(t).filter(t=>null!=t).map(t=>"Feature"===t.type?t:{type:"Feature",geometry:t})}(e)),[])}}(e.fit);e.extent?t.fitExtent(e.extent,n):e.size&&t.fitSize(e.size,n)}(n,t),e.fork(e.NO_SOURCE|e.NO_FIELDS);var r,i}});var xk=function(t,e,n,r,i){this.node=t,this.x0=e,this.y0=n,this.x1=r,this.y1=i};function _k(t){return t[0]}function Ck(t){return t[1]}function kk(t,e,n){var r=new Sk(null==e?_k:e,null==n?Ck:n,NaN,NaN,NaN,NaN);return null==t?r:r.addAll(t)}function Sk(t,e,n,r,i,o){this._x=t,this._y=e,this._x0=n,this._y0=r,this._x1=i,this._y1=o,this._root=void 0}function Ek(t){for(var e={data:t.data},n=e;t=t.next;)n=n.next={data:t.data};return e}var Ok=kk.prototype=Sk.prototype;Ok.copy=function(){var t,e,n=new Sk(this._x,this._y,this._x0,this._y0,this._x1,this._y1),r=this._root;if(!r)return n;if(!r.length)return n._root=Ek(r),n;for(t=[{source:r,target:n._root=new Array(4)}];r=t.pop();)for(var i=0;i<4;++i)(e=r.source[i])&&(e.length?t.push({source:e,target:r.target[i]=new Array(4)}):r.target[i]=Ek(e));return n},Ok.add=function(t){var e=+this._x.call(null,t),n=+this._y.call(null,t);return wk(this.cover(e,n),e,n,t)},Ok.addAll=function(t){var e,n,r,i,o=t.length,a=new Array(o),s=new Array(o),u=1/0,l=1/0,c=-1/0,h=-1/0;for(n=0;n<o;++n)isNaN(r=+this._x.call(null,e=t[n]))||isNaN(i=+this._y.call(null,e))||(a[n]=r,s[n]=i,r<u&&(u=r),r>c&&(c=r),i<l&&(l=i),i>h&&(h=i));if(u>c||l>h)return this;for(this.cover(u,l).cover(c,h),n=0;n<o;++n)wk(this,a[n],s[n],t[n]);return this},Ok.cover=function(t,e){if(isNaN(t=+t)||isNaN(e=+e))return this;var n=this._x0,r=this._y0,i=this._x1,o=this._y1;if(isNaN(n))i=(n=Math.floor(t))+1,o=(r=Math.floor(e))+1;else{for(var a,s,u=i-n,l=this._root;n>t||t>=i||r>e||e>=o;)switch(s=(e<r)<<1|t<n,(a=new Array(4))[s]=l,l=a,u*=2,s){case 0:i=n+u,o=r+u;break;case 1:n=i-u,o=r+u;break;case 2:i=n+u,r=o-u;break;case 3:n=i-u,r=o-u}this._root&&this._root.length&&(this._root=l)}return this._x0=n,this._y0=r,this._x1=i,this._y1=o,this},Ok.data=function(){var t=[];return this.visit((function(e){if(!e.length)do{t.push(e.data)}while(e=e.next)})),t},Ok.extent=function(t){return arguments.length?this.cover(+t[0][0],+t[0][1]).cover(+t[1][0],+t[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]},Ok.find=function(t,e,n){var r,i,o,a,s,u,l,c=this._x0,h=this._y0,d=this._x1,f=this._y1,p=[],m=this._root;for(m&&p.push(new xk(m,c,h,d,f)),null==n?n=1/0:(c=t-n,h=e-n,d=t+n,f=e+n,n*=n);u=p.pop();)if(!(!(m=u.node)||(i=u.x0)>d||(o=u.y0)>f||(a=u.x1)<c||(s=u.y1)<h))if(m.length){var g=(i+a)/2,y=(o+s)/2;p.push(new xk(m[3],g,y,a,s),new xk(m[2],i,y,g,s),new xk(m[1],g,o,a,y),new xk(m[0],i,o,g,y)),(l=(e>=y)<<1|t>=g)&&(u=p[p.length-1],p[p.length-1]=p[p.length-1-l],p[p.length-1-l]=u)}else{var v=t-+this._x.call(null,m.data),b=e-+this._y.call(null,m.data),w=v*v+b*b;if(w<n){var x=Math.sqrt(n=w);c=t-x,h=e-x,d=t+x,f=e+x,r=m.data}}return r},Ok.remove=function(t){if(isNaN(o=+this._x.call(null,t))||isNaN(a=+this._y.call(null,t)))return this;var e,n,r,i,o,a,s,u,l,c,h,d,f=this._root,p=this._x0,m=this._y0,g=this._x1,y=this._y1;if(!f)return this;if(f.length)for(;;){if((l=o>=(s=(p+g)/2))?p=s:g=s,(c=a>=(u=(m+y)/2))?m=u:y=u,e=f,!(f=f[h=c<<1|l]))return this;if(!f.length)break;(e[h+1&3]||e[h+2&3]||e[h+3&3])&&(n=e,d=h)}for(;f.data!==t;)if(r=f,!(f=f.next))return this;return(i=f.next)&&delete f.next,r?(i?r.next=i:delete r.next,this):e?(i?e[h]=i:delete e[h],(f=e[0]||e[1]||e[2]||e[3])&&f===(e[3]||e[2]||e[1]||e[0])&&!f.length&&(n?n[d]=f:this._root=f),this):(this._root=i,this)},Ok.removeAll=function(t){for(var e=0,n=t.length;e<n;++e)this.remove(t[e]);return this},Ok.root=function(){return this._root},Ok.size=function(){var t=0;return this.visit((function(e){if(!e.length)do{++t}while(e=e.next)})),t},Ok.visit=function(t){var e,n,r,i,o,a,s=[],u=this._root;for(u&&s.push(new xk(u,this._x0,this._y0,this._x1,this._y1));e=s.pop();)if(!t(u=e.node,r=e.x0,i=e.y0,o=e.x1,a=e.y1)&&u.length){var l=(r+o)/2,c=(i+a)/2;(n=u[3])&&s.push(new xk(n,l,c,o,a)),(n=u[2])&&s.push(new xk(n,r,c,l,a)),(n=u[1])&&s.push(new xk(n,l,i,o,c)),(n=u[0])&&s.push(new xk(n,r,i,l,c))}return this},Ok.visitAfter=function(t){var e,n=[],r=[];for(this._root&&n.push(new xk(this._root,this._x0,this._y0,this._x1,this._y1));e=n.pop();){var i=e.node;if(i.length){var o,a=e.x0,s=e.y0,u=e.x1,l=e.y1,c=(a+u)/2,h=(s+l)/2;(o=i[0])&&n.push(new xk(o,a,s,c,h)),(o=i[1])&&n.push(new xk(o,c,s,u,h)),(o=i[2])&&n.push(new xk(o,a,h,c,l)),(o=i[3])&&n.push(new xk(o,c,h,u,l))}r.push(e)}for(;e=r.pop();)t(e.node,e.x0,e.y0,e.x1,e.y1);return this},Ok.x=function(t){return arguments.length?(this._x=t,this):this._x},Ok.y=function(t){return arguments.length?(this._y=t,this):this._y};var Ak=function(t){return function(){return t}},Nk=function(t){return 1e-6*(t()-.5)};function Tk(t){return t.x+t.vx}function Dk(t){return t.y+t.vy}var Rk={value:function(){}};function Ik(){for(var t,e=0,n=arguments.length,r={};e<n;++e){if(!(t=arguments[e]+"")||t in r||/[\s.]/.test(t))throw new Error("illegal type: "+t);r[t]=[]}return new Mk(r)}function Mk(t){this._=t}function Fk(t,e){return t.trim().split(/^|\s+/).map((function(t){var n="",r=t.indexOf(".");if(r>=0&&(n=t.slice(r+1),t=t.slice(0,r)),t&&!e.hasOwnProperty(t))throw new Error("unknown type: "+t);return{type:t,name:n}}))}function Pk(t,e){for(var n,r=0,i=t.length;r<i;++r)if((n=t[r]).name===e)return n.value}function jk(t,e,n){for(var r=0,i=t.length;r<i;++r)if(t[r].name===e){t[r]=Rk,t=t.slice(0,r).concat(t.slice(r+1));break}return null!=n&&t.push({name:e,value:n}),t}Mk.prototype=Ik.prototype={constructor:Mk,on:function(t,e){var n,r=this._,i=Fk(t+"",r),o=-1,a=i.length;if(!(arguments.length<2)){if(null!=e&&"function"!=typeof e)throw new Error("invalid callback: "+e);for(;++o<a;)if(n=(t=i[o]).type)r[n]=jk(r[n],t.name,e);else if(null==e)for(n in r)r[n]=jk(r[n],t.name,null);return this}for(;++o<a;)if((n=(t=i[o]).type)&&(n=Pk(r[n],t.name)))return n},copy:function(){var t={},e=this._;for(var n in e)t[n]=e[n].slice();return new Mk(t)},call:function(t,e){if((n=arguments.length-2)>0)for(var n,r,i=new Array(n),o=0;o<n;++o)i[o]=arguments[o+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(o=0,n=(r=this._[t]).length;o<n;++o)r[o].value.apply(e,i)},apply:function(t,e,n){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var r=this._[t],i=0,o=r.length;i<o;++i)r[i].value.apply(e,n)}};var zk,Lk,Bk=Ik,Uk=0,$k=0,Vk=0,Wk=0,qk=0,Hk=0,Gk="object"==typeof performance&&performance.now?performance:Date,Xk="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function Kk(){return qk||(Xk(Yk),qk=Gk.now()+Hk)}function Yk(){qk=0}function Zk(){this._call=this._time=this._next=null}function Qk(t,e,n){var r=new Zk;return r.restart(t,e,n),r}function Jk(){qk=(Wk=Gk.now())+Hk,Uk=$k=0;try{!function(){Kk(),++Uk;for(var t,e=zk;e;)(t=qk-e._time)>=0&&e._call.call(null,t),e=e._next;--Uk}()}finally{Uk=0,function(){for(var t,e,n=zk,r=1/0;n;)n._call?(r>n._time&&(r=n._time),t=n,n=n._next):(e=n._next,n._next=null,n=t?t._next=e:zk=e);Lk=t,eS(r)}(),qk=0}}function tS(){var t=Gk.now(),e=t-Wk;e>1e3&&(Hk-=e,Wk=t)}function eS(t){Uk||($k&&($k=clearTimeout($k)),t-qk>24?(t<1/0&&($k=setTimeout(Jk,t-Gk.now()-Hk)),Vk&&(Vk=clearInterval(Vk))):(Vk||(Wk=Gk.now(),Vk=setInterval(tS,1e3)),Uk=1,Xk(Jk)))}function nS(t){return t.x}function rS(t){return t.y}Zk.prototype=Qk.prototype={constructor:Zk,restart:function(t,e,n){if("function"!=typeof t)throw new TypeError("callback is not a function");n=(null==n?Kk():+n)+(null==e?0:+e),this._next||Lk===this||(Lk?Lk._next=this:zk=this,Lk=this),this._call=t,this._time=n,eS()},stop:function(){this._call&&(this._call=null,this._time=1/0,eS())}};var iS=Math.PI*(3-Math.sqrt(5));function oS(t){return t.index}function aS(t,e){var n=t.get(e);if(!n)throw new Error("node not found: "+e);return n}const sS={center:function(t,e){var n,r=1;function i(){var i,o,a=n.length,s=0,u=0;for(i=0;i<a;++i)s+=(o=n[i]).x,u+=o.y;for(s=(s/a-t)*r,u=(u/a-e)*r,i=0;i<a;++i)(o=n[i]).x-=s,o.y-=u}return null==t&&(t=0),null==e&&(e=0),i.initialize=function(t){n=t},i.x=function(e){return arguments.length?(t=+e,i):t},i.y=function(t){return arguments.length?(e=+t,i):e},i.strength=function(t){return arguments.length?(r=+t,i):r},i},collide:function(t){var e,n,r,i=1,o=1;function a(){for(var t,a,u,l,c,h,d,f=e.length,p=0;p<o;++p)for(a=kk(e,Tk,Dk).visitAfter(s),t=0;t<f;++t)d=(h=n[(u=e[t]).index])*h,l=u.x+u.vx,c=u.y+u.vy,a.visit(m);function m(t,e,n,o,a){var s=t.data,f=t.r,p=h+f;if(!s)return e>l+p||o<l-p||n>c+p||a<c-p;if(s.index>u.index){var m=l-s.x-s.vx,g=c-s.y-s.vy,y=m*m+g*g;y<p*p&&(0===m&&(y+=(m=Nk(r))*m),0===g&&(y+=(g=Nk(r))*g),y=(p-(y=Math.sqrt(y)))/y*i,u.vx+=(m*=y)*(p=(f*=f)/(d+f)),u.vy+=(g*=y)*p,s.vx-=m*(p=1-p),s.vy-=g*p)}}}function s(t){if(t.data)return t.r=n[t.data.index];for(var e=t.r=0;e<4;++e)t[e]&&t[e].r>t.r&&(t.r=t[e].r)}function u(){if(e){var r,i,o=e.length;for(n=new Array(o),r=0;r<o;++r)n[(i=e[r]).index]=+t(i,r,e)}}return"function"!=typeof t&&(t=Ak(null==t?1:+t)),a.initialize=function(t,n){e=t,r=n,u()},a.iterations=function(t){return arguments.length?(o=+t,a):o},a.strength=function(t){return arguments.length?(i=+t,a):i},a.radius=function(e){return arguments.length?(t="function"==typeof e?e:Ak(+e),u(),a):t},a},nbody:function(){var t,e,n,r,i,o=Ak(-30),a=1,s=1/0,u=.81;function l(n){var i,o=t.length,a=kk(t,nS,rS).visitAfter(h);for(r=n,i=0;i<o;++i)e=t[i],a.visit(d)}function c(){if(t){var e,n,r=t.length;for(i=new Array(r),e=0;e<r;++e)i[(n=t[e]).index]=+o(n,e,t)}}function h(t){var e,n,r,o,a,s=0,u=0;if(t.length){for(r=o=a=0;a<4;++a)(e=t[a])&&(n=Math.abs(e.value))&&(s+=e.value,u+=n,r+=n*e.x,o+=n*e.y);t.x=r/u,t.y=o/u}else{(e=t).x=e.data.x,e.y=e.data.y;do{s+=i[e.data.index]}while(e=e.next)}t.value=s}function d(t,o,l,c){if(!t.value)return!0;var h=t.x-e.x,d=t.y-e.y,f=c-o,p=h*h+d*d;if(f*f/u<p)return p<s&&(0===h&&(p+=(h=Nk(n))*h),0===d&&(p+=(d=Nk(n))*d),p<a&&(p=Math.sqrt(a*p)),e.vx+=h*t.value*r/p,e.vy+=d*t.value*r/p),!0;if(!(t.length||p>=s)){(t.data!==e||t.next)&&(0===h&&(p+=(h=Nk(n))*h),0===d&&(p+=(d=Nk(n))*d),p<a&&(p=Math.sqrt(a*p)));do{t.data!==e&&(e.vx+=h*(f=i[t.data.index]*r/p),e.vy+=d*f)}while(t=t.next)}}return l.initialize=function(e,r){t=e,n=r,c()},l.strength=function(t){return arguments.length?(o="function"==typeof t?t:Ak(+t),c(),l):o},l.distanceMin=function(t){return arguments.length?(a=t*t,l):Math.sqrt(a)},l.distanceMax=function(t){return arguments.length?(s=t*t,l):Math.sqrt(s)},l.theta=function(t){return arguments.length?(u=t*t,l):Math.sqrt(u)},l},link:function(t){var e,n,r,i,o,a,s=oS,u=function(t){return 1/Math.min(i[t.source.index],i[t.target.index])},l=Ak(30),c=1;function h(r){for(var i=0,s=t.length;i<c;++i)for(var u,l,h,d,f,p,m,g=0;g<s;++g)d=(h=(u=t[g]).target).x+h.vx-(l=u.source).x-l.vx||Nk(a),f=h.y+h.vy-l.y-l.vy||Nk(a),f*=p=((p=Math.sqrt(d*d+f*f))-n[g])/p*r*e[g],h.vx-=(d*=p)*(m=o[g]),h.vy-=f*m,l.vx+=d*(m=1-m),l.vy+=f*m}function d(){if(r){var a,u,l=r.length,c=t.length,h=new Map(r.map((t,e)=>[s(t,e,r),t]));for(a=0,i=new Array(l);a<c;++a)(u=t[a]).index=a,"object"!=typeof u.source&&(u.source=aS(h,u.source)),"object"!=typeof u.target&&(u.target=aS(h,u.target)),i[u.source.index]=(i[u.source.index]||0)+1,i[u.target.index]=(i[u.target.index]||0)+1;for(a=0,o=new Array(c);a<c;++a)o[a]=i[(u=t[a]).source.index]/(i[u.source.index]+i[u.target.index]);e=new Array(c),f(),n=new Array(c),p()}}function f(){if(r)for(var n=0,i=t.length;n<i;++n)e[n]=+u(t[n],n,t)}function p(){if(r)for(var e=0,i=t.length;e<i;++e)n[e]=+l(t[e],e,t)}return null==t&&(t=[]),h.initialize=function(t,e){r=t,a=e,d()},h.links=function(e){return arguments.length?(t=e,d(),h):t},h.id=function(t){return arguments.length?(s=t,h):s},h.iterations=function(t){return arguments.length?(c=+t,h):c},h.strength=function(t){return arguments.length?(u="function"==typeof t?t:Ak(+t),f(),h):u},h.distance=function(t){return arguments.length?(l="function"==typeof t?t:Ak(+t),p(),h):l},h},x:function(t){var e,n,r,i=Ak(.1);function o(t){for(var i,o=0,a=e.length;o<a;++o)(i=e[o]).vx+=(r[o]-i.x)*n[o]*t}function a(){if(e){var o,a=e.length;for(n=new Array(a),r=new Array(a),o=0;o<a;++o)n[o]=isNaN(r[o]=+t(e[o],o,e))?0:+i(e[o],o,e)}}return"function"!=typeof t&&(t=Ak(null==t?0:+t)),o.initialize=function(t){e=t,a()},o.strength=function(t){return arguments.length?(i="function"==typeof t?t:Ak(+t),a(),o):i},o.x=function(e){return arguments.length?(t="function"==typeof e?e:Ak(+e),a(),o):t},o},y:function(t){var e,n,r,i=Ak(.1);function o(t){for(var i,o=0,a=e.length;o<a;++o)(i=e[o]).vy+=(r[o]-i.y)*n[o]*t}function a(){if(e){var o,a=e.length;for(n=new Array(a),r=new Array(a),o=0;o<a;++o)n[o]=isNaN(r[o]=+t(e[o],o,e))?0:+i(e[o],o,e)}}return"function"!=typeof t&&(t=Ak(null==t?0:+t)),o.initialize=function(t){e=t,a()},o.strength=function(t){return arguments.length?(i="function"==typeof t?t:Ak(+t),a(),o):i},o.y=function(e){return arguments.length?(t="function"==typeof e?e:Ak(+e),a(),o):t},o}},uS=["alpha","alphaMin","alphaTarget","velocityDecay","forces"],lS=["static","iterations"],cS=["x","y","vx","vy"];function hS(t){Hs.call(this,null,t)}function dS(t,e,n,r){var i,o,a,s,u=mn(e.forces);for(i=0,o=uS.length;i<o;++i)"forces"!==(a=uS[i])&&e.modified(a)&&t[a](e[a]);for(i=0,o=u.length;i<o;++i)s="forces"+i,(a=n||e.modified("forces",i)?pS(u[i]):r&&fS(u[i],r)?t.force(s):null)&&t.force(s,a);for(o=t.numForces||0;i<o;++i)t.force("forces"+i,null);return t.numForces=u.length,t}function fS(t,e){var n,r;for(n in t)if(gn(r=t[n])&&e.modified(Pe(r)))return 1;return 0}function pS(t){var e,n;for(n in On(sS,t.force)||Be("Unrecognized force: "+t.force),e=sS[t.force](),t)gn(e[n])&&mS(e[n],t[n],t);return e}function mS(t,e,n){t(gn(e)?t=>e(t,n):e)}hS.Definition={type:"Force",metadata:{modifies:!0},params:[{name:"static",type:"boolean",default:!1},{name:"restart",type:"boolean",default:!1},{name:"iterations",type:"number",default:300},{name:"alpha",type:"number",default:1},{name:"alphaMin",type:"number",default:.001},{name:"alphaTarget",type:"number",default:0},{name:"velocityDecay",type:"number",default:.4},{name:"forces",type:"param",array:!0,params:[{key:{force:"center"},params:[{name:"x",type:"number",default:0},{name:"y",type:"number",default:0}]},{key:{force:"collide"},params:[{name:"radius",type:"number",expr:!0},{name:"strength",type:"number",default:.7},{name:"iterations",type:"number",default:1}]},{key:{force:"nbody"},params:[{name:"strength",type:"number",default:-30},{name:"theta",type:"number",default:.9},{name:"distanceMin",type:"number",default:1},{name:"distanceMax",type:"number"}]},{key:{force:"link"},params:[{name:"links",type:"data"},{name:"id",type:"field"},{name:"distance",type:"number",default:30,expr:!0},{name:"strength",type:"number",expr:!0},{name:"iterations",type:"number",default:1}]},{key:{force:"x"},params:[{name:"strength",type:"number",default:.1},{name:"x",type:"field"}]},{key:{force:"y"},params:[{name:"strength",type:"number",default:.1},{name:"y",type:"field"}]}]},{name:"as",type:"string",array:!0,modify:!1,default:cS}]},Tn(hS,Hs,{transform(t,e){var n,r,i=this.value,o=e.changed(e.ADD_REM),a=t.modified(uS),s=t.iterations||300;if(i?(o&&(e.modifies("index"),i.nodes(e.source)),(a||e.changed(e.MOD))&&dS(i,t,0,e)):(this.value=i=function(t,e){const n=function(t){var e,n=1,r=.001,i=1-Math.pow(r,1/300),o=0,a=.6,s=new Map,u=Qk(h),l=Bk("tick","end"),c=function(){let t=1;return()=>(t=(1664525*t+1013904223)%4294967296)/4294967296}();function h(){d(),l.call("tick",e),n<r&&(u.stop(),l.call("end",e))}function d(r){var u,l,c=t.length;void 0===r&&(r=1);for(var h=0;h<r;++h)for(n+=(o-n)*i,s.forEach((function(t){t(n)})),u=0;u<c;++u)null==(l=t[u]).fx?l.x+=l.vx*=a:(l.x=l.fx,l.vx=0),null==l.fy?l.y+=l.vy*=a:(l.y=l.fy,l.vy=0);return e}function f(){for(var e,n=0,r=t.length;n<r;++n){if((e=t[n]).index=n,null!=e.fx&&(e.x=e.fx),null!=e.fy&&(e.y=e.fy),isNaN(e.x)||isNaN(e.y)){var i=10*Math.sqrt(.5+n),o=n*iS;e.x=i*Math.cos(o),e.y=i*Math.sin(o)}(isNaN(e.vx)||isNaN(e.vy))&&(e.vx=e.vy=0)}}function p(e){return e.initialize&&e.initialize(t,c),e}return null==t&&(t=[]),f(),e={tick:d,restart:function(){return u.restart(h),e},stop:function(){return u.stop(),e},nodes:function(n){return arguments.length?(t=n,f(),s.forEach(p),e):t},alpha:function(t){return arguments.length?(n=+t,e):n},alphaMin:function(t){return arguments.length?(r=+t,e):r},alphaDecay:function(t){return arguments.length?(i=+t,e):+i},alphaTarget:function(t){return arguments.length?(o=+t,e):o},velocityDecay:function(t){return arguments.length?(a=1-t,e):1-a},randomSource:function(t){return arguments.length?(c=t,s.forEach(p),e):c},force:function(t,n){return arguments.length>1?(null==n?s.delete(t):s.set(t,p(n)),e):s.get(t)},find:function(e,n,r){var i,o,a,s,u,l=0,c=t.length;for(null==r?r=1/0:r*=r,l=0;l<c;++l)(a=(i=e-(s=t[l]).x)*i+(o=n-s.y)*o)<r&&(u=s,r=a);return u},on:function(t,n){return arguments.length>1?(l.on(t,n),e):l.on(t)}}}(t),r=n.stop,i=n.restart;let o=!1;return n.stopped=()=>o,n.restart=()=>(o=!1,i()),n.stop=()=>(o=!0,r()),dS(n,e,!0).on("end",()=>o=!0)}(e.source,t),i.on("tick",(n=e.dataflow,r=this,()=>n.touch(r).run())),t.static||(o=!0,i.tick()),e.modifies("index")),a||o||t.modified(lS)||e.changed()&&t.restart)if(i.alpha(Math.max(i.alpha(),t.alpha||1)).alphaDecay(1-Math.pow(i.alphaMin(),1/s)),t.static)for(i.stop();--s>=0;)i.tick();else if(i.stopped()&&i.restart(),!o)return e.StopPropagation;return this.finish(t,e)},finish(t,e){const n=e.dataflow;for(let s,u=this._argops,l=0,c=u.length;l<c;++l)if(s=u[l],"forces"===s.name&&"link"===s.op._argval.force)for(var r,i=s.op._argops,o=0,a=i.length;o<a;++o)if("links"===i[o].name&&(r=i[o].op.source)){n.pulse(r,n.changeset().reflow());break}return e.reflow(t.modified()).modifies(cS)}});var gS=function(t,e,n){var r={};return t.each((function(t){var i=t.data;n(i)&&(r[e(i)]=t)})),t.lookup=r,t};function yS(t){var e=0,n=t.children,r=n&&n.length;if(r)for(;--r>=0;)e+=n[r].value;else e=1;t.value=e}function vS(t,e){var n,r,i,o,a,s=new _S(t),u=+t.value&&(s.value=t.value),l=[s];for(null==e&&(e=bS);n=l.pop();)if(u&&(n.value=+n.data.value),(i=e(n.data))&&(a=i.length))for(n.children=new Array(a),o=a-1;o>=0;--o)l.push(r=n.children[o]=new _S(i[o])),r.parent=n,r.depth=n.depth+1;return s.eachBefore(xS)}function bS(t){return t.children}function wS(t){t.data=t.data.data}function xS(t){var e=0;do{t.height=e}while((t=t.parent)&&t.height<++e)}function _S(t){this.data=t,this.depth=this.height=0,this.parent=null}function CS(t){Hs.call(this,null,t)}_S.prototype=vS.prototype={constructor:_S,count:function(){return this.eachAfter(yS)},each:function(t){var e,n,r,i,o=this,a=[o];do{for(e=a.reverse(),a=[];o=e.pop();)if(t(o),n=o.children)for(r=0,i=n.length;r<i;++r)a.push(n[r])}while(a.length);return this},eachAfter:function(t){for(var e,n,r,i=this,o=[i],a=[];i=o.pop();)if(a.push(i),e=i.children)for(n=0,r=e.length;n<r;++n)o.push(e[n]);for(;i=a.pop();)t(i);return this},eachBefore:function(t){for(var e,n,r=this,i=[r];r=i.pop();)if(t(r),e=r.children)for(n=e.length-1;n>=0;--n)i.push(e[n]);return this},sum:function(t){return this.eachAfter((function(e){for(var n=+t(e.data)||0,r=e.children,i=r&&r.length;--i>=0;)n+=r[i].value;e.value=n}))},sort:function(t){return this.eachBefore((function(e){e.children&&e.children.sort(t)}))},path:function(t){for(var e=this,n=function(t,e){if(t===e)return t;var n=t.ancestors(),r=e.ancestors(),i=null;for(t=n.pop(),e=r.pop();t===e;)i=t,t=n.pop(),e=r.pop();return i}(e,t),r=[e];e!==n;)r.push(e=e.parent);for(var i=r.length;t!==n;)r.splice(i,0,t),t=t.parent;return r},ancestors:function(){for(var t=this,e=[t];t=t.parent;)e.push(t);return e},descendants:function(){var t=[];return this.each((function(e){t.push(e)})),t},leaves:function(){var t=[];return this.eachBefore((function(e){e.children||t.push(e)})),t},links:function(){var t=this,e=[];return t.each((function(n){n!==t&&e.push({source:n.parent,target:n})})),e},copy:function(){return vS(this).eachBefore(wS)}},CS.Definition={type:"Nest",metadata:{treesource:!0,changes:!0},params:[{name:"keys",type:"field",array:!0},{name:"generate",type:"boolean"}]};const kS=t=>t.values;function SS(){const t=[],e={entries:e=>function e(n,r){if(++r>t.length)return n;const i=[];for(const t in n)i.push({key:t,values:e(n[t],r)});return i}(function e(n,r){if(r>=t.length)return n;const i=n.length,o=t[r++],a={},s={};let u,l,c,h=-1;for(;++h<i;)u=o(l=n[h])+"",(c=a[u])?c.push(l):a[u]=[l];for(u in a)s[u]=e(a[u],r);return s}(e,0),0),key:n=>(t.push(n),e)};return e}function ES(t){Hs.call(this,null,t)}Tn(CS,Hs,{transform(t,e){e.source||Be("Nest transform requires an upstream data source.");var n=t.generate,r=t.modified(),i=e.clone(),o=this.value;return(!o||r||e.changed())&&(o&&o.each(t=>{t.children&&Kn(t.data)&&i.rem.push(t.data)}),this.value=o=vS({values:mn(t.keys).reduce((t,e)=>(t.key(e),t),SS()).entries(i.source)},kS),n&&o.each(t=>{t.children&&(t=Qn(t.data),i.add.push(t),i.source.push(t))}),gS(o,Yn,Yn)),i.source.root=o,i}});const OS=(t,e)=>t.parent===e.parent?1:2;Tn(ES,Hs,{transform(t,e){e.source&&e.source.root||Be(this.constructor.name+" transform requires a backing tree data source.");const n=this.layout(t.method),r=this.fields,i=e.source.root,o=t.as||r;t.field?i.sum(t.field):i.count(),t.sort&&i.sort(nr(t.sort,t=>t.data)),function(t,e,n){for(let r,i=0,o=e.length;i<o;++i)r=e[i],r in n&&t[r](n[r])}(n,this.params,t),n.separation&&n.separation(!1!==t.separation?OS:He);try{this.value=n(i)}catch(a){Be(a)}return i.each(t=>function(t,e,n){const r=t.data,i=e.length-1;for(let o=0;o<i;++o)r[n[o]]=t[e[o]];r[n[i]]=t.children?t.children.length:0}(t,r,o)),e.reflow(t.modified()).modifies(o).modifies("leaf")}});var AS=Array.prototype.slice;function NS(t,e){var n,r;if(RS(e,t))return[e];for(n=0;n<t.length;++n)if(TS(e,t[n])&&RS(MS(t[n],e),t))return[t[n],e];for(n=0;n<t.length-1;++n)for(r=n+1;r<t.length;++r)if(TS(MS(t[n],t[r]),e)&&TS(MS(t[n],e),t[r])&&TS(MS(t[r],e),t[n])&&RS(FS(t[n],t[r],e),t))return[t[n],t[r],e];throw new Error}function TS(t,e){var n=t.r-e.r,r=e.x-t.x,i=e.y-t.y;return n<0||n*n<r*r+i*i}function DS(t,e){var n=t.r-e.r+1e-6,r=e.x-t.x,i=e.y-t.y;return n>0&&n*n>r*r+i*i}function RS(t,e){for(var n=0;n<e.length;++n)if(!DS(t,e[n]))return!1;return!0}function IS(t){switch(t.length){case 1:return{x:(e=t[0]).x,y:e.y,r:e.r};case 2:return MS(t[0],t[1]);case 3:return FS(t[0],t[1],t[2])}var e}function MS(t,e){var n=t.x,r=t.y,i=t.r,o=e.x,a=e.y,s=e.r,u=o-n,l=a-r,c=s-i,h=Math.sqrt(u*u+l*l);return{x:(n+o+u/h*c)/2,y:(r+a+l/h*c)/2,r:(h+i+s)/2}}function FS(t,e,n){var r=t.x,i=t.y,o=t.r,a=e.x,s=e.y,u=e.r,l=n.x,c=n.y,h=n.r,d=r-a,f=r-l,p=i-s,m=i-c,g=u-o,y=h-o,v=r*r+i*i-o*o,b=v-a*a-s*s+u*u,w=v-l*l-c*c+h*h,x=f*p-d*m,_=(p*w-m*b)/(2*x)-r,C=(m*g-p*y)/x,k=(f*b-d*w)/(2*x)-i,S=(d*y-f*g)/x,E=C*C+S*S-1,O=2*(o+_*C+k*S),A=_*_+k*k-o*o,N=-(E?(O+Math.sqrt(O*O-4*E*A))/(2*E):A/O);return{x:r+_+C*N,y:i+k+S*N,r:N}}function PS(t,e,n){var r,i,o,a,s=t.x-e.x,u=t.y-e.y,l=s*s+u*u;l?(i=e.r+n.r,a=t.r+n.r,(i*=i)>(a*=a)?(r=(l+a-i)/(2*l),o=Math.sqrt(Math.max(0,a/l-r*r)),n.x=t.x-r*s-o*u,n.y=t.y-r*u+o*s):(r=(l+i-a)/(2*l),o=Math.sqrt(Math.max(0,i/l-r*r)),n.x=e.x+r*s-o*u,n.y=e.y+r*u+o*s)):(n.x=e.x+n.r,n.y=e.y)}function jS(t,e){var n=t.r+e.r-1e-6,r=e.x-t.x,i=e.y-t.y;return n>0&&n*n>r*r+i*i}function zS(t){var e=t._,n=t.next._,r=e.r+n.r,i=(e.x*n.r+n.x*e.r)/r,o=(e.y*n.r+n.y*e.r)/r;return i*i+o*o}function LS(t){this._=t,this.next=null,this.previous=null}function BS(t){return null==t?null:US(t)}function US(t){if("function"!=typeof t)throw new Error;return t}function $S(){return 0}var VS=function(t){return function(){return t}};function WS(t){return Math.sqrt(t.value)}function qS(t){return function(e){e.children||(e.r=Math.max(0,+t(e)||0))}}function HS(t,e){return function(n){if(r=n.children){var r,i,o,a=r.length,s=t(n)*e||0;if(s)for(i=0;i<a;++i)r[i].r+=s;if(o=function(t){if(!(i=t.length))return 0;var e,n,r,i,o,a,s,u,l,c,h;if((e=t[0]).x=0,e.y=0,!(i>1))return e.r;if(e.x=-(n=t[1]).r,n.x=e.r,n.y=0,!(i>2))return e.r+n.r;PS(n,e,r=t[2]),e=new LS(e),n=new LS(n),r=new LS(r),e.next=r.previous=n,n.next=e.previous=r,r.next=n.previous=e;t:for(s=3;s<i;++s){PS(e._,n._,r=t[s]),r=new LS(r),u=n.next,l=e.previous,c=n._.r,h=e._.r;do{if(c<=h){if(jS(u._,r._)){e.next=n=u,n.previous=e,--s;continue t}c+=u._.r,u=u.next}else{if(jS(l._,r._)){(e=l).next=n,n.previous=e,--s;continue t}h+=l._.r,l=l.previous}}while(u!==l.next);for(r.previous=e,r.next=n,e.next=n.previous=n=r,o=zS(e);(r=r.next)!==n;)(a=zS(r))<o&&(e=r,o=a);n=e.next}for(e=[n._],r=n;(r=r.next)!==n;)e.push(r._);for(r=function(t){for(var e,n,r=0,i=(t=function(t){for(var e,n,r=t.length;r;)n=Math.random()*r--|0,e=t[r],t[r]=t[n],t[n]=e;return t}(AS.call(t))).length,o=[];r<i;)e=t[r],n&&DS(n,e)?++r:(n=IS(o=NS(o,e)),r=0);return n}(e),s=0;s<i;++s)(e=t[s]).x-=r.x,e.y-=r.y;return r.r}(r),s)for(i=0;i<a;++i)r[i].r-=s;n.r=o+s}}}function GS(t){return function(e){var n=e.parent;e.r*=t,n&&(e.x=n.x+t*e.x,e.y=n.y+t*e.y)}}const XS=["x","y","r","depth","children"];function KS(t){ES.call(this,t)}KS.Definition={type:"Pack",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"padding",type:"number",default:0},{name:"radius",type:"field",default:null},{name:"size",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:XS.length,default:XS}]},Tn(KS,ES,{layout:function(){var t=null,e=1,n=1,r=$S;function i(i){return i.x=e/2,i.y=n/2,t?i.eachBefore(qS(t)).eachAfter(HS(r,.5)).eachBefore(GS(1)):i.eachBefore(qS(WS)).eachAfter(HS($S,1)).eachAfter(HS(r,i.r/Math.min(e,n))).eachBefore(GS(Math.min(e,n)/(2*i.r))),i}return i.radius=function(e){return arguments.length?(t=BS(e),i):t},i.size=function(t){return arguments.length?(e=+t[0],n=+t[1],i):[e,n]},i.padding=function(t){return arguments.length?(r="function"==typeof t?t:VS(+t),i):r},i},params:["radius","size","padding"],fields:XS});var YS=function(t){t.x0=Math.round(t.x0),t.y0=Math.round(t.y0),t.x1=Math.round(t.x1),t.y1=Math.round(t.y1)},ZS=function(t,e,n,r,i){for(var o,a=t.children,s=-1,u=a.length,l=t.value&&(r-e)/t.value;++s<u;)(o=a[s]).y0=n,o.y1=i,o.x0=e,o.x1=e+=o.value*l};const QS=["x0","y0","x1","y1","depth","children"];function JS(t){ES.call(this,t)}JS.Definition={type:"Partition",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"padding",type:"number",default:0},{name:"round",type:"boolean",default:!1},{name:"size",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:QS.length,default:QS}]},Tn(JS,ES,{layout:function(){var t=1,e=1,n=0,r=!1;function i(i){var o=i.height+1;return i.x0=i.y0=n,i.x1=t,i.y1=e/o,i.eachBefore(function(t,e){return function(r){r.children&&ZS(r,r.x0,t*(r.depth+1)/e,r.x1,t*(r.depth+2)/e);var i=r.x0,o=r.y0,a=r.x1-n,s=r.y1-n;a<i&&(i=a=(i+a)/2),s<o&&(o=s=(o+s)/2),r.x0=i,r.y0=o,r.x1=a,r.y1=s}}(e,o)),r&&i.eachBefore(YS),i}return i.round=function(t){return arguments.length?(r=!!t,i):r},i.size=function(n){return arguments.length?(t=+n[0],e=+n[1],i):[t,e]},i.padding=function(t){return arguments.length?(n=+t,i):n},i},params:["size","round","padding"],fields:QS});var tE={depth:-1},eE={};function nE(t){return t.id}function rE(t){return t.parentId}var iE=function(){var t=nE,e=rE;function n(n){var r,i,o,a,s,u,l,c=n.length,h=new Array(c),d={};for(i=0;i<c;++i)s=h[i]=new _S(r=n[i]),null!=(u=t(r,i,n))&&(u+="")&&(d[l="$"+(s.id=u)]=l in d?eE:s);for(i=0;i<c;++i)if(s=h[i],null!=(u=e(n[i],i,n))&&(u+="")){if(!(a=d["$"+u]))throw new Error("missing: "+u);if(a===eE)throw new Error("ambiguous: "+u);a.children?a.children.push(s):a.children=[s],s.parent=a}else{if(o)throw new Error("multiple roots");o=s}if(!o)throw new Error("no root");if(o.parent=tE,o.eachBefore((function(t){t.depth=t.parent.depth+1,--c})).eachBefore(xS),o.parent=null,c>0)throw new Error("cycle");return o}return n.id=function(e){return arguments.length?(t=US(e),n):t},n.parentId=function(t){return arguments.length?(e=US(t),n):e},n};function oE(t){Hs.call(this,null,t)}function aE(t,e){return t.parent===e.parent?1:2}function sE(t){var e=t.children;return e?e[0]:t.t}function uE(t){var e=t.children;return e?e[e.length-1]:t.t}function lE(t,e,n){var r=n/(e.i-t.i);e.c-=r,e.s+=n,t.c+=r,e.z+=n,e.m+=n}function cE(t,e,n){return t.a.parent===e.parent?t.a:n}function hE(t,e){this._=t,this.parent=null,this.children=null,this.A=null,this.a=this,this.z=0,this.m=0,this.c=0,this.s=0,this.t=null,this.i=e}function dE(t,e){return t.parent===e.parent?1:2}function fE(t,e){return t+e.x}function pE(t,e){return Math.max(t,e.y)}oE.Definition={type:"Stratify",metadata:{treesource:!0},params:[{name:"key",type:"field",required:!0},{name:"parentKey",type:"field",required:!0}]},Tn(oE,Hs,{transform(t,e){e.source||Be("Stratify transform requires an upstream data source.");let n=this.value;const r=t.modified(),i=e.fork(e.ALL).materialize(e.SOURCE),o=!n||r||e.changed(e.ADD_REM)||e.modified(t.key.fields)||e.modified(t.parentKey.fields);return i.source=i.source.slice(),o&&(n=i.source.length?gS(iE().id(t.key).parentId(t.parentKey)(i.source),t.key,Ge):gS(iE()([{}]),t.key,t.key)),i.source.root=this.value=n,i}}),hE.prototype=Object.create(_S.prototype);var mE={tidy:function(){var t=aE,e=1,n=1,r=null;function i(i){var u=function(t){for(var e,n,r,i,o,a=new hE(t,0),s=[a];e=s.pop();)if(r=e._.children)for(e.children=new Array(o=r.length),i=o-1;i>=0;--i)s.push(n=e.children[i]=new hE(r[i],i)),n.parent=e;return(a.parent=new hE(null,0)).children=[a],a}(i);if(u.eachAfter(o),u.parent.m=-u.z,u.eachBefore(a),r)i.eachBefore(s);else{var l=i,c=i,h=i;i.eachBefore((function(t){t.x<l.x&&(l=t),t.x>c.x&&(c=t),t.depth>h.depth&&(h=t)}));var d=l===c?1:t(l,c)/2,f=d-l.x,p=e/(c.x+d+f),m=n/(h.depth||1);i.eachBefore((function(t){t.x=(t.x+f)*p,t.y=t.depth*m}))}return i}function o(e){var n=e.children,r=e.parent.children,i=e.i?r[e.i-1]:null;if(n){!function(t){for(var e,n=0,r=0,i=t.children,o=i.length;--o>=0;)(e=i[o]).z+=n,e.m+=n,n+=e.s+(r+=e.c)}(e);var o=(n[0].z+n[n.length-1].z)/2;i?(e.z=i.z+t(e._,i._),e.m=e.z-o):e.z=o}else i&&(e.z=i.z+t(e._,i._));e.parent.A=function(e,n,r){if(n){for(var i,o=e,a=e,s=n,u=o.parent.children[0],l=o.m,c=a.m,h=s.m,d=u.m;s=uE(s),o=sE(o),s&&o;)u=sE(u),(a=uE(a)).a=e,(i=s.z+h-o.z-l+t(s._,o._))>0&&(lE(cE(s,e,r),e,i),l+=i,c+=i),h+=s.m,l+=o.m,d+=u.m,c+=a.m;s&&!uE(a)&&(a.t=s,a.m+=h-c),o&&!sE(u)&&(u.t=o,u.m+=l-d,r=e)}return r}(e,i,e.parent.A||r[0])}function a(t){t._.x=t.z+t.parent.m,t.m+=t.parent.m}function s(t){t.x*=e,t.y=t.depth*n}return i.separation=function(e){return arguments.length?(t=e,i):t},i.size=function(t){return arguments.length?(r=!1,e=+t[0],n=+t[1],i):r?null:[e,n]},i.nodeSize=function(t){return arguments.length?(r=!0,e=+t[0],n=+t[1],i):r?[e,n]:null},i},cluster:function(){var t=dE,e=1,n=1,r=!1;function i(i){var o,a=0;i.eachAfter((function(e){var n=e.children;n?(e.x=function(t){return t.reduce(fE,0)/t.length}(n),e.y=function(t){return 1+t.reduce(pE,0)}(n)):(e.x=o?a+=t(e,o):0,e.y=0,o=e)}));var s=function(t){for(var e;e=t.children;)t=e[0];return t}(i),u=function(t){for(var e;e=t.children;)t=e[e.length-1];return t}(i),l=s.x-t(s,u)/2,c=u.x+t(u,s)/2;return i.eachAfter(r?function(t){t.x=(t.x-i.x)*e,t.y=(i.y-t.y)*n}:function(t){t.x=(t.x-l)/(c-l)*e,t.y=(1-(i.y?t.y/i.y:1))*n})}return i.separation=function(e){return arguments.length?(t=e,i):t},i.size=function(t){return arguments.length?(r=!1,e=+t[0],n=+t[1],i):r?null:[e,n]},i.nodeSize=function(t){return arguments.length?(r=!0,e=+t[0],n=+t[1],i):r?[e,n]:null},i}};const gE=["x","y","depth","children"];function yE(t){ES.call(this,t)}function vE(t){Hs.call(this,[],t)}yE.Definition={type:"Tree",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"method",type:"enum",default:"tidy",values:["tidy","cluster"]},{name:"size",type:"number",array:!0,length:2},{name:"nodeSize",type:"number",array:!0,length:2},{name:"separation",type:"boolean",default:!0},{name:"as",type:"string",array:!0,length:gE.length,default:gE}]},Tn(yE,ES,{layout(t){var e=t||"tidy";if(On(mE,e))return mE[e]();Be("Unrecognized Tree layout method: "+e)},params:["size","nodeSize"],fields:gE}),vE.Definition={type:"TreeLinks",metadata:{tree:!0,generates:!0,changes:!0},params:[]},Tn(vE,Hs,{transform(t,e){const n=this.value,r=e.source&&e.source.root,i=e.fork(e.NO_SOURCE),o={};return r||Be("TreeLinks transform requires a tree data source."),e.changed(e.ADD_REM)?(i.rem=n,e.visit(e.SOURCE,t=>o[Yn(t)]=1),r.each(t=>{const e=t.data,n=t.parent&&t.parent.data;n&&o[Yn(e)]&&o[Yn(n)]&&i.add.push(Qn({source:n,target:e}))}),this.value=i.add):e.changed(e.MOD)&&(e.visit(e.MOD,t=>o[Yn(t)]=1),n.forEach(t=>{(o[Yn(t.source)]||o[Yn(t.target)])&&i.mod.push(t)})),i}});var bE=function(t,e,n,r,i){for(var o,a=t.children,s=-1,u=a.length,l=t.value&&(i-n)/t.value;++s<u;)(o=a[s]).x0=e,o.x1=r,o.y0=n,o.y1=n+=o.value*l},wE=(1+Math.sqrt(5))/2;function xE(t,e,n,r,i,o){for(var a,s,u,l,c,h,d,f,p,m,g,y=[],v=e.children,b=0,w=0,x=v.length,_=e.value;b<x;){u=i-n,l=o-r;do{c=v[w++].value}while(!c&&w<x);for(h=d=c,g=c*c*(m=Math.max(l/u,u/l)/(_*t)),p=Math.max(d/g,g/h);w<x;++w){if(c+=s=v[w].value,s<h&&(h=s),s>d&&(d=s),g=c*c*m,(f=Math.max(d/g,g/h))>p){c-=s;break}p=f}y.push(a={value:c,dice:u<l,children:v.slice(b,w)}),a.dice?ZS(a,n,r,i,_?r+=l*c/_:o):bE(a,n,r,_?n+=u*c/_:i,o),_-=c,b=w}return y}var _E=function t(e){function n(t,n,r,i,o){xE(e,t,n,r,i,o)}return n.ratio=function(e){return t((e=+e)>1?e:1)},n}(wE),CE=function t(e){function n(t,n,r,i,o){if((a=t._squarify)&&a.ratio===e)for(var a,s,u,l,c,h=-1,d=a.length,f=t.value;++h<d;){for(u=(s=a[h]).children,l=s.value=0,c=u.length;l<c;++l)s.value+=u[l].value;s.dice?ZS(s,n,r,i,r+=(o-r)*s.value/f):bE(s,n,r,n+=(i-n)*s.value/f,o),f-=s.value}else t._squarify=a=xE(e,t,n,r,i,o),a.ratio=e}return n.ratio=function(e){return t((e=+e)>1?e:1)},n}(wE);const kE={binary:function(t,e,n,r,i){var o,a,s=t.children,u=s.length,l=new Array(u+1);for(l[0]=a=o=0;o<u;++o)l[o+1]=a+=s[o].value;!function t(e,n,r,i,o,a,u){if(e>=n-1){var c=s[e];return c.x0=i,c.y0=o,c.x1=a,void(c.y1=u)}for(var h=l[e],d=r/2+h,f=e+1,p=n-1;f<p;){var m=f+p>>>1;l[m]<d?f=m+1:p=m}d-l[f-1]<l[f]-d&&e+1<f&&--f;var g=l[f]-h,y=r-g;if(a-i>u-o){var v=(i*y+a*g)/r;t(e,f,g,i,o,v,u),t(f,n,y,v,o,a,u)}else{var b=(o*y+u*g)/r;t(e,f,g,i,o,a,b),t(f,n,y,i,b,a,u)}}(0,u,t.value,e,n,r,i)},dice:ZS,slice:bE,slicedice:function(t,e,n,r,i){(1&t.depth?bE:ZS)(t,e,n,r,i)},squarify:_E,resquarify:CE},SE=["x0","y0","x1","y1","depth","children"];function EE(t){ES.call(this,t)}EE.Definition={type:"Treemap",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"method",type:"enum",default:"squarify",values:["squarify","resquarify","binary","dice","slice","slicedice"]},{name:"padding",type:"number",default:0},{name:"paddingInner",type:"number",default:0},{name:"paddingOuter",type:"number",default:0},{name:"paddingTop",type:"number",default:0},{name:"paddingRight",type:"number",default:0},{name:"paddingBottom",type:"number",default:0},{name:"paddingLeft",type:"number",default:0},{name:"ratio",type:"number",default:1.618033988749895},{name:"round",type:"boolean",default:!1},{name:"size",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:SE.length,default:SE}]},Tn(EE,ES,{layout(){const t=function(){var t=_E,e=!1,n=1,r=1,i=[0],o=$S,a=$S,s=$S,u=$S,l=$S;function c(t){return t.x0=t.y0=0,t.x1=n,t.y1=r,t.eachBefore(h),i=[0],e&&t.eachBefore(YS),t}function h(e){var n=i[e.depth],r=e.x0+n,c=e.y0+n,h=e.x1-n,d=e.y1-n;h<r&&(r=h=(r+h)/2),d<c&&(c=d=(c+d)/2),e.x0=r,e.y0=c,e.x1=h,e.y1=d,e.children&&(n=i[e.depth+1]=o(e)/2,r+=l(e)-n,c+=a(e)-n,(h-=s(e)-n)<r&&(r=h=(r+h)/2),(d-=u(e)-n)<c&&(c=d=(c+d)/2),t(e,r,c,h,d))}return c.round=function(t){return arguments.length?(e=!!t,c):e},c.size=function(t){return arguments.length?(n=+t[0],r=+t[1],c):[n,r]},c.tile=function(e){return arguments.length?(t=US(e),c):t},c.padding=function(t){return arguments.length?c.paddingInner(t).paddingOuter(t):c.paddingInner()},c.paddingInner=function(t){return arguments.length?(o="function"==typeof t?t:VS(+t),c):o},c.paddingOuter=function(t){return arguments.length?c.paddingTop(t).paddingRight(t).paddingBottom(t).paddingLeft(t):c.paddingTop()},c.paddingTop=function(t){return arguments.length?(a="function"==typeof t?t:VS(+t),c):a},c.paddingRight=function(t){return arguments.length?(s="function"==typeof t?t:VS(+t),c):s},c.paddingBottom=function(t){return arguments.length?(u="function"==typeof t?t:VS(+t),c):u},c.paddingLeft=function(t){return arguments.length?(l="function"==typeof t?t:VS(+t),c):l},c}();return t.ratio=e=>{const n=t.tile();n.ratio&&t.tile(n.ratio(e))},t.method=e=>{On(kE,e)?t.tile(kE[e]):Be("Unrecognized Treemap layout method: "+e)},t},params:["method","ratio","size","round","padding","paddingInner","paddingOuter","paddingTop","paddingRight","paddingBottom","paddingLeft"],fields:SE});var OE=function(t,e){var n,r,i,o,a,s,u=[],l=function(t){return t(o)};if(null==e)u.push(t);else for(n={},r=0,i=t.length;r<i;++r)o=t[r],(s=n[a=e.map(l)])||(n[a]=s=[],s.dims=a,u.push(s)),s.push(o);return u};function AE(t){Hs.call(this,null,t)}AE.Definition={type:"Loess",metadata:{generates:!0},params:[{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"groupby",type:"field",array:!0},{name:"bandwidth",type:"number",default:.3},{name:"as",type:"string",array:!0}]},Tn(AE,Hs,{transform(t,e){const n=e.fork(e.NO_SOURCE|e.NO_FIELDS);if(!this.value||e.changed()||t.modified()){const r=e.materialize(e.SOURCE).source,i=OE(r,t.groupby),o=(t.groupby||[]).map(Fe),a=o.length,s=t.as||[Fe(t.x),Fe(t.y)],u=[];i.forEach(e=>{rl(e,t.x,t.y,t.bandwidth||.3).forEach(t=>{const n={};for(let r=0;r<a;++r)n[o[r]]=e.dims[r];n[s[0]]=t[0],n[s[1]]=t[1],u.push(Qn(n))})}),this.value&&(n.rem=this.value),this.value=n.add=n.source=u}return n}});const NE={linear:Ku,log:Yu,exp:Zu,pow:Qu,quad:Ju,poly:tl};function TE(t){Hs.call(this,null,t)}TE.Definition={type:"Regression",metadata:{generates:!0},params:[{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"groupby",type:"field",array:!0},{name:"method",type:"string",default:"linear",values:Object.keys(NE)},{name:"order",type:"number",default:3},{name:"extent",type:"number",array:!0,length:2},{name:"params",type:"boolean",default:!1},{name:"as",type:"string",array:!0}]},Tn(TE,Hs,{transform(t,e){const n=e.fork(e.NO_SOURCE|e.NO_FIELDS);if(!this.value||e.changed()||t.modified()){const r=e.materialize(e.SOURCE).source,i=OE(r,t.groupby),o=(t.groupby||[]).map(Fe),a=t.method||"linear",s=t.order||3,u=((t,e)=>"poly"===t?e:"quad"===t?2:1)(a,s),l=t.as||[Fe(t.x),Fe(t.y)],c=NE[a],h=[];let d=t.extent;On(NE,a)||Be("Invalid regression method: "+a),null!=d&&"log"===a&&d[0]<=0&&(e.dataflow.warn("Ignoring extent with values <= 0 for log regression."),d=null),i.forEach(n=>{if(n.length<=u)return void e.dataflow.warn("Skipping regression with more parameters than data points.");const r=c(n,t.x,t.y,s);if(t.params)return void h.push(Qn({keys:n.dims,coef:r.coef,rSquared:r.rSquared}));const i=d||Sn(n,t.x),f=t=>{const e={};for(let r=0;r<o.length;++r)e[o[r]]=n.dims[r];e[l[0]]=t[0],e[l[1]]=t[1],h.push(Qn(e))};"linear"===a?i.forEach(t=>f([t,r.predict(t)])):sl(r.predict,i,25,200).forEach(f)}),this.value&&(n.rem=this.value),this.value=n.add=n.source=h}return n}});const DE=Math.pow(2,-52),RE=new Uint32Array(512);class IE{static from(t,e=UE,n=$E){const r=t.length,i=new Float64Array(2*r);for(let o=0;o<r;o++){const r=t[o];i[2*o]=e(r),i[2*o+1]=n(r)}return new IE(i)}constructor(t){const e=t.length>>1;if(e>0&&"number"!=typeof t[0])throw new Error("Expected coords to contain numbers.");this.coords=t;const n=Math.max(2*e-5,0);this._triangles=new Uint32Array(3*n),this._halfedges=new Int32Array(3*n),this._hashSize=Math.ceil(Math.sqrt(e)),this._hullPrev=new Uint32Array(e),this._hullNext=new Uint32Array(e),this._hullTri=new Uint32Array(e),this._hullHash=new Int32Array(this._hashSize).fill(-1),this._ids=new Uint32Array(e),this._dists=new Float64Array(e),this.update()}update(){const{coords:t,_hullPrev:e,_hullNext:n,_hullTri:r,_hullHash:i}=this,o=t.length>>1;let a=1/0,s=1/0,u=-1/0,l=-1/0;for(let S=0;S<o;S++){const e=t[2*S],n=t[2*S+1];e<a&&(a=e),n<s&&(s=n),e>u&&(u=e),n>l&&(l=n),this._ids[S]=S}const c=(a+u)/2,h=(s+l)/2;let d,f,p,m=1/0;for(let S=0;S<o;S++){const e=ME(c,h,t[2*S],t[2*S+1]);e<m&&(d=S,m=e)}const g=t[2*d],y=t[2*d+1];m=1/0;for(let S=0;S<o;S++){if(S===d)continue;const e=ME(g,y,t[2*S],t[2*S+1]);e<m&&e>0&&(f=S,m=e)}let v=t[2*f],b=t[2*f+1],w=1/0;for(let S=0;S<o;S++){if(S===d||S===f)continue;const e=zE(g,y,v,b,t[2*S],t[2*S+1]);e<w&&(p=S,w=e)}let x=t[2*p],_=t[2*p+1];if(w===1/0){for(let r=0;r<o;r++)this._dists[r]=t[2*r]-t[0]||t[2*r+1]-t[1];LE(this._ids,this._dists,0,o-1);const e=new Uint32Array(o);let n=0;for(let t=0,r=-1/0;t<o;t++){const i=this._ids[t];this._dists[i]>r&&(e[n++]=i,r=this._dists[i])}return this.hull=e.subarray(0,n),this.triangles=new Uint32Array(0),void(this.halfedges=new Uint32Array(0))}if(PE(g,y,v,b,x,_)){const t=f,e=v,n=b;f=p,v=x,b=_,p=t,x=e,_=n}const C=function(t,e,n,r,i,o){const a=n-t,s=r-e,u=i-t,l=o-e,c=a*a+s*s,h=u*u+l*l,d=.5/(a*l-s*u);return{x:t+(l*c-s*h)*d,y:e+(a*h-u*c)*d}}(g,y,v,b,x,_);this._cx=C.x,this._cy=C.y;for(let S=0;S<o;S++)this._dists[S]=ME(t[2*S],t[2*S+1],C.x,C.y);LE(this._ids,this._dists,0,o-1),this._hullStart=d;let k=3;n[d]=e[p]=f,n[f]=e[d]=p,n[p]=e[f]=d,r[d]=0,r[f]=1,r[p]=2,i.fill(-1),i[this._hashKey(g,y)]=d,i[this._hashKey(v,b)]=f,i[this._hashKey(x,_)]=p,this.trianglesLen=0,this._addTriangle(d,f,p,-1,-1,-1);for(let S,E,O=0;O<this._ids.length;O++){const o=this._ids[O],a=t[2*o],s=t[2*o+1];if(O>0&&Math.abs(a-S)<=DE&&Math.abs(s-E)<=DE)continue;if(S=a,E=s,o===d||o===f||o===p)continue;let u=0;for(let t=0,e=this._hashKey(a,s);t<this._hashSize&&(u=i[(e+t)%this._hashSize],-1===u||u===n[u]);t++);u=e[u];let l,c=u;for(;l=n[c],!PE(a,s,t[2*c],t[2*c+1],t[2*l],t[2*l+1]);)if(c=l,c===u){c=-1;break}if(-1===c)continue;let h=this._addTriangle(c,o,n[c],-1,-1,r[c]);r[o]=this._legalize(h+2),r[c]=h,k++;let m=n[c];for(;l=n[m],PE(a,s,t[2*m],t[2*m+1],t[2*l],t[2*l+1]);)h=this._addTriangle(m,o,l,r[o],-1,r[m]),r[o]=this._legalize(h+2),n[m]=m,k--,m=l;if(c===u)for(;l=e[c],PE(a,s,t[2*l],t[2*l+1],t[2*c],t[2*c+1]);)h=this._addTriangle(l,o,c,-1,r[c],r[l]),this._legalize(h+2),r[l]=h,n[c]=c,k--,c=l;this._hullStart=e[o]=c,n[c]=e[m]=o,n[o]=m,i[this._hashKey(a,s)]=o,i[this._hashKey(t[2*c],t[2*c+1])]=c}this.hull=new Uint32Array(k);for(let S=0,E=this._hullStart;S<k;S++)this.hull[S]=E,E=n[E];this.triangles=this._triangles.subarray(0,this.trianglesLen),this.halfedges=this._halfedges.subarray(0,this.trianglesLen)}_hashKey(t,e){return Math.floor(function(t,e){const n=t/(Math.abs(t)+Math.abs(e));return(e>0?3-n:1+n)/4}(t-this._cx,e-this._cy)*this._hashSize)%this._hashSize}_legalize(t){const{_triangles:e,_halfedges:n,coords:r}=this;let i=0,o=0;for(;;){const a=n[t],s=t-t%3;if(o=s+(t+2)%3,-1===a){if(0===i)break;t=RE[--i];continue}const u=a-a%3,l=u+(a+2)%3,c=e[o],h=e[t],d=e[s+(t+1)%3],f=e[l];if(jE(r[2*c],r[2*c+1],r[2*h],r[2*h+1],r[2*d],r[2*d+1],r[2*f],r[2*f+1])){e[t]=f,e[a]=c;const r=n[l];if(-1===r){let e=this._hullStart;do{if(this._hullTri[e]===l){this._hullTri[e]=t;break}e=this._hullPrev[e]}while(e!==this._hullStart)}this._link(t,r),this._link(a,n[o]),this._link(o,l);const s=u+(a+1)%3;i<RE.length&&(RE[i++]=s)}else{if(0===i)break;t=RE[--i]}}return o}_link(t,e){this._halfedges[t]=e,-1!==e&&(this._halfedges[e]=t)}_addTriangle(t,e,n,r,i,o){const a=this.trianglesLen;return this._triangles[a]=t,this._triangles[a+1]=e,this._triangles[a+2]=n,this._link(a,r),this._link(a+1,i),this._link(a+2,o),this.trianglesLen+=3,a}}function ME(t,e,n,r){const i=t-n,o=e-r;return i*i+o*o}function FE(t,e,n,r,i,o){const a=(r-e)*(i-t),s=(n-t)*(o-e);return Math.abs(a-s)>=33306690738754716e-32*Math.abs(a+s)?a-s:0}function PE(t,e,n,r,i,o){return(FE(i,o,t,e,n,r)||FE(t,e,n,r,i,o)||FE(n,r,i,o,t,e))<0}function jE(t,e,n,r,i,o,a,s){const u=t-a,l=e-s,c=n-a,h=r-s,d=i-a,f=o-s,p=c*c+h*h,m=d*d+f*f;return u*(h*m-p*f)-l*(c*m-p*d)+(u*u+l*l)*(c*f-h*d)<0}function zE(t,e,n,r,i,o){const a=n-t,s=r-e,u=i-t,l=o-e,c=a*a+s*s,h=u*u+l*l,d=.5/(a*l-s*u),f=(l*c-s*h)*d,p=(a*h-u*c)*d;return f*f+p*p}function LE(t,e,n,r){if(r-n<=20)for(let i=n+1;i<=r;i++){const r=t[i],o=e[r];let a=i-1;for(;a>=n&&e[t[a]]>o;)t[a+1]=t[a--];t[a+1]=r}else{let i=n+1,o=r;BE(t,n+r>>1,i),e[t[n]]>e[t[r]]&&BE(t,n,r),e[t[i]]>e[t[r]]&&BE(t,i,r),e[t[n]]>e[t[i]]&&BE(t,n,i);const a=t[i],s=e[a];for(;;){do{i++}while(e[t[i]]<s);do{o--}while(e[t[o]]>s);if(o<i)break;BE(t,i,o)}t[n+1]=t[o],t[o]=a,r-i+1>=o-n?(LE(t,e,i,r),LE(t,e,n,o-1)):(LE(t,e,n,o-1),LE(t,e,i,r))}}function BE(t,e,n){const r=t[e];t[e]=t[n],t[n]=r}function UE(t){return t[0]}function $E(t){return t[1]}class VE{constructor(){this._x0=this._y0=this._x1=this._y1=null,this._=""}moveTo(t,e){this._+=`M${this._x0=this._x1=+t},${this._y0=this._y1=+e}`}closePath(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")}lineTo(t,e){this._+=`L${this._x1=+t},${this._y1=+e}`}arc(t,e,n){const r=(t=+t)+(n=+n),i=e=+e;if(n<0)throw new Error("negative radius");null===this._x1?this._+=`M${r},${i}`:(Math.abs(this._x1-r)>1e-6||Math.abs(this._y1-i)>1e-6)&&(this._+="L"+r+","+i),n&&(this._+=`A${n},${n},0,1,1,${t-n},${e}A${n},${n},0,1,1,${this._x1=r},${this._y1=i}`)}rect(t,e,n,r){this._+=`M${this._x0=this._x1=+t},${this._y0=this._y1=+e}h${+n}v${+r}h${-n}Z`}value(){return this._||null}}class WE{constructor(){this._=[]}moveTo(t,e){this._.push([t,e])}closePath(){this._.push(this._[0].slice())}lineTo(t,e){this._.push([t,e])}value(){return this._.length?this._:null}}class qE{constructor(t,[e,n,r,i]=[0,0,960,500]){if(!((r=+r)>=(e=+e)&&(i=+i)>=(n=+n)))throw new Error("invalid bounds");this.delaunay=t,this._circumcenters=new Float64Array(2*t.points.length),this.vectors=new Float64Array(2*t.points.length),this.xmax=r,this.xmin=e,this.ymax=i,this.ymin=n,this._init()}update(){return this.delaunay.update(),this._init(),this}_init(){const{delaunay:{points:t,hull:e,triangles:n},vectors:r}=this,i=this.circumcenters=this._circumcenters.subarray(0,n.length/3*2);for(let d,f,p=0,m=0,g=n.length;p<g;p+=3,m+=2){const e=2*n[p],r=2*n[p+1],o=2*n[p+2],a=t[e],s=t[e+1],u=t[o],l=t[o+1],c=t[r]-a,h=t[r+1]-s,g=u-a,y=l-s,v=c*c+h*h,b=g*g+y*y,w=2*(c*y-h*g);if(w)if(Math.abs(w)<1e-8)d=(a+u)/2,f=(s+l)/2;else{const t=1/w;d=a+(y*v-h*b)*t,f=s+(c*b-g*v)*t}else d=(a+u)/2-1e8*y,f=(s+l)/2+1e8*g;i[m]=d,i[m+1]=f}let o,a,s,u=e[e.length-1],l=4*u,c=t[2*u],h=t[2*u+1];r.fill(0);for(let d=0;d<e.length;++d)u=e[d],o=l,a=c,s=h,l=4*u,c=t[2*u],h=t[2*u+1],r[o+2]=r[l]=s-h,r[o+3]=r[l+1]=c-a}render(t){const e=null==t?t=new VE:void 0,{delaunay:{halfedges:n,inedges:r,hull:i},circumcenters:o,vectors:a}=this;if(i.length<=1)return null;for(let l=0,c=n.length;l<c;++l){const e=n[l];if(e<l)continue;const r=2*Math.floor(l/3),i=2*Math.floor(e/3);this._renderSegment(o[r],o[r+1],o[i],o[i+1],t)}let s,u=i[i.length-1];for(let l=0;l<i.length;++l){s=u,u=i[l];const e=2*Math.floor(r[u]/3),n=o[e],c=o[e+1],h=4*s,d=this._project(n,c,a[h+2],a[h+3]);d&&this._renderSegment(n,c,d[0],d[1],t)}return e&&e.value()}renderBounds(t){const e=null==t?t=new VE:void 0;return t.rect(this.xmin,this.ymin,this.xmax-this.xmin,this.ymax-this.ymin),e&&e.value()}renderCell(t,e){const n=null==e?e=new VE:void 0,r=this._clip(t);if(null===r||!r.length)return;e.moveTo(r[0],r[1]);let i=r.length;for(;r[0]===r[i-2]&&r[1]===r[i-1]&&i>1;)i-=2;for(let o=2;o<i;o+=2)r[o]===r[o-2]&&r[o+1]===r[o-1]||e.lineTo(r[o],r[o+1]);return e.closePath(),n&&n.value()}*cellPolygons(){const{delaunay:{points:t}}=this;for(let e=0,n=t.length/2;e<n;++e){const t=this.cellPolygon(e);t&&(t.index=e,yield t)}}cellPolygon(t){const e=new WE;return this.renderCell(t,e),e.value()}_renderSegment(t,e,n,r,i){let o;const a=this._regioncode(t,e),s=this._regioncode(n,r);0===a&&0===s?(i.moveTo(t,e),i.lineTo(n,r)):(o=this._clipSegment(t,e,n,r,a,s))&&(i.moveTo(o[0],o[1]),i.lineTo(o[2],o[3]))}contains(t,e,n){return(e=+e)==e&&(n=+n)==n&&this.delaunay._step(t,e,n)===t}*neighbors(t){const e=this._clip(t);if(e)for(const n of this.delaunay.neighbors(t)){const t=this._clip(n);if(t)t:for(let r=0,i=e.length;r<i;r+=2)for(let o=0,a=t.length;o<a;o+=2)if(e[r]==t[o]&&e[r+1]==t[o+1]&&e[(r+2)%i]==t[(o+a-2)%a]&&e[(r+3)%i]==t[(o+a-1)%a]){yield n;break t}}}_cell(t){const{circumcenters:e,delaunay:{inedges:n,halfedges:r,triangles:i}}=this,o=n[t];if(-1===o)return null;const a=[];let s=o;do{const n=Math.floor(s/3);if(a.push(e[2*n],e[2*n+1]),s=s%3==2?s-2:s+1,i[s]!==t)break;s=r[s]}while(s!==o&&-1!==s);return a}_clip(t){if(0===t&&1===this.delaunay.hull.length)return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];const e=this._cell(t);if(null===e)return null;const{vectors:n}=this,r=4*t;return n[r]||n[r+1]?this._clipInfinite(t,e,n[r],n[r+1],n[r+2],n[r+3]):this._clipFinite(t,e)}_clipFinite(t,e){const n=e.length;let r,i,o,a,s,u=null,l=e[n-2],c=e[n-1],h=this._regioncode(l,c);for(let d=0;d<n;d+=2)if(r=l,i=c,l=e[d],c=e[d+1],o=h,h=this._regioncode(l,c),0===o&&0===h)a=s,s=0,u?u.push(l,c):u=[l,c];else{let e,n,d,f,p;if(0===o){if(null===(e=this._clipSegment(r,i,l,c,o,h)))continue;[n,d,f,p]=e}else{if(null===(e=this._clipSegment(l,c,r,i,h,o)))continue;[f,p,n,d]=e,a=s,s=this._edgecode(n,d),a&&s&&this._edge(t,a,s,u,u.length),u?u.push(n,d):u=[n,d]}a=s,s=this._edgecode(f,p),a&&s&&this._edge(t,a,s,u,u.length),u?u.push(f,p):u=[f,p]}if(u)a=s,s=this._edgecode(u[0],u[1]),a&&s&&this._edge(t,a,s,u,u.length);else if(this.contains(t,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2))return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];return u}_clipSegment(t,e,n,r,i,o){for(;;){if(0===i&&0===o)return[t,e,n,r];if(i&o)return null;let a,s,u=i||o;8&u?(a=t+(n-t)*(this.ymax-e)/(r-e),s=this.ymax):4&u?(a=t+(n-t)*(this.ymin-e)/(r-e),s=this.ymin):2&u?(s=e+(r-e)*(this.xmax-t)/(n-t),a=this.xmax):(s=e+(r-e)*(this.xmin-t)/(n-t),a=this.xmin),i?i=this._regioncode(t=a,e=s):o=this._regioncode(n=a,r=s)}}_clipInfinite(t,e,n,r,i,o){let a,s=Array.from(e);if((a=this._project(s[0],s[1],n,r))&&s.unshift(a[0],a[1]),(a=this._project(s[s.length-2],s[s.length-1],i,o))&&s.push(a[0],a[1]),s=this._clipFinite(t,s))for(let u,l=0,c=s.length,h=this._edgecode(s[c-2],s[c-1]);l<c;l+=2)u=h,h=this._edgecode(s[l],s[l+1]),u&&h&&(l=this._edge(t,u,h,s,l),c=s.length);else this.contains(t,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2)&&(s=[this.xmin,this.ymin,this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax]);return s}_edge(t,e,n,r,i){for(;e!==n;){let n,o;switch(e){case 5:e=4;continue;case 4:e=6,n=this.xmax,o=this.ymin;break;case 6:e=2;continue;case 2:e=10,n=this.xmax,o=this.ymax;break;case 10:e=8;continue;case 8:e=9,n=this.xmin,o=this.ymax;break;case 9:e=1;continue;case 1:e=5,n=this.xmin,o=this.ymin}r[i]===n&&r[i+1]===o||!this.contains(t,n,o)||(r.splice(i,0,n,o),i+=2)}if(r.length>4)for(let o=0;o<r.length;o+=2){const t=(o+2)%r.length,e=(o+4)%r.length;(r[o]===r[t]&&r[t]===r[e]||r[o+1]===r[t+1]&&r[t+1]===r[e+1])&&(r.splice(t,2),o-=2)}return i}_project(t,e,n,r){let i,o,a,s=1/0;if(r<0){if(e<=this.ymin)return null;(i=(this.ymin-e)/r)<s&&(a=this.ymin,o=t+(s=i)*n)}else if(r>0){if(e>=this.ymax)return null;(i=(this.ymax-e)/r)<s&&(a=this.ymax,o=t+(s=i)*n)}if(n>0){if(t>=this.xmax)return null;(i=(this.xmax-t)/n)<s&&(o=this.xmax,a=e+(s=i)*r)}else if(n<0){if(t<=this.xmin)return null;(i=(this.xmin-t)/n)<s&&(o=this.xmin,a=e+(s=i)*r)}return[o,a]}_edgecode(t,e){return(t===this.xmin?1:t===this.xmax?2:0)|(e===this.ymin?4:e===this.ymax?8:0)}_regioncode(t,e){return(t<this.xmin?1:t>this.xmax?2:0)|(e<this.ymin?4:e>this.ymax?8:0)}}const HE=2*Math.PI,GE=Math.pow;function XE(t){return t[0]}function KE(t){return t[1]}function YE(t,e,n){return[t+Math.sin(t+e)*n,e+Math.cos(t-e)*n]}class ZE{static from(t,e=XE,n=KE,r){return new ZE("length"in t?function(t,e,n,r){const i=t.length,o=new Float64Array(2*i);for(let a=0;a<i;++a){const i=t[a];o[2*a]=e.call(r,i,a,t),o[2*a+1]=n.call(r,i,a,t)}return o}(t,e,n,r):Float64Array.from(function*(t,e,n,r){let i=0;for(const o of t)yield e.call(r,o,i,t),yield n.call(r,o,i,t),++i}(t,e,n,r)))}constructor(t){this._delaunator=new IE(t),this.inedges=new Int32Array(t.length/2),this._hullIndex=new Int32Array(t.length/2),this.points=this._delaunator.coords,this._init()}update(){return this._delaunator.update(),this._init(),this}_init(){const t=this._delaunator,e=this.points;if(t.hull&&t.hull.length>2&&function(t){const{triangles:e,coords:n}=t;for(let r=0;r<e.length;r+=3){const t=2*e[r],i=2*e[r+1],o=2*e[r+2];if((n[o]-n[t])*(n[i+1]-n[t+1])-(n[i]-n[t])*(n[o+1]-n[t+1])>1e-10)return!1}return!0}(t)){this.collinear=Int32Array.from({length:e.length/2},(t,e)=>e).sort((t,n)=>e[2*t]-e[2*n]||e[2*t+1]-e[2*n+1]);const t=this.collinear[0],n=this.collinear[this.collinear.length-1],r=[e[2*t],e[2*t+1],e[2*n],e[2*n+1]],i=1e-8*Math.hypot(r[3]-r[1],r[2]-r[0]);for(let o=0,a=e.length/2;o<a;++o){const t=YE(e[2*o],e[2*o+1],i);e[2*o]=t[0],e[2*o+1]=t[1]}this._delaunator=new IE(e)}else delete this.collinear;const n=this.halfedges=this._delaunator.halfedges,r=this.hull=this._delaunator.hull,i=this.triangles=this._delaunator.triangles,o=this.inedges.fill(-1),a=this._hullIndex.fill(-1);for(let s=0,u=n.length;s<u;++s){const t=i[s%3==2?s-2:s+1];-1!==n[s]&&-1!==o[t]||(o[t]=s)}for(let s=0,u=r.length;s<u;++s)a[r[s]]=s;r.length<=2&&r.length>0&&(this.triangles=new Int32Array(3).fill(-1),this.halfedges=new Int32Array(3).fill(-1),this.triangles[0]=r[0],this.triangles[1]=r[1],this.triangles[2]=r[1],o[r[0]]=1,2===r.length&&(o[r[1]]=0))}voronoi(t){return new qE(this,t)}*neighbors(t){const{inedges:e,hull:n,_hullIndex:r,halfedges:i,triangles:o,collinear:a}=this;if(a){const e=a.indexOf(t);return e>0&&(yield a[e-1]),void(e<a.length-1&&(yield a[e+1]))}const s=e[t];if(-1===s)return;let u=s,l=-1;do{if(yield l=o[u],u=u%3==2?u-2:u+1,o[u]!==t)return;if(u=i[u],-1===u){const e=n[(r[t]+1)%n.length];return void(e!==l&&(yield e))}}while(u!==s)}find(t,e,n=0){if((t=+t)!=t||(e=+e)!=e)return-1;const r=n;let i;for(;(i=this._step(n,t,e))>=0&&i!==n&&i!==r;)n=i;return i}_step(t,e,n){const{inedges:r,hull:i,_hullIndex:o,halfedges:a,triangles:s,points:u}=this;if(-1===r[t]||!u.length)return(t+1)%(u.length>>1);let l=t,c=GE(e-u[2*t],2)+GE(n-u[2*t+1],2);const h=r[t];let d=h;do{let r=s[d];const h=GE(e-u[2*r],2)+GE(n-u[2*r+1],2);if(h<c&&(c=h,l=r),d=d%3==2?d-2:d+1,s[d]!==t)break;if(d=a[d],-1===d){if(d=i[(o[t]+1)%i.length],d!==r&&GE(e-u[2*d],2)+GE(n-u[2*d+1],2)<c)return d;break}}while(d!==h);return l}render(t){const e=null==t?t=new VE:void 0,{points:n,halfedges:r,triangles:i}=this;for(let o=0,a=r.length;o<a;++o){const e=r[o];if(e<o)continue;const a=2*i[o],s=2*i[e];t.moveTo(n[a],n[a+1]),t.lineTo(n[s],n[s+1])}return this.renderHull(t),e&&e.value()}renderPoints(t,e=2){const n=null==t?t=new VE:void 0,{points:r}=this;for(let i=0,o=r.length;i<o;i+=2){const n=r[i],o=r[i+1];t.moveTo(n+e,o),t.arc(n,o,e,0,HE)}return n&&n.value()}renderHull(t){const e=null==t?t=new VE:void 0,{hull:n,points:r}=this,i=2*n[0],o=n.length;t.moveTo(r[i],r[i+1]);for(let a=1;a<o;++a){const e=2*n[a];t.lineTo(r[e],r[e+1])}return t.closePath(),e&&e.value()}hullPolygon(){const t=new WE;return this.renderHull(t),t.value()}renderTriangle(t,e){const n=null==e?e=new VE:void 0,{points:r,triangles:i}=this,o=2*i[t*=3],a=2*i[t+1],s=2*i[t+2];return e.moveTo(r[o],r[o+1]),e.lineTo(r[a],r[a+1]),e.lineTo(r[s],r[s+1]),e.closePath(),n&&n.value()}*trianglePolygons(){const{triangles:t}=this;for(let e=0,n=t.length/3;e<n;++e)yield this.trianglePolygon(e)}trianglePolygon(t){const e=new WE;return this.renderTriangle(t,e),e.value()}}function QE(t){Hs.call(this,null,t)}QE.Definition={type:"Voronoi",metadata:{modifies:!0},params:[{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"size",type:"number",array:!0,length:2},{name:"extent",type:"array",array:!0,length:2,default:[[-1e5,-1e5],[1e5,1e5]],content:{type:"number",array:!0,length:2}},{name:"as",type:"string",default:"path"}]};const JE=[-1e5,-1e5,1e5,1e5];function tO(t){const e=t[0][0],n=t[0][1];let r=t.length-1;for(;t[r][0]===e&&t[r][1]===n;--r);return"M"+t.slice(0,r+1).join("L")+"Z"}Tn(QE,Hs,{transform(t,e){const n=t.as||"path",r=e.source;if(!r||!r.length)return e;let i=t.size;i=i?[0,0,i[0],i[1]]:(i=t.extent)?[i[0][0],i[0][1],i[1][0],i[1][1]]:JE;const o=this.value=ZE.from(r,t.x,t.y).voronoi(i);for(let a=0,s=r.length;a<s;++a){const t=o.cellPolygon(a);r[a][n]=t?tO(t):null}return e.reflow(t.modified()).modifies(n)}});var eO=Math.PI/180;function nO(t,e,n,r){if(!e.sprite){var i=t.context,o=t.ratio;i.clearRect(0,0,2048/o,2048/o);var a,s,u,l,c,h=0,d=0,f=0,p=n.length;for(--r;++r<p;){if(e=n[r],i.save(),i.font=e.style+" "+e.weight+" "+~~((e.size+1)/o)+"px "+e.font,a=i.measureText(e.text+"m").width*o,u=e.size<<1,e.rotate){var m=Math.sin(e.rotate*eO),g=Math.cos(e.rotate*eO),y=a*g,v=a*m,b=u*g,w=u*m;a=Math.max(Math.abs(y+w),Math.abs(y-w))+31>>5<<5,u=~~Math.max(Math.abs(v+b),Math.abs(v-b))}else a=a+31>>5<<5;if(u>f&&(f=u),h+a>=2048&&(h=0,d+=f,f=0),d+u>=2048)break;i.translate((h+(a>>1))/o,(d+(u>>1))/o),e.rotate&&i.rotate(e.rotate*eO),i.fillText(e.text,0,0),e.padding&&(i.lineWidth=2*e.padding,i.strokeText(e.text,0,0)),i.restore(),e.width=a,e.height=u,e.xoff=h,e.yoff=d,e.x1=a>>1,e.y1=u>>1,e.x0=-e.x1,e.y0=-e.y1,e.hasText=!0,h+=a}for(var x=i.getImageData(0,0,2048/o,2048/o).data,_=[];--r>=0;)if((e=n[r]).hasText){for(s=(a=e.width)>>5,u=e.y1-e.y0,l=0;l<u*s;l++)_[l]=0;if(null==(h=e.xoff))return;d=e.yoff;var C=0,k=-1;for(c=0;c<u;c++){for(l=0;l<a;l++){var S=x[2048*(d+c)+(h+l)<<2]?1<<31-l%32:0;_[s*c+(l>>5)]|=S,C|=S}C?k=c:(e.y0++,u--,c--,d++)}e.y1=e.y0+k,e.sprite=_.slice(0,(e.y1-e.y0)*s)}}}function rO(t,e,n){for(var r,i=t.sprite,o=t.width>>5,a=t.x-(o<<4),s=127&a,u=32-s,l=t.y1-t.y0,c=(t.y+t.y0)*(n>>=5)+(a>>5),h=0;h<l;h++){r=0;for(var d=0;d<=o;d++)if((r<<u|(d<o?(r=i[h*o+d])>>>s:0))&e[c+d])return!0;c+=n}return!1}function iO(t,e){var n=t[0],r=t[1];e.x+e.x0<n.x&&(n.x=e.x+e.x0),e.y+e.y0<n.y&&(n.y=e.y+e.y0),e.x+e.x1>r.x&&(r.x=e.x+e.x1),e.y+e.y1>r.y&&(r.y=e.y+e.y1)}function oO(t){var e=t[0]/t[1];return function(t){return[e*(t*=.1)*Math.cos(t),t*Math.sin(t)]}}function aO(t){return"function"==typeof t?t:function(){return t}}var sO={archimedean:oO,rectangular:function(t){var e=4*t[0]/t[1],n=0,r=0;return function(t){var i=t<0?-1:1;switch(Math.sqrt(1+4*i*t)-i&3){case 0:n+=e;break;case 1:r+=4;break;case 2:n-=e;break;default:r-=4}return[n,r]}}},uO=["x","y","font","fontSize","fontStyle","fontWeight","angle"],lO=["text","font","rotate","fontSize","fontStyle","fontWeight"];function cO(t){Hs.call(this,function(){var t,e,n,r,i,o,a,s=[256,256],u=oO,l=[],c=Math.random,h={};function d(t,e,n){for(var r,i,o,a,l,h=e.x,d=e.y,f=Math.sqrt(s[0]*s[0]+s[1]*s[1]),p=u(s),m=c()<.5?1:-1,g=-m;(r=p(g+=m))&&(i=~~r[0],o=~~r[1],!(Math.min(Math.abs(i),Math.abs(o))>=f));)if(e.x=h+i,e.y=d+o,!(e.x+e.x0<0||e.y+e.y0<0||e.x+e.x1>s[0]||e.y+e.y1>s[1]||n&&rO(e,t,s[0])||n&&!((a=e).x+a.x1>(l=n)[0].x&&a.x+a.x0<l[1].x&&a.y+a.y1>l[0].y&&a.y+a.y0<l[1].y))){for(var y,v=e.sprite,b=e.width>>5,w=s[0]>>5,x=e.x-(b<<4),_=127&x,C=32-_,k=e.y1-e.y0,S=(e.y+e.y0)*w+(x>>5),E=0;E<k;E++){y=0;for(var O=0;O<=b;O++)t[S+O]|=y<<C|(O<b?(y=v[E*b+O])>>>_:0);S+=w}return e.sprite=null,!0}return!1}return h.layout=function(){for(var u=function(t){t.width=t.height=1;var e=Math.sqrt(t.getContext("2d").getImageData(0,0,1,1).data.length>>2);t.width=2048/e,t.height=2048/e;var n=t.getContext("2d");return n.fillStyle=n.strokeStyle="red",n.textAlign="center",{context:n,ratio:e}}(Vd()),h=function(t){for(var e=[],n=-1;++n<t;)e[n]=0;return e}((s[0]>>5)*s[1]),f=null,p=l.length,m=-1,g=[],y=l.map((function(s){return{text:t(s),font:e(s),style:r(s),weight:i(s),rotate:o(s),size:~~(n(s)+1e-14),padding:a(s),xoff:0,yoff:0,x1:0,y1:0,x0:0,y0:0,hasText:!1,sprite:null,datum:s}})).sort((function(t,e){return e.size-t.size}));++m<p;){var v=y[m];v.x=s[0]*(c()+.5)>>1,v.y=s[1]*(c()+.5)>>1,nO(u,v,y,m),v.hasText&&d(h,v,f)&&(g.push(v),f?iO(f,v):f=[{x:v.x+v.x0,y:v.y+v.y0},{x:v.x+v.x1,y:v.y+v.y1}],v.x-=s[0]>>1,v.y-=s[1]>>1)}return g},h.words=function(t){return arguments.length?(l=t,h):l},h.size=function(t){return arguments.length?(s=[+t[0],+t[1]],h):s},h.font=function(t){return arguments.length?(e=aO(t),h):e},h.fontStyle=function(t){return arguments.length?(r=aO(t),h):r},h.fontWeight=function(t){return arguments.length?(i=aO(t),h):i},h.rotate=function(t){return arguments.length?(o=aO(t),h):o},h.text=function(e){return arguments.length?(t=aO(e),h):t},h.spiral=function(t){return arguments.length?(u=sO[t]||t,h):u},h.fontSize=function(t){return arguments.length?(n=aO(t),h):n},h.padding=function(t){return arguments.length?(a=aO(t),h):a},h.random=function(t){return arguments.length?(c=t,h):c},h}(),t)}cO.Definition={type:"Wordcloud",metadata:{modifies:!0},params:[{name:"size",type:"number",array:!0,length:2},{name:"font",type:"string",expr:!0,default:"sans-serif"},{name:"fontStyle",type:"string",expr:!0,default:"normal"},{name:"fontWeight",type:"string",expr:!0,default:"normal"},{name:"fontSize",type:"number",expr:!0,default:14},{name:"fontSizeRange",type:"number",array:"nullable",default:[10,50]},{name:"rotate",type:"number",expr:!0,default:0},{name:"text",type:"field"},{name:"spiral",type:"string",values:["archimedean","rectangular"]},{name:"padding",type:"number",expr:!0},{name:"as",type:"string",array:!0,length:7,default:uO}]},Tn(cO,Hs,{transform(t,e){!t.size||t.size[0]&&t.size[1]||Be("Wordcloud size dimensions must be non-zero.");const n=t.modified();if(!(n||e.changed(e.ADD_REM)||lO.some((function(n){var r=t[n];return gn(r)&&e.modified(r.fields)}))))return;const r=e.materialize(e.SOURCE).source,i=this.value,o=t.as||uO;let a,s=t.fontSize||14;if(gn(s)?a=t.fontSizeRange:s=_n(s),a){const t=s,e=yy("sqrt")().domain(Sn(r,t)).range(a);s=n=>e(t(n))}r.forEach(t=>{t[o[0]]=NaN,t[o[1]]=NaN,t[o[3]]=0});const u=i.words(r).text(t.text).size(t.size||[500,500]).padding(t.padding||1).spiral(t.spiral||"archimedean").rotate(t.rotate||0).font(t.font||"sans-serif").fontStyle(t.fontStyle||"normal").fontWeight(t.fontWeight||"normal").fontSize(s).random(bu).layout(),l=i.size(),c=l[0]>>1,h=l[1]>>1,d=u.length;for(let f,p,m=0;m<d;++m)f=u[m],p=f.datum,p[o[0]]=f.x+c,p[o[1]]=f.y+h,p[o[2]]=f.font,p[o[3]]=f.size,p[o[4]]=f.style,p[o[5]]=f.weight,p[o[6]]=f.rotate;return e.reflow(n).modifies(o)}});const hO=t=>new Uint8Array(t),dO=t=>new Uint16Array(t),fO=t=>new Uint32Array(t);function pO(t,e,n){const r=(e<257?hO:e<65537?dO:fO)(t);return n&&r.set(n),r}var mO=function(t,e,n){const r=1<<e;return{one:r,zero:~r,range:n.slice(),bisect:t.bisect,index:t.index,size:t.size,onAdd(t,e){let n,i=this.bisect(this.range,t.value),o=t.index,a=i[0],s=i[1],u=o.length;for(n=0;n<a;++n)e[o[n]]|=r;for(n=s;n<u;++n)e[o[n]]|=r;return this}}};function gO(){let t=fO(0),e=[],n=0;return{insert:function(r,i,o){if(!i.length)return[];let a,s,u,l=n,c=i.length,h=Array(c),d=fO(c);for(u=0;u<c;++u)h[u]=r(i[u]),d[u]=u;if(h=function(t,e){return t.sort.call(e,(e,n)=>{const r=t[e],i=t[n];return r<i?-1:r>i?1:0}),n=t,Array.from(e,t=>n[t]);var n}(h,d),l)a=e,s=t,e=Array(l+c),t=fO(l+c),function(t,e,n,r,i,o,a,s,u){let l,c=0,h=0;for(l=0;c<r&&h<a;++l)e[c]<i[h]?(s[l]=e[c],u[l]=n[c++]):(s[l]=i[h],u[l]=o[h++]+t);for(;c<r;++c,++l)s[l]=e[c],u[l]=n[c];for(;h<a;++h,++l)s[l]=i[h],u[l]=o[h]+t}(o,a,s,l,h,d,c,e,t);else{if(o>0)for(u=0;u<c;++u)d[u]+=o;e=h,t=d}return n=l+c,{index:d,value:h}},remove:function(r,i){let o,a,s,u=n;for(a=0;!i[t[a]]&&a<u;++a);for(s=a;a<u;++a)i[o=t[a]]||(t[s]=o,e[s]=e[a],++s);n=u-r},bisect:function(t,r){let i;return r?i=r.length:(r=e,i=n),[_m(r,t[0],0,i),xm(r,t[1],0,i)]},reindex:function(e){for(let r=0,i=n;r<i;++r)t[r]=e[t[r]]},index:()=>t,size:()=>n}}function yO(t){Hs.call(this,function(){let t=8,e=[],n=fO(0),r=pO(0,t),i=pO(0,t);return{data:()=>e,seen:()=>{return n=(t=n).length>=(r=e.length)?t:((i=i||new t.constructor(r)).set(t),i);var t,r,i},add(t){for(let n,r=0,i=e.length,o=t.length;r<o;++r)n=t[r],n._index=i++,e.push(n)},remove(t,n){let o,a,s,u=e.length,l=Array(u-t),c=e;for(a=0;!n[a]&&a<u;++a)l[a]=e[a],c[a]=a;for(s=a;a<u;++a)o=e[a],n[a]?c[a]=-1:(c[a]=s,r[s]=r[a],i[s]=i[a],l[s]=o,o._index=s++),r[a]=0;return e=l,c},size:()=>e.length,curr:()=>r,prev:()=>i,reset:t=>i[t]=r[t],all:()=>t<257?255:t<65537?65535:4294967295,set(t,e){r[t]|=e},clear(t,e){r[t]&=~e},resize(e,n){(e>r.length||n>t)&&(t=Math.max(n,t),r=pO(e,t,r),i=pO(e,t))}}}(),t),this._indices=null,this._dims=null}function vO(t){Hs.call(this,null,t)}yO.Definition={type:"CrossFilter",metadata:{},params:[{name:"fields",type:"field",array:!0,required:!0},{name:"query",type:"array",array:!0,required:!0,content:{type:"number",array:!0,length:2}}]},Tn(yO,Hs,{transform(t,e){return this._dims?t.modified("fields")||t.fields.some(t=>e.modified(t.fields))?this.reinit(t,e):this.eval(t,e):this.init(t,e)},init(t,e){let n,r,i=t.fields,o=t.query,a=this._indices={},s=this._dims=[],u=o.length,l=0;for(;l<u;++l)n=i[l].fname,r=a[n]||(a[n]=gO()),s.push(mO(r,l,o[l]));return this.eval(t,e)},reinit(t,e){let n,r,i,o,a,s,u,l,c,h=e.materialize().fork(),d=t.fields,f=t.query,p=this._indices,m=this._dims,g=this.value,y=g.curr(),v=g.prev(),b=g.all(),w=h.rem=h.add,x=h.mod,_=f.length,C={};if(v.set(y),e.rem.length&&(a=this.remove(t,e,h)),e.add.length&&g.add(e.add),e.mod.length)for(s={},o=e.mod,u=0,l=o.length;u<l;++u)s[o[u]._index]=1;for(u=0;u<_;++u)c=d[u],(!m[u]||t.modified("fields",u)||e.modified(c.fields))&&(i=c.fname,(n=C[i])||(p[i]=r=gO(),C[i]=n=r.insert(c,e.source,0)),m[u]=mO(r,u,f[u]).onAdd(n,y));for(u=0,l=g.data().length;u<l;++u)a[u]||(v[u]!==y[u]?w.push(u):s[u]&&y[u]!==b&&x.push(u));return g.mask=(1<<_)-1,h},eval(t,e){let n=e.materialize().fork(),r=this._dims.length,i=0;return e.rem.length&&(this.remove(t,e,n),i|=(1<<r)-1),t.modified("query")&&!t.modified("fields")&&(i|=this.update(t,e,n)),e.add.length&&(this.insert(t,e,n),i|=(1<<r)-1),e.mod.length&&(this.modify(e,n),i|=(1<<r)-1),this.value.mask=i,n},insert(t,e,n){let r,i,o,a=e.add,s=this.value,u=this._dims,l=this._indices,c=t.fields,h={},d=n.add,f=s.size(),p=f+a.length,m=u.length;s.resize(p,m),s.add(a);const g=s.curr(),y=s.prev(),v=s.all();for(r=0;r<m;++r)i=c[r].fname,o=h[i]||(h[i]=l[i].insert(c[r],a,f)),u[r].onAdd(o,g);for(;f<p;++f)y[f]=v,g[f]!==v&&d.push(f)},modify(t,e){let n,r,i,o=e.mod,a=this.value,s=a.curr(),u=a.all(),l=t.mod;for(n=0,r=l.length;n<r;++n)i=l[n]._index,s[i]!==u&&o.push(i)},remove(t,e,n){let r,i,o,a,s=this._indices,u=this.value,l=u.curr(),c=u.prev(),h=u.all(),d={},f=n.rem,p=e.rem;for(r=0,i=p.length;r<i;++r)o=p[r]._index,d[o]=1,c[o]=a=l[o],l[o]=h,a!==h&&f.push(o);for(o in s)s[o].remove(i,d);return this.reindex(e,i,d),d},reindex(t,e,n){const r=this._indices,i=this.value;t.runAfter(()=>{const t=i.remove(e,n);for(const e in r)r[e].reindex(t)})},update(t,e,n){let r,i,o=this._dims,a=t.query,s=e.stamp,u=o.length,l=0;for(n.filters=0,i=0;i<u;++i)t.modified("query",i)&&(r=i,++l);if(1===l)l=o[r].one,this.incrementOne(o[r],a[r],n.add,n.rem);else for(i=0,l=0;i<u;++i)t.modified("query",i)&&(l|=o[i].one,this.incrementAll(o[i],a[i],s,n.add),n.rem=n.add);return l},incrementAll(t,e,n,r){let i,o,a,s=this.value,u=s.seen(),l=s.curr(),c=s.prev(),h=t.index(),d=t.bisect(t.range),f=t.bisect(e),p=f[0],m=f[1],g=d[0],y=d[1],v=t.one;if(p<g)for(i=p,o=Math.min(g,m);i<o;++i)a=h[i],u[a]!==n&&(c[a]=l[a],u[a]=n,r.push(a)),l[a]^=v;else if(p>g)for(i=g,o=Math.min(p,y);i<o;++i)a=h[i],u[a]!==n&&(c[a]=l[a],u[a]=n,r.push(a)),l[a]^=v;if(m>y)for(i=Math.max(p,y),o=m;i<o;++i)a=h[i],u[a]!==n&&(c[a]=l[a],u[a]=n,r.push(a)),l[a]^=v;else if(m<y)for(i=Math.max(g,m),o=y;i<o;++i)a=h[i],u[a]!==n&&(c[a]=l[a],u[a]=n,r.push(a)),l[a]^=v;t.range=e.slice()},incrementOne(t,e,n,r){let i,o,a,s=this.value.curr(),u=t.index(),l=t.bisect(t.range),c=t.bisect(e),h=c[0],d=c[1],f=l[0],p=l[1],m=t.one;if(h<f)for(i=h,o=Math.min(f,d);i<o;++i)a=u[i],s[a]^=m,n.push(a);else if(h>f)for(i=f,o=Math.min(h,p);i<o;++i)a=u[i],s[a]^=m,r.push(a);if(d>p)for(i=Math.max(h,p),o=d;i<o;++i)a=u[i],s[a]^=m,n.push(a);else if(d<p)for(i=Math.max(f,d),o=p;i<o;++i)a=u[i],s[a]^=m,r.push(a);t.range=e.slice()}}),vO.Definition={type:"ResolveFilter",metadata:{},params:[{name:"ignore",type:"number",required:!0,description:"A bit mask indicating which filters to ignore."},{name:"filter",type:"object",required:!0,description:"Per-tuple filter bitmaps from a CrossFilter transform."}]},Tn(vO,Hs,{transform(t,e){const n=~(t.ignore||0),r=t.filter,i=r.mask;if(0==(i&n))return e.StopPropagation;const o=e.fork(e.ALL),a=r.data(),s=r.curr(),u=r.prev(),l=t=>s[t]&n?null:a[t];return o.filter(o.MOD,l),i&i-1?(o.filter(o.ADD,t=>{const e=s[t]&n;return!e&&e^u[t]&n?a[t]:null}),o.filter(o.REM,t=>{const e=s[t]&n;return!e||e^e^u[t]&n?null:a[t]})):(o.filter(o.ADD,l),o.filter(o.REM,t=>(s[t]&n)===i?a[t]:null)),o.filter(o.SOURCE,t=>l(t._index))}});var bO=n("8WEG"),wO=0;function xO(t){return t&&t.gradient}function _O(t,e,n){let r=t.id,i=t.gradient,o="radial"===i?"p_":"";return r||(r=t.id="gradient_"+wO++,"radial"===i?(t.x1=CO(t.x1,.5),t.y1=CO(t.y1,.5),t.r1=CO(t.r1,0),t.x2=CO(t.x2,.5),t.y2=CO(t.y2,.5),t.r2=CO(t.r2,.5),o="p_"):(t.x1=CO(t.x1,0),t.y1=CO(t.y1,0),t.x2=CO(t.x2,1),t.y2=CO(t.y2,0))),e[r]=t,"url("+(n||"")+"#"+o+r+")"}function CO(t,e){return null!=t?t:e}var kO=function(t,e){var n,r=[];return n={gradient:"linear",x1:t?t[0]:0,y1:t?t[1]:0,x2:e?e[0]:1,y2:e?e[1]:0,stops:r,stop:function(t,e){return r.push({offset:t,color:e}),n}}},SO={basis:{curve:Dc},"basis-closed":{curve:Mc},"basis-open":{curve:Pc},bundle:{curve:zc,tension:"beta",value:.85},cardinal:{curve:Uc,tension:"tension",value:0},"cardinal-open":{curve:Vc,tension:"tension",value:0},"cardinal-closed":{curve:qc,tension:"tension",value:0},"catmull-rom":{curve:ah,tension:"alpha",value:.5},"catmull-rom-closed":{curve:uh,tension:"alpha",value:.5},"catmull-rom-open":{curve:ch,tension:"alpha",value:.5},linear:{curve:dh},"linear-closed":{curve:ph},monotone:{horizontal:Ch,vertical:_h},natural:{curve:Eh},step:{curve:Ah},"step-after":{curve:Th},"step-before":{curve:Nh}};function EO(t,e,n){var r=ue(SO,t)&&SO[t],i=null;return r&&(i=r.curve||r[e||"vertical"],r.tension&&null!=n&&(i=i[r.tension](n))),i}var OO={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7},AO=[/([MLHVCSQTAZmlhvcsqtaz])/g,/###/,/(\d)([-+])/g,/\s|,|###/],NO=function(t){var e,n,r,i,o,a,s,u,l,c,h,d=[];for(u=0,c=(e=t.slice().replace(AO[0],"###$1").split(AO[1]).slice(1)).length;u<c;++u){for(r=(n=e[u]).slice(1).trim().replace(AO[2],"$1###$2").split(AO[3]),i=[a=n.charAt(0)],l=0,h=r.length;l<h;++l)(o=+r[l])===o&&i.push(o);if(s=OO[a.toLowerCase()],i.length-1>s)for(l=1,h=i.length;l<h;l+=s)d.push([a].concat(i.slice(l,l+s)));else d.push(i)}return d};const TO=Math.PI/180,DO=Math.PI/2,RO=2*Math.PI,IO=Math.sqrt(3)/2;var MO={},FO={},PO=[].join;function jO(t){var e=PO.call(t);if(FO[e])return FO[e];var n=t[0],r=t[1],i=t[2],o=t[3],a=t[4],s=t[5],u=t[6],l=t[7],c=l*a,h=-u*s,d=u*a,f=l*s,p=Math.cos(i),m=Math.sin(i),g=Math.cos(o),y=Math.sin(o),v=.5*(o-i),b=Math.sin(.5*v),w=8/3*b*b/Math.sin(v),x=n+p-w*m,_=r+m+w*p,C=n+g,k=r+y,S=C+w*y,E=k-w*g;return FO[e]=[c*x+h*_,d*x+f*_,c*S+h*E,d*S+f*E,c*C+h*k,d*C+f*k]}var zO=["l",0,0,0,0,0,0,0];function LO(t,e,n){var r=zO[0]=t[0];if("a"===r||"A"===r)zO[1]=e*t[1],zO[2]=n*t[2],zO[3]=t[3],zO[4]=t[4],zO[5]=t[5],zO[6]=e*t[6],zO[7]=n*t[7];else if("h"===r||"H"===r)zO[1]=e*t[1];else if("v"===r||"V"===r)zO[1]=n*t[1];else for(var i=1,o=t.length;i<o;++i)zO[i]=(i%2==1?e:n)*t[i];return zO}var BO=function(t,e,n,r,i,o){var a,s,u,l,c,h=null,d=0,f=0,p=0,m=0;null==n&&(n=0),null==r&&(r=0),null==i&&(i=1),null==o&&(o=i),t.beginPath&&t.beginPath();for(var g=0,y=e.length;g<y;++g){switch(a=e[g],1===i&&1===o||(a=LO(a,i,o)),a[0]){case"l":t.lineTo((d+=a[1])+n,(f+=a[2])+r);break;case"L":t.lineTo((d=a[1])+n,(f=a[2])+r);break;case"h":t.lineTo((d+=a[1])+n,f+r);break;case"H":t.lineTo((d=a[1])+n,f+r);break;case"v":t.lineTo(d+n,(f+=a[1])+r);break;case"V":t.lineTo(d+n,(f=a[1])+r);break;case"m":t.moveTo((d+=a[1])+n,(f+=a[2])+r);break;case"M":t.moveTo((d=a[1])+n,(f=a[2])+r);break;case"c":t.bezierCurveTo(d+a[1]+n,f+a[2]+r,(p=d+a[3])+n,(m=f+a[4])+r,(s=d+a[5])+n,(u=f+a[6])+r),d=s,f=u;break;case"C":t.bezierCurveTo(a[1]+n,a[2]+r,(p=a[3])+n,(m=a[4])+r,(d=a[5])+n,(f=a[6])+r);break;case"s":t.bezierCurveTo((p=2*d-p)+n,(m=2*f-m)+r,d+a[1]+n,f+a[2]+r,(s=d+a[3])+n,(u=f+a[4])+r),p=d+a[1],m=f+a[2],d=s,f=u;break;case"S":t.bezierCurveTo((p=2*d-p)+n,(m=2*f-m)+r,a[1]+n,a[2]+r,(s=a[3])+n,(u=a[4])+r),d=s,f=u,p=a[1],m=a[2];break;case"q":t.quadraticCurveTo((p=d+a[1])+n,(m=f+a[2])+r,(s=d+a[3])+n,(u=f+a[4])+r),d=s,f=u;break;case"Q":t.quadraticCurveTo(a[1]+n,a[2]+r,(s=a[3])+n,(u=a[4])+r),d=s,f=u,p=a[1],m=a[2];break;case"t":s=d+a[1],u=f+a[2],null===h[0].match(/[QqTt]/)?(p=d,m=f):"t"===h[0]?(p=2*d-l,m=2*f-c):"q"===h[0]&&(p=2*d-p,m=2*f-m),l=p,c=m,t.quadraticCurveTo(p+n,m+r,s+n,u+r),p=(d=s)+a[1],m=(f=u)+a[2];break;case"T":t.quadraticCurveTo((p=2*d-p)+n,(m=2*f-m)+r,(s=a[1])+n,(u=a[2])+r),d=s,f=u;break;case"a":UO(t,d+n,f+r,[a[1],a[2],a[3],a[4],a[5],a[6]+d+n,a[7]+f+r]),d+=a[6],f+=a[7];break;case"A":UO(t,d+n,f+r,[a[1],a[2],a[3],a[4],a[5],a[6]+n,a[7]+r]),d=a[6],f=a[7];break;case"z":case"Z":t.closePath()}h=a}};function UO(t,e,n,r){for(var i=function(t,e,n,r,i,o,a,s,u){var l=PO.call(arguments);if(MO[l])return MO[l];var c=a*TO,h=Math.sin(c),d=Math.cos(c),f=d*(s-t)*.5+h*(u-e)*.5,p=d*(u-e)*.5-h*(s-t)*.5,m=f*f/((n=Math.abs(n))*n)+p*p/((r=Math.abs(r))*r);m>1&&(n*=m=Math.sqrt(m),r*=m);var g=d/n,y=h/n,v=-h/r,b=d/r,w=g*s+y*u,x=v*s+b*u,_=g*t+y*e,C=v*t+b*e,k=(_-w)*(_-w)+(C-x)*(C-x),S=1/k-.25;S<0&&(S=0);var E=Math.sqrt(S);o==i&&(E=-E);var O=.5*(w+_)-E*(C-x),A=.5*(x+C)+E*(_-w),N=Math.atan2(x-A,w-O),T=Math.atan2(C-A,_-O),D=T-N;D<0&&1===o?D+=RO:D>0&&0===o&&(D-=RO);for(var R=Math.ceil(Math.abs(D/(DO+.001))),I=[],M=0;M<R;++M){var F=N+M*D/R,P=N+(M+1)*D/R;I[M]=[O,A,F,P,n,r,h,d]}return MO[l]=I}(r[5],r[6],r[0],r[1],r[3],r[4],r[2],e,n),o=0;o<i.length;++o){var a=jO(i[o]);t.bezierCurveTo(a[0],a[1],a[2],a[3],a[4],a[5])}}var $O={circle:{draw:function(t,e){var n=Math.sqrt(e)/2;t.moveTo(n,0),t.arc(0,0,n,0,RO)}},cross:{draw:function(t,e){var n=Math.sqrt(e)/2,r=n/2.5;t.moveTo(-n,-r),t.lineTo(-n,r),t.lineTo(-r,r),t.lineTo(-r,n),t.lineTo(r,n),t.lineTo(r,r),t.lineTo(n,r),t.lineTo(n,-r),t.lineTo(r,-r),t.lineTo(r,-n),t.lineTo(-r,-n),t.lineTo(-r,-r),t.closePath()}},diamond:{draw:function(t,e){var n=Math.sqrt(e)/2;t.moveTo(-n,0),t.lineTo(0,-n),t.lineTo(n,0),t.lineTo(0,n),t.closePath()}},square:{draw:function(t,e){var n=Math.sqrt(e),r=-n/2;t.rect(r,r,n,n)}},arrow:{draw:function(t,e){var n=Math.sqrt(e)/2,r=n/7,i=n/2.5,o=n/8;t.moveTo(-r,n),t.lineTo(r,n),t.lineTo(r,-o),t.lineTo(i,-o),t.lineTo(0,-n),t.lineTo(-i,-o),t.lineTo(-r,-o),t.closePath()}},wedge:{draw:function(t,e){var n=Math.sqrt(e)/2,r=IO*n,i=r-.5773502691896257*n,o=n/4;t.moveTo(0,-r-i),t.lineTo(-o,r-i),t.lineTo(o,r-i),t.closePath()}},triangle:{draw:function(t,e){var n=Math.sqrt(e)/2,r=IO*n,i=r-.5773502691896257*n;t.moveTo(0,-r-i),t.lineTo(-n,r-i),t.lineTo(n,r-i),t.closePath()}},"triangle-up":{draw:function(t,e){var n=Math.sqrt(e)/2,r=IO*n;t.moveTo(0,-r),t.lineTo(-n,r),t.lineTo(n,r),t.closePath()}},"triangle-down":{draw:function(t,e){var n=Math.sqrt(e)/2,r=IO*n;t.moveTo(0,r),t.lineTo(-n,-r),t.lineTo(n,-r),t.closePath()}},"triangle-right":{draw:function(t,e){var n=Math.sqrt(e)/2,r=IO*n;t.moveTo(r,0),t.lineTo(-r,-n),t.lineTo(-r,n),t.closePath()}},"triangle-left":{draw:function(t,e){var n=Math.sqrt(e)/2,r=IO*n;t.moveTo(-r,0),t.lineTo(r,-n),t.lineTo(r,n),t.closePath()}},stroke:{draw:function(t,e){var n=Math.sqrt(e)/2;t.moveTo(-n,0),t.lineTo(n,0)}}};function VO(t){return ue($O,t)?$O[t]:function(t){if(!ue(WO,t)){var e=NO(t);WO[t]={draw:function(t,n){BO(t,e,0,0,Math.sqrt(n)/2)}}}return WO[t]}(t)}var WO={};function qO(t){return t.x}function HO(t){return t.y}function GO(t){return t.width}function XO(t){return t.height}function KO(t){return"function"==typeof t?t:()=>+t}function YO(t,e,n){return Math.max(e,Math.min(t,n))}var ZO=function(){var t=qO,e=HO,n=GO,r=XO,i=KO(0),o=i,a=i,s=i,u=null;function l(l,c,h){var d,f=null!=c?c:+t.call(this,l),p=null!=h?h:+e.call(this,l),m=+n.call(this,l),g=+r.call(this,l),y=Math.min(m,g)/2,v=YO(+i.call(this,l),0,y),b=YO(+o.call(this,l),0,y),w=YO(+a.call(this,l),0,y),x=YO(+s.call(this,l),0,y);if(u||(u=d=nd()),v<=0&&b<=0&&w<=0&&x<=0)u.rect(f,p,m,g);else{var _=f+m,C=p+g;u.moveTo(f+v,p),u.lineTo(_-b,p),u.bezierCurveTo(_-.448084975506*b,p,_,p+.448084975506*b,_,p+b),u.lineTo(_,C-x),u.bezierCurveTo(_,C-.448084975506*x,_-.448084975506*x,C,_-x,C),u.lineTo(f+w,C),u.bezierCurveTo(f+.448084975506*w,C,f,C-.448084975506*w,f,C-w),u.lineTo(f,p+v),u.bezierCurveTo(f,p+.448084975506*v,f+.448084975506*v,p,f+v,p),u.closePath()}if(d)return u=null,d+""||null}return l.x=function(e){return arguments.length?(t=KO(e),l):t},l.y=function(t){return arguments.length?(e=KO(t),l):e},l.width=function(t){return arguments.length?(n=KO(t),l):n},l.height=function(t){return arguments.length?(r=KO(t),l):r},l.cornerRadius=function(t,e,n,r){return arguments.length?(i=KO(t),o=null!=e?KO(e):i,s=null!=n?KO(n):i,a=null!=r?KO(r):o,l):i},l.context=function(t){return arguments.length?(u=null==t?null:t,l):u},l},QO=function(){var t,e,n,r,i,o,a,s,u=null;function l(t,e,n){var r=n/2;if(i){var l=a-e,c=t-o;if(l||c){var h=Math.sqrt(l*l+c*c),d=(l/=h)*s,f=(c/=h)*s,p=Math.atan2(c,l);u.moveTo(o-d,a-f),u.lineTo(t-l*r,e-c*r),u.arc(t,e,r,p-Math.PI,p),u.lineTo(o+d,a+f),u.arc(o,a,s,p,p+Math.PI)}else u.arc(t,e,r,0,RO);u.closePath()}else i=1;o=t,a=e,s=r}function c(o){var a,s,c,h=o.length,d=!1;for(null==u&&(u=c=nd()),a=0;a<=h;++a)!(a<h&&r(s=o[a],a,o))===d&&(d=!d)&&(i=0),d&&l(+t(s,a,o),+e(s,a,o),+n(s,a,o));if(c)return u=null,c+""||null}return c.x=function(e){return arguments.length?(t=e,c):t},c.y=function(t){return arguments.length?(e=t,c):e},c.size=function(t){return arguments.length?(n=t,c):n},c.defined=function(t){return arguments.length?(r=t,c):r},c.context=function(t){return arguments.length?(u=null==t?null:t,c):u},c};function JO(t,e){return null!=t?t:e}const tA=t=>t.x||0,eA=t=>t.y||0,nA=t=>!(!1===t.defined),rA=vd().startAngle(t=>t.startAngle||0).endAngle(t=>t.endAngle||0).padAngle(t=>t.padAngle||0).innerRadius(t=>t.innerRadius||0).outerRadius(t=>t.outerRadius||0).cornerRadius(t=>t.cornerRadius||0),iA=_d().x(tA).y1(eA).y0(t=>(t.y||0)+(t.height||0)).defined(nA),oA=_d().y(eA).x1(tA).x0(t=>(t.x||0)+(t.width||0)).defined(nA),aA=xd().x(tA).y(eA).defined(nA),sA=ZO().x(tA).y(eA).width(t=>t.width||0).height(t=>t.height||0).cornerRadius(t=>JO(t.cornerRadiusTopLeft,t.cornerRadius)||0,t=>JO(t.cornerRadiusTopRight,t.cornerRadius)||0,t=>JO(t.cornerRadiusBottomRight,t.cornerRadius)||0,t=>JO(t.cornerRadiusBottomLeft,t.cornerRadius)||0),uA=kd().type(t=>VO(t.shape||"circle")).size(t=>JO(t.size,64)),lA=QO().x(tA).y(eA).defined(nA).size(t=>t.size||1);function cA(t){return t.cornerRadius||t.cornerRadiusTopLeft||t.cornerRadiusTopRight||t.cornerRadiusBottomRight||t.cornerRadiusBottomLeft}function hA(t,e,n,r){return sA.context(t)(e,n,r)}var dA=1;function fA(){dA=1}var pA=function(t,e,n){var r=e.clip,i=t._defs,o=e.clip_id||(e.clip_id="clip"+dA++),a=i.clipping[o]||(i.clipping[o]={id:o});return Yt(r)?a.path=r(null):cA(n)?a.path=hA(null,n,0,0):(a.width=n.width||0,a.height=n.height||0),"url(#"+o+")"};function mA(t){this.clear(),t&&this.union(t)}var gA=mA.prototype;function yA(t){this.mark=t,this.bounds=this.bounds||new mA}function vA(t){yA.call(this,t),this.items=this.items||[]}function bA(t){this._pending=0,this._loader=t||Ds()}gA.clone=function(){return new mA(this)},gA.clear=function(){return this.x1=+Number.MAX_VALUE,this.y1=+Number.MAX_VALUE,this.x2=-Number.MAX_VALUE,this.y2=-Number.MAX_VALUE,this},gA.empty=function(){return this.x1===+Number.MAX_VALUE&&this.y1===+Number.MAX_VALUE&&this.x2===-Number.MAX_VALUE&&this.y2===-Number.MAX_VALUE},gA.equals=function(t){return this.x1===t.x1&&this.y1===t.y1&&this.x2===t.x2&&this.y2===t.y2},gA.set=function(t,e,n,r){return n<t?(this.x2=t,this.x1=n):(this.x1=t,this.x2=n),r<e?(this.y2=e,this.y1=r):(this.y1=e,this.y2=r),this},gA.add=function(t,e){return t<this.x1&&(this.x1=t),e<this.y1&&(this.y1=e),t>this.x2&&(this.x2=t),e>this.y2&&(this.y2=e),this},gA.expand=function(t){return this.x1-=t,this.y1-=t,this.x2+=t,this.y2+=t,this},gA.round=function(){return this.x1=Math.floor(this.x1),this.y1=Math.floor(this.y1),this.x2=Math.ceil(this.x2),this.y2=Math.ceil(this.y2),this},gA.scale=function(t){return this.x1*=t,this.y1*=t,this.x2*=t,this.y2*=t,this},gA.translate=function(t,e){return this.x1+=t,this.x2+=t,this.y1+=e,this.y2+=e,this},gA.rotate=function(t,e,n){const r=this.rotatedPoints(t,e,n);return this.clear().add(r[0],r[1]).add(r[2],r[3]).add(r[4],r[5]).add(r[6],r[7])},gA.rotatedPoints=function(t,e,n){var{x1:r,y1:i,x2:o,y2:a}=this,s=Math.cos(t),u=Math.sin(t),l=e-e*s+n*u,c=n-e*u-n*s;return[s*r-u*i+l,u*r+s*i+c,s*r-u*a+l,u*r+s*a+c,s*o-u*i+l,u*o+s*i+c,s*o-u*a+l,u*o+s*a+c]},gA.union=function(t){return t.x1<this.x1&&(this.x1=t.x1),t.y1<this.y1&&(this.y1=t.y1),t.x2>this.x2&&(this.x2=t.x2),t.y2>this.y2&&(this.y2=t.y2),this},gA.intersect=function(t){return t.x1>this.x1&&(this.x1=t.x1),t.y1>this.y1&&(this.y1=t.y1),t.x2<this.x2&&(this.x2=t.x2),t.y2<this.y2&&(this.y2=t.y2),this},gA.encloses=function(t){return t&&this.x1<=t.x1&&this.x2>=t.x2&&this.y1<=t.y1&&this.y2>=t.y2},gA.alignsWith=function(t){return t&&(this.x1==t.x1||this.x2==t.x2||this.y1==t.y1||this.y2==t.y2)},gA.intersects=function(t){return t&&!(this.x2<t.x1||this.x1>t.x2||this.y2<t.y1||this.y1>t.y2)},gA.contains=function(t,e){return!(t<this.x1||t>this.x2||e<this.y1||e>this.y2)},gA.width=function(){return this.x2-this.x1},gA.height=function(){return this.y2-this.y1},de(vA,yA);var wA=bA.prototype;function xA(t){t._pending+=1}function _A(t){t._pending-=1}wA.pending=function(){return this._pending},wA.sanitizeURL=function(t){var e=this;return xA(e),e._loader.sanitize(t,{context:"href"}).then((function(t){return _A(e),t})).catch((function(){return _A(e),null}))},wA.loadImage=function(t){const e=this,n=Wd();return xA(e),e._loader.sanitize(t,{context:"image"}).then((function(t){const r=t.href;if(!r||!n)throw{url:r};const i=new n,o=ue(t,"crossOrigin")?t.crossOrigin:"anonymous";return null!=o&&(i.crossOrigin=o),i.onload=()=>_A(e),i.onerror=()=>_A(e),i.src=r,i})).catch((function(t){return _A(e),{complete:!1,width:0,height:0,src:t&&t.url||""}}))},wA.ready=function(){var t=this;return new Promise((function(e){!function n(r){t.pending()?setTimeout((function(){n(!0)}),10):e(r)}(!1)}))};var CA,kA,SA,EA=function(t,e,n){if(e.stroke&&0!==e.opacity&&0!==e.strokeOpacity){const r=null!=e.strokeWidth?+e.strokeWidth:1;t.expand(r+(n?function(t,e){return t.strokeJoin&&"miter"!==t.strokeJoin?0:e}(e,r):0))}return t},OA=RO-1e-8;function AA(t){return CA=t,AA}function NA(){}function TA(t,e){CA.add(t,e)}function DA(t,e){TA(kA=t,SA=e)}function RA(t){TA(t,CA.y1)}function IA(t){TA(CA.x1,t)}function MA(t,e,n,r){const i=(t-e)/(t+n-2*e);0<i&&i<1&&r(t+(e-t)*i)}function FA(t,e,n,r,i){const o=r-t+3*e-3*n,a=t+n-2*e,s=t-e;let u,l=0,c=0;Math.abs(o)>1e-14?(u=a*a+s*o,u>=0&&(u=Math.sqrt(u),l=(-a+u)/o,c=(-a-u)/o)):l=.5*s/a,0<l&&l<1&&i(PA(l,t,e,n,r)),0<c&&c<1&&i(PA(c,t,e,n,r))}function PA(t,e,n,r,i){const o=1-t,a=o*o,s=t*t;return a*o*e+3*a*t*n+3*o*s*r+s*t*i}AA.beginPath=NA,AA.closePath=NA,AA.moveTo=DA,AA.lineTo=DA,AA.rect=function(t,e,n,r){TA(t+n,e+r),DA(t,e)},AA.quadraticCurveTo=function(t,e,n,r){MA(kA,t,n,RA),MA(SA,e,r,IA),DA(n,r)},AA.bezierCurveTo=function(t,e,n,r,i,o){FA(kA,t,n,i,RA),FA(SA,e,r,o,IA),DA(i,o)},AA.arc=function(t,e,n,r,i,o){if(kA=n*Math.cos(i)+t,SA=n*Math.sin(i)+e,Math.abs(i-r)>OA)TA(t-n,e-n),TA(t+n,e+n);else{const a=r=>TA(n*Math.cos(r)+t,n*Math.sin(r)+e);let s,u;if(a(r),a(i),i!==r)if((r%=RO)<0&&(r+=RO),(i%=RO)<0&&(i+=RO),i<r&&(o=!o,s=r,r=i,i=s),o)for(i-=RO,s=r-r%DO,u=0;u<4&&s>i;++u,s-=DO)a(s);else for(s=r-r%DO+DO,u=0;u<4&&s<i;++u,s+=DO)a(s)}};var jA=(jA=Vd(1,1))?jA.getContext("2d"):null;const zA=new mA;function LA(t){return function(e,n){if(!jA)return!0;t(jA,e),zA.clear().union(e.bounds).intersect(n).round();const{x1:r,y1:i,x2:o,y2:a}=zA;for(let t=i;t<=a;++t)for(let e=r;e<=o;++e)if(jA.isPointInPath(e,t))return!0;return!1}}function BA(t,e){return e.contains(t.x||0,t.y||0)}function UA(t,e){const n=t.x||0,r=t.y||0;return e.intersects(zA.set(n,r,n+(t.width||0),r+(t.height||0)))}function $A(t,e){const n=t.x||0,r=t.y||0;return VA(e,n,r,null!=t.x2?t.x2:n,null!=t.y2?t.y2:r)}function VA(t,e,n,r,i){const{x1:o,y1:a,x2:s,y2:u}=t,l=r-e,c=i-n;let h,d,f,p,m=0,g=1;for(p=0;p<4;++p){if(0===p&&(h=-l,d=-(o-e)),1===p&&(h=l,d=s-e),2===p&&(h=-c,d=-(a-n)),3===p&&(h=c,d=u-n),Math.abs(h)<1e-10&&d<0)return!1;if(f=d/h,h<0){if(f>g)return!1;f>m&&(m=f)}else if(h>0){if(f<m)return!1;f<g&&(g=f)}}return!0}var WA=function(t,e){t.globalCompositeOperation=e.blend||"source-over"},qA=function(t,e){return null==t?e:t};function HA(t,e){const n=e.length;for(let r=0;r<n;++r)t.addColorStop(e[r].offset,e[r].color);return t}var GA=function(t,e,n){return xO(n)?function(t,e,n){const r=n.width(),i=n.height();let o;if("radial"===e.gradient)o=t.createRadialGradient(n.x1+qA(e.x1,.5)*r,n.y1+qA(e.y1,.5)*i,Math.max(r,i)*qA(e.r1,0),n.x1+qA(e.x2,.5)*r,n.y1+qA(e.y2,.5)*i,Math.max(r,i)*qA(e.r2,.5));else{const a=qA(e.x1,0),s=qA(e.y1,0),u=qA(e.x2,1),l=qA(e.y2,0);if(a!==u&&s!==l&&r!==i){const n=Vd(Math.ceil(r),Math.ceil(i)),o=n.getContext("2d");return o.scale(r,i),o.fillStyle=HA(o.createLinearGradient(a,s,u,l),e.stops),o.fillRect(0,0,r,i),t.createPattern(n,"no-repeat")}o=t.createLinearGradient(n.x1+a*r,n.y1+s*i,n.x1+u*r,n.y1+l*i)}return HA(o,e.stops)}(t,n,e.bounds):n},XA=function(t,e,n){return(n*=null==e.fillOpacity?1:e.fillOpacity)>0&&(t.globalAlpha=n,t.fillStyle=GA(t,e,e.fill),!0)},KA=[],YA=function(t,e,n){var r=null!=(r=e.strokeWidth)?r:1;return!(r<=0)&&(n*=null==e.strokeOpacity?1:e.strokeOpacity)>0&&(t.globalAlpha=n,t.strokeStyle=GA(t,e,e.stroke),t.lineWidth=r,t.lineCap=e.strokeCap||"butt",t.lineJoin=e.strokeJoin||"miter",t.miterLimit=e.strokeMiterLimit||10,t.setLineDash&&(t.setLineDash(e.strokeDash||KA),t.lineDashOffset=e.strokeDashOffset||0),!0)};function ZA(t,e){return t.zindex-e.zindex||t.index-e.index}function QA(t){if(!t.zdirty)return t.zitems;var e,n,r,i=t.items,o=[];for(n=0,r=i.length;n<r;++n)(e=i[n]).index=n,e.zindex&&o.push(e);return t.zdirty=!1,t.zitems=o.sort(ZA)}function JA(t,e){var n,r,i=t.items;if(i&&i.length){var o=QA(t);if(o&&o.length){for(n=0,r=i.length;n<r;++n)i[n].zindex||e(i[n]);i=o}for(n=0,r=i.length;n<r;++n)e(i[n])}}function tN(t,e){var n,r,i=t.items;if(!i||!i.length)return null;var o=QA(t);for(o&&o.length&&(i=o),r=i.length;--r>=0;)if(n=e(i[r]))return n;if(i===o)for(r=(i=t.items).length;--r>=0;)if(!i[r].zindex&&(n=e(i[r])))return n;return null}function eN(t){return function(e,n,r){JA(n,(function(n){r&&!r.intersects(n.bounds)||nN(t,e,n,n)}))}}function nN(t,e,n,r){var i=null==n.opacity?1:n.opacity;0!==i&&(t(e,r)||(WA(e,n),n.fill&&XA(e,n,i)&&e.fill(),n.stroke&&YA(e,n,i)&&e.stroke()))}function rN(t){return t=t||pt,function(e,n,r,i,o,a){return r*=e.pixelRatio,i*=e.pixelRatio,tN(n,(function(n){var s=n.bounds;if((!s||s.contains(o,a))&&s)return t(e,n,r,i,o,a)?n:void 0}))}}function iN(t,e){return function(n,r,i,o){var a,s,u=Array.isArray(r)?r[0]:r,l=null==e?u.fill:e,c=u.stroke&&n.isPointInStroke;return c&&(s=u.strokeCap,n.lineWidth=null!=(a=u.strokeWidth)?a:1,n.lineCap=null!=s?s:"butt"),!t(n,r)&&(l&&n.isPointInPath(i,o)||c&&n.isPointInStroke(i,o))}}function oN(t){return rN(iN(t))}function aN(t,e){return"translate("+t+","+e+")"}function sN(t){return"rotate("+t+")"}function uN(t){return aN(t.x||0,t.y||0)}function lN(t){return aN(t.x||0,t.y||0)+(t.angle?" "+sN(t.angle):"")+(t.scaleX||t.scaleY?" scale("+(t.scaleX||1)+","+(t.scaleY||1)+")":"")}var cN=function(t,e,n){function r(t,n){var r=n.x||0,i=n.y||0,o=n.angle||0;t.translate(r,i),o&&t.rotate(o*=TO),t.beginPath(),e(t,n),o&&t.rotate(-o),t.translate(-r,-i)}return{type:t,tag:"path",nested:!1,attr:function(t,n){t("transform",lN(n)),t("d",e(null,n))},bound:function(t,n){var r=n.x||0,i=n.y||0;return e(AA(t),n),EA(t,n).translate(r,i),n.angle&&t.rotate(n.angle*TO,r,i),t},draw:eN(r),pick:oN(r),isect:n||LA(r)}},hN=cN("arc",(function(t,e){return rA.context(t)(e)})),dN=function(t,e,n){function r(t,n){t.beginPath(),e(t,n)}var i,o=iN(r);return{type:t,tag:"path",nested:!0,attr:function(t,n){var r=n.mark.items;r.length&&t("d",e(null,r))},bound:function(t,n){var r=n.items;return 0===r.length?t:(e(AA(t),r),EA(t,r[0]))},draw:(i=r,function(t,e,n){!e.items.length||n&&!n.intersects(e.bounds)||nN(i,t,e.items[0],e.items)}),pick:function(t,e,n,r,i,a){var s=e.items,u=e.bounds;return!s||!s.length||u&&!u.contains(i,a)?null:o(t,s,n*=t.pixelRatio,r*=t.pixelRatio)?s[0]:null},isect:BA,tip:n}},fN=dN("area",(function(t,e){var n=e[0];return("horizontal"===n.orient?oA:iA).curve(EO(n.interpolate||"linear",n.orient,n.tension)).context(t)(e)}),(function(t,e){for(var n,r,i="horizontal"===t[0].orient?e[1]:e[0],o="horizontal"===t[0].orient?"y":"x",a=t.length,s=1/0;--a>=0;)!1!==t[a].defined&&(r=Math.abs(t[a][o]-i))<s&&(s=r,n=t[a]);return n}));function pN(t,e){t.beginPath(),cA(e)?hA(t,e,0,0):t.rect(0,0,e.width||0,e.height||0),t.clip()}function mN(t){const e=qA(t.strokeWidth,1);return null!=t.strokeOffset?t.strokeOffset:t.stroke&&e>.5&&e<1.5?.5-Math.abs(e-1):0}function gN(t,e){const n=mN(e);t("d",hA(null,e,n,n))}function yN(t,e,n,r){const i=mN(e);t.beginPath(),hA(t,e,(n||0)+i,(r||0)+i)}const vN=iN(yN),bN=iN(yN,!1);var wN={type:"group",tag:"g",nested:!1,attr:function(t,e){t("transform",uN(e))},bound:function(t,e){if(!e.clip&&e.items){const n=e.items,r=n.length;for(let e=0;e<r;++e)t.union(n[e].bounds)}return(e.clip||e.width||e.height)&&!e.noBound&&t.add(0,0).add(e.width||0,e.height||0),EA(t,e),t.translate(e.x||0,e.y||0)},draw:function(t,e,n){JA(e,e=>{const r=e.x||0,i=e.y||0,o=e.strokeForeground,a=null==e.opacity?1:e.opacity;(e.stroke||e.fill)&&a&&(yN(t,e,r,i),WA(t,e),e.fill&&XA(t,e,a)&&t.fill(),e.stroke&&!o&&YA(t,e,a)&&t.stroke()),t.save(),t.translate(r,i),e.clip&&pN(t,e),n&&n.translate(-r,-i),JA(e,e=>{this.draw(t,e,n)}),n&&n.translate(r,i),t.restore(),o&&e.stroke&&a&&(yN(t,e,r,i),WA(t,e),YA(t,e,a)&&t.stroke())})},pick:function(t,e,n,r,i,o){if(e.bounds&&!e.bounds.contains(i,o)||!e.items)return null;const a=n*t.pixelRatio,s=r*t.pixelRatio;return tN(e,u=>{let l,c,h,d,f,p,m,g,y;if(g=u.bounds,(!g||g.contains(i,o))&&(d=u.x||0,f=u.y||0,p=d+(u.width||0),m=f+(u.height||0),y=u.clip,!y||!(i<d||i>p||o<f||o>m)))return t.save(),t.translate(d,f),d=i-d,f=o-f,y&&cA(u)&&!vN(t,u,a,s)?(t.restore(),null):(c=u.strokeForeground,h=!1!==e.interactive,h&&c&&u.stroke&&bN(t,u,a,s)?(t.restore(),u):(l=tN(u,t=>function(t,e,n){return(!1!==t.interactive||"group"===t.marktype)&&t.bounds&&t.bounds.contains(e,n)}(t,d,f)?this.pick(t,n,r,d,f):null),!l&&h&&(u.fill||!c&&u.stroke)&&vN(t,u,a,s)&&(l=u),t.restore(),l||null))})},isect:UA,content:function(t,e,n){t("clip-path",e.clip?pA(n,e,e):null)},background:function(t,e){t("class","background"),t("aria-hidden",!0),gN(t,e)},foreground:function(t,e){t("class","foreground"),t("aria-hidden",!0),e.strokeForeground?gN(t,e):t("d","")}},xN={version:"1.1",xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink"};function _N(t,e){var n=t.image;return(!n||t.url&&t.url!==n.url)&&(n={complete:!1,width:0,height:0},e.loadImage(t.url).then(e=>{t.image=e,t.image.url=t.url})),n}function CN(t,e){return null!=t.width?t.width:e&&e.width?!1!==t.aspect&&t.height?t.height*e.width/e.height:e.width:0}function kN(t,e){return null!=t.height?t.height:e&&e.height?!1!==t.aspect&&t.width?t.width*e.height/e.width:e.height:0}function SN(t,e){return"center"===t?e/2:"right"===t?e:0}function EN(t,e){return"middle"===t?e/2:"bottom"===t?e:0}var ON={type:"image",tag:"image",nested:!1,attr:function(t,e,n){const r=_N(e,n),i=CN(e,r),o=kN(e,r),a=(e.x||0)-SN(e.align,i),s=(e.y||0)-EN(e.baseline,o);t("href",!r.src&&r.toDataURL?r.toDataURL():r.src||"",xN["xmlns:xlink"],"xlink:href"),t("transform",aN(a,s)),t("width",i),t("height",o),t("preserveAspectRatio",!1===e.aspect?"none":"xMidYMid")},bound:function(t,e){const n=e.image,r=CN(e,n),i=kN(e,n),o=(e.x||0)-SN(e.align,r),a=(e.y||0)-EN(e.baseline,i);return t.set(o,a,o+r,a+i)},draw:function(t,e,n){JA(e,e=>{if(n&&!n.intersects(e.bounds))return;let r,i,o,a,s=_N(e,this),u=CN(e,s),l=kN(e,s),c=(e.x||0)-SN(e.align,u),h=(e.y||0)-EN(e.baseline,l);!1!==e.aspect&&(i=s.width/s.height,o=e.width/e.height,i==i&&o==o&&i!==o&&(o<i?(a=u/i,h+=(l-a)/2,l=a):(a=l*i,c+=(u-a)/2,u=a))),(s.complete||s.toDataURL)&&(WA(t,e),t.globalAlpha=null!=(r=e.opacity)?r:1,t.imageSmoothingEnabled=!1!==e.smooth,t.drawImage(s,c,h,u,l))})},pick:rN(),isect:pt,get:_N,xOffset:SN,yOffset:EN},AN=dN("line",(function(t,e){var n=e[0];return aA.curve(EO(n.interpolate||"linear",n.orient,n.tension)).context(t)(e)}),(function(t,e){for(var n,r,i=Math.pow(t[0].strokeWidth||1,2),o=t.length;--o>=0;)if(!1!==t[o].defined&&(n=t[o].x-e[0])*n+(r=t[o].y-e[1])*r<i)return t[o];return null}));function NN(t,e){var n=e.path;if(null==n)return!0;var r=e.x||0,i=e.y||0,o=e.scaleX||1,a=e.scaleY||1,s=(e.angle||0)*TO,u=e.pathCache;u&&u.path===n||((e.pathCache=u=NO(n)).path=n),s&&t.rotate&&t.translate?(t.translate(r,i),t.rotate(s),BO(t,u,0,0,o,a),t.rotate(-s),t.translate(-r,-i)):BO(t,u,r,i,o,a)}var TN={type:"path",tag:"path",nested:!1,attr:function(t,e){1===(e.scaleX||1)&&1===(e.scaleY||1)||t("vector-effect","non-scaling-stroke"),t("transform",lN(e)),t("d",e.path)},bound:function(t,e){return NN(AA(t),e)?t.set(0,0,0,0):EA(t,e,!0),e.angle&&t.rotate(e.angle*TO,e.x||0,e.y||0),t},draw:eN(NN),pick:oN(NN),isect:LA(NN)};function DN(t,e){t.beginPath(),hA(t,e)}var RN={type:"rect",tag:"path",nested:!1,attr:function(t,e){t("d",hA(null,e))},bound:function(t,e){var n,r;return EA(t.set(n=e.x||0,r=e.y||0,n+e.width||0,r+e.height||0),e)},draw:eN(DN),pick:oN(DN),isect:UA};function IN(t,e,n){var r,i,o,a;return!(!e.stroke||!YA(t,e,n)||(r=e.x||0,i=e.y||0,o=null!=e.x2?e.x2:r,a=null!=e.y2?e.y2:i,t.beginPath(),t.moveTo(r,i),t.lineTo(o,a),0))}var MN={type:"rule",tag:"line",nested:!1,attr:function(t,e){t("transform",uN(e)),t("x2",null!=e.x2?e.x2-(e.x||0):0),t("y2",null!=e.y2?e.y2-(e.y||0):0)},bound:function(t,e){var n,r;return EA(t.set(n=e.x||0,r=e.y||0,null!=e.x2?e.x2:n,null!=e.y2?e.y2:r),e)},draw:function(t,e,n){JA(e,(function(e){if(!n||n.intersects(e.bounds)){var r=null==e.opacity?1:e.opacity;r&&IN(t,e,r)&&(WA(t,e),t.stroke())}}))},pick:rN((function(t,e,n,r){return!!t.isPointInStroke&&IN(t,e,1)&&t.isPointInStroke(n,r)})),isect:$A},FN=cN("shape",(function(t,e){return(e.mark.shape||e.shape).context(t)(e)})),PN=cN("symbol",(function(t,e){return uA.context(t)(e)}),BA);const jN=xe();var zN={height:WN,measureWidth:$N,estimateWidth:BN,width:BN,canvas:LN};function LN(t){zN.width=t&&jA?$N:BN}function BN(t,e){return UN(XN(t,e),WN(t))}function UN(t,e){return~~(.8*t.length*e)}function $N(t,e){return WN(t)<=0||!(e=XN(t,e))?0:VN(e,YN(t))}function VN(t,e){const n=`(${e}) ${t}`;let r=jN.get(n);return void 0===r&&(jA.font=e,r=jA.measureText(t).width,jN.set(n,r)),r}function WN(t){return null!=t.fontSize?+t.fontSize||0:11}function qN(t){return null!=t.lineHeight?t.lineHeight:WN(t)+2}function HN(t){return e=t.lineBreak&&t.text&&!Ct(t.text)?t.text.split(t.lineBreak):t.text,Ct(e)?e.length>1?e:e[0]:e;var e}function GN(t){const e=HN(t);return(Ct(e)?e.length-1:0)*qN(t)}function XN(t,e){const n=null==e?"":(e+"").trim();return t.limit>0&&n.length?function(t,e){var n=+t.limit,r=function(t){if(zN.width===$N){const e=YN(t);return t=>VN(t,e)}{const e=WN(t);return t=>UN(t,e)}}(t);if(r(e)<n)return e;var i,o=t.ellipsis||"\u2026",a="rtl"===t.dir,s=0,u=e.length;if(n-=r(o),a){for(;s<u;)r(e.slice(i=s+u>>>1))>n?s=i+1:u=i;return o+e.slice(s)}for(;s<u;)r(e.slice(0,i=1+(s+u>>>1)))<n?s=i:u=i-1;return e.slice(0,s)+o}(t,n):n}function KN(t,e){var n=t.font;return(e&&n?String(n).replace(/"/g,"'"):n)||"sans-serif"}function YN(t,e){return(t.fontStyle?t.fontStyle+" ":"")+(t.fontVariant?t.fontVariant+" ":"")+(t.fontWeight?t.fontWeight+" ":"")+WN(t)+"px "+KN(t,e)}function ZN(t){var e=t.baseline,n=WN(t);return Math.round("top"===e?.79*n:"middle"===e?.3*n:"bottom"===e?-.21*n:"line-top"===e?.29*n+.5*qN(t):"line-bottom"===e?.29*n-.5*qN(t):0)}LN(!0);var QN={left:"start",center:"middle",right:"end"},JN=new mA;function tT(t){var e,n=t.x||0,r=t.y||0,i=t.radius||0;return i&&(e=(t.theta||0)-DO,n+=i*Math.cos(e),r+=i*Math.sin(e)),JN.x1=n,JN.y1=r,JN}function eT(t,e,n){var r,i=zN.height(e),o=e.align,a=tT(e),s=a.x1,u=a.y1,l=e.dx||0,c=(e.dy||0)+ZN(e)-Math.round(.8*i),h=HN(e);if(Ct(h)?(i+=qN(e)*(h.length-1),r=h.reduce((t,n)=>Math.max(t,zN.width(e,n)),0)):r=zN.width(e,h),"center"===o?l-=r/2:"right"===o&&(l-=r),t.set(l+=s,c+=u,l+r,c+i),e.angle&&!n)t.rotate(e.angle*TO,s,u);else if(2===n)return t.rotatedPoints(e.angle*TO,s,u);return t}var nT={arc:hN,area:fN,group:wN,image:ON,line:AN,path:TN,rect:RN,rule:MN,shape:FN,symbol:PN,text:{type:"text",tag:"text",nested:!1,attr:function(t,e){var n,r=e.dx||0,i=(e.dy||0)+ZN(e),o=tT(e),a=o.x1,s=o.y1,u=e.angle||0;t("text-anchor",QN[e.align]||"start"),u?(n=aN(a,s)+" "+sN(u),(r||i)&&(n+=" "+aN(r,i))):n=aN(a+r,s+i),t("transform",n)},bound:eT,draw:function(t,e,n){JA(e,(function(e){var r,i,o,a,s,u,l,c=null==e.opacity?1:e.opacity;if(!(n&&!n.intersects(e.bounds)||0===c||e.fontSize<=0||null==e.text||0===e.text.length)){if(t.font=YN(e),t.textAlign=e.align||"left",i=(r=tT(e)).x1,o=r.y1,e.angle&&(t.save(),t.translate(i,o),t.rotate(e.angle*TO),i=o=0),i+=e.dx||0,o+=(e.dy||0)+ZN(e),u=HN(e),WA(t,e),Ct(u))for(s=qN(e),a=0;a<u.length;++a)l=XN(e,u[a]),e.fill&&XA(t,e,c)&&t.fillText(l,i,o),e.stroke&&YA(t,e,c)&&t.strokeText(l,i,o),o+=s;else l=XN(e,u),e.fill&&XA(t,e,c)&&t.fillText(l,i,o),e.stroke&&YA(t,e,c)&&t.strokeText(l,i,o);e.angle&&t.restore()}}))},pick:rN((function(t,e,n,r,i,o){if(e.fontSize<=0)return!1;if(!e.angle)return!0;var a=tT(e),s=a.x1,u=a.y1,l=eT(JN,e,1),c=-e.angle*TO,h=Math.cos(c),d=Math.sin(c);return l.contains(h*i-d*o+(s-h*s+d*u),d*i+h*o+(u-d*s-h*u))})),isect:function(t,e){var n=eT(JN,t,2);return VA(e,n[0],n[1],n[2],n[3])||VA(e,n[0],n[1],n[4],n[5])||VA(e,n[4],n[5],n[6],n[7])||VA(e,n[2],n[3],n[6],n[7])}},trail:dN("trail",(function(t,e){return lA.context(t)(e)}),(function(t,e){for(var n,r,i=t.length;--i>=0;)if(!1!==t[i].defined&&(n=t[i].x-e[0])*n+(r=t[i].y-e[1])*r<(n=t[i].size||1)*n)return t[i];return null}))},rT=function(t,e,n){var r=nT[t.mark.marktype];return r.nested&&(t=t.mark),(e||r.bound)(t.bounds||(t.bounds=new mA),t,n)},iT={mark:null},oT=function(t,e,n){var r,i,o,a,s=nT[t.marktype],u=s.bound,l=t.items,c=l&&l.length;if(s.nested)return c?o=l[0]:(iT.mark=t,o=iT),a=rT(o,u,n),e&&e.union(a)||a;if(e=e||t.bounds&&t.bounds.clear()||new mA,c)for(r=0,i=l.length;r<i;++r)e.union(rT(l[r],u,n));return t.bounds=e},aT=["marktype","name","role","interactive","clip","items","zindex","x","y","width","height","align","baseline","fill","fillOpacity","opacity","blend","stroke","strokeOpacity","strokeWidth","strokeCap","strokeDash","strokeDashOffset","strokeForeground","strokeOffset","startAngle","endAngle","innerRadius","outerRadius","cornerRadius","padAngle","cornerRadiusTopLeft","cornerRadiusTopRight","cornerRadiusBottomLeft","cornerRadiusBottomRight","interpolate","tension","orient","defined","url","aspect","smooth","path","scaleX","scaleY","x2","y2","size","shape","text","angle","theta","radius","dir","dx","dy","ellipsis","limit","lineBreak","lineHeight","font","fontSize","fontWeight","fontStyle","fontVariant","description","aria","ariaRole","ariaRoleDescription"];function sT(t,e){return JSON.stringify(t,aT,e)}function uT(t){return function t(e){var n,r,i,o=e.marktype,a=e.items;if(a)for(r=0,i=a.length;r<i;++r)a[r][n=o?"mark":"group"]=e,a[r].zindex&&(a[r][n].zdirty=!0),"group"===(o||n)&&t(a[r]);return o&&oT(e),e}("string"==typeof t?JSON.parse(t):t)}function lT(t){arguments.length?this.root=uT(t):(this.root=hT({marktype:"group",name:"root",role:"frame"}),this.root.items=[new vA(this.root)])}var cT=lT.prototype;function hT(t,e){const n={bounds:new mA,clip:!!t.clip,group:e,interactive:!1!==t.interactive,items:[],marktype:t.marktype,name:t.name||void 0,role:t.role||void 0,zindex:t.zindex||0};return null!=t.aria&&(n.aria=t.aria),t.description&&(n.description=t.description),n}function dT(t,e,n){return!t&&"undefined"!=typeof document&&document.createElement&&(t=document),t?n?t.createElementNS(n,e):t.createElement(e):null}function fT(t,e){e=e.toLowerCase();for(var n=t.childNodes,r=0,i=n.length;r<i;++r)if(n[r].tagName.toLowerCase()===e)return n[r]}function pT(t,e,n,r){var i,o=t.childNodes[e];return o&&o.tagName.toLowerCase()===n.toLowerCase()||(i=o||null,o=dT(t.ownerDocument,n,r),t.insertBefore(o,i)),o}function mT(t,e){for(var n=t.childNodes,r=n.length;r>e;)t.removeChild(n[--r]);return t}function gT(t){return"mark-"+t.marktype+(t.role?" role-"+t.role:"")+(t.name?" "+t.name:"")}cT.toJSON=function(t){return sT(this.root,t||0)},cT.mark=function(t,e,n){var r=hT(t,e=e||this.root.items[0]);return e.items[n]=r,r.zindex&&(r.group.zdirty=!0),r};var yT=function(t,e){var n=e.getBoundingClientRect();return[t.clientX-n.left-(e.clientLeft||0),t.clientY-n.top-(e.clientTop||0)]};function vT(t,e){this._active=null,this._handlers={},this._loader=t||Ds(),this._tooltip=e||bT}function bT(t,e,n,r){t.element().setAttribute("title",r||"")}const wT=vT.prototype;function xT(t){this._el=null,this._bgcolor=null,this._loader=new bA(t)}wT.initialize=function(t,e,n){return this._el=t,this._obj=n||null,this.origin(e)},wT.element=function(){return this._el},wT.canvas=function(){return this._el&&this._el.firstChild},wT.origin=function(t){return arguments.length?(this._origin=t||[0,0],this):this._origin.slice()},wT.scene=function(t){return arguments.length?(this._scene=t,this):this._scene},wT.on=function(){},wT.off=function(){},wT._handlerIndex=function(t,e,n){for(let r=t?t.length:0;--r>=0;)if(t[r].type===e&&(!n||t[r].handler===n))return r;return-1},wT.handlers=function(t){const e=this._handlers,n=[];if(t)n.push.apply(n,e[this.eventName(t)]);else for(const r in e)n.push.apply(n,e[r]);return n},wT.eventName=function(t){const e=t.indexOf(".");return e<0?t:t.slice(0,e)},wT.handleHref=function(t,e,n){this._loader.sanitize(n,{context:"href"}).then(e=>{const n=new MouseEvent(t.type,t),r=dT(null,"a");for(const t in e)r.setAttribute(t,e[t]);r.dispatchEvent(n)}).catch((function(){}))},wT.handleTooltip=function(t,e,n){e&&null!=e.tooltip&&(e=function(t,e,n,r){var i,o,a=t&&t.mark;if(a&&(i=nT[a.marktype]).tip){for((o=yT(e,n))[0]-=r[0],o[1]-=r[1];t=t.mark.group;)o[0]-=t.x||0,o[1]-=t.y||0;t=i.tip(a.items,o)}return t}(e,t,this.canvas(),this._origin),this._tooltip.call(this._obj,this,t,e,n&&e&&e.tooltip||null))},wT.getItemBoundingClientRect=function(t){const e=this.canvas();if(!e)return;const n=e.getBoundingClientRect(),r=this._origin,i=t.bounds,o=i.width(),a=i.height();let s=i.x1+r[0]+n.left,u=i.y1+r[1]+n.top;for(;t.mark&&(t=t.mark.group);)s+=t.x||0,u+=t.y||0;return{x:s,y:u,width:o,height:a,left:s,top:u,right:s+o,bottom:u+a}};var _T=xT.prototype;_T.initialize=function(t,e,n,r,i){return this._el=t,this.resize(e,n,r,i)},_T.element=function(){return this._el},_T.canvas=function(){return this._el&&this._el.firstChild},_T.background=function(t){return 0===arguments.length?this._bgcolor:(this._bgcolor=t,this)},_T.resize=function(t,e,n,r){return this._width=t,this._height=e,this._origin=n||[0,0],this._scale=r||1,this},_T.dirty=function(){},_T.render=function(t){var e=this;return e._call=function(){e._render(t)},e._call(),e._call=null,e},_T._render=function(){},_T.renderAsync=function(t){var e=this.render(t);return this._ready?this._ready.then((function(){return e})):Promise.resolve(e)},_T._load=function(t,e){var n=this,r=n._loader[t](e);if(!n._ready){var i=n._call;n._ready=n._loader.ready().then((function(t){t&&i(),n._ready=null}))}return r},_T.sanitizeURL=function(t){return this._load("sanitizeURL",t)},_T.loadImage=function(t){return this._load("loadImage",t)};const CT="dragleave",kT="mousedown",ST="mousemove",ET="mouseout",OT="click",AT=["keydown","keypress","keyup","dragenter",CT,"dragover",kT,"mouseup",ST,ET,"mouseover",OT,"dblclick","wheel","mousewheel","touchstart","touchmove","touchend"],NT=ST,TT=ET,DT=OT;function RT(t,e){vT.call(this,t,e),this._down=null,this._touch=null,this._first=!0,this._events={}}const IT=de(RT,vT);function MT(t,e){(t=>"touchstart"===t||"touchmove"===t||"touchend"===t?["touchstart","touchmove","touchend"]:[t])(e).forEach(e=>function(t,e){const n=t.canvas();n&&!t._events[e]&&(t._events[e]=1,n.addEventListener(e,t[e]?n=>t[e](n):n=>t.fire(e,n)))}(t,e))}function FT(t,e,n){return function(r){const i=this._active,o=this.pickEvent(r);o===i||(i&&i.exit||this.fire(n,r),this._active=o,this.fire(e,r)),this.fire(t,r)}}function PT(t){return function(e){this.fire(t,e),this._active=null}}IT.initialize=function(t,e,n){return this._canvas=t&&fT(t,"canvas"),[OT,kT,ST,ET,CT].forEach(t=>MT(this,t)),vT.prototype.initialize.call(this,t,e,n)},IT.canvas=function(){return this._canvas},IT.context=function(){return this._canvas.getContext("2d")},IT.events=AT,IT.DOMMouseScroll=function(t){this.fire("mousewheel",t)},IT.mousemove=FT(ST,"mouseover",ET),IT.dragover=FT("dragover","dragenter",CT),IT.mouseout=PT(ET),IT.dragleave=PT(CT),IT.mousedown=function(t){this._down=this._active,this.fire(kT,t)},IT.click=function(t){this._down===this._active&&(this.fire(OT,t),this._down=null)},IT.touchstart=function(t){this._touch=this.pickEvent(t.changedTouches[0]),this._first&&(this._active=this._touch,this._first=!1),this.fire("touchstart",t,!0)},IT.touchmove=function(t){this.fire("touchmove",t,!0)},IT.touchend=function(t){this.fire("touchend",t,!0),this._touch=null},IT.fire=function(t,e,n){const r=n?this._touch:this._active,i=this._handlers[t];if(e.vegaType=t,t===DT&&r&&r.href?this.handleHref(e,r,r.href):t!==NT&&t!==TT||this.handleTooltip(e,r,t!==TT),i)for(let o=0,a=i.length;o<a;++o)i[o].handler.call(this._obj,e,r)},IT.on=function(t,e){const n=this.eventName(t),r=this._handlers;return this._handlerIndex(r[n],t,e)<0&&(MT(this,t),(r[n]||(r[n]=[])).push({type:t,handler:e})),this},IT.off=function(t,e){const n=this.eventName(t),r=this._handlers[n],i=this._handlerIndex(r,t,e);return i>=0&&r.splice(i,1),this},IT.pickEvent=function(t){const e=yT(t,this._canvas),n=this._origin;return this.pick(this._scene,e[0],e[1],e[0]-n[0],e[1]-n[1])},IT.pick=function(t,e,n,r,i){const o=this.context();return nT[t.marktype].pick.call(this,o,t,e,n,r,i)};var jT="undefined"!=typeof window&&window.devicePixelRatio||1;function zT(t){xT.call(this,t),this._options={},this._redraw=!1,this._dirty=new mA,this._tempb=new mA}const LT=de(zT,xT),BT=xT.prototype;function UT(t,e){vT.call(this,t,e);const n=this;n._hrefHandler=VT(n,(t,e)=>{e&&e.href&&n.handleHref(t,e,e.href)}),n._tooltipHandler=VT(n,(t,e)=>{n.handleTooltip(t,e,t.type!==TT)})}LT.initialize=function(t,e,n,r,i,o){return this._options=o||{},this._canvas=this._options.externalContext?null:Vd(1,1),t&&this._canvas&&(mT(t,0).appendChild(this._canvas),this._canvas.setAttribute("class","marks")),BT.initialize.call(this,t,e,n,r,i)},LT.resize=function(t,e,n,r){if(BT.resize.call(this,t,e,n,r),this._canvas)!function(t,e,n,r,i,o){const a="undefined"!=typeof HTMLElement&&t instanceof HTMLElement&&null!=t.parentNode,s=t.getContext("2d"),u=a?jT:i;t.width=e*u,t.height=n*u;for(const l in o)s[l]=o[l];a&&1!==u&&(t.style.width=e+"px",t.style.height=n+"px"),s.pixelRatio=u,s.setTransform(u,0,0,u,u*r[0],u*r[1])}(this._canvas,this._width,this._height,this._origin,this._scale,this._options.context);else{const t=this._options.externalContext;t||at("CanvasRenderer is missing a valid canvas or context"),t.scale(this._scale,this._scale),t.translate(this._origin[0],this._origin[1])}return this._redraw=!0,this},LT.canvas=function(){return this._canvas},LT.context=function(){return this._options.externalContext||(this._canvas?this._canvas.getContext("2d"):null)},LT.dirty=function(t){let e=this._tempb.clear().union(t.bounds),n=t.mark.group;for(;n;)e.translate(n.x||0,n.y||0),n=n.mark.group;this._dirty.union(e)},LT._render=function(t){const e=this.context(),n=this._origin,r=this._width,i=this._height,o=this._dirty,a=(s=n,u=r,l=i,(new mA).set(0,0,u,l).translate(-s[0],-s[1]));var s,u,l;e.save();const c=this._redraw||o.empty()?(this._redraw=!1,a.expand(1)):function(t,e,n){return e.expand(1).round(),t.pixelRatio%1&&e.scale(t.pixelRatio).round().scale(1/t.pixelRatio),e.translate(-n[0]%1,-n[1]%1),t.beginPath(),t.rect(e.x1,e.y1,e.width(),e.height()),t.clip(),e}(e,a.intersect(o),n);return this.clear(-n[0],-n[1],r,i),this.draw(e,t,c),e.restore(),o.clear(),this},LT.draw=function(t,e,n){const r=nT[e.marktype];e.clip&&function(t,e){var n=e.clip;t.save(),Yt(n)?(t.beginPath(),n(t),t.clip()):pN(t,e.group)}(t,e),r.draw.call(this,t,e,n),e.clip&&t.restore()},LT.clear=function(t,e,n,r){const i=this._options,o=this.context();"pdf"===i.type||i.externalContext||o.clearRect(t,e,n,r),null!=this._bgcolor&&(o.fillStyle=this._bgcolor,o.fillRect(t,e,n,r))};const $T=de(UT,vT);$T.initialize=function(t,e,n){let r=this._svg;return r&&(r.removeEventListener(DT,this._hrefHandler),r.removeEventListener(NT,this._tooltipHandler),r.removeEventListener(TT,this._tooltipHandler)),this._svg=r=t&&fT(t,"svg"),r&&(r.addEventListener(DT,this._hrefHandler),r.addEventListener(NT,this._tooltipHandler),r.addEventListener(TT,this._tooltipHandler)),vT.prototype.initialize.call(this,t,e,n)},$T.canvas=function(){return this._svg};const VT=(t,e)=>n=>{let r=n.target.__data__;r=Array.isArray(r)?r[0]:r,n.vegaType=n.type,e.call(t._obj,n,r)};$T.on=function(t,e){const n=this.eventName(t),r=this._handlers;if(this._handlerIndex(r[n],t,e)<0){const i={type:t,handler:e,listener:VT(this,e)};(r[n]||(r[n]=[])).push(i),this._svg&&this._svg.addEventListener(n,i.listener)}return this},$T.off=function(t,e){const n=this.eventName(t),r=this._handlers[n],i=this._handlerIndex(r,t,e);return i>=0&&(this._svg&&this._svg.removeEventListener(n,r[i].listener),r.splice(i,1)),this};const WT=(t,e,n)=>({role:t,"aria-roledescription":e,"aria-label":n||void 0}),qT=De(["axis-domain","axis-grid","axis-label","axis-tick","axis-title","legend-band","legend-entry","legend-gradient","legend-label","legend-title","legend-symbol","title"]),HT={axis:{desc:"axis",caption:function(t){const e=t.datum,n=t.orient,r=e.title?ZT(t):null,i=t.context,o=i.scales[e.scale].value,a=i.dataflow.locale(),s=o.type;return("left"===n||"right"===n?"Y":"X")+"-axis"+(r?` titled '${r}'`:"")+` for a ${xy(s)?"discrete":s} scale with `+qv(a,o,t)}},legend:{desc:"legend",caption:function(t){const e=t.datum,n=e.title?ZT(t):null,r=((e.type||"")+" legend").trim(),i=e.scales,o=Object.keys(i),a=t.context,s=a.scales[i[o[0]]].value,u=a.dataflow.locale();return((l=r).length?l[0].toUpperCase()+l.slice(1):l)+(n?` titled '${n}'`:"")+" for "+function(t){return(t=t.map(t=>t+("fill"===t||"stroke"===t?" color":""))).length<2?t[0]:t.slice(0,-1).join(", ")+" and "+Nt(t)}(o)+" with "+qv(u,s,t);var l}},"title-text":{desc:"title",caption:t=>`Title text '${YT(t)}'`},"title-subtitle":{desc:"subtitle",caption:t=>`Subtitle text '${YT(t)}'`}},GT={ariaRole:"role",ariaRoleDescription:"aria-roledescription",description:"aria-label"};function XT(t,e){const n=!1===e.aria;if(t("aria-hidden",n||void 0),n||null==e.description)for(const r in GT)t(GT[r],void 0);else{const n=e.mark.marktype;t("aria-label",e.description),t("role",e.ariaRole||("group"===n?"graphics-object":"graphics-symbol")),t("aria-roledescription",e.ariaRoleDescription||n+" mark")}}function KT(t){return!1===t.aria?{"aria-hidden":!0}:qT[t.role]?null:HT[t.role]?function(t,e){try{const n=t.items[0],r=e.caption||(()=>"");return WT(e.role||"graphics-symbol",e.desc,n.description||r(n))}catch(n){return null}}(t,HT[t.role]):function(t){const e=t.marktype,n="group"===e||"text"===e||t.items.some(t=>null!=t.description&&!1!==t.aria);return WT(n?"graphics-object":"graphics-symbol",e+" mark container",t.description)}(t)}function YT(t){return Xt(t.text).join(" ")}function ZT(t){try{return Xt(Nt(t.items).items[0].text).join(" ")}catch(e){return null}}const QT=t=>(t+"").replace(/&/g,"&amp;").replace(/"/g,"&quot;");function JT(t,e,n){var r,i,o="<"+t;if(e)for(r in e)null!=(i=e[r])&&(o+=" "+r+'="'+QT(i)+'"');return n&&(o+=" "+n),o+">"}function tD(t){return"</"+t+">"}const eD={fill:"fill",fillOpacity:"fill-opacity",stroke:"stroke",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",strokeCap:"stroke-linecap",strokeJoin:"stroke-linejoin",strokeDash:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",strokeMiterLimit:"stroke-miterlimit",opacity:"opacity",blend:"mix-blend-mode"},nD={fill:"none","stroke-miterlimit":10},rD=xN.xmlns;function iD(t){xT.call(this,t),this._dirtyID=0,this._dirty=[],this._svg=null,this._root=null,this._defs=null}var oD=de(iD,xT),aD=xT.prototype;function sD(t,e,n){var r,i,o;if("radial"===e.gradient){var a=pT(t,n++,"pattern",rD);a.setAttribute("id","p_"+e.id),a.setAttribute("viewBox","0,0,1,1"),a.setAttribute("width","100%"),a.setAttribute("height","100%"),a.setAttribute("preserveAspectRatio","xMidYMid slice"),(a=pT(a,0,"rect",rD)).setAttribute("width","1"),a.setAttribute("height","1"),a.setAttribute("fill","url("+yD()+"#"+e.id+")"),(t=pT(t,n++,"radialGradient",rD)).setAttribute("id",e.id),t.setAttribute("fx",e.x1),t.setAttribute("fy",e.y1),t.setAttribute("fr",e.r1),t.setAttribute("cx",e.x2),t.setAttribute("cy",e.y2),t.setAttribute("r",e.r2)}else(t=pT(t,n++,"linearGradient",rD)).setAttribute("id",e.id),t.setAttribute("x1",e.x1),t.setAttribute("x2",e.x2),t.setAttribute("y1",e.y1),t.setAttribute("y2",e.y2);for(r=0,i=e.stops.length;r<i;++r)(o=pT(t,r,"stop",rD)).setAttribute("offset",e.stops[r].offset),o.setAttribute("stop-color",e.stops[r].color);return mT(t,r),n}function uD(t,e,n){var r;return(t=pT(t,n,"clipPath",rD)).setAttribute("id",e.id),e.path?(r=pT(t,0,"path",rD)).setAttribute("d",e.path):((r=pT(t,0,"rect",rD)).setAttribute("x",0),r.setAttribute("y",0),r.setAttribute("width",e.width),r.setAttribute("height",e.height)),mT(t,1),n+1}function lD(t,e){for(;t&&t.dirty!==e;t=t.mark.group){if(t.dirty=e,!t.mark||t.mark.dirty===e)return;t.mark.dirty=e}}function cD(t,e,n,r,i){let o,a=t._svg;if(!a&&(o=e.ownerDocument,a=dT(o,r,rD),t._svg=a,t.mark&&(a.__data__=t,a.__values__={fill:"default"},"g"===r))){const e=dT(o,"path",rD);a.appendChild(e),e.__data__=t;const n=dT(o,"g",rD);a.appendChild(n),n.__data__=t;const r=dT(o,"path",rD);a.appendChild(r),r.__data__=t,r.__values__={fill:"default"}}return(a.ownerSVGElement!==i||function(t,e){return t.parentNode&&t.parentNode.childNodes.length>1&&t.previousSibling!=e}(a,n))&&e.insertBefore(a,n?n.nextSibling:e.firstChild),a}oD.initialize=function(t,e,n,r){if(this._defs={gradient:{},clipping:{}},t){this._svg=pT(t,0,"svg",rD),this._svg.setAttribute("class","marks"),mT(t,1),this._root=pT(this._svg,0,"g",rD);for(const t in nD)this._root.setAttribute(t,nD[t]);mT(this._svg,1)}return this.background(this._bgcolor),aD.initialize.call(this,t,e,n,r)},oD.background=function(t){return arguments.length&&this._svg&&this._svg.style.setProperty("background-color",t),aD.background.apply(this,arguments)},oD.resize=function(t,e,n,r){return aD.resize.call(this,t,e,n,r),this._svg&&(this._svg.setAttribute("width",this._width*this._scale),this._svg.setAttribute("height",this._height*this._scale),this._svg.setAttribute("viewBox","0 0 "+this._width+" "+this._height),this._root.setAttribute("transform","translate("+this._origin+")")),this._dirty=[],this},oD.canvas=function(){return this._svg},oD.svg=function(){if(!this._svg)return null;var t={class:"marks",width:this._width*this._scale,height:this._height*this._scale,viewBox:"0 0 "+this._width+" "+this._height};for(var e in xN)t[e]=xN[e];var n=this._bgcolor?JT("rect",{width:this._width,height:this._height,fill:this._bgcolor})+tD("rect"):"";return JT("svg",t)+(this._defs.el?this._defs.el.outerHTML:"")+n+this._root.outerHTML+tD("svg")},oD._render=function(t){return this._dirtyCheck()&&(this._dirtyAll&&this._resetDefs(),this.draw(this._root,t),mT(this._root,1)),this.updateDefs(),this._dirty=[],++this._dirtyID,this},oD.updateDefs=function(){const t=this._svg,e=this._defs;let n=e.el,r=0;for(const i in e.gradient)n||(e.el=n=pT(t,0,"defs",rD)),r=sD(n,e.gradient[i],r);for(const i in e.clipping)n||(e.el=n=pT(t,0,"defs",rD)),r=uD(n,e.clipping[i],r);n&&(0===r?(t.removeChild(n),e.el=null):mT(n,r))},oD._resetDefs=function(){var t=this._defs;t.gradient={},t.clipping={}},oD.dirty=function(t){t.dirty!==this._dirtyID&&(t.dirty=this._dirtyID,this._dirty.push(t))},oD.isDirty=function(t){return this._dirtyAll||!t._svg||t.dirty===this._dirtyID},oD._dirtyCheck=function(){this._dirtyAll=!0;var t=this._dirty;if(!t.length||!this._dirtyID)return!0;var e,n,r,i,o,a,s,u=++this._dirtyID;for(o=0,a=t.length;o<a;++o)(n=(e=t[o]).mark).marktype!==r&&(i=nT[r=n.marktype]),n.zdirty&&n.dirty!==u&&(this._dirtyAll=!1,lD(e,u),n.items.forEach((function(t){t.dirty=u}))),n.zdirty||(e.exit?(i.nested&&n.items.length?(s=n.items[0])._svg&&this._update(i,s._svg,s):e._svg&&(s=e._svg.parentNode)&&s.removeChild(e._svg),e._svg=null):(e=i.nested?n.items[0]:e)._update!==u&&(e._svg&&e._svg.ownerSVGElement?this._update(i,e._svg,e):(this._dirtyAll=!1,lD(e,u)),e._update=u));return!this._dirtyAll},oD.draw=function(t,e,n){if(!this.isDirty(e))return e._svg;var r,i=this._svg,o=nT[e.marktype],a=!1===e.interactive?"none":null,s="g"===o.tag,u=null,l=0;(r=cD(e,t,n,"g",i)).setAttribute("class",gT(e));const c=KT(e);for(const d in c)gD(r,d,c[d]);s||gD(r,"pointer-events",a),gD(r,"clip-path",e.clip?pA(this,e,e.group):null);const h=t=>{const e=this.isDirty(t),n=cD(t,r,u,o.tag,i);e&&(this._update(o,n,t),s&&function(t,e,n){e=e.lastChild.previousSibling;let r,i=0;JA(n,n=>{r=t.draw(e,n,r),++i}),mT(e,1+i)}(this,n,t)),u=n,++l};return o.nested?e.items.length&&h(e.items[0]):JA(e,h),mT(r,l),r};var hD=null,dD=null,fD={group:function(t,e,n){const r=hD=e.childNodes[2];dD=r.__values__,t.foreground(mD,n,this),dD=e.__values__,hD=e.childNodes[1],t.content(mD,n,this);const i=hD=e.childNodes[0];t.background(mD,n,this);const o=!1===n.mark.interactive?"none":null;if(o!==dD.events&&(gD(r,"pointer-events",o),gD(i,"pointer-events",o),dD.events=o),n.strokeForeground&&n.stroke){const t=n.fill;gD(r,"display",null),this.style(i,n),gD(i,"stroke",null),t&&(n.fill=null),dD=r.__values__,this.style(r,n),t&&(n.fill=t),hD=null}else gD(r,"display","none")},image:function(t,e,n){!1===n.smooth?(pD(e,"image-rendering","optimizeSpeed"),pD(e,"image-rendering","pixelated")):pD(e,"image-rendering",null)},text:function(t,e,n){let r,i,o,a,s=HN(n);Ct(s)?(i=s.map(t=>XN(n,t)),r=i.join("\n"),r!==dD.text&&(mT(e,0),o=e.ownerDocument,a=qN(n),i.forEach((t,r)=>{const i=dT(o,"tspan",rD);i.__data__=n,i.textContent=t,r&&(i.setAttribute("x",0),i.setAttribute("dy",a)),e.appendChild(i)}),dD.text=r)):(i=XN(n,s),i!==dD.text&&(e.textContent=i,dD.text=i)),gD(e,"font-family",KN(n)),gD(e,"font-size",WN(n)+"px"),gD(e,"font-style",n.fontStyle),gD(e,"font-variant",n.fontVariant),gD(e,"font-weight",n.fontWeight)}};function pD(t,e,n){n!==dD[e]&&(null==n?t.style.removeProperty(e):t.style.setProperty(e,n+""),dD[e]=n)}function mD(t,e,n){e!==dD[t]&&(n?function(t,e,n,r){null!=n?t.setAttributeNS(r,e,n):t.removeAttributeNS(r,e)}(hD,t,e,n):gD(hD,t,e),dD[t]=e)}function gD(t,e,n){null!=n?t.setAttribute(e,n):t.removeAttribute(e)}function yD(){let t;return"undefined"==typeof window?"":(t=window.location).hash?t.href.slice(0,-t.hash.length):t.href}function vD(t){xT.call(this,t),this._text={head:"",bg:"",root:"",foot:"",defs:"",body:""},this._defs={gradient:{},clipping:{}}}oD._update=function(t,e,n){hD=e,dD=e.__values__,XT(mD,n),t.attr(mD,n,this);const r=fD[t.type];r&&r.call(this,t,e,n),hD&&this.style(hD,n)},oD.style=function(t,e){if(null!=e)for(const n in eD){let r="font"===n?KN(e):e[n];if(r===dD[n])continue;const i=eD[n];null==r?t.removeAttribute(i):(xO(r)&&(r=_O(r,this._defs.gradient,yD())),t.setAttribute(i,r+"")),dD[n]=r}};var bD=de(vD,xT),wD=xT.prototype;function xD(t){return t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}bD.resize=function(t,e,n,r){wD.resize.call(this,t,e,n,r);var i=this._origin,o=this._text,a={class:"marks",width:this._width*this._scale,height:this._height*this._scale,viewBox:"0 0 "+this._width+" "+this._height};for(var s in xN)a[s]=xN[s];o.head=JT("svg",a);var u=this._bgcolor;return"transparent"!==u&&"none"!==u||(u=null),o.bg=u?JT("rect",{width:this._width,height:this._height,fill:u})+tD("rect"):"",o.root=JT("g",ie({},nD,{transform:"translate("+i+")"})),o.foot=tD("g")+tD("svg"),this},bD.background=function(){var t=wD.background.apply(this,arguments);return arguments.length&&this._text.head&&this.resize(this._width,this._height,this._origin,this._scale),t},bD.svg=function(){var t=this._text;return t.head+t.defs+t.bg+t.root+t.body+t.foot},bD._render=function(t){return this._text.body=this.mark(t),this._text.defs=this.buildDefs(),this},bD.buildDefs=function(){let t,e="";for(const n in this._defs.gradient){const r=this._defs.gradient[n],i=r.stops;"radial"===r.gradient?(e+=JT(t="pattern",{id:"p_"+n,viewBox:"0,0,1,1",width:"100%",height:"100%",preserveAspectRatio:"xMidYMid slice"}),e+=JT("rect",{width:"1",height:"1",fill:"url(#"+n+")"})+tD("rect"),e+=tD(t),e+=JT(t="radialGradient",{id:n,fx:r.x1,fy:r.y1,fr:r.r1,cx:r.x2,cy:r.y2,r:r.r2})):e+=JT(t="linearGradient",{id:n,x1:r.x1,x2:r.x2,y1:r.y1,y2:r.y2});for(let t=0;t<i.length;++t)e+=JT("stop",{offset:i[t].offset,"stop-color":i[t].color})+tD("stop");e+=tD(t)}for(const n in this._defs.clipping){const t=this._defs.clipping[n];e+=JT("clipPath",{id:n}),e+=t.path?JT("path",{d:t.path})+tD("path"):JT("rect",{x:0,y:0,width:t.width,height:t.height})+tD("rect"),e+=tD("clipPath")}return e?JT("defs")+e+tD("defs"):""},bD.attr=function(t,e,n,r){const i={},o=(t,e,n,r)=>{i[r||t]=e};return Array.isArray(n)?n.forEach(t=>t(o,e,this)):n(o,e,this),r&&function(t,e,n,r,i){if(null==e)return t;if("bgrect"===r&&!1===n.interactive&&(t["pointer-events"]="none"),"bgfore"===r&&(!1===n.interactive&&(t["pointer-events"]="none"),t.display="none",null!==e.fill))return t;"image"===r&&!1===e.smooth&&(t.style="image-rendering: optimizeSpeed; image-rendering: pixelated;"),"text"===r&&(t["font-family"]=KN(e),t["font-size"]=WN(e)+"px",e.fontStyle&&(t["font-style"]=e.fontStyle),e.fontVariant&&(t["font-variant"]=e.fontVariant),e.fontWeight&&(t["font-weight"]=e.fontWeight));for(const o in eD){let n=e[o];const r=eD[o];("transparent"!==n||"fill"!==r&&"stroke"!==r)&&null!=n&&(xO(n)&&(n=_O(n,i.gradient,"")),t[r]=n)}}(i,e,t,r,this._defs),i},bD.href=function(t){var e,n=this,r=t.href;if(r){if(e=n._hrefs&&n._hrefs[r])return e;n.sanitizeURL(r).then(t=>{t["xlink:href"]=t.href,t.href=null,(n._hrefs||(n._hrefs={}))[r]=t})}return null},bD.mark=function(t){const e=nT[t.marktype],n=e.tag,r=[XT,e.attr];let i="";i+=JT("g",ie({class:gT(t),"clip-path":t.clip?pA(this,t,t.group):null},KT(t),{"pointer-events":"g"!==n&&!1===t.interactive?"none":null}));const o=o=>{const a=this.href(o);if(a&&(i+=JT("a",a)),i+=JT(n,this.attr(t,o,r,"g"!==n?n:null)),"text"===n){const t=HN(o);if(Ct(t)){const e={x:0,dy:qN(o)};for(let n=0;n<t.length;++n)i+=JT("tspan",n?e:null)+xD(XN(o,t[n]))+tD("tspan")}else i+=xD(XN(o,t))}else if("g"===n){const n=o.strokeForeground,r=o.fill,a=o.stroke;n&&a&&(o.stroke=null),i+=JT("path",this.attr(t,o,e.background,"bgrect"))+tD("path"),i+=JT("g",this.attr(t,o,e.content))+this.markGroup(o)+tD("g"),n&&a?(r&&(o.fill=null),o.stroke=a,i+=JT("path",this.attr(t,o,e.foreground,"bgrect"))+tD("path"),r&&(o.fill=r)):i+=JT("path",this.attr(t,o,e.foreground,"bgfore"))+tD("path")}i+=tD(n),a&&(i+=tD("a"))};return e.nested?t.items&&t.items.length&&o(t.items[0]):JA(t,o),i+tD("g")},bD.markGroup=function(t){let e="";return JA(t,t=>{e+=this.mark(t)}),e};var _D={Canvas:"canvas",PNG:"png",SVG:"svg",None:"none"},CD={};function kD(t,e){return t=String(t||"").toLowerCase(),arguments.length>1?(CD[t]=e,this):CD[t]}function SD(t,e,n){const r=[],i=(new mA).union(e),o=t.marktype;return o?ED(t,i,n,r):"group"===o?OD(t,i,n,r):at("Intersect scene must be mark node or group item.")}function ED(t,e,n,r){if(function(t,e,n){return t.bounds&&e.intersects(t.bounds)&&("group"===t.marktype||!1!==t.interactive&&(!n||n(t)))}(t,e,n)){const i=t.items,o=t.marktype,a=i.length;let s=0;if("group"===o)for(;s<a;++s)OD(i[s],e,n,r);else for(const t=nT[o].isect;s<a;++s){let n=i[s];AD(n,e,t)&&r.push(n)}}return r}function OD(t,e,n,r){n&&n(t.mark)&&AD(t,e,nT.group.isect)&&r.push(t);const i=t.items,o=i&&i.length;if(o){const a=t.x||0,s=t.y||0;e.translate(-a,-s);for(let t=0;t<o;++t)ED(i[t],e,n,r);e.translate(a,s)}return r}function AD(t,e,n){const r=t.bounds;return e.encloses(r)||e.intersects(r)&&n(t,e)}CD.canvas=CD.png={renderer:zT,headless:zT,handler:RT},CD.svg={renderer:iD,headless:vD,handler:UT},CD.none={};var ND=new mA,TD=function(t){var e=t.clip;if(Yt(e))e(AA(ND.clear()));else{if(!e)return;ND.set(0,0,t.group.width,t.group.height)}t.bounds.intersect(ND)};function DD(t,e,n){return t===e||("path"===n?RD(t,e):t instanceof Date&&e instanceof Date?+t==+e:ge(t)&&ge(e)?Math.abs(t-e)<=1e-9:t&&e&&(kt(t)||kt(e))?null!=t&&null!=e&&function(t,e){var n,r,i=Object.keys(t),o=Object.keys(e);if(i.length!==o.length)return!1;for(i.sort(),o.sort(),r=i.length-1;r>=0;r--)if(i[r]!=o[r])return!1;for(r=i.length-1;r>=0;r--)if(!DD(t[n=i[r]],e[n],n))return!1;return typeof t==typeof e}(t,e):t==e)}function RD(t,e){return DD(NO(t),NO(e))}function ID(){fA(),wO=0}function MD(t,e){t&&(null==e?t.removeAttribute("aria-label"):t.setAttribute("aria-label",e))}function FD(t,e){const n=t.globalCursor()?"undefined"!=typeof document&&document.body:t.container();if(n)return null==e?n.style.removeProperty("cursor"):n.style.cursor=e}function PD(t,e){var n=t._runtime.data;return On(n,e)||Be("Unrecognized data set: "+e),n[e]}function jD(t,e){rr(e)||Be("Second argument to changes must be a changeset.");var n=PD(this,t);return n.modified=!0,this.pulse(n.input,e)}function zD(t){var e=t.padding();return Math.max(0,t._viewWidth+e.left+e.right)}function LD(t){var e=t.padding();return Math.max(0,t._viewHeight+e.top+e.bottom)}function BD(t){var e=t.padding(),n=t._origin;return[e.left+n[0],e.top+n[1]]}const UD={trap:!1};function $D(t,e,n){const r=t._eventConfig&&t._eventConfig[e];return!(!1===r||Ze(r)&&!r[n])||(t.warn(`Blocked ${e} ${n} event listener.`),!1)}function VD(t){return t.item}function WD(t){return t.item.mark.source}function qD(t){return function(e,n){return n.vega.view().changeset().encode(n.item,t)}}var HD=function(t,e,n){var r=document.createElement(t);for(var i in e)r.setAttribute(i,e[i]);return null!=n&&(r.textContent=n),r};function GD(t,e,n,r){const i=HD("input");for(const o in n)"signal"!==o&&"element"!==o&&i.setAttribute("input"===o?"type":o,n[o]);i.setAttribute("name",n.signal),i.value=r,e.appendChild(i),i.addEventListener("input",()=>t.update(i.value)),t.elements=[i],t.set=t=>i.value=t}function XD(t,e,n,r){const i={type:"checkbox",name:n.signal};r&&(i.checked=!0);const o=HD("input",i);e.appendChild(o),o.addEventListener("change",()=>t.update(o.checked)),t.elements=[o],t.set=t=>o.checked=!!t||null}function KD(t,e,n,r){const i=HD("select",{name:n.signal}),o=n.labels||[];n.options.forEach((t,e)=>{const n={value:t};QD(t,r)&&(n.selected=!0),i.appendChild(HD("option",n,(o[e]||t)+""))}),e.appendChild(i),i.addEventListener("change",()=>{t.update(n.options[i.selectedIndex])}),t.elements=[i],t.set=t=>{for(let e=0,r=n.options.length;e<r;++e)if(QD(n.options[e],t))return void(i.selectedIndex=e)}}function YD(t,e,n,r){const i=HD("span",{class:"vega-bind-radio"}),o=n.labels||[];e.appendChild(i),t.elements=n.options.map((e,a)=>{const s={type:"radio",name:n.signal,value:e};QD(e,r)&&(s.checked=!0);const u=HD("input",s);u.addEventListener("change",()=>t.update(e));const l=HD("label",{},(o[a]||e)+"");return l.prepend(u),i.appendChild(l),u}),t.set=e=>{const n=t.elements,r=n.length;for(let t=0;t<r;++t)QD(n[t].value,e)&&(n[t].checked=!0)}}function ZD(t,e,n,r){r=void 0!==r?r:(+n.max+ +n.min)/2;const i=null!=n.max?n.max:Math.max(100,+r)||100,o=n.min||Math.min(0,i,+r)||0,a=n.step||ei(o,i,100),s=HD("input",{type:"range",name:n.signal,min:o,max:i,step:a});s.value=r;const u=HD("span",{},+r);e.appendChild(s),e.appendChild(u);const l=()=>{u.textContent=s.value,t.update(+s.value)};s.addEventListener("input",l),s.addEventListener("change",l),t.elements=[s],t.set=t=>{s.value=t,u.textContent=t}}function QD(t,e){return t===e||t+""==e+""}var JD=function(t,e,n,r,i,o){return(e=e||new r(t.loader())).initialize(n,zD(t),LD(t),BD(t),i,o).background(t.background())},tR=function(t,e){return e?function(){try{e.apply(this,arguments)}catch(n){t.error(n)}}:null};function eR(t,e){if("string"==typeof e){if("undefined"==typeof document)return t.error("DOM document instance not found."),null;if(!(e=document.querySelector(e)))return t.error("Signal bind element not found: "+e),null}if(e)try{e.innerHTML=""}catch(n){e=null,t.error(n)}return e}const nR=t=>+t||0;var rR=function(t){return Ze(t)?{top:nR(t.top),bottom:nR(t.bottom),left:nR(t.left),right:nR(t.right)}:(t=>({top:t,bottom:t,left:t,right:t}))(nR(t))},iR=async function(t,e,n,r){const i=xb(e),o=i&&i.headless;return o||Be("Unrecognized renderer type: "+e),await t.runAsync(),JD(t,null,null,o,n,r).renderAsync(t._scenegraph.root)};function oR(t){const e=this.context.data[t];return e?e.values.value:[]}const aR=t=>function(e,n){return this.context.dataflow.locale()[t](n)(e)},sR=aR("format"),uR=aR("timeFormat"),lR=aR("utcFormat"),cR=aR("timeParse"),hR=aR("utcParse"),dR=new Date(2e3,0,1);function fR(t,e,n){return Number.isInteger(t)&&Number.isInteger(e)?(dR.setYear(2e3),dR.setMonth(t),dR.setDate(e),uR.call(this,dR,n)):""}function pR(t){this.type=t}var mR,gR,yR,vR,bR;pR.prototype.visit=function(t){let e,n,r;if(t(this))return 1;for(e=function(t){switch(t.type){case"ArrayExpression":return t.elements;case"BinaryExpression":case"LogicalExpression":return[t.left,t.right];case"CallExpression":return[t.callee].concat(t.arguments);case"ConditionalExpression":return[t.test,t.consequent,t.alternate];case"MemberExpression":return[t.object,t.property];case"ObjectExpression":return t.properties;case"Property":return[t.key,t.value];case"UnaryExpression":return[t.argument];case"Identifier":case"Literal":case"RawCode":default:return[]}}(this),n=0,r=e.length;n<r;++n)if(e[n].visit(t))return 1},(mR={})[1]="Boolean",mR[2]="<end>",mR[3]="Identifier",mR[4]="Keyword",mR[5]="Null",mR[6]="Numeric",mR[7]="Punctuator",mR[8]="String",mR[9]="RegularExpression";var wR="ILLEGAL",xR=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0370-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0620-\\u064A\\u066E\\u066F\\u0671-\\u06D3\\u06D5\\u06E5\\u06E6\\u06EE\\u06EF\\u06FA-\\u06FC\\u06FF\\u0710\\u0712-\\u072F\\u074D-\\u07A5\\u07B1\\u07CA-\\u07EA\\u07F4\\u07F5\\u07FA\\u0800-\\u0815\\u081A\\u0824\\u0828\\u0840-\\u0858\\u08A0-\\u08B2\\u0904-\\u0939\\u093D\\u0950\\u0958-\\u0961\\u0971-\\u0980\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BD\\u09CE\\u09DC\\u09DD\\u09DF-\\u09E1\\u09F0\\u09F1\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A59-\\u0A5C\\u0A5E\\u0A72-\\u0A74\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABD\\u0AD0\\u0AE0\\u0AE1\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3D\\u0B5C\\u0B5D\\u0B5F-\\u0B61\\u0B71\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BD0\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D\\u0C58\\u0C59\\u0C60\\u0C61\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBD\\u0CDE\\u0CE0\\u0CE1\\u0CF1\\u0CF2\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D\\u0D4E\\u0D60\\u0D61\\u0D7A-\\u0D7F\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0E01-\\u0E30\\u0E32\\u0E33\\u0E40-\\u0E46\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB0\\u0EB2\\u0EB3\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EDC-\\u0EDF\\u0F00\\u0F40-\\u0F47\\u0F49-\\u0F6C\\u0F88-\\u0F8C\\u1000-\\u102A\\u103F\\u1050-\\u1055\\u105A-\\u105D\\u1061\\u1065\\u1066\\u106E-\\u1070\\u1075-\\u1081\\u108E\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1711\\u1720-\\u1731\\u1740-\\u1751\\u1760-\\u176C\\u176E-\\u1770\\u1780-\\u17B3\\u17D7\\u17DC\\u1820-\\u1877\\u1880-\\u18A8\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1950-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19C1-\\u19C7\\u1A00-\\u1A16\\u1A20-\\u1A54\\u1AA7\\u1B05-\\u1B33\\u1B45-\\u1B4B\\u1B83-\\u1BA0\\u1BAE\\u1BAF\\u1BBA-\\u1BE5\\u1C00-\\u1C23\\u1C4D-\\u1C4F\\u1C5A-\\u1C7D\\u1CE9-\\u1CEC\\u1CEE-\\u1CF1\\u1CF5\\u1CF6\\u1D00-\\u1DBF\\u1E00-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u2071\\u207F\\u2090-\\u209C\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CEE\\u2CF2\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D80-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2E2F\\u3005-\\u3007\\u3021-\\u3029\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA61F\\uA62A\\uA62B\\uA640-\\uA66E\\uA67F-\\uA69D\\uA6A0-\\uA6EF\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA801\\uA803-\\uA805\\uA807-\\uA80A\\uA80C-\\uA822\\uA840-\\uA873\\uA882-\\uA8B3\\uA8F2-\\uA8F7\\uA8FB\\uA90A-\\uA925\\uA930-\\uA946\\uA960-\\uA97C\\uA984-\\uA9B2\\uA9CF\\uA9E0-\\uA9E4\\uA9E6-\\uA9EF\\uA9FA-\\uA9FE\\uAA00-\\uAA28\\uAA40-\\uAA42\\uAA44-\\uAA4B\\uAA60-\\uAA76\\uAA7A\\uAA7E-\\uAAAF\\uAAB1\\uAAB5\\uAAB6\\uAAB9-\\uAABD\\uAAC0\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEA\\uAAF2-\\uAAF4\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABE2\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D\\uFB1F-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF21-\\uFF3A\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]"),_R=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0300-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u0483-\\u0487\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u0591-\\u05BD\\u05BF\\u05C1\\u05C2\\u05C4\\u05C5\\u05C7\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0610-\\u061A\\u0620-\\u0669\\u066E-\\u06D3\\u06D5-\\u06DC\\u06DF-\\u06E8\\u06EA-\\u06FC\\u06FF\\u0710-\\u074A\\u074D-\\u07B1\\u07C0-\\u07F5\\u07FA\\u0800-\\u082D\\u0840-\\u085B\\u08A0-\\u08B2\\u08E4-\\u0963\\u0966-\\u096F\\u0971-\\u0983\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BC-\\u09C4\\u09C7\\u09C8\\u09CB-\\u09CE\\u09D7\\u09DC\\u09DD\\u09DF-\\u09E3\\u09E6-\\u09F1\\u0A01-\\u0A03\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A3C\\u0A3E-\\u0A42\\u0A47\\u0A48\\u0A4B-\\u0A4D\\u0A51\\u0A59-\\u0A5C\\u0A5E\\u0A66-\\u0A75\\u0A81-\\u0A83\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABC-\\u0AC5\\u0AC7-\\u0AC9\\u0ACB-\\u0ACD\\u0AD0\\u0AE0-\\u0AE3\\u0AE6-\\u0AEF\\u0B01-\\u0B03\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3C-\\u0B44\\u0B47\\u0B48\\u0B4B-\\u0B4D\\u0B56\\u0B57\\u0B5C\\u0B5D\\u0B5F-\\u0B63\\u0B66-\\u0B6F\\u0B71\\u0B82\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BBE-\\u0BC2\\u0BC6-\\u0BC8\\u0BCA-\\u0BCD\\u0BD0\\u0BD7\\u0BE6-\\u0BEF\\u0C00-\\u0C03\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D-\\u0C44\\u0C46-\\u0C48\\u0C4A-\\u0C4D\\u0C55\\u0C56\\u0C58\\u0C59\\u0C60-\\u0C63\\u0C66-\\u0C6F\\u0C81-\\u0C83\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBC-\\u0CC4\\u0CC6-\\u0CC8\\u0CCA-\\u0CCD\\u0CD5\\u0CD6\\u0CDE\\u0CE0-\\u0CE3\\u0CE6-\\u0CEF\\u0CF1\\u0CF2\\u0D01-\\u0D03\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D-\\u0D44\\u0D46-\\u0D48\\u0D4A-\\u0D4E\\u0D57\\u0D60-\\u0D63\\u0D66-\\u0D6F\\u0D7A-\\u0D7F\\u0D82\\u0D83\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0DCA\\u0DCF-\\u0DD4\\u0DD6\\u0DD8-\\u0DDF\\u0DE6-\\u0DEF\\u0DF2\\u0DF3\\u0E01-\\u0E3A\\u0E40-\\u0E4E\\u0E50-\\u0E59\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB9\\u0EBB-\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EC8-\\u0ECD\\u0ED0-\\u0ED9\\u0EDC-\\u0EDF\\u0F00\\u0F18\\u0F19\\u0F20-\\u0F29\\u0F35\\u0F37\\u0F39\\u0F3E-\\u0F47\\u0F49-\\u0F6C\\u0F71-\\u0F84\\u0F86-\\u0F97\\u0F99-\\u0FBC\\u0FC6\\u1000-\\u1049\\u1050-\\u109D\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u135D-\\u135F\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1714\\u1720-\\u1734\\u1740-\\u1753\\u1760-\\u176C\\u176E-\\u1770\\u1772\\u1773\\u1780-\\u17D3\\u17D7\\u17DC\\u17DD\\u17E0-\\u17E9\\u180B-\\u180D\\u1810-\\u1819\\u1820-\\u1877\\u1880-\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1920-\\u192B\\u1930-\\u193B\\u1946-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19B0-\\u19C9\\u19D0-\\u19D9\\u1A00-\\u1A1B\\u1A20-\\u1A5E\\u1A60-\\u1A7C\\u1A7F-\\u1A89\\u1A90-\\u1A99\\u1AA7\\u1AB0-\\u1ABD\\u1B00-\\u1B4B\\u1B50-\\u1B59\\u1B6B-\\u1B73\\u1B80-\\u1BF3\\u1C00-\\u1C37\\u1C40-\\u1C49\\u1C4D-\\u1C7D\\u1CD0-\\u1CD2\\u1CD4-\\u1CF6\\u1CF8\\u1CF9\\u1D00-\\u1DF5\\u1DFC-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u200C\\u200D\\u203F\\u2040\\u2054\\u2071\\u207F\\u2090-\\u209C\\u20D0-\\u20DC\\u20E1\\u20E5-\\u20F0\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D7F-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2DE0-\\u2DFF\\u2E2F\\u3005-\\u3007\\u3021-\\u302F\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u3099\\u309A\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA62B\\uA640-\\uA66F\\uA674-\\uA67D\\uA67F-\\uA69D\\uA69F-\\uA6F1\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA827\\uA840-\\uA873\\uA880-\\uA8C4\\uA8D0-\\uA8D9\\uA8E0-\\uA8F7\\uA8FB\\uA900-\\uA92D\\uA930-\\uA953\\uA960-\\uA97C\\uA980-\\uA9C0\\uA9CF-\\uA9D9\\uA9E0-\\uA9FE\\uAA00-\\uAA36\\uAA40-\\uAA4D\\uAA50-\\uAA59\\uAA60-\\uAA76\\uAA7A-\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEF\\uAAF2-\\uAAF6\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABEA\\uABEC\\uABED\\uABF0-\\uABF9\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE00-\\uFE0F\\uFE20-\\uFE2D\\uFE33\\uFE34\\uFE4D-\\uFE4F\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF10-\\uFF19\\uFF21-\\uFF3A\\uFF3F\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]");function CR(t,e){if(!t)throw new Error("ASSERT: "+e)}function kR(t){return t>=48&&t<=57}function SR(t){return"0123456789abcdefABCDEF".indexOf(t)>=0}function ER(t){return"01234567".indexOf(t)>=0}function OR(t){return 32===t||9===t||11===t||12===t||160===t||t>=5760&&[5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279].indexOf(t)>=0}function AR(t){return 10===t||13===t||8232===t||8233===t}function NR(t){return 36===t||95===t||t>=65&&t<=90||t>=97&&t<=122||92===t||t>=128&&xR.test(String.fromCharCode(t))}function TR(t){return 36===t||95===t||t>=65&&t<=90||t>=97&&t<=122||t>=48&&t<=57||92===t||t>=128&&_R.test(String.fromCharCode(t))}var DR={if:1,in:1,do:1,var:1,for:1,new:1,try:1,let:1,this:1,else:1,case:1,void:1,with:1,enum:1,while:1,break:1,catch:1,throw:1,const:1,yield:1,class:1,super:1,return:1,typeof:1,delete:1,switch:1,export:1,import:1,public:1,static:1,default:1,finally:1,extends:1,package:1,private:1,function:1,continue:1,debugger:1,interface:1,protected:1,instanceof:1,implements:1};function RR(){for(var t;yR<vR&&(OR(t=gR.charCodeAt(yR))||AR(t));)++yR}function IR(t){var e,n,r,i=0;for(n="u"===t?4:2,e=0;e<n;++e)yR<vR&&SR(gR[yR])?(r=gR[yR++],i=16*i+"0123456789abcdef".indexOf(r.toLowerCase())):HR({},"Unexpected token %0",wR);return String.fromCharCode(i)}function MR(){var t,e;for(e=0,"}"===(t=gR[yR])&&HR({},"Unexpected token %0",wR);yR<vR&&SR(t=gR[yR++]);)e=16*e+"0123456789abcdef".indexOf(t.toLowerCase());return(e>1114111||"}"!==t)&&HR({},"Unexpected token %0",wR),e<=65535?String.fromCharCode(e):String.fromCharCode(55296+(e-65536>>10),56320+(e-65536&1023))}function FR(){var t,e;for(t=gR.charCodeAt(yR++),e=String.fromCharCode(t),92===t&&(117!==gR.charCodeAt(yR)&&HR({},"Unexpected token %0",wR),++yR,(t=IR("u"))&&"\\"!==t&&NR(t.charCodeAt(0))||HR({},"Unexpected token %0",wR),e=t);yR<vR&&TR(t=gR.charCodeAt(yR));)++yR,e+=String.fromCharCode(t),92===t&&(e=e.substr(0,e.length-1),117!==gR.charCodeAt(yR)&&HR({},"Unexpected token %0",wR),++yR,(t=IR("u"))&&"\\"!==t&&TR(t.charCodeAt(0))||HR({},"Unexpected token %0",wR),e+=t);return e}function PR(){var t,e,n,r,i=yR,o=gR.charCodeAt(yR),a=gR[yR];switch(o){case 46:case 40:case 41:case 59:case 44:case 123:case 125:case 91:case 93:case 58:case 63:case 126:return++yR,{type:7,value:String.fromCharCode(o),start:i,end:yR};default:if(61===(t=gR.charCodeAt(yR+1)))switch(o){case 43:case 45:case 47:case 60:case 62:case 94:case 124:case 37:case 38:case 42:return yR+=2,{type:7,value:String.fromCharCode(o)+String.fromCharCode(t),start:i,end:yR};case 33:case 61:return 61===gR.charCodeAt(yR+=2)&&++yR,{type:7,value:gR.slice(i,yR),start:i,end:yR}}}return">>>="===(r=gR.substr(yR,4))?{type:7,value:r,start:i,end:yR+=4}:">>>"===(n=r.substr(0,3))||"<<="===n||">>="===n?{type:7,value:n,start:i,end:yR+=3}:a===(e=n.substr(0,2))[1]&&"+-<>&|".indexOf(a)>=0||"=>"===e?{type:7,value:e,start:i,end:yR+=2}:"<>=!+-*%&|^/".indexOf(a)>=0?{type:7,value:a,start:i,end:++yR}:void HR({},"Unexpected token %0",wR)}function jR(){var t,e,n;if(CR(kR((n=gR[yR]).charCodeAt(0))||"."===n,"Numeric literal must start with a decimal digit or a decimal point"),e=yR,t="","."!==n){if(t=gR[yR++],n=gR[yR],"0"===t){if("x"===n||"X"===n)return++yR,function(t){for(var e="";yR<vR&&SR(gR[yR]);)e+=gR[yR++];return 0===e.length&&HR({},"Unexpected token %0",wR),NR(gR.charCodeAt(yR))&&HR({},"Unexpected token %0",wR),{type:6,value:parseInt("0x"+e,16),start:t,end:yR}}(e);if(ER(n))return function(t){for(var e="0"+gR[yR++];yR<vR&&ER(gR[yR]);)e+=gR[yR++];return(NR(gR.charCodeAt(yR))||kR(gR.charCodeAt(yR)))&&HR({},"Unexpected token %0",wR),{type:6,value:parseInt(e,8),octal:!0,start:t,end:yR}}(e);n&&kR(n.charCodeAt(0))&&HR({},"Unexpected token %0",wR)}for(;kR(gR.charCodeAt(yR));)t+=gR[yR++];n=gR[yR]}if("."===n){for(t+=gR[yR++];kR(gR.charCodeAt(yR));)t+=gR[yR++];n=gR[yR]}if("e"===n||"E"===n)if(t+=gR[yR++],"+"!==(n=gR[yR])&&"-"!==n||(t+=gR[yR++]),kR(gR.charCodeAt(yR)))for(;kR(gR.charCodeAt(yR));)t+=gR[yR++];else HR({},"Unexpected token %0",wR);return NR(gR.charCodeAt(yR))&&HR({},"Unexpected token %0",wR),{type:6,value:parseFloat(t),start:e,end:yR}}function zR(){var t,e,n;return RR(),yR>=vR?{type:2,start:yR,end:yR}:NR(t=gR.charCodeAt(yR))?(e=yR,{type:1===(n=92===gR.charCodeAt(yR)?FR():function(){var t,e;for(t=yR++;yR<vR;){if(92===(e=gR.charCodeAt(yR)))return yR=t,FR();if(!TR(e))break;++yR}return gR.slice(t,yR)}()).length?3:DR.hasOwnProperty(n)?4:"null"===n?5:"true"===n||"false"===n?1:3,value:n,start:e,end:yR}):40===t||41===t||59===t?PR():39===t||34===t?function(){var t,e,n,r,i="",o=!1;for(CR("'"===(t=gR[yR])||'"'===t,"String literal must starts with a quote"),e=yR,++yR;yR<vR;){if((n=gR[yR++])===t){t="";break}if("\\"===n)if((n=gR[yR++])&&AR(n.charCodeAt(0)))"\r"===n&&"\n"===gR[yR]&&++yR;else switch(n){case"u":case"x":"{"===gR[yR]?(++yR,i+=MR()):i+=IR(n);break;case"n":i+="\n";break;case"r":i+="\r";break;case"t":i+="\t";break;case"b":i+="\b";break;case"f":i+="\f";break;case"v":i+="\v";break;default:ER(n)?(0!==(r="01234567".indexOf(n))&&(o=!0),yR<vR&&ER(gR[yR])&&(o=!0,r=8*r+"01234567".indexOf(gR[yR++]),"0123".indexOf(n)>=0&&yR<vR&&ER(gR[yR])&&(r=8*r+"01234567".indexOf(gR[yR++]))),i+=String.fromCharCode(r)):i+=n}else{if(AR(n.charCodeAt(0)))break;i+=n}}return""!==t&&HR({},"Unexpected token %0",wR),{type:8,value:i,octal:o,start:e,end:yR}}():46===t?kR(gR.charCodeAt(yR+1))?jR():PR():kR(t)?jR():PR()}function LR(){var t;return yR=(t=bR).end,bR=zR(),yR=t.end,t}function BR(){var t;t=yR,bR=zR(),yR=t}function UR(t,e,n){var r=new pR("||"===t||"&&"===t?"LogicalExpression":"BinaryExpression");return r.operator=t,r.left=e,r.right=n,r}function $R(t){var e=new pR("Identifier");return e.name=t,e}function VR(t){var e=new pR("Literal");return e.value=t.value,e.raw=gR.slice(t.start,t.end),t.regex&&("//"===e.raw&&(e.raw="/(?:)/"),e.regex=t.regex),e}function WR(t,e,n){var r=new pR("MemberExpression");return r.computed="["===t,r.object=e,r.property=n,r.computed||(n.member=!0),r}function qR(t,e,n){var r=new pR("Property");return r.key=e,r.value=n,r.kind=t,r}function HR(t,e){var n,r=Array.prototype.slice.call(arguments,2),i=e.replace(/%(\d)/g,(function(t,e){return CR(e<r.length,"Message reference must be in range"),r[e]}));throw(n=new Error(i)).index=yR,n.description=i,n}function GR(t){2===t.type&&HR(t,"Unexpected end of input"),6===t.type&&HR(t,"Unexpected number"),8===t.type&&HR(t,"Unexpected string"),3===t.type&&HR(t,"Unexpected identifier"),4===t.type&&HR(t,"Unexpected reserved word"),HR(t,"Unexpected token %0",t.value)}function XR(t){var e=LR();7===e.type&&e.value===t||GR(e)}function KR(t){return 7===bR.type&&bR.value===t}function YR(t){return 4===bR.type&&bR.value===t}function ZR(){var t;return yR=bR.start,8===(t=LR()).type||6===t.type?(t.octal&&HR(t,"Octal literals are not allowed in strict mode."),VR(t)):$R(t.value)}function QR(){var t,e,n;return yR=bR.start,3===(t=bR).type?(n=ZR(),XR(":"),qR("init",n,oI())):2!==t.type&&7!==t.type?(e=ZR(),XR(":"),qR("init",e,oI())):void GR(t)}var JR={if:1};function tI(){var t=[];if(XR("("),!KR(")"))for(;yR<vR&&(t.push(oI()),!KR(")"));)XR(",");return XR(")"),t}function eI(){var t;return XR("["),t=aI(),XR("]"),t}function nI(){var t=function(){var t,e,n,r,i;for(t=function(){var t,e,n,r,i,o,a;if(KR("("))return function(){var t;return XR("("),t=aI(),XR(")"),t}();if(KR("["))return function(){var t=[];for(yR=bR.start,XR("[");!KR("]");)KR(",")?(LR(),t.push(null)):(t.push(oI()),KR("]")||XR(","));return LR(),function(t){var e=new pR("ArrayExpression");return e.elements=t,e}(t)}();if(KR("{"))return function(){var t,e,n=[],r={},i=String;for(yR=bR.start,XR("{");!KR("}");)e="$"+("Identifier"===(t=QR()).key.type?t.key.name:i(t.key.value)),Object.prototype.hasOwnProperty.call(r,e)?HR({},"Duplicate data property in object literal not allowed in strict mode"):r[e]=!0,n.push(t),KR("}")||XR(",");return XR("}"),function(t){var e=new pR("ObjectExpression");return e.properties=t,e}(n)}();if(yR=bR.start,3===(t=bR.type)||JR[bR.value])n=$R(LR().value);else if(8===t||6===t)bR.octal&&HR(bR,"Octal literals are not allowed in strict mode."),n=VR(LR());else{if(4===t)throw new Error("Disabled.");1===t?((e=LR()).value="true"===e.value,n=VR(e)):5===t?((e=LR()).value=null,n=VR(e)):KR("/")||KR("/=")?(n=VR((bR=null,RR(),r=yR,i=function(){var t,e,n,r;for(CR("/"===(t=gR[yR]),"Regular expression literal must start with a slash"),e=gR[yR++],n=!1,r=!1;yR<vR;)if(e+=t=gR[yR++],"\\"===t)AR((t=gR[yR++]).charCodeAt(0))&&HR({},"Invalid regular expression: missing /"),e+=t;else if(AR(t.charCodeAt(0)))HR({},"Invalid regular expression: missing /");else if(n)"]"===t&&(n=!1);else{if("/"===t){r=!0;break}"["===t&&(n=!0)}return r||HR({},"Invalid regular expression: missing /"),{value:e.substr(1,e.length-2),literal:e}}(),o=function(){var t,e,n;for(e="",n="";yR<vR&&TR((t=gR[yR]).charCodeAt(0));)++yR,"\\"===t&&yR<vR?HR({},"Unexpected token %0",wR):(n+=t,e+=t);return n.search(/[^gimuy]/g)>=0&&HR({},"Invalid regular expression",n),{value:n,literal:e}}(),a=function(t,e){var n=t;e.indexOf("u")>=0&&(n=n.replace(/\\u\{([0-9a-fA-F]+)\}/g,(function(t,e){if(parseInt(e,16)<=1114111)return"x";HR({},"Invalid regular expression")})).replace(/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,"x"));try{new RegExp(n)}catch(r){HR({},"Invalid regular expression")}try{return new RegExp(t,e)}catch(i){return null}}(i.value,o.value),{literal:i.literal+o.literal,value:a,regex:{pattern:i.value,flags:o.value},start:r,end:yR})),BR()):GR(LR())}return n}();;)if(KR("."))t=WR(".",t,(void 0,XR("."),yR=bR.start,function(t){return 3===t.type||4===t.type||1===t.type||5===t.type}(i=LR())||GR(i),$R(i.value)));else if(KR("("))e=t,n=tI(),r=void 0,(r=new pR("CallExpression")).callee=e,r.arguments=n,t=r;else{if(!KR("["))break;t=WR("[",t,eI())}return t}();if(7===bR.type&&(KR("++")||KR("--")))throw new Error("Disabled.");return t}function rI(){var t,e,n,r,i;if(7!==bR.type&&4!==bR.type)e=nI();else{if(KR("++")||KR("--"))throw new Error("Disabled.");if(KR("+")||KR("-")||KR("~")||KR("!"))t=LR(),e=rI(),n=t.value,r=e,(i=new pR("UnaryExpression")).operator=n,i.argument=r,i.prefix=!0,e=i;else{if(YR("delete")||YR("void")||YR("typeof"))throw new Error("Disabled.");e=nI()}}return e}function iI(t){var e=0;if(7!==t.type&&4!==t.type)return 0;switch(t.value){case"||":e=1;break;case"&&":e=2;break;case"|":e=3;break;case"^":e=4;break;case"&":e=5;break;case"==":case"!=":case"===":case"!==":e=6;break;case"<":case">":case"<=":case">=":case"instanceof":case"in":e=7;break;case"<<":case">>":case">>>":e=8;break;case"+":case"-":e=9;break;case"*":case"/":case"%":e=11}return e}function oI(){var t,e;return t=function(){var t,e,n,r,i,o,a,s,u,l;if(t=bR,u=rI(),0===(i=iI(r=bR)))return u;for(r.prec=i,LR(),e=[t,bR],o=[u,r,a=rI()];(i=iI(bR))>0;){for(;o.length>2&&i<=o[o.length-2].prec;)a=o.pop(),s=o.pop().value,u=o.pop(),e.pop(),n=UR(s,u,a),o.push(n);(r=LR()).prec=i,o.push(r),e.push(bR),n=rI(),o.push(n)}for(n=o[l=o.length-1],e.pop();l>1;)e.pop(),n=UR(o[l-1].value,o[l-2],n),l-=2;return n}(),KR("?")&&(LR(),e=oI(),XR(":"),t=function(t,e,n){var r=new pR("ConditionalExpression");return r.test=t,r.consequent=e,r.alternate=n,r}(t,e,oI())),t}function aI(){var t=oI();if(KR(","))throw new Error("Disabled.");return t}var sI=function(t){yR=0,vR=(gR=t).length,bR=null,BR();var e=aI();if(2!==bR.type)throw new Error("Unexpect token after expression.");return e},uI={NaN:"NaN",E:"Math.E",LN2:"Math.LN2",LN10:"Math.LN10",LOG2E:"Math.LOG2E",LOG10E:"Math.LOG10E",PI:"Math.PI",SQRT1_2:"Math.SQRT1_2",SQRT2:"Math.SQRT2",MIN_VALUE:"Number.MIN_VALUE",MAX_VALUE:"Number.MAX_VALUE"},lI=function(t){function e(e,n,r){return i=>function(e,n,r,i){let o=t(n[0]);return r&&(o=r+"("+o+")",0===r.lastIndexOf("new ",0)&&(o="("+o+")")),o+"."+e+(i<0?"":0===i?"()":"("+n.slice(1).map(t).join(",")+")")}(e,i,n,r)}const n="new Date";return{isNaN:"Number.isNaN",isFinite:"Number.isFinite",abs:"Math.abs",acos:"Math.acos",asin:"Math.asin",atan:"Math.atan",atan2:"Math.atan2",ceil:"Math.ceil",cos:"Math.cos",exp:"Math.exp",floor:"Math.floor",log:"Math.log",max:"Math.max",min:"Math.min",pow:"Math.pow",random:"Math.random",round:"Math.round",sin:"Math.sin",sqrt:"Math.sqrt",tan:"Math.tan",clamp:function(e){e.length<3&&Be("Missing arguments to clamp function."),e.length>3&&Be("Too many arguments to clamp function.");const n=e.map(t);return"Math.max("+n[1]+", Math.min("+n[2]+","+n[0]+"))"},now:"Date.now",utc:"Date.UTC",datetime:n,date:e("getDate",n,0),day:e("getDay",n,0),year:e("getFullYear",n,0),month:e("getMonth",n,0),hours:e("getHours",n,0),minutes:e("getMinutes",n,0),seconds:e("getSeconds",n,0),milliseconds:e("getMilliseconds",n,0),time:e("getTime",n,0),timezoneoffset:e("getTimezoneOffset",n,0),utcdate:e("getUTCDate",n,0),utcday:e("getUTCDay",n,0),utcyear:e("getUTCFullYear",n,0),utcmonth:e("getUTCMonth",n,0),utchours:e("getUTCHours",n,0),utcminutes:e("getUTCMinutes",n,0),utcseconds:e("getUTCSeconds",n,0),utcmilliseconds:e("getUTCMilliseconds",n,0),length:e("length",null,-1),join:e("join",null),indexof:e("indexOf",null),lastindexof:e("lastIndexOf",null),slice:e("slice",null),reverse:function(e){return"("+t(e[0])+").slice().reverse()"},parseFloat:"parseFloat",parseInt:"parseInt",upper:e("toUpperCase","String",0),lower:e("toLowerCase","String",0),substring:e("substring","String"),split:e("split","String"),replace:e("replace","String"),trim:e("trim","String",0),regexp:"RegExp",test:e("test","RegExp"),if:function(e){e.length<3&&Be("Missing arguments to if function."),e.length>3&&Be("Too many arguments to if function.");const n=e.map(t);return"("+n[0]+"?"+n[1]+":"+n[2]+")"}}};function cI(t,e,n,r){"Literal"!==e[0].type&&Be("First argument to data functions must be a string literal.");const i=e[0].value,o=":"+i;if(!On(o,r))try{r[o]=n.getData(i).tuplesRef()}catch(a){}}function hI(t,e,n,r){if("Literal"===e[0].type)dI(n,r,e[0].value);else for(t in n.scales)dI(n,r,t)}function dI(t,e,n){const r="%"+n;if(!On(e,r))try{e[r]=t.scaleRef(n)}catch(i){}}function fI(t,e){let n;return gn(t)?t:Mn(t)?(n=e.scales[t])&&n.value:void 0}var pI,mI,gI,yI,vI,bI=ox(),wI=ox(),xI={point:Nx,lineStart:Nx,lineEnd:Nx,polygonStart:function(){bI.reset(),xI.lineStart=_I,xI.lineEnd=CI},polygonEnd:function(){var t=+bI;wI.add(t<0?dx+t:t),this.lineStart=this.lineEnd=this.point=Nx},sphere:function(){wI.add(dx)}};function _I(){xI.point=kI}function CI(){SI(pI,mI)}function kI(t,e){xI.point=SI,pI=t,mI=e,gI=t*=px,yI=vx(e=(e*=px)/2+hx),vI=Cx(e)}function SI(t,e){var n=(t*=px)-gI,r=n>=0?1:-1,i=r*n,o=vx(e=(e*=px)/2+hx),a=Cx(e),s=vI*a,u=yI*o+s*vx(i),l=s*r*Cx(i);bI.add(yx(l,u)),gI=t,yI=o,vI=a}var EI,OI,AI,NI,TI,DI,RI,II,MI,FI,PI=ox(),jI={point:zI,lineStart:BI,lineEnd:UI,polygonStart:function(){jI.point=$I,jI.lineStart=VI,jI.lineEnd=WI,PI.reset(),xI.polygonStart()},polygonEnd:function(){xI.polygonEnd(),jI.point=zI,jI.lineStart=BI,jI.lineEnd=UI,bI<0?(EI=-(AI=180),OI=-(NI=90)):PI>1e-6?NI=90:PI<-1e-6&&(OI=-90),FI[0]=EI,FI[1]=AI},sphere:function(){EI=-(AI=180),OI=-(NI=90)}};function zI(t,e){MI.push(FI=[EI=t,AI=t]),e<OI&&(OI=e),e>NI&&(NI=e)}function LI(t,e){var n=j_([t*px,e*px]);if(II){var r=L_(II,n),i=L_([r[1],-r[0],0],r);$_(i),i=P_(i);var o,a=t-TI,s=a>0?1:-1,u=i[0]*fx*s,l=mx(a)>180;l^(s*TI<u&&u<s*t)?(o=i[1]*fx)>NI&&(NI=o):l^(s*TI<(u=(u+360)%360-180)&&u<s*t)?(o=-i[1]*fx)<OI&&(OI=o):(e<OI&&(OI=e),e>NI&&(NI=e)),l?t<TI?qI(EI,t)>qI(EI,AI)&&(AI=t):qI(t,AI)>qI(EI,AI)&&(EI=t):AI>=EI?(t<EI&&(EI=t),t>AI&&(AI=t)):t>TI?qI(EI,t)>qI(EI,AI)&&(AI=t):qI(t,AI)>qI(EI,AI)&&(EI=t)}else MI.push(FI=[EI=t,AI=t]);e<OI&&(OI=e),e>NI&&(NI=e),II=n,TI=t}function BI(){jI.point=LI}function UI(){FI[0]=EI,FI[1]=AI,jI.point=zI,II=null}function $I(t,e){if(II){var n=t-TI;PI.add(mx(n)>180?n+(n>0?360:-360):n)}else DI=t,RI=e;xI.point(t,e),LI(t,e)}function VI(){xI.lineStart()}function WI(){$I(DI,RI),xI.lineEnd(),mx(PI)>1e-6&&(EI=-(AI=180)),FI[0]=EI,FI[1]=AI,II=null}function qI(t,e){return(e-=t)<0?e+360:e}function HI(t,e){return t[0]-e[0]}function GI(t,e){return t[0]<=t[1]?t[0]<=e&&e<=t[1]:e<t[0]||t[1]<e}var XI,KI,YI,ZI,QI,JI,tM,eM,nM,rM,iM,oM,aM,sM,uM,lM,cM={sphere:Nx,point:hM,lineStart:fM,lineEnd:gM,polygonStart:function(){cM.lineStart=yM,cM.lineEnd=vM},polygonEnd:function(){cM.lineStart=fM,cM.lineEnd=gM}};function hM(t,e){t*=px;var n=vx(e*=px);dM(n*vx(t),n*Cx(t),Cx(e))}function dM(t,e,n){++XI,YI+=(t-YI)/XI,ZI+=(e-ZI)/XI,QI+=(n-QI)/XI}function fM(){cM.point=pM}function pM(t,e){t*=px;var n=vx(e*=px);sM=n*vx(t),uM=n*Cx(t),lM=Cx(e),cM.point=mM,dM(sM,uM,lM)}function mM(t,e){t*=px;var n=vx(e*=px),r=n*vx(t),i=n*Cx(t),o=Cx(e),a=yx(Sx((a=uM*o-lM*i)*a+(a=lM*r-sM*o)*a+(a=sM*i-uM*r)*a),sM*r+uM*i+lM*o);KI+=a,JI+=a*(sM+(sM=r)),tM+=a*(uM+(uM=i)),eM+=a*(lM+(lM=o)),dM(sM,uM,lM)}function gM(){cM.point=hM}function yM(){cM.point=bM}function vM(){wM(oM,aM),cM.point=hM}function bM(t,e){oM=t,aM=e,t*=px,e*=px,cM.point=wM;var n=vx(e);sM=n*vx(t),uM=n*Cx(t),lM=Cx(e),dM(sM,uM,lM)}function wM(t,e){t*=px;var n=vx(e*=px),r=n*vx(t),i=n*Cx(t),o=Cx(e),a=uM*o-lM*i,s=lM*r-sM*o,u=sM*i-uM*r,l=Sx(a*a+s*s+u*u),c=Ax(l),h=l&&-c/l;nM+=h*a,rM+=h*s,iM+=h*u,KI+=c,JI+=c*(sM+(sM=r)),tM+=c*(uM+(uM=i)),eM+=c*(lM+(lM=o)),dM(sM,uM,lM)}function xM(t,e){return function(n,r,i){if(n){const e=fI(n,(i||this).context);return e&&e.path[t](r)}return e(r)}}const _M=xM("area",(function(t){return wI.reset(),ix(t,xI),2*wI})),CM=xM("bounds",(function(t){var e,n,r,i,o,a,s;if(NI=AI=-(EI=OI=1/0),MI=[],ix(t,jI),n=MI.length){for(MI.sort(HI),e=1,o=[r=MI[0]];e<n;++e)GI(r,(i=MI[e])[0])||GI(r,i[1])?(qI(r[0],i[1])>qI(r[0],r[1])&&(r[1]=i[1]),qI(i[0],r[1])>qI(r[0],r[1])&&(r[0]=i[0])):o.push(r=i);for(a=-1/0,e=0,r=o[n=o.length-1];e<=n;r=i,++e)(s=qI(r[1],(i=o[e])[0]))>a&&(a=s,EI=i[0],AI=r[1])}return MI=FI=null,EI===1/0||OI===1/0?[[NaN,NaN],[NaN,NaN]]:[[EI,OI],[AI,NI]]})),kM=xM("centroid",(function(t){XI=KI=YI=ZI=QI=JI=tM=eM=nM=rM=iM=0,ix(t,cM);var e=nM,n=rM,r=iM,i=e*e+n*n+r*r;return i<1e-12&&(e=JI,n=tM,r=eM,KI<1e-6&&(e=YI,n=ZI,r=QI),(i=e*e+n*n+r*r)<1e-12)?[NaN,NaN]:[yx(n,e)*fx,Ax(r/Sx(i))*fx]}));function SM(t,e,n){try{t[e].apply(t,["EXPRESSION"].concat([].slice.call(n)))}catch(r){t.warn(r)}return n[n.length-1]}function EM(t){const e=t/255;return e<=.03928?e/12.92:Math.pow((e+.055)/1.055,2.4)}function OM(t){const e=tg(t);return.2126*EM(e.r)+.7152*EM(e.g)+.0722*EM(e.b)}function AM(t,e){return t===e||t!=t&&e!=e||(Ye(t)?!(!Ye(e)||t.length!==e.length)&&function(t,e){for(let n=0,r=t.length;n<r;++n)if(!AM(t[n],e[n]))return!1;return!0}(t,e):!(!Ze(t)||!Ze(e))&&NM(t,e))}function NM(t,e){for(let n in t)if(!AM(t[n],e[n]))return!1;return!0}function TM(t){return e=>NM(t,e)}const DM=t=>t.data;function RM(t,e){const n=oR.call(e,t);return n.root&&n.root.lookup||{}}const IM=()=>"undefined"!=typeof window&&window||null;function MM(t,e){for(var n,r,i=e.fields,o=e.values,a=i.length,s=0;s<a;++s)if((r=i[s]).getter=$e.getter||$e(r.field),n=r.getter(t),Rn(n)&&(n=nn(n)),Rn(o[s])&&(o[s]=nn(o[s])),Rn(o[s][0])&&(o[s]=o[s].map(nn)),"E"===r.type){if(Ye(o[s])?o[s].indexOf(n)<0:n!==o[s])return!1}else if("R"===r.type){if(!Dn(n,o[s]))return!1}else if("R-RE"===r.type){if(!Dn(n,o[s],!0,!1))return!1}else if("R-E"===r.type){if(!Dn(n,o[s],!1,!1))return!1}else if("R-LE"===r.type&&!Dn(n,o[s],!1,!0))return!1;return!0}var FM={E_union:function(t,e){if(!t.length)return e;for(var n=0,r=e.length;n<r;++n)t.indexOf(e[n])<0&&t.push(e[n]);return t},E_intersect:function(t,e){return t.length?t.filter((function(t){return e.indexOf(t)>=0})):e},R_union:function(t,e){var n=nn(e[0]),r=nn(e[1]);return n>r&&(n=e[1],r=e[0]),t.length?(t[0]>n&&(t[0]=n),t[1]<r&&(t[1]=r),t):[n,r]},R_intersect:function(t,e){var n=nn(e[0]),r=nn(e[1]);return n>r&&(n=e[1],r=e[0]),t.length?r<t[0]||t[1]<n?[]:(t[0]<n&&(t[0]=n),t[1]>r&&(t[1]=r),t):[n,r]}};function PM(t,e,n,r){"Literal"!==e[0].type&&Be("First argument to selection functions must be a string literal.");const i=e[0].value,o=":"+i;"intersect"!==(e.length>=2&&en(e).value)||On(r,"@unit")||(r["@unit"]=n.getData(i).indataRef(n,"unit")),On(r,o)||(r[o]=n.getData(i).tuplesRef())}const jM={random:()=>bu(),cumulativeNormal:Tu,cumulativeLogNormal:Pu,cumulativeUniform:$u,densityNormal:Nu,densityLogNormal:Fu,densityUniform:Uu,quantileNormal:Du,quantileLogNormal:ju,quantileUniform:Vu,sampleNormal:Au,sampleLogNormal:Mu,sampleUniform:Bu,isArray:Ye,isBoolean:function(t){return"boolean"==typeof t},isDate:Rn,isDefined:t=>void 0!==t,isNumber:In,isObject:Ze,isRegExp:function(t){return"[object RegExp]"===Object.prototype.toString.call(t)},isString:Mn,isTuple:Kn,isValid:t=>null!=t&&t==t,toBoolean:Ln,toDate:Un,toNumber:nn,toString:$n,flush:function(t,e,n,r,i,o){if(!n&&0!==n)return o;let a,s,u=t[0],l=en(t),c=+n;return l<u&&(a=u,u=l,l=a),a=Math.abs(e-u),s=Math.abs(l-e),a<s&&a<=c?r:s<=c?i:o},lerp:function(t,e){const n=t[0],r=en(t),i=+e;return i?1===i?r:n+i*(r-n):n},merge:function(){const t=[].slice.call(arguments);return t.unshift({}),kn.apply(null,t)},pad:function(t,e,n,r){const i=n||" ",o=t+"",a=e-o.length;return a<=0?o:"left"===r?Pn(i,a)+o:"center"===r?Pn(i,~~(a/2))+o+Pn(i,Math.ceil(a/2)):o+Pn(i,a)},peek:en,span:jn,inrange:Dn,truncate:function(t,e,n,r){const i=null!=r?r:"\u2026",o=t+"",a=o.length,s=Math.max(0,e-i.length);return a<=e?o:"left"===n?i+o.slice(a-s):"center"===n?o.slice(0,Math.ceil(s/2))+i+o.slice(a-~~(s/2)):o.slice(0,s)+i},rgb:tg,lab:Gy,hcl:tv,hsl:sg,luminance:OM,contrast:function(t,e){const n=OM(t),r=OM(e);return(Math.max(n,r)+.05)/(Math.min(n,r)+.05)},sequence:nc,format:sR,utcFormat:lR,utcParse:hR,utcOffset:Lo,utcSequence:$o,timeFormat:uR,timeParse:cR,timeOffset:zo,timeSequence:Uo,timeUnitSpecifier:ji,monthFormat:function(t){return fR.call(this,t,1,"%B")},monthAbbrevFormat:function(t){return fR.call(this,t,1,"%b")},dayFormat:function(t){return fR.call(this,0,2+t,"%A")},dayAbbrevFormat:function(t){return fR.call(this,0,2+t,"%a")},quarter:function(t){return 1+~~(new Date(t).getMonth()/3)},utcquarter:function(t){return 1+~~(new Date(t).getUTCMonth()/3)},week:to,utcweek:ao,dayofyear:Ji,utcdayofyear:oo,warn:function(){return SM(this.context.dataflow,"warn",arguments)},info:function(){return SM(this.context.dataflow,"info",arguments)},debug:function(){return SM(this.context.dataflow,"debug",arguments)},extent:Sn,inScope:function(t){let e=this.context.group,n=!1;if(e)for(;t;){if(t===e){n=!0;break}t=t.mark.group}return n},intersect:function(t,e,n){if(!t)return[];const[r,i]=t,o=(new Bd).set(r[0],r[1],i[0],i[1]);return function(t,e,n){const r=[],i=(new Bd).union(e),o=t.marktype;return o?_b(t,i,n,r):"group"===o?Cb(t,i,n,r):Be("Intersect scene must be mark node or group item.")}(n||this.context.dataflow.scenegraph().root,o,function(t){let e=null;if(t){const n=mn(t.marktype),r=mn(t.markname);e=t=>(!n.length||n.some(e=>t.marktype===e))&&(!r.length||r.some(e=>t.name===e))}return e}(e))},clampRange:function(t,e,n){let r,i=t[0],o=t[1];return o<i&&(r=o,o=i,i=r),r=o-i,r>=n-e?[e,n]:[i=Math.min(Math.max(i,e),n-r),i+r]},pinchDistance:function(t){const e=t.touches,n=e[0].clientX-e[1].clientX,r=e[0].clientY-e[1].clientY;return Math.sqrt(n*n+r*r)},pinchAngle:function(t){const e=t.touches;return Math.atan2(e[0].clientY-e[1].clientY,e[0].clientX-e[1].clientX)},screen:function(){const t=IM();return t?t.screen:{}},containerSize:function(){const t=this.context.dataflow,e=t.container&&t.container();return e?[e.clientWidth,e.clientHeight]:[void 0,void 0]},windowSize:function(){const t=IM();return t?[t.innerWidth,t.innerHeight]:[void 0,void 0]},bandspace:function(t,e,n){return mm(t||0,e||0,n||0)},setdata:function(t,e){const n=this.context.dataflow;return n.pulse(this.context.data[t].input,n.changeset().remove(Ge).insert(e)),1},pathShape:function(t){let e=null;return function(n){return n?Hh(n,e=e||Fh(t)):t}},panLinear:function(t,e){return ln(t,e,nn,We)},panLog:function(t,e){var n=Math.sign(t[0]);return ln(t,e,on(n),rn(n))},panPow:function(t,e,n){return ln(t,e,un(n),un(1/n))},panSymlog:function(t,e,n){return ln(t,e,an(n),sn(n))},zoomLinear:hn,zoomLog:dn,zoomPow:fn,zoomSymlog:pn,encode:function(t,e,n){if(t){const n=this.context.dataflow;n.pulse(t.mark.source,n.changeset().encode(t,e))}return void 0!==n?n:t},modify:function(t,e,n,r,i,o){let a,s,u=this.context.dataflow,l=this.context.data[t],c=l.input,h=l.changes,d=u.stamp();if(!1===u._trigger||!(c.value.length||e||r))return 0;if((!h||h.stamp<d)&&(l.changes=h=u.changeset(),h.stamp=d,u.runAfter((function(){l.modified=!0,u.pulse(c,h).run()}),!0,1)),n&&(a=!0===n?Ge:Ye(n)||Kn(n)?n:TM(n),h.remove(a)),e&&h.insert(e),r&&(a=TM(r),c.value.some(a)?h.remove(a):h.insert(r)),i)for(s in o)h.modify(i,s,o[s]);return 1}},zM=["view","item","group","xy","x","y"],LM={},BM={blacklist:["_"],whitelist:["datum","event","item"],fieldvar:"datum",globalvar:t=>`_[${zn("$"+t)}]`,functions:function(t){const e=lI(t);zM.forEach(t=>e[t]="event.vega."+t);for(let n in jM)e[n]="this."+n;return kn(e,function(t,e,n){e.__bandwidth=t=>t&&t.bandwidth?t.bandwidth():0,n._bandwidth=hI,n._range=hI,n._scale=hI;const r=e=>"_["+("Literal"===e.type?zn("%"+e.value):zn("%")+"+"+t(e))+"]";return{_bandwidth:t=>`this.__bandwidth(${r(t[0])})`,_range:t=>r(t[0])+".range()",_scale:e=>`${r(e[0])}(${t(e[1])})`}}(t,jM,LM)),e},constants:uI,visitors:LM},UM=function(t){const e=(t=t||{}).whitelist?Vn(t.whitelist):{},n=t.blacklist?Vn(t.blacklist):{},r=t.constants||uI,i=(t.functions||lI)(h),o=t.globalvar,a=t.fieldvar,s=gn(o)?o:t=>`${o}["${t}"]`;let u={},l={},c=0;function h(t){if(Mn(t))return t;const e=d[t.type];return null==e&&Be("Unsupported type: "+t.type),e(t)}const d={Literal:t=>t.raw,Identifier:t=>{const i=t.name;return c>0?i:On(n,i)?Be("Illegal identifier: "+i):On(r,i)?r[i]:On(e,i)?i:(u[i]=1,s(i))},MemberExpression:t=>{const e=!t.computed,n=h(t.object);e&&(c+=1);const r=h(t.property);return n===a&&(l[function(t){const e=t&&t.length-1;return e&&('"'===t[0]&&'"'===t[e]||"'"===t[0]&&"'"===t[e])?t.slice(1,-1):t}(r)]=1),e&&(c-=1),n+(e?"."+r:"["+r+"]")},CallExpression:t=>{"Identifier"!==t.callee.type&&Be("Illegal callee type: "+t.callee.type);const e=t.callee.name,n=t.arguments,r=On(i,e)&&i[e];return r||Be("Unrecognized function: "+e),gn(r)?r(n):r+"("+n.map(h).join(",")+")"},ArrayExpression:t=>"["+t.elements.map(h).join(",")+"]",BinaryExpression:t=>"("+h(t.left)+t.operator+h(t.right)+")",UnaryExpression:t=>"("+t.operator+h(t.argument)+")",ConditionalExpression:t=>"("+h(t.test)+"?"+h(t.consequent)+":"+h(t.alternate)+")",LogicalExpression:t=>"("+h(t.left)+t.operator+h(t.right)+")",ObjectExpression:t=>"{"+t.properties.map(h).join(",")+"}",Property:t=>{c+=1;const e=h(t.key);return c-=1,e+":"+h(t.value)}};function f(t){const e={code:h(t),globals:Object.keys(u),fields:Object.keys(l)};return u={},l={},e}return f.functions=i,f.constants=r,f}(BM);function $M(t,e,n){return 1===arguments.length?jM[t]:(jM[t]=e,n&&(LM[t]=n),UM&&(UM.functions[t]="this."+t),this)}$M("bandwidth",(function(t,e){const n=fI(t,(e||this).context);return n&&n.bandwidth?n.bandwidth():0}),hI),$M("copy",(function(t,e){const n=fI(t,(e||this).context);return n?n.copy():void 0}),hI),$M("domain",(function(t,e){const n=fI(t,(e||this).context);return n?n.domain():[]}),hI),$M("range",(function(t,e){const n=fI(t,(e||this).context);return n&&n.range?n.range():[]}),hI),$M("invert",(function(t,e,n){const r=fI(t,(n||this).context);return r?Ye(e)?(r.invertRange||r.invert)(e):(r.invert||r.invertExtent)(e):void 0}),hI),$M("scale",(function(t,e,n){const r=fI(t,(n||this).context);return r?r(e):void 0}),hI),$M("gradient",(function(t,e,n,r,i){t=fI(t,(i||this).context);const o=function(t,e){var n,r=[];return n={gradient:"linear",x1:t?t[0]:0,y1:t?t[1]:0,x2:e?e[0]:1,y2:e?e[1]:0,stops:r,stop:function(t,e){return r.push({offset:t,color:e}),n}}}(e,n);let a=t.domain(),s=a[0],u=en(a),l=We;return u-s?l=_v(t,s,u):t=(t.interpolator?yy("sequential")().interpolator(t.interpolator()):yy("linear")().interpolate(t.interpolate()).range(t.range())).domain([s=0,u=1]),t.ticks&&(a=t.ticks(+r||15),s!==a[0]&&a.unshift(s),u!==en(a)&&a.push(u)),a.forEach(e=>o.stop(l(e),t(e))),o}),hI),$M("geoArea",_M,hI),$M("geoBounds",CM,hI),$M("geoCentroid",kM,hI),$M("geoShape",(function(t,e,n){const r=fI(t,(n||this).context);return function(t){return r?r.path.context(t)(e):""}}),hI),$M("indata",(function(t,e,n){const r=this.context.data[t]["index:"+e],i=r?r.value.get(n):void 0;return i?i.count:i}),(function(t,e,n,r){"Literal"!==e[0].type&&Be("First argument to indata must be a string literal."),"Literal"!==e[1].type&&Be("Second argument to indata must be a string literal.");const i=e[0].value,o=e[1].value,a="@"+o;On(a,r)||(r[a]=n.getData(i).indataRef(n,o))})),$M("data",oR,cI),$M("treePath",(function(t,e,n){const r=RM(t,this),i=r[e],o=r[n];return i&&o?i.path(o).map(DM):void 0}),cI),$M("treeAncestors",(function(t,e){const n=RM(t,this)[e];return n?n.ancestors().map(DM):void 0}),cI),$M("vlSelectionTest",(function(t,e,n){for(var r,i,o,a,s,u=this.context.data[t],l=u?u.values.value:[],c=u?u["index:unit"]&&u["index:unit"].value:void 0,h="intersect"===n,d=l.length,f=0;f<d;++f)if(r=l[f],c&&h){if(-1===(o=(i=i||{})[a=r.unit]||0))continue;if(s=MM(e,r),i[a]=s?-1:++o,s&&1===c.size)return!0;if(!s&&o===c.get(a).count)return!1}else if(h^(s=MM(e,r)))return s;return d&&h}),PM),$M("vlSelectionResolve",(function(t,e,n){for(var r,i,o,a,s,u,l,c,h,d,f=this.context.data[t],p=f?f.values.value:[],m={},g={},y={},v=p.length,b=0;b<v;++b){for(a=(r=p[b]).unit,o=r.values,h=0,d=(i=r.fields).length;h<d;++h)l=(u=m[(s=i[h]).field]||(m[s.field]={}))[a]||(u[a]=[]),y[s.field]=c=s.type.charAt(0),u[a]=(0,FM[c+"_union"])(l,mn(o[h]));n&&(l=g[a]||(g[a]=[])).push(mn(o).reduce((t,e,n)=>(t[i[n].field]=e,t),{}))}return e=e||"union",Object.keys(m).forEach((function(t){m[t]=Object.keys(m[t]).map(e=>m[t][e]).reduce((n,r)=>void 0===n?r:FM[y[t]+"_"+e](n,r))})),p=Object.keys(g),n&&p.length&&(m.vlMulti="union"===e?{or:p.reduce((t,e)=>(t.push.apply(t,g[e]),t),[])}:{and:p.map(t=>({or:g[t]}))}),m}),PM);var VM=function(t,e){let n,r,i={};try{t=Mn(t)?t:zn(t)+"",n=sI(t)}catch(o){Be("Expression parse error: "+t)}return n.visit(t=>{if("CallExpression"!==t.type)return;const n=t.callee.name,r=BM.visitors[n];r&&r(n,t.arguments,e,i)}),r=UM(n),r.globals.forEach(t=>{const n="$"+t;!On(i,n)&&e.getSignal(t)&&(i[n]=e.signalRef(t))}),{$expr:kn({code:r.code},e.options.ast?{ast:n}:null),$fields:r.fields,$params:i}};const WM=Vn(["rule"]),qM=Vn(["group","image","rect"]);function HM(t){return(t+"").toLowerCase()}function GM(t,e,n){";"!==n[n.length-1]&&(n="return("+n+");");var r=Function.apply(null,e.concat(n));return t&&t.functions?r.bind(t.functions):r}var XM={operator:(t,e)=>GM(t,["_"],e.code),parameter:(t,e)=>GM(t,["datum","_"],e.code),event:(t,e)=>GM(t,["event"],e.code),handler:(t,e)=>GM(t,["_","event"],`var datum=event.item&&event.item.datum;return ${e.code};`),encode:(t,e)=>{const{marktype:n,channels:r}=e;let i="var o=item,datum=o.datum,m=0,$;";for(const o in r){const t="o["+zn(o)+"]";i+=`$=${r[o].code};if(${t}!==$)${t}=$,m=1;`}return i+=function(t,e){let n="";return WM[e]||(t.x2&&(t.x?(qM[e]&&(n+="if(o.x>o.x2)$=o.x,o.x=o.x2,o.x2=$;"),n+="o.width=o.x2-o.x;"):n+="o.x=o.x2-(o.width||0);"),t.xc&&(n+="o.x=o.xc-(o.width||0)/2;"),t.y2&&(t.y?(qM[e]&&(n+="if(o.y>o.y2)$=o.y,o.y=o.y2,o.y2=$;"),n+="o.height=o.y2-o.y;"):n+="o.y=o.y2-(o.height||0);"),t.yc&&(n+="o.y=o.yc-(o.height||0)/2;")),n}(r,n),i+="return m;",GM(t,["item","_"],i)},codegen:{get(t){const e=`[${t.map(zn).join("][")}]`,n=Function("_",`return _${e};`);return n.path=e,n},comparator(t,e){let n;const r=Function("a","b","var u, v; return "+t.map((t,r)=>{const i=e[r];let o,a;return t.path?(o="a"+t.path,a="b"+t.path):((n=n||{})["f"+r]=t,o=`this.f${r}(a)`,a=`this.f${r}(b)`),function(t,e,n,r){return`((u = ${t}) < (v = ${e}) || u == null) && v != null ? ${n}\n  : (u > v || v == null) && u != null ? ${r}\n  : ((v = v instanceof Date ? +v : v), (u = u instanceof Date ? +u : u)) !== u && v === v ? ${n}\n  : v !== v && u === u ? ${r} : `}(o,a,-i,i)}).join("")+"0;");return n?r.bind(n):r}}};function KM(t,e,n){if(!t||!Ze(t))return t;for(let r,i=0,o=YM.length;i<o;++i)if(r=YM[i],On(t,r.key))return r.parse(t,e,n);return t}var YM=[{key:"$ref",parse:function(t,e){return e.get(t.$ref)||Be("Operator not defined: "+t.$ref)}},{key:"$key",parse:function(t,e){const n="k:"+t.$key+"_"+!!t.$flat;return e.fn[n]||(e.fn[n]=Fn(t.$key,t.$flat,e.expr.codegen))}},{key:"$expr",parse:function(t,e,n){t.$params&&e.parseParameters(t.$params,n);const r="e:"+t.$expr.code+"_"+t.$name;return e.fn[r]||(e.fn[r]=Me(e.parameterExpression(t.$expr),t.$fields,t.$name))}},{key:"$field",parse:function(t,e){if(!t.$field)return null;const n="f:"+t.$field+"_"+t.$name;return e.fn[n]||(e.fn[n]=$e(t.$field,t.$name,e.expr.codegen))}},{key:"$encode",parse:function(t,e){const n=t.$encode,r={};for(const i in n){const t=n[i];r[i]=Me(e.encodeExpression(t.$expr),t.$fields),r[i].output=t.$output}return r}},{key:"$compare",parse:function(t,e){const n="c:"+t.$compare+"_"+t.$order,r=mn(t.$compare).map(t=>t&&t.$tupleid?Yn:t);return e.fn[n]||(e.fn[n]=yn(r,t.$order,e.expr.codegen))}},{key:"$context",parse:function(t,e){return e}},{key:"$subflow",parse:function(t,e){const n=t.$subflow;return function(t,r,i){const o=e.fork().parse(n),a=o.get(n.operators[0].id),s=o.signals.parent;return s&&s.set(i),a.detachSubflow=()=>e.detach(o),a}}},{key:"$tupleid",parse:function(){return Yn}}],ZM={skip:!0},QM=function(t,e,n,r){return new JM(t,e,n,r)};function JM(t,e,n,r){this.dataflow=t,this.transforms=e,this.events=t.events.bind(t),this.expr=r||XM,this.signals={},this.scales={},this.nodes={},this.data={},this.fn={},n&&(this.functions=Object.create(n),this.functions.context=this)}function tF(t){this.dataflow=t.dataflow,this.transforms=t.transforms,this.events=t.events,this.expr=t.expr,this.signals=Object.create(t.signals),this.scales=Object.create(t.scales),this.nodes=Object.create(t.nodes),this.data=Object.create(t.data),this.fn=Object.create(t.fn),t.functions&&(this.functions=Object.create(t.functions),this.functions.context=this)}JM.prototype=tF.prototype={fork(){const t=new tF(this);return(this.subcontext||(this.subcontext=[])).push(t),t},detach(t){this.subcontext=this.subcontext.filter(e=>e!==t);const e=Object.keys(t.nodes);for(const n of e)t.nodes[n]._targets=null;for(const n of e)t.nodes[n].detach();t.nodes=null},get(t){return this.nodes[t]},set(t,e){return this.nodes[t]=e},add(t,e){const n=this,r=n.dataflow,i=t.value;if(n.set(t.id,e),"collect"===HM(t.type)&&i&&(i.$ingest?r.ingest(e,i.$ingest,i.$format):i.$request?r.preload(e,i.$request,i.$format):r.pulse(e,r.changeset().insert(i))),t.root&&(n.root=e),t.parent){var o=n.get(t.parent.$ref);o?(r.connect(o,[e]),e.targets().add(o)):(n.unresolved=n.unresolved||[]).push(()=>{o=n.get(t.parent.$ref),r.connect(o,[e]),e.targets().add(o)})}if(t.signal&&(n.signals[t.signal]=e),t.scale&&(n.scales[t.scale]=e),t.data)for(const a in t.data){const r=n.data[a]||(n.data[a]={});t.data[a].forEach(t=>r[t]=e)}},resolve(){return(this.unresolved||[]).forEach(t=>t()),delete this.unresolved,this},operator(t,e){this.add(t,this.dataflow.add(t.value,e))},transform(t,e){this.add(t,this.dataflow.add(this.transforms[HM(e)]))},stream(t,e){this.set(t.id,e)},update(t,e,n,r,i){this.dataflow.on(e,n,r,i,t.options)},operatorExpression(t){return this.expr.operator(this,t)},parameterExpression(t){return this.expr.parameter(this,t)},eventExpression(t){return this.expr.event(this,t)},handlerExpression(t){return this.expr.handler(this,t)},encodeExpression(t){return this.expr.encode(this,t)},parse:function(t){const e=this,n=t.operators||[];return t.background&&(e.background=t.background),t.eventConfig&&(e.eventConfig=t.eventConfig),t.locale&&(e.locale=t.locale),n.forEach(t=>e.parseOperator(t)),n.forEach(t=>e.parseOperatorParameters(t)),(t.streams||[]).forEach(t=>e.parseStream(t)),(t.updates||[]).forEach(t=>e.parseUpdate(t)),e.resolve()},parseOperator:function(t){"operator"!==HM(t.type)&&t.type?this.transform(t,t.type):this.operator(t,t.update?this.operatorExpression(t.update):null)},parseOperatorParameters:function(t){const e=this;if(t.params){const n=e.get(t.id);n||Be("Invalid operator id: "+t.id),e.dataflow.connect(n,n.parameters(e.parseParameters(t.params),t.react,t.initonly))}},parseParameters:function(t,e){e=e||{};const n=this;for(const r in t){const i=t[r];e[r]=Ye(i)?i.map(t=>KM(t,n,e)):KM(i,n,e)}return e},parseStream:function(t){var e,n=this,r=null!=t.filter?n.eventExpression(t.filter):void 0,i=null!=t.stream?n.get(t.stream):void 0;t.source?i=n.events(t.source,t.type,r):t.merge&&(i=(e=t.merge.map(t=>n.get(t)))[0].merge.apply(e[0],e.slice(1))),t.between&&(e=t.between.map(t=>n.get(t)),i=i.between(e[0],e[1])),t.filter&&(i=i.filter(r)),null!=t.throttle&&(i=i.throttle(+t.throttle)),null!=t.debounce&&(i=i.debounce(+t.debounce)),null==i&&Be("Invalid stream definition: "+JSON.stringify(t)),t.consume&&i.consume(!0),n.stream(t,i)},parseUpdate:function(t){var e,n=Ze(n=t.source)?n.$ref:n,r=this.get(n),i=t.update,o=void 0;r||Be("Source not defined: "+t.source),e=t.target&&t.target.$expr?this.eventExpression(t.target.$expr):this.get(t.target),i&&i.$expr&&(i.$params&&(o=this.parseParameters(i.$params)),i=this.handlerExpression(i.$expr)),this.update(t,r,e,i,o)},getState:function(t){var e=this,n={};if(t.signals){var r=n.signals={};Object.keys(e.signals).forEach(n=>{var i=e.signals[n];t.signals(n,i)&&(r[n]=i.value)})}if(t.data){var i=n.data={};Object.keys(e.data).forEach(n=>{var r=e.data[n];t.data(n,r)&&(i[n]=r.input.value)})}return e.subcontext&&!1!==t.recurse&&(n.subcontext=e.subcontext.map(e=>e.getState(t))),n},setState:function(t){var e=this,n=e.dataflow,r=t.data,i=t.signals;Object.keys(i||{}).forEach(t=>{n.update(e.signals[t],i[t],ZM)}),Object.keys(r||{}).forEach(t=>{n.pulse(e.data[t].input,n.changeset().remove(Ge).insert(r[t]))}),(t.subcontext||[]).forEach((t,n)=>{var r=e.subcontext[n];r&&r.setState(t)})}};var eF={skip:!0};function nF(t,e){var n=t.autosize(),r=t.padding();return e-(n&&"padding"===n.contains?r.left+r.right:0)}function rF(t,e){var n=t.autosize(),r=t.padding();return e-(n&&"padding"===n.contains?r.top+r.bottom:0)}function iF(t,e){return e.modified&&Ye(e.input.value)&&t.indexOf("_:vega:_")}function oF(t,e){return!("parent"===t||e instanceof Gs.proxy)}var aF=function(t,e,n,r){var i=t.element();i&&i.setAttribute("title",function(t){return null==t?"":Ye(t)?sF(t):Ze(t)&&!Rn(t)?(e=t,Object.keys(e).map((function(t){var n=e[t];return t+": "+(Ye(n)?sF(n):uF(n))})).join("\n")):t+"";var e}(r))};function sF(t){return"["+t.map(uF).join(", ")+"]"}function uF(t){return Ye(t)?"[\u2026]":Ze(t)&&!Rn(t)?"{\u2026}":t}function lF(t,e){const n=this;if(e=e||{},Ws.call(n),e.loader&&n.loader(e.loader),e.logger&&n.logger(e.logger),null!=e.logLevel&&n.logLevel(e.logLevel),e.locale||t.locale){const r=kn({},t.locale,e.locale);n.locale(Os(r.number,r.time))}n._el=null,n._elBind=null,n._renderType=e.renderer||"canvas",n._scenegraph=new Up;const r=n._scenegraph.root;n._renderer=null,n._tooltip=e.tooltip||aF,n._redraw=!0,n._handler=(new am).scene(r),n._globalCursor=!1,n._preventDefault=!1,n._timers=[],n._eventListeners=[],n._resizeListeners=[],n._eventConfig=function(t){const e=kn({defaults:{}},t),n=(t,e)=>{e.forEach(e=>{Ye(t[e])&&(t[e]=Vn(t[e]))})};return n(e.defaults,["prevent","allow"]),n(e,["view","window","selector"]),e}(t.eventConfig),n.globalCursor(n._eventConfig.globalCursor);const i=function(t,e,n){return QM(t,Gs,jM,n).parse(e)}(n,t,e.expr);n._runtime=i,n._signals=i.signals,n._bind=(t.bindings||[]).map(t=>({state:null,param:kn({},t)})),i.root&&i.root.set(r),r.source=i.data.root.input,n.pulse(i.data.root.input,n.changeset().insert(r.items)),n._width=n.width(),n._height=n.height(),n._viewWidth=nF(n,n._width),n._viewHeight=rF(n,n._height),n._origin=[0,0],n._resize=0,n._autosize=1,function(t){var e=t._signals,n=e.width,r=e.height,i=e.padding;function o(){t._autosize=t._resize=1}t._resizeWidth=t.add(null,(function(e){t._width=e.size,t._viewWidth=nF(t,e.size),o()}),{size:n}),t._resizeHeight=t.add(null,(function(e){t._height=e.size,t._viewHeight=rF(t,e.size),o()}),{size:r});var a=t.add(null,o,{pad:i});t._resizeWidth.rank=n.rank+1,t._resizeHeight.rank=r.rank+1,a.rank=i.rank+1}(n),function(t){t.add(null,e=>(t._background=e.bg,t._resize=1,e.bg),{bg:t._signals.background})}(n),function(t){const e=t._signals.cursor||(t._signals.cursor=t.add({user:"default",item:null}));t.on(t.events("view","mousemove"),e,(function(t,n){const r=e.value,i=r?Mn(r)?r:r.user:"default",o=n.item&&n.item.cursor||null;return r&&i===r.user&&o==r.item?r:{user:i,item:o}})),t.add(null,(function(e){let n=e.cursor,r=this.value;return Mn(n)||(r=n.item,n=n.user),FD(t,n&&"default"!==n?n:r||n),r}),{cursor:e})}(n),n.description(t.description),e.hover&&n.hover(),e.container&&n.initialize(e.container,e.bind)}function cF(t,e){return On(t._signals,e)?t._signals[e]:Be("Unrecognized signal name: "+zn(e))}function hF(t,e){const n=(t._targets||[]).filter(t=>t._update&&t._update.handler===e);return n.length?n[0]:null}function dF(t,e,n,r){var i=hF(n,r);return i||((i=tR(t,()=>r(e,n.value))).handler=r,t.on(n,null,i)),t}function fF(t,e,n){var r=hF(e,n);return r&&e._targets.remove(r),t}Tn(lF,Ws,{async evaluate(t,e,n){if(await Ws.prototype.evaluate.call(this,t,e),this._redraw||this._resize)try{this._renderer&&(this._resize&&(this._resize=0,i=BD(r=this),o=zD(r),a=LD(r),r._renderer.background(r.background()),r._renderer.resize(o,a,i),r._handler.origin(i),r._resizeListeners.forEach((function(t){try{t(o,a)}catch(e){r.error(e)}}))),await this._renderer.renderAsync(this._scenegraph.root)),this._redraw=!1}catch(s){this.error(s)}var r,i,o,a;return n&&Hn(this,n),this},dirty(t){this._redraw=!0,this._renderer&&this._renderer.dirty(t)},description(t){if(arguments.length){const e=null!=t?t+"":null;return e!==this._desc&&MD(this._el,this._desc=e),this}return this._desc},container(){return this._el},scenegraph(){return this._scenegraph},origin(){return this._origin.slice()},signal(t,e,n){var r=cF(this,t);return 1===arguments.length?r.value:this.update(r,e,n)},width(t){return arguments.length?this.signal("width",t):this.signal("width")},height(t){return arguments.length?this.signal("height",t):this.signal("height")},padding(t){return arguments.length?this.signal("padding",rR(t)):rR(this.signal("padding"))},autosize(t){return arguments.length?this.signal("autosize",t):this.signal("autosize")},background(t){return arguments.length?this.signal("background",t):this.signal("background")},renderer(t){return arguments.length?(xb(t)||Be("Unrecognized renderer type: "+t),t!==this._renderType&&(this._renderType=t,this._resetRenderer()),this):this._renderType},tooltip(t){return arguments.length?(t!==this._tooltip&&(this._tooltip=t,this._resetRenderer()),this):this._tooltip},loader(t){return arguments.length?(t!==this._loader&&(Ws.prototype.loader.call(this,t),this._resetRenderer()),this):this._loader},resize(){return this._autosize=1,this.touch(cF(this,"autosize"))},_resetRenderer(){this._renderer&&(this._renderer=null,this.initialize(this._el,this._elBind))},_resizeView:function(t,e,n,r,i,o){this.runAfter((function(a){var s=0;a._autosize=0,a.width()!==n&&(s=1,a.signal("width",n,eF),a._resizeWidth.skip(!0)),a.height()!==r&&(s=1,a.signal("height",r,eF),a._resizeHeight.skip(!0)),a._viewWidth!==t&&(a._resize=1,a._viewWidth=t),a._viewHeight!==e&&(a._resize=1,a._viewHeight=e),a._origin[0]===i[0]&&a._origin[1]===i[1]||(a._resize=1,a._origin=i),s&&a.run("enter"),o&&a.runAfter(t=>t.resize())}),!1,1)},addEventListener(t,e,n){var r=e;return n&&!1===n.trap||((r=tR(this,e)).raw=e),this._handler.on(t,r),this},removeEventListener(t,e){for(var n,r,i=this._handler.handlers(t),o=i.length;--o>=0;)if(n=i[o].handler,t===(r=i[o].type)&&(e===n||e===n.raw)){this._handler.off(r,n);break}return this},addResizeListener(t){var e=this._resizeListeners;return e.indexOf(t)<0&&e.push(t),this},removeResizeListener(t){var e=this._resizeListeners,n=e.indexOf(t);return n>=0&&e.splice(n,1),this},addSignalListener(t,e){return dF(this,t,cF(this,t),e)},removeSignalListener(t,e){return fF(this,cF(this,t),e)},addDataListener(t,e){return dF(this,t,PD(this,t).values,e)},removeDataListener(t,e){return fF(this,PD(this,t).values,e)},globalCursor(t){if(arguments.length){if(this._globalCursor!==!!t){const e=FD(this,null);this._globalCursor=!!t,e&&FD(this,e)}return this}return this._globalCursor},preventDefault(t){return arguments.length?(this._preventDefault=t,this):this._preventDefault},timer:function(t,e){this._timers.push(function(t,e,n){var r=new Zk,i=e;return null==e?(r.restart(t,e,n),r):(e=+e,n=null==n?Kk():+n,r.restart((function o(a){a+=i,r.restart(o,i+=e,n),t(a)}),e,n),r)}((function(e){t({timestamp:Date.now(),elapsed:e})}),e))},events:function(t,e,n){var r,i=this,o=new hr(n),a=function(n,r){i.runAsync(null,()=>{"view"===t&&function(t,e){var n=t._eventConfig.defaults,r=n.prevent,i=n.allow;return!1!==r&&!0!==i&&(!0===r||!1===i||(r?r[e]:i?!i[e]:t.preventDefault()))}(i,e)&&n.preventDefault(),o.receive(function(t,e,n){var r,i,o=t._renderer,a=o&&o.canvas();return a&&(i=BD(t),(r=Xp(e.changedTouches?e.changedTouches[0]:e,a))[0]-=i[0],r[1]-=i[1]),e.dataflow=t,e.item=n,e.vega=function(t,e,n){var r=e?"group"===e.mark.marktype?e:e.mark.group:null;function i(t){var n,i=r;if(t)for(n=e;n;n=n.mark.group)if(n.mark.name===t){i=n;break}return i&&i.mark&&i.mark.interactive?i:{}}function o(t){if(!t)return n;Mn(t)&&(t=i(t));for(var e=n.slice();t;)e[0]-=t.x||0,e[1]-=t.y||0,t=t.mark&&t.mark.group;return e}return{view:_n(t),item:_n(e||{}),group:i,xy:o,x:function(t){return o(t)[0]},y:function(t){return o(t)[1]}}}(t,n,r),e}(i,n,r))})};if("timer"===t)$D(i,"timer",e)&&i.timer(a,e);else if("view"===t)$D(i,"view",e)&&i.addEventListener(e,a,UD);else if("window"===t?$D(i,"window",e)&&"undefined"!=typeof window&&(r=[window]):"undefined"!=typeof document&&$D(i,"selector",e)&&(r=document.querySelectorAll(t)),r){for(var s=0,u=r.length;s<u;++s)r[s].addEventListener(e,a);i._eventListeners.push({type:e,sources:r,handler:a})}else i.warn("Can not resolve event source: "+t);return o},finalize:function(){var t,e,n,r=this._tooltip,i=this._timers,o=this._eventListeners;for(t=i.length;--t>=0;)i[t].stop();for(t=o.length;--t>=0;)for(e=(n=o[t]).sources.length;--e>=0;)n.sources[e].removeEventListener(n.type,n.handler);return r&&r.call(this,this._handler,null,null,null),this},hover:function(t,e){return e=[e||"update",(t=[t||"hover"])[0]],this.on(this.events("view","mouseover",VD),WD,qD(t)),this.on(this.events("view","mouseout",VD),WD,qD(e)),this},data:function(t,e){return arguments.length<2?PD(this,t).values.value:jD.call(this,t,ir().remove(Ge).insert(e))},change:jD,insert:function(t,e){return jD.call(this,t,ir().insert(e))},remove:function(t,e){return jD.call(this,t,ir().remove(e))},scale:function(t){var e=this._runtime.scales;return On(e,t)||Be("Unrecognized scale or projection: "+t),e[t].value},initialize:function(t,e){const n=this,r=n._renderType,i=n._eventConfig.bind,o=xb(r);t=n._el=t?eR(n,t):null,function(t){const e=t.container();e&&(e.setAttribute("role","graphics-document"),e.setAttribute("aria-roleDescription","visualization"),MD(e,t.description()))}(n),o||n.error("Unrecognized renderer type: "+r);const a=o.handler||am,s=t?o.renderer:o.headless;return n._renderer=s?JD(n,n._renderer,t,s):null,n._handler=function(t,e,n,r){var i=new r(t.loader(),tR(t,t.tooltip())).scene(t.scenegraph().root).initialize(n,BD(t),t);return e&&e.handlers().forEach((function(t){i.on(t.type,t.handler)})),i}(n,n._handler,t,a),n._redraw=!0,t&&"none"!==i&&(e=e?n._elBind=eR(n,e):t.appendChild(HD("form",{class:"vega-bindings"})),n._bind.forEach((function(t){t.param.element&&"container"!==i&&(t.element=eR(n,t.param.element))})),n._bind.forEach((function(t){!function(t,e,n){if(!e)return;const r=n.param;let i=n.state;i||(i=n.state={elements:null,active:!1,set:null,update:e=>{e!==t.signal(r.signal)&&t.runAsync(null,(function(){i.source=!0,t.signal(r.signal,e)}))}},r.debounce&&(i.update=Cn(r.debounce,i.update))),function(t,e,n,r){const i=HD("div",{class:"vega-bind"}),o="radio"===n.input?i:i.appendChild(HD("label"));o.appendChild(HD("span",{class:"vega-bind-name"},n.name||n.signal)),e.appendChild(i);let a=GD;switch(n.input){case"checkbox":a=XD;break;case"select":a=KD;break;case"radio":a=YD;break;case"range":a=ZD}a(t,o,n,r)}(i,e,r,t.signal(r.signal)),i.active||(t.on(t._signals[r.signal],null,()=>{i.source?i.source=!1:i.set(t.signal(r.signal))}),i.active=!0)}(n,t.element||e,t)}))),n},toImageURL:async function(t,e){"canvas"!==t&&"svg"!==t&&"png"!==t&&Be("Unrecognized image type: "+t);const n=await iR(this,t,e);return"svg"===t?(r=n.svg(),i=new Blob([r],{type:"image/svg+xml"}),window.URL.createObjectURL(i)):n.canvas().toDataURL("image/png");var r,i},toCanvas:async function(t,e){return(await iR(this,"canvas",t,e)).canvas()},toSVG:async function(t){return(await iR(this,"svg",t)).svg()},getState:function(t){return this._runtime.getState(t||{data:iF,signals:oF,recurse:!0})},setState:function(t){return this.runAsync(null,e=>{e._trigger=!1,e._runtime.setState(t)},t=>{t._trigger=!0}),this}});var pF=function(t){return Ze(t)?t:{type:t||"pad"}};const mF=t=>+t||0;var gF=function(t){return Ze(t)?t.signal?t:{top:mF(t.top),bottom:mF(t.bottom),left:mF(t.left),right:mF(t.right)}:{top:e=mF(t),bottom:e,left:e,right:e};var e};const yF=t=>Ze(t)&&!Ye(t)?kn({},t):{value:t};function vF(t,e,n,r){return null!=n?(Ze(n)&&!Ye(n)||Ye(n)&&n.length&&Ze(n[0])?t.update[e]=n:t[r||"enter"][e]={value:n},1):0}function bF(t,e,n){for(const r in e)vF(t,r,e[r]);for(const r in n)vF(t,r,n[r],"update")}function wF(t,e,n){for(const r in e)n&&On(n,r)||(t[r]=kn(t[r]||{},e[r]));return t}function xF(t,e){return e&&(e.enter&&e.enter[t]||e.update&&e.update[t])}function _F(t,e,n){t[e]=n&&n.signal?{signal:n.signal}:{value:n}}const CF=t=>Mn(t)?zn(t):t.signal?`(${t.signal})`:OF(t);function kF(t){if(null!=t.gradient)return function(t){const e=[t.start,t.stop,t.count].map(t=>null==t?null:zn(t));for(;e.length&&null==en(e);)e.pop();return e.unshift(CF(t.gradient)),`gradient(${e.join(",")})`}(t);let e=t.signal?`(${t.signal})`:t.color?function(t){return t.c?SF("hcl",t.h,t.c,t.l):t.h||t.s?SF("hsl",t.h,t.s,t.l):t.l||t.a?SF("lab",t.l,t.a,t.b):t.r||t.g||t.b?SF("rgb",t.r,t.g,t.b):null}(t.color):null!=t.field?OF(t.field):void 0!==t.value?zn(t.value):void 0;return null!=t.scale&&(e=function(t,e){const n=CF(t.scale);return null!=t.range?e=`lerp(_range(${n}), ${+t.range})`:(void 0!==e&&(e=`_scale(${n}, ${e})`),t.band&&(e=(e?e+"+":"")+`_bandwidth(${n})`+(1==+t.band?"":"*"+EF(t.band)),t.extra&&(e=`(datum.extra ? _scale(${n}, datum.extra.value) : ${e})`)),null==e&&(e="0")),e}(t,e)),void 0===e&&(e=null),null!=t.exponent&&(e=`pow(${e},${EF(t.exponent)})`),null!=t.mult&&(e+="*"+EF(t.mult)),null!=t.offset&&(e+="+"+EF(t.offset)),t.round&&(e=`round(${e})`),e}const SF=(t,e,n,r)=>`(${t}(${[e,n,r].map(kF).join(",")})+'')`;function EF(t){return Ze(t)?"("+kF(t)+")":t}function OF(t){return function t(e){let n,r,i;if(e.signal)n="datum",i=e.signal;else if(e.group||e.parent){for(r=Math.max(1,e.level||1),n="item";r-- >0;)n+=".mark.group";e.parent?(i=e.parent,n+=".datum"):i=e.group}else e.datum?(n="datum",i=e.datum):Be("Invalid field reference: "+zn(e));return e.signal||(i=Mn(i)?Ue(i).map(zn).join("]["):t(i)),n+"["+i+"]"}(Ze(t)?t:{datum:t})}var AF=function(t,e,n,r,i,o){const a={};(o=o||{}).encoders={$encode:a},t=function(t,e,n,r,i){const o={},a={};let s,u,l,c;for(u in u="lineBreak","text"!==e||null==i[u]||xF(u,t)||_F(o,u,i[u]),("legend"==n||String(n).startsWith("axis"))&&(n=null),c="frame"===n?i.group:"mark"===n?kn({},i.mark,i[e]):null,c)l=xF(u,t)||("fill"===u||"stroke"===u)&&(xF("fill",t)||xF("stroke",t)),l||_F(o,u,c[u]);for(u in mn(r).forEach(e=>{const n=i.style&&i.style[e];for(const r in n)xF(r,t)||_F(o,r,n[r])}),t=kn({},t),o)c=o[u],c.signal?(s=s||{})[u]=c:a[u]=c;return t.enter=kn(a,t.enter),s&&(t.update=kn(s,t.update)),t}(t,e,n,r,i.config);for(const s in t)a[s]=NF(t[s],e,o,i);return o};function NF(t,e,n,r){const i={},o={};for(const s in t)null!=t[s]&&(i[s]=TF(Ye(a=t[s])?function(t){let e="";return t.forEach(t=>{const n=kF(t);e+=t.test?`(${t.test})?${n}:`:n}),":"===en(e)&&(e+="null"),e}(a):kF(a),r,n,o));var a;return{$expr:{marktype:e,channels:i},$fields:Object.keys(o),$output:Object.keys(t)}}function TF(t,e,n,r){const i=VM(t,e);return i.$fields.forEach(t=>r[t]=1),kn(n,i.$params),i.$expr}const DF=["value","update","init","react","bind"];function RF(t,e){Be(t+' for "outer" push: '+zn(e))}var IF=function(t,e){const n=t.name;if("outer"===t.push)e.signals[n]||RF("No prior signal definition",n),DF.forEach(e=>{void 0!==t[e]&&RF("Invalid property ",e)});else{const r=e.addSignal(n,t.value);!1===t.react&&(r.react=!1),t.bind&&e.addBinding(n,t.bind)}};function MF(t,e,n,r){this.id=-1,this.type=t,this.value=e,this.params=n,r&&(this.parent=r)}function FF(t,e,n,r){return new MF(t,e,n,r)}function PF(t,e){return FF("operator",t,e)}function jF(t){const e={$ref:t.id};return t.id<0&&(t.refs=t.refs||[]).push(e),e}function zF(t,e){return e?{$field:t,$name:e}:{$field:t}}const LF=zF("key");function BF(t,e){return{$compare:t,$order:e}}function UF(t,e){return(t&&t.signal?"$"+t.signal:t||"")+(t&&e?"_":"")+(e&&e.signal?"$"+e.signal:e||"")}function $F(t){return t&&t.signal}function VF(t){if($F(t))return!0;if(Ze(t))for(const e in t)if(VF(t[e]))return!0;return!1}function WF(t,e){return null!=t?t:e}function qF(t){return t&&t.signal||t}function HF(t,e){return(t.merge?GF:t.stream?XF:t.type?KF:Be("Invalid stream specification: "+zn(t)))(t,e)}function GF(t,e){const n=YF({merge:t.merge.map(t=>HF(t,e))},t,e);return e.addStream(n).id}function XF(t,e){const n=YF({stream:HF(t.stream,e)},t,e);return e.addStream(n).id}function KF(t,e){let n,r;var i;return"timer"===t.type?(n=e.event("timer",t.throttle),t={between:t.between,filter:t.filter}):n=e.event("scope"===(i=t.source)?"view":i||"view",t.type),r=YF({stream:n},t,e),1===Object.keys(r).length?n:e.addStream(r).id}function YF(t,e,n){let r=e.between;return r&&(2!==r.length&&Be('Stream "between" parameter must have 2 entries: '+zn(e)),t.between=[HF(r[0],n),HF(r[1],n)]),r=e.filter?[].concat(e.filter):[],(e.marktype||e.markname||e.markrole)&&r.push(function(t,e,n){const r="event.item";return r+(t&&"*"!==t?"&&"+r+".mark.marktype==='"+t+"'":"")+(n?"&&"+r+".mark.role==='"+n+"'":"")+(e?"&&"+r+".mark.name==='"+e+"'":"")}(e.marktype,e.markname,e.markrole)),"scope"===e.source&&r.push("inScope(event.item)"),r.length&&(t.filter=VM("("+r.join(")&&(")+")",n).$expr),null!=(r=e.throttle)&&(t.throttle=+r),null!=(r=e.debounce)&&(t.debounce=+r),e.consume&&(t.consume=!0),t}var ZF=function(t,e,n){return QF=e||tP,JF=n||nP,iP(t.trim()).map(oP)};let QF,JF,tP="view",eP=/[[\]{}]/,nP={"*":1,arc:1,area:1,group:1,image:1,line:1,path:1,rect:1,rule:1,shape:1,symbol:1,text:1,trail:1};function rP(t,e,n,r,i){let o,a=0,s=t.length;for(;e<s;++e){if(o=t[e],!a&&o===n)return e;i&&i.indexOf(o)>=0?--a:r&&r.indexOf(o)>=0&&++a}return e}function iP(t){let e=[],n=0,r=t.length,i=0;for(;i<r;)i=rP(t,i,",","[{","]}"),e.push(t.substring(n,i).trim()),n=++i;if(0===e.length)throw"Empty event selector: "+t;return e}function oP(t){return"["===t[0]?function(t){let e,n,r=t.length,i=1;if(i=rP(t,i,"]","[","]"),i===r)throw"Empty between selector: "+t;if(e=iP(t.substring(1,i)),2!==e.length)throw"Between selector must have two elements: "+t;if(">"!==(t=t.slice(i+1).trim())[0])throw"Expected '>' after between selector: "+t;return e=e.map(oP),n=oP(t.slice(1).trim()),n.between?{between:e,stream:n}:(n.between=e,n)}(t):function(t){let e,n,r={source:QF},i=[],o=[0,0],a=0,s=0,u=t.length,l=0;if("}"===t[u-1]){if(l=t.lastIndexOf("{"),!(l>=0))throw"Unmatched right brace: "+t;try{o=function(t){const e=t.split(",");if(!t.length||e.length>2)throw t;return e.map((function(e){const n=+e;if(n!=n)throw t;return n}))}(t.substring(l+1,u-1))}catch(c){throw"Invalid throttle specification: "+t}u=(t=t.slice(0,l).trim()).length,l=0}if(!u)throw t;if("@"===t[0]&&(a=++l),e=rP(t,l,":"),e<u&&(i.push(t.substring(s,e).trim()),s=l=++e),l=rP(t,l,"["),l===u)i.push(t.substring(s,u).trim());else if(i.push(t.substring(s,l).trim()),n=[],s=++l,s===u)throw"Unmatched left bracket: "+t;for(;l<u;){if(l=rP(t,l,"]"),l===u)throw"Unmatched left bracket: "+t;if(n.push(t.substring(s,l).trim()),l<u-1&&"["!==t[++l])throw"Expected left bracket: "+t;s=++l}if(!(u=i.length)||eP.test(i[u-1]))throw"Invalid event selector: "+t;return u>1?(r.type=i[1],a?r.markname=i[0].slice(1):JF[i[0]]?r.marktype=i[0]:r.source=i[0]):r.type=i[0],"!"===r.type.slice(-1)&&(r.consume=!0,r.type=r.type.slice(0,-1)),null!=n&&(r.filter=n),o[0]&&(r.throttle=o[0]),o[1]&&(r.debounce=o[1]),r}(t)}const aP={code:"_.$value",ast:{type:"Identifier",value:"value"}};function sP(t){return{signal:"["+t.map(t=>t.scale?'scale("'+t.scale+'")':t.signal)+"]"}}const uP=t=>(e,n,r)=>FF(t,n,e||void 0,r),lP=uP("aggregate"),cP=uP("axisticks"),hP=uP("bound"),dP=uP("collect"),fP=uP("compare"),pP=uP("datajoin"),mP=uP("encode"),gP=uP("expression"),yP=(uP("extent"),uP("facet")),vP=uP("field"),bP=uP("key"),wP=uP("legendentries"),xP=uP("load"),_P=uP("mark"),CP=uP("multiextent"),kP=uP("multivalues"),SP=uP("overlap"),EP=uP("params"),OP=uP("prefacet"),AP=uP("projection"),NP=uP("proxy"),TP=uP("relay"),DP=uP("render"),RP=uP("scale"),IP=uP("sieve"),MP=uP("sortitems"),FP=uP("viewlayout"),PP=uP("values");let jP=0;const zP={min:"min",max:"max",count:"sum"};function LP(t,e){return Ze(t)?t.signal?e.signalRef(t.signal):Be("Unsupported object: "+zn(t)):t}function BP(t,e){return t.signal?e.signalRef(t.signal):t.map(t=>LP(t,e))}function UP(t){Be("Can not find data set: "+zn(t))}function $P(t,e,n){if(t)return t.signal?n.signalRef(t.signal):(Ye(t)?VP:t.fields?qP:WP)(t,e,n);null==e.domainMin&&null==e.domainMax||Be("No scale domain defined for domainMin/domainMax to override.")}function VP(t,e,n){return t.map(t=>LP(t,n))}function WP(t,e,n){const r=n.getData(t.data);return r||UP(t.data),xy(e.type)?r.valuesRef(n,t.field,GP(t.sort,!1)):Sy(e.type)?r.domainRef(n,t.field):r.extentRef(n,t.field)}function qP(t,e,n){const r=t.data,i=t.fields.reduce((function(t,e){return e=Mn(e)?{data:r,field:e}:Ye(e)||e.signal?function(t,e){const n="_:vega:_"+jP++,r=dP({});if(Ye(t))r.value={$ingest:t};else if(t.signal){const i="setdata("+zn(n)+","+t.signal+")";r.params.input=e.signalRef(i)}return e.addDataPipeline(n,[r,IP({})]),{data:n,field:"data"}}(e,n):e,t.push(e),t}),[]);return(xy(e.type)?HP:Sy(e.type)?XP:KP)(t,n,i)}function HP(t,e,n){let r,i,o,a,s,u=GP(t.sort,!0);return r=n.map(t=>{const n=e.getData(t.data);return n||UP(t.data),n.countsRef(e,t.field,u)}),i={groupby:LF,pulse:r},u&&(o=u.op||"count",s=u.field?UF(o,u.field):"count",i.ops=[zP[o]],i.fields=[e.fieldRef(s)],i.as=[s]),o=e.add(lP(i)),a=e.add(dP({pulse:jF(o)})),s=e.add(PP({field:LF,sort:e.sortRef(u),pulse:jF(a)})),jF(s)}function GP(t,e){return t&&(t.field||t.op?t.field||"count"===t.op?e&&t.field&&t.op&&!zP[t.op]&&Be("Multiple domain scales can not be sorted using "+t.op):Be("No field provided for sort aggregate op: "+t.op):Ze(t)?t.field="key":t={field:"key"}),t}function XP(t,e,n){const r=n.map(t=>{const n=e.getData(t.data);return n||UP(t.data),n.domainRef(e,t.field)});return jF(e.add(kP({values:r})))}function KP(t,e,n){const r=n.map(t=>{const n=e.getData(t.data);return n||UP(t.data),n.extentRef(e,t.field)});return jF(e.add(CP({extents:r})))}function YP(t,e,n){return Ye(t)?t.map(t=>YP(t,e,n)):Ze(t)?t.signal?n.signalRef(t.signal):"fit"===e?t:Be("Unsupported parameter object: "+zn(t)):t}const ZP="value",QP=["size","shape","fill","stroke","strokeWidth","strokeDash","opacity"],JP={name:1,style:1,interactive:1},tj={value:0},ej={value:1};var nj=function(t){return t.type="group",t.interactive=t.interactive||!1,t};function rj(t,e){const n=(n,r)=>WF(t[n],WF(e[n],r));return n.isVertical=n=>"vertical"===WF(t.direction,e.direction||(n?e.symbolDirection:e.gradientDirection)),n.gradientLength=()=>WF(t.gradientLength,e.gradientLength||e.gradientWidth),n.gradientThickness=()=>WF(t.gradientThickness,e.gradientThickness||e.gradientHeight),n.entryColumns=()=>WF(t.columns,WF(e.columns,+n.isVertical(!0))),n}function ij(t,e){const n=e&&(e.update&&e.update[t]||e.enter&&e.enter[t]);return n&&n.signal?n:n?n.value:null}function oj(t,e,n){return`item.anchor === 'start' ? ${t} : item.anchor === 'end' ? ${e} : ${n}`}const aj=oj(zn("left"),zn("right"),zn("center"));function sj(t,e){return e?t?Ze(t)?Object.assign({},t,{offset:sj(t.offset,e)}):{value:t,offset:e}:e:t}var uj=function(t,e){return e?(t.name=e.name,t.style=e.style||t.style,t.interactive=!!e.interactive,t.encode=wF(t.encode,e,JP)):t.interactive=!1,t},lj=function(t,e,n,r){let i,o,a,s,u,l,c=rj(t,n),h=c.isVertical(),d=c.gradientThickness(),f=c.gradientLength();return h?(a=[0,1],s=[0,0],u=d,l=f):(a=[0,0],s=[1,0],u=f,l=d),i={enter:o={opacity:tj,x:tj,y:tj,width:yF(u),height:yF(l)},update:kn({},o,{opacity:ej,fill:{gradient:e,start:a,stop:s}}),exit:{opacity:tj}},bF(i,{stroke:c("gradientStrokeColor"),strokeWidth:c("gradientStrokeWidth")},{opacity:c("gradientOpacity")}),uj({type:"rect",role:"legend-gradient",encode:i},r)},cj=function(t,e,n,r,i){let o,a,s,u,l,c,h=rj(t,n),d=h.isVertical(),f=h.gradientThickness(),p=h.gradientLength(),m="";return d?(s="y",l="y2",u="x",c="width",m="1-"):(s="x",l="x2",u="y",c="height"),a={opacity:tj,fill:{scale:e,field:ZP}},a[s]={signal:m+"datum.perc",mult:p},a[u]=tj,a[l]={signal:m+"datum.perc2",mult:p},a[c]=yF(f),o={enter:a,update:kn({},a,{opacity:ej}),exit:{opacity:tj}},bF(o,{stroke:h("gradientStrokeColor"),strokeWidth:h("gradientStrokeWidth")},{opacity:h("gradientOpacity")}),uj({type:"rect",role:"legend-band",key:ZP,from:i,encode:o},r)},hj=function(t,e,n,r){let i,o,a,s,u,l=rj(t,e),c=l.isVertical(),h=yF(l.gradientThickness()),d=l.gradientLength(),f=l("labelOverlap"),p="";return i={enter:o={opacity:tj},update:a={opacity:ej,text:{field:"label"}},exit:{opacity:tj}},bF(i,{fill:l("labelColor"),fillOpacity:l("labelOpacity"),font:l("labelFont"),fontSize:l("labelFontSize"),fontStyle:l("labelFontStyle"),fontWeight:l("labelFontWeight"),limit:WF(t.labelLimit,e.gradientLabelLimit)}),c?(o.align={value:"left"},o.baseline=a.baseline={signal:'datum.perc<=0?"bottom":datum.perc>=1?"top":"middle"'},s="y",u="x",p="1-"):(o.align=a.align={signal:'datum.perc<=0?"left":datum.perc>=1?"right":"center"'},o.baseline={value:"top"},s="x",u="y"),o[s]=a[s]={signal:p+"datum.perc",mult:d},o[u]=a[u]=h,h.offset=WF(t.labelOffset,e.gradientLabelOffset)||0,f=f?{separation:l("labelSeparation"),method:f,order:"datum.index"}:void 0,uj({type:"text",role:"legend-label",style:"guide-label",key:ZP,from:r,encode:i,overlap:f},n)},dj=function(t,e,n,r,i){let o,a,s,u,l,c,h,d=rj(t,e),f=n.entries,p=!(!f||!f.interactive),m=f?f.name:void 0,g=d("clipHeight"),y=d("symbolOffset"),v={data:"value"},b={},w=`(${i}) ? datum.offset : datum.size`,x=g?yF(g):{field:"size"},_="datum.index",C=`max(1, ${i})`;x.mult=.5,b={enter:o={opacity:tj,x:{signal:w,mult:.5,offset:y},y:x},update:a={opacity:ej,x:o.x,y:o.y},exit:{opacity:tj}};let k=null,S=null;return t.fill||(k=e.symbolBaseFillColor,S=e.symbolBaseStrokeColor),bF(b,{fill:d("symbolFillColor",k),shape:d("symbolType"),size:d("symbolSize"),stroke:d("symbolStrokeColor",S),strokeDash:d("symbolDash"),strokeDashOffset:d("symbolDashOffset"),strokeWidth:d("symbolStrokeWidth")},{opacity:d("symbolOpacity")}),QP.forEach((function(e){t[e]&&(a[e]=o[e]={scale:t[e],field:ZP})})),u=uj({type:"symbol",role:"legend-symbol",key:ZP,from:v,clip:!!g||void 0,encode:b},n.symbols),s=yF(y),s.offset=d("labelOffset"),b={enter:o={opacity:tj,x:{signal:w,offset:s},y:x},update:a={opacity:ej,text:{field:"label"},x:o.x,y:o.y},exit:{opacity:tj}},bF(b,{align:d("labelAlign"),baseline:d("labelBaseline"),fill:d("labelColor"),fillOpacity:d("labelOpacity"),font:d("labelFont"),fontSize:d("labelFontSize"),fontStyle:d("labelFontStyle"),fontWeight:d("labelFontWeight"),limit:d("labelLimit")}),l=uj({type:"text",role:"legend-label",style:"guide-label",key:ZP,from:v,encode:b},n.labels),b={enter:{noBound:{value:!g},width:tj,height:g?yF(g):tj,opacity:tj},exit:{opacity:tj},update:a={opacity:ej,row:{signal:null},column:{signal:null}}},d.isVertical(!0)?(c=`ceil(item.mark.items.length / ${C})`,a.row.signal=`${_}%${c}`,a.column.signal=`floor(${_} / ${c})`,h={field:["row",_]}):(a.row.signal=`floor(${_} / ${C})`,a.column.signal=`${_} % ${C}`,h={field:_}),a.column.signal=`(${i})?${a.column.signal}:${_}`,nj({role:"scope",from:r={facet:{data:r,name:"value",groupby:"index"}},encode:wF(b,f,JP),marks:[u,l],name:m,interactive:p,sort:h})};const fj='item.orient === "left"',pj='item.orient === "right"',mj=`(${fj} || ${pj})`,gj="datum.vgrad && "+mj,yj=oj('"top"','"bottom"','"middle"'),vj=`datum.vgrad && ${pj} ? (${oj('"right"','"left"','"center"')}) : (${mj} && !(datum.vgrad && ${fj})) ? "left" : ${aj}`,bj=`item._anchor || (${mj} ? "middle" : "start")`,wj=`${gj} ? (${fj} ? -90 : 90) : 0`,xj=`${mj} ? (datum.vgrad ? (${pj} ? "bottom" : "top") : ${yj}) : "top"`;var _j=function(t,e){let n;return Ze(t)&&(t.signal?n=t.signal:t.path?n="pathShape("+Cj(t.path)+")":t.sphere&&(n="geoShape("+Cj(t.sphere)+', {type: "Sphere"})')),n?e.signalRef(n):!!t};function Cj(t){return Ze(t)&&t.signal?t.signal:zn(t)}var kj=function(t){const e=t.role||"";return e.indexOf("axis")&&e.indexOf("legend")&&e.indexOf("title")?"group"===t.type?"scope":e||"mark":e},Sj=function(t){return{marktype:t.type,name:t.name||void 0,role:t.role||kj(t),zindex:+t.zindex||void 0,aria:t.aria,description:t.description}},Ej=function(t,e){return t&&t.signal?e.signalRef(t.signal):!1!==t},Oj=function(t,e){const n=Xs(t.type);n||Be("Unrecognized transform type: "+zn(t.type));const r=FF(n.type.toLowerCase(),null,Aj(n,t,e));return t.signal&&e.addSignal(t.signal,e.proxy(r)),r.metadata=n.metadata||{},r};function Aj(t,e,n){let r,i,o,a={};for(i=0,o=t.params.length;i<o;++i)r=t.params[i],a[r.name]=Nj(r,e,n);return a}function Nj(t,e,n){const r=t.type,i=e[t.name];return"index"===r?function(t,e,n){return Mn(e.from)||Be('Lookup "from" parameter must be a string literal.'),n.getData(e.from).lookupRef(n,e.key)}(0,e,n):void 0!==i?"param"===r?function(t,e,n){const r=e[t.name];return t.array?(Ye(r)||Be("Expected an array of sub-parameters. Instead: "+zn(r)),r.map(e=>Dj(t,e,n))):Dj(t,r,n)}(t,e,n):"projection"===r?n.projectionRef(e[t.name]):t.array&&!$F(i)?i.map(e=>Tj(t,e,n)):Tj(t,i,n):void(t.required&&Be("Missing required "+zn(e.type)+" parameter: "+zn(t.name)))}function Tj(t,e,n){const r=t.type;if($F(e))return Fj(r)?Be("Expression references can not be signals."):Pj(r)?n.fieldRef(e):jj(r)?n.compareRef(e):n.signalRef(e.signal);{const i=t.expr||Pj(r);return i&&Rj(e)?n.exprRef(e.expr,e.as):i&&Ij(e)?zF(e.field,e.as):Fj(r)?VM(e,n):Mj(r)?jF(n.getData(e).values):Pj(r)?zF(e):jj(r)?n.compareRef(e):e}}function Dj(t,e,n){let r,i,o,a,s;for(a=0,s=t.params.length;a<s;++a){for(o in i=t.params[a],i.key)if(i.key[o]!==e[o]){i=null;break}if(i)break}return i||Be("Unsupported parameter: "+zn(e)),r=kn(Aj(i,e,n),i.key),jF(n.add(EP(r)))}const Rj=t=>t&&t.expr,Ij=t=>t&&t.field,Mj=t=>"data"===t,Fj=t=>"expr"===t,Pj=t=>"field"===t,jj=t=>"compare"===t;function zj(t,e){return t.$ref?t:t.data&&t.data.$ref?t.data:jF(e.getData(t.data).output)}function Lj(t,e,n,r,i){this.scope=t,this.input=e,this.output=n,this.values=r,this.aggregate=i,this.index={}}function Bj(t){return Mn(t)?t:null}function Uj(t,e,n){let r,i=UF(n.op,n.field);if(e.ops){for(let o=0,a=e.as.length;o<a;++o)if(e.as[o]===i)return}else e.ops=["count"],e.fields=[null],e.as=["count"];n.op&&(e.ops.push((r=n.op.signal)?t.signalRef(r):n.op),e.fields.push(t.fieldRef(n.field)),e.as.push(i))}function $j(t,e,n,r,i,o,a){let s,u,l=e[n]||(e[n]={}),c=function(t){return Ze(t)?("descending"===t.order?"-":"+")+UF(t.op,t.field):""}(o),h=Bj(i);if(null!=h&&(t=e.scope,h+=c?"|"+c:"",s=l[h]),!s){const n=o?{field:LF,pulse:e.countsRef(t,i,o)}:{field:t.fieldRef(i),pulse:jF(e.output)};c&&(n.sort=t.sortRef(o)),u=t.add(FF(r,void 0,n)),a&&(e.index[i]=u),s=jF(u),null!=h&&(l[h]=s)}return s}Lj.fromEntries=function(t,e){let n=e.length,r=1,i=e[0],o=e[n-1],a=e[n-2],s=null;for(i&&"load"===i.type&&(i=e[1]),t.add(e[0]);r<n;++r)e[r].params.pulse=jF(e[r-1]),t.add(e[r]),"aggregate"===e[r].type&&(s=e[r]);return new Lj(t,i,a,o,s)},Lj.prototype={countsRef(t,e,n){let r,i,o,a=this.counts||(this.counts={}),s=Bj(e);return null!=s&&(t=this.scope,r=a[s]),r?n&&n.field&&Uj(t,r.agg.params,n):(o={groupby:t.fieldRef(e,"key"),pulse:jF(this.output)},n&&n.field&&Uj(t,o,n),i=t.add(lP(o)),r=t.add(dP({pulse:jF(i)})),r={agg:i,ref:jF(r)},null!=s&&(a[s]=r)),r.ref},tuplesRef(){return jF(this.values)},extentRef(t,e){return $j(t,this,"extent","extent",e,!1)},domainRef(t,e){return $j(t,this,"domain","values",e,!1)},valuesRef(t,e,n){return $j(t,this,"vals","values",e,n||!0)},lookupRef(t,e){return $j(t,this,"lookup","tupleindex",e,!1)},indataRef(t,e){return $j(t,this,"indata","tupleindex",e,!0,!0)}};var Vj=function(t,e,n){let r,i,o=t.remove,a=t.insert,s=t.toggle,u=t.modify,l=t.values,c=e.add(PF());r="if("+t.trigger+',modify("'+n+'",'+[a,o,s,u,l].map(t=>null==t?"null":t).join(",")+"),0)",i=VM(r,e),c.update=i.$expr,c.params=i.$params},Wj=function(t,e){let n,r,i,o,a,s,u,l,c,h,d,f,p,m,g=kj(t),y="group"===t.type,v=t.from&&t.from.facet,b=t.layout||"scope"===g||"frame"===g,w="mark"===g||b||v,x=t.overlap;i=function(t,e,n){let r,i,o,a,s;return t?(r=t.facet)&&(e||Be("Only group marks can be faceted."),null!=r.field?a=s=zj(r,n):(t.data?s=jF(n.getData(t.data).aggregate):(o=Oj(kn({type:"aggregate",groupby:mn(r.groupby)},r.aggregate),n),o.params.key=n.keyRef(r.groupby),o.params.pulse=zj(r,n),a=s=jF(n.add(o))),i=n.keyRef(r.groupby,!0))):a=jF(n.add(dP(null,[{}]))),a||(a=zj(t,n)),{key:i,pulse:a,parent:s}}(t.from,y,e),r=e.add(pP({key:i.key||(t.key?zF(t.key):void 0),pulse:i.pulse,clean:!y})),h=jF(r),r=o=e.add(dP({pulse:h})),r=e.add(_P({markdef:Sj(t),interactive:Ej(t.interactive,e),clip:_j(t.clip,e),context:{$context:!0},groups:e.lookup(),parent:e.signals.parent?e.signalRef("parent"):null,index:e.markpath(),pulse:jF(r)})),d=jF(r),r=a=e.add(mP(AF(t.encode,t.type,g,t.style,e,{mod:!1,pulse:d}))),r.params.parent=e.encode(),t.transform&&t.transform.forEach(t=>{const n=Oj(t,e),i=n.metadata;(i.generates||i.changes)&&Be("Mark transforms should not generate new data."),i.nomod||(a.params.mod=!0),n.params.pulse=jF(r),e.add(r=n)}),t.sort&&(r=e.add(MP({sort:e.compareRef(t.sort),pulse:jF(r)}))),f=jF(r),(v||b)&&(b=e.add(FP({layout:e.objectProperty(t.layout),legends:e.legends,mark:d,pulse:f})),p=jF(b)),s=e.add(hP({mark:d,pulse:p||f})),m=jF(s),y&&(w&&(n=e.operators,n.pop(),b&&n.pop()),e.pushState(f,p||m,h),v?function(t,e,n){let r,i,o,a,s=t.from.facet,u=s.name,l=zj(s,e);s.name||Be("Facet must have a name: "+zn(s)),s.data||Be("Facet must reference a data set: "+zn(s)),s.field?a=e.add(OP({field:e.fieldRef(s.field),pulse:l})):s.groupby?a=e.add(yP({key:e.keyRef(s.groupby),group:jF(e.proxy(n.parent)),pulse:l})):Be("Facet must specify groupby or field: "+zn(s)),r=e.fork(),i=r.add(dP()),o=r.add(IP({pulse:jF(i)})),r.addData(u,new Lj(r,i,i,o)),r.addSignal("parent",null),a.params.subflow={$subflow:r.parse(t).toRuntime()}}(t,e,i):w?function(t,e,n){const r=e.add(OP({pulse:n.pulse})),i=e.fork();i.add(IP()),i.addSignal("parent",null),r.params.subflow={$subflow:i.parse(t).toRuntime()}}(t,e,i):e.parse(t),e.popState(),w&&(b&&n.push(b),n.push(s))),x&&(m=function(t,e,n){const r=t.method,i=t.bound,o=t.separation,a={separation:$F(o)?n.signalRef(o.signal):o,method:$F(r)?n.signalRef(r.signal):r,pulse:e};if(t.order&&(a.sort=n.compareRef({field:t.order})),i){const t=i.tolerance;a.boundTolerance=$F(t)?n.signalRef(t.signal):+t,a.boundScale=n.scaleRef(i.scale),a.boundOrient=i.orient}return jF(n.add(SP(a)))}(x,m,e)),u=e.add(DP({pulse:m})),l=e.add(IP({pulse:jF(u)},void 0,e.parent())),null!=t.name&&(c=t.name,e.addData(c,new Lj(e,o,u,l)),t.on&&t.on.forEach(t=>{(t.insert||t.remove||t.toggle)&&Be("Marks only support modify triggers."),Vj(t,e,c)}))};function qj(t,e,n){return e[t]?`scale("${e[t]}",datum)`:ij(t,n[0].encode)}function Hj(t,e){const n={enter:{},update:{}};return bF(n,{orient:t("orient"),anchor:t("anchor"),align:{signal:aj},angle:{signal:'item.orient==="left"?-90:item.orient==="right"?90:0'},limit:t("limit"),frame:t("frame"),offset:t("offset")||0,padding:t("subtitlePadding")}),wF(n,e,JP)}function Gj(t){const e=dP({},t);return e.metadata={source:!0},e}function Xj(t,e){return xP({url:e.url?t.property(e.url):void 0,async:e.async?t.property(e.async):void 0,values:e.values?t.property(e.values):void 0,format:t.objectProperty(e.format)})}const Kj=t=>"bottom"===t||"top"===t,Yj=(t,e,n)=>$F(t)?nz(t.signal,e,n):"left"===t||"top"===t?e:n,Zj=(t,e,n)=>$F(t)?tz(t.signal,e,n):Kj(t)?e:n,Qj=(t,e,n)=>$F(t)?ez(t.signal,e,n):Kj(t)?n:e,Jj=(t,e,n)=>$F(t)?rz(t.signal,e,n):"top"===t?{value:e}:{value:n},tz=(t,e,n)=>iz(`${t} === 'top' || ${t} === 'bottom'`,e,n),ez=(t,e,n)=>iz(`${t} !== 'top' && ${t} !== 'bottom'`,e,n),nz=(t,e,n)=>az(`${t} === 'left' || ${t} === 'top'`,e,n),rz=(t,e,n)=>az(t+" === 'top'",e,n),iz=(t,e,n)=>(e=null!=e?yF(e):e,n=null!=n?yF(n):n,oz(e)&&oz(n)?{signal:`${t} ? (${e=e?e.signal||zn(e.value):null}) : (${n=n?n.signal||zn(n.value):null})`}:[kn({test:t},e)].concat(n||[])),oz=t=>null==t||1===Object.keys(t).length,az=(t,e,n)=>({signal:`${t} ? (${sz(e)}) : (${sz(n)})`}),sz=t=>$F(t)?t.signal:null==t?null:zn(t),uz=(t,e)=>{const n=t.signal;return n&&n.endsWith("(null)")?{signal:n.slice(0,-6)+e.signal}:t};function lz(t,e,n,r){let i;if(e&&On(e,t))return e[t];if(On(n,t))return n[t];if(t.startsWith("title")){switch(t){case"titleColor":i="fill";break;case"titleFont":case"titleFontSize":case"titleFontWeight":i=t[5].toLowerCase()+t.slice(6)}return r["guide-title"][i]}if(t.startsWith("label")){switch(t){case"labelColor":i="fill";break;case"labelFont":case"labelFontSize":i=t[5].toLowerCase()+t.slice(6)}return r["guide-label"][i]}return null}function cz(t){const e={};for(const n of t)if(n)for(const t in n)e[t]=1;return Object.keys(e)}function hz(t,e){return{scale:t.scale,range:e}}function dz(t,e,n,r,i){return{signal:'flush(range("'+t+'"), scale("'+t+'", datum.value), '+e+","+n+","+r+","+i+")"}}var fz=function(t,e){let n,r,i,o,a,s=function(t,e){var n,r,i,o,a,s,u,l,c=e.config,h=c.style,d=c.axis,f="band"===e.scaleType(t.scale)&&c.axisBand,p=t.orient;if($F(p)){const t=cz([c.axisX,c.axisY]),e=cz([c.axisTop,c.axisBottom,c.axisLeft,c.axisRight]);for(i of(n={},t))n[i]=Zj(p,lz(i,c.axisX,d,h),lz(i,c.axisY,d,h));for(i of(r={},e))r[i]=(o=p.signal,a=lz(i,c.axisTop,d,h),s=lz(i,c.axisBottom,d,h),u=lz(i,c.axisLeft,d,h),l=lz(i,c.axisRight,d,h),{signal:(null!=u?`${o} === 'left' ? (${sz(u)}) : `:"")+(null!=s?`${o} === 'bottom' ? (${sz(s)}) : `:"")+(null!=l?`${o} === 'right' ? (${sz(l)}) : `:"")+(null!=a?`${o} === 'top' ? (${sz(a)}) : `:"")+"(null)"})}else n="top"===p||"bottom"===p?c.axisX:c.axisY,r=c["axis"+p[0].toUpperCase()+p.slice(1)];return n||r||f?kn({},d,n,r,f):d}(t,e),u=t.encode||{},l=u.axis||{},c=l.name||void 0,h=l.interactive,d=l.style,f=rj(t,s),p=function(t){let e,n,r=t("tickBand"),i=t("tickOffset");return r?r.signal?(e={signal:`(${r.signal}) === 'extent' ? 1 : 0.5`},n={signal:`(${r.signal}) === 'extent'`},Ze(i)||(i={signal:`(${r.signal}) === 'extent' ? 0 : ${i}`})):"extent"===r?(e=1,n=!0,i=0):(e=.5,n=!1):(e=t("bandPosition"),n=t("tickExtra")),{extra:n,band:e,offset:i}}(f);return n={scale:t.scale,ticks:!!f("ticks"),labels:!!f("labels"),grid:!!f("grid"),domain:!!f("domain"),title:null!=t.title},r=jF(e.add(dP({},[n]))),l=wF(function(t,e){const n={enter:{},update:{}};return bF(n,{orient:t("orient"),offset:t("offset")||0,position:WF(e.position,0),titlePadding:t("titlePadding"),minExtent:t("minExtent"),maxExtent:t("maxExtent"),range:{signal:`abs(span(range("${e.scale}")))`},translate:t("translate"),format:e.format,formatType:e.formatType}),n}(f,t),l,JP),i=jF(e.add(cP({scale:e.scaleRef(t.scale),extra:e.property(p.extra),count:e.objectProperty(t.tickCount),values:e.objectProperty(t.values),minstep:e.property(t.tickMinStep),formatType:e.property(t.formatType),formatSpecifier:e.property(t.format)}))),a=[],n.grid&&a.push(function(t,e,n,r,i){let o,a,s,u,l,c,h,d,f=rj(t,e),p=t.orient,m=t.gridScale,g=Yj(p,1,-1),y=function(t,e){if(1===e);else if(Ze(t)){let n=t=kn({},t);for(;null!=n.mult;){if(!Ze(n.mult))return n.mult=$F(e)?{signal:`(${n.mult}) * (${e.signal})`}:n.mult*e,t;n=n.mult=kn({},n.mult)}n.mult=e}else t=$F(e)?{signal:`(${e.signal}) * (${t||0})`}:e*(t||0);return t}(t.offset,g);return o={enter:a={opacity:tj},update:u={opacity:ej},exit:s={opacity:tj}},bF(o,{stroke:f("gridColor"),strokeCap:f("gridCap"),strokeDash:f("gridDash"),strokeDashOffset:f("gridDashOffset"),strokeOpacity:f("gridOpacity"),strokeWidth:f("gridWidth")}),l={scale:t.scale,field:ZP,band:i.band,extra:i.extra,offset:i.offset,round:f("tickRound")},d=Zj(p,{signal:"height"},{signal:"width"}),c=m?{scale:m,range:0,mult:g,offset:y}:{value:0,offset:y},h=m?{scale:m,range:1,mult:g,offset:y}:kn(d,{mult:g,offset:y}),a.x=u.x=Zj(p,l,c),a.y=u.y=Qj(p,l,c),a.x2=u.x2=Qj(p,h),a.y2=u.y2=Zj(p,h),s.x=Zj(p,l),s.y=Qj(p,l),uj({type:"rule",role:"axis-grid",key:ZP,from:r,encode:o},n)}(t,s,u.grid,i,p)),n.ticks&&(o=f("tickSize"),a.push(function(t,e,n,r,i,o){let a,s,u,l,c,h,d=rj(t,e),f=t.orient,p=Yj(f,-1,1);return a={enter:s={opacity:tj},update:l={opacity:ej},exit:u={opacity:tj}},bF(a,{stroke:d("tickColor"),strokeCap:d("tickCap"),strokeDash:d("tickDash"),strokeDashOffset:d("tickDashOffset"),strokeOpacity:d("tickOpacity"),strokeWidth:d("tickWidth")}),c=yF(i),c.mult=p,h={scale:t.scale,field:ZP,band:o.band,extra:o.extra,offset:o.offset,round:d("tickRound")},l.y=s.y=Zj(f,tj,h),l.y2=s.y2=Zj(f,c),u.x=Zj(f,h),l.x=s.x=Qj(f,tj,h),l.x2=s.x2=Qj(f,c),u.y=Qj(f,h),uj({type:"rule",role:"axis-tick",key:ZP,from:r,encode:a},n)}(t,s,u.ticks,i,o,p))),n.labels&&(o=n.ticks?o:0,a.push(function(t,e,n,r,i,o){let a,s,u,l,c,h,d,f,p,m,g=rj(t,e),y=t.orient,v=t.scale,b=Yj(y,-1,1),w=qF(g("labelFlush")),x=qF(g("labelFlushOffset")),_=0===w||!!w,C=g("labelAlign"),k=g("labelBaseline");return l=yF(i),l.mult=b,l.offset=yF(g("labelPadding")||0),l.offset.mult=b,c={scale:v,field:ZP,band:.5,offset:sj(o.offset,g("labelOffset"))},h=Zj(y,_?dz(v,w,'"left"','"right"','"center"'):{value:"center"},((t,e,n)=>$F(t)?az(t.signal+" === 'right'","left","right"):"right"===t?{value:e}:{value:n})(y,"left","right")),d=Zj(y,Jj(y,"bottom","top"),_?dz(v,w,'"top"','"bottom"','"middle"'):{value:"middle"}),m=dz(v,w,`-(${x})`,x,0),_=_&&x,s={opacity:tj,x:Zj(y,c,l),y:Qj(y,c,l)},a={enter:s,update:u={opacity:ej,text:{field:"label"},x:s.x,y:s.y,align:h,baseline:d},exit:{opacity:tj,x:s.x,y:s.y}},bF(a,{dx:!C&&_?Zj(y,m):null,dy:!k&&_?Qj(y,m):null}),bF(a,{angle:g("labelAngle"),fill:g("labelColor"),fillOpacity:g("labelOpacity"),font:g("labelFont"),fontSize:g("labelFontSize"),fontWeight:g("labelFontWeight"),fontStyle:g("labelFontStyle"),limit:g("labelLimit"),lineHeight:g("labelLineHeight")},{align:C,baseline:k}),f=g("labelBound"),p=g("labelOverlap"),p=p||f?{separation:g("labelSeparation"),method:p,order:"datum.index",bound:f?{scale:v,orient:y,tolerance:f}:null}:void 0,u.align!==h&&(u.align=uz(u.align,h)),u.baseline!==d&&(u.baseline=uz(u.baseline,d)),uj({type:"text",role:"axis-label",style:"guide-label",key:ZP,from:r,encode:a,overlap:p},n)}(t,s,u.labels,i,o,p))),n.domain&&a.push(function(t,e,n,r){let i,o,a,s=rj(t,e),u=t.orient;i={enter:o={opacity:tj},update:a={opacity:ej},exit:{opacity:tj}},bF(i,{stroke:s("domainColor"),strokeCap:s("domainCap"),strokeDash:s("domainDash"),strokeDashOffset:s("domainDashOffset"),strokeWidth:s("domainWidth"),strokeOpacity:s("domainOpacity")});const l=hz(t,0),c=hz(t,1);return o.x=a.x=Zj(u,l,tj),o.x2=a.x2=Zj(u,c),o.y=a.y=Qj(u,l,tj),o.y2=a.y2=Qj(u,c),uj({type:"rule",role:"axis-domain",from:r,encode:i},n)}(t,s,u.domain,r)),n.title&&a.push(function(t,e,n,r){let i,o,a,s,u=rj(t,e),l=t.orient,c=Yj(l,-1,1);return i={enter:o={opacity:tj,anchor:yF(u("titleAnchor",null)),align:{signal:aj}},update:a=kn({},o,{opacity:ej,text:yF(t.title)}),exit:{opacity:tj}},s={signal:`lerp(range("${t.scale}"), ${oj(0,1,.5)})`},a.x=Zj(l,s),a.y=Qj(l,s),o.angle=Zj(l,tj,((t,e)=>$F(t)?{signal:`(${t.signal}) * 90`}:{value:90*t})(c)),o.baseline=Zj(l,Jj(l,"bottom","top"),{value:"bottom"}),a.angle=o.angle,a.baseline=o.baseline,bF(i,{fill:u("titleColor"),fillOpacity:u("titleOpacity"),font:u("titleFont"),fontSize:u("titleFontSize"),fontStyle:u("titleFontStyle"),fontWeight:u("titleFontWeight"),limit:u("titleLimit"),lineHeight:u("titleLineHeight")},{align:u("titleAlign"),angle:u("titleAngle"),baseline:u("titleBaseline")}),function(t,e,n,r){const i=(t,e)=>null!=t?(n.update[e]=uz(yF(t),n.update[e]),!1):!xF(e,r),o=i(t("titleX"),"x"),a=i(t("titleY"),"y");n.enter.auto=a===o?yF(a):Zj(e,yF(a),yF(o))}(u,l,i,n),i.update.align=uz(i.update.align,o.align),i.update.angle=uz(i.update.angle,o.angle),i.update.baseline=uz(i.update.baseline,o.baseline),uj({type:"text",role:"axis-title",style:"guide-title",from:r,encode:i},n)}(t,s,u.title,r)),Wj(nj({role:"axis",from:r,encode:l,marks:a,aria:f("aria"),description:f("description"),zindex:f("zindex"),name:c,interactive:h,style:d}),e)},pz=function(t,e,n){const r=mn(t.signals),i=mn(t.scales);return n||r.forEach(t=>IF(t,e)),mn(t.projections).forEach(t=>function(t,e){const n=e.config.projection||{},r={};for(const i in t)"name"!==i&&(r[i]=YP(t[i],i,e));for(const i in n)null==r[i]&&(r[i]=YP(n[i],i,e));e.addProjection(t.name,r)}(t,e)),i.forEach(t=>function(t,e){const n=t.type||"linear";vy(n)||Be("Unrecognized scale type: "+zn(n)),e.addScale(t.name,{type:n,domain:void 0})}(t,e)),mn(t.data).forEach(t=>function(t,e){const n=[];t.transform&&t.transform.forEach(t=>{n.push(Oj(t,e))}),t.on&&t.on.forEach((function(n){Vj(n,e,t.name)})),e.addDataPipeline(t.name,function(t,e,n){let r,i,o,a,s,u=[],l=null,c=!1,h=!1;for(t.values?VF(t.values)||VF(t.format)?(u.push(Xj(e,t)),u.push(l=Gj())):u.push(l=Gj({$ingest:t.values,$format:t.format})):t.url?VF(t.url)||VF(t.format)?(u.push(Xj(e,t)),u.push(l=Gj())):u.push(l=Gj({$request:t.url,$format:t.format})):t.source&&(l=r=mn(t.source).map(t=>jF(e.getData(t).output)),u.push(null)),i=0,o=n.length;i<o;++i)a=n[i],s=a.metadata,l||s.source||u.push(l=Gj()),u.push(a),s.generates&&(h=!0),s.modifies&&!h&&(c=!0),s.source?l=a:s.changes&&(l=null);return r&&(o=r.length-1,u[0]=TP({derive:c,pulse:o?r:r[0]}),(c||o)&&u.splice(1,0,Gj())),l||u.push(Gj()),u.push(IP({})),u}(t,e,n))}(t,e)),i.forEach(t=>function(t,e){let n,r=e.getScale(t.name).params;var i;for(n in r.domain=$P(t.domain,t,e),null!=t.range&&(r.range=function t(e,n,r){let i=e.range,o=n.config.range;if(i.signal)return n.signalRef(i.signal);if(Mn(i)){if(o&&On(o,i))return t(e=kn({},e,{range:o[i]}),n,r);"width"===i?i=[0,{signal:"width"}]:"height"===i?i=xy(e.type)?[0,{signal:"height"}]:[{signal:"height"},0]:Be("Unrecognized scale range value: "+zn(i))}else{if(i.scheme)return r.scheme=Ye(i.scheme)?BP(i.scheme,n):LP(i.scheme,n),i.extent&&(r.schemeExtent=BP(i.extent,n)),void(i.count&&(r.schemeCount=LP(i.count,n)));if(i.step)return void(r.rangeStep=LP(i.step,n));if(xy(e.type)&&!Ye(i))return $P(i,e,n);Ye(i)||Be("Unsupported range type: "+zn(i))}return i.map(t=>(Ye(t)?BP:LP)(t,n))}(t,e,r)),null!=t.interpolate&&function(t,e){e.interpolate=LP(t.type||t),null!=t.gamma&&(e.interpolateGamma=LP(t.gamma))}(t.interpolate,r),null!=t.nice&&(r.nice=Ze(i=t.nice)?{interval:LP(i.interval),step:LP(i.step)}:LP(i)),null!=t.bins&&(r.bins=function(t,e){return t.signal||Ye(t)?BP(t,e):e.objectProperty(t)}(t.bins,e)),t)On(r,n)||"name"===n||(r[n]=LP(t[n],e))}(t,e)),(n||r).forEach(t=>function(t,e){let n=e.getSignal(t.name),r=t.update;t.init&&(r?Be("Signals can not include both init and update expressions."):(r=t.init,n.initonly=!0)),r&&(r=VM(r,e),n.update=r.$expr,n.params=r.$params),t.on&&t.on.forEach(t=>function(t,e,n){let r=t.events,i=t.update,o=t.encode,a=[],s={target:n};r||Be("Signal update missing events specification."),Mn(r)&&(r=ZF(r,e.isSubscope()?"scope":"view")),r=mn(r).filter(t=>t.signal||t.scale?(a.push(t),0):1),a.length>1&&(a=[sP(a)]),r.length&&a.push(r.length>1?{merge:r}:r[0]),null!=o&&(i&&Be("Signal encode and update are mutually exclusive."),i="encode(item(),"+zn(o)+")"),s.update=Mn(i)?VM(i,e):null!=i.expr?VM(i.expr,e):null!=i.value?i.value:null!=i.signal?{$expr:aP,$params:{$value:e.signalRef(i.signal)}}:Be("Invalid signal update specification."),t.force&&(s.options={force:!0}),a.forEach(t=>e.addUpdate(kn(function(t,e){return{source:t.signal?e.signalRef(t.signal):t.scale?e.scaleRef(t.scale):HF(t,e)}}(t,e),s)))}(t,e,n.id))}(t,e)),mn(t.axes).forEach(t=>fz(t,e)),mn(t.marks).forEach(t=>Wj(t,e)),mn(t.legends).forEach(t=>function(t,e){let n,r,i,o,a,s,u,l,c=e.config.legend,h=t.encode||{},d=h.legend||{},f=d.name||void 0,p=d.interactive,m=d.style,g=rj(t,c),y={},v=0;return QP.forEach(e=>t[e]?(y[e]=t[e],v=v||t[e]):0),v||Be("Missing valid scale for legend."),a=function(t,e){let n=t.type||"symbol";return t.type||1!==function(t){return QP.reduce((function(e,n){return e+(t[n]?1:0)}),0)}(t)||!t.fill&&!t.stroke||(n=wy(e)?"gradient":_y(e)?"discrete":"symbol"),"gradient"!==n?n:_y(e)?"discrete":"gradient"}(t,e.scaleType(v)),s={title:null!=t.title,scales:y,type:a,vgrad:"symbol"!==a&&g.isVertical()},u=jF(e.add(dP(null,[s]))),d=wF(function(t,e,n){const r={enter:{},update:{}};return bF(r,{orient:t("orient"),offset:t("offset"),padding:t("padding"),titlePadding:t("titlePadding"),cornerRadius:t("cornerRadius"),fill:t("fillColor"),stroke:t("strokeColor"),strokeWidth:n.strokeWidth,strokeDash:n.strokeDash,x:t("legendX"),y:t("legendY"),format:e.format,formatType:e.formatType}),r}(g,t,c),d,JP),n={enter:{x:{value:0},y:{value:0}}},l=jF(e.add(wP(i={type:a,scale:e.scaleRef(v),count:e.objectProperty(g("tickCount")),limit:e.property(g("symbolLimit")),values:e.objectProperty(t.values),minstep:e.property(t.tickMinStep),formatType:e.property(t.formatType),formatSpecifier:e.property(t.format)}))),"gradient"===a?(o=[lj(t,v,c,h.gradient),hj(t,c,h.labels,l)],i.count=i.count||e.signalRef(`max(2,2*floor((${qF(g.gradientLength())})/100))`)):"discrete"===a?o=[cj(t,v,c,h.gradient,l),hj(t,c,h.labels,l)]:(r=function(t,e){const n=rj(t,e);return{align:n("gridAlign"),columns:n.entryColumns(),center:{row:!0,column:!1},padding:{row:n("rowPadding"),column:n("columnPadding")}}}(t,c),o=[dj(t,c,h,l,qF(r.columns))],i.size=function(t,e,n){const r=qF(qj("size",t,n)),i=qF(qj("strokeWidth",t,n)),o=qF(function(t,e,n){return ij("fontSize",t)||function(t,e,n){const r=e.config.style["guide-label"];return r&&r.fontSize}(0,e)}(n[1].encode,e));return VM(`max(ceil(sqrt(${r})+${i}),${o})`,e)}(t,e,o[0].marks)),o=[nj({role:"legend-entry",from:u,encode:n,marks:o,layout:r,interactive:p})],s.title&&o.push(function(t,e,n,r){let i,o=rj(t,e);return i={enter:{opacity:tj},update:{opacity:ej,x:{field:{group:"padding"}},y:{field:{group:"padding"}}},exit:{opacity:tj}},bF(i,{orient:o("titleOrient"),_anchor:o("titleAnchor"),anchor:{signal:bj},angle:{signal:wj},align:{signal:vj},baseline:{signal:xj},text:t.title,fill:o("titleColor"),fillOpacity:o("titleOpacity"),font:o("titleFont"),fontSize:o("titleFontSize"),fontStyle:o("titleFontStyle"),fontWeight:o("titleFontWeight"),limit:o("titleLimit"),lineHeight:o("titleLineHeight")},{align:o("titleAlign"),baseline:o("titleBaseline")}),uj({type:"text",role:"legend-title",style:"guide-title",from:r,encode:i},n)}(t,c,h.title,u)),Wj(nj({role:"legend",from:u,encode:d,marks:o,aria:g("aria"),description:g("description"),zindex:g("zindex"),name:f,interactive:p,style:m}),e)}(t,e)),t.title&&function(t,e){let n,r,i=rj(t=Mn(t)?{text:t}:t,e.config.title),o=t.encode||{},a=o.group||{},s=a.name||void 0,u=a.interactive,l=a.style,c=[];n={},r=jF(e.add(dP(null,[n]))),c.push(function(t,e,n,r){const i={value:0},o={enter:{opacity:i},update:{opacity:{value:1}},exit:{opacity:i}};return bF(o,{text:t.text,align:{signal:"item.mark.group.align"},angle:{signal:"item.mark.group.angle"},limit:{signal:"item.mark.group.limit"},baseline:"top",dx:e("dx"),dy:e("dy"),fill:e("color"),font:e("font"),fontSize:e("fontSize"),fontStyle:e("fontStyle"),fontWeight:e("fontWeight"),lineHeight:e("lineHeight")},{align:e("align"),angle:e("angle"),baseline:e("baseline")}),uj({type:"text",role:"title-text",style:"group-title",from:r,encode:o},n)}(t,i,function(t){const e=t.encode;return e&&e.title||kn({name:t.name,interactive:t.interactive,style:t.style},e)}(t),r)),t.subtitle&&c.push(function(t,e,n,r){const i={value:0},o={enter:{opacity:i},update:{opacity:{value:1}},exit:{opacity:i}};return bF(o,{text:t.subtitle,align:{signal:"item.mark.group.align"},angle:{signal:"item.mark.group.angle"},limit:{signal:"item.mark.group.limit"},baseline:"top",dx:e("dx"),dy:e("dy"),fill:e("subtitleColor"),font:e("subtitleFont"),fontSize:e("subtitleFontSize"),fontStyle:e("subtitleFontStyle"),fontWeight:e("subtitleFontWeight"),lineHeight:e("subtitleLineHeight")},{align:e("align"),angle:e("angle"),baseline:e("baseline")}),uj({type:"text",role:"title-subtitle",style:"group-subtitle",from:r,encode:o},n)}(t,i,o.subtitle,r)),Wj(nj({role:"title",from:r,encode:Hj(i,a),marks:c,aria:i("aria"),description:i("description"),zindex:i("zindex"),name:s,interactive:u,style:l}),e)}(t.title,e),e.parseLambdas(),e};function mz(t,e){return e&&e.signal?{name:t,update:e.signal}:{name:t,value:e}}function gz(t,e){this.config=t||{},this.options=e||{},this.bindings=[],this.field={},this.signals={},this.lambdas={},this.scales={},this.events={},this.data={},this.streams=[],this.updates=[],this.operators=[],this.eventConfig=null,this.locale=null,this._id=0,this._subid=0,this._nextsub=[0],this._parent=[],this._encode=[],this._lookup=[],this._markpath=[]}function yz(t){this.config=t.config,this.options=t.options,this.legends=t.legends,this.field=Object.create(t.field),this.signals=Object.create(t.signals),this.lambdas=Object.create(t.lambdas),this.scales=Object.create(t.scales),this.events=Object.create(t.events),this.data=Object.create(t.data),this.streams=[],this.updates=[],this.operators=[],this._id=0,this._subid=++t._nextsub[0],this._nextsub=t._nextsub,this._parent=t._parent.slice(),this._encode=t._encode.slice(),this._lookup=t._lookup.slice(),this._markpath=t._markpath}function vz(t){return(Ye(t)?bz:wz)(t)}function bz(t){let e,n="[",r=0,i=t.length;for(;r<i;++r)e=t[r],n+=(r>0?",":"")+(Ze(e)?e.signal||vz(e):zn(e));return n+"]"}function wz(t){let e,n,r="{",i=0;for(e in t)n=t[e],r+=(++i>1?",":"")+zn(e)+":"+(Ze(n)?n.signal||vz(n):zn(n));return r+"}"}gz.prototype=yz.prototype={parse(t){return pz(t,this)},fork(){return new yz(this)},isSubscope(){return this._subid>0},toRuntime(){return this.finish(),{description:this.description,operators:this.operators,streams:this.streams,updates:this.updates,bindings:this.bindings,eventConfig:this.eventConfig,locale:this.locale}},id(){return(this._subid?this._subid+":":0)+this._id++},add(t){return this.operators.push(t),t.id=this.id(),t.refs&&(t.refs.forEach((function(e){e.$ref=t.id})),t.refs=null),t},proxy(t){const e=t instanceof MF?jF(t):t;return this.add(NP({value:e}))},addStream(t){return this.streams.push(t),t.id=this.id(),t},addUpdate(t){return this.updates.push(t),t},finish(){let t,e;for(t in this.root&&(this.root.root=!0),this.signals)this.signals[t].signal=t;for(t in this.scales)this.scales[t].scale=t;function n(t,e,n){let r,i;t&&(r=t.data||(t.data={}),i=r[e]||(r[e]=[]),i.push(n))}for(t in this.data){e=this.data[t],n(e.input,t,"input"),n(e.output,t,"output"),n(e.values,t,"values");for(const r in e.index)n(e.index[r],t,"index:"+r)}return this},pushState(t,e,n){this._encode.push(jF(this.add(IP({pulse:t})))),this._parent.push(e),this._lookup.push(n?jF(this.proxy(n)):null),this._markpath.push(-1)},popState(){this._encode.pop(),this._parent.pop(),this._lookup.pop(),this._markpath.pop()},parent(){return en(this._parent)},encode(){return en(this._encode)},lookup(){return en(this._lookup)},markpath(){const t=this._markpath;return++t[t.length-1]},fieldRef(t,e){if(Mn(t))return zF(t,e);t.signal||Be("Unsupported field reference: "+zn(t));let n=t.signal,r=this.field[n];if(!r){const t={name:this.signalRef(n)};e&&(t.as=e),this.field[n]=r=jF(this.add(vP(t)))}return r},compareRef(t){let e=!1;const n=t=>$F(t)?(e=!0,this.signalRef(t.signal)):function(t){return t&&t.expr}(t)?(e=!0,this.exprRef(t.expr)):t,r=mn(t.field).map(n),i=mn(t.order).map(n);return e?jF(this.add(fP({fields:r,orders:i}))):BF(r,i)},keyRef(t,e){let n=!1;const r=this.signals;return t=mn(t).map(t=>$F(t)?(n=!0,jF(r[t.signal])):t),n?jF(this.add(bP({fields:t,flat:e}))):function(t,e){const n={$key:t};return e&&(n.$flat=!0),n}(t,e)},sortRef(t){if(!t)return t;const e=UF(t.op,t.field),n=t.order||"ascending";return n.signal?jF(this.add(fP({fields:e,orders:this.signalRef(n.signal)}))):BF(e,n)},event(t,e){const n=t+":"+e;if(!this.events[n]){const r=this.id();this.streams.push({id:r,source:t,type:e}),this.events[n]=r}return this.events[n]},hasOwnSignal(t){return On(this.signals,t)},addSignal(t,e){this.hasOwnSignal(t)&&Be("Duplicate signal name: "+zn(t));const n=e instanceof MF?e:this.add(PF(e));return this.signals[t]=n},getSignal(t){return this.signals[t]||Be("Unrecognized signal name: "+zn(t)),this.signals[t]},signalRef(t){return this.signals[t]?jF(this.signals[t]):(On(this.lambdas,t)||(this.lambdas[t]=this.add(PF(null))),jF(this.lambdas[t]))},parseLambdas(){const t=Object.keys(this.lambdas);for(let e=0,n=t.length;e<n;++e){const n=t[e],r=VM(n,this),i=this.lambdas[n];i.params=r.$params,i.update=r.$expr}},property(t){return t&&t.signal?this.signalRef(t.signal):t},objectProperty(t){return t&&Ze(t)?this.signalRef(t.signal||vz(t)):t},exprRef(t,e){const n={expr:VM(t,this)};return e&&(n.expr.$name=e),jF(this.add(gP(n)))},addBinding(t,e){this.bindings||Be("Nested signals do not support binding: "+zn(t)),this.bindings.push(kn({signal:t},e))},addScaleProj(t,e){On(this.scales,t)&&Be("Duplicate scale or projection name: "+zn(t)),this.scales[t]=this.add(e)},addScale(t,e){this.addScaleProj(t,RP(e))},addProjection(t,e){this.addScaleProj(t,AP(e))},getScale(t){return this.scales[t]||Be("Unrecognized scale name: "+zn(t)),this.scales[t]},scaleRef(t){return jF(this.getScale(t))},scaleType(t){return this.getScale(t).params.type},projectionRef(t){return this.scaleRef(t)},projectionType(t){return this.scaleType(t)},addData(t,e){return On(this.data,t)&&Be("Duplicate data set name: "+zn(t)),this.data[t]=e},getData(t){return this.data[t]||Be("Undefined data set name: "+zn(t)),this.data[t]},addDataPipeline(t,e){return On(this.data,t)&&Be("Duplicate data set name: "+zn(t)),this.addData(t,Lj.fromEntries(this,e))}};var xz=function(t,e,n){return Ze(t)||Be("Input Vega specification must be an object."),function(t,e){const n=e.config,r=jF(e.root=e.add(PF())),i=function(t,e){const n=n=>WF(t[n],e[n]),r=[mz("background",n("background")),mz("autosize",pF(n("autosize"))),mz("padding",gF(n("padding"))),mz("width",n("width")||0),mz("height",n("height")||0)],i=r.reduce((t,e)=>(t[e.name]=e,t),{}),o={};return mn(t.signals).forEach(t=>{On(i,t.name)?t=kn(i[t.name],t):r.push(t),o[t.name]=t}),mn(e.signals).forEach(t=>{On(o,t.name)||On(i,t.name)||r.push(t)}),r}(t,n);i.forEach(t=>IF(t,e)),e.description=t.description||n.description,e.eventConfig=n.events,e.legends=e.objectProperty(n.legend&&n.legend.layout),e.locale=n.locale;const o=e.add(dP()),a=e.add(mP(AF((t=>wF({enter:{x:{value:0},y:{value:0}},update:{width:{signal:"width"},height:{signal:"height"}}},t))(t.encode),"group","frame",t.style,e,{pulse:jF(o)}))),s=e.add(FP({layout:e.objectProperty(t.layout),legends:e.legends,autosize:e.signalRef("autosize"),mark:r,pulse:jF(a)}));e.operators.pop(),e.pushState(jF(a),jF(s),null),pz(t,e,i),e.operators.push(s);let u=e.add(hP({mark:r,pulse:jF(s)}));return u=e.add(DP({pulse:jF(u)})),u=e.add(IP({pulse:jF(u)})),e.addData("root",new Lj(e,o,o,u)),e}(t,new gz(e=function(...t){return t.reduce((t,e)=>{for(const n in e)"signals"===n?t.signals=tn(t.signals,e.signals):Je(t,n,e[n],"legend"===n?{layout:1}:"style"===n||null);return t},{})}({description:"Vega visualization",padding:0,autosize:"pad",background:null,events:{defaults:{allow:["wheel"]}},group:null,mark:null,arc:{fill:"#4c78a8"},area:{fill:"#4c78a8"},image:null,line:{stroke:"#4c78a8",strokeWidth:2},path:{stroke:"#4c78a8"},rect:{fill:"#4c78a8"},rule:{stroke:"#000"},shape:{stroke:"#4c78a8"},symbol:{fill:"#4c78a8",size:64},text:{fill:"#000",font:"sans-serif",fontSize:11},trail:{fill:"#4c78a8",size:2},style:{"guide-label":{fill:"#000",font:"sans-serif",fontSize:10},"guide-title":{fill:"#000",font:"sans-serif",fontSize:11,fontWeight:"bold"},"group-title":{fill:"#000",font:"sans-serif",fontSize:13,fontWeight:"bold"},"group-subtitle":{fill:"#000",font:"sans-serif",fontSize:12},point:{size:30,strokeWidth:2,shape:"circle"},circle:{size:30,strokeWidth:2},square:{size:30,strokeWidth:2,shape:"square"},cell:{fill:"transparent",stroke:"#ddd"}},title:{orient:"top",anchor:"middle",offset:4,subtitlePadding:3},axis:{minExtent:0,maxExtent:200,bandPosition:.5,domain:!0,domainWidth:1,domainColor:"#888",grid:!1,gridWidth:1,gridColor:"#ddd",labels:!0,labelAngle:0,labelLimit:180,labelOffset:0,labelPadding:2,ticks:!0,tickColor:"#888",tickOffset:0,tickRound:!0,tickSize:5,tickWidth:1,titlePadding:4},axisBand:{tickOffset:-.5},projection:{type:"mercator"},legend:{orient:"right",padding:0,gridAlign:"each",columnPadding:10,rowPadding:2,symbolDirection:"vertical",gradientDirection:"vertical",gradientLength:200,gradientThickness:16,gradientStrokeColor:"#ddd",gradientStrokeWidth:0,gradientLabelOffset:2,labelAlign:"left",labelBaseline:"middle",labelLimit:160,labelOffset:4,labelOverlap:!0,symbolLimit:30,symbolType:"circle",symbolSize:100,symbolOffset:0,symbolStrokeWidth:1.5,symbolBaseFillColor:"transparent",symbolBaseStrokeColor:"#888",titleLimit:180,titleOrient:"top",titlePadding:5,layout:{offset:18,direction:"horizontal",left:{direction:"vertical"},right:{direction:"vertical"}}},range:{category:{scheme:"tableau10"},ordinal:{scheme:"blues"},heatmap:{scheme:"yellowgreenblue"},ramp:{scheme:"blues"},diverging:{scheme:"blueorange",extent:[1,0]},symbol:["circle","square","triangle-up","cross","diamond","triangle-right","triangle-down","triangle-left"]}},e,t.config),n)).toRuntime()};ie(Gs,o,s,u,l,c,h,d,f,p,m);var _z=n("qHvB");Array.prototype.flat||Object.defineProperty(Array.prototype,"flat",{configurable:!0,value:function t(){var e=isNaN(arguments[0])?1:Number(arguments[0]);return e?Array.prototype.reduce.call(this,(function(n,r){return Array.isArray(r)?n.push.apply(n,t.call(r,e-1)):n.push(r),n}),[]):Array.prototype.slice.call(this)},writable:!0}),Array.prototype.flatMap||Object.defineProperty(Array.prototype,"flatMap",{configurable:!0,value:function(t){return Array.prototype.map.apply(this,arguments).flat()},writable:!0});var Cz=n("JBAE"),kz=n.n(Cz),Sz=n("aUsF"),Ez=n.n(Sz),Oz=n("9x6x"),Az=n.n(Oz);function Nz(t){return!!t.or}function Tz(t){return!!t.and}function Dz(t){return!!t.not}function Rz(t,e){return Dz(t)?{not:Rz(t.not,e)}:Tz(t)?{and:t.and.map(t=>Rz(t,e))}:Nz(t)?{or:t.or.map(t=>Rz(t,e))}:e(t)}const Iz=Ez.a,Mz=kz.a;function Fz(t,e){const n={};for(const r of e)ue(t,r)&&(n[r]=t[r]);return n}function Pz(t,e){const n=Object.assign({},t);for(const r of e)delete n[r];return n}Set.prototype.toJSON=function(){return`Set(${[...this].map(t=>Az()(t)).join(",")})`};const jz=Az.a;function zz(t){if(ge(t))return t;const e=ve(t)?t:Az()(t);if(e.length<250)return e;let n=0;for(let r=0;r<e.length;r++)n=(n<<5)-n+e.charCodeAt(r),n&=n;return n}function Lz(t){return!1===t||null===t}function Bz(t,e){return t.indexOf(e)>-1}function Uz(t,e){let n=0;for(const[r,i]of t.entries())if(e(i,r,n++))return!0;return!1}function $z(t,e){let n=0;for(const[r,i]of t.entries())if(!e(i,r,n++))return!1;return!0}function Vz(t,e){for(const n of Kz(e))Ot(t,n,e[n],!0)}function Wz(t,e){const n=[],r={};let i;for(const o of t)i=e(o),i in r||(r[i]=1,n.push(o));return n}function qz(t,e){for(const n of t)if(e.has(n))return!0;return!1}function Hz(t){const e=new Set;for(const n of t){const t=st(n).map((t,e)=>0===e?t:`[${t}]`),r=t.map((e,n)=>t.slice(0,n+1).join(""));for(const n of r)e.add(n)}return e}function Gz(t,e){return void 0===t||void 0===e||qz(Hz(t),Hz(e))}function Xz(t){return 0===Kz(t).length}const Kz=Object.keys,Yz=Object.values;function Zz(t){const e=[];for(const n in t)ue(t,n)&&e.push({key:n,value:t[n]});return e}function Qz(t){return!0===t||!1===t}function Jz(t){const e=t.replace(/\W/g,"_");return(t.match(/^\d+/)?"_":"")+e}function tL(t,e){return Dz(t)?"!("+tL(t.not,e)+")":Tz(t)?"("+t.and.map(t=>tL(t,e)).join(") && (")+")":Nz(t)?"("+t.or.map(t=>tL(t,e)).join(") || (")+")":e(t)}function eL(t,e){if(0===e.length)return!0;const n=e.shift();return n in t&&eL(t[n],e)&&delete t[n],Xz(t)}function nL(t){return t.charAt(0).toUpperCase()+t.substr(1)}function rL(t,e="datum"){const n=st(t),r=[];for(let i=1;i<=n.length;i++){const t=`[${n.slice(0,i).map(Ee).join("][")}]`;r.push(`${e}${t}`)}return r.join(" && ")}function iL(t){return t.replace(/(\[|\]|\.|'|")/g,"\\$1")}function oL(t){return""+st(t).map(iL).join("\\.")}function aL(t,e,n){return t.replace(new RegExp(e.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&"),"g"),n)}function sL(t){return""+st(t).join(".")}function uL(t){return t?st(t).length:0}function lL(...t){for(const e of t)if(void 0!==e)return e}let cL=42;function hL(t){if(void 0!==t)return(t%360+360)%360}function dL(t){return!!ge(t)||!isNaN(t)&&!isNaN(parseFloat(t))}const fL={domainColor:{part:"domain",vgProp:"stroke"},labelAlign:{part:"labels",vgProp:"align"},labelBaseline:{part:"labels",vgProp:"baseline"},labelColor:{part:"labels",vgProp:"fill"},labelFont:{part:"labels",vgProp:"font"},labelFontSize:{part:"labels",vgProp:"fontSize"},labelFontStyle:{part:"labels",vgProp:"fontStyle"},labelFontWeight:{part:"labels",vgProp:"fontWeight"},labelOpacity:{part:"labels",vgProp:"opacity"},labelOffset:null,labelPadding:null,gridColor:{part:"grid",vgProp:"stroke"},gridDash:{part:"grid",vgProp:"strokeDash"},gridDashOffset:{part:"grid",vgProp:"strokeDash"},gridOpacity:{part:"grid",vgProp:"opacity"},gridWidth:{part:"grid",vgProp:"strokeWidth"},tickColor:{part:"ticks",vgProp:"stroke"},tickDash:{part:"ticks",vgProp:"strokeDash"},tickDashOffset:{part:"ticks",vgProp:"strokeDash"},tickOpacity:{part:"ticks",vgProp:"opacity"},tickSize:null,tickWidth:{part:"ticks",vgProp:"strokeWidth"},titleColor:{part:"title",vgProp:"fill"},title:null};function pL(t){return t&&t.condition}const mL=["domain","grid","labels","ticks","title"],gL={grid:"grid",gridCap:"grid",gridColor:"grid",gridDash:"grid",gridDashOffset:"grid",gridOpacity:"grid",gridScale:"grid",gridWidth:"grid",orient:"main",bandPosition:"both",aria:"main",description:"main",domain:"main",domainCap:"main",domainColor:"main",domainDash:"main",domainDashOffset:"main",domainOpacity:"main",domainWidth:"main",format:"main",formatType:"main",labelAlign:"main",labelAngle:"main",labelBaseline:"main",labelBound:"main",labelColor:"main",labelFlush:"main",labelFlushOffset:"main",labelFont:"main",labelFontSize:"main",labelFontStyle:"main",labelFontWeight:"main",labelLimit:"main",labelLineHeight:"main",labelOffset:"main",labelOpacity:"main",labelOverlap:"main",labelPadding:"main",labels:"main",labelSeparation:"main",maxExtent:"main",minExtent:"main",offset:"both",position:"main",tickCap:"main",tickColor:"main",tickDash:"main",tickDashOffset:"main",tickMinStep:"main",tickOffset:"both",tickOpacity:"main",tickRound:"both",ticks:"main",tickSize:"main",tickWidth:"both",title:"main",titleAlign:"main",titleAnchor:"main",titleAngle:"main",titleBaseline:"main",titleColor:"main",titleFont:"main",titleFontSize:"main",titleFontStyle:"main",titleFontWeight:"main",titleLimit:"main",titleLineHeight:"main",titleOpacity:"main",titlePadding:"main",titleX:"main",titleY:"main",encode:"both",scale:"both",tickBand:"both",tickCount:"both",tickExtra:"both",translate:"both",values:"both",zindex:"both"},yL={orient:1,aria:1,bandPosition:1,description:1,domain:1,domainCap:1,domainColor:1,domainDash:1,domainDashOffset:1,domainOpacity:1,domainWidth:1,format:1,formatType:1,grid:1,gridCap:1,gridColor:1,gridDash:1,gridDashOffset:1,gridOpacity:1,gridWidth:1,labelAlign:1,labelAngle:1,labelBaseline:1,labelBound:1,labelColor:1,labelFlush:1,labelFlushOffset:1,labelFont:1,labelFontSize:1,labelFontStyle:1,labelFontWeight:1,labelLimit:1,labelLineHeight:1,labelOffset:1,labelOpacity:1,labelOverlap:1,labelPadding:1,labels:1,labelSeparation:1,maxExtent:1,minExtent:1,offset:1,position:1,tickBand:1,tickCap:1,tickColor:1,tickCount:1,tickDash:1,tickDashOffset:1,tickExtra:1,tickMinStep:1,tickOffset:1,tickOpacity:1,tickRound:1,ticks:1,tickSize:1,tickWidth:1,title:1,titleAlign:1,titleAnchor:1,titleAngle:1,titleBaseline:1,titleColor:1,titleFont:1,titleFontSize:1,titleFontStyle:1,titleFontWeight:1,titleLimit:1,titleLineHeight:1,titleOpacity:1,titlePadding:1,titleX:1,titleY:1,translate:1,values:1,zindex:1},vL=Object.assign(Object.assign({},yL),{style:1,labelExpr:1,encoding:1});function bL(t){return!!vL[t]}Kz(vL);const wL={arc:"arc",area:"area",bar:"bar",image:"image",line:"line",point:"point",rect:"rect",rule:"rule",text:"text",tick:"tick",trail:"trail",circle:"circle",square:"square",geoshape:"geoshape"},xL=wL.arc,_L=wL.area,CL=wL.bar,kL=wL.image,SL=wL.line,EL=wL.point,OL=wL.rect,AL=wL.rule,NL=wL.text,TL=wL.tick,DL=wL.trail,RL=wL.circle,IL=wL.square,ML=wL.geoshape;function FL(t){return Bz(["line","area","trail"],t)}function PL(t){return Bz(["rect","bar","image","arc"],t)}const jL=Kz(wL);function zL(t){return t.type}De(jL);const LL=["stroke","strokeWidth","strokeDash","strokeDashOffset","strokeOpacity","strokeJoin","strokeMiterLimit","fill","fillOpacity"],BL=Kz({color:1,filled:1,invalid:1,order:1,radius2:1,theta2:1,timeUnitBand:1,timeUnitBandPosition:1}),UL={horizontal:["cornerRadiusTopRight","cornerRadiusBottomRight"],vertical:["cornerRadiusTopLeft","cornerRadiusTopRight"]};function $L(t){return"mark"in t}class VL{constructor(t,e){this.name=t,this.run=e}hasMatchingType(t){return!!$L(t)&&(zL(e=t.mark)?e.type:e)===this.name;var e}}const WL={argmax:1,argmin:1,average:1,count:1,distinct:1,product:1,max:1,mean:1,median:1,min:1,missing:1,q1:1,q3:1,ci0:1,ci1:1,stderr:1,stdev:1,stdevp:1,sum:1,valid:1,values:1,variance:1,variancep:1},qL={count:1,min:1,max:1};function HL(t){return!!t&&!!t.argmin}function GL(t){return!!t&&!!t.argmax}function XL(t){return ve(t)&&!!WL[t]}Kz(WL);const KL=["count","valid","missing","distinct"];function YL(t){return ve(t)&&Bz(KL,t)}const ZL=["count","sum","distinct","valid","missing"],QL=De(["mean","average","median","q1","q3","min","max"]),JL="row",tB="column",eB="radius",nB="theta",rB="theta2",iB="color",oB="fill",aB="stroke",sB="shape",uB="size",lB={theta:1,theta2:1,radius:1,radius2:1};function cB(t){return t in lB}const hB={longitude:1,longitude2:1,latitude:1,latitude2:1},dB=Kz(hB),fB=Object.assign(Object.assign(Object.assign(Object.assign({},{x:1,y:1,x2:1,y2:1}),lB),hB),{color:1,fill:1,stroke:1,opacity:1,fillOpacity:1,strokeOpacity:1,strokeWidth:1,strokeDash:1,size:1,angle:1,shape:1,order:1,text:1,detail:1,key:1,tooltip:1,href:1,url:1,description:1});function pB(t){return t===iB||t===oB||t===aB}const mB={row:1,column:1,facet:1},gB=Kz(mB),yB=Object.assign(Object.assign({},fB),mB),vB=Kz(yB),bB=Object(x.b)(yB,["order","detail","tooltip"]),wB=Object(x.b)(bB,["row","column","facet"]);function xB(t){return!!yB[t]}Kz(bB),Kz(wB);const _B=["x2","y2","latitude2","longitude2",rB,"radius2"];function CB(t){return kB(t)!==t}function kB(t){switch(t){case"x2":return"x";case"y2":return"y";case"latitude2":return"latitude";case"longitude2":return"longitude";case rB:return nB;case"radius2":return eB}return t}function SB(t){if(cB(t))switch(t){case nB:return"startAngle";case rB:return"endAngle";case eB:return"outerRadius";case"radius2":return"innerRadius"}return t}function EB(t){switch(t){case"x":return"x2";case"y":return"y2";case"latitude":return"latitude2";case"longitude":return"longitude2";case nB:return rB;case eB:return"radius2"}}function OB(t){switch(t){case"x":case"x2":return"width";case"y":case"y2":return"height"}}Kz(fB);const AB=Object(x.b)(fB,["x","y","x2","y2","latitude","longitude","latitude2","longitude2","theta","theta2","radius","radius2"]),NB=Kz(AB),TB={x:1,y:1},DB=Kz(TB);function RB(t){return t in TB}const IB={theta:1,radius:1},MB=Kz(IB);function FB(t){return"width"===t?"x":"y"}const PB=Object(x.b)(AB,["text","tooltip","href","url","description","detail","key","order"]),jB=Kz(PB),zB=Object.assign(Object.assign(Object.assign({},TB),IB),PB),LB=Kz(zB);function BB(t){return!!zB[t]}const UB={arc:"always",area:"always",bar:"always",circle:"always",geoshape:"always",image:"always",line:"always",rule:"always",point:"always",rect:"always",square:"always",trail:"always",text:"always",tick:"always"},$B=Object(x.b)(UB,["geoshape"]);function VB(t){switch(t){case"x":case"y":case nB:case eB:case uB:case"angle":case"strokeWidth":case"opacity":case"fillOpacity":case"strokeOpacity":case"x2":case"y2":case rB:case"radius2":return;case"facet":case JL:case tB:case sB:case"strokeDash":case"text":case"tooltip":case"href":case"url":case"description":return"discrete";case iB:case oB:case aB:return"flexible";case"latitude":case"longitude":case"latitude2":case"longitude2":case"detail":case"key":case"order":return}}function WB(t){return pe(t)&&(t=jW(t,void 0)),"bin"+Kz(t).map(e=>XB(t[e])?Jz(`_${e}_${Object.entries(t[e])}`):Jz(`_${e}_${t[e]}`)).join("")}function qB(t){return!0===t||GB(t)&&!t.binned}function HB(t){return"binned"===t||GB(t)&&!0===t.binned}function GB(t){return kt(t)}function XB(t){return null==t?void 0:t.selection}function KB(t){switch(t){case JL:case tB:case uB:case iB:case oB:case aB:case"strokeWidth":case"opacity":case"fillOpacity":case"strokeOpacity":case sB:return 6;case"strokeDash":return 4;default:return 10}}function YB(t){return`Invalid specification ${JSON.stringify(t)}. Make sure the specification includes at least one of the following properties: "mark", "layer", "facet", "hconcat", "vconcat", "concat", or "repeat".`}const ZB='Autosize "fit" only works for single views and layered views.';function QB(t){return("width"==t?"Width":"Height")+' "container" only works for single views and layered views.'}function JB(t){return`${"width"==t?"Width":"Height"} "container" only works well with autosize "fit" or "fit-${"width"==t?"x":"y"}".`}function tU(t){return t?`Dropping "fit-${t}" because spec has discrete ${OB(t)}.`:'Dropping "fit" because spec has discrete size.'}function eU(t){return`Cannot project a selection on encoding channel "${t}", which has no field.`}function nU(t,e){return`Cannot project a selection on encoding channel "${t}" as it uses an aggregate function ("${e}").`}function rU(t){return`The "nearest" transform is not supported for ${t} marks.`}function iU(t){return`Selection not supported for ${t} yet.`}function oU(t){return`Cannot find a selection named "${t}".`}const aU="Scale bindings are currently only supported for scales with unbinned, continuous domains.",sU="Legend bindings are only supported for selections over an individual field or encoding channel.";function uU(t){return`Cannot define and lookup the "${t}" selection in the same view. Try moving the lookup into a second, layered view?`}function lU(t){return`Unknown repeated value "${t}".`}function cU(t){return`The "columns" property cannot be used when "${t}" has nested row/column.`}const hU="Axes cannot be shared in concatenated or repeated views yet (https://github.com/vega/vega-lite/issues/2415).";function dU(t){return`Unrecognized parse "${t}".`}function fU(t,e,n){return`An ancestor parsed field "${t}" as ${n} but a child wants to parse the field as ${e}.`}function pU(t){return`Ignoring an invalid transform: ${jz(t)}.`}const mU='If "from.fields" is not specified, "as" has to be a string that specifies the key to be used for the data from the secondary source.';function gU(t){return`Config.customFormatTypes is not true, thus custom format type and format for channel ${t} are dropped.`}function yU(t){return`Layer's shared ${t.join(",")} channel ${1===t.length?"is":"are"} overriden.`}function vU(t){const{parentProjection:e,projection:n}=t;return`Layer's shared projection ${jz(e)} is overridden by a child projection ${jz(n)}.`}const bU="Arc marks uses theta channel rather than angle, replacing angle with theta.";function wU(t,e,n){return`Channel ${t} is a ${e}. Converted to {value: ${jz(n)}}.`}function xU(t){return`Invalid field type "${t}".`}function _U(t,e){return`Invalid field type "${t}" for aggregate: "${e}", using "quantitative" instead.`}function CU(t){return`Invalid aggregation operator "${t}".`}function kU(t,e){return`Missing type for channel "${t}", using "${e}" instead.`}function SU(t,e){const{fill:n,stroke:r}=e;return`Dropping color ${t} as the plot also has ${n&&r?"fill and stroke":n?"fill":"stroke"}.`}function EU(t,e){return`Dropping ${jz(t)} from channel "${e}" since it does not contain any data field, datum, value, or signal.`}function OU(t,e,n){return`${t}-encoding with type ${e} is deprecated. Replacing with ${n}-encoding.`}const AU="Line marks cannot encode size with a non-groupby field. You may want to use trail marks instead.";function NU(t,e,n){return`${t} dropped as it is incompatible with "${e}"${n?" when "+n:""}.`}function TU(t){return`${t}-encoding is dropped as ${t} is not a valid encoding channel.`}function DU(t){return t+" encoding should be discrete (ordinal / nominal / binned)."}function RU(t){return`Facet encoding dropped as ${t.join(" and ")} ${t.length>1?"are":"is"} also specified.`}function IU(t,e){return`Using discrete channel "${t}" to encode "${e}" field can be misleading as it does not encode ${"ordinal"===e?"order":"magnitude"}.`}function MU(t,e){return`Line mark is for continuous lines and thus cannot be used with ${t&&e?"x2 and y2":t?"x2":"y2"}. We will use the rule mark (line segments) instead.`}function FU(t,e){return`Specified orient "${t}" overridden with "${e}".`}const PU="Custom domain scale cannot be unioned with default field-based domain.",jU='Scale\'s "rangeStep" is deprecated and will be removed in Vega-Lite 5.0. Please use "width"/"height": {"step": ...} instead. See https://vega.github.io/vega-lite/docs/size.html.';function zU(t){return`Cannot use the scale property "${t}" with non-color channel.`}function LU(t){return`Using unaggregated domain with raw field has no effect (${jz(t)}).`}function BU(t){return`Unaggregated domain not applicable for "${t}" since it produces values outside the origin domain of the source data.`}function UU(t){return`Unaggregated domain is currently unsupported for log scale (${jz(t)}).`}function $U(t){return`Cannot apply size to non-oriented mark "${t}".`}function VU(t,e,n){return`Channel "${t}" does not work with "${e}" scale. We are using "${n}" scale instead.`}function WU(t,e){return`FieldDef does not work with "${t}" scale. We are using "${e}" scale instead.`}function qU(t,e,n){return`${n}-scale's "${e}" is dropped as it does not work with ${t} scale.`}function HU(t,e){return`Scale type "${e}" does not work with mark "${t}".`}function GU(t){return`The step for "${t}" is dropped because the ${"width"===t?"x":"y"} is continuous.`}function XU(t,e,n,r){return`Conflicting ${e.toString()} property "${t.toString()}" (${jz(n)} and ${jz(r)}). Using ${jz(n)}.`}function KU(t,e,n,r){return`Conflicting ${e.toString()} property "${t.toString()}" (${jz(n)} and ${jz(r)}). Using the union of the two domains.`}function YU(t){return`Setting the scale to be independent for "${t}" means we also have to set the guide (axis or legend) to be independent.`}function ZU(t){return`Dropping sort property ${jz(t)} as unioned domains only support boolean or op "count", "min", and "max".`}const QU="Domains that should be unioned has conflicting sort properties. Sort will be set to true.",JU="Detected faceted independent scales that union domain of multiple fields from different data sources. We will use the first field. The result view size may be incorrect.",t$="Detected faceted independent scales that union domain of the same fields from different source. We will assume that this is the same field from a different fork of the same data source. However, if this is not the case, the result view size may be incorrect.",e$="Detected faceted independent scales that union domain of multiple fields from the same data source. We will use the first field. The result view size may be incorrect.",n$="Invalid channel for axis.";function r$(t){return`Cannot stack "${t}" if there is already "${t}2".`}function i$(t){return`Cannot stack non-linear scale (${t}).`}function o$(t){return`Stacking is applied even though the aggregate function is non-summative ("${t}").`}function a$(t,e){return`Invalid ${t}: ${jz(e)}.`}function s$(t){return`Dropping day from datetime ${jz(t)} as day cannot be combined with other units.`}function u$(t,e){return`${e?"extent ":""}${e&&t?"and ":""}${t?"center ":""}${e&&t?"are ":"is "}not needed when data are aggregated.`}function l$(t,e,n){return`${t} is not usually used with ${e} for ${n}.`}function c$(t,e){return`Continuous axis should not have customized aggregation function ${t}; ${e} already agregates the axis.`}function h$(t,e){return`Center is not needed to be specified in ${e} when extent is ${t}.`}function d$(t){return`1D error band does not support ${t}.`}function f$(t){return`Channel ${t} is required for "binned" bin.`}function p$(t){return`Domain for ${t} is required for threshold scale.`}const m$=_t(bt);let g$=m$;function y$(...t){g$.warn(...t)}function v$(t){if(t&&kt(t))for(const e of E$)if(e in t)return!0;return!1}const b$=["january","february","march","april","may","june","july","august","september","october","november","december"],w$=b$.map(t=>t.substr(0,3)),x$=["sunday","monday","tuesday","wednesday","thursday","friday","saturday"],_$=x$.map(t=>t.substr(0,3));function C$(t,e){const n=[];if(e&&void 0!==t.day&&Kz(t).length>1&&(y$(y.droppedDay(t)),delete(t=Mz(t)).day),n.push(void 0!==t.year?t.year:2012),void 0!==t.month){const r=e?function(t){if(dL(t)&&(t=+t),ge(t))return t-1;{const e=t.toLowerCase(),n=b$.indexOf(e);if(-1!==n)return n;const r=e.substr(0,3),i=w$.indexOf(r);if(-1!==i)return i;throw new Error(y.invalidTimeUnit("month",t))}}(t.month):t.month;n.push(r)}else if(void 0!==t.quarter){const r=e?function(t){if(dL(t)&&(t=+t),ge(t))return t>4&&y$(y.invalidTimeUnit("quarter",t)),t-1;throw new Error(y.invalidTimeUnit("quarter",t))}(t.quarter):t.quarter;n.push(ge(r)?3*r:r+"*3")}else n.push(0);if(void 0!==t.date)n.push(t.date);else if(void 0!==t.day){const r=e?function(t){if(dL(t)&&(t=+t),ge(t))return t%7;{const e=t.toLowerCase(),n=x$.indexOf(e);if(-1!==n)return n;const r=e.substr(0,3),i=_$.indexOf(r);if(-1!==i)return i;throw new Error(y.invalidTimeUnit("day",t))}}(t.day):t.day;n.push(ge(r)?r+1:r+"+1")}else n.push(1);for(const r of["hours","minutes","seconds","milliseconds"]){const e=t[r];n.push(void 0===e?0:e)}return n}function k$(t){const e=C$(t,!0).join(", ");return t.utc?`utc(${e})`:`datetime(${e})`}const S$={year:1,quarter:1,month:1,week:1,day:1,dayofyear:1,date:1,hours:1,minutes:1,seconds:1,milliseconds:1},E$=Kz(S$);function O$(t){return t.startsWith("utc")}const A$={"year-month":"%b %Y ","year-month-date":"%b %d, %Y "};function N$(t){const e=[];for(const n of E$)T$(t,n)&&e.push(n);return e}function T$(t,e){const n=t.indexOf(e);return!(n<0||n>0&&"seconds"===e&&"i"===t.charAt(n-1)||t.length>n+3&&"day"===e&&"o"===t.charAt(n+3)||n>0&&"year"===e&&"f"===t.charAt(n-1))}function D$(t){if(!t)return;const e=N$(t);return`timeUnitSpecifier(${Az()(e)}, ${Az()(A$)})`}function R$(t){if(!t)return;let e;return ve(t)?e={unit:t}:kt(t)&&(e=Object.assign(Object.assign({},t),t.unit?{unit:t.unit}:{})),O$(e.unit)&&(e.utc=!0,e.unit=e.unit.substr(3)),e}function I$(t){return t&&!!t.signal}function M$(t){return!!t.step}function F$(t){return!Ct(t)&&"field"in t&&"data"in t}const P$=Kz({aria:1,description:1,ariaRole:1,ariaRoleDescription:1,blend:1,opacity:1,fill:1,fillOpacity:1,stroke:1,strokeCap:1,strokeWidth:1,strokeOpacity:1,strokeDash:1,strokeDashOffset:1,strokeJoin:1,strokeOffset:1,strokeMiterLimit:1,startAngle:1,endAngle:1,padAngle:1,innerRadius:1,outerRadius:1,size:1,shape:1,interpolate:1,tension:1,orient:1,align:1,baseline:1,text:1,dir:1,dx:1,dy:1,ellipsis:1,limit:1,radius:1,theta:1,angle:1,font:1,fontSize:1,fontWeight:1,fontStyle:1,lineBreak:1,lineHeight:1,cursor:1,href:1,tooltip:1,cornerRadius:1,cornerRadiusTopLeft:1,cornerRadiusTopRight:1,cornerRadiusBottomLeft:1,cornerRadiusBottomRight:1,aspect:1,width:1,height:1}),j$={arc:1,area:1,group:1,image:1,line:1,path:1,rect:1,rule:1,shape:1,symbol:1,text:1,trail:1},z$=["cornerRadius","cornerRadiusTopLeft","cornerRadiusTopRight","cornerRadiusBottomLeft","cornerRadiusBottomRight"];function L$(t){return t&&!!t.field&&void 0!==t.equal}function B$(t){return t&&!!t.field&&void 0!==t.lt}function U$(t){return t&&!!t.field&&void 0!==t.lte}function $$(t){return t&&!!t.field&&void 0!==t.gt}function V$(t){return t&&!!t.field&&void 0!==t.gte}function W$(t){if(t&&t.field){if(Ct(t.range)&&2===t.range.length)return!0;if(I$(t.range))return!0}return!1}function q$(t){return t&&!!t.field&&(Ct(t.oneOf)||Ct(t.in))}function H$(t){return q$(t)||L$(t)||W$(t)||B$(t)||$$(t)||U$(t)||V$(t)}function G$(t,e){return BW(t,{timeUnit:e,wrapTime:!0})}function X$(t,e=!0){var n;const{field:r}=t,i=null===(n=R$(t.timeUnit))||void 0===n?void 0:n.unit,o=i?"time("+function(t,e,{end:n}={end:!1}){const r=rL(e),i=O$(t)?"utc":"";let o;const a={};for(const u of E$)T$(t,u)&&(a[u]="quarter"===(s=u)?`(${i}quarter(${r})-1)`:`${i}${s}(${r})`,o=u);var s;return n&&(a[o]+="+1"),function(t){const e=C$(t,!1).join(", ");return t.utc?`utc(${e})`:`datetime(${e})`}(a)}(i,r)+")":_W(t,{expr:"datum"});if(L$(t))return o+"==="+G$(t.equal,i);if(B$(t))return`${o}<${G$(t.lt,i)}`;if($$(t))return`${o}>${G$(t.gt,i)}`;if(U$(t))return`${o}<=${G$(t.lte,i)}`;if(V$(t))return`${o}>=${G$(t.gte,i)}`;if(q$(t))return`indexof([${function(t,e){return t.map(t=>G$(t,e))}(t.oneOf,i).join(",")}], ${o}) !== -1`;if(function(t){return t&&!!t.field&&void 0!==t.valid}(t))return K$(o,t.valid);if(W$(t)){const{range:n}=t,r=I$(n)?{signal:n.signal+"[0]"}:n[0],a=I$(n)?{signal:n.signal+"[1]"}:n[1];if(null!==r&&null!==a&&e)return"inrange("+o+", ["+G$(r,i)+", "+G$(a,i)+"])";const s=[];return null!==r&&s.push(`${o} >= ${G$(r,i)}`),null!==a&&s.push(`${o} <= ${G$(a,i)}`),s.length>0?s.join(" && "):"true"}throw new Error("Invalid field predicate: "+JSON.stringify(t))}function K$(t,e=!0){return e?`isValid(${t}) && isFinite(+${t})`:`!isValid(${t}) || !isFinite(+${t})`}function Y$(t){var e;return H$(t)&&t.timeUnit?Object.assign(Object.assign({},t),{timeUnit:null===(e=R$(t.timeUnit))||void 0===e?void 0:e.unit}):t}const Z$={quantitative:"quantitative",ordinal:"ordinal",temporal:"temporal",nominal:"nominal",geojson:"geojson"},Q$=Z$.quantitative,J$=Z$.ordinal,tV=Z$.temporal,eV=Z$.nominal,nV=Z$.geojson,rV=Kz(Z$),iV={linear:"numeric",log:"numeric",pow:"numeric",sqrt:"numeric",symlog:"numeric",identity:"numeric",sequential:"numeric",time:"time",utc:"time",ordinal:"ordinal","bin-ordinal":"bin-ordinal",point:"ordinal-position",band:"ordinal-position",quantile:"discretizing",quantize:"discretizing",threshold:"discretizing"},oV=Kz(iV);function aV(t,e){const n=iV[t],r=iV[e];return n===r||"ordinal-position"===n&&"time"===r||"ordinal-position"===r&&"time"===n}const sV={linear:0,log:1,pow:1,sqrt:1,symlog:1,identity:1,sequential:1,time:0,utc:0,point:10,band:11,ordinal:0,"bin-ordinal":0,quantile:0,quantize:0,threshold:0};function uV(t){return sV[t]}const lV=["linear","log","pow","sqrt","symlog","time","utc"],cV=De(lV),hV=De(["linear","log","pow","sqrt","symlog"]),dV=De(["quantile","quantize","threshold"]),fV=lV.concat(["quantile","quantize","threshold","sequential","identity"]),pV=De(fV),mV=De(["ordinal","bin-ordinal","point","band"]);function gV(t){return t in mV}function yV(t){return t in pV}function vV(t){return t in cV}function bV(t){return t in dV}function wV(t){return null==t?void 0:t.selection}const xV={type:1,domain:1,domainMid:1,align:1,range:1,scheme:1,bins:1,reverse:1,round:1,clamp:1,nice:1,base:1,exponent:1,constant:1,interpolate:1,zero:1,padding:1,paddingInner:1,paddingOuter:1},_V=(Kz(xV),Object(x.b)(xV,["type","domain","range","scheme"])),CV=Kz(_V);function kV(t,e){switch(e){case"type":case"domain":case"reverse":case"range":return!0;case"scheme":case"interpolate":return!Bz(["point","band","identity"],t);case"bins":return!Bz(["point","band","identity","ordinal"],t);case"round":return vV(t)||"band"===t||"point"===t;case"padding":return vV(t)||Bz(["point","band"],t);case"paddingOuter":case"align":return Bz(["point","band"],t);case"paddingInner":return"band"===t;case"domainMid":case"clamp":return vV(t);case"nice":return vV(t)||"quantize"===t||"threshold"===t;case"exponent":return"pow"===t;case"base":return"log"===t;case"constant":return"symlog"===t;case"zero":return yV(t)&&!Bz(["log","time","utc","threshold","quantile"],t)}}function SV(t,e){switch(e){case"interpolate":case"scheme":case"domainMid":return pB(t)?void 0:y.cannotUseScalePropertyWithNonColor(t);case"align":case"type":case"bins":case"domain":case"range":case"base":case"exponent":case"constant":case"nice":case"padding":case"paddingInner":case"paddingOuter":case"reverse":case"round":case"clamp":case"zero":return}}function EV(t,e){return Bz([J$,eV],e)?void 0===t||gV(t):e===tV?Bz(["time","utc",void 0],t):e!==Q$||Bz(["log","pow","sqrt","symlog","quantile","quantize","threshold","linear",void 0],t)}function OV(t,e){if(!BB(t))return!1;switch(t){case"x":case"y":case nB:case eB:return vV(e)||Bz(["band","point"],e);case uB:case"strokeWidth":case"opacity":case"fillOpacity":case"strokeOpacity":case"angle":return vV(e)||bV(e)||Bz(["band","point","ordinal"],e);case iB:case oB:case aB:return"band"!==e;case"strokeDash":return"ordinal"===e||bV(e);case sB:return"ordinal"===e}}function AV(t,e){return t+"_"+e}function NV(t){const{channel:e,channelDef:n,markDef:r,scale:i,config:o}=t,a=FV(t);return cW(n)&&!YL(n.aggregate)&&i&&vV(i.get("type"))&&!1===i.get("zero")?TV({fieldDef:n,channel:e,markDef:r,ref:a,config:o}):a}function TV({fieldDef:t,channel:e,markDef:n,ref:r,config:i}){return FL(n.type)||null===KW("invalid",n,i)?r:[DV(t,e),r]}function DV(t,e){const n=RV(t,!0),r=kB(e);return Object.assign({test:n},"y"===r?{field:{group:"height"}}:{value:0})}function RV(t,e=!0){return K$(ve(t)?t:_W(t,{expr:"datum"}),!e)}function IV(t,e,n,r){const i={};if(e&&(i.scale=e),dW(t)){const{datum:e}=t;v$(e)?i.signal=k$(e):I$(e)?i.signal=e.signal:i.value=e}else i.field=_W(t,n);if(r){const{offset:t,band:e}=r;t&&(i.offset=t),e&&(i.band=e)}return i}function MV({scaleName:t,fieldOrDatumDef:e,fieldOrDatumDef2:n,offset:r,startSuffix:i,band:o=.5}){const a=0<o&&o<1?"datum":void 0,s=_W(e,{expr:a,suffix:i}),u=void 0!==n?_W(n,{expr:a}):_W(e,{suffix:"end",expr:a}),l={};return 0===o||1===o?(l.scale=t,l.field=0===o?s:u):l.signal=`scale("${t}", ${o} * ${s} + ${1-o} * ${u})`,r&&(l.offset=r),l}function FV({channel:t,channelDef:e,channel2Def:n,markDef:r,config:i,scaleName:o,scale:a,stack:s,offset:u,defaultRef:l,band:c}){var h;if(e){if(mW(e)){if(gW(e)){c=null!=c?c:oW({channel:t,fieldDef:e,fieldDef2:n,markDef:r,stack:s,config:i,isMidPoint:!0});const{bin:a,timeUnit:l,type:h}=e;if(qB(a)||c&&l&&h===tV)return s&&s.impute?IV(e,o,{binSuffix:"mid"},{offset:u}):c?MV({scaleName:o,fieldOrDatumDef:e,band:c,offset:u}):IV(e,o,$W(e,t)?{binSuffix:"range"}:{},{offset:u});if(HB(a)){if(cW(n))return MV({scaleName:o,fieldOrDatumDef:e,fieldOrDatumDef2:n,band:c,offset:u});y$(y.channelRequiredForBinned("x"===t?"x2":"y2"))}}const l=null==a?void 0:a.get("type");return IV(e,o,gV(l)?{binSuffix:"range"}:{},{offset:u,band:"band"===l?null!==(h=null!=c?c:e.band)&&void 0!==h?h:.5:void 0})}if(yW(e)){const n=u?{offset:u}:{};return Object.assign(Object.assign({},PV(t,e.value)),n)}}return Yt(l)&&(l=l()),l?Object.assign(Object.assign({},l),u?{offset:u}:{}):l}function PV(t,e){return Bz(["x","x2"],t)&&"width"===e?{field:{group:"width"}}:Bz(["y","y2"],t)&&"height"===e?{field:{group:"height"}}:qW(e)}function jV(t){return t&&"number"!==t&&"time"!==t}function zV(t,e,n){return`${t}(${e}${n?", "+JSON.stringify(n):""})`}function LV({fieldOrDatumDef:t,format:e,formatType:n,expr:r,normalizeStack:i,config:o}){var a,s;if(jV(n))return UV({fieldOrDatumDef:t,format:e,formatType:n,expr:r,config:o});const u=BV(t,r,i);if(LW(t)){const n=function(t,e,n,r,i){return!e||n?`${i?"utc":"time"}Format(${t}, '${n=ve(n)?n:r}')`:function(t,e,n){if(!t)return;const r=D$(t);return`${n||O$(t)?"utc":"time"}Format(${e}, ${r})`}(e,t,i)}(u,cW(t)?null===(a=R$(t.timeUnit))||void 0===a?void 0:a.unit:void 0,e,o.timeFormat,vW(t)&&"utc"===(null===(s=t.scale)||void 0===s?void 0:s.type));return n?{signal:n}:void 0}return e=WV(hW(t),e,o),cW(t)&&qB(t.bin)?{signal:GV(u,_W(t,{expr:r,binSuffix:"end"}),e,n,o)}:e||"quantitative"===hW(t)?{signal:""+qV(u,e)}:{signal:`isValid(${u}) ? ${u} : ""+${u}`}}function BV(t,e,n){return cW(t)?n?`${_W(t,{expr:e,suffix:"end"})}-${_W(t,{expr:e,suffix:"start"})}`:_W(t,{expr:e}):function(t){const{datum:e}=t;return v$(e)?k$(e):""+JSON.stringify(e)}(t)}function UV({fieldOrDatumDef:t,format:e,formatType:n,expr:r,normalizeStack:i,config:o,field:a}){return a=null!=a?a:BV(t,r,i),cW(t)&&qB(t.bin)?{signal:GV(a,_W(t,{expr:r,binSuffix:"end"}),e,n,o)}:{signal:zV(n,a,e)}}function $V(t,e,n,r,i,o){var a;if(!jV(r))return LW(t)?function(t,e,n,r){return t||(e?{signal:D$(e)}:r?void 0:n.timeFormat)}(n,cW(t)?null===(a=R$(t.timeUnit))||void 0===a?void 0:a.unit:void 0,i,o):WV(e,n,i)}function VV(t,e,n){return t&&(I$(t)||"number"===t||"time"===t)?t:LW(e)&&"time"!==n&&"utc"!==n?"time":void 0}function WV(t,e,n){return ve(e)?e:t===Q$?n.numberFormat:void 0}function qV(t,e){return`format(${t}, "${e||""}")`}function HV(t,e,n,r){var i;return jV(n)?zV(n,t,e):qV(t,null!==(i=ve(e)?e:void 0)&&void 0!==i?i:r.numberFormat)}function GV(t,e,n,r,i){const o=HV(t,n,r,i),a=HV(e,n,r,i);return`${K$(t,!1)} ? "null" : ${o} + " \u2013 " + ${a}`}!function(){var t;const e={};for(const n of vB)for(const r of rV)for(const i of oV){const o=AV(n,r);OV(n,i)&&EV(i,r)&&(e[o]=null!==(t=e[o])&&void 0!==t?t:[],e[o].push(i))}}();const XV="min",KV={x:1,y:1,color:1,fill:1,stroke:1,strokeWidth:1,size:1,shape:1,fillOpacity:1,strokeOpacity:1,opacity:1,text:1};function YV(t){return t in KV}function ZV(t){return!!t&&!!t.encoding}function QV(t){return!(!t||"count"!==t.op&&!t.field)}function JV(t){return!!t&&Ct(t)}function tW(t){return"row"in t||"column"in t}function eW(t){return!!t&&"header"in t}function nW(t){return"facet"in t}function rW(t){const{field:e,timeUnit:n,bin:r,aggregate:i}=t;return Object.assign(Object.assign(Object.assign(Object.assign({},n?{timeUnit:n}:{}),r?{bin:r}:{}),i?{aggregate:i}:{}),{field:e})}function iW(t){return gW(t)&&"sort"in t}function oW({channel:t,fieldDef:e,fieldDef2:n,markDef:r,stack:i,config:o,isMidPoint:a}){if(mW(e)&&void 0!==e.band)return e.band;if(cW(e)){const{timeUnit:t,bin:i}=e;if(t&&!n)return a?YW("timeUnitBandPosition",r,o):PL(r.type)?YW("timeUnitBand",r,o):0;if(qB(i))return PL(r.type)&&!a?1:.5}return(null==i?void 0:i.fieldChannel)===t&&a?.5:void 0}function aW(t,e,n,r,i,o){return!!(qB(e.bin)||e.timeUnit&&gW(e)&&"temporal"===e.type)&&!!oW({channel:t,fieldDef:e,fieldDef2:n,stack:r,markDef:i,config:o})}function sW(t){return!!t&&"condition"in t}function uW(t){const e=t&&t.condition;return!!e&&!Ct(e)&&cW(e)}function lW(t){const e=t&&t.condition;return!!e&&!Ct(e)&&mW(e)}function cW(t){return!(!t||!t.field&&"count"!==t.aggregate)}function hW(t){return t&&t.type}function dW(t){return!!t&&"datum"in t}function fW(t){return gW(t)&&kW(t)||pW(t)}function pW(t){return dW(t)&&ge(t.datum)}function mW(t){return cW(t)||dW(t)}function gW(t){return!!t&&("field"in t&&"type"in t||"count"===t.aggregate)}function yW(t){return t&&"value"in t&&"value"in t}function vW(t){return!!t&&("scale"in t||"sort"in t)}function bW(t){return t&&("axis"in t||"stack"in t||"impute"in t)}function wW(t){return!!t&&"legend"in t}function xW(t){return!!t&&("format"in t||"formatType"in t)}function _W(t,e={}){var n,r,i;let o=t.field;const a=e.prefix;let s=e.suffix,u="";if(function(t){return"count"===t.aggregate}(t))o=0==="count".indexOf("__")?"count":"__count";else{let a;if(!e.nofn)if(function(t){return"op"in t}(t))a=t.op;else{const{bin:l,aggregate:c,timeUnit:h}=t;qB(l)?(a=WB(l),s=(null!==(n=e.binSuffix)&&void 0!==n?n:"")+(null!==(r=e.suffix)&&void 0!==r?r:"")):c?GL(c)?(u=`["${o}"]`,o="argmax_"+c.argmax):HL(c)?(u=`["${o}"]`,o="argmin_"+c.argmin):a=String(c):h&&(a=function(t){const e=R$(t),{utc:n}=e,r=Object(x.b)(e,["utc"]);return r.unit?(n?"utc":"")+Kz(r).map(t=>Jz(`${"unit"===t?"":`_${t}_`}${r[t]}`)).join(""):(n?"utc":"")+"timeunit"+Kz(r).map(t=>Jz(`_${t}_${r[t]}`)).join("")}(h),s=(!Bz(["range","mid"],e.binSuffix)&&e.binSuffix||"")+(null!==(i=e.suffix)&&void 0!==i?i:""))}a&&(o=o?`${a}_${o}`:a)}return s&&(o=`${o}_${s}`),a&&(o=`${a}_${o}`),e.forAs?sL(o):e.expr?function(t,e="datum"){return`${e}[${Ee(st(t).join("."))}]`}(o,e.expr)+u:oL(o)+u}function CW(t){switch(t.type){case"nominal":case"ordinal":case"geojson":return!0;case"quantitative":return cW(t)&&!!t.bin;case"temporal":return!1}throw new Error(y.invalidFieldType(t.type))}function kW(t){return!CW(t)}const SW=(t,e)=>{switch(e.fieldTitle){case"plain":return t.field;case"functional":return function(t){const{aggregate:e,bin:n,timeUnit:r,field:i}=t;if(GL(e))return`${i} for argmax(${e.argmax})`;if(HL(e))return`${i} for argmin(${e.argmin})`;const o=R$(r),a=e||(null==o?void 0:o.unit)||(null==o?void 0:o.maxbins)&&"timeunit"||qB(n)&&"bin";return a?a.toUpperCase()+"("+i+")":i}(t);default:return function(t,e){var n;const{field:r,bin:i,timeUnit:o,aggregate:a}=t;if("count"===a)return e.countTitle;if(qB(i))return r+" (binned)";if(o){const t=null===(n=R$(o))||void 0===n?void 0:n.unit;if(t)return`${r} (${N$(t).join("-")})`}else if(a)return GL(a)?`${r} for max ${a.argmax}`:HL(a)?`${r} for min ${a.argmin}`:`${nL(a)} of ${r}`;return r}(t,e)}};let EW=SW;function OW(t){EW=t}function AW(t,e,{allowDisabling:n,includeDefault:r=!0}){var i,o;const a=(null!==(i=NW(t))&&void 0!==i?i:{}).title;if(!cW(t))return a;const s=t,u=r?TW(s,e):void 0;return n?lL(a,s.title,u):null!==(o=null!=a?a:s.title)&&void 0!==o?o:u}function NW(t){return bW(t)&&t.axis?t.axis:wW(t)&&t.legend?t.legend:eW(t)&&t.header?t.header:void 0}function TW(t,e){return EW(t,e)}function DW(t){var e;if(xW(t)){const{format:e,formatType:n}=t;return{format:e,formatType:n}}{const n=null!==(e=NW(t))&&void 0!==e?e:{},{format:r,formatType:i}=n;return{format:r,formatType:i}}}function RW(t){return cW(t)?t:uW(t)?t.condition:void 0}function IW(t){return mW(t)?t:lW(t)?t.condition:void 0}function MW(t,e,n){if(ve(t)||ge(t)||pe(t)){const n=ve(t)?"string":ge(t)?"number":"boolean";return y$(y.primitiveChannelDef(e,n,t)),{value:t}}return mW(t)?FW(t,e,n):lW(t)?Object.assign(Object.assign({},t),{condition:FW(t.condition,e,n)}):t}function FW(t,e,n){if(xW(t)){const{formatType:r}=t,i=Object(x.b)(t,["format","formatType"]);if(jV(r)&&!n.customFormatTypes)return y$(y.customFormatTypeNotAllowed(e)),FW(i,e,n)}else{const r=bW(t)?"axis":wW(t)?"legend":eW(t)?"header":null;if(r&&t[r]){const i=t[r],{formatType:o}=i,a=Object(x.b)(i,["format","formatType"]);if(jV(o)&&!n.customFormatTypes)return y$(y.customFormatTypeNotAllowed(e)),FW(Object.assign(Object.assign({},t),{[r]:a}),e,n)}}return cW(t)?PW(t,e):function(t){let e=t.type;if(e)return t;const{datum:n}=t;return e=ge(n)?"quantitative":ve(n)?"nominal":v$(n)?"temporal":void 0,Object.assign(Object.assign({},t),{type:e})}(t)}function PW(t,e){const{aggregate:n,timeUnit:r,bin:i,field:o}=t,a=Object.assign({},t);if(!n||XL(n)||GL(n)||HL(n)||(y$(y.invalidAggregate(n)),delete a.aggregate),r&&(a.timeUnit=R$(r)),o&&(a.field=""+o),qB(i)&&(a.bin=jW(i,e)),HB(i)&&!RB(e)&&y$(`Channel ${e} should not be used with "binned" bin.`),gW(a)){const{type:t}=a,e=function(t){if(t)switch(t=t.toLowerCase()){case"q":case Q$:return"quantitative";case"t":case tV:return"temporal";case"o":case J$:return"ordinal";case"n":case eV:return"nominal";case nV:return"geojson"}}(t);t!==e&&(a.type=e),"quantitative"!==t&&YL(n)&&(y$(y.invalidFieldTypeForCountAggregate(t,n)),a.type="quantitative")}else if(!CB(e)){const t=function(t,e){if(t.timeUnit)return"temporal";if(qB(t.bin))return"quantitative";switch(VB(e)){case"continuous":return"quantitative";case"discrete":case"flexible":return"nominal";default:return"quantitative"}}(a,e);y$(y.missingFieldType(e,t)),a.type=t}if(gW(a)){const{compatible:t,warning:n}=function(t,e){const n=t.type;if("geojson"===n&&"shape"!==e)return{compatible:!1,warning:`Channel ${e} should not be used with a geojson data.`};switch(e){case JL:case tB:case"facet":return kW(t)?{compatible:!1,warning:y.facetChannelShouldBeDiscrete(e)}:zW;case"x":case"y":case iB:case oB:case aB:case"text":case"detail":case"key":case"tooltip":case"href":case"url":case"angle":case nB:case eB:case"description":return zW;case"longitude":case"longitude2":case"latitude":case"latitude2":return n!==Q$?{compatible:!1,warning:`Channel ${e} should be used with a quantitative field only, not ${t.type} field.`}:zW;case"opacity":case"fillOpacity":case"strokeOpacity":case"strokeWidth":case uB:case rB:case"radius2":case"x2":case"y2":return"nominal"!==n||t.sort?zW:{compatible:!1,warning:`Channel ${e} should not be used with an unsorted discrete field.`};case"strokeDash":return Bz(["ordinal","nominal"],t.type)?zW:{compatible:!1,warning:"StrokeDash channel should be used with only discrete data."};case sB:return Bz(["ordinal","nominal","geojson"],t.type)?zW:{compatible:!1,warning:"Shape channel should be used with only either discrete or geojson data."};case"order":return"nominal"!==t.type||"sort"in t?zW:{compatible:!1,warning:"Channel order is inappropriate for nominal field, which has no inherent order."}}}(a,e);t||y$(n)}if(iW(a)&&ve(a.sort)){const{sort:t}=a;if(YV(t))return Object.assign(Object.assign({},a),{sort:{encoding:t}});const e=t.substr(1);if("-"===t.charAt(0)&&YV(e))return Object.assign(Object.assign({},a),{sort:{encoding:e,order:"descending"}})}if(eW(a)){const{header:t}=a,{orient:e}=t,n=Object(x.b)(t,["orient"]);if(e)return Object.assign(Object.assign({},a),{header:Object.assign(Object.assign({},n),{labelOrient:t.labelOrient||e,titleOrient:t.titleOrient||e})})}return a}function jW(t,e){return pe(t)?{maxbins:KB(e)}:"binned"===t?{binned:!0}:t.maxbins||t.step?t:Object.assign(Object.assign({},t),{maxbins:KB(e)})}const zW={compatible:!0};function LW(t){const{formatType:e}=DW(t);return"time"===e||!e&&(n=t)&&("temporal"===n.type||cW(n)&&!!n.timeUnit);var n}function BW(t,{timeUnit:e,type:n,wrapTime:r,undefinedIfExprNotRequired:i}){var o;const a=e&&(null===(o=R$(e))||void 0===o?void 0:o.unit);let s,u=a||"temporal"===n;return I$(t)?s=t.signal:v$(t)?(u=!0,s=k$(t)):(ve(t)||ge(t))&&u&&(s=`datetime(${JSON.stringify(t)})`,function(t){return!!S$[t]}(a)&&(ge(t)&&t<1e4||ve(t)&&isNaN(Date.parse(t)))&&(s=k$({[a]:t}))),s?r&&u?`time(${s})`:s:i?void 0:JSON.stringify(t)}function UW(t,e){const{type:n}=t;return e.map(e=>{const r=BW(e,{timeUnit:cW(t)?t.timeUnit:void 0,type:n,undefinedIfExprNotRequired:!0});return void 0!==r?{signal:r}:e})}function $W(t,e){return qB(t.bin)?BB(e)&&Bz(["ordinal","nominal"],t.type):(console.warn("Only call this method for binned field defs."),!1)}function VW(t){const{anchor:e,frame:n,offset:r,orient:i,color:o,subtitleColor:a,subtitleFont:s,subtitleFontSize:u,subtitleFontStyle:l,subtitleFontWeight:c,subtitleLineHeight:h,subtitlePadding:d}=t,f=Object(x.b)(t,["anchor","frame","offset","orient","color","subtitleColor","subtitleFont","subtitleFontSize","subtitleFontStyle","subtitleFontWeight","subtitleLineHeight","subtitlePadding"]),p=Object.assign(Object.assign({},f),o?{fill:o}:{}),m=Object.assign(Object.assign(Object.assign(Object.assign({},e?{anchor:e}:{}),n?{frame:n}:{}),r?{offset:r}:{}),i?{orient:i}:{}),g=Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},a?{subtitleColor:a}:{}),s?{subtitleFont:s}:{}),u?{subtitleFontSize:u}:{}),l?{subtitleFontStyle:l}:{}),c?{subtitleFontWeight:c}:{}),h?{subtitleLineHeight:h}:{}),d?{subtitlePadding:d}:{});return{titleMarkConfig:p,subtitleMarkConfig:Fz(p,["align","baseline","dx","dy","limit"]),nonMark:m,subtitle:g}}function WW(t){return ve(t)||Ct(t)&&ve(t[0])}function qW(t){return I$(t)?t:void 0!==t?{value:t}:void 0}function HW(t){return I$(t)?t.signal:Ee(t.value)}function GW(t){return I$(t)?t.signal:null==t?null:Ee(t)}function XW(t){var e;return[].concat(t.type,null!==(e=t.style)&&void 0!==e?e:[])}function KW(t,e,n,r={}){const{vgChannel:i,ignoreVgConfig:o}=r;return i&&void 0!==e[i]?e[i]:void 0!==e[t]?e[t]:!o||i&&i!==t?YW(t,e,n,r):void 0}function YW(t,e,n,{vgChannel:r}={}){return lL(r?ZW(t,e,n.style):void 0,ZW(t,e,n.style),r?n[e.type][r]:void 0,n[e.type][t],r?n.mark[r]:n.mark[t])}function ZW(t,e,n){return QW(t,XW(e),n)}function QW(t,e,n){let r;e=Xt(e);for(const i of e){const e=n[i];e&&void 0!==e[t]&&(r=e[t])}return r}function JW(t,e){return Xt(t).reduce((t,n)=>{var r;return t.field.push(_W(n,e)),t.order.push(null!==(r=n.sort)&&void 0!==r?r:"ascending"),t},{field:[],order:[]})}function tq(t,e){const n=[...t];return e.forEach(t=>{for(const e of n)if(Iz(e,t))return;n.push(t)}),n}function eq(t,e){return Iz(t,e)||!e?t:t?[...Xt(t),...Xt(e)].join(", "):e}function nq(t,e){const n=t.value,r=e.value;if(null==n||null===r)return{explicit:t.explicit,value:null};if((WW(n)||I$(n))&&(WW(r)||I$(r)))return{explicit:t.explicit,value:eq(n,r)};if(WW(n)||I$(n))return{explicit:t.explicit,value:n};if(WW(r)||I$(r))return{explicit:t.explicit,value:r};if(!(WW(n)||I$(n)||WW(r)||I$(r)))return{explicit:t.explicit,value:tq(n,r)};throw new Error("It should never reach here")}function rq(t,e){const n=t&&t[e];return!!n&&(Ct(n)?Uz(n,t=>!!t.field):cW(n)||uW(n))}function iq(t){return Uz(vB,e=>{if(rq(t,e)){const n=t[e];if(Ct(n))return Uz(n,t=>!!t.aggregate);{const t=RW(n);return t&&!!t.aggregate}}return!1})}function oq(t,e){const n=[],r=[],i=[],o=[],a={};return sq(t,(s,u)=>{if(cW(s)){const{field:l,aggregate:c,bin:h,timeUnit:d}=s,f=Object(x.b)(s,["field","aggregate","bin","timeUnit"]);if(c||d||h){const t=NW(s),p=t&&t.title;let m=_W(s,{forAs:!0});const g=Object.assign(Object.assign(Object.assign({},p?[]:{title:AW(s,e,{allowDisabling:!0})}),f),{field:m});if(c){let t;if(GL(c)?(t="argmax",m=_W({op:"argmax",field:c.argmax},{forAs:!0}),g.field=`${m}.${l}`):HL(c)?(t="argmin",m=_W({op:"argmin",field:c.argmin},{forAs:!0}),g.field=`${m}.${l}`):"boxplot"!==c&&"errorbar"!==c&&"errorband"!==c&&(t=c),t){const e={op:t,as:m};l&&(e.field=l),o.push(e)}}else if(n.push(m),gW(s)&&qB(h))r.push({bin:h,field:l,as:m}),n.push(_W(s,{binSuffix:"end"})),$W(s,u)&&n.push(_W(s,{binSuffix:"range"})),RB(u)&&(a[u+"2"]={field:m+"_end"}),g.bin="binned",CB(u)||(g.type=Q$);else if(d){i.push({timeUnit:d,field:l,as:m});const t=gW(s)&&s.type!==tV&&"time";t&&("text"===u||"tooltip"===u?g.formatType=t:function(t){return!!AB[t]}(u)?g.legend=Object.assign({formatType:t},g.legend):RB(u)&&(g.axis=Object.assign({formatType:t},g.axis)))}a[u]=g}else n.push(l),a[u]=t[u]}else a[u]=t[u]}),{bins:r,timeUnits:i,aggregate:o,groupby:n,encoding:a}}function aq(t){const e=[];for(const n of Kz(t))if(rq(t,n)){const r=Xt(t[n]);for(const t of r)cW(t)?e.push(t):uW(t)&&e.push(t.condition)}return e}function sq(t,e,n){if(t)for(const r of Kz(t)){const i=t[r];if(Ct(i))for(const t of i)e.call(n,t,r);else e.call(n,i,r)}}function uq(t,e,n,r){return t?Kz(t).reduce((n,i)=>{const o=t[i];return Ct(o)?o.reduce((t,n)=>e.call(r,t,n,i),n):e.call(r,n,o,i)},n):n}function lq(t,e){return Kz(e).reduce((n,r)=>{switch(r){case"x":case"y":case"href":case"description":case"url":case"x2":case"y2":case nB:case rB:case eB:case"radius2":case"latitude":case"longitude":case"latitude2":case"longitude2":case"text":case sB:case"angle":case"tooltip":return n;case"order":if("line"===t||"trail"===t)return n;case"detail":case"key":{const t=e[r];if(Ct(t)||cW(t))for(const e of Xt(t))e.aggregate||n.push(_W(e,{}));return n}case uB:if("trail"===t)return n;case iB:case oB:case aB:case"opacity":case"fillOpacity":case"strokeOpacity":case"strokeDash":case"strokeWidth":{const t=RW(e[r]);return t&&!t.aggregate&&n.push(_W(t,{})),n}}},[])}function cq(t,e,n,r=!0){return"tooltip"in n?{tooltip:n.tooltip}:{tooltip:[...t.map(({fieldPrefix:t,titlePrefix:n})=>{const i=r?" of "+e.field:"";return{field:t+e.field,type:e.type,title:I$(n)?{signal:n+`"${escape(i)}"`}:n+i}}),...aq(n)]}}function hq(t){const{axis:e,title:n,field:r}=t;return e&&void 0!==e.title?void 0:lL(n,r)}function dq(t,e,n,r,i){const{scale:o,axis:a}=n;return({partName:s,mark:u,positionPrefix:l,endPositionPrefix:c,aria:h,extraEncoding:d={}})=>{const f=hq(n);return fq(t,s,i,h,{mark:u,encoding:Object.assign(Object.assign(Object.assign({[e]:Object.assign(Object.assign(Object.assign({field:l+"_"+n.field,type:n.type},void 0!==f?{title:f}:{}),void 0!==o?{scale:o}:{}),void 0!==a?{axis:a}:{})},ve(c)?{[e+"2"]:{field:c+"_"+n.field}}:{}),r),d)})}}function fq(t,e,n,r,i){const{clip:o,color:a,opacity:s}=t,u=t.type;return t[e]||void 0===t[e]&&n[e]?[Object.assign(Object.assign({},i),{mark:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},n[e]),o?{clip:o}:{}),a?{color:a}:{}),s?{opacity:s}:{}),zL(i.mark)?i.mark:{type:i.mark}),{style:`${u}-${e}`}),pe(t[e])?{}:t[e]),!1===r?{aria:r}:{})})]:[]}function pq(t,e,n){const{encoding:r}=t,i="vertical"===e?"y":"x",o=r[i+"2"],a=r[i+"Error"],s=r[i+"Error2"];return{continuousAxisChannelDef:mq(r[i],n),continuousAxisChannelDef2:mq(o,n),continuousAxisChannelDefError:mq(a,n),continuousAxisChannelDefError2:mq(s,n),continuousAxis:i}}function mq(t,e){if(t&&t.aggregate){const{aggregate:n}=t,r=Object(x.b)(t,["aggregate"]);return n!==e&&y$(y.errorBarContinuousAxisHasCustomizedAggregate(n,e)),r}return t}function gq(t,e){const{mark:n,encoding:r}=t,{x:i,y:o}=r;if(fW(i)){if(fW(o)){const t=cW(i)&&i.aggregate,r=cW(o)&&o.aggregate;if(t||r!==e){if(r||t!==e){if(t===e&&r===e)throw new Error("Both x and y cannot have aggregate");return zL(n)&&n.orient?n.orient:"vertical"}return"horizontal"}return"vertical"}return"horizontal"}if(fW(o))return"vertical";throw new Error("Need a valid continuous axis for "+e+"s")}const yq=new VL("boxplot",bq);function vq(t){return ge(t)?"tukey":t}function bq(t,{config:e}){var n,r;const{mark:i,selection:o}=t,a=Object(x.b)(t,["mark","encoding","selection","projection"]),s=zL(i)?i:{type:i};o&&y$(y.selectionNotSupported("boxplot"));const u=null!==(n=s.extent)&&void 0!==n?n:e.boxplot.extent,l=KW("size",s,e),c=vq(u),{transform:h,continuousAxisChannelDef:d,continuousAxis:f,groupby:p,aggregate:m,encodingWithoutContinuousAxis:g,ticksOrient:v,boxOrient:b,customTooltipWithoutAggregatedField:w}=function(t,e,n){const r=gq(t,"boxplot"),{continuousAxisChannelDef:i,continuousAxis:o}=pq(t,r,"boxplot"),a=i.field,s=vq(e),u=[...wq(a),{op:"median",field:a,as:"mid_box_"+a},{op:"min",field:a,as:("min-max"===s?"lower_whisker_":"min_")+a},{op:"max",field:a,as:("min-max"===s?"upper_whisker_":"max_")+a}],l="min-max"===s||"tukey"===s?[]:[{calculate:`datum["upper_box_${a}"] - datum["lower_box_${a}"]`,as:"iqr_"+a},{calculate:`min(datum["upper_box_${a}"] + datum["iqr_${a}"] * ${e}, datum["max_${a}"])`,as:"upper_whisker_"+a},{calculate:`max(datum["lower_box_${a}"] - datum["iqr_${a}"] * ${e}, datum["min_${a}"])`,as:"lower_whisker_"+a}],c=t.encoding,h=o,d=Object(x.b)(c,["symbol"==typeof h?h:h+""]),{customTooltipWithoutAggregatedField:f,filteredEncoding:p}=function(t){const{tooltip:e}=t,n=Object(x.b)(t,["tooltip"]);if(!e)return{filteredEncoding:t};let r,i;if(Ct(e)){for(const t of e)t.aggregate?(r||(r=[]),r.push(t)):(i||(i=[]),i.push(t));r&&(n.tooltip=r)}else e.aggregate?n.tooltip=e:i=e;return Ct(i)&&1===i.length&&(i=i[0]),{customTooltipWithoutAggregatedField:i,filteredEncoding:n}}(d),{bins:m,timeUnits:g,aggregate:y,groupby:v,encoding:b}=oq(p,n),w="vertical"===r?"horizontal":"vertical",_=r;return{transform:[...m,...g,{aggregate:[...y,...u],groupby:v},...l],groupby:v,aggregate:y,continuousAxisChannelDef:i,continuousAxis:o,encodingWithoutContinuousAxis:b,ticksOrient:w,boxOrient:_,customTooltipWithoutAggregatedField:f}}(t,u,e),{size:_}=g,C=Object(x.b)(g,["color","size"]),k=t=>dq(s,f,d,t,e.boxplot),S=k(C),E=k(g),O=k(Object.assign(Object.assign({},C),_?{size:_}:{})),A=cq([{fieldPrefix:"min-max"===c?"upper_whisker_":"max_",titlePrefix:"Max"},{fieldPrefix:"upper_box_",titlePrefix:"Q3"},{fieldPrefix:"mid_box_",titlePrefix:"Median"},{fieldPrefix:"lower_box_",titlePrefix:"Q1"},{fieldPrefix:"min-max"===c?"lower_whisker_":"min_",titlePrefix:"Min"}],d,g),N={type:"tick",color:"black",opacity:1,orient:v,invalid:null},T="min-max"===c?A:cq([{fieldPrefix:"upper_whisker_",titlePrefix:"Upper Whisker"},{fieldPrefix:"lower_whisker_",titlePrefix:"Lower Whisker"}],d,g),D=[...S({partName:"rule",mark:{type:"rule",invalid:null},positionPrefix:"lower_whisker",endPositionPrefix:"lower_box",aria:!1,extraEncoding:T}),...S({partName:"rule",mark:{type:"rule",invalid:null},positionPrefix:"upper_box",endPositionPrefix:"upper_whisker",aria:!1,extraEncoding:T}),...S({partName:"ticks",mark:N,positionPrefix:"lower_whisker",aria:!1,extraEncoding:T}),...S({partName:"ticks",mark:N,positionPrefix:"upper_whisker",aria:!1,extraEncoding:T})],R=[..."tukey"!==c?D:[],...E({partName:"box",mark:Object.assign(Object.assign({type:"bar"},l?{size:l}:{}),{orient:b,invalid:null}),positionPrefix:"lower_box",endPositionPrefix:"upper_box",aria:!1,extraEncoding:A}),...O({partName:"median",mark:Object.assign(Object.assign(Object.assign({type:"tick",invalid:null},kt(e.boxplot.median)&&e.boxplot.median.color?{color:e.boxplot.median.color}:{}),l?{size:l}:{}),{orient:v,ariaRoleDescription:"box"}),positionPrefix:"mid_box",extraEncoding:A})];let I;if("min-max"!==c){const t=`datum["lower_box_${d.field}"]`,n=`datum["upper_box_${d.field}"]`,r=`(${n} - ${t})`,i=`${t} - ${u} * ${r}`,o=`${n} + ${u} * ${r}`,a=`datum["${d.field}"]`,l={joinaggregate:wq(d.field),groupby:p};let h=void 0;"tukey"===c&&(h={transform:[{filter:`(${i} <= ${a}) && (${a} <= ${o})`},{aggregate:[{op:"min",field:d.field,as:"lower_whisker_"+d.field},{op:"max",field:d.field,as:"upper_whisker_"+d.field},{op:"min",field:"lower_box_"+d.field,as:"lower_box_"+d.field},{op:"max",field:"upper_box_"+d.field,as:"upper_box_"+d.field},...m],groupby:p}],layer:D});const g=Object(x.b)(C,["tooltip"]),{scale:y,axis:v}=d,b=hq(d),_=fq(s,"outliers",e.boxplot,!0,{transform:[{filter:`(${a} < ${i}) || (${a} > ${o})`}],mark:"point",encoding:Object.assign(Object.assign({[f]:Object.assign(Object.assign(Object.assign({field:d.field,type:d.type},void 0!==b?{title:b}:{}),void 0!==y?{scale:y}:{}),void 0!==v?{axis:v}:{})},g),w?{tooltip:w}:{})})[0];_&&h?I={transform:[l],layer:[_,h]}:_?(I=_,I.transform.unshift(l)):h&&(I=h,I.transform.unshift(l))}return Object.assign(Object.assign({},a),I?{layer:[I,{transform:h,layer:R}]}:{transform:(null!==(r=a.transform)&&void 0!==r?r:[]).concat(h),layer:R})}function wq(t){return[{op:"q1",field:t,as:"lower_box_"+t},{op:"q3",field:t,as:"upper_box_"+t}]}const xq=new VL("errorbar",_q);function _q(t,{config:e}){const{transform:n,continuousAxisChannelDef:r,continuousAxis:i,encodingWithoutContinuousAxis:o,ticksOrient:a,markDef:s,outerSpec:u,tooltipEncoding:l}=Cq(t,"errorbar",e),c=dq(s,i,r,o,e.errorbar),h={type:"tick",orient:a},d=[...c({partName:"ticks",mark:h,positionPrefix:"lower",aria:!1,extraEncoding:l}),...c({partName:"ticks",mark:h,positionPrefix:"upper",aria:!1,extraEncoding:l}),...c({partName:"rule",mark:{type:"rule",ariaRoleDescription:"errorbar"},positionPrefix:"lower",endPositionPrefix:"upper",extraEncoding:l})];return Object.assign(Object.assign(Object.assign({},u),{transform:n}),d.length>1?{layer:d}:Object.assign({},d[0]))}function Cq(t,e,n){var r;const{mark:i,encoding:o,selection:a}=t,s=Object(x.b)(t,["mark","encoding","selection","projection"]),u=zL(i)?i:{type:i};a&&y$(y.selectionNotSupported(e));const{orient:l,inputType:c}=function(t,e){const{encoding:n}=t;if(function(t){return(mW(t.x)||mW(t.y))&&!mW(t.x2)&&!mW(t.y2)&&!mW(t.xError)&&!mW(t.xError2)&&!mW(t.yError)&&!mW(t.yError2)}(n))return{orient:gq(t,e),inputType:"raw"};const r=function(t){return mW(t.x2)||mW(t.y2)}(n),i=function(t){return mW(t.xError)||mW(t.xError2)||mW(t.yError)||mW(t.yError2)}(n),o=n.x,a=n.y;if(r){if(i)throw new Error(e+" cannot be both type aggregated-upper-lower and aggregated-error");const t=n.x2,r=n.y2;if(mW(t)&&mW(r))throw new Error(e+" cannot have both x2 and y2");if(mW(t)){if(fW(o))return{orient:"horizontal",inputType:"aggregated-upper-lower"};throw new Error("Both x and x2 have to be quantitative in "+e)}if(mW(r)){if(fW(a))return{orient:"vertical",inputType:"aggregated-upper-lower"};throw new Error("Both y and y2 have to be quantitative in "+e)}throw new Error("No ranged axis")}{const t=n.xError,r=n.yError,i=n.yError2;if(mW(n.xError2)&&!mW(t))throw new Error(e+" cannot have xError2 without xError");if(mW(i)&&!mW(r))throw new Error(e+" cannot have yError2 without yError");if(mW(t)&&mW(r))throw new Error(e+" cannot have both xError and yError with both are quantiative");if(mW(t)){if(fW(o))return{orient:"horizontal",inputType:"aggregated-error"};throw new Error("All x, xError, and xError2 (if exist) have to be quantitative")}if(mW(r)){if(fW(a))return{orient:"vertical",inputType:"aggregated-error"};throw new Error("All y, yError, and yError2 (if exist) have to be quantitative")}throw new Error("No ranged axis")}}(t,e),{continuousAxisChannelDef:h,continuousAxisChannelDef2:d,continuousAxisChannelDefError:f,continuousAxisChannelDefError2:p,continuousAxis:m}=pq(t,l,e),{errorBarSpecificAggregate:g,postAggregateCalculates:v,tooltipSummary:b,tooltipTitleWithFieldName:w}=function(t,e,n,r,i,o,a,s){let u=[],l=[];const c=e.field;let h,d=!1;if("raw"===o){const e=t.center?t.center:t.extent?"iqr"===t.extent?"median":"mean":s.errorbar.center,n=t.extent?t.extent:"mean"===e?"stderr":"iqr";if("median"===e!=("iqr"===n)&&y$(y.errorBarCenterIsUsedWithWrongExtent(e,n,a)),"stderr"===n||"stdev"===n)u=[{op:n,field:c,as:"extent_"+c},{op:e,field:c,as:"center_"+c}],l=[{calculate:`datum["center_${c}"] + datum["extent_${c}"]`,as:"upper_"+c},{calculate:`datum["center_${c}"] - datum["extent_${c}"]`,as:"lower_"+c}],h=[{fieldPrefix:"center_",titlePrefix:nL(e)},{fieldPrefix:"upper_",titlePrefix:kq(e,n,"+")},{fieldPrefix:"lower_",titlePrefix:kq(e,n,"-")}],d=!0;else{let e,r,i;t.center&&t.extent&&y$(y.errorBarCenterIsNotNeeded(t.extent,a)),"ci"===n?(e="mean",r="ci0",i="ci1"):(e="median",r="q1",i="q3"),u=[{op:r,field:c,as:"lower_"+c},{op:i,field:c,as:"upper_"+c},{op:e,field:c,as:"center_"+c}],h=[{fieldPrefix:"upper_",titlePrefix:AW({field:c,aggregate:i,type:"quantitative"},s,{allowDisabling:!1})},{fieldPrefix:"lower_",titlePrefix:AW({field:c,aggregate:r,type:"quantitative"},s,{allowDisabling:!1})},{fieldPrefix:"center_",titlePrefix:AW({field:c,aggregate:e,type:"quantitative"},s,{allowDisabling:!1})}]}}else{(t.center||t.extent)&&y$(y.errorBarCenterAndExtentAreNotNeeded(t.center,t.extent)),"aggregated-upper-lower"===o?(h=[],l=[{calculate:`datum["${n.field}"]`,as:"upper_"+c},{calculate:`datum["${c}"]`,as:"lower_"+c}]):"aggregated-error"===o&&(h=[{fieldPrefix:"",titlePrefix:c}],l=[{calculate:`datum["${c}"] + datum["${r.field}"]`,as:"upper_"+c}],l.push(i?{calculate:`datum["${c}"] + datum["${i.field}"]`,as:"lower_"+c}:{calculate:`datum["${c}"] - datum["${r.field}"]`,as:"lower_"+c}));for(const t of l)h.push({fieldPrefix:t.as.substring(0,6),titlePrefix:aL(aL(t.calculate,'datum["',""),'"]',"")})}return{postAggregateCalculates:l,errorBarSpecificAggregate:u,tooltipSummary:h,tooltipTitleWithFieldName:d}}(u,h,d,f,p,c,e,n),_=o,C=m,k="x"===m?"x2":"y2",S="x"===m?"xError":"yError",E="x"===m?"xError2":"yError2",O=Object(x.b)(_,["symbol"==typeof C?C:C+"","symbol"==typeof k?k:k+"","symbol"==typeof S?S:S+"","symbol"==typeof E?E:E+""]),{bins:A,timeUnits:N,aggregate:T,groupby:D,encoding:R}=oq(O,n),I=[...T,...g],M="raw"!==c?[]:D,F=cq(b,h,R,w);return{transform:[...null!==(r=s.transform)&&void 0!==r?r:[],...A,...N,...0===I.length?[]:[{aggregate:I,groupby:M}],...v],groupby:M,continuousAxisChannelDef:h,continuousAxis:m,encodingWithoutContinuousAxis:R,ticksOrient:"vertical"===l?"horizontal":"vertical",markDef:u,outerSpec:s,tooltipEncoding:F}}function kq(t,e,n){return nL(t)+" "+n+" "+e}const Sq=new VL("errorband",Eq);function Eq(t,{config:e}){const{transform:n,continuousAxisChannelDef:r,continuousAxis:i,encodingWithoutContinuousAxis:o,markDef:a,outerSpec:s,tooltipEncoding:u}=Cq(t,"errorband",e),l=a,c=dq(l,i,r,o,e.errorband),h=void 0!==t.encoding.x&&void 0!==t.encoding.y;let d={type:h?"area":"rect"},f={type:h?"line":"rule"};const p=Object.assign(Object.assign({},l.interpolate?{interpolate:l.interpolate}:{}),l.tension&&l.interpolate?{tension:l.tension}:{});return h?(d=Object.assign(Object.assign(Object.assign({},d),p),{ariaRoleDescription:"errorband"}),f=Object.assign(Object.assign({},f),p)):l.interpolate?y$(y.errorBand1DNotSupport("interpolate")):l.tension&&y$(y.errorBand1DNotSupport("tension")),Object.assign(Object.assign({},s),{transform:n,layer:[...c({partName:"band",mark:d,positionPrefix:"lower",endPositionPrefix:"upper",extraEncoding:u}),...c({partName:"borders",mark:f,positionPrefix:"lower",aria:!1,extraEncoding:u}),...c({partName:"borders",mark:f,positionPrefix:"upper",aria:!1,extraEncoding:u})]})}const Oq={};function Aq(t,e,n){const r=new VL(t,e);Oq[t]={normalizer:r,parts:n}}Aq("boxplot",bq,["box","median","outliers","rule","ticks"]),Aq("errorbar",_q,["ticks","rule"]),Aq("errorband",Eq,["band","borders"]);const Nq=["gradientHorizontalMaxLength","gradientHorizontalMinLength","gradientVerticalMaxLength","gradientVerticalMinLength","unselectedOpacity"],Tq=["size","shape","fill","stroke","strokeDash","strokeWidth","opacity"],Dq={fillColor:{part:"legend",vgProp:"fill"},gradientStrokeColor:{part:"gradient",vgProp:"stroke"},labelColor:{part:"labels",vgProp:"fill"},strokeColor:{part:"legend",vgProp:"stroke"},symbolFillColor:{part:"symbols",vgProp:"fill"},symbolStrokeColor:{part:"symbols",vgProp:"stroke"},titleColor:{part:"title",vgProp:"fill"}},Rq={aria:1,clipHeight:1,columnPadding:1,columns:1,cornerRadius:1,description:1,direction:1,fillColor:1,format:1,formatType:1,gradientLength:1,gradientOpacity:1,gradientStrokeColor:1,gradientStrokeWidth:1,gradientThickness:1,gridAlign:1,labelAlign:1,labelBaseline:1,labelColor:1,labelFont:1,labelFontSize:1,labelFontStyle:1,labelFontWeight:1,labelLimit:1,labelOffset:1,labelOpacity:1,labelOverlap:1,labelPadding:1,labelSeparation:1,legendX:1,legendY:1,offset:1,orient:1,padding:1,rowPadding:1,strokeColor:1,symbolDash:1,symbolDashOffset:1,symbolFillColor:1,symbolLimit:1,symbolOffset:1,symbolOpacity:1,symbolSize:1,symbolStrokeColor:1,symbolStrokeWidth:1,symbolType:1,tickCount:1,tickMinStep:1,title:1,titleAlign:1,titleAnchor:1,titleBaseline:1,titleColor:1,titleFont:1,titleFontSize:1,titleFontStyle:1,titleFontWeight:1,titleLimit:1,titleLineHeight:1,titleOpacity:1,titleOrient:1,titlePadding:1,type:1,values:1,zindex:1},Iq=(Kz(Rq),{single:{on:"click",fields:["_vgsid_"],resolve:"global",empty:"all",clear:"dblclick"},multi:{on:"click",fields:["_vgsid_"],toggle:"event.shiftKey",resolve:"global",empty:"all",clear:"dblclick"},interval:{on:"[mousedown, window:mouseup] > window:mousemove!",encodings:["x","y"],translate:"[mousedown, window:mouseup] > window:mousemove!",zoom:"wheel!",mark:{fill:"#333",fillOpacity:.125,stroke:"white"},resolve:"global",clear:"dblclick"}});function Mq(t){return!(!t||"legend"!==t&&!t.legend)}function Fq(t){return Mq(t)&&kt(t)}function Pq(t){return"concat"in t}function jq(t){return"vconcat"in t}function zq(t){return"hconcat"in t}function Lq(t){return kt(t)&&void 0!==t.step}function Bq(t){return t.view||t.width||t.height}const Uq=Kz({align:1,bounds:1,center:1,columns:1,spacing:1});function $q(t,e){var n;return null!==(n=t[e])&&void 0!==n?n:t["width"===e?"continuousWidth":"continuousHeight"]}function Vq(t,e){const n=Wq(t,e);return Lq(n)?n.step:qq}function Wq(t,e){var n;return lL(null!==(n=t[e])&&void 0!==n?n:t["width"===e?"discreteWidth":"discreteHeight"],{step:t.step})}const qq=20,Hq={background:"white",padding:5,timeFormat:"%b %d, %Y",countTitle:"Count of Records",view:{continuousWidth:200,continuousHeight:200,step:qq},mark:{color:"#4c78a8",invalid:"filter",timeUnitBand:1},arc:{},area:{},bar:{binSpacing:1,continuousBandSize:5,timeUnitBandPosition:.5},circle:{},geoshape:{},image:{},line:{},point:{},rect:{binSpacing:0,continuousBandSize:5,timeUnitBandPosition:.5},rule:{color:"black"},square:{},text:{color:"black"},tick:{thickness:1},trail:{},boxplot:{size:14,extent:1.5,box:{},median:{color:"white"},outliers:{},rule:{},ticks:null},errorbar:{center:"mean",rule:!0,ticks:!1},errorband:{band:{opacity:.3},borders:!1},scale:{pointPadding:.5,barBandPaddingInner:.1,rectBandPaddingInner:0,minBandSize:2,minFontSize:8,maxFontSize:40,minOpacity:.3,maxOpacity:.8,minSize:9,minStrokeWidth:1,maxStrokeWidth:4,quantileCount:4,quantizeCount:4},projection:{},legend:{gradientHorizontalMaxLength:200,gradientHorizontalMinLength:100,gradientVerticalMaxLength:200,gradientVerticalMinLength:64,unselectedOpacity:.35},header:{titlePadding:10,labelPadding:10},headerColumn:{},headerRow:{},headerFacet:{},selection:Iq,style:{},title:{},facet:{spacing:20},concat:{spacing:20}},Gq=["#4c78a8","#f58518","#e45756","#72b7b2","#54a24b","#eeca3b","#b279a2","#ff9da6","#9d755d","#bab0ac"],Xq={text:11,guideLabel:10,guideTitle:11,groupTitle:13,groupSubtitle:12},Kq={blue:Gq[0],orange:Gq[1],red:Gq[2],teal:Gq[3],green:Gq[4],yellow:Gq[5],purple:Gq[6],pink:Gq[7],brown:Gq[8],gray0:"#000",gray1:"#111",gray2:"#222",gray3:"#333",gray4:"#444",gray5:"#555",gray6:"#666",gray7:"#777",gray8:"#888",gray9:"#999",gray10:"#aaa",gray11:"#bbb",gray12:"#ccc",gray13:"#ddd",gray14:"#eee",gray15:"#fff"};function Yq(t={}){const{color:e,font:n,fontSize:r}=t,i=Object(x.b)(t,["color","font","fontSize"]);return Et({},Hq,n?function(t){return{text:{font:t},style:{"guide-label":{font:t},"guide-title":{font:t},"group-title":{font:t},"group-subtitle":{font:t}}}}(n):{},e?function(t={}){return{signals:[{name:"color",value:kt(t)?Object.assign(Object.assign({},Kq),t):Kq}],mark:{color:{signal:"color.blue"}},rule:{color:{signal:"color.gray0"}},text:{color:{signal:"color.gray0"}},style:{"guide-label":{fill:{signal:"color.gray0"}},"guide-title":{fill:{signal:"color.gray0"}},"group-title":{fill:{signal:"color.gray0"}},"group-subtitle":{fill:{signal:"color.gray0"}},cell:{stroke:{signal:"color.gray8"}}},axis:{domainColor:{signal:"color.gray13"},gridColor:{signal:"color.gray8"},tickColor:{signal:"color.gray13"}},range:{category:[{signal:"color.blue"},{signal:"color.orange"},{signal:"color.red"},{signal:"color.teal"},{signal:"color.green"},{signal:"color.yellow"},{signal:"color.purple"},{signal:"color.pink"},{signal:"color.brown"},{signal:"color.grey8"}]}}}(e):{},r?function(t){return{signals:[{name:"fontSize",value:kt(t)?Object.assign(Object.assign({},Xq),t):Xq}],text:{fontSize:{signal:"fontSize.text"}},style:{"guide-label":{fontSize:{signal:"fontSize.guideLabel"}},"guide-title":{fontSize:{signal:"fontSize.guideTitle"}},"group-title":{fontSize:{signal:"fontSize.groupTitle"}},"group-subtitle":{fontSize:{signal:"fontSize.groupSubtitle"}}}}}(r):{},i||{})}const Zq=["view",...jL],Qq=["color","fontSize","background","padding","facet","concat","numberFormat","timeFormat","countTitle","header","axisQuantitative","axisTemporal","axisDiscrete","axisPoint","axisXBand","axisXPoint","axisXDiscrete","axisXQuantitative","axisXTemporal","axisYBand","axisYPoint","axisYDiscrete","axisYQuantitative","axisYTemporal","scale","selection","overlay"],Jq=Object.assign({view:["continuousWidth","continuousHeight","discreteWidth","discreteHeight","step"]},{area:["line","point"],bar:["binSpacing","continuousBandSize","discreteBandSize"],rect:["binSpacing","continuousBandSize","discreteBandSize"],line:["point"],tick:["bandSize","thickness"]});function tH(t,e,n,r){"view"===e&&(n="cell");const i=Object.assign(Object.assign({},r?t[e][r]:t[e]),t.style[null!=n?n:e]);Xz(i)||(t.style[null!=n?n:e]=i),r||delete t[e]}function eH(t){return"layer"in t}class nH{map(t,e){return nW(t)?this.mapFacet(t,e):function(t){return"repeat"in t}(t)?this.mapRepeat(t,e):zq(t)?this.mapHConcat(t,e):jq(t)?this.mapVConcat(t,e):Pq(t)?this.mapConcat(t,e):this.mapLayerOrUnit(t,e)}mapLayerOrUnit(t,e){if(eH(t))return this.mapLayer(t,e);if($L(t))return this.mapUnit(t,e);throw new Error(y.invalidSpec(t))}mapLayer(t,e){return Object.assign(Object.assign({},t),{layer:t.layer.map(t=>this.mapLayerOrUnit(t,e))})}mapHConcat(t,e){return Object.assign(Object.assign({},t),{hconcat:t.hconcat.map(t=>this.map(t,e))})}mapVConcat(t,e){return Object.assign(Object.assign({},t),{vconcat:t.vconcat.map(t=>this.map(t,e))})}mapConcat(t,e){const{concat:n}=t,r=Object(x.b)(t,["concat"]);return Object.assign(Object.assign({},r),{concat:n.map(t=>this.map(t,e))})}mapFacet(t,e){return Object.assign(Object.assign({},t),{spec:this.map(t.spec,e)})}mapRepeat(t,e){return Object.assign(Object.assign({},t),{spec:this.map(t.spec,e)})}}const rH={zero:1,center:1,normalize:1},iH=new Set([xL,CL,_L,AL,EL,RL,IL,SL,NL,TL]),oH=new Set([CL,_L,xL]);function aH(t,e){var n,r;const i="x"===e?"y":"radius",o=t[e],a=t[i];if(cW(o)&&cW(a))if("quantitative"===hW(o)&&"quantitative"===hW(a)){if(o.stack)return e;if(a.stack)return i;const t=cW(o)&&!!o.aggregate;if(t!==(cW(a)&&!!a.aggregate))return t?e:i;{const t=null===(n=o.scale)||void 0===n?void 0:n.type,s=null===(r=a.scale)||void 0===r?void 0:r.type;if(t&&"linear"!==t)return i;if(s&&"linear"!==s)return e}}else{if("quantitative"===hW(o))return e;if("quantitative"===hW(a))return i}else{if("quantitative"===hW(o))return e;if("quantitative"===hW(a))return i}}function sH(t,e,n={}){const r=zL(t)?t.type:t;if(!iH.has(r))return null;const i=aH(e,"x")||aH(e,"theta");if(!i)return null;const o=e[i],a=cW(o)?_W(o,{}):void 0;let s=function(t){switch(t){case"x":return"y";case"y":return"x";case"theta":return"radius";case"radius":return"theta"}}(i),u=e[s],l=cW(u)?_W(u,{}):void 0;l===a&&(l=void 0,u=void 0,s=void 0);const c=NB.reduce((t,n)=>{if("tooltip"!==n&&rq(e,n)){const r=e[n];for(const e of Xt(r)){const r=RW(e);if(r.aggregate)continue;const i=_W(r,{});i&&i===l||t.push({channel:n,fieldDef:r})}}return t},[]);let h;if(void 0!==o.stack?h=pe(o.stack)?o.stack?"zero":null:o.stack:c.length>0&&oH.has(r)&&(h="zero"),!h||!(h in rH))return null;if(iq(e)&&0===c.length)return null;if(o.scale&&o.scale.type&&"linear"!==o.scale.type){if(n.disallowNonLinearStack)return null;y$(y.cannotStackNonLinearScale(o.scale.type))}return mW(e[EB(i)])?(void 0!==o.stack&&y$(y.cannotStackRangedMark(i)),null):(cW(o)&&o.aggregate&&!Bz(ZL,o.aggregate)&&y$(y.stackNonSummativeAggregate(o.aggregate)),{groupbyChannel:u?s:void 0,groupbyField:l,fieldChannel:i,impute:null!==o.impute&&FL(r),stackBy:c,offset:h})}function uH(t){const e=Object(x.b)(t,["point","line"]);return Kz(e).length>1?e:e.type}function lH(t){for(const e of["line","area","rule","trail"])t[e]&&(t=Object.assign(Object.assign({},t),{[e]:Pz(t[e],["point","line"])}));return t}function cH(t,e={},n){return"transparent"===t.point?{opacity:0}:t.point?kt(t.point)?t.point:{}:void 0!==t.point?null:e.point||n.shape?kt(e.point)?e.point:{}:void 0}function hH(t,e={}){return t.line?!0===t.line?{}:t.line:void 0!==t.line?null:e.line?!0===e.line?{}:e.line:void 0}class dH{constructor(){this.name="path-overlay"}hasMatchingType(t,e){if($L(t)){const{mark:n,encoding:r}=t,i=zL(n)?n:{type:n};switch(i.type){case"line":case"rule":case"trail":return!!cH(i,e[i.type],r);case"area":return!!cH(i,e[i.type],r)||!!hH(i,e[i.type])}}return!1}run(t,e,n){const{config:r}=e,{selection:i,projection:o,encoding:a,mark:s}=t,u=Object(x.b)(t,["selection","projection","encoding","mark"]),l=zL(s)?s:{type:s},c=cH(l,r[l.type],a),h="area"===l.type&&hH(l,r[l.type]),d=[Object.assign(Object.assign({},i?{selection:i}:{}),{mark:uH(Object.assign(Object.assign({},"area"===l.type&&void 0===l.opacity&&void 0===l.fillOpacity?{opacity:.7}:{}),l)),encoding:Pz(a,["shape"])})],f=sH(l,a);let p=a;if(f){const{fieldChannel:t,offset:e}=f;p=Object.assign(Object.assign({},a),{[t]:Object.assign(Object.assign({},a[t]),e?{stack:e}:{})})}return h&&d.push(Object.assign(Object.assign({},o?{projection:o}:{}),{mark:Object.assign(Object.assign({type:"line"},Fz(l,["clip","interpolate","tension","tooltip"])),h),encoding:p})),c&&d.push(Object.assign(Object.assign({},o?{projection:o}:{}),{mark:Object.assign(Object.assign({type:"point",opacity:1,filled:!0},Fz(l,["clip","tooltip"])),c),encoding:p})),n(Object.assign(Object.assign({},u),{layer:d}),Object.assign(Object.assign({},e),{config:lH(r)}))}}class fH{constructor(){this.name="RangeStep"}hasMatchingType(t){var e;if($L(t)&&t.encoding)for(const n of DB){const r=t.encoding[n];if(r&&mW(r)&&(null===(e=null==r?void 0:r.scale)||void 0===e?void 0:e.rangeStep))return!0}return!1}run(t){var e;const n={};let r=Object.assign({},t.encoding);for(const i of DB){const t=OB(i),o=r[i];if(o&&mW(o)&&(null===(e=null==o?void 0:o.scale)||void 0===e?void 0:e.rangeStep)){const{scale:e}=o,a=Object(x.b)(o,["scale"]),s=e,u=Object(x.b)(s,["rangeStep"]);n[t]={step:e.rangeStep},y$(y.RANGE_STEP_DEPRECATED),r=Object.assign(Object.assign({},r),{[i]:Object.assign(Object.assign({},a),Xz(u)?{}:{scale:u})})}}return Object.assign(Object.assign(Object.assign({},n),t),{encoding:r})}}function pH(t,e){return e?tW(t)?wH(t,e):yH(t,e):t}function mH(t,e){return e?wH(t,e):t}function gH(t,e,n){const r=e[t];return(i=r)&&!ve(i)&&"repeat"in i?r.repeat in n?Object.assign(Object.assign({},e),{[t]:n[r.repeat]}):void y$(y.noSuchRepeatedValue(r.repeat)):e;var i}function yH(t,e){if(void 0!==(t=gH("field",t,e))){if(null===t)return null;if(iW(t)&&QV(t.sort)){const n=gH("field",t.sort,e);t=Object.assign(Object.assign({},t),n?{sort:n}:{})}return t}}function vH(t,e){if(cW(t))return yH(t,e);{const n=gH("datum",t,e);return n===t||n.type||(n.type="nominal"),n}}function bH(t,e){if(!mW(t)){if(lW(t)){const n=vH(t.condition,e);return n?Object.assign(Object.assign({},t),{condition:n}):Object(x.b)(t,["condition"])}return t}{const n=vH(t,e);if(n)return n;if(sW(t))return{condition:t.condition}}}function wH(t,e){const n={};for(const r in t)if(ue(t,r)){const i=t[r];if(Ct(i))n[r]=i.map(t=>bH(t,e)).filter(t=>t);else{const t=bH(i,e);void 0!==t&&(n[r]=t)}}return n}class xH{constructor(){this.name="RuleForRangedLine"}hasMatchingType(t){if($L(t)){const{encoding:e,mark:n}=t;if("line"===n)for(const t of _B){const n=e[kB(t)];if(e[t]&&(cW(n)&&!HB(n.bin)||dW(n)))return!0}}return!1}run(t,e,n){const{encoding:r}=t;return y$(y.lineWithRange(!!r.x2,!!r.y2)),n(Object.assign(Object.assign({},t),{mark:"rule"}),e)}}function _H(t){const{parentEncoding:e,encoding:n}=t;if(e&&n){const t=Kz(e).reduce((t,e)=>(n[e]&&t.push(e),t),[]);t.length>0&&y$(y.encodingOverridden(t))}const r=Object.assign(Object.assign({},null!=e?e:{}),null!=n?n:{});return Xz(r)?void 0:r}function CH(t){const{parentProjection:e,projection:n}=t;return e&&n&&y$(y.projectionOverridden({parentProjection:e,projection:n})),null!=n?n:e}function kH(t,e){void 0===e&&(e=Yq(t.config));const n=function(t,e={}){return SH.map(t,{config:e})}(t,e),{width:r,height:i}=t,o=function(t,e,n){let{width:r,height:i}=e;const o=$L(t)||eH(t),a={};o?"container"==r&&"container"==i?(a.type="fit",a.contains="padding"):"container"==r?(a.type="fit-x",a.contains="padding"):"container"==i&&(a.type="fit-y",a.contains="padding"):("container"==r&&(y$(y.containerSizeNonSingle("width")),r=void 0),"container"==i&&(y$(y.containerSizeNonSingle("height")),i=void 0));const s=Object.assign(Object.assign(Object.assign({type:"pad"},a),n?EH(n.autosize):{}),EH(t.autosize));if("fit"!==s.type||o||(y$(y.FIT_NON_SINGLE),s.type="pad"),"container"==r&&"fit"!=s.type&&"fit-x"!=s.type&&y$(y.containerSizeNotCompatibleWithAutosize("width")),"container"==i&&"fit"!=s.type&&"fit-y"!=s.type&&y$(y.containerSizeNotCompatibleWithAutosize("height")),!Iz(s,{type:"pad"}))return s}(n,{width:r,height:i,autosize:t.autosize},e);return Object.assign(Object.assign({},n),o?{autosize:o}:{})}const SH=new class extends nH{constructor(){super(...arguments),this.nonFacetUnitNormalizers=[yq,xq,Sq,new dH,new xH,new fH]}map(t,e){if($L(t)){const n=rq(t.encoding,JL),r=rq(t.encoding,tB),i=rq(t.encoding,"facet");if(n||r||i)return this.mapFacetedUnit(t,e)}return super.map(t,e)}mapUnit(t,e){const{parentEncoding:n,parentProjection:r}=e,i=Object.assign(Object.assign({},t),{encoding:mH(t.encoding,e.repeater)});if(n||r)return this.mapUnitWithParentEncodingOrProjection(i,e);const o=this.mapLayerOrUnit.bind(this);for(const a of this.nonFacetUnitNormalizers)if(a.hasMatchingType(i,e.config))return a.run(i,e,o);return i}mapRepeat(t,e){return function(t){return!Ct(t.repeat)&&t.repeat.layer}(t)?this.mapLayerRepeat(t,e):this.mapNonLayerRepeat(t,e)}mapLayerRepeat(t,e){const{repeat:n,spec:r}=t,i=Object(x.b)(t,["repeat","spec"]),{row:o,column:a,layer:s}=n,{repeater:u={},repeaterPrefix:l=""}=e;return o||a?this.mapRepeat(Object.assign(Object.assign({},t),{repeat:Object.assign(Object.assign({},o?{row:o}:{}),a?{column:a}:{}),spec:{repeat:{layer:s},spec:r}}),e):Object.assign(Object.assign({},i),{layer:s.map(t=>{const n=Object.assign(Object.assign({},u),{layer:t}),i=(r.name||"")+l+"child__layer_"+Jz(t),o=this.mapLayerOrUnit(r,Object.assign(Object.assign({},e),{repeater:n,repeaterPrefix:i}));return o.name=i,o})})}mapNonLayerRepeat(t,e){var n;const{repeat:r,spec:i,data:o}=t,a=Object(x.b)(t,["repeat","spec","data"]);!Ct(r)&&t.columns&&(t=Pz(t,["columns"]),y$(y.columnsNotSupportByRowCol("repeat")));const s=[],{repeater:u={},repeaterPrefix:l=""}=e,c=!Ct(r)&&r.row||[u?u.row:null],h=!Ct(r)&&r.column||[u?u.column:null],d=Ct(r)&&r||[u?u.repeat:null];for(const p of d)for(const t of c)for(const n of h){const o={repeat:p,row:t,column:n,layer:u.layer},a=(i.name||"")+l+"child__"+(Ct(r)?""+Jz(p):(r.row?"row_"+Jz(t):"")+(r.column?"column_"+Jz(n):"")),c=this.map(i,Object.assign(Object.assign({},e),{repeater:o,repeaterPrefix:a}));c.name=a,s.push(Pz(c,["data"]))}const f=Ct(r)?t.columns:r.column?r.column.length:1;return Object.assign(Object.assign({data:null!==(n=i.data)&&void 0!==n?n:o,align:"all"},a),{columns:f,concat:s})}mapFacet(t,e){const{facet:n}=t;return tW(n)&&t.columns&&(t=Pz(t,["columns"]),y$(y.columnsNotSupportByRowCol("facet"))),super.mapFacet(t,e)}mapUnitWithParentEncodingOrProjection(t,e){const{encoding:n,projection:r}=t,{parentEncoding:i,parentProjection:o,config:a}=e,s=CH({parentProjection:o,projection:r}),u=_H({parentEncoding:i,encoding:mH(n,e.repeater)});return this.mapUnit(Object.assign(Object.assign(Object.assign({},t),s?{projection:s}:{}),u?{encoding:u}:{}),{config:a})}mapFacetedUnit(t,e){const n=t.encoding,{row:r,column:i,facet:o}=n,a=Object(x.b)(n,["row","column","facet"]),{mark:s,width:u,projection:l,height:c,view:h,selection:d}=t,f=Object(x.b)(t,["mark","width","projection","height","view","selection","encoding"]),{facetMapping:p,layout:m}=this.getFacetMappingAndLayout({row:r,column:i,facet:o},e),g=mH(a,e.repeater);return this.mapFacet(Object.assign(Object.assign(Object.assign({},f),m),{facet:p,spec:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},u?{width:u}:{}),c?{height:c}:{}),h?{view:h}:{}),l?{projection:l}:{}),{mark:s,encoding:g}),d?{selection:d}:{})}),e)}getFacetMappingAndLayout(t,e){var n;const{row:r,column:i,facet:o}=t;if(r||i){o&&y$(y.facetChannelDropped([...r?[JL]:[],...i?[tB]:[]]));const e={},a={};for(const r of[JL,tB]){const i=t[r];if(i){const t=Object(x.b)(i,["align","center","spacing","columns"]);e[r]=t;for(const e of["align","center","spacing"])void 0!==i[e]&&(a[e]=null!==(n=a[e])&&void 0!==n?n:{},a[e][r]=i[e])}}return{facetMapping:e,layout:a}}{const{align:t,center:n,spacing:r,columns:i}=o;return{facetMapping:pH(Object(x.b)(o,["align","center","spacing","columns"]),e.repeater),layout:Object.assign(Object.assign(Object.assign(Object.assign({},t?{align:t}:{}),n?{center:n}:{}),r?{spacing:r}:{}),i?{columns:i}:{})}}}mapLayer(t,e){var{parentEncoding:n,parentProjection:r}=e,i=Object(x.b)(e,["parentEncoding","parentProjection"]);const{encoding:o,projection:a}=t,s=Object(x.b)(t,["encoding","projection"]),u=Object.assign(Object.assign({},i),{parentEncoding:_H({parentEncoding:n,encoding:o}),parentProjection:CH({parentProjection:r,projection:a})});return super.mapLayer(s,u)}};function EH(t){return ve(t)?{type:t}:null!=t?t:{}}const OH=["background","padding"];function AH(t){return OH.reduce((e,n)=>(t&&void 0!==t[n]&&(e[n]=t[n]),e),{})}class NH{constructor(t={},e={}){this.explicit=t,this.implicit=e}clone(){return new NH(Mz(this.explicit),Mz(this.implicit))}combine(){return Object.assign(Object.assign({},this.explicit),this.implicit)}get(t){return lL(this.explicit[t],this.implicit[t])}getWithExplicit(t){return void 0!==this.explicit[t]?{explicit:!0,value:this.explicit[t]}:void 0!==this.implicit[t]?{explicit:!1,value:this.implicit[t]}:{explicit:!1,value:void 0}}setWithExplicit(t,e){void 0!==e.value&&this.set(t,e.value,e.explicit)}set(t,e,n){return delete this[n?"implicit":"explicit"][t],this[n?"explicit":"implicit"][t]=e,this}copyKeyFromSplit(t,e){void 0!==e.explicit[t]?this.set(t,e.explicit[t],!0):void 0!==e.implicit[t]&&this.set(t,e.implicit[t],!1)}copyKeyFromObject(t,e){void 0!==e[t]&&this.set(t,e[t],!0)}copyAll(t){for(const e of Kz(t.combine())){const n=t.getWithExplicit(e);this.setWithExplicit(e,n)}}}function TH(t){return{explicit:!0,value:t}}function DH(t){return{explicit:!1,value:t}}function RH(t){return(e,n,r,i)=>{const o=t(e.value,n.value);return o>0?e:o<0?n:IH(e,n,r,i)}}function IH(t,e,n,r){return t.explicit&&e.explicit&&y$(y.mergeConflictingProperty(n,r,t.value,e.value)),t}function MH(t,e,n,r,i=IH){return void 0===t||void 0===t.value?e:t.explicit&&!e.explicit?t:e.explicit&&!t.explicit?e:Iz(t.value,e.value)?t:i(t,e,n,r)}class FH extends NH{constructor(t={},e={},n=!1){super(t,e),this.explicit=t,this.implicit=e,this.parseNothing=n}clone(){const t=super.clone();return t.parseNothing=this.parseNothing,t}}function PH(t){return"url"in t}function jH(t){return"values"in t}function zH(t){return"name"in t&&!PH(t)&&!jH(t)&&!LH(t)}function LH(t){return t&&(BH(t)||UH(t)||$H(t))}function BH(t){return"sequence"in t}function UH(t){return"sphere"in t}function $H(t){return"graticule"in t}const VH="main";function WH(t){return"filter"in t}function qH(t){return"lookup"in t}function HH(t){return"pivot"in t}function GH(t){return"density"in t}function XH(t){return"quantile"in t}function KH(t){return"regression"in t}function YH(t){return"loess"in t}function ZH(t){return"sample"in t}function QH(t){return"window"in t}function JH(t){return"joinaggregate"in t}function tG(t){return"flatten"in t}function eG(t){return"calculate"in t}function nG(t){return"bin"in t}function rG(t){return"impute"in t}function iG(t){return"timeUnit"in t}function oG(t){return"aggregate"in t}function aG(t){return"stack"in t}function sG(t){return"fold"in t}function uG(t,e,n,r){const i=sW(e)&&e.condition,o=r(e);return i?{[n]:[...Xt(i).map(e=>{const n=r(e),i=function(t){return t.selection}(e)?yX(t,e.selection):bX(t,e.test);return Object.assign({test:i},n)}),...void 0!==o?[o]:[]]}:void 0!==o?{[n]:o}:{}}function lG(t,e="text"){return uG(t,t.encoding[e],e,e=>cG(e,t.config))}function cG(t,e,n="datum"){if(t){if(yW(t))return qW(t.value);if(mW(t)){const{format:r,formatType:i}=DW(t);return LV({fieldOrDatumDef:t,format:r,formatType:i,expr:n,config:e})}}}function hG(t,e={}){const{encoding:n,markDef:r,config:i,stack:o}=t,a=n.tooltip;if(Ct(a))return{tooltip:fG({tooltip:a},o,i,e)};{const s=e.reactiveGeom?"datum.datum":"datum";return uG(t,a,"tooltip",t=>{const a=cG(t,i,s);if(a)return a;if(null===t)return;let u=KW("tooltip",r,i);return!0===u&&(u={content:"encoding"}),ve(u)?{value:u}:kt(u)?"encoding"===u.content?fG(n,o,i,e):{signal:s}:void 0})}}function dG(t,e,n,{reactiveGeom:r}={}){const i={},o=r?"datum.datum":"datum",a=[];function s(r,s){const u=kB(s),l=gW(r)?r:Object.assign(Object.assign({},r),{type:t[u].type}),c=Xt(AW(l,n,{allowDisabling:!1})).join(", ");let h;if(RB(s)){const r="x"===s?"x2":"y2",a=RW(t[r]);if(HB(l.bin)&&a){const t=_W(l,{expr:o}),e=_W(a,{expr:o}),{format:s,formatType:u}=DW(l);h=GV(t,e,s,u,n),i[r]=!0}else if(e&&e.fieldChannel===s&&"normalize"===e.offset){const{format:t,formatType:e}=DW(l);h=LV({fieldOrDatumDef:l,format:t,formatType:e,expr:o,config:n,normalizeStack:!0}).signal}}h=null!=h?h:cG(l,n,o).signal,a.push({channel:s,key:c,value:h})}sq(t,(t,e)=>{cW(t)?s(t,e):uW(t)&&s(t.condition,e)});const u={};for(const{channel:l,key:c,value:h}of a)i[l]||u[c]||(u[Ee(c)]=h);return u}function fG(t,e,n,{reactiveGeom:r}={}){const i=Zz(dG(t,e,n,{reactiveGeom:r})).map(({key:t,value:e})=>`${t}: ${e}`);return i.length>0?{signal:`{${i.join(", ")}}`}:void 0}function pG(t,e,n={}){const{markDef:r,encoding:i,config:o}=e,{vgChannel:a}=n;let{defaultRef:s,defaultValue:u}=n;return void 0===s&&(u=null!=u?u:KW(t,r,o,{vgChannel:a,ignoreVgConfig:!0}),void 0!==u&&(s=qW(u))),uG(e,i[t],null!=a?a:t,n=>FV({channel:t,channelDef:n,markDef:r,config:o,scaleName:e.scaleName(t),scale:e.getScaleComponent(t),stack:null,defaultRef:s}))}function mG(t,e={filled:void 0}){var n,r,i,o;const{markDef:a,encoding:s,config:u}=t,{type:l}=a,c=null!==(n=e.filled)&&void 0!==n?n:KW("filled",a,u),h=Bz(["bar","point","circle","square","geoshape"],l)?"transparent":void 0,d=null!==(i=null!==(r=KW(!0===c?"color":void 0,a,u,{vgChannel:"fill"}))&&void 0!==r?r:u.mark[!0===c&&"color"])&&void 0!==i?i:h,f=null!==(o=KW(!1===c?"color":void 0,a,u,{vgChannel:"stroke"}))&&void 0!==o?o:u.mark[!1===c&&"color"],p=c?"fill":"stroke",m=Object.assign(Object.assign({},d?{fill:qW(d)}:{}),f?{stroke:qW(f)}:{});return a.color&&(c?a.fill:a.stroke)&&y$(y.droppingColor("property",{fill:"fill"in a,stroke:"stroke"in a})),Object.assign(Object.assign(Object.assign(Object.assign({},m),pG("color",t,{vgChannel:p,defaultValue:c?d:f})),pG("fill",t,{defaultValue:s.fill?d:void 0})),pG("stroke",t,{defaultValue:s.stroke?f:void 0}))}function gG(t,e){const n=e[function(t){switch(t){case"x":return"xOffset";case"y":return"yOffset";case"x2":return"x2Offset";case"y2":return"y2Offset";case nB:return"thetaOffset";case eB:return"radiusOffset";case rB:return"theta2Offset";case"radius2":return"radius2Offset"}}(t)];if(n)return n}function yG(t,e,{defaultPos:n,vgChannel:r,isMidPoint:i}){const{encoding:o,markDef:a,config:s,stack:u}=e,l=o[t],c=o[EB(t)],h=e.scaleName(t),d=e.getScaleComponent(t),f=gG(t,a),p=vG({model:e,defaultPos:n,channel:t,scaleName:h,scale:d}),m=!l&&RB(t)&&(o.latitude||o.longitude)?{field:e.getName(t)}:function(t){const{channel:e,channelDef:n,isMidPoint:r,scaleName:i,stack:o,offset:a,markDef:s,config:u}=t;if(mW(n)&&o&&e===o.fieldChannel){if(cW(n)){const t=oW({channel:e,fieldDef:n,isMidPoint:r,markDef:s,stack:o,config:u});if(void 0!==t)return MV({scaleName:i,fieldOrDatumDef:n,startSuffix:"start",band:t,offset:a})}return IV(n,i,{suffix:"end"},{offset:a})}return NV(t)}({channel:t,channelDef:l,channel2Def:c,markDef:a,config:s,isMidPoint:i,scaleName:h,scale:d,stack:u,offset:f,defaultRef:p});return m?{[r||t]:m}:void 0}function vG({model:t,defaultPos:e,channel:n,scaleName:r,scale:i}){const{markDef:o,config:a}=t;return()=>{const s=kB(n),u=SB(n),l=KW(n,o,a,{vgChannel:u});if(void 0!==l)return PV(n,l);switch(e){case"zeroOrMin":case"zeroOrMax":if(r)if(Bz(["log","time","utc"],i.get("type")));else if(i.domainDefinitelyIncludesZero())return{scale:r,value:0};if("zeroOrMin"===e)return"y"===s?{field:{group:"height"}}:{value:0};switch(s){case"radius":return{signal:`min(${t.width.signal},${t.height.signal})/2`};case"theta":return{signal:"2*PI"};case"x":return{field:{group:"width"}};case"y":return{value:0}}break;case"mid":{const e=t[OB(n)];return Object.assign(Object.assign({},e),{mult:.5})}}}}const bG={left:"x",center:"xc",right:"x2"},wG={top:"y",middle:"yc",bottom:"y2"};function xG(t,e,n,r="middle"){if("radius"===t||"theta"===t)return SB(t);const i=KW("x"===t?"align":"baseline",e,n);return"x"===t?bG[i||("top"===r?"left":"center")]:wG[i||r]}function _G(t,e,{defaultPos:n,defaultPos2:r,range:i}){return i?CG(t,e,{defaultPos:n,defaultPos2:r}):yG(t,e,{defaultPos:n})}function CG(t,e,{defaultPos:n,defaultPos2:r}){const{markDef:i,config:o}=e,a=EB(t),s=OB(t),u=function(t,e,n){const{encoding:r,mark:i,markDef:o,stack:a,config:s}=t,u=kB(n),l=OB(n),c=SB(n),h=r[u],d=t.scaleName(u),f=t.getScaleComponent(u),p=gG(n in r||n in o?n:u,t.markDef);if(!h&&("x2"===n||"y2"===n)&&(r.latitude||r.longitude))return{[c]:{field:t.getName(n)}};const m=function({channel:t,channelDef:e,channel2Def:n,markDef:r,config:i,scaleName:o,scale:a,stack:s,offset:u,defaultRef:l}){return mW(e)&&s&&t.charAt(0)===s.fieldChannel.charAt(0)?IV(e,o,{suffix:"start"},{offset:u}):NV({channel:t,channelDef:n,scaleName:o,scale:a,stack:s,markDef:r,config:i,offset:u,defaultRef:l})}({channel:n,channelDef:h,channel2Def:r[n],markDef:o,config:s,scaleName:d,scale:f,stack:a,offset:p,defaultRef:void 0});return void 0!==m?{[c]:m}:kG(n,o)||kG(n,{[n]:ZW(n,o,s.style),[l]:ZW(l,o,s.style)})||kG(n,s[i])||kG(n,s.mark)||{[c]:vG({model:t,defaultPos:e,channel:n,scaleName:d,scale:f})()}}(e,r,a),l=u[s]?xG(t,i,o):SB(t);return Object.assign(Object.assign({},yG(t,e,{defaultPos:n,vgChannel:l})),u)}function kG(t,e){const n=OB(t),r=SB(t);return void 0!==e[r]?{[r]:PV(t,e[r])}:void 0!==e[t]?{[r]:PV(t,e[t])}:e[n]?{[n]:PV(t,e[n])}:void 0}function SG(t,e,n){var r,i,o,a;const{config:s,encoding:u,markDef:l,stack:c}=t,h=EB(e),d=OB(e),f=u[e],p=u[h],m=t.getScaleComponent(e),g=m?m.get("type"):void 0,v=t.scaleName(e),b=l.orient,w=null!==(i=null!==(r=u[d])&&void 0!==r?r:u.size)&&void 0!==i?i:KW("size",l,s,{vgChannel:d}),x="bar"===n&&("x"===e?"vertical"===b:"horizontal"===b);if(cW(f)&&(qB(f.bin)||HB(f.bin)||f.timeUnit&&!p)&&!w&&!gV(g)){const n=oW({channel:e,fieldDef:f,stack:c,markDef:l,config:s}),r=null===(o=t.component.axes[e])||void 0===o?void 0:o[0];return function({fieldDef:t,fieldDef2:e,channel:n,band:r,scaleName:i,markDef:o,spacing:a=0,axisTranslate:s,reverse:u,config:l}){const c=EB(n),h=SB(n),d=SB(c),f=gG(n,o);if(qB(t.bin)||t.timeUnit)return{[d]:AG({channel:n,fieldDef:t,scaleName:i,markDef:o,band:(1-r)/2,offset:OG(c,a,u,s,f),config:l}),[h]:AG({channel:n,fieldDef:t,scaleName:i,markDef:o,band:1-(1-r)/2,offset:OG(n,a,u,s,f),config:l})};if(HB(t.bin)){const r=IV(t,i,{},{offset:OG(c,a,u,s,f)});if(cW(e))return{[d]:r,[h]:IV(e,i,{},{offset:OG(n,a,u,s,f)})};if(GB(t.bin)&&t.bin.step)return{[d]:r,[h]:{signal:`scale("${i}", ${_W(t,{expr:"datum"})} + ${t.bin.step})`,offset:OG(n,a,u,s,f)}}}y$(y.channelRequiredForBinned(c))}({fieldDef:f,fieldDef2:p,channel:e,markDef:l,scaleName:v,band:n,axisTranslate:null!==(a=null==r?void 0:r.get("translate"))&&void 0!==a?a:.5,spacing:RB(e)?KW("binSpacing",l,s):void 0,reverse:m.get("reverse"),config:s})}return(mW(f)&&gV(g)||x)&&!p?function(t,e,n,r){var i;const{markDef:o,encoding:a,config:s,stack:u}=r,l=o.orient,c=r.scaleName(n),h=r.getScaleComponent(n),d=OB(n),f=EB(n),p="horizontal"===l&&"y"===n||"vertical"===l&&"x"===n,m=KW(p?"size":d,o,s,{vgChannel:d});let g;(a.size||void 0!==m)&&(p?g=pG("size",r,{vgChannel:d,defaultValue:m}):y$(y.cannotApplySizeToNonOrientedMark(o.type)));const v=null!==(i=mW(e)?oW({channel:n,fieldDef:e,markDef:o,stack:u,config:s}):void 0)&&void 0!==i?i:1;g=g||{[d]:EG(t,d,c,h,s,v)};const b="band"!==(null==h?void 0:h.get("type"))||!("band"in g[d]),w=xG(n,o,s,b?"middle":"top"),x=gG(n,o),_=NV({channel:n,channelDef:e,markDef:o,config:s,scaleName:c,scale:h,stack:u,offset:x,defaultRef:vG({model:r,defaultPos:"mid",channel:n,scaleName:c,scale:h}),band:b?.5:(1-v)/2});if(d)return Object.assign({[w]:_},g);{const t=SB(f),e=g[d],n=x?Object.assign(Object.assign({},e),{offset:x}):e;return{[w]:_,[t]:Ct(_)?[_[0],Object.assign(Object.assign({},_[1]),{offset:n})]:Object.assign(Object.assign({},_),{offset:n})}}}(n,f,e,t):CG(e,t,{defaultPos:"zeroOrMax",defaultPos2:"zeroOrMin"})}function EG(t,e,n,r,i,o){if(r){const e=r.get("type");if("point"===e||"band"===e){if(void 0!==i[t].discreteBandSize)return{value:i[t].discreteBandSize};if("point"===e){const t=r.get("range");return M$(t)&&ge(t.step)?{value:t.step-2}:{value:qq-2}}return{scale:n,band:o}}return{value:i[t].continuousBandSize}}const a=Vq(i.view,e),s=lL(i[t].discreteBandSize,a-2);return void 0!==s?{value:s}:void 0}function OG(t,e,n,r,i){if(cB(t))return 0;const o="x"===t||"y2"===t?-e/2:e/2;if(I$(n)){const t=GW(i);return{signal:`${n.signal} ? ${r-o}${t?"-"+t:""} : ${r+o}${t?"+"+t:""}`}}if(I$(i)){const t=r+(n?-o:o);return{signal:`${t||""}${n?" - ":t?" + ":""}${i.signal}`}}return i=i||0,r+(n?-i-o:+i+o)}function AG({channel:t,fieldDef:e,scaleName:n,markDef:r,band:i,offset:o,config:a}){return TV({fieldDef:e,channel:t,markDef:r,ref:MV({scaleName:n,fieldOrDatumDef:e,band:i,offset:o}),config:a})}const NG=new Set(["aria"]);function TG(t,e){const{fill:n,stroke:r}="include"===e.color?mG(t):{};return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},function(t,e){return P$.reduce((n,r)=>(NG.has(r)||void 0===t[r]||"ignore"===e[r]||(n[r]=qW(t[r])),n),{})}(t.markDef,e)),DG(t,"fill",n)),DG(t,"stroke",r)),pG("opacity",t)),pG("fillOpacity",t)),pG("strokeOpacity",t)),pG("strokeWidth",t)),pG("strokeDash",t)),hG(t)),lG(t,"href")),function(t){const{markDef:e,config:n}=t,r=KW("aria",e,n);return!1===r?{}:Object.assign(Object.assign(Object.assign({},r?{aria:r}:{}),function(t){const{mark:e,markDef:n,config:r}=t;if(!1===r.aria)return{};const i=KW("ariaRoleDescription",n,r);return null!=i?{ariaRoleDescription:{value:i}}:e in j$?{}:{ariaRoleDescription:{value:e}}}(t)),function(t){const{encoding:e,markDef:n,config:r,stack:i}=t,o=e.description;if(o)return uG(t,o,"description",e=>cG(e,t.config));const a=KW("description",n,r);if(null!=a)return{description:qW(a)};if(!1===r.aria)return{};const s=dG(e,i,r);return Xz(s)?void 0:{description:{signal:Zz(s).map(({key:t,value:e})=>`${t} + ": " + (${e})`).join(' + "; " + ')}}}(t))}(t))}function DG(t,e,n){const{config:r,mark:i,markDef:o}=t;if("hide"===KW("invalid",o,r)&&n&&!FL(i)){const r=function(t,{invalid:e=!1,channels:n}){const r=n.reduce((e,n)=>{const r=t.getScaleComponent(n);if(r){const i=r.get("type"),o=t.vgField(n,{expr:"datum"});o&&yV(i)&&(e[o]=!0)}return e},{}),i=Kz(r);if(i.length>0){const t=e?"||":"&&";return i.map(t=>RV(t,e)).join(` ${t} `)}}(t,{invalid:!0,channels:LB});if(r)return{[e]:[{test:r,value:null},...Xt(n)]}}return n?{[e]:n}:{}}function RG(t){const{config:e,markDef:n}=t;if(KW("invalid",n,e)){const e=function(t,{invalid:e=!1,channels:n}){const r=n.reduce((e,n)=>{const r=t.getScaleComponent(n);if(r){const i=r.get("type"),o=t.vgField(n,{expr:"datum"});o&&yV(i)&&(e[o]=!0)}return e},{}),i=Kz(r);if(i.length>0){const t=e?"||":"&&";return i.map(t=>RV(t,e)).join(` ${t} `)}}(t,{channels:DB});if(e)return{defined:{signal:e}}}return{}}function IG(t,e){if(void 0!==e)return{[t]:qW(e)}}var MG={has:t=>"interval"!==t.type&&t.nearest,parse:(t,e)=>{if(e.events)for(const n of e.events)n.markname=t.getName("voronoi")},marks:(t,e,n)=>{const{x:r,y:i}=e.project.hasChannel,o=t.mark;if(FL(o))return y$(y.nearestNotSupportForContinuous(o)),n;const a={name:t.getName("voronoi"),type:"path",interactive:!0,from:{data:t.getName("marks")},encode:{update:Object.assign({fill:{value:"transparent"},strokeWidth:{value:.35},stroke:{value:"transparent"},isVoronoi:{value:!0}},hG(t,{reactiveGeom:!0}))},transform:[{type:"voronoi",x:{expr:r||!i?"datum.datum.x || 0":"0"},y:{expr:i||!r?"datum.datum.y || 0":"0"},size:[t.getSizeSignalRef("width"),t.getSizeSignalRef("height")]}]};let s=0,u=!1;return n.forEach((e,n)=>{var r;const i=null!==(r=e.name)&&void 0!==r?r:"";i===t.component.mark[0].name?s=n:i.indexOf("voronoi")>=0&&(u=!0)}),u||n.splice(s+1,0,a),n}};class FG{constructor(t,e){this.debugName=e,this._children=[],this._parent=null,t&&(this.parent=t)}clone(){throw new Error("Cannot clone node")}get parent(){return this._parent}set parent(t){this._parent=t,t&&t.addChild(this)}get children(){return this._children}numChildren(){return this._children.length}addChild(t,e){this._children.indexOf(t)>-1?console.warn("Attempt to add the same child twice."):void 0!==e?this._children.splice(e,0,t):this._children.push(t)}removeChild(t){const e=this._children.indexOf(t);return this._children.splice(e,1),e}remove(){let t=this._parent.removeChild(this);for(const e of this._children)e._parent=this._parent,this._parent.addChild(e,t++)}insertAsParentOf(t){const e=t.parent;e.removeChild(this),this.parent=e,t.parent=this}swapWithParent(){const t=this._parent,e=t.parent;for(const n of this._children)n.parent=t;this._children=[],t.removeChild(this),t.parent.removeChild(t),this.parent=e,t.parent=this}}class PG extends FG{constructor(t,e,n,r){super(t,e),this.type=n,this.refCounts=r,this._source=this._name=e,this.refCounts&&!(this._name in this.refCounts)&&(this.refCounts[this._name]=0)}clone(){const t=new this.constructor;return t.debugName="clone_"+this.debugName,t._source=this._source,t._name="clone_"+this._name,t.type=this.type,t.refCounts=this.refCounts,t.refCounts[t._name]=0,t}dependentFields(){return new Set}producedFields(){return new Set}hash(){return void 0===this._hash&&(this._hash="Output "+function(t){const e=++cL;return e}()),this._hash}getSource(){return this.refCounts[this._name]++,this._source}isRequired(){return!!this.refCounts[this._name]}setSource(t){this._source=t}}class jG extends FG{constructor(t,e){super(t),this.formula=e}clone(){return new jG(null,Mz(this.formula))}static makeFromEncoding(t,e){const n=e.reduceFieldDef((t,n,r)=>{const{field:i,timeUnit:o}=n,a=RY(e)?e.encoding[EB(r)]:void 0,s=RY(e)&&aW(r,n,a,e.stack,e.markDef,e.config);if(o){const e=_W(n,{forAs:!0});t[zz({as:e,field:i,timeUnit:o})]=Object.assign({as:e,field:i,timeUnit:o},s?{band:!0}:{})}return t},{});return Xz(n)?null:new jG(t,n)}static makeFromTransform(t,e){const n=Object.assign({},e),{timeUnit:r}=n,i=Object(x.b)(n,["timeUnit"]),o=R$(r),a=Object.assign(Object.assign({},i),{timeUnit:o});return new jG(t,{[zz(a)]:a})}merge(t){this.formula=Object.assign({},this.formula);for(const e in t.formula)this.formula[e]&&!t.formula[e].band||(this.formula[e]=t.formula[e]);for(const e of t.children)t.removeChild(e),e.parent=this;t.remove()}producedFields(){return new Set(Yz(this.formula).map(t=>t.as))}dependentFields(){return new Set(Yz(this.formula).map(t=>t.field))}hash(){return"TimeUnit "+zz(this.formula)}assemble(){const t=[];for(const e of Yz(this.formula)){const{field:n,as:r,timeUnit:i}=e,o=R$(i),{unit:a,utc:s}=o,u=Object(x.b)(o,["unit","utc"]);t.push(Object.assign(Object.assign(Object.assign(Object.assign({field:oL(n),type:"timeunit"},a?{units:N$(a)}:{}),s?{timezone:"utc"}:{}),u),{as:[r,r+"_end"]}))}return t}}class zG{constructor(...t){this.items=t,this.hasChannel={},this.hasField={}}}var LG={has:t=>"single"===t.type&&"global"===t.resolve&&t.bind&&"scales"!==t.bind&&!Mq(t.bind),parse:(t,e,n,r)=>{r.on||delete e.events,r.clear||delete e.clear},topLevelSignals:(t,e,n)=>{const r=e.name,i=e.project,o=e.bind,a=e.init&&e.init[0],s=MG.has(e)?"(item().isVoronoi ? datum.datum : datum)":"datum";return i.items.forEach((t,i)=>{var u,l;const c=Jz(`${r}_${t.field}`);n.filter(t=>t.name===c).length||n.unshift(Object.assign(Object.assign({name:c},a?{init:JG(a[i])}:{value:null}),{on:e.events?[{events:e.events,update:`datum && item().mark.marktype !== 'group' ? ${s}[${Ee(t.field)}] : null`}]:[],bind:null!==(l=null!==(u=o[t.field])&&void 0!==u?u:o[t.channel])&&void 0!==l?l:o}))}),n},signals:(t,e,n)=>{const r=e.name,i=e.project,o=n.filter(t=>t.name===r+lX)[0],a=r+"_tuple_fields",s=i.items.map(t=>Jz(`${r}_${t.field}`)),u=s.map(t=>t+" !== null").join(" && ");return s.length&&(o.update=`${u} ? {fields: ${a}, values: [${s.join(", ")}]} : null`),delete o.value,delete o.on,n}},BG={has:t=>"multi"===t.type&&!!t.toggle,signals:(t,e,n)=>n.concat({name:e.name+"_toggle",value:!1,on:[{events:e.events,update:e.toggle}]}),modifyExpr:(t,e)=>{const n=e.name+lX,r=e.name+"_toggle";return`${r} ? null : ${n}, `+("global"===e.resolve?r+" ? null : true, ":`${r} ? null : {unit: ${fX(t)}}, `)+`${r} ? ${n} : null`}};const UG={has:t=>void 0!==t.clear&&!1!==t.clear,parse:(t,e,n)=>{n.clear&&(e.clear=ve(n.clear)?ZF(n.clear,"scope"):n.clear)},topLevelSignals:(t,e,n)=>{if(LG.has(e))for(const r of e.project.items){const t=n.findIndex(t=>t.name===Jz(`${e.name}_${r.field}`));-1!==t&&n[t].on.push({events:e.clear,update:"null"})}return n},signals:(t,e,n)=>{function r(t,r){-1!==t&&n[t].on&&n[t].on.push({events:e.clear,update:r})}if("interval"===e.type)for(const i of e.project.items){const t=n.findIndex(t=>t.name===i.signals.visual);r(t,"[0, 0]"),-1===t&&r(n.findIndex(t=>t.name===i.signals.data),"null")}else{let t=n.findIndex(t=>t.name===e.name+lX);r(t,"null"),BG.has(e)&&(t=n.findIndex(t=>t.name===e.name+"_toggle"),r(t,"false"))}return n}};var $G={has:t=>"interval"===t.type&&"global"===t.resolve&&t.bind&&"scales"===t.bind,parse:(t,e)=>{const n=e.scales=[];for(const r of e.project.items){const i=r.channel;if(!BB(i))continue;const o=t.getScaleComponent(i),a=o?o.get("type"):void 0;o&&yV(a)?(o.set("selectionExtent",{selection:e.name,field:r.field},!0),n.push(r)):y$(y.SCALE_BINDINGS_CONTINUOUS)}},topLevelSignals:(t,e,n)=>{const r=e.scales.filter(t=>0===n.filter(e=>e.name===t.signals.data).length);if(!t.parent||WG(t)||0===r.length)return n;const i=n.filter(t=>t.name===e.name)[0];let o=i.update;if(o.indexOf(cX)>=0)i.update=`{${r.map(t=>`${Ee(t.field)}: ${t.signals.data}`).join(", ")}}`;else{for(const t of r){const e=`${Ee(t.field)}: ${t.signals.data}`;o.indexOf(e)<0&&(o=`${o.substring(0,o.length-1)}, ${e}}`)}i.update=o}return n.concat(r.map(t=>({name:t.signals.data})))},signals:(t,e,n)=>{if(t.parent&&!WG(t))for(const r of e.scales){const t=n.filter(t=>t.name===r.signals.data)[0];t.push="outer",delete t.value,delete t.update}return n}};function VG(t,e){return`domain(${Ee(t.scaleName(e))})`}function WG(t){var e;return t.parent&&FY(t.parent)&&(null!==(e=!t.parent.parent)&&void 0!==e?e:WG(t.parent.parent))}const qG={has:t=>{const e="global"===t.resolve&&t.bind&&Mq(t.bind),n=1===t.project.items.length&&"_vgsid_"!==t.project.items[0].field;return e&&!n&&y$(y.LEGEND_BINDINGS_PROJECT_LENGTH),e&&n},parse:(t,e,n,r)=>{var i;if(r.on||delete e.events,r.clear||delete e.clear,r.on||r.clear){const t='event.item && indexof(event.item.mark.role, "legend") < 0';for(const n of e.events)n.filter=Xt(null!==(i=n.filter)&&void 0!==i?i:[]),n.filter.indexOf(t)<0&&n.filter.push(t)}const o=Fq(e.bind)?e.bind.legend:"click",a=ve(o)?ZF(o,"view"):Xt(o);e.bind={legend:{merge:a}}},topLevelSignals:(t,e,n)=>{const r=e.name,i=Fq(e.bind)&&e.bind.legend,o=t=>e=>{const n=Mz(e);return n.markname=t,n};for(const a of e.project.items){if(!a.hasLegend)continue;const t=Jz(a.field)+"_legend",s=`${r}_${t}`;if(0===n.filter(t=>t.name===s).length){const r=i.merge.map(o(t+"_symbols")).concat(i.merge.map(o(t+"_labels"))).concat(i.merge.map(o(t+"_entries")));n.unshift(Object.assign(Object.assign({name:s},e.init?{}:{value:null}),{on:[{events:r,update:"datum.value || item().items[0].items[0].datum.value",force:!0},{events:i.merge,update:"!event.item || !datum ? null : "+s,force:!0}]}))}}return n},signals:(t,e,n)=>{const r=e.name,i=e.project,o=n.find(t=>t.name===r+lX),a=r+"_tuple_fields",s=i.items.filter(t=>t.hasLegend).map(t=>Jz(`${r}_${Jz(t.field)}_legend`)),u=`${s.map(t=>t+" !== null").join(" && ")} ? {fields: ${a}, values: [${s.join(", ")}]} : null`;e.events&&s.length>0?o.on.push({events:s.map(t=>({signal:t})),update:u}):s.length>0&&(o.update=u,delete o.value,delete o.on);const l=n.find(t=>t.name===r+"_toggle"),c=Fq(e.bind)&&e.bind.legend;return l&&(e.events?l.on.push(Object.assign(Object.assign({},l.on[0]),{events:c})):l.on[0].events=c),n}},HG="_translate_delta",GG={has:t=>"interval"===t.type&&t.translate,signals:(t,e,n)=>{const r=e.name,i=$G.has(e),o=r+"_translate_anchor",{x:a,y:s}=e.project.hasChannel;let u=ZF(e.translate,"scope");return i||(u=u.map(t=>(t.between[0].markname=r+nX,t))),n.push({name:o,value:{},on:[{events:u.map(t=>t.between[0]),update:"{x: x(unit), y: y(unit)"+(void 0!==a?", extent_x: "+(i?VG(t,"x"):`slice(${a.signals.visual})`):"")+(void 0!==s?", extent_y: "+(i?VG(t,"y"):`slice(${s.signals.visual})`):"")+"}"}]},{name:r+HG,value:{},on:[{events:u,update:`{x: ${o}.x - x(unit), y: ${o}.y - y(unit)}`}]}),void 0!==a&&XG(t,e,a,"width",n),void 0!==s&&XG(t,e,s,"height",n),n}};function XG(t,e,n,r,i){var o;const a=e.name,s=a+"_translate_anchor",u=a+HG,l=n.channel,c=$G.has(e),h=i.filter(t=>t.name===n.signals[c?"data":"visual"])[0],d=t.getSizeSignalRef(r).signal,f=t.getScaleComponent(l),p=f.get("type"),m=`${s}.extent_${l}`,g=`${c?"log"===p?"panLog":"pow"===p?"panPow":"panLinear":"panLinear"}(${m}, ${`${c&&"x"===l?"-":""}${u}.${l} / `+(c?""+d:`span(${m})`)}`+(c&&"pow"===p?", "+(null!==(o=f.get("exponent"))&&void 0!==o?o:1):"")+")";h.on.push({events:{signal:u},update:c?g:`clampRange(${g}, 0, ${d})`})}const KG={has:t=>"interval"===t.type&&t.zoom,signals:(t,e,n)=>{const r=e.name,i=$G.has(e),o=r+"_zoom_delta",{x:a,y:s}=e.project.hasChannel,u=Ee(t.scaleName("x")),l=Ee(t.scaleName("y"));let c=ZF(e.zoom,"scope");return i||(c=c.map(t=>(t.markname=r+nX,t))),n.push({name:r+"_zoom_anchor",on:[{events:c,update:i?"{"+[u?`x: invert(${u}, x(unit))`:"",l?`y: invert(${l}, y(unit))`:""].filter(t=>!!t).join(", ")+"}":"{x: x(unit), y: y(unit)}"}]},{name:o,on:[{events:c,force:!0,update:"pow(1.001, event.deltaY * pow(16, event.deltaMode))"}]}),void 0!==a&&YG(t,e,a,"width",n),void 0!==s&&YG(t,e,s,"height",n),n}};function YG(t,e,n,r,i){var o;const a=e.name,s=n.channel,u=$G.has(e),l=i.filter(t=>t.name===n.signals[u?"data":"visual"])[0],c=t.getSizeSignalRef(r).signal,h=t.getScaleComponent(s),d=h.get("type"),f=u?VG(t,s):l.name,p=a+"_zoom_delta",m=`${u?"log"===d?"zoomLog":"pow"===d?"zoomPow":"zoomLinear":"zoomLinear"}(${f}, ${a}_zoom_anchor.${s}, ${p}`+(u&&"pow"===d?", "+(null!==(o=h.get("exponent"))&&void 0!==o?o:1):"")+")";l.on.push({events:{signal:p},update:u?m:`clampRange(${m}, 0, ${c})`})}const ZG=[{has:()=>!0,parse:(t,e,n)=>{var r,i,o;const a=e.name,s=null!==(r=e.project)&&void 0!==r?r:e.project=new zG,u={},l={},c=new Set,h=(t,e)=>{const n="visual"===e?t.channel:t.field;let r=Jz(`${a}_${n}`);for(let i=1;c.has(r);i++)r=Jz(`${a}_${n}_${i}`);return c.add(r),{[e]:r}};if(!n.fields&&!n.encodings){const e=t.config.selection[n.type];if(n.init)for(const t of Xt(n.init))for(const r of Kz(t))wB[r]?(n.encodings||(n.encodings=[])).push(r):"interval"===n.type?(y$('Interval selections should be initialized using "x" and/or "y" keys.'),n.encodings=e.encodings):(n.fields||(n.fields=[])).push(r);else n.encodings=e.encodings,n.fields=e.fields}for(const d of null!==(i=n.fields)&&void 0!==i?i:[]){const t={type:"E",field:d};t.signals=Object.assign({},h(t,"data")),s.items.push(t),s.hasField[d]=t}for(const d of null!==(o=n.encodings)&&void 0!==o?o:[]){const n=t.fieldDef(d);if(n){let r=n.field;if(n.aggregate){y$(y.cannotProjectAggregate(d,n.aggregate));continue}if(!r){y$(y.cannotProjectOnChannelWithoutField(d));continue}if(n.timeUnit){r=t.vgField(d);const e={timeUnit:n.timeUnit,as:r,field:n.field};l[zz(e)]=e}if(!u[r]){let i="E";"interval"===e.type?yV(t.getScaleComponent(d).get("type"))&&(i="R"):n.bin&&(i="R-RE");const o={field:r,channel:d,type:i};o.signals=Object.assign(Object.assign({},h(o,"data")),h(o,"visual")),s.items.push(u[r]=o),s.hasField[r]=s.hasChannel[d]=u[r]}}else y$(y.cannotProjectOnChannelWithoutField(d))}if(n.init){const t=t=>s.items.map(e=>void 0!==t[e.channel]?t[e.channel]:t[e.field]);if("interval"===n.type)e.init=t(n.init);else{const r=Xt(n.init);e.init=r.map(t)}}Xz(l)||(s.timeUnit=new jG(null,l))},signals:(t,e,n)=>{const r=e.name+"_tuple_fields";return n.filter(t=>t.name===r).length>0?n:n.concat({name:r,value:e.project.items.map(t=>{const e=Object(x.b)(t,["signals","hasLegend"]);return e.field=oL(e.field),e})})}},BG,$G,qG,GG,KG,LG,MG,UG];function QG(t,e){for(const n of ZG)n.has(t)&&e(n)}function JG(t,e=!0,n=ht){if(Ct(t)){const r=t.map(t=>JG(t,e,n));return e?`[${r.join(", ")}]`:r}return v$(t)?n(e?k$(t):function(t){const e=C$(t,!0);return t.utc?+new Date(Date.UTC(...e)):+new Date(...e)}(t)):e?n(JSON.stringify(t)):t}function tX(t,e){return dX(t,(n,r)=>{e=r.marks?r.marks(t,n,e):e,QG(n,r=>{r.marks&&(e=r.marks(t,n,e))})}),e}function eX(t){return t.map(t=>(t.on&&!t.on.length&&delete t.on,t))}const nX="_brush",rX={signals:(t,e)=>{const n=e.name,r=n+"_tuple_fields",i=$G.has(e),o=[],a=[],s=[];if(e.translate&&!i){const t="!event.item || event.item.mark.name !== "+Ee(n+nX);iX(e,(e,n)=>{var r;const i=Xt(null!==(r=n.between[0].filter)&&void 0!==r?r:n.between[0].filter=[]);return i.indexOf(t)<0&&i.push(t),e})}e.project.items.forEach((n,r)=>{const i=n.channel;if("x"!==i&&"y"!==i)return void y$("Interval selections only support x and y encoding channels.");const u=function(t,e,n,r){const i=n.channel,o=n.signals.visual,a=n.signals.data,s=$G.has(e),u=Ee(t.scaleName(i)),l=t.getScaleComponent(i),c=l?l.get("type"):void 0,h=t=>`scale(${u}, ${t})`,d=t.getSizeSignalRef("x"===i?"width":"height").signal,f=i+"(unit)",p=iX(e,(t,e)=>[...t,{events:e.between[0],update:`[${f}, ${f}]`},{events:e,update:`[${o}[0], clamp(${f}, 0, ${d})]`}]);return p.push({events:{signal:e.name+"_scale_trigger"},update:yV(c)?`[${h(a+"[0]")}, ${h(a+"[1]")}]`:"[0, 0]"}),s?[{name:a,on:[]}]:[Object.assign(Object.assign({name:o},r?{init:JG(r,!0,h)}:{value:[]}),{on:p}),Object.assign(Object.assign({name:a},r?{init:JG(r)}:{}),{on:[{events:{signal:o},update:`${o}[0] === ${o}[1] ? null : invert(${u}, ${o})`}]})]}(t,e,n,e.init?e.init[r]:null),l=n.signals.data,c=n.signals.visual,h=Ee(t.scaleName(i)),d=yV(t.getScaleComponent(i).get("type"))?"+":"";o.push(...u),a.push(l),s.push({scaleName:t.scaleName(i),expr:`(!isArray(${l}) || (${d}invert(${h}, ${c})[0] === ${d}${l}[0] && ${d}invert(${h}, ${c})[1] === ${d}${l}[1]))`})}),i||o.push({name:n+"_scale_trigger",value:{},on:[{events:s.map(t=>({scale:t.scaleName})),update:s.map(t=>t.expr).join(" && ")+` ? ${n+"_scale_trigger"} : {}`}]});const u=e.init,l=`unit: ${fX(t)}, fields: ${r}, values`;return o.concat(Object.assign(Object.assign({name:n+lX},u?{init:`{${l}: ${JG(u)}}`}:{}),{on:[{events:[{signal:a.join(" || ")}],update:a.join(" && ")+` ? {${l}: [${a}]} : null`}]}))},modifyExpr:(t,e)=>e.name+lX+", "+("global"===e.resolve?"true":`{unit: ${fX(t)}}`),marks:(t,e,n)=>{const r=e.name,{x:i,y:o}=e.project.hasChannel,a=i&&i.signals.visual,s=o&&o.signals.visual,u=`data(${Ee(e.name+uX)})`;if($G.has(e))return n;const l={x:void 0!==i?{signal:a+"[0]"}:{value:0},y:void 0!==o?{signal:s+"[0]"}:{value:0},x2:void 0!==i?{signal:a+"[1]"}:{field:{group:"width"}},y2:void 0!==o?{signal:s+"[1]"}:{field:{group:"height"}}};if("global"===e.resolve)for(const g of Kz(l))l[g]=[Object.assign({test:`${u}.length && ${u}[0].unit === ${fX(t)}`},l[g]),{value:0}];const c=e.mark,{fill:h,fillOpacity:d,cursor:f}=c,p=Object(x.b)(c,["fill","fillOpacity","cursor"]),m=Kz(p).reduce((t,e)=>(t[e]=[{test:[void 0!==i&&`${a}[0] !== ${a}[1]`,void 0!==o&&`${s}[0] !== ${s}[1]`].filter(t=>t).join(" && "),value:p[e]},{value:null}],t),{});return[{name:r+nX+"_bg",type:"rect",clip:!0,encode:{enter:{fill:{value:h},fillOpacity:{value:d}},update:l}},...n,{name:r+nX,type:"rect",clip:!0,encode:{enter:Object.assign(Object.assign({},f?{cursor:{value:f}}:{}),{fill:{value:"transparent"}}),update:Object.assign(Object.assign({},l),m)}}]}};function iX(t,e){return t.events.reduce((t,n)=>n.between?e(t,n):(y$(n+" is not an ordered event stream for interval selections."),t),[])}function oX(t,e){const n=e.name,r=n+"_tuple_fields",i="(item().isVoronoi ? datum.datum : datum)",o=e.project.items.map(e=>{const n=t.fieldDef(e.channel);return n&&n.bin?`[${i}[${Ee(t.vgField(e.channel,{}))}], ${i}[${Ee(t.vgField(e.channel,{binSuffix:"end"}))}]]`:`${i}[${Ee(e.field)}]`}).join(", "),a=`unit: ${fX(t)}, fields: ${r}, values`,s=e.events;return[{name:n+lX,on:s?[{events:s,update:`datum && item().mark.marktype !== 'group' ? {${a}: [${o}]} : null`,force:!0}]:[]}]}const aX={signals:oX,modifyExpr:(t,e)=>e.name+lX+", "+("global"===e.resolve?"null":`{unit: ${fX(t)}}`)},sX={signals:oX,modifyExpr:(t,e)=>e.name+lX+", "+("global"===e.resolve?"true":`{unit: ${fX(t)}}`)},uX="_store",lX="_tuple",cX="vlSelectionResolve",hX={single:sX,multi:aX,interval:rX};function dX(t,e){const n=t.component.selection;if(n)for(const r of Yz(n))if(!0===e(r,hX[r.type]))break}function fX(t,{escape:e}={escape:!0}){let n=e?Ee(t.name):t.name;const r=function(t){let e=t.parent;for(;e&&!IY(e);)e=e.parent;return e}(t);if(r){const{facet:t}=r;for(const e of gB)t[e]&&(n+=` + '__facet_${e}_' + (facet[${Ee(r.vgField(e))}])`)}return n}function pX(t){let e=!1;return dX(t,t=>{e=e||t.project.items.some(t=>"_vgsid_"===t.field)}),e}function mX(t){const e=sI(t),n=new Set;return e.visit(t=>{"MemberExpression"===t.type&&function t(e){return"MemberExpression"===e.object.type?t(e.object):"datum"===e.object.name}(t)&&n.add(function t(e){const n=[];return"Identifier"===e.type?[e.name]:"Literal"===e.type?[e.value]:("MemberExpression"===e.type&&(n.push(...t(e.object)),n.push(...t(e.property))),n)}(t).slice(1).join("."))}),n}class gX extends FG{constructor(t,e,n){super(t),this.model=e,this.filter=n,this.expr=bX(this.model,this.filter,this),this._dependentFields=mX(this.expr)}clone(){return new gX(null,this.model,Mz(this.filter))}dependentFields(){return this._dependentFields}producedFields(){return new Set}assemble(){return{type:"filter",expr:this.expr}}hash(){return"Filter "+this.expr}}function yX(t,e,n,r="datum"){const i=[],o=tL(e,(function(e){const o=Jz(e),a=t.getSelectionComponent(o,e),s=Ee(o+uX);if(a.project.timeUnit){const e=null!=n?n:t.component.data.raw,r=a.project.timeUnit.clone();e.parent?r.insertAsParentOf(e):e.parent=r}return"none"!==a.empty&&i.push(s),`vlSelectionTest(${s}, ${r}`+("global"===a.resolve?")":`, ${Ee(a.resolve)})`)}));return(i.length?"!("+i.map(t=>`length(data(${t}))`).join(" || ")+") || ":"")+`(${o})`}function vX(t,e){const n=e.encoding;let r=e.field;if(n||r){if(n&&!r){const i=t.project.items.filter(t=>t.channel===n);!i.length||i.length>1?(r=t.project.items[0].field,y$((i.length?"Multiple ":"No ")+`matching ${Ee(n)} encoding found for selection ${Ee(e.selection)}. `+`Using "field": ${Ee(r)}.`)):r=i[0].field}}else r=t.project.items[0].field,t.project.items.length>1&&y$(`A "field" or "encoding" must be specified when using a selection as a scale domain. Using "field": ${Ee(r)}.`);return`${t.name}[${Ee(r)}]`}function bX(t,e,n){return tL(e,e=>ve(e)?e:function(t){return null==t?void 0:t.selection}(e)?yX(t,e.selection,n):X$(e))}function wX(t,e,n,r){var i,o,a;t.encode=null!==(i=t.encode)&&void 0!==i?i:{},t.encode[e]=null!==(o=t.encode[e])&&void 0!==o?o:{},t.encode[e].update=null!==(a=t.encode[e].update)&&void 0!==a?a:{},t.encode[e].update[n]=r}function xX(t,e,n,r={header:!1}){var i,o;const a=t.combine(),{disable:s,orient:u,scale:l,labelExpr:c,title:h,zindex:d}=a,f=Object(x.b)(a,["disable","orient","scale","labelExpr","title","zindex"]);if(!s){for(const t in f){const n=gL[t],r=f[t];if(n&&n!==e&&"both"!==n)delete f[t];else if(pL(r)){const{condition:e}=r,n=Object(x.b)(r,["condition"]),i=Xt(e),o=fL[t];if(o){const{vgProp:e,part:r}=o;wX(f,r,e,[...i.map(t=>{const{test:e}=t,n=Object(x.b)(t,["test"]);return Object.assign({test:bX(null,e)},n)}),n]),delete f[t]}else if(null===o){const e={signal:i.map(t=>{const{test:e}=t,n=Object(x.b)(t,["test"]);return`${bX(null,e)} ? ${HW(n)} : `}).join("")+HW(n)};f[t]=e}}else if(I$(r)){const e=fL[t];if(e){const{vgProp:n,part:i}=e;wX(f,i,n,r),delete f[t]}}}if("grid"===e){if(!f.grid)return;if(f.encode){const{grid:t}=f.encode;f.encode=Object.assign({},t?{grid:t}:{}),Xz(f.encode)&&delete f.encode}return Object.assign(Object.assign({scale:l,orient:u},f),{domain:!1,labels:!1,aria:!1,maxExtent:0,minExtent:0,ticks:!1,zindex:lL(d,0)})}{if(!r.header&&t.mainExtracted)return;if(void 0!==c){let t=c;(null===(o=null===(i=f.encode)||void 0===i?void 0:i.labels)||void 0===o?void 0:o.update)&&I$(f.encode.labels.update.text)&&(t=aL(c,"datum.label",f.encode.labels.update.text.signal)),wX(f,"labels","text",{signal:t})}if(null===f.labelAlign&&delete f.labelAlign,f.encode){for(const e of mL)t.hasAxisPart(e)||delete f.encode[e];Xz(f.encode)&&delete f.encode}const e=function(t,e){if(t)return Ct(t)&&!WW(t)?t.map(t=>TW(t,e)).join(", "):t}(h,n);return Object.assign(Object.assign(Object.assign(Object.assign({scale:l,orient:u,grid:!1},e?{title:e}:{}),f),!1===n.aria?{aria:!1}:{}),{zindex:lL(d,0)})}}}function _X(t){const{axes:e}=t.component,n=[];for(const r of DB)if(e[r])for(const i of e[r])if(!i.get("disable")&&!i.get("gridScale")){const e="x"===r?"height":"width",i=t.getSizeSignalRef(e).signal;e!==i&&n.push({name:e,update:i})}return n}const CX={titleAlign:"align",titleAnchor:"anchor",titleAngle:"angle",titleBaseline:"baseline",titleColor:"color",titleFont:"font",titleFontSize:"fontSize",titleFontStyle:"fontStyle",titleFontWeight:"fontWeight",titleLimit:"limit",titleLineHeight:"lineHeight",titleOrient:"orient",titlePadding:"offset"},kX={labelAlign:"align",labelAnchor:"anchor",labelAngle:"angle",labelBaseline:"baseline",labelColor:"color",labelFont:"font",labelFontSize:"fontSize",labelFontStyle:"fontStyle",labelFontWeight:"fontWeight",labelLimit:"limit",labelLineHeight:"lineHeight",labelOrient:"orient",labelPadding:"offset"},SX=Kz(CX),EX=Kz(kX);function OX(t,e,n,r){return Object.assign.apply(null,[{},...t.map(t=>{if("axisOrient"===t){const t="x"===n?"bottom":"left",i=e["x"===n?"axisBottom":"axisLeft"]||{},o=e["x"===n?"axisTop":"axisRight"]||{},a=new Set([...Kz(i),...Kz(o)]),s={};for(const e of a.values())s[e]={signal:`${r.signal} === "${t}" ? ${GW(i[e])} : ${GW(o[e])}`};return s}return e[t]})])}function AX(t,e){var n;const r=[{}];for(const i of t){let t=null===(n=e[i])||void 0===n?void 0:n.style;if(t){t=Xt(t);for(const n of t)r.push(e.style[n])}}return Object.assign.apply(null,r)}function NX(t,e,n,r={}){var i;const o=QW(t,n,e.style);if(void 0!==o)return{configFrom:"style",configValue:o};for(const a of["vlOnlyAxisConfig","vgAxisConfig","axisConfigStyle"])if(void 0!==(null===(i=r[a])||void 0===i?void 0:i[t]))return{configFrom:a,configValue:r[a][t]};return{}}const TX={scale:({model:t,channel:e})=>t.scaleName(e),format:({fieldOrDatumDef:t,config:e,axis:n})=>{const{format:r,formatType:i}=n;return $V(t,t.type,r,i,e,!0)},formatType:({axis:t,fieldOrDatumDef:e,scaleType:n})=>{const{formatType:r}=t;return VV(r,e,n)},grid:({fieldOrDatumDef:t,axis:e,scaleType:n})=>{var r;return(!cW(t)||!HB(t.bin))&&(null!==(r=e.grid)&&void 0!==r?r:function(t,e){return!gV(t)&&cW(e)&&!qB(null==e?void 0:e.bin)}(n,t))},gridScale:({model:t,channel:e})=>function(t,e){const n="x"===e?"y":"x";if(t.getScaleComponent(n))return t.scaleName(n)}(t,e),labelAlign:({axis:t,labelAngle:e,orient:n,channel:r})=>t.labelAlign||IX(e,n,r),labelAngle:({labelAngle:t})=>t,labelBaseline:({axis:t,labelAngle:e,orient:n,channel:r})=>t.labelBaseline||RX(e,n,r),labelFlush:({axis:t,fieldOrDatumDef:e,channel:n})=>{var r;return null!==(r=t.labelFlush)&&void 0!==r?r:function(t,e){if("x"===e&&Bz(["quantitative","temporal"],t))return!0}(e.type,n)},labelOverlap:({axis:t,fieldOrDatumDef:e,scaleType:n})=>{var r;return null!==(r=t.labelOverlap)&&void 0!==r?r:function(t,e){if("nominal"!==t)return"log"!==e||"greedy"}(e.type,n)},orient:({orient:t})=>t,tickCount:({channel:t,model:e,axis:n,fieldOrDatumDef:r,scaleType:i})=>{var o;const a="x"===t?"width":"y"===t?"height":void 0,s=a?e.getSizeSignalRef(a):void 0;return null!==(o=n.tickCount)&&void 0!==o?o:function({fieldOrDatumDef:t,scaleType:e,size:n,values:r}){var i;if(!r&&!gV(e)&&"log"!==e){if(cW(t)){if(qB(t.bin))return{signal:`ceil(${n.signal}/10)`};if(t.timeUnit&&Bz(["month","hours","day","quarter"],null===(i=R$(t.timeUnit))||void 0===i?void 0:i.unit))return}return{signal:`ceil(${n.signal}/40)`}}}({fieldOrDatumDef:r,scaleType:i,size:s,values:n.values})},title:({axis:t,model:e,channel:n})=>{if(void 0!==t.title)return t.title;const r=MX(e,n);if(void 0!==r)return r;const i=e.typedFieldDef(n),o=e.fieldDef("x"===n?"x2":"y2");return tq(i?[rW(i)]:[],cW(o)?[rW(o)]:[])},values:({axis:t,fieldOrDatumDef:e})=>function(t,e){const n=t.values;return Ct(n)?UW(e,n):I$(n)?n:void 0}(t,e),zindex:({axis:t,fieldOrDatumDef:e,mark:n})=>{var r;return null!==(r=t.zindex)&&void 0!==r?r:function(t,e){return"rect"===t&&CW(e)?1:0}(n,e)}};function DX(t){return`(((${t.signal} % 360) + 360) % 360)`}function RX(t,e,n,r){if(void 0!==t){if("x"===n){if(I$(t)){const n=DX(t);return{signal:`(45 < ${n} && ${n} < 135) || (225 < ${n} && ${n} < 315) ? "middle" :(${n} <= 45 || 315 <= ${n}) === ${I$(e)?`(${e.signal} === "top")`:"top"===e} ? "bottom" : "top"`}}return 45<t&&t<135||225<t&&t<315?"middle":I$(e)?{signal:`${e.signal} ${t<=45||315<=t?"===":"!=="} "top" ? "bottom" : "top"`}:(t<=45||315<=t)==("top"===e)?"bottom":"top"}if(I$(t)){const n=DX(t);return{signal:`${n} <= 45 || 315 <= ${n} || (135 <= ${n} && ${n} <= 225) ? ${r?'"middle"':"null"} : (45 <= ${n} && ${n} <= 135) === ${I$(e)?`(${e.signal} === "left")`:"left"===e} ? "top" : "bottom"`}}return t<=45||315<=t||135<=t&&t<=225?r?"middle":null:I$(e)?{signal:`${e.signal} ${45<=t&&t<=135?"===":"!=="} "left" ? "top" : "bottom"`}:(45<=t&&t<=135)==("left"===e)?"top":"bottom"}}function IX(t,e,n){if(void 0===t)return;const r="x"===n,i=r?0:90,o=r?"bottom":"left";if(I$(t)){const n=DX(t);return{signal:`(${i?"("+n+" + 90)":n} % 180 === 0) ? ${r?null:'"center"'} :(${i} < ${n} && ${n} < ${180+i}) === ${I$(e)?`(${e.signal} === "${o}")`:e===o} ? "left" : "right"`}}return(t+i)%180==0?r?null:"center":I$(e)?{signal:`${e.signal} ${i<t&&t<180+i?"===":"!=="} "${o}" ? "left" : "right"`}:(i<t&&t<180+i)==(e===o)?"left":"right"}function MX(t,e){const n="x"===e?"x2":"y2",r=t.fieldDef(e),i=t.fieldDef(n),o=r?r.title:void 0,a=i?i.title:void 0;return o&&a?eq(o,a):o||a||(void 0!==o?o:void 0!==a?a:void 0)}class FX extends FG{constructor(t,e){super(t),this.transform=e,this._dependentFields=mX(this.transform.calculate)}clone(){return new FX(null,Mz(this.transform))}static parseAllForSortIndex(t,e){return e.forEachFieldDef((e,n)=>{if(vW(e)&&JV(e.sort)){const{field:r,timeUnit:i}=e,o=e.sort,a=o.map((t,e)=>`${X$({field:r,timeUnit:i,equal:t})} ? ${e} : `).join("")+o.length;t=new FX(t,{calculate:a,as:PX(e,n,{forAs:!0})})}}),t}producedFields(){return new Set([this.transform.as])}dependentFields(){return this._dependentFields}assemble(){return{type:"formula",expr:this.transform.calculate,as:this.transform.as}}hash(){return"Calculate "+zz(this.transform)}}function PX(t,e,n){return _W(t,Object.assign({prefix:e,suffix:"sort_index"},null!=n?n:{}))}function jX(t,e){return Bz(["top","bottom"],e)?"column":Bz(["left","right"],e)||"row"===t?"row":"column"}function zX(t,e,n,r){const i="row"===r?n.headerRow:"column"===r?n.headerColumn:n.headerFacet;return lL(((null==e?void 0:e.header)||{})[t],i[t],n.header[t])}function LX(t,e,n,r){const i={};for(const o of t){const t=zX(o,e,n,r);void 0!==t&&(i[o]=t)}return i}const BX=["row","column"],UX=["header","footer"];function $X(t,e){const n=t.component.layoutHeaders[e].title,r=t.config?t.config:void 0,i=t.component.layoutHeaders[e].facetFieldDef?t.component.layoutHeaders[e].facetFieldDef:void 0,{titleAnchor:o,titleAngle:a,titleOrient:s}=LX(["titleAnchor","titleAngle","titleOrient"],i,r,e),u=jX(e,s),l=hL(a);return{name:e+"-title",type:"group",role:u+"-title",title:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({text:n},"row"===e?{orient:"left"}:{}),{style:"guide-title"}),WX(l,u)),VX(u,l,o)),ZX(r,i,e,SX,CX))}}function VX(t,e,n="middle"){switch(n){case"start":return{align:"left"};case"end":return{align:"right"}}const r=IX(e,"row"===t?"left":"top","row"===t?"y":"x");return r?{align:r}:{}}function WX(t,e){const n=RX(t,"row"===e?"left":"top","row"===e?"y":"x",!0);return n?{baseline:n}:{}}function qX(t,e){const n=t.component.layoutHeaders[e],r=[];for(const i of UX)if(n[i])for(const o of n[i]){const a=XX(t,e,i,n,o);null!=a&&r.push(a)}return r}function HX(t,e){var n;const{sort:r}=t;return QV(r)?{field:_W(r,{expr:"datum"}),order:null!==(n=r.order)&&void 0!==n?n:"ascending"}:Ct(r)?{field:PX(t,e,{expr:"datum"}),order:"ascending"}:{field:_W(t,{expr:"datum"}),order:null!=r?r:"ascending"}}function GX(t,e,n){const{format:r,formatType:i,labelAngle:o,labelAnchor:a,labelOrient:s,labelExpr:u}=LX(["format","formatType","labelAngle","labelAnchor","labelOrient","labelExpr"],t,n,e),l=LV({fieldOrDatumDef:t,format:r,formatType:i,expr:"parent",config:n}).signal,c=jX(e,s);return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({text:{signal:u?aL(aL(u,"datum.label",l),"datum.value",_W(t,{expr:"parent"})):l}},"row"===e?{orient:"left"}:{}),{style:"guide-label",frame:"group"}),WX(o,c)),VX(c,o,a)),ZX(n,t,e,EX,kX))}function XX(t,e,n,r,i){if(i){let o=null;const{facetFieldDef:a}=r,s=t.config?t.config:void 0;if(a&&i.labels){const{labelOrient:t}=LX(["labelOrient"],a,s,e);("row"===e&&!Bz(["top","bottom"],t)||"column"===e&&!Bz(["left","right"],t))&&(o=GX(a,e,s))}const u=IY(t)&&!tW(t.facet),l=i.axes,c=(null==l?void 0:l.length)>0;if(o||c){const s="row"===e?"height":"width";return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({name:t.getName(`${e}_${n}`),type:"group",role:`${e}-${n}`},r.facetFieldDef?{from:{data:t.getName(e+"_domain")},sort:HX(a,e)}:{}),c&&u?{from:{data:t.getName("facet_domain_"+e)}}:{}),o?{title:o}:{}),i.sizeSignal?{encode:{update:{[s]:i.sizeSignal}}}:{}),c?{axes:l}:{})}}return null}const KX={column:{start:0,end:1},row:{start:1,end:0}};function YX(t,e){return KX[e][t]}function ZX(t,e,n,r,i){const o={};for(const a of r){if(!i[a])continue;const r=zX(a,e,t,n);void 0!==r&&(o[i[a]]=r)}return o}function QX(t){return[...JX(t,"width"),...JX(t,"height"),...JX(t,"childWidth"),...JX(t,"childHeight")]}function JX(t,e){const n="width"===e?"x":"y",r=t.component.layoutSize.get(e);if(!r||"merged"===r)return[];const i=t.getSizeSignalRef(e).signal;if("step"===r){const e=t.getScaleComponent(n);if(e){const r=e.get("type"),o=e.get("range");if(gV(r)&&M$(o)){const r=t.scaleName(n);return IY(t.parent)&&"independent"===t.parent.component.resolve.scale[n]?[tK(r,o)]:[tK(r,o),{name:i,update:eK(r,e,`domain('${r}').length`)}]}}throw new Error("layout size is step although width/height is not step.")}if("container"==r){const e=i.endsWith("width"),n=e?"containerSize()[0]":"containerSize()[1]",r=`isFinite(${n}) ? ${n} : ${$q(t.config.view,e?"width":"height")}`;return[{name:i,init:r,on:[{update:r,events:"window:resize"}]}]}return[{name:i,value:r}]}function tK(t,e){return{name:t+"_step",value:e.step}}function eK(t,e,n){const r=e.get("type"),i=e.get("padding"),o=lL(e.get("paddingOuter"),i);let a=e.get("paddingInner");return a="band"===r?void 0!==a?a:i:1,`bandspace(${n}, ${a}, ${o}) * ${t}_step`}function nK(t){return"childWidth"===t?"width":"childHeight"===t?"height":t}function rK(t,e){return Kz(t).reduce((n,r)=>{const i=t[r];return Object.assign(Object.assign({},n),uG(e,i,r,t=>I$(t)?t:{value:t.value}))},{})}function iK(t,e){if(FY(e)||IY(e))return"shared";if(MY(e))return RB(t)?"independent":"shared";throw new Error("invalid model type for resolve")}function oK(t,e){const n=t.scale[e],r=RB(e)?"axis":"legend";return"independent"===n?("shared"===t[r][e]&&y$(y.independentScaleMeansIndependentGuide(e)),"independent"):t[r][e]||"shared"}const aK=Object.assign(Object.assign({},Rq),{disable:1,labelExpr:1,selections:1,opacity:1,shape:1,stroke:1,fill:1,size:1,strokeWidth:1,strokeDash:1,encode:1}),sK=Kz(aK);class uK extends NH{}const lK={symbols:function(t,{fieldOrDatumDef:e,model:n,channel:r,legendCmpt:i,legendType:o}){var a,s,u,l,c;if("symbol"!==o)return;const{markDef:h,encoding:d,config:f,mark:p}=n,m=h.filled&&"trail"!==p;let g=Object.assign(Object.assign({},function(t,e,n){for(const r of n){const n=YW(r,e.markDef,e.config);void 0!==n&&(t[r]=qW(n))}return t}({},n,LL)),mG(n,{filled:m}));const y=null!==(a=cK(d.opacity))&&void 0!==a?a:h.opacity;if(g.fill)if("fill"===r||m&&r===iB)delete g.fill;else if(g.fill.field)i.get("symbolFillColor")?delete g.fill:(g.fill=qW(null!==(s=f.legend.symbolBaseFillColor)&&void 0!==s?s:"black"),g.fillOpacity=qW(null!=y?y:1));else if(Ct(g.fill)){const t=null!==(c=null!==(l=hK(null!==(u=d.fill)&&void 0!==u?u:d.color))&&void 0!==l?l:h.fill)&&void 0!==c?c:m&&h.color;t&&(g.fill=qW(t))}if(g.stroke)if("stroke"===r||!m&&r===iB)delete g.stroke;else if(g.stroke.field)delete g.stroke;else if(Ct(g.stroke)){const t=lL(hK(d.stroke||d.color),h.stroke,m?h.color:void 0);t&&(g.stroke={value:t})}if("opacity"!==r){const t=cW(e)&&fK(0,i,e);t?g.opacity=[Object.assign({test:t},qW(null!=y?y:1)),qW(f.legend.unselectedOpacity)]:y&&(g.opacity=qW(y))}return g=Object.assign(Object.assign({},g),t),Xz(g)?void 0:g},gradient:function(t,{model:e,legendType:n}){if("gradient"!==n)return;let r={};const i=cK(e.encoding.opacity)||e.markDef.opacity;return i&&(r.opacity=qW(i)),r=Object.assign(Object.assign({},r),t),Xz(r)?void 0:r},labels:function(t,{fieldOrDatumDef:e,model:n,channel:r,legendCmpt:i}){const o=n.legend(r)||{},a=n.config,s=cW(e)?fK(0,i,e):void 0,u=s?[{test:s,value:1},{value:a.legend.unselectedOpacity}]:void 0,{format:l,formatType:c}=o,h=jV(c)?UV({fieldOrDatumDef:e,field:"datum.value",format:l,formatType:c,config:a}):void 0,d=Object.assign(Object.assign(Object.assign({},u?{opacity:u}:{}),h?{text:h}:{}),t);return Xz(d)?void 0:d},entries:function(t,{legendCmpt:e}){const n=e.get("selections");return(null==n?void 0:n.length)?Object.assign(Object.assign({},t),{fill:{value:"transparent"}}):t}};function cK(t){return dK(t,(t,e)=>Math.max(t,e.value))}function hK(t){return dK(t,(t,e)=>lL(t,e.value))}function dK(t,e){return function(t){const e=t&&t.condition;return!!e&&(Ct(e)||yW(e))}(t)?Xt(t.condition).reduce(e,t.value):yW(t)?t.value:void 0}function fK(t,e,n){const r=e.get("selections");if(!(null==r?void 0:r.length))return;const i=Ee(n.field);return r.map(t=>`(!length(data(${Ee(Jz(t)+uX)})) || (${t}[${i}] && indexof(${t}[${i}], datum.value) >= 0))`).join(" || ")}const pK={direction:({direction:t})=>t,format:({fieldOrDatumDef:t,legend:e,config:n})=>{const{format:r,formatType:i}=e;return $V(t,t.type,r,i,n,!1)},formatType:({legend:t,fieldOrDatumDef:e,scaleType:n})=>{const{formatType:r}=t;return VV(r,e,n)},gradientLength:t=>{var e,n;const{legend:r,legendConfig:i}=t;return null!==(n=null!==(e=r.gradientLength)&&void 0!==e?e:i.gradientLength)&&void 0!==n?n:function({legendConfig:t,model:e,direction:n,orient:r,scaleType:i}){const{gradientHorizontalMaxLength:o,gradientHorizontalMinLength:a,gradientVerticalMaxLength:s,gradientVerticalMinLength:u}=t;if(vV(i))return"horizontal"===n?"top"===r||"bottom"===r?gK(e,"width",a,o):a:gK(e,"height",u,s)}(t)},labelOverlap:({legend:t,legendConfig:e,scaleType:n})=>{var r,i;return null!==(i=null!==(r=t.labelOverlap)&&void 0!==r?r:e.labelOverlap)&&void 0!==i?i:function(t){if(Bz(["quantile","threshold","log"],t))return"greedy"}(n)},symbolType:({legend:t,markDef:e,channel:n,encoding:r})=>{var i;return null!==(i=t.symbolType)&&void 0!==i?i:function(t,e,n,r){var i;if("shape"!==e){const t=null!==(i=hK(n))&&void 0!==i?i:r;if(t)return t}switch(t){case"bar":case"rect":case"image":case"square":return"square";case"line":case"trail":case"rule":return"stroke";case"arc":case"point":case"circle":case"tick":case"geoshape":case"area":case"text":return"circle"}}(e.type,n,r.shape,e.shape)},title:({fieldOrDatumDef:t,config:e})=>AW(t,e,{allowDisabling:!0}),type:({legendType:t,scaleType:e,channel:n})=>{if(pB(n)&&vV(e)){if("gradient"===t)return}else if("symbol"===t)return;return t},values:({fieldOrDatumDef:t,legend:e})=>function(t,e){const n=t.values;return Ct(n)?UW(e,n):I$(n)?n:void 0}(e,t)};function mK({legendConfig:t,legendType:e,orient:n,legend:r}){var i,o;return null!==(o=null!==(i=r.direction)&&void 0!==i?i:t[e?"gradientDirection":"symbolDirection"])&&void 0!==o?o:function(t,e){switch(t){case"top":case"bottom":return"horizontal";case"left":case"right":case"none":case void 0:return;default:return"gradient"===e?"horizontal":void 0}}(n,e)}function gK(t,e,n,r){return{signal:`clamp(${t.getSizeSignalRef(e).signal}, ${n}, ${r})`}}function yK(t,e,n,r){switch(e){case"disable":return void 0!==n;case"values":return!!(null==n?void 0:n.values);case"title":if("title"===e&&t===(null==r?void 0:r.title))return!0}return t===(n||{})[e]}function vK(t,e){var n,r,i;let o=t.legend(e);const{markDef:a,encoding:s,config:u}=t,l=u.legend,c=new uK({},function(t,e){const n=t.scaleName(e);if("trail"===t.mark){if("color"===e)return{stroke:n};if("size"===e)return{strokeWidth:n}}return"color"===e?t.markDef.filled?{fill:n}:{stroke:n}:{[e]:n}}(t,e));!function(t,e,n){var r;const i=null===(r=t.fieldDef(e))||void 0===r?void 0:r.field;dX(t,t=>{var r,o;const a=null!==(r=t.project.hasField[i])&&void 0!==r?r:t.project.hasChannel[e];if(a&&qG.has(t)){const e=null!==(o=n.get("selections"))&&void 0!==o?o:[];e.push(t.name),n.set("selections",e,!1),a.hasLegend=!0}})}(t,e,c);const h=void 0!==o?!o:l.disable;if(c.set("disable",h,void 0!==o),h)return c;o=o||{};const d=t.getScaleComponent(e).get("type"),f=IW(s[e]),p=cW(f)?null===(n=R$(f.timeUnit))||void 0===n?void 0:n.unit:void 0,m=o.orient||u.legend.orient||"right",g=function(t){const{legend:e}=t;return lL(e.type,function({channel:t,timeUnit:e,scaleType:n}){if(pB(t)){if(Bz(["quarter","month","day"],e))return"symbol";if(vV(n))return"gradient"}return"symbol"}(t))}({legend:o,channel:e,timeUnit:p,scaleType:d}),y={legend:o,channel:e,model:t,markDef:a,encoding:s,fieldOrDatumDef:f,legendConfig:l,config:u,scaleType:d,orient:m,legendType:g,direction:mK({legend:o,legendType:g,orient:m,legendConfig:l})};for(const _ of sK){const n=_ in pK?pK[_](y):o[_];if(void 0!==n){const r=yK(n,_,o,t.fieldDef(e));(r||void 0===u.legend[_])&&c.set(_,n,r)}}const v=null!==(r=null==o?void 0:o.encoding)&&void 0!==r?r:{},b=c.get("selections"),w={},x={fieldOrDatumDef:f,model:t,channel:e,legendCmpt:c,legendType:g};for(const _ of["labels","legend","title","symbols","gradient","entries"]){const e=rK(null!==(i=v[_])&&void 0!==i?i:{},t),n=_ in lK?lK[_](e,x):e;void 0===n||Xz(n)||(w[_]=Object.assign(Object.assign(Object.assign({},(null==b?void 0:b.length)&&cW(f)?{name:`${Jz(f.field)}_legend_${_}`}:{}),(null==b?void 0:b.length)?{interactive:!!b}:{}),{update:n}))}return Xz(w)||c.set("encode",w,!!(null==o?void 0:o.encoding)),c}function bK(t,e){var n,r,i,o;if(!t)return e.clone();const a=t.getWithExplicit("orient"),s=e.getWithExplicit("orient");if(a.explicit&&s.explicit&&a.value!==s.value)return;let u=!1;for(const l of sK){const n=MH(t.getWithExplicit(l),e.getWithExplicit(l),l,"legend",(t,e)=>{switch(l){case"symbolType":return"circle"===(n=e).value?n:t;case"title":return nq(t,e);case"type":return u=!0,DH("symbol")}var n;return IH(t,e,l,"legend")});t.setWithExplicit(l,n)}return u&&((null===(r=null===(n=t.implicit)||void 0===n?void 0:n.encode)||void 0===r?void 0:r.gradient)&&eL(t.implicit,["encode","gradient"]),(null===(o=null===(i=t.explicit)||void 0===i?void 0:i.encode)||void 0===o?void 0:o.gradient)&&eL(t.explicit,["encode","gradient"])),t}function wK(t,e,n,r){var i,o,a;t.encode=null!==(i=t.encode)&&void 0!==i?i:{},t.encode[e]=null!==(o=t.encode[e])&&void 0!==o?o:{},t.encode[e].update=null!==(a=t.encode[e].update)&&void 0!==a?a:{},t.encode[e].update[n]=r}function xK(t){const e=t.component.legends,n={};for(const r of Kz(e)){const i=t.getScaleComponent(r),o=jz(i.get("domains"));if(n[o])for(const t of n[o])bK(t,e[r])||n[o].push(e[r]);else n[o]=[e[r].clone()]}return Yz(n).flat().map(e=>function(t,e){var n,r,i;const o=t.combine(),{disable:a,labelExpr:s}=o,u=Object(x.b)(o,["disable","labelExpr","selections"]);if(!a){if(!1===e.aria&&null==u.aria&&(u.aria=!1),null===(n=u.encode)||void 0===n?void 0:n.symbols){const t=u.encode.symbols.update;!t.fill||"transparent"===t.fill.value||t.stroke||u.stroke||(t.stroke={value:"transparent"});for(const e of Tq)u[e]&&delete t[e]}if(u.title||delete u.title,void 0!==s){let t=s;(null===(i=null===(r=u.encode)||void 0===r?void 0:r.labels)||void 0===i?void 0:i.update)&&I$(u.encode.labels.update.text)&&(t=aL(s,"datum.label",u.encode.labels.update.text.signal)),wK(u,"labels","text",{signal:t})}for(const t in u){const e=u[t];if(I$(e)){const n=Dq[t];if(n){const{vgProp:r,part:i}=n;wK(u,i,r,e),delete u[t]}}}return u}}(e,t.config)).filter(t=>void 0!==t)}function _K(t){const e=t.component.projection;if(!e||e.merged)return[];const n=e.combine(),{name:r}=n;if(e.data){const i={signal:`[${e.size.map(t=>t.signal).join(", ")}]`},o=e.data.reduce((e,n)=>{const r=I$(n)?n.signal:`data('${t.lookupDataSource(n)}')`;return Bz(e,r)||e.push(r),e},[]);if(o.length<=0)throw new Error("Projection's fit didn't find any data sources");return[Object.assign({name:r,size:i,fit:{signal:o.length>1?`[${o.join(", ")}]`:o[0]}},n)]}return[Object.assign(Object.assign({name:r},{translate:{signal:"[width / 2, height / 2]"}}),n)]}const CK=["type","clipAngle","clipExtent","center","rotate","precision","reflectX","reflectY","coefficient","distance","fraction","lobes","parallel","radius","ratio","spacing","tilt"];class kK extends NH{constructor(t,e,n,r){super(Object.assign({},e),{name:t}),this.specifiedProjection=e,this.size=n,this.data=r,this.merged=!1}get isFit(){return!!this.data}}function SK(t,e){return`${WB(t)}_${e}`}function EK(t,e,n){var r;const i=SK(null!==(r=jW(n,void 0))&&void 0!==r?r:{},e);return t.getName(i+"_bins")}function OK(t,e,n){let r,i;r=function(t){return"as"in t}(t)?ve(t.as)?[t.as,t.as+"_end"]:[t.as[0],t.as[1]]:[_W(t,{forAs:!0}),_W(t,{binSuffix:"end",forAs:!0})];const o=Object.assign({},jW(e,void 0)),a=SK(o,t.field),{signal:s,extentSignal:u}=function(t,e){return{signal:t.getName(e+"_bins"),extentSignal:t.getName(e+"_extent")}}(n,a);if(XB(o.extent)){const t=o.extent,e=t.selection;i=vX(n.getSelectionComponent(Jz(e),e),t),delete o.extent}return{key:a,binComponent:Object.assign(Object.assign(Object.assign({bin:o,field:t.field,as:[r]},s?{signal:s}:{}),u?{extentSignal:u}:{}),i?{span:i}:{})}}class AK extends FG{constructor(t,e){super(t),this.bins=e}clone(){return new AK(null,Mz(this.bins))}static makeFromEncoding(t,e){const n=e.reduceFieldDef((t,n,r)=>{if(gW(n)&&qB(n.bin)){const{key:i,binComponent:o}=OK(n,n.bin,e);t[i]=Object.assign(Object.assign(Object.assign({},o),t[i]),function(t,e,n,r){var i,o;if($W(e,n)){const a=RY(t)&&null!==(o=null!==(i=t.axis(n))&&void 0!==i?i:t.legend(n))&&void 0!==o?o:{},s=_W(e,{expr:"datum"}),u=_W(e,{expr:"datum",binSuffix:"end"});return{formulaAs:_W(e,{binSuffix:"range",forAs:!0}),formula:GV(s,u,a.format,a.formatType,r)}}return{}}(e,n,r,e.config))}return t},{});return Xz(n)?null:new AK(t,n)}static makeFromTransform(t,e,n){const{key:r,binComponent:i}=OK(e,e.bin,n);return new AK(t,{[r]:i})}merge(t,e){for(const n of Kz(t.bins))n in this.bins?(e(t.bins[n].signal,this.bins[n].signal),this.bins[n].as=Wz([...this.bins[n].as,...t.bins[n].as],zz)):this.bins[n]=t.bins[n];for(const n of t.children)t.removeChild(n),n.parent=this;t.remove()}producedFields(){return new Set(Yz(this.bins).map(t=>t.as).flat(2))}dependentFields(){return new Set(Yz(this.bins).map(t=>t.field))}hash(){return"Bin "+zz(this.bins)}assemble(){return Yz(this.bins).flatMap(t=>{const e=[],[n,...r]=t.as,i=t.bin,{extent:o}=i,a=Object(x.b)(i,["extent"]),s=Object.assign(Object.assign(Object.assign({type:"bin",field:oL(t.field),as:n,signal:t.signal},XB(o)?{extent:null}:{extent:o}),t.span?{span:{signal:`span(${t.span})`}}:{}),a);!o&&t.extentSignal&&(e.push({type:"extent",field:oL(t.field),signal:t.extentSignal}),s.extent={signal:t.extentSignal}),e.push(s);for(const u of r)for(let t=0;t<2;t++)e.push({type:"formula",expr:_W({field:n[t]},{expr:"datum"}),as:u[t]});return t.formula&&e.push({type:"formula",expr:t.formula,as:t.formulaAs}),e})}}class NK extends FG{constructor(t){let e;if(super(null),LH(t=null!=t?t:{name:"source"})||(e=t.format?Object.assign({},Pz(t.format,["parse"])):{}),jH(t))this._data={values:t.values};else if(PH(t)){if(this._data={url:t.url},!e.type){let n=/(?:\.([^.]+))?$/.exec(t.url)[1];Bz(["json","csv","tsv","dsv","topojson"],n)||(n="json"),e.type=n}}else UH(t)?this._data={values:[{type:"Sphere"}]}:(zH(t)||LH(t))&&(this._data={});this._generator=LH(t),t.name&&(this._name=t.name),e&&!Xz(e)&&(this._data.format=e)}dependentFields(){return new Set}producedFields(){}get data(){return this._data}hasName(){return!!this._name}get isGenerator(){return this._generator}get dataName(){return this._name}set dataName(t){this._name=t}set parent(t){throw new Error("Source nodes have to be roots.")}remove(){throw new Error("Source nodes are roots and cannot be removed.")}hash(){throw new Error("Cannot hash sources")}assemble(){return Object.assign(Object.assign({name:this._name},this._data),{transform:[]})}}function TK(t){for(const e of t){for(const t of e.children)if(t.parent!==e)return console.error("Dataflow graph is inconsistent.",e,t),!1;if(!TK(e.children))return!1}return!0}class DK extends FG{constructor(t,e){super(t),this.params=e}clone(){return new DK(null,this.params)}dependentFields(){return new Set}producedFields(){}hash(){return"Graticule "+zz(this.params)}assemble(){return Object.assign({type:"graticule"},!0===this.params?{}:this.params)}}class RK extends FG{constructor(t,e){super(t),this.params=e}clone(){return new RK(null,this.params)}dependentFields(){return new Set}producedFields(){var t;return new Set([null!==(t=this.params.as)&&void 0!==t?t:"data"])}hash(){return"Hash "+zz(this.params)}assemble(){return Object.assign({type:"sequence"},this.params)}}function IK(t){return t instanceof NK||t instanceof DK||t instanceof RK}class MK{constructor(){this._mutated=!1}setMutated(){this._mutated=!0}get mutatedFlag(){return this._mutated}}class FK extends MK{constructor(){super(),this._continue=!1}setContinue(){this._continue=!0}get continueFlag(){return this._continue}get flags(){return{continueFlag:this.continueFlag,mutatedFlag:this.mutatedFlag}}set flags({continueFlag:t,mutatedFlag:e}){t&&this.setContinue(),e&&this.setMutated()}reset(){}optimizeNextFromLeaves(t){if(IK(t))return!1;const e=t.parent,{continueFlag:n}=this.run(t);return n&&this.optimizeNextFromLeaves(e),this.mutatedFlag}}class PK extends MK{}class jK extends FG{constructor(t,e,n){super(t),this.dimensions=e,this.measures=n}clone(){return new jK(null,new Set(this.dimensions),Mz(this.measures))}get groupBy(){return this.dimensions}static makeFromEncoding(t,e){let n=!1;e.forEachFieldDef(t=>{t.aggregate&&(n=!0)});const r={},i=new Set;return n?(e.forEachFieldDef((t,n)=>{var o,a,s,u;const{aggregate:l,field:c}=t;if(l)if("count"===l)r["*"]=null!==(o=r["*"])&&void 0!==o?o:{},r["*"].count=new Set([_W(t,{forAs:!0})]);else{if(HL(l)||GL(l)){const t=HL(l)?"argmin":"argmax",e=l[t];r[e]=null!==(a=r[e])&&void 0!==a?a:{},r[e][t]=new Set([_W({op:t,field:e},{forAs:!0})])}else r[c]=null!==(s=r[c])&&void 0!==s?s:{},r[c][l]=new Set([_W(t,{forAs:!0})]);BB(n)&&"unaggregated"===e.scaleDomain(n)&&(r[c]=null!==(u=r[c])&&void 0!==u?u:{},r[c].min=new Set([_W({field:c,aggregate:"min"},{forAs:!0})]),r[c].max=new Set([_W({field:c,aggregate:"max"},{forAs:!0})]))}else!function(t,e,n,r){const i=RY(r)?r.encoding[EB(e)]:void 0;if(gW(n)&&RY(r)&&aW(e,n,i,r.stack,r.markDef,r.config))t.add(_W(n,{})),t.add(_W(n,{suffix:"end"})),n.bin&&$W(n,e)&&t.add(_W(n,{binSuffix:"range"}));else if(e in hB){const n=function(t){switch(t){case"latitude":return"y";case"latitude2":return"y2";case"longitude":return"x";case"longitude2":return"x2"}}(e);t.add(r.getName(n))}else t.add(_W(n))}(i,n,t,e)}),i.size+Kz(r).length===0?null:new jK(t,i,r)):null}static makeFromTransform(t,e){var n,r,i;const o=new Set,a={};for(const s of e.aggregate){const{op:t,field:e,as:i}=s;t&&("count"===t?(a["*"]=null!==(n=a["*"])&&void 0!==n?n:{},a["*"].count=new Set([i||_W(s,{forAs:!0})])):(a[e]=null!==(r=a[e])&&void 0!==r?r:{},a[e][t]=new Set([i||_W(s,{forAs:!0})])))}for(const s of null!==(i=e.groupby)&&void 0!==i?i:[])o.add(s);return o.size+Kz(a).length===0?null:new jK(t,o,a)}merge(t){return function(t,e){if(t.size!==e.size)return!1;for(const n of t)if(!e.has(n))return!1;return!0}(this.dimensions,t.dimensions)?(function(t,e){var n;for(const r of Kz(e)){const i=e[r];for(const e of Kz(i))r in t?t[r][e]=new Set([...null!==(n=t[r][e])&&void 0!==n?n:[],...i[e]]):t[r]={[e]:i[e]}}}(this.measures,t.measures),!0):(g$.debug("different dimensions, cannot merge"),!1)}addDimensions(t){t.forEach(this.dimensions.add,this.dimensions)}dependentFields(){return new Set([...this.dimensions,...Kz(this.measures)])}producedFields(){const t=new Set;for(const e of Kz(this.measures))for(const n of Kz(this.measures[e])){const r=this.measures[e][n];0===r.size?t.add(`${n}_${e}`):r.forEach(t.add,t)}return t}hash(){return"Aggregate "+zz({dimensions:this.dimensions,measures:this.measures})}assemble(){const t=[],e=[],n=[];for(const r of Kz(this.measures))for(const i of Kz(this.measures[r]))for(const o of this.measures[r][i])n.push(o),t.push(i),e.push("*"===r?null:oL(r));return{type:"aggregate",groupby:[...this.dimensions].map(oL),ops:t,fields:e,as:n}}}class zK extends FG{constructor(t,e,n,r){super(t),this.model=e,this.name=n,this.data=r;for(const i of gB){const t=e.facet[i];if(t){const{bin:n,sort:r}=t;this[i]=Object.assign({name:e.getName(i+"_domain"),fields:[_W(t),...qB(n)?[_W(t,{binSuffix:"end"})]:[]]},QV(r)?{sortField:r}:Ct(r)?{sortIndexField:PX(t,i)}:{})}}this.childModel=e.child}hash(){let t="Facet";for(const e of gB)this[e]&&(t+=` ${e.charAt(0)}:${zz(this[e])}`);return t}get fields(){var t;const e=[];for(const n of gB)(null===(t=this[n])||void 0===t?void 0:t.fields)&&e.push(...this[n].fields);return e}dependentFields(){const t=new Set(this.fields);for(const e of gB)this[e]&&(this[e].sortField&&t.add(this[e].sortField.field),this[e].sortIndexField&&t.add(this[e].sortIndexField));return t}producedFields(){return new Set}getSource(){return this.name}getChildIndependentFieldsWithStep(){const t={};for(const e of DB){const n=this.childModel.component.scales[e];if(n&&!n.merged){const r=n.get("type"),i=n.get("range");if(gV(r)&&M$(i)){const n=yY(vY(this.childModel,e));n?t[e]=n:y$(`Unknown field for ${e}. Cannot calculate view size.`)}}}return t}assembleRowColumnHeaderData(t,e,n){const r={row:"y",column:"x"}[t],i=[],o=[],a=[];n&&n[r]&&(e?(i.push("distinct_"+n[r]),o.push("max")):(i.push(n[r]),o.push("distinct")),a.push("distinct_"+n[r]));const{sortField:s,sortIndexField:u}=this[t];if(s){const{op:t=XV,field:e}=s;i.push(e),o.push(t),a.push(_W(s,{forAs:!0}))}else u&&(i.push(u),o.push("max"),a.push(u));return{name:this[t].name,source:null!=e?e:this.data,transform:[Object.assign({type:"aggregate",groupby:this[t].fields},i.length?{fields:i,ops:o,as:a}:{})]}}assembleFacetHeaderData(t){var e,n;const{columns:r}=this.model.layout,{layoutHeaders:i}=this.model.component,o=[],a={};for(const l of BX){for(const t of UX){const r=null!==(e=i[l]&&i[l][t])&&void 0!==e?e:[];for(const t of r)if((null===(n=t.axes)||void 0===n?void 0:n.length)>0){a[l]=!0;break}}if(a[l]){const t=`length(data("${this.facet.name}"))`;o.push({name:`${this.facet.name}_${l}`,transform:[{type:"sequence",start:0,stop:"row"===l?r?{signal:`ceil(${t} / ${r})`}:1:r?{signal:`min(${t}, ${r})`}:{signal:t}}]})}}const{row:s,column:u}=a;return(s||u)&&o.unshift(this.assembleRowColumnHeaderData("facet",null,t)),o}assemble(){var t,e;const n=[];let r=null;const i=this.getChildIndependentFieldsWithStep(),{column:o,row:a,facet:s}=this;if(o&&a&&(i.x||i.y)){r=`cross_${this.column.name}_${this.row.name}`;const o=[].concat(null!==(t=i.x)&&void 0!==t?t:[],null!==(e=i.y)&&void 0!==e?e:[]),a=o.map(()=>"distinct");n.push({name:r,source:this.data,transform:[{type:"aggregate",groupby:this.fields,fields:o,ops:a}]})}for(const u of[tB,JL])this[u]&&n.push(this.assembleRowColumnHeaderData(u,r,i));if(s){const t=this.assembleFacetHeaderData(i);t&&n.push(...t)}return n}}function LK(t){return"'"===t[0]&&"'"===t[t.length-1]||'"'===t[0]&&'"'===t[t.length-1]?t.slice(1,-1):t}function BK(t){const e={};return function t(e,n){if(Dz(e))t(e.not,n);else if(Tz(e))for(const r of e.and)t(r,n);else if(Nz(e))for(const r of e.or)t(r,n);else n(e)}(t.filter,t=>{var n;if(H$(t)){let r=null;L$(t)?r=t.equal:W$(t)?r=t.range[0]:q$(t)&&(r=(null!==(n=t.oneOf)&&void 0!==n?n:t.in)[0]),r&&(v$(r)?e[t.field]="date":ge(r)?e[t.field]="number":ve(r)&&(e[t.field]="string")),t.timeUnit&&(e[t.field]="date")}}),e}class UK extends FG{constructor(t,e){super(t),this._parse=e}clone(){return new UK(null,Mz(this._parse))}hash(){return"Parse "+zz(this._parse)}static makeExplicit(t,e,n){let r={};const i=e.data;return!LH(i)&&i&&i.format&&i.format.parse&&(r=i.format.parse),this.makeWithAncestors(t,r,{},n)}static makeWithAncestors(t,e,n,r){for(const a of Kz(n)){const t=r.getWithExplicit(a);void 0!==t.value&&(t.explicit||t.value===n[a]||"derived"===t.value||"flatten"===n[a]?delete n[a]:y$(y.differentParse(a,n[a],t.value)))}for(const a of Kz(e)){const t=r.get(a);void 0!==t&&(t===e[a]?delete e[a]:y$(y.differentParse(a,e[a],t)))}const i=new NH(e,n);r.copyAll(i);const o={};for(const a of Kz(i.combine())){const t=i.get(a);null!==t&&(o[a]=t)}return 0===Kz(o).length||r.parseNothing?null:new UK(t,o)}get parse(){return this._parse}merge(t){this._parse=Object.assign(Object.assign({},this._parse),t.parse),t.remove()}assembleFormatParse(){const t={};for(const e of Kz(this._parse)){const n=this._parse[e];1===uL(e)&&(t[e]=n)}return t}producedFields(){return new Set(Kz(this._parse))}dependentFields(){return new Set(Kz(this._parse))}assembleTransforms(t=!1){return Kz(this._parse).filter(e=>!t||uL(e)>1).map(t=>{const e=function(t,e){const n=rL(t);return"number"===e?`toNumber(${n})`:"boolean"===e?`toBoolean(${n})`:"string"===e?`toString(${n})`:"date"===e?`toDate(${n})`:"flatten"===e?n:0===e.indexOf("date:")?`timeParse(${n},'${LK(e.slice(5,e.length))}')`:0===e.indexOf("utc:")?`utcParse(${n},'${LK(e.slice(4,e.length))}')`:(y$(y.unrecognizedParse(e)),null)}(t,this._parse[t]);return e?{type:"formula",expr:e,as:sL(t)}:null}).filter(t=>null!==t)}}class $K extends FG{clone(){return new $K(null)}constructor(t){super(t)}dependentFields(){return new Set}producedFields(){return new Set(["_vgsid_"])}hash(){return"Identifier"}assemble(){return{type:"identifier",as:"_vgsid_"}}}class VK extends FG{constructor(t,e){super(t),this.transform=e}clone(){return new VK(null,Mz(this.transform))}addDimensions(t){this.transform.groupby=Wz(this.transform.groupby.concat(t),t=>t)}dependentFields(){const t=new Set;return this.transform.groupby&&this.transform.groupby.forEach(t.add,t),this.transform.joinaggregate.map(t=>t.field).filter(t=>void 0!==t).forEach(t.add,t),t}producedFields(){return new Set(this.transform.joinaggregate.map(this.getDefaultName))}getDefaultName(t){var e;return null!==(e=t.as)&&void 0!==e?e:_W(t)}hash(){return"JoinAggregateTransform "+zz(this.transform)}assemble(){const t=[],e=[],n=[];for(const i of this.transform.joinaggregate)e.push(i.op),n.push(this.getDefaultName(i)),t.push(void 0===i.field?null:i.field);const r=this.transform.groupby;return Object.assign({type:"joinaggregate",as:n,ops:e,fields:t},void 0!==r?{groupby:r}:{})}}class WK extends FG{constructor(t,e){super(t),this._stack=e}clone(){return new WK(null,Mz(this._stack))}static makeFromTransform(t,e){const{stack:n,groupby:r,as:i,offset:o="zero"}=e,a=[],s=[];if(void 0!==e.sort)for(const c of e.sort)a.push(c.field),s.push(lL(c.order,"ascending"));const u={field:a,order:s};let l;return l=function(t){return Ct(t)&&t.every(t=>ve(t))&&t.length>1}(i)?i:ve(i)?[i,i+"_end"]:[e.stack+"_start",e.stack+"_end"],new WK(t,{stackField:n,groupby:r,offset:o,sort:u,facetby:[],as:l})}static makeFromEncoding(t,e){const n=e.stack,{encoding:r}=e;if(!n)return null;const{groupbyChannel:i,fieldChannel:o,offset:a,impute:s}=n;let u;i&&(u=RW(r[i]));const l=function(t){return t.stack.stackBy.reduce((t,e)=>{const n=_W(e.fieldDef);return n&&t.push(n),t},[])}(e),c=e.encoding.order;let h;return h=Ct(c)||cW(c)?JW(c):l.reduce((t,e)=>(t.field.push(e),t.order.push("y"===o?"descending":"ascending"),t),{field:[],order:[]}),new WK(t,{dimensionFieldDef:u,stackField:e.vgField(o),facetby:[],stackby:l,sort:h,offset:a,impute:s,as:[e.vgField(o,{suffix:"start",forAs:!0}),e.vgField(o,{suffix:"end",forAs:!0})]})}get stack(){return this._stack}addDimensions(t){this._stack.facetby.push(...t)}dependentFields(){const t=new Set;return t.add(this._stack.stackField),this.getGroupbyFields().forEach(t.add,t),this._stack.facetby.forEach(t.add,t),this._stack.sort.field.forEach(t.add,t),t}producedFields(){return new Set(this._stack.as)}hash(){return"Stack "+zz(this._stack)}getGroupbyFields(){const{dimensionFieldDef:t,impute:e,groupby:n}=this._stack;return t?t.bin?e?[_W(t,{binSuffix:"mid"})]:[_W(t,{}),_W(t,{binSuffix:"end"})]:[_W(t)]:null!=n?n:[]}assemble(){const t=[],{facetby:e,dimensionFieldDef:n,stackField:r,stackby:i,sort:o,offset:a,impute:s,as:u}=this._stack;if(s&&n){const{band:o=.5,bin:a}=n;a&&t.push({type:"formula",expr:o+"*"+_W(n,{expr:"datum"})+`+${1-o}*`+_W(n,{expr:"datum",binSuffix:"end"}),as:_W(n,{binSuffix:"mid",forAs:!0})}),t.push({type:"impute",field:r,groupby:[...i,...e],key:_W(n,{binSuffix:"mid"}),method:"value",value:0})}return t.push({type:"stack",groupby:[...this.getGroupbyFields(),...e],field:r,sort:o,as:u,offset:a}),t}}class qK extends FG{constructor(t,e){super(t),this.transform=e}clone(){return new qK(null,Mz(this.transform))}addDimensions(t){this.transform.groupby=Wz(this.transform.groupby.concat(t),t=>t)}dependentFields(){var t,e;const n=new Set;return(null!==(t=this.transform.groupby)&&void 0!==t?t:[]).forEach(n.add,n),(null!==(e=this.transform.sort)&&void 0!==e?e:[]).forEach(t=>n.add(t.field)),this.transform.window.map(t=>t.field).filter(t=>void 0!==t).forEach(n.add,n),n}producedFields(){return new Set(this.transform.window.map(this.getDefaultName))}getDefaultName(t){var e;return null!==(e=t.as)&&void 0!==e?e:_W(t)}hash(){return"WindowTransform "+zz(this.transform)}assemble(){var t;const e=[],n=[],r=[],i=[];for(const c of this.transform.window)n.push(c.op),r.push(this.getDefaultName(c)),i.push(void 0===c.param?null:c.param),e.push(void 0===c.field?null:c.field);const o=this.transform.frame,a=this.transform.groupby;if(o&&null===o[0]&&null===o[1]&&n.every(t=>XL(t)))return Object.assign({type:"joinaggregate",as:r,ops:n,fields:e},void 0!==a?{groupby:a}:{});const s=[],u=[];if(void 0!==this.transform.sort)for(const c of this.transform.sort)s.push(c.field),u.push(null!==(t=c.order)&&void 0!==t?t:"ascending");const l=this.transform.ignorePeers;return Object.assign(Object.assign(Object.assign({type:"window",params:i,as:r,ops:n,fields:e,sort:{field:s,order:u}},void 0!==l?{ignorePeers:l}:{}),void 0!==a?{groupby:a}:{}),void 0!==o?{frame:o}:{})}}class HK extends FK{run(t){const e=t.parent;if(t instanceof UK){if(IK(e))return this.flags;if(e.numChildren()>1)return this.setContinue(),this.flags;if(e instanceof UK)this.setMutated(),e.merge(t);else{if(Gz(e.producedFields(),t.dependentFields()))return this.setContinue(),this.flags;this.setMutated(),t.swapWithParent()}}return this.setContinue(),this.flags}}class GK extends PK{mergeNodes(t,e){const n=e.shift();for(const r of e)t.removeChild(r),r.parent=n,r.remove()}run(t){const e=t.children.map(t=>t.hash()),n={};for(let r=0;r<e.length;r++)void 0===n[e[r]]?n[e[r]]=[t.children[r]]:n[e[r]].push(t.children[r]);for(const r of Kz(n))n[r].length>1&&(this.setMutated(),this.mergeNodes(t,n[r]));for(const r of t.children)this.run(r);return this.mutatedFlag}}class XK extends FK{run(t){return t instanceof PG||t.numChildren()>0||t instanceof zK||(this.setMutated(),t.remove()),this.flags}}class KK extends FK{constructor(){super(...arguments),this.fields=new Set,this.prev=null}run(t){if(this.setContinue(),t instanceof jG){const e=t.producedFields();qz(e,this.fields)?(this.setMutated(),this.prev.remove()):this.fields=new Set([...this.fields,...e]),this.prev=t}return this.flags}reset(){this.fields.clear()}}class YK extends FK{run(t){this.setContinue();const e=t.parent.children.filter(t=>t instanceof jG),n=e.pop();for(const r of e)this.setMutated(),n.merge(r);return this.flags}}function ZK(t){if(t instanceof zK)if(1!==t.numChildren()||t.children[0]instanceof PG){const n=t.model.component.data.main;!function t(e){if(e instanceof PG&&e.type===VH&&1===e.numChildren()){const n=e.children[0];n instanceof zK||(n.swapWithParent(),t(e))}}(n);const r=(e=t,function t(n){if(!(n instanceof zK)){const r=n.clone();if(r instanceof PG){const t=iY+r.getSource();r.setSource(t),e.model.component.data.outputNodes[t]=r}else(r instanceof jK||r instanceof WK||r instanceof qK||r instanceof VK)&&r.addDimensions(e.fields);for(const e of n.children.flatMap(t))e.parent=r;return[r]}return n.children.flatMap(t)}),i=t.children.map(r).flat();for(const t of i)t.parent=n}else{const e=t.children[0];(e instanceof jK||e instanceof WK||e instanceof qK||e instanceof VK)&&e.addDimensions(t.fields),e.swapWithParent(),ZK(t)}else t.children.map(ZK);var e}class QK extends PK{constructor(){super()}run(t){t instanceof PG&&!t.isRequired()&&(this.setMutated(),t.remove());for(const e of t.children)this.run(e);return this.mutatedFlag}}class JK extends PK{constructor(t){super(),this.requiresSelectionId=t&&pX(t)}run(t){t instanceof $K&&(this.requiresSelectionId&&(IK(t.parent)||t.parent instanceof jK||t.parent instanceof UK)||(this.setMutated(),t.remove()));for(const e of t.children)this.run(e);return this.mutatedFlag}}class tY extends FK{run(t){const e=t.parent,n=[...e.children],r=e.children.filter(t=>t instanceof UK);if(e.numChildren()>1&&r.length>=1){const t={},i=new Set;for(const e of r){const n=e.parse;for(const e of Kz(n))e in t?t[e]!==n[e]&&i.add(e):t[e]=n[e]}for(const e of i)delete t[e];if(!Xz(t)){this.setMutated();const r=new UK(e,t);for(const i of n){if(i instanceof UK)for(const e of Kz(t))delete i.parse[e];e.removeChild(i),i.parent=r,i instanceof UK&&0===Kz(i.parse).length&&i.remove()}}}return this.setContinue(),this.flags}}class eY extends FK{run(t){const e=t.parent,n=e.children.filter(t=>t instanceof jK),r={};for(const i of n){const t=zz(i.groupBy);t in r||(r[t]=[]),r[t].push(i)}for(const i of Kz(r)){const t=r[i];if(t.length>1){const n=t.pop();for(const r of t)n.merge(r)&&(e.removeChild(r),r.parent=n,r.remove(),this.setMutated())}}return this.setContinue(),this.flags}}class nY extends FK{constructor(t){super(),this.model=t}run(t){const e=t.parent,n=!(IK(e)||e instanceof gX||e instanceof UK||e instanceof $K),r=[],i=[];for(const o of e.children)o instanceof AK&&(n&&!Gz(e.producedFields(),o.dependentFields())?r.push(o):i.push(o));if(r.length>0){const t=r.pop();for(const e of r)t.merge(e,this.model.renameSignal.bind(this.model));this.setMutated(),e instanceof AK?e.merge(t,this.model.renameSignal.bind(this.model)):t.swapWithParent()}if(i.length>1){const t=i.pop();for(const e of i)t.merge(e,this.model.renameSignal.bind(this.model));this.setMutated()}return this.setContinue(),this.flags}}class rY extends FK{run(t){const e=t.parent,n=[...e.children];if(!Uz(n,t=>t instanceof PG)||e.numChildren()<=1)return this.setContinue(),this.flags;const r=[];let i;for(const o of n)if(o instanceof PG){let t=o;for(;1===t.numChildren();){const e=t.children[0];if(!(e instanceof PG))break;t=e}r.push(...t.children),i?(e.removeChild(o),o.parent=i.parent,i.parent.removeChild(i),i.parent=t,this.setMutated()):i=t}else r.push(o);if(r.length){this.setMutated();for(const t of r)t.parent.removeChild(t),t.parent=i}return this.setContinue(),this.flags}}const iY="scale_";function oY(t){const e=[];function n(t){if(0===t.numChildren())e.push(t);else for(const e of t.children)n(e)}for(const r of t)n(r);return e}function aY(t){return t}function sY(t,e){return e.map(e=>{if(t instanceof FK){const n=t.optimizeNextFromLeaves(e);return t.reset(),n}return t.run(e)}).some(aY)}function uY(t,e){let n=t.sources;const r=new Set;return r.add(sY(new QK,n)),r.add(sY(new JK(e),n)),n=n.filter(t=>t.numChildren()>0),r.add(sY(new XK,oY(n))),n=n.filter(t=>t.numChildren()>0),r.add(sY(new HK,oY(n))),r.add(sY(new nY(e),oY(n))),r.add(sY(new KK,oY(n))),r.add(sY(new tY,oY(n))),r.add(sY(new eY,oY(n))),r.add(sY(new YK,oY(n))),r.add(sY(new GK,n)),r.add(sY(new rY,oY(n))),t.sources=n,r.has(!0)}class lY{constructor(t){Object.defineProperty(this,"signal",{enumerable:!0,get:t})}static fromName(t,e){return new lY(()=>t(e))}}function cY(t,e){const n=t.getScaleComponent(e).get("type"),{encoding:r}=t,i=function(t,e,n,r){if("unaggregated"===t){const{valid:t,reason:r}=mY(e,n);if(!t)return void y$(r)}else if(void 0===t&&r.useUnaggregatedDomain){const{valid:t}=mY(e,n);if(t)return"unaggregated"}return t}(t.scaleDomain(e),t.typedFieldDef(e),n,t.config.scale);return i!==t.scaleDomain(e)&&(t.specifiedScales[e]=Object.assign(Object.assign({},t.specifiedScales[e]),{domain:i})),"x"===e&&IW(r.x2)?IW(r.x)?MH(dY(n,i,t,"x"),dY(n,i,t,"x2"),"domain","scale",gY):dY(n,i,t,"x2"):"y"===e&&IW(r.y2)?IW(r.y)?MH(dY(n,i,t,"y"),dY(n,i,t,"y2"),"domain","scale",gY):dY(n,i,t,"y2"):dY(n,i,t,e)}function hY(t,e,n){var r;const i=null===(r=R$(n))||void 0===r?void 0:r.unit;return"temporal"===e||i?function(t,e,n){return t.map(t=>({signal:`{data: ${BW(t,{timeUnit:n,type:e})}}`}))}(t,e,i):[t]}function dY(t,e,n,r){const{encoding:i}=n,o=IW(i[r]),{type:a}=o,s=o.timeUnit;if(function(t){return t&&t.unionWith}(e)){const i=dY(t,void 0,n,r),o=hY(e.unionWith,a,s);return TH([...i.value,...o])}if(I$(e))return TH([e]);if(e&&"unaggregated"!==e&&!wV(e))return TH(hY(e,a,s));const u=n.stack;if(u&&r===u.fieldChannel){if("normalize"===u.offset)return DH([[0,1]]);const t=n.requestDataName(VH);return DH([{data:t,field:n.vgField(r,{suffix:"start"})},{data:t,field:n.vgField(r,{suffix:"end"})}])}const l=BB(r)&&cW(o)?function(t,e,n){if(!gV(n))return;const r=t.fieldDef(e),i=r.sort;if(JV(i))return{op:"min",field:PX(r,e),order:"ascending"};const{stack:o}=t,a=o?[...o.groupbyField?[o.groupbyField]:[],...o.stackBy.map(t=>t.fieldDef.field)]:void 0;if(QV(i))return fY(i,o&&!Bz(a,i.field));if(ZV(i)){const{encoding:e,order:n}=i,r=t.fieldDef(e),{aggregate:s,field:u}=r,l=o&&!Bz(a,u);if(HL(s)||GL(s))return fY({field:_W(r),order:n},l);if(XL(s)||!s)return fY({op:s,field:u,order:n},l)}else{if("descending"===i)return{op:"min",field:t.vgField(e),order:"descending"};if(Bz(["ascending",void 0],i))return!0}}(n,r,t):void 0;if(dW(o))return DH(hY([o.datum],a,s));const c=o;if("unaggregated"===e){const t=n.requestDataName(VH),{field:e}=o;return DH([{data:t,field:_W({field:e,aggregate:"min"})},{data:t,field:_W({field:e,aggregate:"max"})}])}if(qB(c.bin)){if(gV(t))return DH("bin-ordinal"===t?[]:[{data:Qz(l)?n.requestDataName(VH):n.requestDataName("raw"),field:n.vgField(r,$W(c,r)?{binSuffix:"range"}:{}),sort:!0!==l&&kt(l)?l:{field:n.vgField(r,{}),op:"min"}}]);{const{bin:t}=c;if(qB(t)){const e=EK(n,c.field,t);return DH([new lY(()=>{const t=n.getSignalName(e);return`[${t}.start, ${t}.stop]`})])}return DH([{data:n.requestDataName(VH),field:n.vgField(r,{})}])}}if(c.timeUnit&&Bz(["time","utc"],t)&&aW(r,c,RY(n)?n.encoding[EB(r)]:void 0,n.stack,n.markDef,n.config)){const t=n.requestDataName(VH);return DH([{data:t,field:n.vgField(r)},{data:t,field:n.vgField(r,{suffix:"end"})}])}return DH(l?[{data:Qz(l)?n.requestDataName(VH):n.requestDataName("raw"),field:n.vgField(r),sort:l}]:[{data:n.requestDataName(VH),field:n.vgField(r)}])}function fY(t,e){const{op:n,field:r,order:i}=t;return Object.assign(Object.assign({op:null!=n?n:e?"sum":XV},r?{field:oL(r)}:{}),i?{order:i}:{})}function pY(t,e){var n;const r=t.component.scales[e],i=t.specifiedScales[e].domain,o=null===(n=t.fieldDef(e))||void 0===n?void 0:n.bin,a=wV(i)&&i,s=GB(o)&&XB(o.extent)&&o.extent;(a||s)&&r.set("selectionExtent",null!=a?a:s,!0)}function mY(t,e){const{aggregate:n,type:r}=t;return n?ve(n)&&!QL[n]?{valid:!1,reason:y.unaggregateDomainWithNonSharedDomainOp(n)}:"quantitative"===r&&"log"===e?{valid:!1,reason:y.unaggregatedDomainWithLogScale(t)}:{valid:!0}:{valid:!1,reason:y.unaggregateDomainHasNoEffectForRawField(t)}}function gY(t,e,n,r){return t.explicit&&e.explicit&&y$(y.mergeConflictingDomainProperty(n,r,t.value,e.value)),{explicit:t.explicit,value:[...t.value,...e.value]}}function yY(t){if(F$(t)&&ve(t.field))return t.field;if(function(t){return!Ct(t)&&"fields"in t&&!("data"in t)}(t)){let e;for(const n of t.fields)if(F$(n)&&ve(n.field))if(e){if(e!==n.field)return y$(y.FACETED_INDEPENDENT_DIFFERENT_SOURCES),e}else e=n.field;return y$(y.FACETED_INDEPENDENT_SAME_FIELDS_DIFFERENT_SOURCES),e}if(function(t){return!Ct(t)&&"fields"in t&&"data"in t}(t)){y$(y.FACETED_INDEPENDENT_SAME_SOURCE);const e=t.fields[0];return ve(e)?e:void 0}}function vY(t,e){return function(t){const e=Wz(t.map(t=>F$(t)?Object(x.b)(t,["sort"]):t),zz),n=Wz(t.map(t=>{if(F$(t)){const e=t.sort;return void 0===e||Qz(e)||("op"in e&&"count"===e.op&&delete e.field,"ascending"===e.order&&delete e.order),e}}).filter(t=>void 0!==t),zz);if(0===e.length)return;if(1===e.length){const e=t[0];if(F$(e)&&n.length>0){let t=n[0];return n.length>1?(y$(y.MORE_THAN_ONE_SORT),t=!0):kt(t)&&"field"in t&&e.field===t.field&&(t=!t.order||{order:t.order}),Object.assign(Object.assign({},e),{sort:t})}return e}const r=Wz(n.map(t=>Qz(t)||!("op"in t)||t.op in qL?t:(y$(y.domainSortDropped(t)),!0)),zz);let i;1===r.length?i=r[0]:r.length>1&&(y$(y.MORE_THAN_ONE_SORT),i=!0);const o=Wz(t.map(t=>F$(t)?t.data:null),t=>t);return Object.assign(1===o.length&&null!==o[0]?{data:o[0],fields:e.map(t=>t.field)}:{fields:e},i?{sort:i}:{})}(t.component.scales[e].get("domains").map(e=>(F$(e)&&(e.data=t.lookupDataSource(e.data)),e)))}function bY(t){return Kz(t.component.scales).reduce((e,n)=>{const r=t.component.scales[n];if(r.merged)return e;const i=r.combine(),{name:o,type:a,selectionExtent:s,reverse:u}=i,l=Object(x.b)(i,["name","type","selectionExtent","domains","range","reverse"]),c=function(t,e,n){return RB(n)&&M$(t)?{step:{signal:e+"_step"}}:t}(i.range,o,n);let h;s&&(h=function(t,e){const n=e.selection;return{signal:vX(t.getSelectionComponent(n,Jz(n)),e)}}(t,s));const d=vY(t,n);return e.push(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({name:o,type:a},d?{domain:d}:{}),h?{domainRaw:h}:{}),{range:c}),void 0!==u?{reverse:u}:{}),l)),e},[])}class wY extends NH{constructor(t,e){super({},{name:t}),this.merged=!1,this.setWithExplicit("type",e)}domainDefinitelyIncludesZero(){return!1!==this.get("zero")||Uz(this.get("domains"),t=>Ct(t)&&2===t.length&&t[0]<=0&&t[1]>=0)}}const xY=["range","scheme"];function _Y(t){return"x"===t?"width":"y"===t?"height":void 0}function CY(t,e){const n=t.fieldDef(e);if(n&&n.bin&&qB(n.bin)){const r=EK(t,n.field,n.bin),i=_Y(e),o=t.getName(i);return new lY(()=>{const e=t.getSignalName(r),n=`(${e}.stop - ${e}.start) / ${e}.step`;return`${t.getSignalName(o)} / (${n})`})}}function kY(t,e){const n=e.specifiedScales[t],{size:r}=e,i=e.getScaleComponent(t).get("type");for(const a of xY)if(void 0!==n[a]){const r=kV(i,a),s=SV(t,a);if(r)if(s)y$(s);else switch(a){case"range":return Ct(n.range)&&RB(t)?TH(n.range.map(t=>{if("width"===t||"height"===t){const n=e.getName(t),r=e.getSignalName.bind(e);return lY.fromName(r,n)}return t})):TH(n.range);case"scheme":return TH(function(t){return!ve(t)&&!!t.name}(o=n[a])?Object.assign({scheme:o.name},Pz(o,["name"])):{scheme:o})}else y$(y.scalePropertyNotWorkWithScaleType(i,a,t))}var o;if("x"===t||"y"===t){const e="x"===t?"width":"height",n=r[e];if(Lq(n)){if(gV(i))return TH({step:n.step});y$(y.stepDropped(e))}}return DH(function(t,e){const{size:n,config:r,mark:i,encoding:o}=e,a=e.getSignalName.bind(e),{type:s}=IW(o[t]),u=e.getScaleComponent(t).get("type"),{domain:l,domainMid:c}=e.specifiedScales[t];switch(t){case"x":case"y":{if(Bz(["point","band"],u))if("x"!==t||n.width){if("y"===t&&!n.height){const t=Wq(r.view,"height");if(Lq(t))return t}}else{const t=Wq(r.view,"width");if(Lq(t))return t}const i=_Y(t),o=e.getName(i);return"y"===t&&yV(u)?[lY.fromName(a,o),0]:[0,lY.fromName(a,o)]}case uB:{const o=function t(e,n,r){if(n)return I$(n)?{signal:`${n.signal} ? 0 : ${t(e,!1,r)}`}:0;switch(e){case"bar":case"tick":return r.scale.minBandSize;case"line":case"trail":case"rule":return r.scale.minStrokeWidth;case"text":return r.scale.minFontSize;case"point":case"square":case"circle":return r.scale.minSize}throw new Error(y.incompatibleChannel("size",e))}(i,e.component.scales[t].get("zero"),r),a=function(t,e,n,r){const i={x:CY(n,"x"),y:CY(n,"y")};switch(t){case"bar":case"tick":{if(void 0!==r.scale.maxBandSize)return r.scale.maxBandSize;const t=SY(e,i,r.view);return ge(t)?t-1:new lY(()=>t.signal+" - 1")}case"line":case"trail":case"rule":return r.scale.maxStrokeWidth;case"text":return r.scale.maxFontSize;case"point":case"square":case"circle":{if(r.scale.maxSize)return r.scale.maxSize;const t=SY(e,i,r.view);return ge(t)?Math.pow(.95*t,2):new lY(()=>`pow(0.95 * ${t.signal}, 2)`)}}throw new Error(y.incompatibleChannel("size",t))}(i,n,e,r);return bV(u)?function(t,e,n){const r=()=>{const r=GW(e),i=GW(t),o=`(${r} - ${i}) / (${n} - 1)`;return`sequence(${i}, ${r} + ${o}, ${o})`};return I$(e)?new lY(r):{signal:r()}}(o,a,function(t,e,n,r){switch(t){case"quantile":return e.scale.quantileCount;case"quantize":return e.scale.quantizeCount;case"threshold":return void 0!==n&&Ct(n)?n.length+1:(y$(y.domainRequiredForThresholdScale(r)),3)}}(u,r,l,t)):[o,a]}case nB:return[0,2*Math.PI];case"angle":return[0,360];case eB:return[0,new lY(()=>`min(${e.getSignalName("width")},${e.getSignalName("height")})/2`)];case"strokeWidth":return[r.scale.minStrokeWidth,r.scale.maxStrokeWidth];case"strokeDash":return[[1,0],[4,2],[2,1],[1,1],[1,2,4,2]];case sB:return"symbol";case iB:case oB:case aB:return"ordinal"===u?"nominal"===s?"category":"ordinal":void 0!==c?"diverging":"rect"===i||"geoshape"===i?"heatmap":"ramp";case"opacity":case"fillOpacity":case"strokeOpacity":return[r.scale.minOpacity,r.scale.maxOpacity]}throw new Error("Scale range undefined for channel "+t)}(t,e))}function SY(t,e,n){const r=Lq(t.width)?t.width.step:Vq(n,"width"),i=Lq(t.height)?t.height.step:Vq(n,"height");return e.x||e.y?new lY(()=>`min(${[e.x?e.x.signal:r,e.y?e.y.signal:i].join(", ")})`):Math.min(r,i)}function EY(t,e){RY(t)?function(t,e){const n=t.component.scales,{config:r,encoding:i,markDef:o,specifiedScales:a}=t;for(const s of Kz(n)){const u=a[s],l=n[s],c=t.getScaleComponent(s),h=IW(i[s]),d=u[e],f=c.get("type"),p=c.get("padding"),m=c.get("paddingInner"),g=kV(f,e),v=SV(s,e);if(void 0!==d&&(g?v&&y$(v):y$(y.scalePropertyNotWorkWithScaleType(f,e,s))),g&&void 0===v)if(void 0!==d)l.copyKeyFromObject(e,u);else{const n=e in OY?OY[e]({model:t,channel:s,fieldOrDatumDef:h,scaleType:f,scalePadding:p,scalePaddingInner:m,domain:u.domain,markDef:o,config:r}):r.scale[e];void 0!==n&&l.set(e,n,!1)}}}(t,e):NY(t,e)}const OY={bins:({model:t,fieldOrDatumDef:e})=>cW(e)?function(t,e){const n=e.bin;if(qB(n)){const r=EK(t,e.field,n);return new lY(()=>t.getSignalName(r))}if(HB(n)&&GB(n)&&void 0!==n.step)return{step:n.step}}(t,e):void 0,interpolate:({channel:t,fieldOrDatumDef:e})=>function(t,e){if(Bz([iB,oB,aB],t)&&"nominal"!==e)return"hcl"}(t,e.type),nice:({scaleType:t,channel:e,fieldOrDatumDef:n})=>function(t,e,n){var r;if(!(null===(r=RW(n))||void 0===r?void 0:r.bin)&&!Bz(["time","utc"],t))return e in TB||void 0}(t,e,n),padding:({channel:t,scaleType:e,fieldOrDatumDef:n,markDef:r,config:i})=>function(t,e,n,r,i,o){if(t in TB){if(vV(e)){if(void 0!==n.continuousPadding)return n.continuousPadding;const{type:e,orient:a}=i;if("bar"===e&&(!cW(r)||!r.bin&&!r.timeUnit)&&("vertical"===a&&"x"===t||"horizontal"===a&&"y"===t))return o.continuousBandSize}if("point"===e)return n.pointPadding}}(t,e,i.scale,n,r,i.bar),paddingInner:({scalePadding:t,channel:e,markDef:n,config:r})=>function(t,e,n,r){if(void 0===t&&e in TB){const{bandPaddingInner:t,barBandPaddingInner:e,rectBandPaddingInner:i}=r;return lL(t,"bar"===n?e:i)}}(t,e,n.type,r.scale),paddingOuter:({scalePadding:t,channel:e,scaleType:n,scalePaddingInner:r,config:i})=>function(t,e,n,r,i,o){if(void 0===t&&e in TB&&"band"===n){const{bandPaddingOuter:t}=o;return lL(t,I$(i)?{signal:i.signal+"/2"}:i/2)}}(t,e,n,0,r,i.scale),reverse:({fieldOrDatumDef:t,scaleType:e,channel:n,config:r})=>function(t,e,n,r){return"x"===n&&void 0!==r.xReverse?yV(t)&&"descending"===e?I$(r.xReverse)?{signal:"!"+r.xReverse.signal}:!r.xReverse:r.xReverse:!(!yV(t)||"descending"!==e)||void 0}(e,cW(t)?t.sort:void 0,n,r.scale),zero:({channel:t,fieldOrDatumDef:e,domain:n,markDef:r,scaleType:i})=>function(t,e,n,r,i){if(n&&"unaggregated"!==n&&yV(i)){if(Ct(n)){const t=n[n.length-1];if(n[0]<=0&&t>=0)return!0}return!1}if("size"===t&&"quantitative"===e.type&&!bV(i))return!0;if((!cW(e)||!e.bin)&&Bz([...DB,...MB],t)){const{orient:e,type:n}=r;return!Bz(["bar","area","line","trail"],n)||!("horizontal"===e&&"y"===t||"vertical"===e&&"x"===t)}return!1}(t,e,n,r,i)};function AY(t){RY(t)?function(t){const e=t.component.scales;for(const n of LB){const r=e[n];if(!r)continue;const i=kY(n,t);r.setWithExplicit("range",i)}}(t):NY(t,"range")}function NY(t,e){const n=t.component.scales;for(const r of t.children)"range"===e?AY(r):EY(r,e);for(const r of Kz(n)){let i;for(const n of t.children){const t=n.component.scales[r];t&&(i=MH(i,t.getWithExplicit(e),e,"scale",RH((t,n)=>{switch(e){case"range":return t.step&&n.step?t.step-n.step:0}return 0})))}n[r].setWithExplicit(e,i)}}const TY=RH((t,e)=>uV(t)-uV(e));class DY{constructor(){this.nameMap={}}rename(t,e){this.nameMap[t]=e}has(t){return void 0!==this.nameMap[t]}get(t){for(;this.nameMap[t]&&t!==this.nameMap[t];)t=this.nameMap[t];return t}}function RY(t){return"unit"===(null==t?void 0:t.type)}function IY(t){return"facet"===(null==t?void 0:t.type)}function MY(t){return"concat"===(null==t?void 0:t.type)}function FY(t){return"layer"===(null==t?void 0:t.type)}class PY{constructor(t,e,n,r,i,o,a){var s,u;this.type=e,this.parent=n,this.config=i,this.view=a,this.children=[],this.correctDataNames=t=>(t.from&&t.from.data&&(t.from.data=this.lookupDataSource(t.from.data)),t.from&&t.from.facet&&t.from.facet.data&&(t.from.facet.data=this.lookupDataSource(t.from.facet.data)),t),this.parent=n,this.config=i,this.name=null!==(s=t.name)&&void 0!==s?s:r,this.title=WW(t.title)?{text:t.title}:t.title,this.scaleNameMap=n?n.scaleNameMap:new DY,this.projectionNameMap=n?n.projectionNameMap:new DY,this.signalNameMap=n?n.signalNameMap:new DY,this.data=t.data,this.description=t.description,this.transforms=(null!==(u=t.transform)&&void 0!==u?u:[]).map(t=>WH(t)?{filter:Rz(t.filter,Y$)}:t),this.layout="layer"===e||"unit"===e?{}:function(t,e,n){var r,i;const o=n[e],a={},{spacing:s,columns:u}=o;void 0!==s&&(a.spacing=s),void 0!==u&&(nW(t)&&!tW(t.facet)||Pq(t))&&(a.columns=u),jq(t)&&(a.columns=1);for(const l of Uq)if(void 0!==t[l])if("spacing"===l){const e=t[l];a[l]=ge(e)?e:{row:null!==(r=e.row)&&void 0!==r?r:s,column:null!==(i=e.column)&&void 0!==i?i:s}}else a[l]=t[l];return a}(t,e,i),this.component={data:{sources:n?n.component.data.sources:[],outputNodes:n?n.component.data.outputNodes:{},outputNodeRefCounts:n?n.component.data.outputNodeRefCounts:{},isFaceted:nW(t)||n&&n.component.data.isFaceted&&void 0===t.data},layoutSize:new NH,layoutHeaders:{row:{},column:{},facet:{}},mark:null,resolve:Object.assign({scale:{},axis:{},legend:{}},o?Mz(o):{}),selection:null,scales:null,projection:null,axes:{},legends:{}}}get width(){return this.getSizeSignalRef("width")}get height(){return this.getSizeSignalRef("height")}parse(){this.parseScale(),this.parseLayoutSize(),this.renameTopLevelLayoutSizeSignal(),this.parseSelections(),this.parseProjection(),this.parseData(),this.parseAxesAndHeaders(),this.parseLegends(),this.parseMarkGroup()}parseScale(){!function(t,{ignoreRange:e}={}){(function t(e){e.component.scales=RY(e)?function(t){const{encoding:e,mark:n}=t;return LB.reduce((r,i)=>{const o=IW(e[i]);if(o&&n===ML&&i===sB&&o.type===nV)return r;let a=o&&o.scale;if(o&&null!==a&&!1!==a){a=null!=a?a:{};const e=function(t,e,n,r){const i=function(t,e,n){var r;switch(e.type){case"nominal":case"ordinal":if(pB(t)||"discrete"===VB(t))return"shape"===t&&"ordinal"===e.type&&y$(y.discreteChannelCannotEncode(t,"ordinal")),"ordinal";if(t in TB){if(Bz(["rect","bar","image","rule"],n))return"band"}else if("arc"===n&&t in IB)return"band";return void 0!==e.band||bW(e)&&(null===(r=e.axis)||void 0===r?void 0:r.tickBand)?"band":"point";case"temporal":return pB(t)?"time":"discrete"===VB(t)?(y$(y.discreteChannelCannotEncode(t,"temporal")),"ordinal"):cW(e)&&e.timeUnit&&R$(e.timeUnit).utc?"utc":"time";case"quantitative":return pB(t)?cW(e)&&qB(e.bin)?"bin-ordinal":"linear":"discrete"===VB(t)?(y$(y.discreteChannelCannotEncode(t,"quantitative")),"ordinal"):"linear";case"geojson":return}throw new Error(y.invalidFieldType(e.type))}(e,n,r),{type:o}=t;return BB(e)?void 0!==o?OV(e,o)?cW(n)&&!EV(o,n.type)?(y$(y.scaleTypeNotWorkWithFieldDef(o,i)),i):o:(y$(y.scaleTypeNotWorkWithChannel(e,o,i)),i):i:null}(a,i,o,n);r[i]=new wY(t.scaleName(i+"",!0),{value:e,explicit:a.type===e})}return r},{})}(e):function(e){var n;const r=e.component.scales={},i={},o=e.component.resolve;for(const a of e.children){t(a);for(const t of Kz(a.component.scales))if(o.scale[t]=null!==(n=o.scale[t])&&void 0!==n?n:iK(t,e),"shared"===o.scale[t]){const e=i[t],n=a.component.scales[t].getWithExplicit("type");e?aV(e.value,n.value)?i[t]=MH(e,n,"type","scale",TY):(o.scale[t]="independent",delete i[t]):i[t]=n}}for(const t of Kz(i)){const n=e.scaleName(t,!0);r[t]=new wY(n,i[t]);for(const r of e.children){const e=r.component.scales[t];e&&(r.renameScale(e.get("name"),n),e.merged=!0)}}return r}(e)})(t),function t(e){RY(e)?function(t){const e=t.component.scales;for(const n of Kz(e)){const r=cY(t,n);if(e[n].setWithExplicit("domains",r),pY(t,n),t.component.data.isFaceted){let e=t;for(;!IY(e)&&e.parent;)e=e.parent;if("shared"===e.component.resolve.scale[n])for(const t of r.value)F$(t)&&(t.data=iY+t.data.replace(iY,""))}}}(e):function(e){for(const r of e.children)t(r);const n=e.component.scales;for(const t of Kz(n)){let r,i=null;for(const n of e.children){const e=n.component.scales[t];if(e){r=void 0===r?e.getWithExplicit("domains"):MH(r,e.getWithExplicit("domains"),"domains","scale",gY);const t=e.get("selectionExtent");i&&t&&i.selection!==t.selection&&y$("The same selection must be used to override scale domains in a layered view."),i=t}}n[t].setWithExplicit("domains",r),i&&n[t].set("selectionExtent",i,!0)}}(e)}(t);for(const n of CV)EY(t,n);e||AY(t)}(this)}parseProjection(){!function t(e){e.component.projection=RY(e)?function(t){var e;if(t.hasProjection){const n=t.specifiedProjection,r=!(n&&(null!=n.scale||null!=n.translate)),i=r?[t.getSizeSignalRef("width"),t.getSizeSignalRef("height")]:void 0,o=r?function(t){const e=[],{encoding:n}=t;for(const r of[["longitude","latitude"],["longitude2","latitude2"]])(IW(n[r[0]])||IW(n[r[1]]))&&e.push({signal:t.getName("geojson_"+e.length)});return t.channelHasField(sB)&&t.typedFieldDef(sB).type===nV&&e.push({signal:t.getName("geojson_"+e.length)}),0===e.length&&e.push(t.requestDataName(VH)),e}(t):void 0;return new kK(t.projectionName(!0),Object.assign(Object.assign({},null!==(e=t.config.projection)&&void 0!==e?e:{}),null!=n?n:{}),i,o)}}(e):function(e){if(0===e.children.length)return;let n;for(const i of e.children)t(i);const r=$z(e.children,t=>{const e=t.component.projection;if(e){if(n){const t=function(t,e){const n=$z(CK,n=>!ue(t.explicit,n)&&!ue(e.explicit,n)||!(!ue(t.explicit,n)||!ue(e.explicit,n)||jz(t.get(n))!==jz(e.get(n))));if(jz(t.size)===jz(e.size)){if(n)return t;if(jz(t.explicit)===jz({}))return e;if(jz(e.explicit)===jz({}))return t}return null}(n,e);return t&&(n=t),!!t}return n=e,!0}return!0});if(n&&r){const t=e.projectionName(!0),r=new kK(t,n.specifiedProjection,n.size,Mz(n.data));for(const n of e.children){const e=n.component.projection;e&&(e.isFit&&r.data.push(...n.component.projection.data),n.renameProjection(e.get("name"),t),e.merged=!0)}return r}}(e)}(this)}renameTopLevelLayoutSizeSignal(){"width"!==this.getName("width")&&this.renameSignal(this.getName("width"),"width"),"height"!==this.getName("height")&&this.renameSignal(this.getName("height"),"height")}parseLegends(){!function t(e){const n=RY(e)?function(t){const{encoding:e}=t,n={};for(const r of[iB,...Tq]){const i=IW(e[r]);i&&t.getScaleComponent(r)&&(r===sB&&cW(i)&&i.type===nV||(n[r]=vK(t,r)))}return n}(e):function(e){const{legends:n,resolve:r}=e.component;for(const i of e.children){t(i);for(const t of Kz(i.component.legends))r.legend[t]=oK(e.component.resolve,t),"shared"===r.legend[t]&&(n[t]=bK(n[t],i.component.legends[t]),n[t]||(r.legend[t]="independent",delete n[t]))}for(const t of Kz(n))for(const n of e.children)n.component.legends[t]&&"shared"===r.legend[t]&&delete n.component.legends[t];return n}(e);return e.component.legends=n,n}(this)}assembleGroupStyle(){var t,e;if("unit"===this.type||"layer"===this.type)return null!==(e=null===(t=this.view)||void 0===t?void 0:t.style)&&void 0!==e?e:"cell"}assembleEncodeFromView(t){const e=Object(x.b)(t,["style"]),n={};for(const r of Kz(e)){const t=e[r];void 0!==t&&(n[r]=qW(t))}return n}assembleGroupEncodeEntry(t){let e={};return this.view&&(e=this.assembleEncodeFromView(this.view)),t||(this.description&&(e.description=qW(this.description)),"unit"!==this.type&&"layer"!==this.type)?Xz(e)?void 0:e:Object.assign({width:this.getSizeSignalRef("width"),height:this.getSizeSignalRef("height")},null!=e?e:{})}assembleLayout(){if(!this.layout)return;const t=this.layout,{spacing:e}=t,n=Object(x.b)(t,["spacing"]),{component:r,config:i}=this,o=function(t,e){const n={};for(const r of gB){const i=t[r];if(null==i?void 0:i.facetFieldDef){const{titleAnchor:t,titleOrient:o}=LX(["titleAnchor","titleOrient"],i.facetFieldDef,e,r),a=jX(r,o),s=YX(t,a);void 0!==s&&(n[a]=s)}}return Xz(n)?void 0:n}(r.layoutHeaders,i);return Object.assign(Object.assign(Object.assign({padding:e},this.assembleDefaultLayout()),n),o?{titleBand:o}:{})}assembleDefaultLayout(){return{}}assembleHeaderMarks(){const{layoutHeaders:t}=this.component;let e=[];for(const n of gB)t[n].title&&e.push($X(this,n));for(const n of BX)e=e.concat(qX(this,n));return e}assembleAxes(){return function(t,e){const{x:n=[],y:r=[]}=t;return[...n.map(t=>xX(t,"grid",e)),...r.map(t=>xX(t,"grid",e)),...n.map(t=>xX(t,"main",e)),...r.map(t=>xX(t,"main",e))].filter(t=>t)}(this.component.axes,this.config)}assembleLegends(){return xK(this)}assembleProjections(){return FY(this)||MY(this)?function(t){return t.children.reduce((t,e)=>t.concat(e.assembleProjections()),_K(t))}(this):_K(this)}assembleTitle(){var t,e,n;const r=null!==(t=this.title)&&void 0!==t?t:{},{encoding:i}=r,o=Object(x.b)(r,["encoding"]),a=Object.assign(Object.assign(Object.assign({},VW(this.config.title).nonMark),o),i?{encode:{update:i}}:{});if(a.text)return Bz(["unit","layer"],this.type)?Bz(["middle",void 0],a.anchor)&&(a.frame=null!==(e=a.frame)&&void 0!==e?e:"group"):a.anchor=null!==(n=a.anchor)&&void 0!==n?n:"start",Xz(a)?void 0:a}assembleGroup(t=[]){const e={};(t=t.concat(this.assembleSignals())).length>0&&(e.signals=t);const n=this.assembleLayout();n&&(e.layout=n),e.marks=[].concat(this.assembleHeaderMarks(),this.assembleMarks());const r=!this.parent||IY(this.parent)?function t(e){return FY(e)||MY(e)?e.children.reduce((e,n)=>e.concat(t(n)),bY(e)):bY(e)}(this):[];r.length>0&&(e.scales=r);const i=this.assembleAxes();i.length>0&&(e.axes=i);const o=this.assembleLegends();return o.length>0&&(e.legends=o),e}getName(t){return Jz((this.name?this.name+"_":"")+t)}requestDataName(t){var e;const n=this.getName(t),r=this.component.data.outputNodeRefCounts;return r[n]=(null!==(e=r[n])&&void 0!==e?e:0)+1,n}getSizeSignalRef(t){if(IY(this.parent)){const e=FB(nK(t)),n=this.component.scales[e];if(n&&!n.merged){const t=n.get("type"),r=n.get("range");if(gV(t)&&M$(r)){const t=n.get("name"),r=yY(vY(this,e));return r?{signal:eK(t,n,_W({aggregate:"distinct",field:r},{expr:"datum"}))}:(y$(`Unknown field for ${e}. Cannot calculate view size.`),null)}}}return{signal:this.signalNameMap.get(this.getName(t))}}lookupDataSource(t){const e=this.component.data.outputNodes[t];return e?e.getSource():t}getSignalName(t){return this.signalNameMap.get(t)}renameSignal(t,e){this.signalNameMap.rename(t,e)}renameScale(t,e){this.scaleNameMap.rename(t,e)}renameProjection(t,e){this.projectionNameMap.rename(t,e)}scaleName(t,e){return e?this.getName(t):xB(t)&&BB(t)&&this.component.scales[t]||this.scaleNameMap.has(this.getName(t))?this.scaleNameMap.get(this.getName(t)):void 0}projectionName(t){return t?this.getName("projection"):this.component.projection&&!this.component.projection.merged||this.projectionNameMap.has(this.getName("projection"))?this.projectionNameMap.get(this.getName("projection")):void 0}getScaleComponent(t){if(!this.component.scales)throw new Error("getScaleComponent cannot be called before parseScale(). Make sure you have called parseScale or use parseUnitModelWithScale().");const e=this.component.scales[t];return e&&!e.merged?e:this.parent?this.parent.getScaleComponent(t):void 0}getSelectionComponent(t,e){let n=this.component.selection[t];if(!n&&this.parent&&(n=this.parent.getSelectionComponent(t,e)),!n)throw new Error(y.selectionNotFound(e));return n}hasAxisOrientSignalRef(){var t,e;return(null===(t=this.component.axes.x)||void 0===t?void 0:t.some(t=>t.hasOrientSignalRef()))||(null===(e=this.component.axes.y)||void 0===e?void 0:e.some(t=>t.hasOrientSignalRef()))}}class jY extends PY{vgField(t,e={}){const n=this.fieldDef(t);if(n)return _W(n,e)}reduceFieldDef(t,e){return uq(this.getMapping(),(e,n,r)=>{const i=RW(n);return i?t(e,i,r):e},e)}forEachFieldDef(t,e){sq(this.getMapping(),(e,n)=>{const r=RW(e);r&&t(r,n)},e)}}class zY extends FG{constructor(t,e){var n,r,i;super(t),this.transform=e,this.transform=Mz(e);const o=null!==(n=this.transform.as)&&void 0!==n?n:[void 0,void 0];this.transform.as=[null!==(r=o[0])&&void 0!==r?r:"value",null!==(i=o[1])&&void 0!==i?i:"density"]}clone(){return new zY(null,Mz(this.transform))}dependentFields(){var t;return new Set([this.transform.density,...null!==(t=this.transform.groupby)&&void 0!==t?t:[]])}producedFields(){return new Set(this.transform.as)}hash(){return"DensityTransform "+zz(this.transform)}assemble(){const t=this.transform,{density:e}=t,n=Object(x.b)(t,["density"]);return Object.assign({type:"kde",field:e},n)}}class LY extends FG{constructor(t,e){super(t),this.filter=e}clone(){return new LY(null,Object.assign({},this.filter))}static make(t,e){const{config:n,mark:r,markDef:i}=e;if("filter"!==KW("invalid",i,n))return null;const o=e.reduceFieldDef((t,n,i)=>{const o=BB(i)&&e.getScaleComponent(i);return o&&yV(o.get("type"))&&"count"!==n.aggregate&&!FL(r)&&(t[n.field]=n),t},{});return Kz(o).length?new LY(t,o):null}dependentFields(){return new Set(Kz(this.filter))}producedFields(){return new Set}hash(){return"FilterInvalid "+zz(this.filter)}assemble(){const t=Kz(this.filter).reduce((t,e)=>{const n=this.filter[e],r=_W(n,{expr:"datum"});return null!==n&&("temporal"===n.type?t.push(`(isDate(${r}) || (isValid(${r}) && isFinite(+${r})))`):"quantitative"===n.type&&(t.push(`isValid(${r})`),t.push(`isFinite(+${r})`))),t},[]);return t.length>0?{type:"filter",expr:t.join(" && ")}:null}}class BY extends FG{constructor(t,e){super(t),this.transform=e,this.transform=Mz(e);const{flatten:n,as:r=[]}=this.transform;this.transform.as=n.map((t,e)=>{var n;return null!==(n=r[e])&&void 0!==n?n:t})}clone(){return new BY(this.parent,Mz(this.transform))}dependentFields(){return new Set(this.transform.flatten)}producedFields(){return new Set(this.transform.as)}hash(){return"FlattenTransform "+zz(this.transform)}assemble(){const{flatten:t,as:e}=this.transform;return{type:"flatten",fields:t,as:e}}}class UY extends FG{constructor(t,e){var n,r,i;super(t),this.transform=e,this.transform=Mz(e);const o=null!==(n=this.transform.as)&&void 0!==n?n:[void 0,void 0];this.transform.as=[null!==(r=o[0])&&void 0!==r?r:"key",null!==(i=o[1])&&void 0!==i?i:"value"]}clone(){return new UY(null,Mz(this.transform))}dependentFields(){return new Set(this.transform.fold)}producedFields(){return new Set(this.transform.as)}hash(){return"FoldTransform "+zz(this.transform)}assemble(){const{fold:t,as:e}=this.transform;return{type:"fold",fields:t,as:e}}}class $Y extends FG{constructor(t,e,n,r){super(t),this.fields=e,this.geojson=n,this.signal=r}clone(){return new $Y(null,Mz(this.fields),this.geojson,this.signal)}static parseAll(t,e){if(e.component.projection&&!e.component.projection.isFit)return t;let n=0;for(const r of[["longitude","latitude"],["longitude2","latitude2"]]){const i=r.map(t=>{const n=IW(e.encoding[t]);return cW(n)?n.field:dW(n)?{expr:""+n.datum}:yW(n)?{expr:""+n.value}:void 0});(i[0]||i[1])&&(t=new $Y(t,i,null,e.getName("geojson_"+n++)))}if(e.channelHasField(sB)){const r=e.typedFieldDef(sB);r.type===nV&&(t=new $Y(t,null,r.field,e.getName("geojson_"+n++)))}return t}dependentFields(){var t;const e=(null!==(t=this.fields)&&void 0!==t?t:[]).filter(ve);return new Set([...this.geojson?[this.geojson]:[],...e])}producedFields(){return new Set}hash(){return`GeoJSON ${this.geojson} ${this.signal} ${zz(this.fields)}`}assemble(){return Object.assign(Object.assign(Object.assign({type:"geojson"},this.fields?{fields:this.fields}:{}),this.geojson?{geojson:this.geojson}:{}),{signal:this.signal})}}class VY extends FG{constructor(t,e,n,r){super(t),this.projection=e,this.fields=n,this.as=r}clone(){return new VY(null,this.projection,Mz(this.fields),Mz(this.as))}static parseAll(t,e){if(!e.projectionName())return t;for(const n of[["longitude","latitude"],["longitude2","latitude2"]]){const r=n.map(t=>{const n=IW(e.encoding[t]);return cW(n)?n.field:dW(n)?{expr:""+n.datum}:yW(n)?{expr:""+n.value}:void 0}),i="longitude2"===n[0]?"2":"";(r[0]||r[1])&&(t=new VY(t,e.projectionName(),r,[e.getName("x"+i),e.getName("y"+i)]))}return t}dependentFields(){return new Set(this.fields.filter(ve))}producedFields(){return new Set(this.as)}hash(){return`Geopoint ${this.projection} ${zz(this.fields)} ${zz(this.as)}`}assemble(){return{type:"geopoint",projection:this.projection,fields:this.fields,as:this.as}}}class WY extends FG{constructor(t,e){super(t),this.transform=e}clone(){return new WY(null,Mz(this.transform))}dependentFields(){var t;return new Set([this.transform.impute,this.transform.key,...null!==(t=this.transform.groupby)&&void 0!==t?t:[]])}producedFields(){return new Set([this.transform.impute])}processSequence(t){const{start:e=0,stop:n,step:r}=t;return{signal:`sequence(${[e,n,...r?[r]:[]].join(",")})`}}static makeFromTransform(t,e){return new WY(t,e)}static makeFromEncoding(t,e){const n=e.encoding,r=n.x,i=n.y;if(cW(r)&&cW(i)){const o=r.impute?r:i.impute?i:void 0;if(void 0===o)return;const a=r.impute?i:i.impute?r:void 0,{method:s,value:u,frame:l,keyvals:c}=o.impute,h=lq(e.mark,n);return new WY(t,Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({impute:o.field,key:a.field},s?{method:s}:{}),void 0!==u?{value:u}:{}),l?{frame:l}:{}),void 0!==c?{keyvals:c}:{}),h.length?{groupby:h}:{}))}return null}hash(){return"Impute "+zz(this.transform)}assemble(){const{impute:t,key:e,keyvals:n,method:r,groupby:i,value:o,frame:a=[null,null]}=this.transform,s=Object.assign(Object.assign(Object.assign(Object.assign({type:"impute",field:t,key:e},n?{keyvals:(u=n,void 0!==(null==u?void 0:u.stop)?this.processSequence(n):n)}:{}),{method:"value"}),i?{groupby:i}:{}),{value:r&&"value"!==r?null:o});var u;return r&&"value"!==r?[s,Object.assign({type:"window",as:[`imputed_${t}_value`],ops:[r],fields:[t],frame:a,ignorePeers:!1},i?{groupby:i}:{}),{type:"formula",expr:`datum.${t} === null ? datum.imputed_${t}_value : datum.${t}`,as:t}]:[s]}}class qY extends FG{constructor(t,e){var n,r,i;super(t),this.transform=e,this.transform=Mz(e);const o=null!==(n=this.transform.as)&&void 0!==n?n:[void 0,void 0];this.transform.as=[null!==(r=o[0])&&void 0!==r?r:e.on,null!==(i=o[1])&&void 0!==i?i:e.loess]}clone(){return new qY(null,Mz(this.transform))}dependentFields(){var t;return new Set([this.transform.loess,this.transform.on,...null!==(t=this.transform.groupby)&&void 0!==t?t:[]])}producedFields(){return new Set(this.transform.as)}hash(){return"LoessTransform "+zz(this.transform)}assemble(){const t=this.transform,{loess:e,on:n}=t,r=Object(x.b)(t,["loess","on"]);return Object.assign({type:"loess",x:n,y:e},r)}}class HY extends FG{constructor(t,e,n){super(t),this.transform=e,this.secondary=n}clone(){return new HY(null,Mz(this.transform),this.secondary)}static make(t,e,n,r){const i=e.component.data.sources,{from:o}=n;let a=null;if(function(t){return"data"in t}(o)){let t=aZ(o.data,i);t||(t=new NK(o.data),i.push(t));const n=e.getName("lookup_"+r);a=new PG(t,n,"lookup",e.component.data.outputNodeRefCounts),e.component.data.outputNodes[n]=a}else if(function(t){return"selection"in t}(o)){const t=o.selection;if(n=Object.assign({as:t},n),a=e.getSelectionComponent(Jz(t),t).materialized,!a)throw new Error(y.noSameUnitLookup(t))}return new HY(t,n,a.getSource())}dependentFields(){return new Set([this.transform.lookup])}producedFields(){return new Set(this.transform.as?Xt(this.transform.as):this.transform.from.fields)}hash(){return"Lookup "+zz({transform:this.transform,secondary:this.secondary})}assemble(){let t;if(this.transform.from.fields)t=Object.assign({values:this.transform.from.fields},this.transform.as?{as:Xt(this.transform.as)}:{});else{let e=this.transform.as;ve(e)||(y$(y.NO_FIELDS_NEEDS_AS),e="_lookup"),t={as:[e]}}return Object.assign(Object.assign({type:"lookup",from:this.secondary,key:this.transform.from.key,fields:[this.transform.lookup]},t),this.transform.default?{default:this.transform.default}:{})}}class GY extends FG{constructor(t,e){var n,r,i;super(t),this.transform=e,this.transform=Mz(e);const o=null!==(n=this.transform.as)&&void 0!==n?n:[void 0,void 0];this.transform.as=[null!==(r=o[0])&&void 0!==r?r:"prob",null!==(i=o[1])&&void 0!==i?i:"value"]}clone(){return new GY(null,Mz(this.transform))}dependentFields(){var t;return new Set([this.transform.quantile,...null!==(t=this.transform.groupby)&&void 0!==t?t:[]])}producedFields(){return new Set(this.transform.as)}hash(){return"QuantileTransform "+zz(this.transform)}assemble(){const t=this.transform,{quantile:e}=t,n=Object(x.b)(t,["quantile"]);return Object.assign({type:"quantile",field:e},n)}}class XY extends FG{constructor(t,e){var n,r,i;super(t),this.transform=e,this.transform=Mz(e);const o=null!==(n=this.transform.as)&&void 0!==n?n:[void 0,void 0];this.transform.as=[null!==(r=o[0])&&void 0!==r?r:e.on,null!==(i=o[1])&&void 0!==i?i:e.regression]}clone(){return new XY(null,Mz(this.transform))}dependentFields(){var t;return new Set([this.transform.regression,this.transform.on,...null!==(t=this.transform.groupby)&&void 0!==t?t:[]])}producedFields(){return new Set(this.transform.as)}hash(){return"RegressionTransform "+zz(this.transform)}assemble(){const t=this.transform,{regression:e,on:n}=t,r=Object(x.b)(t,["regression","on"]);return Object.assign({type:"regression",x:n,y:e},r)}}class KY extends FG{constructor(t,e){super(t),this.transform=e}clone(){return new KY(null,Mz(this.transform))}addDimensions(t){var e;this.transform.groupby=Wz((null!==(e=this.transform.groupby)&&void 0!==e?e:[]).concat(t),t=>t)}producedFields(){}dependentFields(){var t;return new Set([this.transform.pivot,this.transform.value,...null!==(t=this.transform.groupby)&&void 0!==t?t:[]])}hash(){return"PivotTransform "+zz(this.transform)}assemble(){const{pivot:t,value:e,groupby:n,limit:r,op:i}=this.transform;return Object.assign(Object.assign(Object.assign({type:"pivot",field:t,value:e},void 0!==r?{limit:r}:{}),void 0!==i?{op:i}:{}),void 0!==n?{groupby:n}:{})}}class YY extends FG{constructor(t,e){super(t),this.transform=e}clone(){return new YY(null,Mz(this.transform))}dependentFields(){return new Set}producedFields(){return new Set}hash(){return"SampleTransform "+zz(this.transform)}assemble(){return{type:"sample",size:this.transform.sample}}}function ZY(t){let e=0;return function n(r,i){var o;if(r instanceof NK&&!r.isGenerator&&!PH(r.data)&&(t.push(i),i={name:null,source:i.name,transform:[]}),r instanceof UK&&(r.parent instanceof NK&&!i.source?(i.format=Object.assign(Object.assign({},null!==(o=i.format)&&void 0!==o?o:{}),{parse:r.assembleFormatParse()}),i.transform.push(...r.assembleTransforms(!0))):i.transform.push(...r.assembleTransforms())),r instanceof zK){i.name||(i.name="data_"+e++),!i.source||i.transform.length>0?(t.push(i),r.data=i.name):r.data=i.source;for(const e of r.assemble())t.push(e)}else switch((r instanceof DK||r instanceof RK||r instanceof LY||r instanceof gX||r instanceof FX||r instanceof VY||r instanceof $Y||r instanceof jK||r instanceof HY||r instanceof qK||r instanceof VK||r instanceof UY||r instanceof BY||r instanceof zY||r instanceof qY||r instanceof GY||r instanceof XY||r instanceof $K||r instanceof YY||r instanceof KY)&&i.transform.push(r.assemble()),(r instanceof AK||r instanceof jG||r instanceof WY||r instanceof WK)&&i.transform.push(...r.assemble()),r instanceof PG&&(i.source&&0===i.transform.length?r.setSource(i.source):r.parent instanceof PG?r.setSource(i.name):(i.name||(i.name="data_"+e++),r.setSource(i.name),1===r.numChildren()&&(t.push(i),i={name:null,source:i.name,transform:[]}))),r.numChildren()){case 0:r instanceof PG&&(!i.source||i.transform.length>0)&&t.push(i);break;case 1:n(r.children[0],i);break;default:{i.name||(i.name="data_"+e++);let o=i.name;!i.source||i.transform.length>0?t.push(i):o=i.source;for(const t of r.children)n(t,{name:null,source:o,transform:[]});break}}}}function QY(t,e){var n;const{facet:r,config:i,child:o,component:a}=t;if(t.channelHasField(e)){const s=r[e],u=zX("title",null,i,e);let l=AW(s,i,{allowDisabling:!0,includeDefault:void 0===u||!!u});o.component.layoutHeaders[e].title&&(l=Ct(l)?l.join(", "):l,l+=" / "+o.component.layoutHeaders[e].title,o.component.layoutHeaders[e].title=null);const c=zX("labelOrient",s,i,e),h=lL((null!==(n=s.header)&&void 0!==n?n:{}).labels,i.header.labels,!0),d=Bz(["bottom","right"],c)?"footer":"header";a.layoutHeaders[e]={title:l,facetFieldDef:s,[d]:"facet"===e?[]:[JY(t,e,h)]}}}function JY(t,e,n){const r="row"===e?"height":"width";return{labels:n,sizeSignal:t.child.component.layoutSize.get(r)?t.child.getSizeSignalRef(r):void 0,axes:[]}}function tZ(t,e){var n;const{child:r}=t;if(r.component.axes[e]){const{layoutHeaders:o,resolve:a}=t.component;if(a.axis[e]=oK(a,e),"shared"===a.axis[e]){const a="x"===e?"column":"row",s=o[a];for(const o of r.component.axes[e]){const e="top"===(i=o.get("orient"))||"left"===i||I$(i)?"header":"footer";s[e]=null!==(n=s[e])&&void 0!==n?n:[JY(t,a,!1)];const r=xX(o,"main",t.config,{header:!0});r&&s[e][0].axes.push(r),o.mainExtracted=!0}}}var i}function eZ(t){for(const e of t.children)e.parseLayoutSize()}function nZ(t,e){const n=nK(e),r=FB(n),i=t.component.resolve,o=t.component.layoutSize;let a;for(const s of t.children){const t=s.component.layoutSize.getWithExplicit(n),e=i.scale[r];if("independent"===e&&"step"===t.value){a=void 0;break}if(a){if("independent"===e&&a.value!==t.value){a=void 0;break}a=MH(a,t,n,"")}else a=t}if(a){for(const r of t.children)t.renameSignal(r.getName(n),t.getName(e)),r.component.layoutSize.set(n,"merged",!1);o.setWithExplicit(e,a)}else o.setWithExplicit(e,{explicit:!1,value:void 0})}function rZ(t,e){const n=t.config,r=t.getScaleComponent("width"===e?"x":"y");if(r){const t=r.get("type"),i=r.get("range");if(gV(t)){const t=Wq(n.view,e);return M$(i)||Lq(t)?"step":t}return $q(n.view,e)}if(t.hasProjection||"arc"===t.mark)return $q(n.view,e);{const t=Wq(n.view,e);return Lq(t)?t.step:t}}function iZ(t,e,n){return _W(e,Object.assign({suffix:"by_"+_W(t)},null!=n?n:{}))}class oZ extends jY{constructor(t,e,n,r){super(t,"facet",e,n,r,t.resolve),this.child=kZ(t.spec,this,this.getName("child"),void 0,r),this.children=[this.child],this.facet=this.initFacet(t.facet,r)}initFacet(t,e){return tW(t)?uq(t,(t,n,r)=>Bz([JL,tB],r)?void 0===n.field?(y$(y.emptyFieldDef(n,r)),t):(t[r]=MW(n,r,e),t):(y$(y.incompatibleChannel(r,"facet")),t),{}):{facet:MW(t,"facet",e)}}channelHasField(t){return!!this.facet[t]}fieldDef(t){return this.facet[t]}parseData(){this.component.data=sZ(this),this.child.parseData()}parseLayoutSize(){eZ(this)}parseSelections(){this.child.parseSelections(),this.component.selection=this.child.component.selection}parseMarkGroup(){this.child.parseMarkGroup()}parseAxesAndHeaders(){this.child.parseAxesAndHeaders(),function(t){for(const e of gB)QY(t,e);tZ(t,"x"),tZ(t,"y")}(this)}assembleSelectionTopLevelSignals(t){return this.child.assembleSelectionTopLevelSignals(t)}assembleSignals(){return this.child.assembleSignals(),[]}assembleSelectionData(t){return this.child.assembleSelectionData(t)}getHeaderLayoutMixins(){var t,e,n;const r={};for(const i of gB)for(const o of UX){const a=this.component.layoutHeaders[i],s=a[o],{facetFieldDef:u}=a;if(u){const e=zX("titleOrient",u,this.config,i);if(Bz(["right","bottom"],e)){const n=jX(i,e);r.titleAnchor=null!==(t=r.titleAnchor)&&void 0!==t?t:{},r.titleAnchor[n]="end"}}if(null==s?void 0:s[0]){const t="row"===i?"height":"width",s="header"===o?"headerBand":"footerBand";"facet"===i||this.child.component.layoutSize.get(t)||(r[s]=null!==(e=r[s])&&void 0!==e?e:{},r[s][i]=.5),a.title&&(r.offset=null!==(n=r.offset)&&void 0!==n?n:{},r.offset["row"===i?"rowTitle":"columnTitle"]=10)}}return r}assembleDefaultLayout(){const{column:t,row:e}=this.facet,n=t?this.columnDistinctSignal():e?1:void 0;let r="all";return(e||"independent"!==this.component.resolve.scale.x)&&(t||"independent"!==this.component.resolve.scale.y)||(r="none"),Object.assign(Object.assign(Object.assign({},this.getHeaderLayoutMixins()),n?{columns:n}:{}),{bounds:"full",align:r})}assembleLayoutSignals(){return this.child.assembleLayoutSignals()}columnDistinctSignal(){if(!(this.parent&&this.parent instanceof oZ))return{signal:`length(data('${this.getName("column_domain")}'))`}}assembleGroup(t){return this.parent&&this.parent instanceof oZ?Object.assign(Object.assign({},this.channelHasField("column")?{encode:{update:{columns:{field:_W(this.facet.column,{prefix:"distinct"})}}}}:{}),super.assembleGroup(t)):super.assembleGroup(t)}getCardinalityAggregateForChild(){const t=[],e=[],n=[];if(this.child instanceof oZ){if(this.child.channelHasField("column")){const r=_W(this.child.facet.column);t.push(r),e.push("distinct"),n.push("distinct_"+r)}}else for(const r of DB){const i=this.child.component.scales[r];if(i&&!i.merged){const o=i.get("type"),a=i.get("range");if(gV(o)&&M$(a)){const i=yY(vY(this.child,r));i?(t.push(i),e.push("distinct"),n.push("distinct_"+i)):y$(`Unknown field for ${r}. Cannot calculate view size.`)}}}return{fields:t,ops:e,as:n}}assembleFacet(){const{name:t,data:e}=this.component.data.facetRoot,{row:n,column:r}=this.facet,{fields:i,ops:o,as:a}=this.getCardinalityAggregateForChild(),s=[];for(const l of gB){const t=this.facet[l];if(t){s.push(_W(t));const{bin:e,sort:u}=t;if(qB(e)&&s.push(_W(t,{binSuffix:"end"})),QV(u)){const{field:e,op:s=XV}=u,l=iZ(t,u);n&&r?(i.push(l),o.push("max"),a.push(l)):(i.push(e),o.push(s),a.push(l))}else if(Ct(u)){const e=PX(t,l);i.push(e),o.push("max"),a.push(e)}}}const u=!!n&&!!r;return Object.assign({name:t,data:e,groupby:s},u||i.length>0?{aggregate:Object.assign(Object.assign({},u?{cross:u}:{}),i.length?{fields:i,ops:o,as:a}:{})}:{})}facetSortFields(t){const{facet:e}=this,n=e[t];return n?QV(n.sort)?[iZ(n,n.sort,{expr:"datum"})]:Ct(n.sort)?[PX(n,t,{expr:"datum"})]:[_W(n,{expr:"datum"})]:[]}facetSortOrder(t){const{facet:e}=this,n=e[t];if(n){const{sort:t}=n;return[(QV(t)?t.order:!Ct(t)&&t)||"ascending"]}return[]}assembleLabelTitle(){const{facet:t,config:e}=this;if(t.facet)return GX(t.facet,"facet",e);const n={row:["top","bottom"],column:["left","right"]};for(const r of BX)if(t[r]){const i=zX("labelOrient",t[r],e,r);if(Bz(n[r],i))return GX(t[r],r,e)}}assembleMarks(){const{child:t}=this,e=function(t){const e=[],n=ZY(e);for(const r of t.children)n(r,{source:t.name,name:null,transform:[]});return e}(this.component.data.facetRoot),n=t.assembleGroupEncodeEntry(!1),r=this.assembleLabelTitle()||t.assembleTitle(),i=t.assembleGroupStyle();return[Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({name:this.getName("cell"),type:"group"},r?{title:r}:{}),i?{style:i}:{}),{from:{facet:this.assembleFacet()},sort:{field:gB.map(t=>this.facetSortFields(t)).flat(),order:gB.map(t=>this.facetSortOrder(t)).flat()}}),e.length>0?{data:e}:{}),n?{encode:{update:n}}:{}),t.assembleGroup(function(t,e){if(t.component.selection&&Kz(t.component.selection).length){const n=Ee(t.getName("cell"));e.unshift({name:"facet",value:{},on:[{events:ZF("mousemove","scope"),update:`isTuple(facet) ? facet : group(${n}).datum`}]})}return eX(e)}(this,[])))]}getMapping(){return this.facet}}function aZ(t,e){var n,r,i,o,a,s,u,l,c,h;for(const d of e){const e=d.data;if(!(t.name&&d.hasName()&&t.name!==d.dataName||(null===(n=t.format)||void 0===n?void 0:n.mesh)&&(null===(r=e.format)||void 0===r?void 0:r.feature)||((null===(i=t.format)||void 0===i?void 0:i.feature)||(null===(o=e.format)||void 0===o?void 0:o.feature))&&(null===(a=t.format)||void 0===a?void 0:a.feature)!==(null===(s=e.format)||void 0===s?void 0:s.feature)||((null===(u=t.format)||void 0===u?void 0:u.mesh)||(null===(l=e.format)||void 0===l?void 0:l.mesh))&&(null===(c=t.format)||void 0===c?void 0:c.mesh)!==(null===(h=e.format)||void 0===h?void 0:h.mesh)))if(jH(t)&&jH(e)){if(Iz(t.values,e.values))return d}else if(PH(t)&&PH(e)){if(t.url===e.url)return d}else if(zH(t)&&t.name===d.dataName)return d}return null}function sZ(t){var e,n,r,i,o,a,s,u,l,c;let h=function(t,e){if(t.data||!t.parent){if(null===t.data){const t=new NK({values:[]});return e.push(t),t}const n=aZ(t.data,e);if(n)return LH(t.data)||(n.data.format=function(t,...e){for(const n of e)Vz(t,null!=n?n:{});return t}({},t.data.format,n.data.format)),!n.hasName()&&t.data.name&&(n.dataName=t.data.name),n;{const n=new NK(t.data);return e.push(n),n}}return t.parent.component.data.facetRoot?t.parent.component.data.facetRoot:t.parent.component.data.main}(t,t.component.data.sources);const{outputNodes:d,outputNodeRefCounts:f}=t.component.data,p=t.parent?t.parent.component.data.ancestorParse.clone():new FH,m=t.data;LH(m)?(BH(m)?h=new RK(h,m.sequence):$H(m)&&(h=new DK(h,m.graticule)),p.parseNothing=!0):null===(null===(e=null==m?void 0:m.format)||void 0===e?void 0:e.parse)&&(p.parseNothing=!0),h=null!==(n=UK.makeExplicit(h,t,p))&&void 0!==n?n:h,h=new $K(h);const g=t.parent&&FY(t.parent);(RY(t)||IY(t))&&g&&(h=null!==(r=AK.makeFromEncoding(h,t))&&void 0!==r?r:h),t.transforms.length>0&&(h=function(t,e,n){var r,i;let o=0;for(const a of e.transforms){let s,u=void 0;if(eG(a))s=t=new FX(t,a),u="derived";else if(WH(a)){const i=BK(a);s=t=null!==(r=UK.makeWithAncestors(t,{},i,n))&&void 0!==r?r:t,t=new gX(t,e,a.filter)}else if(nG(a))s=t=AK.makeFromTransform(t,a,e),u="number";else if(iG(a))u="date",void 0===n.getWithExplicit(a.field).value&&(t=new UK(t,{[a.field]:u}),n.set(a.field,u,!1)),s=t=jG.makeFromTransform(t,a);else if(oG(a))s=t=jK.makeFromTransform(t,a),u="number",pX(e)&&(t=new $K(t));else if(qH(a))s=t=HY.make(t,e,a,o++),u="derived";else if(QH(a))s=t=new qK(t,a),u="number";else if(JH(a))s=t=new VK(t,a),u="number";else if(aG(a))s=t=WK.makeFromTransform(t,a),u="derived";else if(sG(a))s=t=new UY(t,a),u="derived";else if(tG(a))s=t=new BY(t,a),u="derived";else if(HH(a))s=t=new KY(t,a),u="derived";else if(ZH(a))t=new YY(t,a);else if(rG(a))s=t=WY.makeFromTransform(t,a),u="derived";else if(GH(a))s=t=new zY(t,a),u="derived";else if(XH(a))s=t=new GY(t,a),u="derived";else if(KH(a))s=t=new XY(t,a),u="derived";else{if(!YH(a)){y$(y.invalidTransformIgnored(a));continue}s=t=new qY(t,a),u="derived"}if(s&&void 0!==u)for(const t of null!==(i=s.producedFields())&&void 0!==i?i:[])n.set(t,u,!1)}return t}(h,t,p));const v=function(t){const e={};if(RY(t)&&t.component.selection)for(const n of Kz(t.component.selection)){const r=t.component.selection[n];for(const t of r.project.items)!t.channel&&uL(t.field)>1&&(e[t.field]="flatten")}return e}(t),b=function(t){const e={};function n(t){var n;LW(t)?e[t.field]="date":"quantitative"===t.type&&ve(n=t.aggregate)&&Bz(["min","max"],n)?e[t.field]="number":uL(t.field)>1?t.field in e||(e[t.field]="flatten"):vW(t)&&QV(t.sort)&&uL(t.sort.field)>1&&(t.sort.field in e||(e[t.sort.field]="flatten"))}if((RY(t)||IY(t))&&t.forEachFieldDef((e,r)=>{if(gW(e))n(e);else{const i=kB(r),o=t.fieldDef(i);n(Object.assign(Object.assign({},e),{type:o.type}))}}),RY(t)){const{mark:n,markDef:r,encoding:i}=t;if(FL(n)&&!t.encoding.order){const t=i["horizontal"===r.orient?"y":"x"];cW(t)&&"quantitative"===t.type&&!(t.field in e)&&(e[t.field]="number")}}return e}(t);h=null!==(i=UK.makeWithAncestors(h,{},Object.assign(Object.assign({},v),b),p))&&void 0!==i?i:h,RY(t)&&(h=$Y.parseAll(h,t),h=VY.parseAll(h,t)),(RY(t)||IY(t))&&(g||(h=null!==(o=AK.makeFromEncoding(h,t))&&void 0!==o?o:h),h=null!==(a=jG.makeFromEncoding(h,t))&&void 0!==a?a:h,h=FX.parseAllForSortIndex(h,t));const w=t.getName("raw"),x=new PG(h,w,"raw",f);if(d[w]=x,h=x,RY(t)){const e=jK.makeFromEncoding(h,t);e&&(h=e,pX(t)&&(h=new $K(h))),h=null!==(s=WY.makeFromEncoding(h,t))&&void 0!==s?s:h,h=null!==(u=WK.makeFromEncoding(h,t))&&void 0!==u?u:h}RY(t)&&(h=null!==(l=LY.make(h,t))&&void 0!==l?l:h);const _=t.getName(VH),C=new PG(h,_,VH,f);d[_]=C,h=C,RY(t)&&function(t,e){dX(t,n=>{const r=n.name,i=t.getName("lookup_"+r);t.component.data.outputNodes[i]=n.materialized=new PG(new gX(e,t,{selection:r}),i,"lookup",t.component.data.outputNodeRefCounts)})}(t,C);let k=null;if(IY(t)){const e=t.getName("facet");h=null!==(c=function(t,e){const{row:n,column:r}=e;if(n&&r){let e=null;for(const i of[n,r])if(QV(i.sort)){const{field:n,op:r=XV}=i.sort;t=e=new VK(t,{joinaggregate:[{op:r,field:n,as:iZ(i,i.sort,{forAs:!0})}],groupby:[_W(i)]})}return e}return null}(h,t.facet))&&void 0!==c?c:h,k=new zK(h,t,e,C.getSource()),d[e]=k}return Object.assign(Object.assign({},t.component.data),{outputNodes:d,outputNodeRefCounts:f,raw:x,main:C,facetRoot:k,ancestorParse:p})}class uZ extends PY{constructor(t,e,n,r){var i,o,a,s;super(t,"concat",e,n,r,t.resolve),"shared"!==(null===(o=null===(i=t.resolve)||void 0===i?void 0:i.axis)||void 0===o?void 0:o.x)&&"shared"!==(null===(s=null===(a=t.resolve)||void 0===a?void 0:a.axis)||void 0===s?void 0:s.y)||y$(y.CONCAT_CANNOT_SHARE_AXIS),this.children=this.getChildren(t).map((t,e)=>kZ(t,this,this.getName("concat_"+e),void 0,r))}parseData(){this.component.data=sZ(this);for(const t of this.children)t.parseData()}parseSelections(){this.component.selection={};for(const t of this.children){t.parseSelections();for(const e of Kz(t.component.selection))this.component.selection[e]=t.component.selection[e]}}parseMarkGroup(){for(const t of this.children)t.parseMarkGroup()}parseAxesAndHeaders(){for(const t of this.children)t.parseAxesAndHeaders()}getChildren(t){return jq(t)?t.vconcat:zq(t)?t.hconcat:t.concat}parseLayoutSize(){!function(t){eZ(t);const e=void 0===t.layout.columns?"height":"childHeight";nZ(t,1===t.layout.columns?"width":"childWidth"),nZ(t,e)}(this)}parseAxisGroup(){return null}assembleSelectionTopLevelSignals(t){return this.children.reduce((t,e)=>e.assembleSelectionTopLevelSignals(t),t)}assembleSignals(){return this.children.forEach(t=>t.assembleSignals()),[]}assembleLayoutSignals(){const t=QX(this);for(const e of this.children)t.push(...e.assembleLayoutSignals());return t}assembleSelectionData(t){return this.children.reduce((t,e)=>e.assembleSelectionData(t),t)}assembleMarks(){return this.children.map(t=>{const e=t.assembleTitle(),n=t.assembleGroupStyle(),r=t.assembleGroupEncodeEntry(!1);return Object.assign(Object.assign(Object.assign(Object.assign({type:"group",name:t.getName("group")},e?{title:e}:{}),n?{style:n}:{}),r?{encode:{update:r}}:{}),t.assembleGroup())})}assembleDefaultLayout(){const t=this.layout.columns;return Object.assign(Object.assign({},null!=t?{columns:t}:{}),{bounds:"full",align:"each"})}}const lZ=Object.assign(Object.assign({disable:1,gridScale:1,scale:1},yL),{labelExpr:1,encode:1}),cZ=Kz(lZ);class hZ extends NH{constructor(t={},e={},n=!1){super(),this.explicit=t,this.implicit=e,this.mainExtracted=n}clone(){return new hZ(Mz(this.explicit),Mz(this.implicit),this.mainExtracted)}hasAxisPart(t){return!("axis"!==t&&("grid"===t||"title"===t?!this.get(t):!1===(e=this.get(t))||null===e));var e}hasOrientSignalRef(){return I$(this.explicit.orient)}}const dZ={bottom:"top",top:"bottom",left:"right",right:"left"};function fZ(t,e){if(!t)return e.map(t=>t.clone());{if(t.length!==e.length)return;const n=t.length;for(let r=0;r<n;r++){const n=t[r],i=e[r];if(!!n!=!!i)return;if(n&&i){const e=n.getWithExplicit("orient"),o=i.getWithExplicit("orient");if(e.explicit&&o.explicit&&e.value!==o.value)return;t[r]=pZ(n,i)}}}return t}function pZ(t,e){for(const n of cZ){const r=MH(t.getWithExplicit(n),e.getWithExplicit(n),n,"axis",(t,e)=>{switch(n){case"title":return nq(t,e);case"gridScale":return{explicit:t.explicit,value:lL(t.value,e.value)}}return IH(t,e,n,"axis")});t.setWithExplicit(n,r)}return t}function mZ(t,e,n,r,i){if("disable"===e)return void 0!==n;switch(n=n||{},e){case"titleAngle":case"labelAngle":return t===(I$(n.labelAngle)?n.labelAngle:hL(n.labelAngle));case"values":return!!n.values;case"encode":return!!n.encoding||!!n.labelAngle;case"title":if(t===MX(r,i))return!0}return t===n[e]}const gZ=new Set(["grid","translate","format","formatType","orient","labelExpr","tickCount","position","tickMinStep"]);function yZ(t,e){var n,r,i;let o=e.axis(t);const a=new hZ,s=IW(e.encoding[t]),{mark:u,config:l}=e,c=(null==o?void 0:o.orient)||(null===(n=l["x"===t?"axisX":"axisY"])||void 0===n?void 0:n.orient)||(null===(r=l.axis)||void 0===r?void 0:r.orient)||function(t){return"x"===t?"bottom":"left"}(t),h=e.getScaleComponent(t).get("type"),d=function(t,e,n,r){const i="band"===e?["axisDiscrete","axisBand"]:"point"===e?["axisDiscrete","axisPoint"]:e in hV?["axisQuantitative"]:"time"===e||"utc"===e?["axisTemporal"]:[],o="x"===t?"axisX":"axisY",a=I$(n)?"axisOrient":"axis"+nL(n),s=[...i,...i.map(t=>o+t.substr(4))],u=["axis",a,o];return{vlOnlyAxisConfig:OX(s,r,t,n),vgAxisConfig:OX(u,r,t,n),axisConfigStyle:AX([...u,...s],r)}}(t,h,c,e.config),f=void 0!==o?!o:NX("disable",l,null==o?void 0:o.style,d).configValue;if(a.set("disable",f,void 0!==o),f)return a;o=o||{};const p=function(t,e,n,r,i){const o=null==e?void 0:e.labelAngle;if(void 0!==o)return I$(o)?o:hL(o);{const{configValue:o}=NX("labelAngle",t.config,null==e?void 0:e.style,i);return void 0!==o?hL(o):"x"===n&&Bz([eV,J$],r.type)?270:void 0}}(e,o,t,s,d),m={fieldOrDatumDef:s,axis:o,channel:t,model:e,scaleType:h,orient:c,labelAngle:p,mark:u,config:l};for(const v of cZ){const n=v in TX?TX[v](m):bL(v)?o[v]:void 0,r=void 0!==n,i=mZ(n,v,o,e,t);if(r&&i)a.set(v,n,i);else{const{configValue:t,configFrom:s}=bL(v)&&"values"!==v?NX(v,e.config,o.style,d):{},u=void 0!==t;r&&!u?a.set(v,n,i):("vgAxisConfig"!==s||gZ.has(v)&&u||pL(t)||I$(t))&&a.set(v,t,!1)}}const g=null!==(i=o.encoding)&&void 0!==i?i:{},y=mL.reduce((n,r)=>{var i;if(!a.hasAxisPart(r))return n;const o=rK(null!==(i=g[r])&&void 0!==i?i:{},e),s="labels"===r?function(t,e,n){var r;const{encoding:i,config:o}=t,a=null!==(r=IW(i[e]))&&void 0!==r?r:IW(i[EB(e)]),s=t.axis(e)||{},{format:u,formatType:l}=s;return jV(l)?Object.assign({text:UV({fieldOrDatumDef:a,field:"datum.value",format:u,formatType:l,config:o})},n):n}(e,t,o):o;return void 0===s||Xz(s)||(n[r]={update:s}),n},{});return Xz(y)||a.set("encode",y,!!o.encoding||void 0!==o.labelAngle),a}function vZ(t,e){return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},TG(t,{align:"ignore",baseline:"ignore",color:"include",size:"include",orient:"ignore",theta:"ignore"})),yG("x",t,{defaultPos:"mid"})),yG("y",t,{defaultPos:"mid"})),pG("size",t)),pG("angle",t)),function(t,e,n){return n?{shape:{value:n}}:pG("shape",t)}(t,0,e))}function bZ(t){var e;const{config:n,markDef:r}=t,{orient:i}=r,o="horizontal"===i?"width":"height",a=t.getScaleComponent("horizontal"===i?"x":"y"),s=null!==(e=KW("size",r,n,{vgChannel:o}))&&void 0!==e?e:n.tick.bandSize;if(void 0!==s)return s;{const t=a?a.get("range"):void 0;return t&&M$(t)&&ge(t.step)?3*t.step/4:3*Vq(n.view,o)/4}}const wZ={arc:{vgMark:"arc",encodeEntry:t=>Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},TG(t,{align:"ignore",baseline:"ignore",color:"include",size:"ignore",orient:"ignore",theta:"ignore"})),yG("x",t,{defaultPos:"mid"})),yG("y",t,{defaultPos:"mid"})),SG(t,"radius","arc")),SG(t,"theta","arc"))},area:{vgMark:"area",encodeEntry:t=>Object.assign(Object.assign(Object.assign(Object.assign({},TG(t,{align:"ignore",baseline:"ignore",color:"include",orient:"include",size:"ignore",theta:"ignore"})),_G("x",t,{defaultPos:"zeroOrMin",defaultPos2:"zeroOrMin",range:"horizontal"===t.markDef.orient})),_G("y",t,{defaultPos:"zeroOrMin",defaultPos2:"zeroOrMin",range:"vertical"===t.markDef.orient})),RG(t))},bar:{vgMark:"rect",encodeEntry:t=>Object.assign(Object.assign(Object.assign({},TG(t,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"})),SG(t,"x","bar")),SG(t,"y","bar"))},circle:{vgMark:"symbol",encodeEntry:t=>vZ(t,"circle")},geoshape:{vgMark:"shape",encodeEntry:t=>Object.assign({},TG(t,{align:"ignore",baseline:"ignore",color:"include",size:"ignore",orient:"ignore",theta:"ignore"})),postEncodingTransform:t=>{const{encoding:e}=t,n=e.shape;return[Object.assign({type:"geoshape",projection:t.projectionName()},n&&cW(n)&&n.type===nV?{field:_W(n,{expr:"datum"})}:{})]}},image:{vgMark:"image",encodeEntry:t=>Object.assign(Object.assign(Object.assign(Object.assign({},TG(t,{align:"ignore",baseline:"ignore",color:"ignore",orient:"ignore",size:"ignore",theta:"ignore"})),SG(t,"x","image")),SG(t,"y","image")),lG(t,"url"))},line:{vgMark:"line",encodeEntry:t=>Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},TG(t,{align:"ignore",baseline:"ignore",color:"include",size:"ignore",orient:"ignore",theta:"ignore"})),yG("x",t,{defaultPos:"mid"})),yG("y",t,{defaultPos:"mid"})),pG("size",t,{vgChannel:"strokeWidth"})),RG(t))},point:{vgMark:"symbol",encodeEntry:t=>vZ(t)},rect:{vgMark:"rect",encodeEntry:t=>Object.assign(Object.assign(Object.assign({},TG(t,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"})),SG(t,"x","rect")),SG(t,"y","rect"))},rule:{vgMark:"rule",encodeEntry:t=>{const{markDef:e}=t,n=e.orient;return t.encoding.x||t.encoding.y||t.encoding.latitude||t.encoding.longitude?Object.assign(Object.assign(Object.assign(Object.assign({},TG(t,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"})),_G("x",t,{defaultPos:"horizontal"===n?"zeroOrMax":"mid",defaultPos2:"zeroOrMin",range:"vertical"!==n})),_G("y",t,{defaultPos:"vertical"===n?"zeroOrMax":"mid",defaultPos2:"zeroOrMin",range:"horizontal"!==n})),pG("size",t,{vgChannel:"strokeWidth"})):{}}},square:{vgMark:"symbol",encodeEntry:t=>vZ(t,"square")},text:{vgMark:"text",encodeEntry:t=>{const{config:e}=t;return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},TG(t,{align:"include",baseline:"include",color:"include",size:"ignore",orient:"ignore",theta:"include"})),yG("x",t,{defaultPos:"mid"})),yG("y",t,{defaultPos:"mid"})),lG(t)),pG("size",t,{vgChannel:"fontSize"})),pG("angle",t)),IG("align",function(t,e,n){if(void 0===KW("align",t,n))return"center"}(t.markDef,0,e))),IG("baseline",function(t,e,n){if(void 0===KW("baseline",t,n))return"middle"}(t.markDef,0,e))),yG("radius",t,{defaultPos:null,isMidPoint:!0})),yG("theta",t,{defaultPos:null,isMidPoint:!0}))}},tick:{vgMark:"rect",encodeEntry:t=>{const{config:e,markDef:n}=t,r=n.orient,i="horizontal"===r?"width":"height",o="horizontal"===r?"height":"width";return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},TG(t,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"})),yG("x",t,{defaultPos:"mid",vgChannel:"xc"})),yG("y",t,{defaultPos:"mid",vgChannel:"yc"})),pG("size",t,{defaultValue:bZ(t),vgChannel:i})),{[o]:qW(KW("thickness",n,e))})}},trail:{vgMark:"trail",encodeEntry:t=>Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},TG(t,{align:"ignore",baseline:"ignore",color:"include",size:"include",orient:"ignore",theta:"ignore"})),yG("x",t,{defaultPos:"mid"})),yG("y",t,{defaultPos:"mid"})),pG("size",t)),RG(t))}};function xZ(t,e={fromPrefix:""}){const{mark:n,markDef:r,config:i}=t,o=lL(r.clip,function(t){const e=t.getScaleComponent("x"),n=t.getScaleComponent("y");return!!(e&&e.get("selectionExtent")||n&&n.get("selectionExtent"))||void 0}(t),function(t){const e=t.component.projection;return!(!e||e.isFit)||void 0}(t)),a=XW(r),s=t.encoding.key,u=function(t){const{encoding:e,stack:n,mark:r,markDef:i,config:o}=t,a=e.order;if(!(!Ct(a)&&yW(a)&&Lz(a.value)||!a&&Lz(KW("order",i,o)))){if((Ct(a)||cW(a))&&!n)return JW(a,{expr:"datum"});if(FL(r)){const n="horizontal"===i.orient?"y":"x",r=e[n];if(cW(r)){const e=r.sort;return Ct(e)?{field:_W(r,{prefix:n,suffix:"sort_index",expr:"datum"})}:QV(e)?{field:_W({aggregate:iq(t.encoding)?e.op:void 0,field:e.field},{expr:"datum"})}:ZV(e)?{field:_W(t.fieldDef(e.encoding),{expr:"datum"}),order:e.order}:null===e?void 0:{field:_W(r,{binSuffix:t.stack&&t.stack.impute?"mid":void 0,expr:"datum"})}}}}}(t),l=function(t){if(!t.component.selection)return null;const e=Kz(t.component.selection).length;let n=e,r=t.parent;for(;r&&0===n;)n=Kz(r.component.selection).length,r=r.parent;return n?{interactive:e>0}:null}(t),c=KW("aria",r,i),h=wZ[n].postEncodingTransform?wZ[n].postEncodingTransform(t):null;return[Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({name:t.getName("marks"),type:wZ[n].vgMark},o?{clip:!0}:{}),a?{style:a}:{}),s?{key:s.field}:{}),u?{sort:u}:{}),l||{}),!1===c?{aria:c}:{}),{from:{data:e.fromPrefix+t.requestDataName(VH)},encode:{update:wZ[n].encodeEntry(t)}}),h?{transform:h}:{})]}class _Z extends jY{constructor(t,e,n,r={},i){var o,a;super(t,"unit",e,n,i,void 0,Bq(t)?t.view:void 0),this.specifiedScales={},this.specifiedAxes={},this.specifiedLegends={},this.specifiedProjection={},this.selection={},this.children=[];const s=zL(t.mark)?t.mark.type:t.mark;this.markDef=function(t,e,n,{graticule:r}){const i=zL(t)?Object.assign({},t):{type:t},o=KW("orient",i,n);if(i.orient=function(t,e,n){switch(t){case EL:case RL:case IL:case NL:case OL:case kL:return}const{x:r,y:i,x2:o,y2:a}=e;switch(t){case CL:if(cW(r)&&(HB(r.bin)||cW(i)&&i.aggregate&&!r.aggregate))return"vertical";if(cW(i)&&(HB(i.bin)||cW(r)&&r.aggregate&&!i.aggregate))return"horizontal";if(a||o){if(n)return n;if(!o&&(cW(r)&&r.type===Q$&&!qB(r.bin)||pW(r)))return"horizontal";if(!a&&(cW(i)&&i.type===Q$&&!qB(i.bin)||pW(i)))return"vertical"}case AL:if(o&&(!cW(r)||!HB(r.bin))&&a&&(!cW(i)||!HB(i.bin)))return;case _L:if(a)return cW(i)&&HB(i.bin)?"horizontal":"vertical";if(o)return cW(r)&&HB(r.bin)?"vertical":"horizontal";if(t===AL){if(r&&!i)return"vertical";if(i&&!r)return"horizontal"}case SL:case TL:{const e=fW(r),o=fW(i);if(e&&!o)return"tick"!==t?"horizontal":"vertical";if(!e&&o)return"tick"!==t?"vertical":"horizontal";if(e&&o){const e=r,o=i,a=e.type===tV,s=o.type===tV;return a&&!s?"tick"!==t?"vertical":"horizontal":!a&&s?"tick"!==t?"horizontal":"vertical":!e.aggregate&&o.aggregate?"tick"!==t?"vertical":"horizontal":e.aggregate&&!o.aggregate?"tick"!==t?"horizontal":"vertical":n||"vertical"}return n||void 0}}return"vertical"}(i.type,e,o),void 0!==o&&o!==i.orient&&y$(y.orientOverridden(i.orient,o)),"bar"===i.type&&i.orient){const t=KW("cornerRadiusEnd",i,n);if(void 0!==t){const n="horizontal"===i.orient&&e.x2||"vertical"===i.orient&&e.y2?["cornerRadius"]:UL[i.orient];for(const e of n)i[e]=t;void 0!==i.cornerRadiusEnd&&delete i.cornerRadiusEnd}}return void 0===KW("opacity",i,n)&&(i.opacity=function(t,e){if(Bz([EL,TL,RL,IL],t)&&!iq(e))return.7}(i.type,e)),void 0===i.filled&&(i.filled=!r&&function(t,e){const n=YW("filled",t,e),r=t.type;return lL(n,r!==EL&&r!==SL&&r!==AL)}(i,n)),void 0===KW("cursor",i,n)&&(i.cursor=function(t,e,n){return e.href||t.href||KW("href",t,n)?"pointer":t.cursor}(i,e,n)),i}(t.mark,null!==(o=t.encoding)&&void 0!==o?o:{},i,{graticule:t.data&&$H(t.data)});const u=this.encoding=function(t,e,n){const r=e.type;return Kz(t).reduce((i,o)=>{if(!xB(o))return y$(y.invalidEncodingChannel(o)),i;const a=t[o];if("angle"!==o||"arc"!==r||t.theta||(y$(y.REPLACE_ANGLE_WITH_THETA),o=nB),!function(t,e,n){const r=function(t,e){return function(t){switch(t){case iB:case oB:case aB:case"description":case"detail":case"key":case"tooltip":case"href":case"order":case"opacity":case"fillOpacity":case"strokeOpacity":case"strokeWidth":case"facet":case JL:case tB:return UB;case"x":case"y":case"latitude":case"longitude":return $B;case"x2":case"y2":case"latitude2":case"longitude2":return{area:"always",bar:"always",image:"always",rect:"always",rule:"always",circle:"binned",point:"binned",square:"binned",tick:"binned",line:"binned",trail:"binned"};case uB:return{point:"always",tick:"always",rule:"always",circle:"always",square:"always",bar:"always",text:"always",line:"always",trail:"always"};case"strokeDash":return{line:"always",point:"always",tick:"always",rule:"always",circle:"always",square:"always",bar:"always",geoshape:"always"};case sB:return{point:"always",geoshape:"always"};case"text":return{text:"always"};case"angle":return{point:"always",square:"always",text:"always"};case"url":return{image:"always"};case nB:case eB:return{text:"always",arc:"always"};case rB:case"radius2":return{arc:"always"}}}(t)[e]}(e,n);if(!r)return!1;if("binned"===r){const n=t["x2"===e?"x":"y"];return!!(cW(n)&&cW(t[e])&&HB(n.bin))}return!0}(t,o,r))return y$(y.incompatibleChannel(o,r)),i;if(o===uB&&"line"===r){const e=RW(t[o]);if(null==e?void 0:e.aggregate)return y$(y.LINE_WITH_VARYING_SIZE),i}if(o===iB&&(e.filled?"fill"in t:"stroke"in t))return y$(y.droppingColor("encoding",{fill:"fill"in t,stroke:"stroke"in t})),i;if("detail"===o||"order"===o&&!Ct(a)&&!yW(a)||"tooltip"===o&&Ct(a))a&&(i[o]=Xt(a).reduce((t,e)=>(cW(e)?t.push(PW(e,o)):y$(y.emptyFieldDef(e,o)),t),[]));else{if("tooltip"===o&&null===a)i[o]=null;else if(!(cW(a)||dW(a)||yW(a)||sW(a)||I$(a)))return y$(y.emptyFieldDef(a,o)),i;i[o]=MW(a,o,n)}return i},{})}(null!==(a=t.encoding)&&void 0!==a?a:{},this.markDef,i);this.size=function({encoding:t,size:e}){for(const n of DB){const r=OB(n);Lq(e[r])&&fW(t[n])&&(delete e[r],y$(y.stepDropped(r)))}return e}({encoding:u,size:Bq(t)?Object.assign(Object.assign(Object.assign({},r),t.width?{width:t.width}:{}),t.height?{height:t.height}:{}):r}),this.stack=sH(s,u),this.specifiedScales=this.initScales(s,u),this.specifiedAxes=this.initAxes(u),this.specifiedLegends=this.initLegend(u),this.specifiedProjection=t.projection,this.selection=t.selection}get hasProjection(){const{encoding:t}=this,e=this.mark===ML,n=t&&dB.some(e=>mW(t[e]));return e||n}scaleDomain(t){const e=this.specifiedScales[t];return e?e.domain:void 0}axis(t){return this.specifiedAxes[t]}legend(t){return this.specifiedLegends[t]}initScales(t,e){return LB.reduce((t,n)=>{var r;const i=IW(e[n]);return i&&(t[n]=null!==(r=i.scale)&&void 0!==r?r:{}),t},{})}initAxes(t){return DB.reduce((e,n)=>{const r=t[n];if(mW(r)||"x"===n&&mW(t.x2)||"y"===n&&mW(t.y2)){const t=mW(r)?r.axis:void 0;e[n]=t?Object.assign({},t):t}return e},{})}initLegend(t){return jB.reduce((e,n)=>{const r=IW(t[n]);if(r&&function(t){switch(t){case iB:case oB:case aB:case uB:case sB:case"opacity":case"strokeWidth":case"strokeDash":return!0;case"fillOpacity":case"strokeOpacity":case"angle":return!1}}(n)){const t=r.legend;e[n]=t?Object.assign({},t):t}return e},{})}parseData(){this.component.data=sZ(this)}parseLayoutSize(){!function(t){const{size:e,component:n}=t;for(const r of DB){const i=OB(r);if(e[i]){const t=e[i];n.layoutSize.set(i,Lq(t)?"step":t,!0)}else{const e=rZ(t,i);n.layoutSize.set(i,e,!1)}}}(this)}parseSelections(){this.component.selection=function(t,e){var n;const r={},i=t.config.selection;for(const o of Kz(null!=e?e:{})){const a=Mz(e[o]),s=i[a.type],u=Object(x.b)(s,["fields","encodings"]);for(const t in u)"encodings"===t&&a.fields||"fields"===t&&a.encodings||("mark"===t&&(a[t]=Object.assign(Object.assign({},u[t]),a[t])),void 0!==a[t]&&!0!==a[t]||(a[t]=null!==(n=u[t])&&void 0!==n?n:a[t]));const l=Jz(o),c=r[l]=Object.assign(Object.assign({},a),{name:l,events:ve(a.on)?ZF(a.on,"scope"):Mz(a.on)});QG(c,n=>{n.has(c)&&n.parse&&n.parse(t,c,a,e[o])})}return r}(this,this.selection)}parseMarkGroup(){this.component.mark=Bz([SL,_L,DL],this.mark)?function(t){const e=lq(t.mark,t.encoding),n=xZ(t,{fromPrefix:e.length>0?"faceted_path_":""});return e.length>0?[{name:t.getName("pathgroup"),type:"group",from:{facet:{name:"faceted_path_"+t.requestDataName(VH),data:t.requestDataName(VH),groupby:e}},encode:{update:{width:{field:{group:"width"}},height:{field:{group:"height"}}}},marks:n}]:n}(this):Bz([CL],this.mark)?function(t){const e=z$.some(e=>KW(e,t.markDef,t.config));if(t.stack&&!t.fieldDef("size")&&e){const[e]=xZ(t,{fromPrefix:"stack_group_"}),n=t.scaleName(t.stack.fieldChannel),r=(e={})=>t.vgField(t.stack.fieldChannel,e),i=(t,e)=>`${t}(${[r({prefix:"min",suffix:"start",expr:e}),r({prefix:"max",suffix:"start",expr:e}),r({prefix:"min",suffix:"end",expr:e}),r({prefix:"max",suffix:"end",expr:e})].map(t=>`scale('${n}',${t})`).join(",")})`;let o,a;"x"===t.stack.fieldChannel?(o=Object.assign(Object.assign({},Fz(e.encode.update,["y","yc","y2","height",...z$])),{x:{signal:i("min","datum")},x2:{signal:i("max","datum")},clip:{value:!0}}),a={x:{field:{group:"x"},mult:-1},height:{field:{group:"height"}}},e.encode.update=Object.assign(Object.assign({},Pz(e.encode.update,["y","yc","y2"])),{height:{field:{group:"height"}}})):(o=Object.assign(Object.assign({},Fz(e.encode.update,["x","xc","x2","width"])),{y:{signal:i("min","datum")},y2:{signal:i("max","datum")},clip:{value:!0}}),a={y:{field:{group:"y"},mult:-1},width:{field:{group:"width"}}},e.encode.update=Object.assign(Object.assign({},Pz(e.encode.update,["x","xc","x2"])),{width:{field:{group:"width"}}}));for(const l of z$){const n=YW(l,t.markDef,t.config);e.encode.update[l]?(o[l]=e.encode.update[l],delete e.encode.update[l]):n&&(o[l]=qW(n)),n&&(e.encode.update[l]={value:0})}const s=t.fieldDef(t.stack.groupbyChannel),u=_W(s)?[_W(s)]:[];return((null==s?void 0:s.bin)||(null==s?void 0:s.timeUnit))&&u.push(_W(s,{binSuffix:"end"})),o=["stroke","strokeWidth","strokeJoin","strokeCap","strokeDash","strokeDashOffset","strokeMiterLimit","strokeOpacity"].reduce((n,r)=>{if(e.encode.update[r])return Object.assign(Object.assign({},n),{[r]:e.encode.update[r]});{const e=YW(r,t.markDef,t.config);return void 0!==e?Object.assign(Object.assign({},n),{[r]:qW(e)}):n}},o),o.stroke&&(o.strokeForeground={value:!0},o.strokeOffset={value:0}),[{type:"group",from:{facet:{data:t.requestDataName(VH),name:"stack_group_"+t.requestDataName(VH),groupby:u,aggregate:{fields:[r({suffix:"start"}),r({suffix:"start"}),r({suffix:"end"}),r({suffix:"end"})],ops:["min","max","min","max"]}}},encode:{update:o},marks:[{type:"group",encode:{update:a},marks:[e]}]}]}return xZ(t)}(this):xZ(this)}parseAxesAndHeaders(){var t;this.component.axes=(t=this,DB.reduce((e,n)=>(t.component.scales[n]&&(e[n]=[yZ(n,t)]),e),{}))}assembleSelectionTopLevelSignals(t){return function(t,e){let n=!1;return dX(t,(r,i)=>{const o=r.name,a=Ee(o+uX);if(0===e.filter(t=>t.name===o).length){const t="multi"===r.type?", true)":")";e.push({name:r.name,update:`${cX}(${a}, ${Ee("global"===r.resolve?"union":r.resolve)}${t}`})}n=!0,i.topLevelSignals&&(e=i.topLevelSignals(t,r,e)),QG(r,n=>{n.topLevelSignals&&(e=n.topLevelSignals(t,r,e))})}),n&&0===e.filter(t=>"unit"===t.name).length&&e.unshift({name:"unit",value:{},on:[{events:"mousemove",update:"isTuple(group()) ? group() : unit"}]}),eX(e)}(this,t)}assembleSignals(){return[..._X(this),...(t=this,e=[],dX(t,(n,r)=>{const i=n.name;let o=r.modifyExpr(t,n);e.push(...r.signals(t,n)),QG(n,r=>{r.signals&&(e=r.signals(t,n,e)),r.modifyExpr&&(o=r.modifyExpr(t,n,o))}),e.push({name:i+"_modify",on:[{events:{signal:n.name+lX},update:`modify(${Ee(n.name+uX)}, ${o})`}]})}),eX(e))];var t,e}assembleSelectionData(t){return function(t,e){const n=[...e];return dX(t,e=>{const r={name:e.name+uX};if(e.init){const n=e.project.items.map(t=>Object(x.b)(t,["signals"])),i=e.init.map(t=>JG(t,!1));r.values="interval"===e.type?[{unit:fX(t,{escape:!1}),fields:n,values:i}]:i.map(e=>({unit:fX(t,{escape:!1}),fields:n,values:e}))}n.filter(t=>t.name===e.name+uX).length||n.push(r)}),n}(this,t)}assembleLayout(){return null}assembleLayoutSignals(){return QX(this)}assembleMarks(){var t;let e=null!==(t=this.component.mark)&&void 0!==t?t:[];return this.parent&&FY(this.parent)||(e=tX(this,e)),e.map(this.correctDataNames)}getMapping(){return this.encoding}get mark(){return this.markDef.type}channelHasField(t){return rq(this.encoding,t)}fieldDef(t){return RW(this.encoding[t])}typedFieldDef(t){const e=this.fieldDef(t);return gW(e)?e:null}}class CZ extends PY{constructor(t,e,n,r,i){super(t,"layer",e,n,i,t.resolve,t.view);const o=Object.assign(Object.assign(Object.assign({},r),t.width?{width:t.width}:{}),t.height?{height:t.height}:{});this.children=t.layer.map((t,e)=>{if(eH(t))return new CZ(t,this,this.getName("layer_"+e),o,i);if($L(t))return new _Z(t,this,this.getName("layer_"+e),o,i);throw new Error(y.invalidSpec(t))})}parseData(){this.component.data=sZ(this);for(const t of this.children)t.parseData()}parseLayoutSize(){eZ(this),nZ(this,"width"),nZ(this,"height")}parseSelections(){this.component.selection={};for(const t of this.children){t.parseSelections();for(const e of Kz(t.component.selection))this.component.selection[e]=t.component.selection[e]}}parseMarkGroup(){for(const t of this.children)t.parseMarkGroup()}parseAxesAndHeaders(){!function(t){var e;const{axes:n,resolve:r}=t.component,i={top:0,bottom:0,right:0,left:0};for(const o of t.children){o.parseAxesAndHeaders();for(const e of Kz(o.component.axes))r.axis[e]=oK(t.component.resolve,e),"shared"===r.axis[e]&&(n[e]=fZ(n[e],o.component.axes[e]),n[e]||(r.axis[e]="independent",delete n[e]))}for(const o of DB){for(const a of t.children)if(a.component.axes[o]){if("independent"===r.axis[o]){n[o]=(null!==(e=n[o])&&void 0!==e?e:[]).concat(a.component.axes[o]);for(const t of a.component.axes[o]){const{value:e,explicit:n}=t.getWithExplicit("orient");if(!I$(e)){if(i[e]>0&&!n){const n=dZ[e];i[e]>i[n]&&t.set("orient",n,!1)}i[e]++}}}delete a.component.axes[o]}if("independent"===r.axis[o]&&n[o]&&n[o].length>1)for(const t of n[o])t.get("grid")&&!t.explicit.grid&&(t.implicit.grid=!1)}}(this)}assembleSelectionTopLevelSignals(t){return this.children.reduce((t,e)=>e.assembleSelectionTopLevelSignals(t),t)}assembleSignals(){return this.children.reduce((t,e)=>t.concat(e.assembleSignals()),_X(this))}assembleLayoutSignals(){return this.children.reduce((t,e)=>t.concat(e.assembleLayoutSignals()),QX(this))}assembleSelectionData(t){return this.children.reduce((t,e)=>e.assembleSelectionData(t),t)}assembleTitle(){let t=super.assembleTitle();if(t)return t;for(const e of this.children)if(t=e.assembleTitle(),t)return t}assembleLayout(){return null}assembleMarks(){return function(t,e){for(const n of t.children)RY(n)&&(e=tX(n,e));return e}(this,this.children.flatMap(t=>t.assembleMarks()))}assembleLegends(){return this.children.reduce((t,e)=>t.concat(e.assembleLegends()),xK(this))}}function kZ(t,e,n,r,i){if(nW(t))return new oZ(t,e,n,i);if(eH(t))return new CZ(t,e,n,r,i);if($L(t))return new _Z(t,e,n,r,i);if(function(t){return jq(t)||zq(t)||Pq(t)}(t))return new uZ(t,e,n,i);throw new Error(y.invalidSpec(t))}function SZ(t,e={}){e.logger&&(g$=e.logger),e.fieldTitle&&OW(e.fieldTitle);try{const n=Yq(Et(e.config,t.config)),r=kH(t,n),i=kZ(r,null,"",void 0,n);return i.parse(),function(t,e){TK(t.sources);let n=0,r=0;for(let i=0;i<5&&uY(t,e);i++)n++;t.sources.map(ZK);for(let i=0;i<5&&uY(t,e);i++)r++;TK(t.sources),5===Math.max(n,r)&&y$("Maximum optimization runs(5) reached.")}(i.component.data,i),{spec:function(t,e,n={},r){const i=t.config?function(t){t=Mz(t);for(const e of Qq)delete t[e];if(t.axis)for(const e in t.axis)pL(t.axis[e])&&delete t.axis[e];if(t.legend)for(const e of Nq)delete t.legend[e];if(t.mark){for(const e of BL)delete t.mark[e];t.mark.tooltip&&kt(t.mark.tooltip)&&delete t.mark.tooltip}for(const e of Zq){for(const r of BL)delete t[e][r];const n=Jq[e];if(n)for(const r of n)delete t[e][r];tH(t,e)}for(const e of Kz(Oq))delete t[e];!function(t){const{titleMarkConfig:e,subtitleMarkConfig:n,subtitle:r}=VW(t.title);Xz(e)||(t.style["group-title"]=Object.assign(Object.assign({},t.style["group-title"]),e)),Xz(n)||(t.style["group-subtitle"]=Object.assign(Object.assign({},t.style["group-subtitle"]),n)),Xz(r)?delete t.title:t.title=r}(t);for(const e in t)kt(t[e])&&Xz(t[e])&&delete t[e];return Xz(t)?void 0:t}(t.config):void 0,o=[].concat(t.assembleSelectionData([]),function(t,e){var n,r;const i=[],o=ZY(i);let a=0;for(const u of t.sources){u.hasName()||(u.dataName="source_"+a++);const t=u.assemble();o(u,t)}for(const u of i)0===u.transform.length&&delete u.transform;let s=0;for(const[u,l]of i.entries())0!==(null!==(n=l.transform)&&void 0!==n?n:[]).length||l.source||i.splice(s++,0,i.splice(u,1)[0]);for(const u of i)for(const e of null!==(r=u.transform)&&void 0!==r?r:[])"lookup"===e.type&&(e.from=t.outputNodes[e.from].getSource());for(const u of i)u.name in e&&(u.values=e[u.name]);return i}(t.component.data,n)),a=t.assembleProjections(),s=t.assembleTitle(),u=t.assembleGroupStyle(),l=t.assembleGroupEncodeEntry(!0);let c=t.assembleLayoutSignals();return c=c.filter(t=>"width"!==t.name&&"height"!==t.name||void 0===t.value||(e[t.name]=+t.value,!1)),Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({$schema:"https://vega.github.io/schema/vega/v5.json"},t.description?{description:t.description}:{}),e),s?{title:s}:{}),u?{style:u}:{}),l?{encode:{update:l}}:{}),{data:o}),a.length>0?{projections:a}:{}),t.assembleGroup([...c,...t.assembleSelectionTopLevelSignals([])])),i?{config:i}:{}),r?{usermeta:r}:{})}(i,function(t,e,n,r){const i=r.component.layoutSize.get("width"),o=r.component.layoutSize.get("height");if(void 0===e?(e={type:"pad"},r.hasAxisOrientSignalRef()&&(e.resize=!0)):ve(e)&&(e={type:e}),i&&o&&("fit"===(a=e.type)||"fit-x"===a||"fit-y"===a))if("step"===i&&"step"===o)y$(y.droppingFit()),e.type="pad";else if("step"===i||"step"===o){const t="step"===i?"width":"height";y$(y.droppingFit(FB(t))),e.type=function(t){return t?"fit-"+FB(t):"fit"}("width"===t?"height":"width")}var a;return Object.assign(Object.assign(Object.assign({},1===Kz(e).length&&e.type?"pad"===e.type?{}:{autosize:e.type}:{autosize:e}),AH(n)),AH(t))}(t,r.autosize,n,i),t.datasets,t.usermeta),normalized:r}}finally{e.logger&&(g$=m$),e.fieldTitle&&OW(SW)}}const EZ=new class extends nH{mapUnit(t,{config:e}){if(t.encoding){const{encoding:n,transform:r}=t,{bins:i,timeUnits:o,aggregate:a,groupby:s,encoding:u}=oq(n,e),l=[...r||[],...i,...o,...0===a.length?[]:[{aggregate:a,groupby:s}]];return Object.assign(Object.assign(Object.assign({},t),l.length>0?{transform:l}:{}),{encoding:u})}return t}};function OZ(t,e){return EZ.map(t,{config:e})}const AZ=_z.version;var NZ=n("gatG"),TZ=n.n(NZ),DZ=n("qw/d"),RZ={background:"#333",title:{color:"#fff"},style:{"guide-label":{fill:"#fff"},"guide-title":{fill:"#fff"}},axis:{domainColor:"#fff",gridColor:"#888",tickColor:"#fff"}},IZ={background:"#fff",arc:{fill:"#4572a7"},area:{fill:"#4572a7"},line:{stroke:"#4572a7",strokeWidth:2},path:{stroke:"#4572a7"},rect:{fill:"#4572a7"},shape:{stroke:"#4572a7"},symbol:{fill:"#4572a7",strokeWidth:1.5,size:50},axis:{bandPosition:.5,grid:!0,gridColor:"#000000",gridOpacity:1,gridWidth:.5,labelPadding:10,tickSize:5,tickWidth:.5},axisBand:{grid:!1,tickExtra:!0},legend:{labelBaseline:"middle",labelFontSize:11,symbolSize:50,symbolType:"square"},range:{category:["#4572a7","#aa4643","#8aa453","#71598e","#4598ae","#d98445","#94aace","#d09393","#b9cc98","#a99cbc"]}},MZ={arc:{fill:"#30a2da"},area:{fill:"#30a2da"},axis:{domainColor:"#cbcbcb",grid:!0,gridColor:"#cbcbcb",gridWidth:1,labelColor:"#999",labelFontSize:10,titleColor:"#333",tickColor:"#cbcbcb",tickSize:10,titleFontSize:14,titlePadding:10,labelPadding:4},axisBand:{grid:!1},background:"#f0f0f0",group:{fill:"#f0f0f0"},legend:{labelColor:"#333",labelFontSize:11,padding:1,symbolSize:30,symbolType:"square",titleColor:"#333",titleFontSize:14,titlePadding:10},line:{stroke:"#30a2da",strokeWidth:2},path:{stroke:"#30a2da",strokeWidth:.5},rect:{fill:"#30a2da"},range:{category:["#30a2da","#fc4f30","#e5ae38","#6d904f","#8b8b8b","#b96db8","#ff9e27","#56cc60","#52d2ca","#52689e","#545454","#9fe4f8"],diverging:["#cc0020","#e77866","#f6e7e1","#d6e8ed","#91bfd9","#1d78b5"],heatmap:["#d6e8ed","#cee0e5","#91bfd9","#549cc6","#1d78b5"]},point:{filled:!0,shape:"circle"},shape:{stroke:"#30a2da"},bar:{binSpacing:2,fill:"#30a2da",stroke:null},title:{anchor:"start",fontSize:24,fontWeight:600,offset:20}},FZ={group:{fill:"#e5e5e5"},arc:{fill:"#000"},area:{fill:"#000"},line:{stroke:"#000"},path:{stroke:"#000"},rect:{fill:"#000"},shape:{stroke:"#000"},symbol:{fill:"#000",size:40},axis:{domain:!1,grid:!0,gridColor:"#FFFFFF",gridOpacity:1,labelColor:"#7F7F7F",labelPadding:4,tickColor:"#7F7F7F",tickSize:5.67,titleFontSize:16,titleFontWeight:"normal"},legend:{labelBaseline:"middle",labelFontSize:11,symbolSize:40},range:{category:["#000000","#7F7F7F","#1A1A1A","#999999","#333333","#B0B0B0","#4D4D4D","#C9C9C9","#666666","#DCDCDC"]}};const PZ="Benton Gothic Bold, sans-serif",jZ={"category-6":["#ec8431","#829eb1","#c89d29","#3580b1","#adc839","#ab7fb4"],"fire-7":["#fbf2c7","#f9e39c","#f8d36e","#f4bb6a","#e68a4f","#d15a40","#ab4232"],"fireandice-6":["#e68a4f","#f4bb6a","#f9e39c","#dadfe2","#a6b7c6","#849eae"],"ice-7":["#edefee","#dadfe2","#c4ccd2","#a6b7c6","#849eae","#607785","#47525d"]};var zZ={background:"#ffffff",title:{anchor:"start",color:"#000000",font:PZ,fontSize:22,fontWeight:"normal"},arc:{fill:"#82c6df"},area:{fill:"#82c6df"},line:{stroke:"#82c6df",strokeWidth:2},path:{stroke:"#82c6df"},rect:{fill:"#82c6df"},shape:{stroke:"#82c6df"},symbol:{fill:"#82c6df",size:30},axis:{labelFont:"Benton Gothic, sans-serif",labelFontSize:11.5,labelFontWeight:"normal",titleFont:PZ,titleFontSize:13,titleFontWeight:"normal"},axisX:{labelAngle:0,labelPadding:4,tickSize:3},axisY:{labelBaseline:"middle",maxExtent:45,minExtent:45,tickSize:2,titleAlign:"left",titleAngle:0,titleX:-45,titleY:-11},legend:{labelFont:"Benton Gothic, sans-serif",labelFontSize:11.5,symbolType:"square",titleFont:PZ,titleFontSize:13,titleFontWeight:"normal"},range:{category:jZ["category-6"],diverging:jZ["fireandice-6"],heatmap:jZ["fire-7"],ordinal:jZ["fire-7"],ramp:jZ["fire-7"]}},LZ={background:"#f9f9f9",arc:{fill:"#ab5787"},area:{fill:"#ab5787"},line:{stroke:"#ab5787"},path:{stroke:"#ab5787"},rect:{fill:"#ab5787"},shape:{stroke:"#ab5787"},symbol:{fill:"#ab5787",size:30},axis:{domainColor:"#979797",domainWidth:.5,gridWidth:.2,labelColor:"#979797",tickColor:"#979797",tickWidth:.2,titleColor:"#979797"},axisBand:{grid:!1},axisX:{grid:!0,tickSize:10},axisY:{domain:!1,grid:!0,tickSize:0},legend:{labelFontSize:11,padding:1,symbolSize:30,symbolType:"square"},range:{category:["#ab5787","#51b2e5","#703c5c","#168dd9","#d190b6","#00609f","#d365ba","#154866","#666666","#c4c4c4"]}},BZ={background:"#fff",arc:{fill:"#3e5c69"},area:{fill:"#3e5c69"},line:{stroke:"#3e5c69"},path:{stroke:"#3e5c69"},rect:{fill:"#3e5c69"},shape:{stroke:"#3e5c69"},symbol:{fill:"#3e5c69"},axis:{domainWidth:.5,grid:!0,labelPadding:2,tickSize:5,tickWidth:.5,titleFontWeight:"normal"},axisBand:{grid:!1},axisX:{gridWidth:.2},axisY:{gridDash:[3],gridWidth:.4},legend:{labelFontSize:11,padding:1,symbolType:"square"},range:{category:["#3e5c69","#6793a6","#182429","#0570b0","#3690c0","#74a9cf","#a6bddb","#e2ddf2"]}};const UZ={"main-colors":["#1696d2","#d2d2d2","#000000","#fdbf11","#ec008b","#55b748","#5c5859","#db2b27"],"shades-blue":["#CFE8F3","#A2D4EC","#73BFE2","#46ABDB","#1696D2","#12719E","#0A4C6A","#062635"],"shades-gray":["#F5F5F5","#ECECEC","#E3E3E3","#DCDBDB","#D2D2D2","#9D9D9D","#696969","#353535"],"shades-yellow":["#FFF2CF","#FCE39E","#FDD870","#FCCB41","#FDBF11","#E88E2D","#CA5800","#843215"],"shades-magenta":["#F5CBDF","#EB99C2","#E46AA7","#E54096","#EC008B","#AF1F6B","#761548","#351123"],"shades-green":["#DCEDD9","#BCDEB4","#98CF90","#78C26D","#55B748","#408941","#2C5C2D","#1A2E19"],"shades-black":["#D5D5D4","#ADABAC","#848081","#5C5859","#332D2F","#262223","#1A1717","#0E0C0D"],"shades-red":["#F8D5D4","#F1AAA9","#E9807D","#E25552","#DB2B27","#A4201D","#6E1614","#370B0A"],"one-group":["#1696d2","#000000"],"two-groups-cat-1":["#1696d2","#000000"],"two-groups-cat-2":["#1696d2","#fdbf11"],"two-groups-cat-3":["#1696d2","#db2b27"],"two-groups-seq":["#a2d4ec","#1696d2"],"three-groups-cat":["#1696d2","#fdbf11","#000000"],"three-groups-seq":["#a2d4ec","#1696d2","#0a4c6a"],"four-groups-cat-1":["#000000","#d2d2d2","#fdbf11","#1696d2"],"four-groups-cat-2":["#1696d2","#ec0008b","#fdbf11","#5c5859"],"four-groups-seq":["#cfe8f3","#73bf42","#1696d2","#0a4c6a"],"five-groups-cat-1":["#1696d2","#fdbf11","#d2d2d2","#ec008b","#000000"],"five-groups-cat-2":["#1696d2","#0a4c6a","#d2d2d2","#fdbf11","#332d2f"],"five-groups-seq":["#cfe8f3","#73bf42","#1696d2","#0a4c6a","#000000"],"six-groups-cat-1":["#1696d2","#ec008b","#fdbf11","#000000","#d2d2d2","#55b748"],"six-groups-cat-2":["#1696d2","#d2d2d2","#ec008b","#fdbf11","#332d2f","#0a4c6a"],"six-groups-seq":["#cfe8f3","#a2d4ec","#73bfe2","#46abdb","#1696d2","#12719e"],"diverging-colors":["#ca5800","#fdbf11","#fdd870","#fff2cf","#cfe8f3","#73bfe2","#1696d2","#0a4c6a"]};var $Z={background:"#FFFFFF",title:{anchor:"start",fontSize:18,font:"Lato"},axisX:{domain:!0,domainColor:"#000000",domainWidth:1,grid:!1,labelFontSize:12,labelFont:"Lato",labelAngle:0,tickColor:"#000000",tickSize:5,titleFontSize:12,titlePadding:10,titleFont:"Lato"},axisY:{domain:!1,domainWidth:1,grid:!0,gridColor:"#DEDDDD",gridWidth:1,labelFontSize:12,labelFont:"Lato",labelPadding:8,ticks:!1,titleFontSize:12,titlePadding:10,titleFont:"Lato",titleAngle:0,titleY:-10,titleX:18},legend:{labelFontSize:12,labelFont:"Lato",symbolSize:100,titleFontSize:12,titlePadding:10,titleFont:"Lato",orient:"right",offset:10},view:{stroke:"transparent"},range:{category:UZ["six-groups-cat-1"],diverging:UZ["diverging-colors"],heatmap:UZ["diverging-colors"],ordinal:UZ["six-groups-seq"],ramp:UZ["shades-blue"]},area:{fill:"#1696d2"},rect:{fill:"#1696d2"},line:{color:"#1696d2",stroke:"#1696d2",strokeWidth:5},trail:{color:"#1696d2",stroke:"#1696d2",strokeWidth:0,size:1},path:{stroke:"#1696d2",strokeWidth:.5},point:{filled:!0},text:{font:"Lato",color:"#1696d2",fontSize:11,align:"center",fontWeight:400,size:11},style:{bar:{fill:"#1696d2",stroke:null}},arc:{fill:"#1696d2"},shape:{stroke:"#1696d2"},symbol:{fill:"#1696d2",size:30}},VZ={arc:{fill:"#3366CC"},area:{fill:"#3366CC"},path:{stroke:"#3366CC"},rect:{fill:"#3366CC"},shape:{stroke:"#3366CC"},symbol:{stroke:"#3366CC"},circle:{fill:"#3366CC"},background:"#fff",padding:{top:10,right:10,bottom:10,left:10},style:{"guide-label":{font:"Arial, sans-serif",fontSize:12},"guide-title":{font:"Arial, sans-serif",fontSize:12},"group-title":{font:"Arial, sans-serif",fontSize:12}},title:{font:"Arial, sans-serif",fontSize:14,fontWeight:"bold",dy:-3,anchor:"start"},axis:{gridColor:"#ccc",tickColor:"#ccc",domain:!1,grid:!0},range:{category:["#4285F4","#DB4437","#F4B400","#0F9D58","#AB47BC","#00ACC1","#FF7043","#9E9D24","#5C6BC0","#F06292","#00796B","#C2185B"],heatmap:["#c6dafc","#5e97f6","#2a56c6"]}};const WZ=DZ.version;n("3iBx");const qZ="vg-tooltip-element",HZ={offsetX:10,offsetY:10,id:qZ,styleId:"vega-tooltip-style",theme:"light",disableDefaultStyle:!1,sanitize:function(t){return String(t).replace(/&/g,"&amp;").replace(/</g,"&lt;")},maxDepth:2};function GZ(t,e){return JSON.stringify(t,function(t){const e=[];return function(n,r){if("object"!=typeof r||null===r)return r;const i=e.indexOf(this)+1;return e.length=i,e.length>t?"[Object]":e.indexOf(r)>=0?"[Circular]":(e.push(r),r)}}(e))}class XZ{constructor(t){this.options=Object.assign(Object.assign({},HZ),t);const e=this.options.id;if(this.call=this.tooltipHandler.bind(this),!this.options.disableDefaultStyle&&!document.getElementById(this.options.styleId)){const t=document.createElement("style");t.setAttribute("id",this.options.styleId),t.innerHTML=function(t){if(!/^[A-Za-z]+[-:.\w]*$/.test(t))throw new Error("Invalid HTML ID");return"#vg-tooltip-element {\n  visibility: hidden;\n  padding: 8px;\n  position: fixed;\n  z-index: 1000;\n  font-family: sans-serif;\n  font-size: 11px;\n  border-radius: 3px;\n  box-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);\n  /* The default theme is the light theme. */\n  background-color: rgba(255, 255, 255, 0.95);\n  border: 1px solid #d9d9d9;\n  color: black; }\n  #vg-tooltip-element.visible {\n    visibility: visible; }\n  #vg-tooltip-element h2 {\n    margin-top: 0;\n    margin-bottom: 10px;\n    font-size: 13px; }\n  #vg-tooltip-element img {\n    max-width: 200px;\n    max-height: 200px; }\n  #vg-tooltip-element table {\n    border-spacing: 0; }\n    #vg-tooltip-element table tr {\n      border: none; }\n      #vg-tooltip-element table tr td {\n        overflow: hidden;\n        text-overflow: ellipsis;\n        padding-top: 2px;\n        padding-bottom: 2px; }\n        #vg-tooltip-element table tr td.key {\n          color: #808080;\n          max-width: 150px;\n          text-align: right;\n          padding-right: 4px; }\n        #vg-tooltip-element table tr td.value {\n          display: block;\n          max-width: 300px;\n          max-height: 7em;\n          text-align: left; }\n  #vg-tooltip-element.dark-theme {\n    background-color: rgba(32, 32, 32, 0.9);\n    border: 1px solid #f5f5f5;\n    color: white; }\n    #vg-tooltip-element.dark-theme td.key {\n      color: #bfbfbf; }\n".toString().replace(qZ,t)}(e);const n=document.head;n.childNodes.length>0?n.insertBefore(t,n.childNodes[0]):n.appendChild(t)}this.el=document.getElementById(e),this.el||(this.el=document.createElement("div"),this.el.setAttribute("id",e),this.el.classList.add("vg-tooltip"),document.body.appendChild(this.el))}tooltipHandler(t,e,n,r){if(null==r||""===r)return void this.el.classList.remove("visible",this.options.theme+"-theme");this.el.innerHTML=function(t,e,n){if(Ct(t))return`[${t.map(t=>e(ve(t)?t:GZ(t,n))).join(", ")}]`;if(kt(t)){let r="";const i=t,{title:o,image:a}=i,s=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n}(i,["title","image"]);o&&(r+=`<h2>${e(o)}</h2>`),a&&(r+=`<img src="${e(a)}">`);const u=Object.keys(s);if(u.length>0){r+="<table>";for(const t of u){let i=s[t];void 0!==i&&(kt(i)&&(i=GZ(i,n)),r+=`<tr><td class="key">${e(t)}:</td><td class="value">${e(i)}</td></tr>`)}r+="</table>"}return r||"{}"}return e(t)}(r,this.options.sanitize,this.options.maxDepth),this.el.classList.add("visible",this.options.theme+"-theme");const{x:i,y:o}=function(t,e,n,r){let i=t.clientX+n;i+e.width>window.innerWidth&&(i=+t.clientX-n-e.width);let o=t.clientY+r;return o+e.height>window.innerHeight&&(o=+t.clientY-r-e.height),{x:i,y:o}}(e,this.el.getBoundingClientRect(),this.options.offsetX,this.options.offsetY);this.el.setAttribute("style",`top: ${o}px; left: ${i}px`)}}var KZ;function YZ(t,...e){for(const n of e)ZZ(t,n);return t}function ZZ(t,e){for(const n of Object.keys(e))Ot(t,n,e[n],!0)}String.prototype.startsWith||(String.prototype.startsWith=function(t,e){return this.substr(!e||e<0?0:+e,t.length)===t});const QZ=g;let JZ=v;const tQ="undefined"!=typeof window?window:void 0;void 0===JZ&&(null===(KZ=null==tQ?void 0:tQ.vl)||void 0===KZ?void 0:KZ.compile)&&(JZ=tQ.vl);const eQ={export:{svg:!0,png:!0},source:!0,compiled:!0,editor:!0},nQ={CLICK_TO_VIEW_ACTIONS:"Click to view actions",COMPILED_ACTION:"View Compiled Vega",EDITOR_ACTION:"Open in Vega Editor",PNG_ACTION:"Save as PNG",SOURCE_ACTION:"View Source",SVG_ACTION:"Save as SVG"},rQ={vega:"Vega","vega-lite":"Vega-Lite"},iQ={vega:g.version,"vega-lite":JZ?JZ.version:"not available"},oQ={vega:t=>t,"vega-lite":(t,e)=>JZ.compile(t,{config:e}).spec};function aQ(t,e,n,r){const i=`<html><head>${e}</head><body><pre><code class="json">`,o=`</code></pre>${n}</body></html>`,a=window.open("");a.document.write(i+t+o),a.document.title=rQ[r]+" JSON Source"}function sQ(t,e){var n;if(t.$schema){const r=TZ()(t.$schema);e&&e!==r.library&&console.warn(`The given visualization spec is written in ${rQ[r.library]}, but mode argument sets ${null!==(n=rQ[e])&&void 0!==n?n:e}.`);const i=r.library;return Object(J.satisfies)(iQ[i],"^"+r.version.slice(1))||console.warn(`The input spec uses ${rQ[i]} ${r.version}, but the current version of ${rQ[i]} is v${iQ[i]}.`),i}return"mark"in t||"encoding"in t||"layer"in t||"hconcat"in t||"vconcat"in t||"facet"in t||"repeat"in t?"vega-lite":"marks"in t||"signals"in t||"scales"in t||"axes"in t?"vega":null!=e?e:"vega"}function uQ(t,e,n={}){var r,i,o;return Object(x.a)(this,void 0,void 0,(function*(){const a=(s=n.loader)&&"load"in s?n.loader:QZ.loader(n.loader);var s;const u=ve(e)?JSON.parse(yield a.load(e)):e,l=yield lQ(null!==(r=u.usermeta&&u.usermeta.embedOptions)&&void 0!==r?r:{},a),c=yield lQ(n,a),h=Object.assign(Object.assign({},YZ(c,l)),{config:Et(null!==(i=c.config)&&void 0!==i?i:{},null!==(o=l.config)&&void 0!==o?o:{})});return yield function(t,e,n={},r){var i,o,a,s,u,l;return Object(x.a)(this,void 0,void 0,(function*(){const c=n.theme?Et(b[n.theme],null!==(i=n.config)&&void 0!==i?i:{}):n.config,h=pe(n.actions)?n.actions:YZ({},eQ,null!==(o=n.actions)&&void 0!==o?o:{}),d=Object.assign(Object.assign({},nQ),n.i18n),f=null!==(a=n.renderer)&&void 0!==a?a:"canvas",p=null!==(s=n.logLevel)&&void 0!==s?s:QZ.Warn,m=null!==(u=n.downloadFileName)&&void 0!==u?u:"visualization";if(!1!==n.defaultStyle){const t="vega-embed-style";if(!document.getElementById(t)){const e=document.createElement("style");e.id=t,e.innerText=void 0===n.defaultStyle||!0===n.defaultStyle?'.vega-embed {\n  position: relative;\n  display: inline-block; }\n  .vega-embed.has-actions {\n    padding-right: 38px; }\n  .vega-embed details:not([open]) > :not(summary) {\n    display: none !important; }\n  .vega-embed summary {\n    list-style: none;\n    position: absolute;\n    top: 0;\n    right: 0;\n    padding: 6px;\n    z-index: 1000;\n    background: white;\n    box-shadow: 1px 1px 3px rgba(0, 0, 0, 0.1);\n    color: #1b1e23;\n    border: 1px solid #aaa;\n    border-radius: 999px;\n    opacity: 0.2;\n    transition: opacity 0.4s ease-in;\n    outline: none;\n    cursor: pointer;\n    line-height: 0px; }\n    .vega-embed summary::-webkit-details-marker {\n      display: none; }\n    .vega-embed summary:active {\n      box-shadow: #aaa 0px 0px 0px 1px inset; }\n    .vega-embed summary svg {\n      width: 14px;\n      height: 14px; }\n  .vega-embed details[open] summary {\n    opacity: 0.7; }\n  .vega-embed:hover summary,\n  .vega-embed:focus summary {\n    opacity: 1 !important;\n    transition: opacity 0.2s ease; }\n  .vega-embed .vega-actions {\n    position: absolute;\n    z-index: 1001;\n    top: 35px;\n    right: -9px;\n    display: flex;\n    flex-direction: column;\n    padding-bottom: 8px;\n    padding-top: 8px;\n    border-radius: 4px;\n    box-shadow: 0 2px 8px 0 rgba(0, 0, 0, 0.2);\n    border: 1px solid #d9d9d9;\n    background: white;\n    animation-duration: 0.15s;\n    animation-name: scale-in;\n    animation-timing-function: cubic-bezier(0.2, 0, 0.13, 1.5);\n    text-align: left; }\n    .vega-embed .vega-actions a {\n      padding: 8px 16px;\n      font-family: sans-serif;\n      font-size: 14px;\n      font-weight: 600;\n      white-space: nowrap;\n      color: #434a56;\n      text-decoration: none; }\n      .vega-embed .vega-actions a:hover {\n        background-color: #f7f7f9;\n        color: black; }\n    .vega-embed .vega-actions::before, .vega-embed .vega-actions::after {\n      content: "";\n      display: inline-block;\n      position: absolute; }\n    .vega-embed .vega-actions::before {\n      left: auto;\n      right: 14px;\n      top: -16px;\n      border: 8px solid #0000;\n      border-bottom-color: #d9d9d9; }\n    .vega-embed .vega-actions::after {\n      left: auto;\n      right: 15px;\n      top: -14px;\n      border: 7px solid #0000;\n      border-bottom-color: #fff; }\n\n.vega-embed-wrapper {\n  max-width: 100%;\n  overflow: scroll;\n  padding-right: 14px; }\n\n@keyframes scale-in {\n  from {\n    opacity: 0;\n    transform: scale(0.6); }\n  to {\n    opacity: 1;\n    transform: scale(1); } }\n'.toString():n.defaultStyle,document.head.appendChild(e)}}const g=sQ(e,n.mode);let y=oQ[g](e,c);if("vega-lite"===g&&y.$schema){const t=TZ()(y.$schema);Object(J.satisfies)(iQ.vega,"^"+t.version.slice(1))||console.warn(`The compiled spec uses Vega ${t.version}, but current version is v${iQ.vega}.`)}const v="string"==typeof t?document.querySelector(t):t;if(!v)throw Error(t+" does not exist");v.classList.add("vega-embed"),h&&v.classList.add("has-actions"),v.innerHTML="";const w=n.patch;w&&(y=w instanceof Function?w(y):z(y,w,!0,!1).newDocument),n.formatLocale&&QZ.formatLocale(n.formatLocale),n.timeFormatLocale&&QZ.timeFormatLocale(n.timeFormatLocale);const _=QZ.parse(y,"vega-lite"===g?{}:c),C=new QZ.View(_,{loader:r,logLevel:p,renderer:f});if(!1!==n.tooltip){let t;t="function"==typeof n.tooltip?n.tooltip:new XZ(!0===n.tooltip?{}:n.tooltip).call,C.tooltip(t)}let k,{hover:S}=n;if(void 0===S&&(S="vega"===g),S){const{hoverSet:t,updateSet:e}="boolean"==typeof S?{}:S;C.hover(t,e)}if(n&&(null!=n.width&&C.width(n.width),null!=n.height&&C.height(n.height),null!=n.padding&&C.padding(n.padding)),yield C.initialize(t).runAsync(),!1!==h){let t=v;if(!1!==n.defaultStyle){const e=document.createElement("details");e.title=d.CLICK_TO_VIEW_ACTIONS,v.append(e),t=e;const n=document.createElement("summary");n.innerHTML='\n<svg viewBox="0 0 16 16" fill="currentColor" stroke="none" stroke-width="1" stroke-linecap="round" stroke-linejoin="round">\n  <circle r="2" cy="8" cx="2"></circle>\n  <circle r="2" cy="8" cx="8"></circle>\n  <circle r="2" cy="8" cx="14"></circle>\n</svg>',e.append(n),k=t=>{e.contains(t.target)||e.removeAttribute("open")},document.addEventListener("click",k)}const r=document.createElement("div");if(t.append(r),r.classList.add("vega-actions"),!0===h||!1!==h.export)for(const e of["svg","png"])if(!0===h||!0===h.export||h.export[e]){const t=d[e.toUpperCase()+"_ACTION"],i=document.createElement("a");i.text=t,i.href="#",i.target="_blank",i.download=`${m}.${e}`,i.addEventListener("mousedown",(function(t){return Object(x.a)(this,void 0,void 0,(function*(){t.preventDefault();const r=yield C.toImageURL(e,n.scaleFactor);this.href=r}))})),r.append(i)}if(!0===h||!1!==h.source){const t=document.createElement("a");t.text=d.SOURCE_ACTION,t.href="#",t.addEventListener("click",(function(t){var r,i;aQ(Q()(e),null!==(r=n.sourceHeader)&&void 0!==r?r:"",null!==(i=n.sourceFooter)&&void 0!==i?i:"",g),t.preventDefault()})),r.append(t)}if("vega-lite"===g&&(!0===h||!1!==h.compiled)){const t=document.createElement("a");t.text=d.COMPILED_ACTION,t.href="#",t.addEventListener("click",(function(t){var e,r;aQ(Q()(y),null!==(e=n.sourceHeader)&&void 0!==e?e:"",null!==(r=n.sourceFooter)&&void 0!==r?r:"","vega"),t.preventDefault()})),r.append(t)}if(!0===h||!1!==h.editor){const t=null!==(l=n.editorUrl)&&void 0!==l?l:"https://vega.github.io/editor/",i=document.createElement("a");i.text=d.EDITOR_ACTION,i.href="#",i.addEventListener("click",(function(n){!function(t,e,n){const r=t.open(e),{origin:i}=new URL(e);let o=40;t.addEventListener("message",(function e(n){n.source===r&&(o=0,t.removeEventListener("message",e,!1))}),!1),setTimeout((function t(){o<=0||(r.postMessage(n,i),setTimeout(t,250),o-=1)}),250)}(window,t,{config:c,mode:g,renderer:f,spec:Q()(e)}),n.preventDefault()})),r.append(i)}}return{view:C,spec:e,vgSpec:y,finalize:function(){k&&document.removeEventListener("click",k),C.finalize()}}}))}(t,u,h,a)}))}function lQ(t,e){var n;return Object(x.a)(this,void 0,void 0,(function*(){const r=ve(t.config)?JSON.parse(yield e.load(t.config)):null!==(n=t.config)&&void 0!==n?n:{},i=ve(t.patch)?JSON.parse(yield e.load(t.patch)):t.patch;return Object.assign(Object.assign(Object.assign({},t),i?{patch:i}:{}),r?{config:r}:{})}))}},"ex/Z":function(t,e,n){class r{constructor(t,e){if(e&&"object"==typeof e||(e={loose:!!e,includePrerelease:!1}),t instanceof r)return t.loose===!!e.loose&&t.includePrerelease===!!e.includePrerelease?t:new r(t.raw,e);if(t instanceof i)return this.raw=t.value,this.set=[[t]],this.format(),this;if(this.options=e,this.loose=!!e.loose,this.includePrerelease=!!e.includePrerelease,this.raw=t,this.set=t.split(/\s*\|\|\s*/).map(t=>this.parseRange(t.trim())).filter(t=>t.length),!this.set.length)throw new TypeError("Invalid SemVer Range: "+t);this.format()}format(){return this.range=this.set.map(t=>t.join(" ").trim()).join("||").trim(),this.range}toString(){return this.range}parseRange(t){const e=this.options.loose;t=(t=t.trim()).replace(e?s[u.HYPHENRANGELOOSE]:s[u.HYPHENRANGE],C(this.options.includePrerelease)),o("hyphen replace",t),t=t.replace(s[u.COMPARATORTRIM],l),o("comparator trim",t,s[u.COMPARATORTRIM]),t=(t=(t=t.replace(s[u.TILDETRIM],c)).replace(s[u.CARETTRIM],h)).split(/\s+/).join(" ");const n=e?s[u.COMPARATORLOOSE]:s[u.COMPARATOR];return t.split(" ").map(t=>f(t,this.options)).join(" ").split(/\s+/).map(t=>_(t,this.options)).filter(this.options.loose?t=>!!t.match(n):()=>!0).map(t=>new i(t,this.options))}intersects(t,e){if(!(t instanceof r))throw new TypeError("a Range is required");return this.set.some(n=>d(n,e)&&t.set.some(t=>d(t,e)&&n.every(n=>t.every(t=>n.intersects(t,e)))))}test(t){if(!t)return!1;if("string"==typeof t)try{t=new a(t,this.options)}catch(e){return!1}for(let n=0;n<this.set.length;n++)if(k(this.set[n],t,this.options))return!0;return!1}}t.exports=r;const i=n("vwDW"),o=n("DXxi"),a=n("3wIk"),{re:s,t:u,comparatorTrimReplace:l,tildeTrimReplace:c,caretTrimReplace:h}=n("IsDc"),d=(t,e)=>{let n=!0;const r=t.slice();let i=r.pop();for(;n&&r.length;)n=r.every(t=>i.intersects(t,e)),i=r.pop();return n},f=(t,e)=>(o("comp",t,e),t=y(t,e),o("caret",t),t=m(t,e),o("tildes",t),t=b(t,e),o("xrange",t),t=x(t,e),o("stars",t),t),p=t=>!t||"x"===t.toLowerCase()||"*"===t,m=(t,e)=>t.trim().split(/\s+/).map(t=>g(t,e)).join(" "),g=(t,e)=>t.replace(e.loose?s[u.TILDELOOSE]:s[u.TILDE],(e,n,r,i,a)=>{let s;return o("tilde",t,e,n,r,i,a),p(n)?s="":p(r)?s=`>=${n}.0.0 <${+n+1}.0.0-0`:p(i)?s=`>=${n}.${r}.0 <${n}.${+r+1}.0-0`:a?(o("replaceTilde pr",a),s=`>=${n}.${r}.${i}-${a} <${n}.${+r+1}.0-0`):s=`>=${n}.${r}.${i} <${n}.${+r+1}.0-0`,o("tilde return",s),s}),y=(t,e)=>t.trim().split(/\s+/).map(t=>v(t,e)).join(" "),v=(t,e)=>{o("caret",t,e);const n=e.includePrerelease?"-0":"";return t.replace(e.loose?s[u.CARETLOOSE]:s[u.CARET],(e,r,i,a,s)=>{let u;return o("caret",t,e,r,i,a,s),p(r)?u="":p(i)?u=`>=${r}.0.0${n} <${+r+1}.0.0-0`:p(a)?u="0"===r?`>=${r}.${i}.0${n} <${r}.${+i+1}.0-0`:`>=${r}.${i}.0${n} <${+r+1}.0.0-0`:s?(o("replaceCaret pr",s),u="0"===r?"0"===i?`>=${r}.${i}.${a}-${s} <${r}.${i}.${+a+1}-0`:`>=${r}.${i}.${a}-${s} <${r}.${+i+1}.0-0`:`>=${r}.${i}.${a}-${s} <${+r+1}.0.0-0`):(o("no pr"),u="0"===r?"0"===i?`>=${r}.${i}.${a}${n} <${r}.${i}.${+a+1}-0`:`>=${r}.${i}.${a}${n} <${r}.${+i+1}.0-0`:`>=${r}.${i}.${a} <${+r+1}.0.0-0`),o("caret return",u),u})},b=(t,e)=>(o("replaceXRanges",t,e),t.split(/\s+/).map(t=>w(t,e)).join(" ")),w=(t,e)=>(t=t.trim()).replace(e.loose?s[u.XRANGELOOSE]:s[u.XRANGE],(n,r,i,a,s,u)=>{o("xRange",t,n,r,i,a,s,u);const l=p(i),c=l||p(a),h=c||p(s);return"="===r&&h&&(r=""),u=e.includePrerelease?"-0":"",l?n=">"===r||"<"===r?"<0.0.0-0":"*":r&&h?(c&&(a=0),s=0,">"===r?(r=">=",c?(i=+i+1,a=0,s=0):(a=+a+1,s=0)):"<="===r&&(r="<",c?i=+i+1:a=+a+1),"<"===r&&(u="-0"),n=`${r+i}.${a}.${s}${u}`):c?n=`>=${i}.0.0${u} <${+i+1}.0.0-0`:h&&(n=`>=${i}.${a}.0${u} <${i}.${+a+1}.0-0`),o("xRange return",n),n}),x=(t,e)=>(o("replaceStars",t,e),t.trim().replace(s[u.STAR],"")),_=(t,e)=>(o("replaceGTE0",t,e),t.trim().replace(s[e.includePrerelease?u.GTE0PRE:u.GTE0],"")),C=t=>(e,n,r,i,o,a,s,u,l,c,h,d,f)=>`${n=p(r)?"":p(i)?`>=${r}.0.0${t?"-0":""}`:p(o)?`>=${r}.${i}.0${t?"-0":""}`:a?">="+n:`>=${n}${t?"-0":""}`} ${u=p(l)?"":p(c)?`<${+l+1}.0.0-0`:p(h)?`<${l}.${+c+1}.0-0`:d?`<=${l}.${c}.${h}-${d}`:t?`<${l}.${c}.${+h+1}-0`:"<="+u}`.trim(),k=(t,e,n)=>{for(let r=0;r<t.length;r++)if(!t[r].test(e))return!1;if(e.prerelease.length&&!n.includePrerelease){for(let n=0;n<t.length;n++)if(o(t[n].semver),t[n].semver!==i.ANY&&t[n].semver.prerelease.length>0){const r=t[n].semver;if(r.major===e.major&&r.minor===e.minor&&r.patch===e.patch)return!0}return!1}return!0}},fl4C:function(t,e,n){var r;!function(i,o){var a=function(t,e){var n=t.document,r=Array.prototype.slice,i=t.requestAnimationFrame||t.mozRequestAnimationFrame||t.webkitRequestAnimationFrame||t.msRequestAnimationFrame||function(t){return setTimeout(t,1e3/60)};return function(){var t={dialRadius:40,dialStartAngle:135,dialEndAngle:45,value:0,max:100,min:0,valueDialClass:"value",valueClass:"value-text",dialClass:"dial",gaugeClass:"gauge",showValue:!0,gaugeColor:null,label:function(t){return Math.round(t)}};function e(t,e,r){var i=n.createElementNS("http://www.w3.org/2000/svg",t);for(var o in e)i.setAttribute(o,e[o]);return r&&r.forEach((function(t){i.appendChild(t)})),i}function o(t,e){return t*e/100}function a(t,e,n){var r=Number(t);return r>n?n:r<e?e:r}function s(t,e,n,r){var i=r*Math.PI/180;return{x:Math.round(1e3*(t+n*Math.cos(i)))/1e3,y:Math.round(1e3*(e+n*Math.sin(i)))/1e3}}return function(n,u){var l,c,h,d=n,f=(u=function(){var t=arguments[0],e=r.call(arguments,1);return e.forEach((function(e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})),t}({},t,u)).max,p=u.min,m=a(u.value,p,f),g=u.dialRadius,y=u.showValue,v=u.dialStartAngle,b=u.dialEndAngle,w=u.valueDialClass,x=u.valueClass,_=u.dialClass,C=u.gaugeClass,k=u.color,S=u.label,E=u.viewBox;if(v<b){console.log("WARN! startAngle < endAngle, Swapping");var O=v;v=b,b=O}function A(t,e,n,r){var i=function(t,e,n){return{end:s(50,50,t,n),start:s(50,50,t,e)}}(t,e,n),o=i.start,a=i.end;return["M",o.x,o.y,"A",t,t,0,void 0===r?1:r,1,a.x,a.y].join(" ")}function N(t,e){var n=o(function(t,e,n){return 100*(t-e)/(n-e)}(t,p,f),360-Math.abs(v-b)),r=n<=180?0:1;y&&(l.textContent=S.call(u,t)),c.setAttribute("d",A(g,v,n+v,r))}function T(t,e){var n=k(t),r="stroke "+1e3*e+"ms ease";c.style=["stroke: "+n,"-webkit-transition: "+r,"-moz-transition: "+r,"transition: "+r].join(";")}return h={setMaxValue:function(t){f=t},setValue:function(t){m=a(t,p,f),k&&T(m,0),N(m)},setValueAnimated:function(t,e){var n,r,o,s,u,l,c,h=m;h!==(m=a(t,p,f))&&(k&&T(m,e),r=1,o=60*(n={start:h||0,end:m,duration:e||1,step:function(t,e){N(t)}}).duration,u=n.end-(s=n.start||0),l=n.step,c=n.easing||function(t){return(t/=.5)<1?.5*Math.pow(t,3):.5*(Math.pow(t-2,3)+2)},i((function t(){var e=r/o,n=u*c(e)+s;l(n,r),r+=1,e<1&&i(t)})))},getValue:function(){return m}},function(t){l=e("text",{x:50,y:50,fill:"#999",class:x,"font-size":"100%","font-family":"sans-serif","font-weight":"normal","text-anchor":"middle","alignment-baseline":"middle","dominant-baseline":"central"}),c=e("path",{class:w,fill:"none",stroke:"#666","stroke-width":2.5,d:A(g,v,v)});var n=o(100,360-Math.abs(v-b)),r=e("svg",{viewBox:E||"0 0 100 100",class:C},[e("path",{class:_,fill:"none",stroke:"#eee","stroke-width":2,d:A(g,v,b,n<=180?0:1)}),l,c]);t.appendChild(r)}(d),h.setValue(m),h}}()}(i);void 0===(r=(function(){return a}).call(e,n,e,t))||(t.exports=r)}("undefined"==typeof window?this:window)},gatG:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t){var e=/\/schema\/([\w-]+)\/([\w\.\-]+)\.json$/g.exec(t).slice(1,3);return{library:e[0],version:e[1]}}},gqzR:function(t,e,n){const r=n("Ybu3");t.exports=(t,e)=>{const n=r(t,e);return n?n.version:null}},h1ZQ:function(t,e,n){"use strict";var r=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(e){o(e)}}function s(t){try{u(r.throw(t))}catch(e){o(e)}}function u(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(a,s)}u((r=r.apply(t,e||[])).next())}))},i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const o=n("rWgG"),a=i(n("etOl")),s=n("Ewl0"),u=n("QUk2"),l=n("Vinz"),c={maxBins:12,fontSize:11};e.histogram=function(t,e,n={}){return r(this,void 0,void 0,(function*(){const r=function(t){if(null==t.length)throw new Error("input data must be an array");if(0===t.length)return[];if("object"==typeof t[0]){if(null==t[0].value)throw new Error("input data must have a value field");return t}{const e=Array(t.length);for(let n=0;n<t.length;n++)e[n]={value:t[n]};return e}}(e),i=Object.assign({},c,n),h=s.subSurface(t,"histogram");if(!1!==n.stats){const e=s.subSurface(t,"stats",{prepend:!0});let a;a=n.stats?n.stats:u.arrayStats(r.map(t=>t.value)),function(t,e,n){const r=o.format(",.4~f"),i=o.format(".4~p"),a=[],s=[];if(null!=t.numVals&&(a.push("Num Vals"),s.push(r(t.numVals))),null!=t.min&&(a.push("Min"),s.push(r(t.min))),null!=t.max&&(a.push("Max"),s.push(r(t.max))),null!=t.numZeros){a.push("# Zeros");let e="";t.numVals&&(e=t.numZeros>0?`(${i(t.numZeros/t.numVals)})`:""),s.push(`${r(t.numZeros)} ${e}`)}if(null!=t.numNans){a.push("# NaNs");let e="";t.numVals&&(e=t.numNans>0?`(${i(t.numNans/t.numVals)})`:""),s.push(`${r(t.numNans)} ${e}`)}if(null!=t.numInfs){a.push("# Infinity");let e="";t.numVals&&(e=t.numInfs>0?`(${i(t.numInfs/t.numVals)})`:""),s.push(`${r(t.numInfs)} ${e}`)}l.table(e,{headers:a,values:[s]},n)}(a,e,{fontSize:i.fontSize})}if(0===r.length)return;const d=[];for(let t=0;t<r.length;t++){const e=r[t].value;null!=e&&isFinite(e)&&d.push(r[t])}const f={width:i.width||s.getDefaultWidth(h),height:i.height||s.getDefaultHeight(h),padding:0,autosize:{type:"fit",contains:"padding",resize:!0},data:{values:d},mark:{type:"bar",tooltip:!0},config:{axis:{labelFontSize:i.fontSize,titleFontSize:i.fontSize},text:{fontSize:i.fontSize},legend:{labelFontSize:i.fontSize,titleFontSize:i.fontSize}},encoding:{x:{bin:{maxbins:i.maxBins},field:"value",type:"quantitative"},y:{aggregate:"count",type:"quantitative"},color:{value:i.color||"#001B44"}}};return a.default(h,f,{actions:!1,mode:"vega-lite",defaultStyle:!1})}))}},hAya:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e){if("position"===t&&"sticky"===e)return["-webkit-sticky","sticky"]},t.exports=e.default},homf:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e){if("cursor"===t&&i.hasOwnProperty(e))return r.map((function(t){return t+e}))};var r=["-webkit-","-moz-",""],i={"zoom-in":!0,"zoom-out":!0,grab:!0,grabbing:!0};t.exports=e.default},iEBQ:function(t,e,n){const r=n("3wIk");t.exports=(t,e,n)=>{const i=new r(t,n),o=new r(e,n);return i.compare(o)||i.compareBuild(o)}},j0pM:function(t,e,n){const r=n("ex/Z");t.exports=(t,e)=>new r(t,e).set.map(t=>t.map(t=>t.value).join(" ").trim().split(" "))},jke5:function(t,e,n){"use strict";var r=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(e){o(e)}}function s(t){try{u(r.throw(t))}catch(e){o(e)}}function u(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(a,s)}u((r=r.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0});const i=n("t+T0"),o=n("LwnN");e.getDrawArea=function(t){if(t instanceof HTMLElement)return t;if(i.isSurface(t))return t.drawArea;if(i.isSurfaceInfo(t))return o.visor().surface({name:t.name,tab:t.tab,styles:t.styles}).drawArea;throw new Error("Not a drawable")},e.shallowEquals=function(t,e){const n=Object.getOwnPropertyNames(t),r=Object.getOwnPropertyNames(e);if(n.length!==r.length)return!1;for(let i=0;i<n.length;i++){const r=n[i];if(t[r]!==e[r])return!1}return!0},e.nextFrame=function(){return r(this,void 0,void 0,(function*(){yield new Promise(t=>requestAnimationFrame(t))}))}},lYj8:function(t,e,n){const r=n("iEBQ");t.exports=(t,e)=>t.sort((t,n)=>r(t,n,e))},lZ34:function(t,e,n){"use strict";var r=n("NgHg"),i=/^-ms-/;t.exports=function(t){return r(t.replace(i,"ms-"))}},lkeM:function(t,e,n){const r=n("3wIk"),i=n("ex/Z"),o=n("7sNm");t.exports=(t,e)=>{t=new i(t,e);let n=new r("0.0.0");if(t.test(n))return n;if(n=new r("0.0.0-0"),t.test(n))return n;n=null;for(let i=0;i<t.set.length;++i)t.set[i].forEach(t=>{const e=new r(t.semver.version);switch(t.operator){case">":0===e.prerelease.length?e.patch++:e.prerelease.push(0),e.raw=e.format();case"":case">=":n&&!o(n,e)||(n=e);break;case"<":case"<=":break;default:throw new Error("Unexpected operation: "+t.operator)}});return n&&t.test(n)?n:null}},mrSG:function(t,e,n){"use strict";function r(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n}function i(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(e){o(e)}}function s(t){try{u(r.throw(t))}catch(e){o(e)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))}n.d(e,"b",(function(){return r})),n.d(e,"a",(function(){return i}))},msJK:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.processStyleName=void 0,e.createMarkupForStyles=function(t,e){var n="";for(var i in t){var o=0===i.indexOf("--");if(t.hasOwnProperty(i)&&"label"!==i){var a=t[i];null!=a&&(o?n+=i+":"+a+";":(n+=s(i)+":",n+=(0,r.default)(i,a,e)+";"))}}return n||null},a(n("lZ34"));var r=a(n("0mDd")),i=a(n("+8Ar")),o=a(n("rWXM"));function a(t){return t&&t.__esModule?t:{default:t}}a(n("2mcs"));var s=e.processStyleName=(0,o.default)(i.default)},oBeb:function(t,e,n){const r=n("Ybu3");t.exports=(t,e)=>{const n=r(t.trim().replace(/^[=v]+/,""),e);return n?n.version:null}},oh0K:function(t,e,n){const r=n("8GxW");t.exports=(t,e,n)=>r(e,t,n)},ohE5:function(t,e,n){"use strict";function r(t){return function(){return t}}var i=function(){};i.thatReturns=r,i.thatReturnsFalse=r(!1),i.thatReturnsTrue=r(!0),i.thatReturnsNull=r(null),i.thatReturnsThis=function(){return this},i.thatReturnsArgument=function(t){return t},t.exports=i},ouyH:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=n("ML/J"),i=n("Ad6o");class o extends r.Component{componentDidMount(){const{name:t,tab:e}=this.props;this.props.registerSurface(t,e,this)}componentDidUpdate(){return!1}render(){const{name:t,visible:e,styles:n}=this.props,a=Object.assign({},o.defaultStyles,n),{width:s,height:u}=a;let{maxHeight:l,maxWidth:c}=a;l=u===o.defaultStyles.height?l:u,c=s===o.defaultStyles.width?c:s;const h=i.css({display:e?"block":"none",backgroundColor:"white",marginTop:"10px",marginBottom:"10px",boxShadow:"0 0 6px -3px #777",padding:"10px !important",height:u,width:s,maxHeight:l,maxWidth:c,overflow:"auto"}),d=i.css({backgroundColor:"white",boxSizing:"border-box",borderBottom:"1px solid #357EDD",lineHeight:"2em",marginBottom:"20px",fontWeight:"600",textAlign:"center"}),f=i.css({boxSizing:"border-box"});return r.h("div",{className:h+" tf-surface",ref:t=>this.container=t,"data-visible":e},r.h("div",{className:d+" tf-label",ref:t=>this.label=t},t),r.h("div",{className:f+" tf-draw-area",ref:t=>this.drawArea=t}))}}o.defaultStyles={maxWidth:"550px",maxHeight:"580px",height:"auto",width:"auto"},e.SurfaceComponent=o},qHvB:function(t){t.exports=JSON.parse('{"name":"vega-lite","author":"Dominik Moritz, Kanit \\"Ham\\" Wongsuphasawat, Arvind Satyanarayan, Jeffrey Heer","version":"4.13.1","collaborators":["Kanit Wongsuphasawat (http://kanitw.yellowpigz.com)","Dominik Moritz (https://www.domoritz.de)","Arvind Satyanarayan (https://arvindsatya.com)","Jeffrey Heer (https://jheer.org)"],"homepage":"https://vega.github.io/vega-lite/","description":"Vega-Lite is a concise high-level language for interactive visualization.","main":"build/vega-lite.js","unpkg":"build/vega-lite.min.js","jsdelivr":"build/vega-lite.min.js","module":"build/src/index","types":"build/src/index.d.ts","bin":{"vl2png":"./bin/vl2png","vl2svg":"./bin/vl2svg","vl2pdf":"./bin/vl2pdf","vl2vg":"./bin/vl2vg"},"directories":{"test":"test"},"scripts":{"changelog":"conventional-changelog -p angular -r 2","build":"yarn build:only","build:only":"yarn tsc:src && rollup -c","postbuild":"terser build/vega-lite.js -cm --source-map content=build/vega-lite.js.map,filename=build/vega-lite.min.js.map -o build/vega-lite.min.js && yarn schema && babel build/vega-lite.js --out-dir build-es5 --config-file ./babel.config.js","prebuild:examples":"yarn build:only","build:examples":"yarn data && TZ=America/Los_Angeles scripts/build-examples.sh","prebuild:examples-full":"yarn build:only","build:examples-full":"TZ=America/Los_Angeles scripts/build-examples.sh 1","build:example":"TZ=America/Los_Angeles scripts/build-example.sh","build:toc":"yarn build:jekyll && scripts/generate-toc","build:site":"yarn tsc:site && rollup -c site/rollup.config.js","build:jekyll":"pushd site && bundle exec jekyll build -q && popd","build:versions":"scripts/update-version.sh","clean":"find build ! -name \'vega-lite-schema.json\' -type f -delete && rm -rf site/data/* && rm -f examples/compiled/*.png && find site/examples ! -name \'index.md\' ! -name \'data\' -type f -delete","predeploy:site":"yarn presite","deploy:site":"gh-pages -d site","data":"rsync -r node_modules/vega-datasets/data/* site/data","schema":"mkdir -p build && ts-json-schema-generator -f tsconfig.json -p src/index.ts -t TopLevelSpec --no-type-check --no-ref-encode > build/vega-lite-schema.json && yarn renameschema && cp build/vega-lite-schema.json site/_data/","renameschema":"scripts/rename-schema.sh","presite":"yarn data && yarn schema && yarn build:site && yarn build:versions && scripts/create-example-pages.sh","site":"pushd site && bundle exec jekyll serve -I -l && popd","tsc:src":"tsc -b src/tsconfig.src.json","tsc:site":"tsc -b site/tsconfig.site.json","prettierbase":"prettier \'**/*.{md,css,yml}\'","eslintbase":"eslint .","format":"yarn eslintbase --fix && yarn prettierbase --write","lint":"yarn eslintbase && yarn prettierbase --check","test":"jest test/ && yarn lint && yarn schema && jest examples/ && yarn test:runtime","test:inspect":"node --inspect-brk ./node_modules/.bin/jest --runInBand test","test:runtime":"TZ=America/Los_Angeles jest test-runtime/","test:runtime:generate":"yarn build:only && rm -Rf test-runtime/resources && VL_GENERATE_TESTS=true yarn test:runtime","watch:build":"yarn build:only && concurrently --kill-others -n Typescript,Rollup \'yarn tsc:src -w\' \'rollup -c -w\'","watch:site":"concurrently --kill-others -n Typescript,Rollup \'yarn tsc:site -w\' \'rollup -c site/rollup.config.js -w\'","watch:test":"jest --watch"},"repository":{"type":"git","url":"https://github.com/vega/vega-lite.git"},"license":"BSD-3-Clause","bugs":{"url":"https://github.com/vega/vega-lite/issues"},"devDependencies":{"@babel/cli":"^7.10.1","@babel/core":"^7.10.1","@babel/preset-env":"^7.10.1","@rollup/plugin-commonjs":"12.0.0","@rollup/plugin-json":"^4.0.3","@rollup/plugin-node-resolve":"^8.0.0","@types/chai":"^4.2.11","@types/d3":"^5.7.2","@types/jest":"^25.2.3","@types/mkdirp":"^1.0.0","@types/puppeteer":"^3.0.0","@typescript-eslint/eslint-plugin":"^3.0.2","@typescript-eslint/parser":"^3.0.2","ajv":"^6.12.2","chai":"^4.2.0","cheerio":"^1.0.0-rc.3","codecov":"^3.7.0","concurrently":"^5.2.0","conventional-changelog-cli":"^2.0.34","d3":"^5.16.0","eslint":"^7.1.0","eslint-config-prettier":"^6.11.0","eslint-plugin-jest":"^23.13.2","eslint-plugin-prettier":"^3.1.3","gh-pages":"^2.2.0","highlight.js":"^10.0.3","http-server":"^0.12.3","jest":"^26.0.1","jest-puppeteer":"^4.4.0","mkdirp":"^1.0.4","prettier":"^2.0.5","puppeteer":"^3.1.0","rollup":"^2.11.0","rollup-plugin-sourcemaps":"^0.6.2","rollup-plugin-terser":"^6.1.0","svg2png-many":"^0.0.7","terser":"^4.7.0","ts-jest":"^26.0.0","ts-json-schema-generator":"^0.68.1","typescript":"~3.9.3","vega-cli":"^5.12.1","vega-datasets":"^1.30.2","vega-embed":"^6.8.0","vega-tooltip":"^0.23.0","vega-typings":"^0.17.0","yaml-front-matter":"^4.1.0"},"dependencies":{"@types/clone":"~0.1.30","@types/fast-json-stable-stringify":"^2.0.0","array-flat-polyfill":"^1.0.1","clone":"~2.1.2","fast-deep-equal":"~3.1.1","fast-json-stable-stringify":"~2.1.0","json-stringify-pretty-compact":"~2.0.0","tslib":"~2.0.0","vega-event-selector":"~2.0.3","vega-expression":"~2.6.5","vega-util":"~1.14.0","yargs":"~15.3.1"},"peerDependencies":{"vega":"^5.12.1"},"jest":{"preset":"jest-puppeteer","transform":{"^.+\\\\.tsx?$":"ts-jest"},"testRegex":"(/__tests__/.*|(\\\\.|/)(test|spec))\\\\.(jsx?|tsx?)$","moduleFileExtensions":["ts","tsx","js","jsx","json","node"],"testPathIgnorePatterns":["<rootDir>/node_modules","<rootDir>/build","<rootDir>/_site","<rootDir>/src"],"coverageDirectory":"./coverage/","collectCoverage":false}}')},qvkj:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e){if("string"==typeof e&&!(0,i.default)(e)&&e.indexOf("cross-fade(")>-1)return o.map((function(t){return e.replace(/cross-fade\(/g,t+"cross-fade(")}))};var r,i=(r=n("sUt/"))&&r.__esModule?r:{default:r},o=["-webkit-",""];t.exports=e.default},"qw/d":function(t){t.exports=JSON.parse('{"name":"vega-themes","version":"2.8.5","description":"Themes for stylized Vega and Vega-Lite visualizations.","keywords":["vega","vega-lite","themes","style"],"license":"BSD-3-Clause","author":{"name":"UW Interactive Data Lab","url":"https://idl.cs.washington.edu"},"contributors":[{"name":"Emily Gu","url":"https://github.com/emilygu"},{"name":"Arvind Satyanarayan","url":"http://arvindsatya.com"},{"name":"Jeffrey Heer","url":"https://idl.cs.washington.edu"},{"name":"Dominik Moritz","url":"https://www.domoritz.de"}],"main":"build/vega-themes.js","module":"build/src/index.js","unpkg":"build/vega-themes.min.js","jsdelivr":"build/vega-themes.min.js","typings":"build/src/index.d.ts","repository":{"type":"git","url":"https://github.com/vega/vega-themes.git"},"scripts":{"prepare":"beemo create-config --silent","clean":"rm -rf build examples/build","prettierbase":"beemo prettier \'examples/*.{html,scss,css}\'","eslintbase":"beemo eslint .","format":"yarn eslintbase --fix && yarn prettierbase --write","lint":"yarn eslintbase && yarn prettierbase --check","prebuild":"mkdir -p build","build":"tsc && rollup -c","postbuild":"terser build/vega-themes.js -cm > build/vega-themes.min.js","deploy:gh":"yarn build && mkdir -p examples/build && rsync -r build/* examples/build && gh-pages -d examples","prepublishOnly":"yarn clean && yarn build","preversion":"yarn lint","serve":"browser-sync start -s -f build examples --serveStatic examples","start":"yarn build && concurrently --kill-others -n Server,Typescript,Rollup \'yarn serve\' \'tsc -w\' \'rollup -c -w\'"},"devDependencies":{"@rollup/plugin-json":"^4.1.0","browser-sync":"^2.26.7","concurrently":"^5.2.0","gh-pages":"^3.1.0","rollup":"^2.21.0","terser":"^4.8.0","typescript":"^3.9.6","vega":"^5.10.0","vega-lite":"^4.8.1","vega-lite-dev-config":"^0.11.8"},"peerDependencies":{"vega":"*","vega-lite":"*"},"beemo":{"module":"vega-lite-dev-config","drivers":["prettier","eslint"]}}')},rWXM:function(t,e,n){"use strict";t.exports=function(t){var e={};return function(n){return e.hasOwnProperty(n)||(e[n]=t.call(this,n)),e[n]}}},rWgG:function(t,e,n){"use strict";n.r(e),n.d(e,"formatDefaultLocale",(function(){return y})),n.d(e,"format",(function(){return c})),n.d(e,"formatPrefix",(function(){return h})),n.d(e,"formatLocale",(function(){return g})),n.d(e,"formatSpecifier",(function(){return a})),n.d(e,"precisionFixed",(function(){return v})),n.d(e,"precisionPrefix",(function(){return b})),n.d(e,"precisionRound",(function(){return w}));var r=function(t,e){if((n=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var n,r=t.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+t.slice(n+1)]},i=function(t){return(t=r(Math.abs(t)))?t[1]:NaN},o=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function a(t){return new s(t)}function s(t){if(!(e=o.exec(t)))throw new Error("invalid format: "+t);var e;this.fill=e[1]||" ",this.align=e[2]||">",this.sign=e[3]||"-",this.symbol=e[4]||"",this.zero=!!e[5],this.width=e[6]&&+e[6],this.comma=!!e[7],this.precision=e[8]&&+e[8].slice(1),this.trim=!!e[9],this.type=e[10]||""}a.prototype=s.prototype,s.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(null==this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(null==this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};var u,l,c,h,d=function(t,e){var n=r(t,e);if(!n)return t+"";var i=n[0],o=n[1];return o<0?"0."+new Array(-o).join("0")+i:i.length>o+1?i.slice(0,o+1)+"."+i.slice(o+1):i+new Array(o-i.length+2).join("0")},f={"%":function(t,e){return(100*t).toFixed(e)},b:function(t){return Math.round(t).toString(2)},c:function(t){return t+""},d:function(t){return Math.round(t).toString(10)},e:function(t,e){return t.toExponential(e)},f:function(t,e){return t.toFixed(e)},g:function(t,e){return t.toPrecision(e)},o:function(t){return Math.round(t).toString(8)},p:function(t,e){return d(100*t,e)},r:d,s:function(t,e){var n=r(t,e);if(!n)return t+"";var i=n[0],o=n[1],a=o-(u=3*Math.max(-8,Math.min(8,Math.floor(o/3))))+1,s=i.length;return a===s?i:a>s?i+new Array(a-s+1).join("0"):a>0?i.slice(0,a)+"."+i.slice(a):"0."+new Array(1-a).join("0")+r(t,Math.max(0,e+a-1))[0]},X:function(t){return Math.round(t).toString(16).toUpperCase()},x:function(t){return Math.round(t).toString(16)}},p=function(t){return t},m=["y","z","a","f","p","n","\xb5","m","","k","M","G","T","P","E","Z","Y"],g=function(t){var e,n,r=t.grouping&&t.thousands?(e=t.grouping,n=t.thousands,function(t,r){for(var i=t.length,o=[],a=0,s=e[0],u=0;i>0&&s>0&&(u+s+1>r&&(s=Math.max(1,r-u)),o.push(t.substring(i-=s,i+s)),!((u+=s+1)>r));)s=e[a=(a+1)%e.length];return o.reverse().join(n)}):p,o=t.currency,s=t.decimal,l=t.numerals?function(t){return function(e){return e.replace(/[0-9]/g,(function(e){return t[+e]}))}}(t.numerals):p,c=t.percent||"%";function h(t){var e=(t=a(t)).fill,n=t.align,i=t.sign,h=t.symbol,d=t.zero,p=t.width,g=t.comma,y=t.precision,v=t.trim,b=t.type;"n"===b?(g=!0,b="g"):f[b]||(null==y&&(y=12),v=!0,b="g"),(d||"0"===e&&"="===n)&&(d=!0,e="0",n="=");var w="$"===h?o[0]:"#"===h&&/[boxX]/.test(b)?"0"+b.toLowerCase():"",x="$"===h?o[1]:/[%p]/.test(b)?c:"",_=f[b],C=/[defgprs%]/.test(b);function k(t){var o,a,c,h=w,f=x;if("c"===b)f=_(t)+f,t="";else{var k=(t=+t)<0;if(t=_(Math.abs(t),y),v&&(t=function(t){t:for(var e,n=t.length,r=1,i=-1;r<n;++r)switch(t[r]){case".":i=e=r;break;case"0":0===i&&(i=r),e=r;break;default:if(i>0){if(!+t[r])break t;i=0}}return i>0?t.slice(0,i)+t.slice(e+1):t}(t)),k&&0==+t&&(k=!1),h=(k?"("===i?i:"-":"-"===i||"("===i?"":i)+h,f=("s"===b?m[8+u/3]:"")+f+(k&&"("===i?")":""),C)for(o=-1,a=t.length;++o<a;)if(48>(c=t.charCodeAt(o))||c>57){f=(46===c?s+t.slice(o+1):t.slice(o))+f,t=t.slice(0,o);break}}g&&!d&&(t=r(t,1/0));var S=h.length+t.length+f.length,E=S<p?new Array(p-S+1).join(e):"";switch(g&&d&&(t=r(E+t,E.length?p-f.length:1/0),E=""),n){case"<":t=h+t+f+E;break;case"=":t=h+E+t+f;break;case"^":t=E.slice(0,S=E.length>>1)+h+t+f+E.slice(S);break;default:t=E+h+t+f}return l(t)}return y=null==y?6:/[gprs]/.test(b)?Math.max(1,Math.min(21,y)):Math.max(0,Math.min(20,y)),k.toString=function(){return t+""},k}return{format:h,formatPrefix:function(t,e){var n=h(((t=a(t)).type="f",t)),r=3*Math.max(-8,Math.min(8,Math.floor(i(e)/3))),o=Math.pow(10,-r),s=m[8+r/3];return function(t){return n(o*t)+s}}}};function y(t){return l=g(t),c=l.format,h=l.formatPrefix,l}y({decimal:".",thousands:",",grouping:[3],currency:["$",""]});var v=function(t){return Math.max(0,-i(Math.abs(t)))},b=function(t,e){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(i(e)/3)))-i(Math.abs(t)))},w=function(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,i(e)-i(t))+1}},rtRu:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=n("ML/J"),i=n("Ad6o"),o=n("ouyH"),a=n("EzSE");class s extends r.Component{static render(t,e,n){return r.render(r.h(s,Object.assign({},n)),t,e)}constructor(t){super(t),this.surfaces=new Map,this.state={isOpen:null==t.startOpen||t.startOpen,isFullscreen:!1,activeTab:null,tabs:new Set},this.keyHandler=this.keyHandler.bind(this)}close(){this.setState({isOpen:!1})}open(){this.setState({isOpen:!0})}toggle(){this.setState({isOpen:!this.state.isOpen})}toggleFullScreen(){this.setState({isFullscreen:!this.state.isFullscreen})}isOpen(){return this.state.isOpen}isFullscreen(){return this.state.isFullscreen}getSurface(t,e){const n=this.surfaceId(t,e);let r;if(!this.surfaces.has(n))throw Error("Surface not found with id: "+n);return r=this.surfaces.get(n),{container:r.container,label:r.label,drawArea:r.drawArea}}bindKeys(){document.addEventListener("keydown",this.keyHandler,!1)}unbindKeys(){document.removeEventListener("keydown",this.keyHandler)}surfaceId(t,e){return t+e}setTabs(t){const e=t.map(t=>t.tab),n=this.state.tabs;let r;for(const i of e)n.has(i)||(n.add(i),r=i);null!=r&&this.setState({tabs:n,activeTab:r})}getTabs(){return this.state.tabs}registerSurface(t,e,n){const r=this.surfaceId(t,e);this.surfaces.set(r,n)}keyHandler(t){192===t.keyCode&&(t.shiftKey?this.toggleFullScreen():this.toggle())}setActiveTab(t){this.setState({activeTab:t})}componentDidMount(){this.bindKeys()}componentWillMount(){this.setTabs(this.props.surfaceList)}componentWillReceiveProps(t){this.setTabs(t.surfaceList)}render(){const{isOpen:t,isFullscreen:e,activeTab:n}=this.state,{surfaceList:s}=this.props,l=Array.from(this.getTabs().values()),c=e?"90vw":"550px",h=i.css({width:c,height:"100%",backgroundColor:"#fafafa",boxSizing:"border-box",padding:"10px",position:"fixed",top:"0px",transition:"right 0.5s cubic-bezier(0.645, 0.045, 0.355, 1), width 0.5s cubic-bezier(0.645, 0.045, 0.355, 1)",boxShadow:"0 2px 5px rgba(0, 0, 0, 0.12), 0 2px 5px rgba(0, 0, 0, 0.24)",overflow:"auto",fontFamily:"sans-serif",fontSize:"14px",zIndex:1e3}),d=i.css({right:"0"}),f=i.css({right:`calc(-${c} - 10px)`}),p=t?d:f,m=i.css({});return r.h("div",{className:`${h} ${p} visor`,"data-isopen":t,"data-isfullscreen":e},r.h(u,{fullScreenHandler:this.toggleFullScreen.bind(this),closeHandler:this.close.bind(this),isFullScreen:e}),r.h(a.Tabs,{tabNames:l,activeTab:n,handleClick:this.setActiveTab.bind(this)}),r.h("div",{className:m+" visor-surfaces"},s.map(t=>r.h(o.SurfaceComponent,{key:t.name+t.tab,name:t.name,tab:t.tab,styles:t.styles,registerSurface:this.registerSurface.bind(this),visible:n===t.tab}))))}}function u(t){const{isFullScreen:e,fullScreenHandler:n,closeHandler:o}=t,a=i.css({display:"flex",backgroundColor:"white",border:"1px solid white",padding:"6px",paddingTop:"10px",marginBottom:"10px",borderRadius:"6px",marginTop:"-16px"}),s=i.css({fontSize:".875rem",borderRadius:".25rem",paddingLeft:"1rem",paddingRight:"1rem",paddingTop:".5rem",paddingBottom:".5rem",textDecoration:"none",transition:"color .15s ease-in",color:"#111"}),u=i.css({marginLeft:"auto"});return r.h("div",{className:a+" visor-controls"},r.h("button",{className:""+s,onClick:n},e?"Minimize":"Maximize"),r.h("button",{className:`${s} ${u}`,onClick:o},"Hide"))}e.VisorComponent=s},"sUt/":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t){return"string"==typeof t&&r.test(t)};var r=/-webkit-|-moz-|-ms-/;t.exports=e.default},"t+T0":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.isSurfaceInfo=function(t){return null!=t.name},e.isSurface=function(t){return t.drawArea instanceof HTMLElement}},tNsn:function(t,e,n){"use strict";var r=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(e){o(e)}}function s(t){try{u(r.throw(t))}catch(e){o(e)}}function u(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(a,s)}u((r=r.apply(t,e||[])).next())}))},i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const o=i(n("etOl")),a=n("Ewl0"),s=n("jke5");e.barchart=function(t,e,n={}){return r(this,void 0,void 0,(function*(){const r=s.getDrawArea(t),i=e,c=Object.assign({},u,n);if(l.has(r)){const t=l.get(r);if(s.shallowEquals(c,t.lastOptions)){yield s.nextFrame();const e=t.view,n=e.changeset().remove(()=>!0).insert(i);return void(yield e.change("values",n).runAsync())}}const{xLabel:h,yLabel:d,xType:f,yType:p}=c;let m=null;null!=h&&(m={title:h});let g,y=null;null!=d&&(y={title:d}),g=null!=c.color?Array.isArray(c.color)?{field:"index",type:"nominal",scale:{range:c.color}}:{value:c.color}:{value:"#4C78A0"};const v={width:c.width||a.getDefaultWidth(r),height:c.height||a.getDefaultHeight(r),padding:0,autosize:{type:"fit",contains:"padding",resize:!0},config:{axis:{labelFontSize:c.fontSize,titleFontSize:c.fontSize},text:{fontSize:c.fontSize},legend:{labelFontSize:c.fontSize,titleFontSize:c.fontSize}},data:{values:i,name:"values"},mark:{type:"bar",tooltip:!0},encoding:{x:{field:"index",type:f,axis:m},y:{field:"value",type:p,axis:y},color:g}};yield s.nextFrame();const b=yield o.default(r,v,{actions:!1,mode:"vega-lite",defaultStyle:!1});l.set(r,{view:b.view,lastOptions:c})}))};const u={xLabel:"",yLabel:"",xType:"ordinal",yType:"quantitative",fontSize:11},l=new Map},tduB:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};e.default=function t(e){return Array.isArray(e)?(i=!1,o=[],(n=e).forEach((function(e){var n=t(e);null!==n&&n===e||(i=!0),null!==n&&o.push(n)})),0==o.length?null:i?o:n):function(e){if(function(t){return null==t||!1===t||"object"===(void 0===t?"undefined":r(t))&&0===Object.keys(t).length}(e))return null;if("object"!==(void 0===e?"undefined":r(e)))return e;for(var n={},i=Object.keys(e),o=!1,a=0;a<i.length;a++){var s=e[i[a]],u=t(s);null!==u&&u===s||(o=!0),null!==u&&(n[i[a]]=u)}return 0===Object.keys(n).length?null:o?n:e}(e);var n,i,o}},tgWb:function(t,e,n){"use strict";n.d(e,"a",(function(){return at})),n.d(e,"c",(function(){return st})),n.d(e,"b",(function(){return f})),n.d(e,"d",(function(){return h})),n.d(e,"e",(function(){return ut}));var r,i,o,a=n("Re/O"),s=function(){return(s=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};function u(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(a,s)}u((r=r.apply(t,e||[])).next())}))}function l(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}(o=r||(r={}))[o.DT_INVALID=0]="DT_INVALID",o[o.DT_FLOAT=1]="DT_FLOAT",o[o.DT_DOUBLE=2]="DT_DOUBLE",o[o.DT_INT32=3]="DT_INT32",o[o.DT_UINT8=4]="DT_UINT8",o[o.DT_INT16=5]="DT_INT16",o[o.DT_INT8=6]="DT_INT8",o[o.DT_STRING=7]="DT_STRING",o[o.DT_COMPLEX64=8]="DT_COMPLEX64",o[o.DT_INT64=9]="DT_INT64",o[o.DT_BOOL=10]="DT_BOOL",o[o.DT_QINT8=11]="DT_QINT8",o[o.DT_QUINT8=12]="DT_QUINT8",o[o.DT_QINT32=13]="DT_QINT32",o[o.DT_BFLOAT16=14]="DT_BFLOAT16",o[o.DT_FLOAT_REF=101]="DT_FLOAT_REF",o[o.DT_DOUBLE_REF=102]="DT_DOUBLE_REF",o[o.DT_INT32_REF=103]="DT_INT32_REF",o[o.DT_UINT8_REF=104]="DT_UINT8_REF",o[o.DT_INT16_REF=105]="DT_INT16_REF",o[o.DT_INT8_REF=106]="DT_INT8_REF",o[o.DT_STRING_REF=107]="DT_STRING_REF",o[o.DT_COMPLEX64_REF=108]="DT_COMPLEX64_REF",o[o.DT_INT64_REF=109]="DT_INT64_REF",o[o.DT_BOOL_REF=110]="DT_BOOL_REF",o[o.DT_QINT8_REF=111]="DT_QINT8_REF",o[o.DT_QUINT8_REF=112]="DT_QUINT8_REF",o[o.DT_QINT32_REF=113]="DT_QINT32_REF",o[o.DT_BFLOAT16_REF=114]="DT_BFLOAT16_REF",function(t){!function(t){t[t.LEGACY=0]="LEGACY",t[t.V1=1]="V1",t[t.V2=2]="V2"}(t.CheckpointFormatVersion||(t.CheckpointFormatVersion={}))}(i||(i={}));var c={};function h(t,e){c[t]={tfOpName:t,category:"custom",inputs:[],attrs:[],customExecutor:e}}function d(t){return c[t]}function f(t){delete c[t]}function p(t,e,n,r){var i=e.inputParams[t];if(i&&void 0!==i.inputIndexStart){var o=i.inputIndexStart,a=0===i.inputIndexEnd?void 0:void 0===i.inputIndexEnd?o+1:i.inputIndexEnd;if("tensor"===i.type)return m(e.inputNames[i.inputIndexStart],n,r);if("tensors"===i.type)return e.inputNames.slice(o,a).map((function(t){return m(t,n,r)}));var s=Array.prototype.slice.call(m(e.inputNames.slice(o)[0],n,r).dataSync());return"number"===i.type?s[0]:s}var u=e.attrParams[t];return u&&u.value}function m(t,e,n){var r=v(t),i=r[0],o=r[1],a=n.currentContextIds.find((function(t){return!!e[y(i,t)]}));return void 0!==a?e[y(i,a)][o]:void 0}function g(t,e){var n=v(t),r=n[1];return[y(n[0],e&&e.currentContextId),r]}function y(t,e){return e?t+"-"+e:t}function v(t){var e=t.lastIndexOf(":");return-1===e?[t,0]:[t.substring(0,e),Number(t.substring(e+1))]}function b(t,e){for(var n=[],r=0;r<t.length;r+=e)n.push(t.slice(r,r+e));return n}var w=Object.freeze({json:[{tfOpName:"Add",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddV2",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddN",category:"arithmetic",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"BiasAdd",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sub",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"RealDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Div",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mul",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Maximum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}]},{tfOpName:"Minimum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}]},{tfOpName:"Pow",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SquaredDifference",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorMod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}]}),x=Object.freeze({json:[{tfOpName:"Abs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan2",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Ceil",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ClipByValue",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"clip_value_min",name:"clipValueMin",type:"number"},{tfName:"clip_value_max",name:"clipValueMax",type:"number"}]},{tfOpName:"Complex",category:"basic_math",inputs:[{start:0,name:"real",type:"tensor"},{start:1,name:"imag",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ComplexAbs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Elu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Exp",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Floor",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Imag",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Neg",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Real",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Prelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"alpha",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu6",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"clipValueMin",name:"clipValueMin",type:"number",defaultValue:0},{tfName:"clipValueMax",name:"clipValueMax",type:"number",defaultValue:6}]},{tfOpName:"Selu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sigmoid",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Rsqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Square",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sign",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Round",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Expm1",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log1p",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Reciprocal",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Softplus",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Erf",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Prod",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axes",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool",notSupported:!0},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LeakyRelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"alpha",name:"alpha",type:"number",defaultValue:.2},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}]}),_=Object.freeze({json:[{tfOpName:"LoopCond",category:"control",inputs:[{start:0,name:"pred",type:"tensor"}]},{tfOpName:"Switch",category:"control",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"pred",type:"tensor"}]},{tfOpName:"Merge",category:"control",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"Enter",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"frame_name",name:"frameName",type:"string"},{tfName:"is_constant",name:"isConstant",type:"bool"}]},{tfOpName:"Exit",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NextIteration",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayV3",category:"control",inputs:[{start:0,name:"size",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"dynamic_size",name:"dynamicSize",type:"bool"},{tfName:"clear_after_read",name:"clearAfterRead",type:"bool"},{tfName:"identical_element_shapes",name:"identicalElementShapes",type:"bool"},{tfName:"tensor_array_name",name:"name",type:"string"}]},{tfOpName:"TensorArrayWriteV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"number"},{start:1,name:"index",type:"number"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayReadV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"number"},{start:1,name:"index",type:"number"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayGatherV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"number"},{start:1,name:"indices",type:"number[]"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"}]},{tfOpName:"TensorArrayScatterV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"number"},{start:1,name:"indices",type:"number[]"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArrayConcatV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"number"},{start:1,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape_except0",name:"elementShapeExcept0",type:"shape",notSupported:!0}]},{tfOpName:"TensorArraySplitV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"number"},{start:1,name:"tensor",type:"tensor"},{start:2,name:"lengths",type:"number[]"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArraySizeV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"number"},{start:1,name:"flowIn",type:"number"}]},{tfOpName:"TensorArrayCloseV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"number"}]}]}),C=Object.freeze({json:[{tfOpName:"AvgPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AvgPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Conv1D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"stride",name:"stride",type:"number"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NWC"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"dilation",name:"dilation",type:"number",defaultValue:1}]},{tfOpName:"Conv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"useCudnnOnGpu",name:"useCudnnOnGpu",type:"bool"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"_FusedConv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"use_cudnn_on_gpu",name:"useCudnnOnGpu",type:"bool",defaultValue:!0},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4}]},{tfOpName:"Conv2DBackpropInput",category:"convolution",inputs:[{start:2,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:0,name:"outputShape",type:"number[]"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"DepthwiseConv2d",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"DepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"Conv3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]"}]}]}),k=Object.freeze({json:[{tfOpName:"Fill",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"},{start:1,name:"value",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"LinSpace",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"num",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"OneHot",category:"creation",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"depth",type:"number"},{start:2,name:"onValue",type:"number",defaultValue:1},{start:3,name:"offValue",type:"number",defaultValue:0}],attrs:[{tfName:"axis",name:"axis",type:"number",notSupported:!0},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Ones",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"OnesLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"RandomUniform",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"minval",name:"minval",type:"number",defaultValue:0},{tfName:"maxval",name:"maxval",type:"number",defaultValue:1},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"Range",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"step",type:"number",defaultValue:0}],attrs:[{tfName:"Tidx",name:"dtype",type:"dtype"}]},{tfOpName:"TruncatedNormal",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"means",name:"mean",type:"number",defaultValue:0},{tfName:"stddev",name:"stdDev",type:"number",defaultValue:1},{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"Zeros",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"ZerosLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"Multinomial",category:"creation",inputs:[{start:0,name:"logits",type:"tensor"},{start:1,name:"numSamples",type:"number"}],attrs:[{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number"},{tfName:"T",name:"dtype",type:"dtype"},{tfName:"output_dtype",name:"output_dtype",type:"dtype"}]}]}),S=Object.freeze({json:[{tfOpName:"NonMaxSuppressionV2",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV3",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"}]},{tfOpName:"Where",category:"dynamic",inputs:[{start:0,name:"condition",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ListDiff",category:"dynamic",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}]}),E=Object.freeze({json:[{tfOpName:"TopKV2",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"k",type:"number"}],attrs:[{tfName:"sorted",name:"sorted",type:"bool"}]}]}),O=Object.freeze({json:[{tfOpName:"PlaceholderWithDefault",category:"graph",inputs:[{start:0,name:"default",type:"tensor"}],attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Placeholder",category:"graph",attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Const",category:"graph"},{tfOpName:"Identity",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IdentityN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Snapshot",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Rank",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Size",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Shape",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"ShapeN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Print",category:"graph",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"data",type:"tensors"}],attrs:[{tfName:"message",name:"message",type:"string"},{tfName:"first_n",name:"firstN",type:"number",notSupported:!0},{tfName:"summarize",name:"summarize",type:"number",defaultValue:3}]},{tfOpName:"NoOp",category:"graph",inputs:[]},{tfOpName:"StopGradient",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"FakeQuantWithMinMaxVars",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"min",name:"min",type:"number"},{tfName:"max",name:"max",type:"number"}]}]}),A=Object.freeze({json:[{tfOpName:"ResizeBilinear",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ResizeNearestNeighbor",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"CropAndResize",category:"image",inputs:[{start:0,name:"image",type:"tensor"},{start:1,name:"boxes",type:"tensor"},{start:2,name:"boxInd",type:"tensor"},{start:3,name:"cropSize",type:"number[]"}],attrs:[{tfName:"method",name:"method",type:"string"},{tfName:"extrapolation_value",name:"extrapolationValue",type:"number"}]}]}),N=Object.freeze({json:[{tfOpName:"Equal",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NotEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Greater",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"GreaterEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Less",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LessEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalAnd",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalNot",category:"logical",inputs:[{start:0,name:"a",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalOr",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Select",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}]}),T=Object.freeze({json:[{tfOpName:"MatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMulV2",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Transpose",category:"matrices",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"perm",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}]}),D=Object.freeze({json:[{tfOpName:"FusedBatchNorm",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV2",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV3",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"LRN",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"depth_radius",name:"radius",type:"number",defaultValue:5},{tfName:"bias",name:"bias",type:"number",defaultValue:1},{tfName:"alpha",name:"alpha",type:"number",defaultValue:1},{tfName:"beta",name:"beta",type:"number",defaultValue:.5}]},{tfOpName:"Softmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"LogSoftmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"SparseToDense",category:"normalization",inputs:[{start:0,name:"sparseIndices",type:"tensor"},{start:1,name:"outputShape",type:"number[]"},{start:2,name:"sparseValues",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",defaultValue:!0,notSupported:!0}]}]}),R=Object.freeze({json:[{tfOpName:"Max",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Mean",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Min",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Sum",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"All",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Any",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"ArgMax",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"ArgMin",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"Prod",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]}]}),I=Object.freeze({json:[{tfOpName:"ConcatV2",category:"slice_join",inputs:[{start:0,end:-1,name:"tensors",type:"tensors"},{start:-1,name:"axis",type:"number"}]},{tfOpName:"Concat",category:"slice_join",inputs:[{start:1,end:0,name:"tensors",type:"tensors"},{start:0,name:"axis",type:"number"}]},{tfOpName:"GatherV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"axis",type:"number",defaultValue:0}]},{tfOpName:"Gather",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0},{tfName:"validate_indices",name:"validateIndices",type:"bool",notSupported:!0}]},{tfOpName:"Reverse",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"dims",type:"bool",notSupported:!0}]},{tfOpName:"ReverseV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}]},{tfOpName:"Slice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"size",type:"number[]"}]},{tfOpName:"StridedSlice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"end",type:"number[]"},{start:3,name:"strides",type:"number[]"}],attrs:[{tfName:"begin_mask",name:"beginMask",type:"number",defaultValue:0},{tfName:"end_mask",name:"endMask",type:"number",defaultValue:0},{tfName:"new_axis_mask",name:"newAxisMask",type:"number",defaultValue:0},{tfName:"ellipsis_mask",name:"ellipsisMask",type:"number",defaultValue:0},{tfName:"shrink_axis_mask",name:"shrinkAxisMask",type:"number",defaultValue:0}]},{tfOpName:"Pack",category:"slice_join",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0}]},{tfOpName:"Unpack",category:"slice_join",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0},{tfName:"num",name:"num",type:"number",defaultValue:0,notSupported:!0}]},{tfOpName:"Tile",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"reps",type:"number[]"}]},{tfOpName:"Split",category:"slice_join",inputs:[{start:0,name:"axis",type:"number",defaultValue:0},{start:1,name:"x",type:"tensor"}],attrs:[{tfName:"num_split",name:"numOrSizeSplits",type:"number",defaultValue:1}]},{tfOpName:"SplitV",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"numOrSizeSplits",type:"number[]"},{start:2,name:"axis",type:"number",defaultValue:0}]},{tfOpName:"ScatterNd",category:"slice_join",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"values",type:"tensor"},{start:2,name:"shape",type:"number[]"}]},{tfOpName:"GatherNd",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}]},{tfOpName:"SparseToDense",category:"slice_join",inputs:[{start:0,name:"sparseIndices",type:"tensor"},{start:1,name:"outputShape",type:"number[]"},{start:2,name:"sparseValues",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",defaultValue:!1,notSupported:!0}]}]}),M=Object.freeze({json:[{tfOpName:"FFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"RFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]},{tfOpName:"IRFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]}]}),F=Object.freeze({json:[{tfOpName:"Cast",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"SrcT",name:"sdtype",type:"dtype",notSupported:!0},{tfName:"DstT",name:"dtype",type:"dtype"}]},{tfOpName:"ExpandDims",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"Pad",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"}],attrs:[{tfName:"constant_value",name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"PadV2",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"},{start:2,name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"Reshape",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}]},{tfOpName:"Squeeze",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"axis",tfDeprecatedName:"squeeze_dims",name:"axis",type:"number[]"}]},{tfOpName:"SpaceToBatchND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"paddings",type:"number[]"}]},{tfOpName:"BatchToSpaceND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"crops",type:"number[]"}]},{tfOpName:"DepthToSpace",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"block_size",name:"blockSize",type:"number"},{tfName:"data_format",name:"dataFormat",type:"string"}]}]}),P=function(){function t(){var t=[].concat.apply([],[w,x,_,C,k,S,E,N,A,O,T,D,R,I,M,F].map((function(t){return t.json})));this.opMappers=t.reduce((function(t,e){return t[e.tfOpName]=e,t}),{})}return Object.defineProperty(t,"Instance",{get:function(){return this._instance||(this._instance=new this)},enumerable:!0,configurable:!0}),t.prototype.transformGraph=function(t){var e=this,n=[],r=[],i=t.node.reduce((function(t,i){return t[i.name]=e.mapNode(i),"Placeholder"===i.op&&n.push(t[i.name]),"Const"===i.op&&r.push(t[i.name]),t}),{}),o=[],a=[],s=Object.keys(i);return s.forEach((function(t){var e=i[t];e.inputNames.forEach((function(t){var n=g(t)[0];e.inputs.push(i[n]),i[n].children.push(e)})),0===e.inputs.length&&o.push(e)})),s.forEach((function(t){var e=i[t];0===e.children.length&&a.push(e)})),{nodes:i,inputs:o,outputs:a,weights:r,placeholders:n}},t.prototype.mapNode=function(t){var e=d(t.op)||this.opMappers[t.op]||{};null==t.attr&&(t.attr={});var n={name:t.name,op:t.op,category:e.category,inputNames:(t.input||[]).map((function(t){return t.startsWith("^")?t.substr(1):t})),inputs:[],children:[],inputParams:{},attrParams:{},rawAttrs:t.attr};return null!=e.inputs&&(n.inputParams=e.inputs.reduce((function(t,e){return t[e.name]={type:e.type,inputIndexStart:e.start,inputIndexEnd:e.end},t}),{})),null!=e.attrs&&(n.attrParams=e.attrs.reduce((function(e,n){var r=n.type,i=void 0;switch(n.type){case"string":void 0===(i=z(t.attr,n.tfName,n.defaultValue))&&n.tfDeprecatedName&&(i=z(t.attr,n.tfDeprecatedName,n.defaultValue));break;case"string[]":void 0===(i=G(t.attr,n.tfName,n.defaultValue))&&n.tfDeprecatedName&&(i=G(t.attr,n.tfDeprecatedName,n.defaultValue));break;case"number":void 0===(i=B(t.attr,n.tfName,n.defaultValue||0))&&n.tfDeprecatedName&&(i=B(t.attr,n.tfDeprecatedName,n.defaultValue));break;case"number[]":void 0===(i=H(t.attr,n.tfName,n.defaultValue))&&n.tfDeprecatedName&&(i=H(t.attr,n.tfDeprecatedName,n.defaultValue));break;case"bool":void 0===(i=L(t.attr,n.tfName,n.defaultValue))&&n.tfDeprecatedName&&(i=L(t.attr,n.tfDeprecatedName,n.defaultValue));break;case"bool[]":void 0===(i=K(t.attr,n.tfName,n.defaultValue))&&n.tfDeprecatedName&&(i=K(t.attr,n.tfDeprecatedName,n.defaultValue));break;case"shape":void 0===(i=q(t.attr,n.tfName,n.defaultValue))&&n.tfDeprecatedName&&(i=q(t.attr,n.tfDeprecatedName,n.defaultValue));break;case"shape[]":void 0===(i=X(t.attr,n.tfName,n.defaultValue))&&n.tfDeprecatedName&&(i=X(t.attr,n.tfDeprecatedName,n.defaultValue));break;case"dtype":void 0===(i=$(t.attr,n.tfName,n.defaultValue))&&n.tfDeprecatedName&&(i=$(t.attr,n.tfDeprecatedName,n.defaultValue));break;case"dtype[]":void 0===(i=V(t.attr,n.tfName,n.defaultValue))&&n.tfDeprecatedName&&(i=V(t.attr,n.tfDeprecatedName,n.defaultValue));break;case"tensor":case"tensors":break;default:throw new Error("Unsupported param type: "+n.type+" for op: "+t.op)}return e[n.name]={value:i,type:r},e}),{})),n},t}();function j(t,e){var n=Array.isArray(t)?String.fromCharCode.apply(null,t):function(t){var e=a.ENV.global;if(void 0!==e.atob)return e.atob(t);if("undefined"!=typeof Buffer)return new Buffer(t,"base64").toString();throw new Error("Unable to decode base64 in this environment. Missing built-in atob() or Buffer()")}(t);return e?n:n.toLowerCase()}function z(t,e,n,r){void 0===r&&(r=!1);var i=t[e];return null!=i?j(i.s,r):n}function L(t,e,n){var r=t[e];return r?r.b:n}function B(t,e,n){var r=t[e]||{},i=null!=r.i?r.i:null!=r.f?r.f:n;return"number"==typeof i?i:parseInt(i,10)}function U(t){switch("string"==typeof t&&(t=r[t]),t){case r.DT_FLOAT:return"float32";case r.DT_INT32:return"int32";case r.DT_BOOL:return"bool";case r.DT_DOUBLE:return"float32";case r.DT_STRING:return"string";default:return null}}function $(t,e,n){var r=t[e];return r&&r.type?U(r.type):n}function V(t,e,n){var r=t[e];return r&&r.list&&r.list.type?r.list.type.map((function(t){return U(t)})):n}function W(t){if(!t.unknownRank)return null!=t.dim?t.dim.map((function(t){return"number"==typeof t.size?t.size:parseInt(t.size,10)})):[]}function q(t,e,n){var r=t[e];return r&&r.shape?W(r.shape):n}function H(t,e,n){var r=t[e];return r?((r.list.f&&r.list.f.length?r.list.f:r.list.i)||[]).map((function(t){return"number"==typeof t?t:parseInt(t,10)})):n}function G(t,e,n,r){void 0===r&&(r=!1);var i=t[e];return i&&i.list&&i.list.s?i.list.s.map((function(t){return j(t,r)})):n}function X(t,e,n){var r=t[e];return r&&r.list&&r.list.shape?r.list.shape.map((function(t){return W(t)})):n}function K(t,e,n){var r=t[e];return r&&r.list&&r.list.b?r.list.b:n}var Y=function(){function t(t,e,n){var r=this;this.node=t,this.tensorMap=e,this.context=n,this.inputs=[],this.attrs={},this.inputs=t.inputNames.map((function(t){return r.getInput(t)})),null!=t.rawAttrs&&(this.attrs=Object.keys(t.rawAttrs).reduce((function(t,e){return t[e]=r.getAttr(e),t}),{}))}return t.prototype.getInput=function(t){return m(t,this.tensorMap,this.context)},t.prototype.getAttr=function(t,e){var n=this.node.rawAttrs[t];if(null!=n.tensor)return m(t,this.tensorMap,this.context);if(null!=n.i||null!=n.f)return B(this.node.rawAttrs,t,e);if(null!=n.s)return z(this.node.rawAttrs,t,e);if(null!=n.b)return L(this.node.rawAttrs,t,e);if(null!=n.shape)return q(this.node.rawAttrs,t,e);if(null!=n.type)return $(this.node.rawAttrs,t,e);if(null!=n.list){if(null!=n.list.i||null!=n.list.f)return H(this.node.rawAttrs,t,e);if(null!=n.list.s)return G(this.node.rawAttrs,t,e);if(null!=n.list.shape)return X(this.node.rawAttrs,t,e);if(null!=n.list.b)return K(this.node.rawAttrs,t,e);if(null!=n.list.type)return V(this.node.rawAttrs,t,e)}return e},t}(),Z=function(){function t(e,n,r,i,o,a,s){this.name=e,this.dtype=n,this.maxSize=r,this.elementShape=i,this.identicalElementShapes=o,this.dynamicSize=a,this.clearAfterRead=s,this.tensors=[],this.closed_=!1,this.id=t.nextId++}return Object.defineProperty(t.prototype,"closed",{get:function(){return this.closed_},enumerable:!0,configurable:!0}),t.prototype.clearAndClose=function(){this.tensors.forEach((function(t){return t.tensor.dispose()})),this.tensors=[],this.closed_=!0},t.prototype.size=function(){return this.tensors.length},t.prototype.read=function(t){if(this.closed_)throw new Error("TensorArray "+this.name+" has already been closed.");if(t<0||t>=this.tensors.length)throw new Error("Tried to read from index "+t+", but array size is: "+this.tensors.length);var e=this.tensors[t];if(e.cleared)throw new Error("TensorArray "+this.name+": Could not read index "+t+" twice because it was cleared after a previous read (perhaps try setting clear_after_read = false?).");return this.clearAfterRead&&(e.cleared=!0),e.read=!0,e.tensor},t.prototype.readMany=function(t){var e=this;return t.map((function(t){return e.read(t)}))},t.prototype.write=function(t,e){if(this.closed_)throw new Error("TensorArray "+this.name+" has already been closed.");if(t<0||!this.dynamicSize&&t>=this.maxSize)throw new Error("Tried to write to index "+t+", but array is not resizeable and size is: "+this.maxSize);var n=this.tensors[t]||{};if(e.dtype!==this.dtype)throw new Error("TensorArray "+this.name+": Could not write to TensorArray index "+t+",\n          because the value dtype is "+e.dtype+", but TensorArray dtype is "+this.dtype+".");if(0!==this.size()||null!=this.elementShape&&0!==this.elementShape.length||(this.elementShape=e.shape),this.assertShapesMatchAllowUndefinedSize(this.elementShape,e.shape,"TensorArray "+this.name+": Could not write to TensorArray index "+t+"."),n&&n.read)throw new Error("TensorArray "+this.name+": Could not write to TensorArray index "+t+", because it has already been read.");if(n&&n.written)throw new Error("TensorArray "+this.name+": Could not write to TensorArray index "+t+", because it has already been written.");n.tensor=e,n.written=!0,this.tensors[t]=n},t.prototype.writeMany=function(t,e){var n=this;if(t.length!==e.length)throw new Error("TensorArray "+this.name+": could not write multiple tensors,because the index size: "+t.length+" is not the same as tensors size: "+e.length+".");t.forEach((function(t,r){return n.write(t,e[r])}))},t.prototype.gather=function(t,e){if(e&&e!==this.dtype)throw new Error("TensorArray dtype is "+this.dtype+" but gather requested dtype "+e);if(!t){t=[];for(var n=0;n<this.size();n++)t.push(n)}if(0===t.length)return Object(a.tensor)([],[0].concat(this.elementShape));var r=this.readMany(t);return this.assertShapesMatchAllowUndefinedSize(this.elementShape,r[0].shape,"TensorArray shape mismatch: "),Object(a.stack)(r,0)},t.prototype.concat=function(t){if(t&&t!==this.dtype)throw new Error("TensorArray dtype is "+this.dtype+" but concat requested dtype "+t);if(0===this.size())return Object(a.tensor)([],[0].concat(this.elementShape));for(var e=[],n=0;n<this.size();n++)e.push(n);var r=this.readMany(e);return this.assertShapesMatchAllowUndefinedSize(this.elementShape,r[0].shape,"TensorArray shape mismatch: tensor array shape ("+this.elementShape+") vs first tensor shape ("+r[0].shape+")"),Object(a.concat)(r,0)},t.prototype.scatter=function(t,e){if(e.dtype!==this.dtype)throw new Error("TensorArray dtype is "+this.dtype+" but tensor has dtype "+e.dtype);if(t.length!==e.shape[0])throw new Error("Expected len(indices) == tensor.shape[0], but saw: "+t.length+" vs. "+e.shape[0]);var n=Math.max.apply(Math,t);if(!this.dynamicSize&&n>=this.maxSize)throw new Error("Max index must be < array size ("+n+"  vs. "+this.maxSize+")");this.writeMany(t,Object(a.unstack)(e,0))},t.prototype.split=function(t,e){var n=this;if(e.dtype!==this.dtype)throw new Error("TensorArray dtype is "+this.dtype+" but tensor has dtype "+e.dtype);var r=0,i=t.map((function(t){return r+=t}));if(r!==e.shape[0])throw new Error("Expected sum of lengths to be equal to\n          tensor.shape[0], but sum of lengths is\n        "+r+", and tensor's shape is: "+e.shape);if(!this.dynamicSize&&t.length!==this.maxSize)throw new Error("TensorArray's size is not equal to the size of lengths ("+this.maxSize+" vs. "+t.length+"), and the TensorArray is not marked as dynamically resizeable");var o=0===r?0:e.size/r,s=[];Object(a.tidy)((function(){e=e.reshape([1,r,o]);for(var u=0;u<t.length;++u){var l=[0,0===u?0:i[u-1],0],c=[1,t[u],o];s[u]=Object(a.slice)(e,l,c).reshape(n.elementShape)}return s}));for(var u=[],l=0;l<t.length;l++)u[l]=l;this.writeMany(u,s)},t.prototype.assertShapesMatchAllowUndefinedSize=function(t,e,n){void 0===n&&(n=""),a.util.assert(this.shapesEqualAllowUndefinedSize(t,e),(function(){return n+" Shapes "+t+" and "+e+" must match"}))},t.prototype.shapesEqualAllowUndefinedSize=function(t,e){if(t.length!==e.length)return!1;for(var n=0;n<t.length;n++)if(-1!==t[n]&&-1!==e[n]&&t[n]!==e[n])return!1;return!0},t.nextId=0,t}();function Q(t,e,n){var r=function(t,e,n){switch(t.category){case"arithmetic":return function(t,e,n){switch(t.op){case"BiasAdd":case"AddV2":case"Add":return[Object(a.add)(p("a",t,e,n),p("b",t,e,n))];case"AddN":return[Object(a.addN)(p("tensors",t,e,n))];case"FloorMod":case"Mod":return[Object(a.mod)(p("a",t,e,n),p("b",t,e,n))];case"Mul":return[Object(a.mul)(p("a",t,e,n),p("b",t,e,n))];case"RealDiv":case"Div":return[Object(a.div)(p("a",t,e,n),p("b",t,e,n))];case"FloorDiv":return[Object(a.floorDiv)(p("a",t,e,n),p("b",t,e,n))];case"Sub":return[Object(a.sub)(p("a",t,e,n),p("b",t,e,n))];case"Minimum":return[Object(a.minimum)(p("a",t,e,n),p("b",t,e,n))];case"Maximum":return[Object(a.maximum)(p("a",t,e,n),p("b",t,e,n))];case"Pow":return[Object(a.pow)(p("a",t,e,n),p("b",t,e,n))];case"SquaredDifference":return[Object(a.squaredDifference)(p("a",t,e,n),p("b",t,e,n))];default:throw TypeError("Node type "+t.op+" is not implemented")}}(t,e,n);case"basic_math":return function(t,e,n){switch(t.op){case"Abs":case"ComplexAbs":return[Object(a.abs)(p("x",t,e,n))];case"Acos":return[Object(a.acos)(p("x",t,e,n))];case"Acosh":return[Object(a.acosh)(p("x",t,e,n))];case"Asin":return[Object(a.asin)(p("x",t,e,n))];case"Asinh":return[Object(a.asinh)(p("x",t,e,n))];case"Atan":return[Object(a.atan)(p("x",t,e,n))];case"Atan2":return[Object(a.atan2)(p("x",t,e,n),p("y",t,e,n))];case"Atanh":return[Object(a.atanh)(p("x",t,e,n))];case"Ceil":return[Object(a.ceil)(p("x",t,e,n))];case"Complex":return[Object(a.complex)(p("real",t,e,n),p("imag",t,e,n))];case"Cos":return[Object(a.cos)(p("x",t,e,n))];case"Cosh":return[Object(a.cosh)(p("x",t,e,n))];case"Elu":return[Object(a.elu)(p("x",t,e,n))];case"Erf":return[Object(a.erf)(p("x",t,e,n))];case"Exp":return[Object(a.exp)(p("x",t,e,n))];case"Expm1":return[Object(a.expm1)(p("x",t,e,n))];case"Floor":return[Object(a.floor)(p("x",t,e,n))];case"Log":return[Object(a.log)(p("x",t,e,n))];case"Log1p":return[Object(a.log1p)(p("x",t,e,n))];case"Imag":return[Object(a.imag)(p("x",t,e,n))];case"Neg":return[Object(a.neg)(p("x",t,e,n))];case"Reciprocal":return[Object(a.reciprocal)(p("x",t,e,n))];case"Real":return[Object(a.real)(p("x",t,e,n))];case"Relu":return[Object(a.relu)(p("x",t,e,n))];case"Round":return[Object(a.round)(p("x",t,e,n))];case"Selu":return[Object(a.selu)(p("x",t,e,n))];case"Sigmoid":return[Object(a.sigmoid)(p("x",t,e,n))];case"Sin":return[Object(a.sin)(p("x",t,e,n))];case"Sign":return[Object(a.sign)(p("x",t,e,n))];case"Sinh":return[Object(a.sinh)(p("x",t,e,n))];case"Softplus":return[Object(a.softplus)(p("x",t,e,n))];case"Sqrt":return[Object(a.sqrt)(p("x",t,e,n))];case"Square":return[Object(a.square)(p("x",t,e,n))];case"Tanh":return[Object(a.tanh)(p("x",t,e,n))];case"Tan":return[Object(a.tan)(p("x",t,e,n))];case"Relu6":case"ClipByValue":return[Object(a.clipByValue)(p("x",t,e,n),p("clipValueMin",t,e,n),p("clipValueMax",t,e,n))];case"Rsqrt":return[Object(a.rsqrt)(m(t.inputNames[0],e,n))];case"Prod":return[Object(a.prod)(p("x",t,e,n),p("axes",t,e,n))];case"LeakyRelu":return[Object(a.leakyRelu)(p("x",t,e,n),p("alpha",t,e,n))];default:throw TypeError("Node type "+t.op+" is not implemented")}}(t,e,n);case"control":return function(t,e,n){return u(this,void 0,void 0,(function(){var r,i,o,s,u,c,h,d,f,g,y,v,b,w,x,_,C,k,S,E,O,A,N,T,D,R,I,M,F,P,j,z,L,B,U;return l(this,(function(l){switch(l.label){case 0:switch(t.op){case"LoopCond":return[3,1];case"Switch":return[3,2];case"Merge":return[3,4];case"Enter":return[3,5];case"Exit":return[3,6];case"NextIteration":return[3,7];case"TensorArrayV3":return[3,8];case"TensorArrayWriteV3":return[3,9];case"TensorArrayReadV3":return[3,10];case"TensorArrayGatherV3":return[3,11];case"TensorArrayScatterV3":return[3,12];case"TensorArrayConcatV3":return[3,13];case"TensorArraySplitV3":return[3,14];case"TensorArraySizeV3":return[3,15];case"TensorArrayCloseV3":return[3,16]}return[3,17];case 1:return[2,[p("pred",t,e,n).clone()]];case 2:return r=p("pred",t,e,n),i=p("data",t,e,n),[4,r.data()];case 3:return[2,l.sent()[0]?[void 0,i.clone()]:[i.clone(),void 0]];case 4:return[2,(o=t.inputNames.find((function(t){return void 0!==m(t,e,n)})))?[m(o,e,n).clone()]:void 0];case 5:return s=p("frameName",t,e,n),u=p("tensor",t,e,n),n.enterFrame(s),[2,[u.clone()]];case 6:return c=p("tensor",t,e,n),n.exitFrame(),[2,[c.clone()]];case 7:return h=p("tensor",t,e,n),n.nextIteration(),[2,[h.clone()]];case 8:return d=p("size",t,e,n),f=p("dtype",t,e,n),g=p("elementShape",t,e,n),y=p("dynamicSize",t,e,n),v=p("clearAfterRead",t,e,n),b=p("identicalElementShapes",t,e,n),w=p("name",t,e,n),x=new Z(w,f,d,g,b,y,v),n.addTensorArray(x),[2,[Object(a.scalar)(x.id),Object(a.scalar)(1)]];case 9:return _=p("tensorArrayId",t,e,n),C=p("index",t,e,n),k=p("tensor",t,e,n),n.getTensorArray(_).write(C,k),[2,[Object(a.scalar)(1)]];case 10:return S=p("tensorArrayId",t,e,n),E=p("index",t,e,n),[2,[n.getTensorArray(S).read(E)]];case 11:return O=p("tensorArrayId",t,e,n),A=p("indices",t,e,n),N=p("dtype",t,e,n),[2,[n.getTensorArray(O).gather(A,N)]];case 12:return T=p("tensorArrayId",t,e,n),D=p("indices",t,e,n),R=p("tensor",t,e,n),n.getTensorArray(T).scatter(D,R),[2,[Object(a.scalar)(1)]];case 13:return I=p("tensorArrayId",t,e,n),M=n.getTensorArray(I),F=p("dtype",t,e,n),[2,[M.concat(F)]];case 14:return P=p("tensorArrayId",t,e,n),j=p("tensor",t,e,n),z=p("lengths",t,e,n),n.getTensorArray(P).split(z,j),[2,[Object(a.scalar)(1)]];case 15:return L=p("tensorArrayId",t,e,n),B=n.getTensorArray(L),[2,[Object(a.scalar)(B.size(),"int32")]];case 16:return U=p("tensorArrayId",t,e,n),n.getTensorArray(U).clearAndClose(),[2,[]];case 17:throw TypeError("Node type "+t.op+" is not implemented")}}))}))}(t,e,n);case"convolution":return function(t,e,n){var r,i;switch(t.op){case"Conv1D":var o=p("stride",t,e,n),s=p("pad",t,e,n),u=p("dataFormat",t,e,n).toUpperCase(),l=p("dilation",t,e,n);return[Object(a.conv1d)(p("x",t,e,n),p("filter",t,e,n),o,s,u,l)];case"Conv2D":o=p("strides",t,e,n),s=p("pad",t,e,n),u=p("dataFormat",t,e,n).toUpperCase();var c=p("dilations",t,e,n);return[Object(a.conv2d)(p("x",t,e,n),p("filter",t,e,n),[o[1],o[2]],s,u,[c[1],c[2]])];case"_FusedConv2D":var h=(r=p("fusedOps",t,e,n))[0],d=r[1],f="biasadd"===h,m="prelu"===d,g="fusedbatchnorm"===h,y=p("numArgs",t,e,n);if(f){if(m&&2!==y)throw new Error("Fused Conv2d with BiasAdd and Prelu must have two extra arguments: bias and alpha.");if(!m&&1!==y)throw new Error("Fused Conv2d with BiasAdd must have one extra argument: bias.")}if(g)throw new Error("Fused Conv2d with FusedBatchNorm is not supported.");o=p("strides",t,e,n),s=p("pad",t,e,n),u=p("dataFormat",t,e,n).toUpperCase(),c=p("dilations",t,e,n);var v=(i=p("args",t,e,n))[0],b=i[1];return[a.fused.conv2d({x:p("x",t,e,n),filter:p("filter",t,e,n),strides:[o[1],o[2]],pad:s,dataFormat:u,dilations:[c[1],c[2]],bias:v,activation:d,preluActivationWeights:b})];case"Conv2DBackpropInput":case"Conv2dTranspose":var w=p("outputShape",t,e,n);return o=p("strides",t,e,n),s=p("pad",t,e,n),[Object(a.conv2dTranspose)(p("x",t,e,n),p("filter",t,e,n),w,[o[1],o[2]],s)];case"DepthwiseConv2dNative":case"DepthwiseConv2d":return o=p("strides",t,e,n),s=p("pad",t,e,n),c=p("dilations",t,e,n),u=p("dataFormat",t,e,n).toUpperCase(),[Object(a.depthwiseConv2d)(p("input",t,e,n),p("filter",t,e,n),[o[1],o[2]],s,u,[c[1],c[2]])];case"Conv3D":return o=p("strides",t,e,n),s=p("pad",t,e,n),u=p("dataFormat",t,e,n).toUpperCase(),c=p("dilations",t,e,n),[Object(a.conv3d)(p("x",t,e,n),p("filter",t,e,n),[o[1],o[2],o[3]],s,u,[c[1],c[2],c[3]])];case"AvgPool":o=p("strides",t,e,n),s=p("pad",t,e,n);var x=p("kernelSize",t,e,n);return[Object(a.avgPool)(p("x",t,e,n),[x[1],x[2]],[o[1],o[2]],s)];case"MaxPool":return o=p("strides",t,e,n),s=p("pad",t,e,n),x=p("kernelSize",t,e,n),[Object(a.maxPool)(p("x",t,e,n),[x[1],x[2]],[o[1],o[2]],s)];case"AvgPool3D":return o=p("strides",t,e,n),s=p("pad",t,e,n),x=p("kernelSize",t,e,n),[Object(a.avgPool3d)(p("x",t,e,n),[x[1],x[2],x[3]],[o[1],o[2],o[3]],s)];case"MaxPool3D":return o=p("strides",t,e,n),s=p("pad",t,e,n),x=p("kernelSize",t,e,n),[Object(a.maxPool3d)(p("x",t,e,n),[x[1],x[2],x[3]],[o[1],o[2],o[3]],s)];default:throw TypeError("Node type "+t.op+" is not implemented")}}(t,e,n);case"creation":return function(t,e,n){switch(t.op){case"Fill":var r=p("shape",t,e,n),i=p("dtype",t,e,n),o=p("value",t,e,n);return[Object(a.fill)(r,o,i)];case"LinSpace":var s=p("start",t,e,n),u=p("stop",t,e,n),l=p("num",t,e,n);return[Object(a.linspace)(s,u,l)];case"Multinomial":var c=p("logits",t,e,n),h=p("numSamples",t,e,n),d=p("seed",t,e,n);return[Object(a.multinomial)(c,h,d)];case"OneHot":var f=p("indices",t,e,n),m=p("depth",t,e,n),g=p("onValue",t,e,n),y=p("offValue",t,e,n);return[Object(a.oneHot)(f,m,g,y)];case"Ones":return[Object(a.ones)(p("shape",t,e,n),p("dtype",t,e,n))];case"OnesLike":return[Object(a.onesLike)(p("x",t,e,n))];case"RandomUniform":return[Object(a.randomUniform)(p("shape",t,e,n),p("minval",t,e,n),p("maxval",t,e,n),p("dtype",t,e,n))];case"Range":s=p("start",t,e,n);var v=p("stop",t,e,n),b=p("step",t,e,n);return[Object(a.range)(s,v,b,p("dtype",t,e,n))];case"TruncatedNormal":r=p("shape",t,e,n);var w=p("mean",t,e,n),x=p("stdDev",t,e,n);return d=p("seed",t,e,n),[Object(a.truncatedNormal)(r,w,x,p("dtype",t,e,n),d)];case"Zeros":return[Object(a.zeros)(p("shape",t,e,n),p("dtype",t,e,n))];case"ZerosLike":return[Object(a.zerosLike)(p("x",t,e,n))];default:throw TypeError("Node type "+t.op+" is not implemented")}}(t,e,n);case"dynamic":return function(t,e,n){return u(this,void 0,void 0,(function(){var r,i,o,s,u;return l(this,(function(l){switch(l.label){case 0:switch(t.op){case"NonMaxSuppressionV3":case"NonMaxSuppressionV2":return[3,1];case"Where":return[3,3];case"ListDiff":return[3,5]}return[3,6];case 1:return r=p("boxes",t,e,n),i=p("scores",t,e,n),o=p("maxOutputSize",t,e,n),s=p("iouThreshold",t,e,n),u=p("scoreThreshold",t,e,n),[4,a.image.nonMaxSuppressionAsync(r,i,o,s,u)];case 2:return[2,[l.sent()]];case 3:return[4,Object(a.whereAsync)(p("condition",t,e,n))];case 4:return[2,[l.sent()]];case 5:return[2,Object(a.setdiff1dAsync)(p("x",t,e,n),p("y",t,e,n))];case 6:throw TypeError("Node type "+t.op+" is not implemented")}}))}))}(t,e,n);case"evaluation":return function(t,e,n){switch(t.op){case"TopKV2":var r=p("x",t,e,n),i=p("k",t,e,n),o=p("sorted",t,e,n),s=Object(a.topk)(r,i,o);return[s.values,s.indices];default:throw TypeError("Node type "+t.op+" is not implemented")}}(t,e,n);case"image":return function(t,e,n){switch(t.op){case"ResizeBilinear":var r=p("images",t,e,n),i=p("size",t,e,n),o=p("alignCorners",t,e,n);return[a.image.resizeBilinear(r,[i[0],i[1]],o)];case"ResizeNearestNeighbor":return r=p("images",t,e,n),i=p("size",t,e,n),o=p("alignCorners",t,e,n),[a.image.resizeNearestNeighbor(r,[i[0],i[1]],o)];case"CropAndResize":var s=p("image",t,e,n),u=p("boxes",t,e,n),l=p("boxInd",t,e,n),c=p("cropSize",t,e,n),h=p("method",t,e,n),d=p("extrapolationValue",t,e,n);return[a.image.cropAndResize(s,u,l,c,h,d)];default:throw TypeError("Node type "+t.op+" is not implemented")}}(t,e,n);case"graph":return function(t,e,n){switch(t.op){case"Const":return e[t.name];case"PlaceholderWithDefault":var r=p("default",t,e,n);return[m(t.name,e,n)||r];case"Placeholder":return[m(t.name,e,n)];case"Identity":case"StopGradient":case"FakeQuantWithMinMaxVars":return[p("x",t,e,n).clone()];case"IdentityN":return p("x",t,e,n).map((function(t){return t.clone()}));case"Snapshot":return[p("x",t,e,n).clone()];case"Shape":return[Object(a.tensor1d)(p("x",t,e,n).shape,"int32")];case"ShapeN":return p("x",t,e,n).map((function(t){return Object(a.tensor1d)(t.shape)}));case"Size":return[Object(a.scalar)(p("x",t,e,n).size,"int32")];case"Rank":return[Object(a.scalar)(p("x",t,e,n).rank,"int32")];case"NoOp":return[];case"Print":var i=p("x",t,e,n),o=p("data",t,e,n),s=p("message",t,e,n),u=p("summarize",t,e,n);console.warn("The graph has a tf.print() operation,usually used for debugging, which slows down performance."),console.log(s);for(var l=0;l<o.length;l++)console.log(Array.prototype.slice.call(o[l].dataSync()).slice(0,u));return[i];default:throw TypeError("Node type "+t.op+" is not implemented")}}(t,e,n);case"logical":return function(t,e,n){switch(t.op){case"Equal":return[Object(a.equal)(p("a",t,e,n),p("b",t,e,n))];case"NotEqual":return[Object(a.notEqual)(p("a",t,e,n),p("b",t,e,n))];case"Greater":return[Object(a.greater)(p("a",t,e,n),p("b",t,e,n))];case"GreaterEqual":return[Object(a.greaterEqual)(p("a",t,e,n),p("b",t,e,n))];case"Less":return[Object(a.less)(p("a",t,e,n),p("b",t,e,n))];case"LessEqual":return[Object(a.lessEqual)(p("a",t,e,n),p("b",t,e,n))];case"LogicalAnd":return[Object(a.logicalAnd)(p("a",t,e,n),p("b",t,e,n))];case"LogicalNot":return[Object(a.logicalNot)(p("a",t,e,n))];case"LogicalOr":return[Object(a.logicalOr)(p("a",t,e,n),p("b",t,e,n))];case"Select":return[Object(a.where)(p("condition",t,e,n),p("a",t,e,n),p("b",t,e,n))];default:throw TypeError("Node type "+t.op+" is not implemented")}}(t,e,n);case"matrices":return function(t,e,n){switch(t.op){case"BatchMatMul":case"BatchMatMulV2":case"MatMul":return[Object(a.matMul)(p("a",t,e,n),p("b",t,e,n),p("transposeA",t,e,n),p("transposeB",t,e,n))];case"Transpose":return[Object(a.transpose)(p("x",t,e,n),p("perm",t,e,n))];default:throw TypeError("Node type "+t.op+" is not implemented")}}(t,e,n);case"normalization":return function(t,e,n){switch(t.op){case"FusedBatchNorm":case"FusedBatchNormV2":case"FusedBatchNormV3":return[Object(a.batchNorm)(p("x",t,e,n),p("mean",t,e,n),p("variance",t,e,n),p("offset",t,e,n),p("scale",t,e,n),p("epsilon",t,e,n))];case"LRN":return[Object(a.localResponseNormalization)(p("x",t,e,n),p("radius",t,e,n),p("bias",t,e,n),p("alpha",t,e,n),p("beta",t,e,n))];case"Softmax":return[Object(a.softmax)(p("x",t,e,n))];case"LogSoftmax":return[Object(a.logSoftmax)(p("x",t,e,n))];case"SparseToDense":return[Object(a.sparseToDense)(p("sparseIndices",t,e,n),p("outputShape",t,e,n),p("sparseValues",t,e,n),p("defaultValue",t,e,n))];default:throw TypeError("Node type "+t.op+" is not implemented")}}(t,e,n);case"reduction":return function(t,e,n){switch(t.op){case"Max":var r=p("axis",t,e,n),i=p("keepDims",t,e,n);return[Object(a.max)(p("x",t,e,n),r,i)];case"Mean":return r=p("axis",t,e,n),i=p("keepDims",t,e,n),[Object(a.mean)(p("x",t,e,n),r,i)];case"Min":return r=p("axis",t,e,n),i=p("keepDims",t,e,n),[Object(a.min)(p("x",t,e,n),r,i)];case"Sum":return r=p("axis",t,e,n),i=p("keepDims",t,e,n),[Object(a.sum)(p("x",t,e,n),r,i)];case"All":return r=p("axis",t,e,n),i=p("keepDims",t,e,n),[Object(a.all)(p("x",t,e,n),r,i)];case"Any":return r=p("axis",t,e,n),i=p("keepDims",t,e,n),[Object(a.any)(p("x",t,e,n),r,i)];case"ArgMax":return r=p("axis",t,e,n),[Object(a.argMax)(p("x",t,e,n),r)];case"ArgMin":return r=p("axis",t,e,n),[Object(a.argMin)(p("x",t,e,n),r)];case"Prod":return r=p("axis",t,e,n),i=p("keepDims",t,e,n),[Object(a.prod)(p("x",t,e,n),r,i)];default:throw TypeError("Node type "+t.op+" is not implemented")}}(t,e,n);case"slice_join":return function(t,e,n){switch(t.op){case"ConcatV2":case"Concat":var r=p("axis",t,e,n),i=p("tensors",t,e,n);return[Object(a.concat)(i,r)];case"GatherV2":case"Gather":r=p("axis",t,e,n);var o=p("x",t,e,n),s=p("indices",t,e,n);return[Object(a.gather)(o,s.asType("int32"),r)];case"ReverseV2":case"Reverse":return r=p("axis",t,e,n),o=p("x",t,e,n),[Object(a.reverse)(o,r)];case"Slice":var u=p("begin",t,e,n),l=p("size",t,e,n);return[Object(a.slice)(p("x",t,e,n),u,l)];case"StridedSlice":u=p("begin",t,e,n);var c=p("end",t,e,n),h=p("strides",t,e,n),d=p("beginMask",t,e,n),f=p("endMask",t,e,n),m=p("ellipsisMask",t,e,n),g=p("newAxisMask",t,e,n),y=p("shrinkAxisMask",t,e,n),v=p("x",t,e,n);if(1===u.length&&v.shape.length>1)for(var b=1;b<v.shape.length;b++)u.push(0),c.push(v.shape[b]),h.push(h[0]);return[Object(a.stridedSlice)(v,u,c,h,d,f,m,g,y)];case"Pack":return Object(a.tidy)((function(){var r=p("axis",t,e,n),i=p("tensors",t,e,n),o=i[0].shape,s=i[0].squeeze().shape,u=i.map((function(t){var e=a.util.arraysEqual(t.shape,o);if(!e&&!a.util.arraysEqual(t.squeeze().shape,s))throw new Error("the input tensors shape does not match");return e?t:t.reshape(o)}));return[Object(a.stack)(u,r)]}));case"Unpack":return Object(a.tidy)((function(){var r=p("axis",t,e,n),i=p("tensor",t,e,n);return Object(a.unstack)(i,r)}));case"Tile":var w=p("reps",t,e,n);return[Object(a.tile)(p("x",t,e,n),w)];case"Split":case"SplitV":r=p("axis",t,e,n);var x=p("numOrSizeSplits",t,e,n);return Object(a.split)(p("x",t,e,n),x,r);case"ScatterNd":s=p("indices",t,e,n);var _=p("values",t,e,n),C=p("shape",t,e,n);return[Object(a.scatterND)(s,_,C)];case"GatherNd":var k=p("x",t,e,n);return s=p("indices",t,e,n),[Object(a.gatherND)(k,s)];case"SparseToDense":s=p("sparseIndices",t,e,n),C=p("outputShape",t,e,n);var S=p("sparseValues",t,e,n),E=p("defaultValue",t,e,n);return[Object(a.sparseToDense)(s,S,C,S.dtype===E.dtype?E:E.asType(S.dtype))];default:throw TypeError("Node type "+t.op+" is not implemented")}}(t,e,n);case"spectral":return function(t,e,n){switch(t.op){case"FFT":return[Object(a.fft)(p("x",t,e,n))];case"IFFT":return[Object(a.ifft)(p("x",t,e,n))];case"RFFT":return[Object(a.rfft)(p("x",t,e,n))];case"IRFFT":return[Object(a.irfft)(p("x",t,e,n))];default:throw TypeError("Node type "+t.op+" is not implemented")}}(t,e,n);case"transformation":return function(t,e,n){switch(t.op){case"Cast":return[Object(a.cast)(p("x",t,e,n),p("dtype",t,e,n))];case"ExpandDims":var r=p("axis",t,e,n);return[Object(a.expandDims)(p("x",t,e,n),r)];case"Squeeze":return r=p("axis",t,e,n),[Object(a.squeeze)(p("x",t,e,n),r)];case"Reshape":return[Object(a.reshape)(p("x",t,e,n),p("shape",t,e,n))];case"PadV2":case"Pad":return[Object(a.pad)(p("x",t,e,n),b(p("padding",t,e,n),2),p("constantValue",t,e,n))];case"SpaceToBatchND":var i=p("blockShape",t,e,n),o=b(p("paddings",t,e,n),2);return[Object(a.spaceToBatchND)(p("x",t,e,n),i,o)];case"BatchToSpaceND":i=p("blockShape",t,e,n);var s=b(p("crops",t,e,n),2);return[Object(a.batchToSpaceND)(p("x",t,e,n),i,s)];case"DepthToSpace":var u=p("blockSize",t,e,n),l=p("dataFormat",t,e,n).toUpperCase();return[Object(a.depthToSpace)(p("x",t,e,n),u,l)];default:throw TypeError("Node type "+t.op+" is not implemented")}}(t,e,n);case"custom":var r=d(t.op);if(r&&r.customExecutor)return r.customExecutor(new Y(t,e,n));throw TypeError("Custom op "+t.op+" is not registered.");default:throw TypeError("Unknown op '"+t.op+"'. File an issue at https://github.com/tensorflow/tfjs/issues so we can add it, or register a custom execution with tf.registerOp()")}}(t,e,n);return r instanceof Promise?r.then((function(t){return[].concat(t)})):[].concat(r)}var J=function(){function t(t,e){this.weightMap=t,this.tensorArrayMap=e,this.rootContext={id:0,frameName:"",iterationId:0},this.contexts=[this.rootContext],this.lastId=0,this.generateCurrentContextIds()}return t.prototype.newFrame=function(t,e){return{id:t,frameName:e,iterationId:0}},Object.defineProperty(t.prototype,"currentContext",{get:function(){return this.contexts},set:function(t){this.contexts!==t&&(this.contexts=t,this.generateCurrentContextIds())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"currentContextId",{get:function(){return this._currentContextIds[0]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"currentContextIds",{get:function(){return this._currentContextIds},enumerable:!0,configurable:!0}),t.prototype.generateCurrentContextIds=function(){for(var t=[],e=0;e<this.contexts.length-1;e++){var n=this.contexts.slice(0,this.contexts.length-e);t.push(this.contextIdforContexts(n))}t.push(""),this._currentContextIds=t},t.prototype.contextIdforContexts=function(t){return t?t.map((function(t){return 0===t.id&&0===t.iterationId?"":t.frameName+"-"+t.iterationId})).join("/"):""},t.prototype.enterFrame=function(t){this.contexts&&(this.lastId++,this.contexts=this.contexts.slice(),this.contexts.push(this.newFrame(this.lastId,t)),this._currentContextIds.unshift(this.contextIdforContexts(this.contexts)))},t.prototype.exitFrame=function(){if(!(this.contexts&&this.contexts.length>1))throw new Error("Cannot exit frame, the context is empty");this.contexts=this.contexts.slice(),this.contexts.splice(-1),this.currentContextIds.shift()},t.prototype.nextIteration=function(){if(!(this.contexts&&this.contexts.length>0))throw new Error("Cannot increase frame iteration, the context is empty");this.contexts=this.contexts.slice(),this.lastId++;var t=Object.assign({},this.contexts[this.contexts.length-1]);t.iterationId+=1,t.id=this.lastId,this.contexts.splice(-1,1,t),this._currentContextIds.splice(0,1,this.contextIdforContexts(this.contexts))},t.prototype.getWeight=function(t){return this.weightMap[t]},t.prototype.addTensorArray=function(t){this.tensorArrayMap[t.id]=t},t.prototype.getTensorArray=function(t){return this.tensorArrayMap[t]},t}();function tt(t,e,n){for(var r=new Set,i=[],o=null,a=null,s=new Set,u=e.slice();u.length>0;){var l=u.pop();(rt(l)||it(l))&&null==o&&(a=(o=l).children.map((function(t){return t.name})).filter((function(t){return r.has(t)}))),r.add(l.name),null==n[l.name]&&null==t[l.name]&&(0!==l.inputs.length?l.inputs.forEach((function(t){s.has(t.name)||(s.add(t.name),u.push(t))})):i.push(l.name))}return{inputs:t,outputs:e,usedNodes:r,missingInputs:i,dynamicNode:o,syncInputs:a}}var et=["Switch","Merge","Enter","Exit","NextIteration"],nt=["NonMaxSuppressionV2","NonMaxSuppressionV3","Where"];function rt(t){return et.indexOf(t.op)>=0}function it(t){return nt.indexOf(t.op)>=0}var ot=function(){function t(t){this.graph=t,this.compiledMap=new Map,this._weightMap={},this.SEPERATOR=",",this.placeholders=t.placeholders,this._outputs=t.outputs}return Object.defineProperty(t.prototype,"weightMap",{get:function(){return this._weightMap},set:function(t){var e=Object.keys(t).map((function(e){return t[e].map((function(t){return t.id}))}));this.weightIds=[].concat.apply([],e),this._weightMap=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"inputs",{get:function(){return this.placeholders.map((function(t){return{name:t.name,shape:t.attrParams.shape?t.attrParams.shape.value:void 0,dtype:t.attrParams.dtype?t.attrParams.dtype.value:void 0}}))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"outputs",{get:function(){return this._outputs.map((function(t){return{name:t.name,shape:t.attrParams.shape?t.attrParams.shape.value:void 0,dtype:t.attrParams.dtype?t.attrParams.dtype.value:void 0}}))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"inputNodes",{get:function(){return this.placeholders.map((function(t){return t.name}))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"outputNodes",{get:function(){return this.outputs.map((function(t){return t.name}))},enumerable:!0,configurable:!0}),t.prototype.getCompilationKey=function(t,e){var n=t.map((function(t){return t.name})).sort(),r=e.map((function(t){return t.name})).sort();return n.join(this.SEPERATOR)+"--"+r.join(this.SEPERATOR)},t.prototype.compile=function(t,e){var n=tt(t,e,this.weightMap),r=n.missingInputs,i=n.dynamicNode;if(null!=i)throw new Error("This execution contains the node '"+i.name+"', which has the dynamic op '"+i.op+"'. Please use model.executeAsync() instead. Alternatively, to avoid the dynamic ops, specify the inputs ["+n.syncInputs+"]");if(r.length>0){var o=e.map((function(t){return t.name})),a=Object.keys(t);throw new Error("Cannot compute the outputs ["+o+"] from the provided inputs ["+a+"]. Missing the following inputs: ["+r+"]")}return function(t,e,n){var r=n.usedNodes,i=[];Object.keys(n.inputs).map((function(e){return t.nodes[e]})).forEach((function(t){r.has(t.name)&&i.push(t)})),t.weights.forEach((function(t){r.has(t.name)&&i.push(t)}));for(var o=new Set,a=[];i.length>0;){var s=i.pop();o.add(s.name),e[s.name]||a.push(s),s.children.forEach((function(t){!o.has(t.name)&&r.has(t.name)&&t.inputs.every((function(t){return o.has(t.name)}))&&i.push(t)}))}return a}(this.graph,this.weightMap,n)},t.prototype.execute=function(t,e){var n=this,r=Object.keys(t).sort();this.checkInputs(t),this.checkInputShapeAndType(t),this.checkOutputs(e);var i=r.map((function(t){return n.graph.nodes[t]})),o=e.map((function(t){return n.graph.nodes[v(t)[0]]})),u=this.getCompilationKey(i,o),l=this.compiledMap.get(u);null==l&&(l=this.compile(t,o),this.compiledMap.set(u,l));var c={};return Object(a.tidy)((function(){var r=new J(n._weightMap,c),i=s({},n.weightMap);Object.keys(t).forEach((function(e){i[e]=[t[e]]}));for(var o=n.getFrozenTensorIds(i),a={},u=0;u<l.length;u++){var h=l[u];if(!i[h.name]){var d=Q(h,i,r);if(d instanceof Promise)throw new Error("The execution of the op '"+h.op+"' returned a promise. Please use model.executeAsync() instead.");i[h.name]=d,n.checkTensorForDisposal(h.name,h,i,r,o,e,a)}}return e.map((function(t){return m(t,i,r)}))}))},t.prototype.getFrozenTensorIds=function(t){var e=[].concat.apply([],Object.keys(t).map((function(e){return t[e]})).map((function(t){return t.map((function(t){return t.id}))})));return new Set(e)},t.prototype.checkTensorForDisposal=function(t,e,n,r,i,o,a){"control"!==e.category&&-1===o.indexOf(t)&&(n[t].forEach((function(t){null!=t&&(a[t.id]=(a[t.id]||0)+e.children.length)})),e.inputs.forEach((function(t){if("control"!==t.category){var e=function(t,e,n){return e[y(t,n.currentContextId)]}(t.name,n,r);null!=e&&e.forEach((function(t){if(t&&!i.has(t.id)){var e=a[t.id];1===e?(t.dispose(),delete a[t.id]):null!=e&&a[t.id]--}}))}})))},t.prototype.executeAsync=function(t,e){return u(this,void 0,void 0,(function(){var n,r,i,o,a,s=this;return l(this,(function(u){switch(u.label){case 0:return this.checkInputs(t),this.checkInputShapeAndType(t),this.checkOutputs(e),n=new J(this._weightMap,{}),[4,this.executeWithControlFlow(t,n,e)];case 1:return r=u.sent(),i=e.map((function(t){return m(t,r,n)})),o=new Set(i.map((function(t){return t.id}))),a=new Set(Object.keys(t).map((function(e){return t[e].id}))),Object.keys(r).forEach((function(t){r[t].forEach((function(t){!t||t.isDisposed||o.has(t.id)||a.has(t.id)||-1!==s.weightIds.indexOf(t.id)||t.dispose()}))})),[2,i]}}))}))},t.prototype.executeWithControlFlow=function(t,e,n){return u(this,void 0,void 0,(function(){var r,i,o,a,u,c,h,d,f,p,g,y,b,w,x,_,C=this;return l(this,(function(l){switch(l.label){case 0:r=Object.keys(t),i=r.map((function(t){return C.graph.nodes[t]})),o=n.map((function(t){return C.graph.nodes[v(t)[0]]})),a=tt(t,o,this.weightMap),u=a.usedNodes,c=a.missingInputs,h=a.dynamicNode,d=a.syncInputs,f=i.concat(this.graph.weights).map((function(t){return{node:t,contexts:e.currentContext}})),p=s({},this.weightMap),Object.keys(t).forEach((function(e){p[e]=[t[e]]})),g={},y=this.getFrozenTensorIds(p),b={},l.label=1;case 1:return f.length>0?(w=this.processStack(i,f,e,p,b,y,n,g,u),[4,Promise.all(w)]):[3,3];case 2:return l.sent(),[3,1];case 3:if(null==h&&console.warn("This model execution did not contain any nodes with control flow or dynamic output shapes. You can use model.execute() instead."),(x=o.filter((function(t){return!rt(t)&&!m(t.name,p,e)})).map((function(t){return t.name}))).length>0)throw _="",null!=h&&(_="Alternatively, to avoid the dynamic ops, use model.execute() and specify the inputs ["+d+"]"),new Error("Cannot compute the outputs ["+x+"] from the provided inputs ["+r+"]. Consider providing the following inputs: ["+c+"]. "+_);return[2,p]}}))}))},t.prototype.processStack=function(t,e,n,r,i,o,a,s,u){for(var l=this,c=[],h=function(){var h=e.pop();n.currentContext=h.contexts;var f="";if("Enter"===h.node.op&&p("isConstant",h.node,r,n)&&(f=g(h.node.name,n)[0]),-1===t.indexOf(h.node)){var m=Q(h.node,r,n);f||(f=g(h.node.name,n)[0]);var y=n.currentContext;m instanceof Promise?c.push(m.then((function(t){return r[f]=t,n.currentContext=y,l.checkTensorForDisposal(f,h.node,r,n,o,a,s),l.processChildNodes(h.node,e,n,r,i,u),t}))):(r[f]=m,d.checkTensorForDisposal(f,h.node,r,n,o,a,s),d.processChildNodes(h.node,e,n,r,i,u))}else d.processChildNodes(h.node,e,n,r,i,u)},d=this;e.length>0;)h();return c},t.prototype.processChildNodes=function(t,e,n,r,i,o){t.children.forEach((function(t){var a=g(t.name,n)[0];!i[a]&&o.has(t.name)&&("Merge"===t.op?t.inputNames.some((function(t){return!!m(t,r,n)}))&&(i[a]=!0,e.push({contexts:n.currentContext,node:t})):t.inputNames.every((function(t){return!!m(t,r,n)}))&&(i[a]=!0,e.push({contexts:n.currentContext,node:t})))}))},t.prototype.dispose=function(){var t=this;Object.keys(this.weightMap).forEach((function(e){return t.weightMap[e].forEach((function(t){return t.dispose()}))}))},t.prototype.checkInputShapeAndType=function(t){var e=this;Object.keys(t).forEach((function(n){var r=t[n],i=e.graph.nodes[n];if(i.attrParams.shape&&i.attrParams.shape.value){var o=i.attrParams.shape.value,s=o.length===r.shape.length&&r.shape.every((function(t,e){return-1===o[e]||o[e]===t}));a.util.assert(s,(function(){return"The shape of dict['"+i.name+"'] provided in model.execute(dict) must be ["+o+"], but was ["+r.shape+"]"}))}i.attrParams.dtype&&i.attrParams.dtype.value&&a.util.assert(r.dtype===i.attrParams.dtype.value,(function(){return"The dtype of dict['"+i.name+"'] provided in model.execute(dict) must be "+i.attrParams.dtype.value+", but was "+r.dtype}))}))},t.prototype.checkInputs=function(t){var e=this,n=Object.keys(t).filter((function(t){return!e.graph.nodes[t]}));if(n.length>0)throw new Error("The dict provided in model.execute(dict) has keys: ["+n+"] that are not part of graph")},t.prototype.checkOutputs=function(t){var e=this;t.forEach((function(t){var n=v(t)[0];if(!e.graph.nodes[n])throw new Error("The output '"+t+"' is not found in the graph")}))},t}(),at=function(){function t(t,e){void 0===e&&(e={}),this.modelUrl=t,this.loadOptions=e,this.version="n/a",null==e&&(this.loadOptions={})}return Object.defineProperty(t.prototype,"modelVersion",{get:function(){return this.version},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"inputNodes",{get:function(){return this.executor.inputNodes},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"outputNodes",{get:function(){return this.executor.outputNodes},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"inputs",{get:function(){return this.executor.inputs},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"outputs",{get:function(){return this.executor.outputs},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"weights",{get:function(){return this.executor.weightMap},enumerable:!0,configurable:!0}),t.prototype.findIOHandler=function(){var t=this.modelUrl;if(null!=t.load)this.handler=t;else if(null!=this.loadOptions.requestInit)this.handler=a.io.browserHTTPRequest(t,this.loadOptions);else{var e=a.io.getLoadHandlers(t,this.loadOptions.onProgress);if(0===e.length)e.push(a.io.browserHTTPRequest(t,this.loadOptions));else if(e.length>1)throw new Error("Found more than one ("+e.length+") load handlers for URL '"+[t]+"'");this.handler=e[0]}},t.prototype.load=function(){return u(this,void 0,void 0,(function(){var t,e,n;return l(this,(function(r){switch(r.label){case 0:if(this.findIOHandler(),null==this.handler.load)throw new Error("Cannot proceed with model loading because the IOHandler provided does not have the `load` method implemented.");return[4,this.handler.load()];case 1:return t=r.sent(),this.version=(e=t.modelTopology).versions.producer+"."+e.versions.minConsumer,n=a.io.decodeWeights(t.weightData,t.weightSpecs),this.executor=new ot(P.Instance.transformGraph(e)),this.executor.weightMap=this.convertTensorMapToTensorsMap(n),[2,!0]}}))}))},t.prototype.predict=function(t,e){return this.execute(t,this.outputNodes)},t.prototype.normalizeInputs=function(t){if(!(t instanceof a.Tensor||Array.isArray(t)))return t;if((t=Array.isArray(t)?t:[t]).length!==this.inputNodes.length)throw new Error("Input tensor count mismatch,the graph model has "+this.inputNodes.length+" placeholders, while there are "+t.length+" input tensors.");return this.inputNodes.reduce((function(e,n,r){return e[n]=t[r],e}),{})},t.prototype.normalizeOutputs=function(t){return t=t||this.outputNodes,Array.isArray(t)?t:[t]},t.prototype.execute=function(t,e){t=this.normalizeInputs(t),e=this.normalizeOutputs(e);var n=this.executor.execute(t,e);return n.length>1?n:n[0]},t.prototype.executeAsync=function(t,e){return u(this,void 0,void 0,(function(){var n;return l(this,(function(r){switch(r.label){case 0:return t=this.normalizeInputs(t),e=this.normalizeOutputs(e),[4,this.executor.executeAsync(t,e)];case 1:return[2,(n=r.sent()).length>1?n:n[0]]}}))}))},t.prototype.convertTensorMapToTensorsMap=function(t){return Object.keys(t).reduce((function(e,n){return e[n]=[t[n]],e}),{})},t.prototype.dispose=function(){this.executor.dispose()},t}();function st(t,e){return void 0===e&&(e={}),u(this,void 0,void 0,(function(){var n;return l(this,(function(r){switch(r.label){case 0:if(null==t)throw new Error("modelUrl in loadGraphModel() cannot be null. Please provide a url or an IOHandler that loads the model");return null==e&&(e={}),e.fromTFHub&&null==t.load&&(t.endsWith("/")||(t+="/"),t+="model.json?tfjs-format=file"),[4,(n=new at(t,e)).load()];case 1:return r.sent(),[2,n]}}))}))}var ut="1.2.11"},uGx6:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t){for(var e in t){var n=(0,o.default)(y,e,t[e],t,v);n&&(t[e]=n),(0,i.default)(v,e,t)}return t};var r=g(n("e575")),i=g(n("djh3")),o=g(n("Pp8E")),a=g(n("homf")),s=g(n("qvkj")),u=g(n("7ZGM")),l=g(n("9eqh")),c=g(n("ytq/")),h=g(n("6fql")),d=g(n("2KGH")),f=g(n("hAya")),p=g(n("uVON")),m=g(n("c0yS"));function g(t){return t&&t.__esModule?t:{default:t}}var y=[s.default,a.default,u.default,c.default,h.default,d.default,f.default,p.default,m.default,l.default],v=r.default.prefixMap},uVON:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e){if(i.hasOwnProperty(t)&&o.hasOwnProperty(e))return r.map((function(t){return t+e}))};var r=["-webkit-","-moz-",""],i={maxHeight:!0,maxWidth:!0,width:!0,height:!0,columnWidth:!0,minWidth:!0,minHeight:!0},o={"min-content":!0,"max-content":!0,"fill-available":!0,"fit-content":!0,"contain-floats":!0};t.exports=e.default},v20e:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t};e.PluginSet=u,e.fallbacks=function(t){if(Object.keys(t.style).map((function(e){return Array.isArray(t.style[e])})).indexOf(!0)>=0){var e=t.style,n=Object.keys(e).reduce((function(t,n){return t[n]=Array.isArray(e[n])?e[n].join("; "+(0,o.processStyleName)(n)+": "):e[n],t}),{});return(0,i.default)({},t,{style:n})}return t},e.contentWrap=function(t){if(t.style.content){var e=t.style.content;return l.indexOf(e)>=0||/^(attr|calc|counters?|url)\(/.test(e)?t:e.charAt(0)!==e.charAt(e.length-1)||'"'!==e.charAt(0)&&"'"!==e.charAt(0)?r({},t,{style:r({},t.style,{content:'"'+e+'"'})}):t}return t},e.prefixes=function(t){return(0,i.default)({},t,{style:(0,a.default)(r({},t.style))})};var i=s(n("MgzW")),o=n("msJK"),a=s(n("uGx6"));function s(t){return t&&t.__esModule?t:{default:t}}function u(t){this.fns=t||[]}(0,i.default)(u.prototype,{add:function(){for(var t=this,e=arguments.length,n=Array(e),r=0;r<e;r++)n[r]=arguments[r];n.forEach((function(e){t.fns.indexOf(e)>=0||(t.fns=[e].concat(t.fns))}))},remove:function(t){this.fns=this.fns.filter((function(e){return e!==t}))},clear:function(){this.fns=[]},transform:function(t){return this.fns.reduce((function(t,e){return e(t)}),t)}});var l=["normal","none","counter","open-quote","close-quote","no-open-quote","no-close-quote","initial","inherit"]},v6YA:function(t,e,n){const r=n("MpxT"),i=n("8GxW");t.exports=(t,e,n)=>{const o=[];let a=null,s=null;const u=t.sort((t,e)=>i(t,e,n));for(const i of u)r(i,e,n)?(s=i,a||(a=i)):(s&&o.push([a,s]),s=null,a=null);a&&o.push([a,null]);const l=[];for(const[r,i]of o)l.push(r===i?r:i||r!==u[0]?i?r===u[0]?"<="+i:`${r} - ${i}`:">="+r:"*");const c=l.join(" || "),h="string"==typeof e.raw?e.raw:String(e);return c.length<h.length?c:e}},vWdZ:function(t,e,n){"use strict";var r=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(e){o(e)}}function s(t){try{u(r.throw(t))}catch(e){o(e)}}function u(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(a,s)}u((r=r.apply(t,e||[])).next())}))},i=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e},o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const a=i(n("C1Pg")),s=o(n("etOl")),u=n("Ewl0"),l=n("YYB2"),c=n("jke5");function h(t,e,n){const r=t instanceof a.Tensor?t.shape:[t.length,t[0].length];0===n?l.assert(r[0]===e.length,`Length of xTickLabels (${e.length}) must match number of rows (${r[0]})`):1===n&&l.assert(r[1]===e.length,`Length of yTickLabels (${e.length}) must match number of columns (${r[1]})`)}e.heatmap=function(t,e,n={}){return r(this,void 0,void 0,(function*(){const i=Object.assign({},d,n),o=c.getDrawArea(t);let f=e.values;i.rowMajor&&(f=yield function(t){return r(this,void 0,void 0,(function*(){let e,n;t instanceof a.Tensor?(e=t.shape,n=t.transpose()):(e=[t.length,t[0].length],n=a.tidy(()=>a.tensor2d(t).transpose())),l.assert(2===n.rank,"Input to renderHeatmap must be a 2d array or Tensor2d");const r=yield n.array();n.dispose();const i=[r.length,r[0].length];return l.assert(e[0]===i[1]&&e[1]===i[0],`Unexpected transposed shape. Original ${e} : Transposed ${i}`),r}))}(e.values));const{xTickLabels:p,yTickLabels:m}=e;null!=p&&h(f,p,0),null!=m&&h(f,m,1);const g=[];if(f instanceof a.Tensor){l.assert(2===f.rank,"Input to renderHeatmap must be a 2d array or Tensor2d");const t=yield f.data(),[e,n]=f.shape;for(let r=0;r<e;r++){const e=p?`${p[r]}@tfidx@${r}`:r;for(let i=0;i<n;i++)g.push({x:e,y:m?`${m[i]}@tfidx@${i}`:i,value:t[r*n+i]})}}else{const t=f;for(let e=0;e<t.length;e++){const n=p?`${p[e]}@tfidx@${e}`:e;for(let r=0;r<t[e].length;r++)g.push({x:n,y:m?`${m[r]}@tfidx@${r}`:r,value:t[e][r]})}}const y={actions:!1,mode:"vega-lite",defaultStyle:!1},v={width:i.width||u.getDefaultWidth(o),height:i.height||u.getDefaultHeight(o),padding:0,autosize:{type:"fit",contains:"padding",resize:!0},config:{axis:{labelFontSize:i.fontSize,titleFontSize:i.fontSize},text:{fontSize:i.fontSize},legend:{labelFontSize:i.fontSize,titleFontSize:i.fontSize},scale:{bandPaddingInner:0,bandPaddingOuter:0}},data:{values:g},mark:{type:"rect",tooltip:!0},encoding:{x:{field:"x",type:i.xType,title:i.xLabel,sort:"x"},y:{field:"y",type:i.yType,title:i.yLabel,sort:"y"},fill:{field:"value",type:"quantitative"}}},b=new RegExp("@tfidx@\\d+$");let w;switch(p&&(v.encoding.x.axis={labelExpr:"replace(datum.value, regexp(/@tfidx@\\d+$/), '')"}),m&&(v.encoding.y.axis={labelExpr:"replace(datum.value, regexp(/@tfidx@\\d+$/), '')"}),(p||m)&&(y.tooltip={sanitize:t=>String(t).replace(b,"")}),i.colorMap){case"blues":w=["#f7fbff","#4292c6"];break;case"greyscale":w=["#000000","#ffffff"];break;case"viridis":default:w="viridis"}if("viridis"!==w&&(v.encoding.fill.scale={range:w}),i.domain){const t=v.encoding.fill;t.scale=null!=t.scale?Object.assign({},t.scale,{domain:i.domain}):{domain:i.domain}}yield s.default(o,v,y)}))};const d={xLabel:null,yLabel:null,xType:"ordinal",yType:"ordinal",colorMap:"viridis",fontSize:12,domain:null,rowMajor:!1}},vwDW:function(t,e,n){const r=Symbol("SemVer ANY");class i{static get ANY(){return r}constructor(t,e){if(e&&"object"==typeof e||(e={loose:!!e,includePrerelease:!1}),t instanceof i){if(t.loose===!!e.loose)return t;t=t.value}u("comparator",t,e),this.options=e,this.loose=!!e.loose,this.parse(t),this.value=this.semver===r?"":this.operator+this.semver.version,u("comp",this)}parse(t){const e=t.match(this.options.loose?o[a.COMPARATORLOOSE]:o[a.COMPARATOR]);if(!e)throw new TypeError("Invalid comparator: "+t);this.operator=void 0!==e[1]?e[1]:"","="===this.operator&&(this.operator=""),this.semver=e[2]?new l(e[2],this.options.loose):r}toString(){return this.value}test(t){if(u("Comparator.test",t,this.options.loose),this.semver===r||t===r)return!0;if("string"==typeof t)try{t=new l(t,this.options)}catch(e){return!1}return s(t,this.operator,this.semver,this.options)}intersects(t,e){if(!(t instanceof i))throw new TypeError("a Comparator is required");if(e&&"object"==typeof e||(e={loose:!!e,includePrerelease:!1}),""===this.operator)return""===this.value||new c(t.value,e).test(this.value);if(""===t.operator)return""===t.value||new c(this.value,e).test(t.semver);const n=!(">="!==this.operator&&">"!==this.operator||">="!==t.operator&&">"!==t.operator),r=!("<="!==this.operator&&"<"!==this.operator||"<="!==t.operator&&"<"!==t.operator),o=this.semver.version===t.semver.version,a=!(">="!==this.operator&&"<="!==this.operator||">="!==t.operator&&"<="!==t.operator),u=s(this.semver,"<",t.semver,e)&&(">="===this.operator||">"===this.operator)&&("<="===t.operator||"<"===t.operator),l=s(this.semver,">",t.semver,e)&&("<="===this.operator||"<"===this.operator)&&(">="===t.operator||">"===t.operator);return n||r||o&&a||u||l}}t.exports=i;const{re:o,t:a}=n("IsDc"),s=n("VMJL"),u=n("DXxi"),l=n("3wIk"),c=n("ex/Z")},xfvg:function(t,e,n){const r=n("8GxW");t.exports=(t,e,n)=>0===r(t,e,n)},yLV6:function(t,e,n){var r;!function(i,o,a,s){"use strict";var u,l=["","webkit","Moz","MS","ms","o"],c=o.createElement("div"),h=Math.round,d=Math.abs,f=Date.now;function p(t,e,n){return setTimeout(x(t,n),e)}function m(t,e,n){return!!Array.isArray(t)&&(g(t,n[e],n),!0)}function g(t,e,n){var r;if(t)if(t.forEach)t.forEach(e,n);else if(void 0!==t.length)for(r=0;r<t.length;)e.call(n,t[r],r,t),r++;else for(r in t)t.hasOwnProperty(r)&&e.call(n,t[r],r,t)}function y(t,e,n){var r="DEPRECATED METHOD: "+e+"\n"+n+" AT \n";return function(){var e=new Error("get-stack-trace"),n=e&&e.stack?e.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",o=i.console&&(i.console.warn||i.console.log);return o&&o.call(i.console,r,n),t.apply(this,arguments)}}u="function"!=typeof Object.assign?function(t){if(null==t)throw new TypeError("Cannot convert undefined or null to object");for(var e=Object(t),n=1;n<arguments.length;n++){var r=arguments[n];if(null!=r)for(var i in r)r.hasOwnProperty(i)&&(e[i]=r[i])}return e}:Object.assign;var v=y((function(t,e,n){for(var r=Object.keys(e),i=0;i<r.length;)(!n||n&&void 0===t[r[i]])&&(t[r[i]]=e[r[i]]),i++;return t}),"extend","Use `assign`."),b=y((function(t,e){return v(t,e,!0)}),"merge","Use `assign`.");function w(t,e,n){var r,i=e.prototype;(r=t.prototype=Object.create(i)).constructor=t,r._super=i,n&&u(r,n)}function x(t,e){return function(){return t.apply(e,arguments)}}function _(t,e){return"function"==typeof t?t.apply(e&&e[0]||void 0,e):t}function C(t,e){return void 0===t?e:t}function k(t,e,n){g(A(e),(function(e){t.addEventListener(e,n,!1)}))}function S(t,e,n){g(A(e),(function(e){t.removeEventListener(e,n,!1)}))}function E(t,e){for(;t;){if(t==e)return!0;t=t.parentNode}return!1}function O(t,e){return t.indexOf(e)>-1}function A(t){return t.trim().split(/\s+/g)}function N(t,e,n){if(t.indexOf&&!n)return t.indexOf(e);for(var r=0;r<t.length;){if(n&&t[r][n]==e||!n&&t[r]===e)return r;r++}return-1}function T(t){return Array.prototype.slice.call(t,0)}function D(t,e,n){for(var r=[],i=[],o=0;o<t.length;){var a=e?t[o][e]:t[o];N(i,a)<0&&r.push(t[o]),i[o]=a,o++}return n&&(r=e?r.sort((function(t,n){return t[e]>n[e]})):r.sort()),r}function R(t,e){for(var n,r,i=e[0].toUpperCase()+e.slice(1),o=0;o<l.length;){if((r=(n=l[o])?n+i:e)in t)return r;o++}}var I=1;function M(t){var e=t.ownerDocument||t;return e.defaultView||e.parentWindow||i}var F="ontouchstart"in i,P=void 0!==R(i,"PointerEvent"),j=F&&/mobile|tablet|ip(ad|hone|od)|android/i.test(navigator.userAgent),z=["x","y"],L=["clientX","clientY"];function B(t,e){var n=this;this.manager=t,this.callback=e,this.element=t.element,this.target=t.options.inputTarget,this.domHandler=function(e){_(t.options.enable,[t])&&n.handler(e)},this.init()}function U(t,e,n){var r=n.pointers.length,i=n.changedPointers.length,o=1&e&&r-i==0,a=12&e&&r-i==0;n.isFirst=!!o,n.isFinal=!!a,o&&(t.session={}),n.eventType=e,function(t,e){var n=t.session,r=e.pointers,i=r.length;n.firstInput||(n.firstInput=$(e)),i>1&&!n.firstMultiple?n.firstMultiple=$(e):1===i&&(n.firstMultiple=!1);var o=n.firstInput,a=n.firstMultiple,s=a?a.center:o.center,u=e.center=V(r);e.timeStamp=f(),e.deltaTime=e.timeStamp-o.timeStamp,e.angle=G(s,u),e.distance=H(s,u),function(t,e){var n=e.center,r=t.offsetDelta||{},i=t.prevDelta||{},o=t.prevInput||{};1!==e.eventType&&4!==o.eventType||(i=t.prevDelta={x:o.deltaX||0,y:o.deltaY||0},r=t.offsetDelta={x:n.x,y:n.y}),e.deltaX=i.x+(n.x-r.x),e.deltaY=i.y+(n.y-r.y)}(n,e),e.offsetDirection=q(e.deltaX,e.deltaY);var l,c,h=W(e.deltaTime,e.deltaX,e.deltaY);e.overallVelocityX=h.x,e.overallVelocityY=h.y,e.overallVelocity=d(h.x)>d(h.y)?h.x:h.y,e.scale=a?(l=a.pointers,H((c=r)[0],c[1],L)/H(l[0],l[1],L)):1,e.rotation=a?function(t,e){return G(e[1],e[0],L)+G(t[1],t[0],L)}(a.pointers,r):0,e.maxPointers=n.prevInput?e.pointers.length>n.prevInput.maxPointers?e.pointers.length:n.prevInput.maxPointers:e.pointers.length,function(t,e){var n,r,i,o,a=t.lastInterval||e,s=e.timeStamp-a.timeStamp;if(8!=e.eventType&&(s>25||void 0===a.velocity)){var u=e.deltaX-a.deltaX,l=e.deltaY-a.deltaY,c=W(s,u,l);r=c.x,i=c.y,n=d(c.x)>d(c.y)?c.x:c.y,o=q(u,l),t.lastInterval=e}else n=a.velocity,r=a.velocityX,i=a.velocityY,o=a.direction;e.velocity=n,e.velocityX=r,e.velocityY=i,e.direction=o}(n,e);var p=t.element;E(e.srcEvent.target,p)&&(p=e.srcEvent.target),e.target=p}(t,n),t.emit("hammer.input",n),t.recognize(n),t.session.prevInput=n}function $(t){for(var e=[],n=0;n<t.pointers.length;)e[n]={clientX:h(t.pointers[n].clientX),clientY:h(t.pointers[n].clientY)},n++;return{timeStamp:f(),pointers:e,center:V(e),deltaX:t.deltaX,deltaY:t.deltaY}}function V(t){var e=t.length;if(1===e)return{x:h(t[0].clientX),y:h(t[0].clientY)};for(var n=0,r=0,i=0;i<e;)n+=t[i].clientX,r+=t[i].clientY,i++;return{x:h(n/e),y:h(r/e)}}function W(t,e,n){return{x:e/t||0,y:n/t||0}}function q(t,e){return t===e?1:d(t)>=d(e)?t<0?2:4:e<0?8:16}function H(t,e,n){n||(n=z);var r=e[n[0]]-t[n[0]],i=e[n[1]]-t[n[1]];return Math.sqrt(r*r+i*i)}function G(t,e,n){return n||(n=z),180*Math.atan2(e[n[1]]-t[n[1]],e[n[0]]-t[n[0]])/Math.PI}B.prototype={handler:function(){},init:function(){this.evEl&&k(this.element,this.evEl,this.domHandler),this.evTarget&&k(this.target,this.evTarget,this.domHandler),this.evWin&&k(M(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&S(this.element,this.evEl,this.domHandler),this.evTarget&&S(this.target,this.evTarget,this.domHandler),this.evWin&&S(M(this.element),this.evWin,this.domHandler)}};var X={mousedown:1,mousemove:2,mouseup:4};function K(){this.evEl="mousedown",this.evWin="mousemove mouseup",this.pressed=!1,B.apply(this,arguments)}w(K,B,{handler:function(t){var e=X[t.type];1&e&&0===t.button&&(this.pressed=!0),2&e&&1!==t.which&&(e=4),this.pressed&&(4&e&&(this.pressed=!1),this.callback(this.manager,e,{pointers:[t],changedPointers:[t],pointerType:"mouse",srcEvent:t}))}});var Y={pointerdown:1,pointermove:2,pointerup:4,pointercancel:8,pointerout:8},Z={2:"touch",3:"pen",4:"mouse",5:"kinect"},Q="pointerdown",J="pointermove pointerup pointercancel";function tt(){this.evEl=Q,this.evWin=J,B.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}i.MSPointerEvent&&!i.PointerEvent&&(Q="MSPointerDown",J="MSPointerMove MSPointerUp MSPointerCancel"),w(tt,B,{handler:function(t){var e=this.store,n=!1,r=t.type.toLowerCase().replace("ms",""),i=Y[r],o=Z[t.pointerType]||t.pointerType,a="touch"==o,s=N(e,t.pointerId,"pointerId");1&i&&(0===t.button||a)?s<0&&(e.push(t),s=e.length-1):12&i&&(n=!0),s<0||(e[s]=t,this.callback(this.manager,i,{pointers:e,changedPointers:[t],pointerType:o,srcEvent:t}),n&&e.splice(s,1))}});var et={touchstart:1,touchmove:2,touchend:4,touchcancel:8};function nt(){this.evTarget="touchstart",this.evWin="touchstart touchmove touchend touchcancel",this.started=!1,B.apply(this,arguments)}function rt(t,e){var n=T(t.touches),r=T(t.changedTouches);return 12&e&&(n=D(n.concat(r),"identifier",!0)),[n,r]}w(nt,B,{handler:function(t){var e=et[t.type];if(1===e&&(this.started=!0),this.started){var n=rt.call(this,t,e);12&e&&n[0].length-n[1].length==0&&(this.started=!1),this.callback(this.manager,e,{pointers:n[0],changedPointers:n[1],pointerType:"touch",srcEvent:t})}}});var it={touchstart:1,touchmove:2,touchend:4,touchcancel:8};function ot(){this.evTarget="touchstart touchmove touchend touchcancel",this.targetIds={},B.apply(this,arguments)}function at(t,e){var n=T(t.touches),r=this.targetIds;if(3&e&&1===n.length)return r[n[0].identifier]=!0,[n,n];var i,o,a=T(t.changedTouches),s=[],u=this.target;if(o=n.filter((function(t){return E(t.target,u)})),1===e)for(i=0;i<o.length;)r[o[i].identifier]=!0,i++;for(i=0;i<a.length;)r[a[i].identifier]&&s.push(a[i]),12&e&&delete r[a[i].identifier],i++;return s.length?[D(o.concat(s),"identifier",!0),s]:void 0}function st(){B.apply(this,arguments);var t=x(this.handler,this);this.touch=new ot(this.manager,t),this.mouse=new K(this.manager,t),this.primaryTouch=null,this.lastTouches=[]}function ut(t,e){1&t?(this.primaryTouch=e.changedPointers[0].identifier,lt.call(this,e)):12&t&&lt.call(this,e)}function lt(t){var e=t.changedPointers[0];if(e.identifier===this.primaryTouch){var n={x:e.clientX,y:e.clientY};this.lastTouches.push(n);var r=this.lastTouches;setTimeout((function(){var t=r.indexOf(n);t>-1&&r.splice(t,1)}),2500)}}function ct(t){for(var e=t.srcEvent.clientX,n=t.srcEvent.clientY,r=0;r<this.lastTouches.length;r++){var i=this.lastTouches[r],o=Math.abs(e-i.x),a=Math.abs(n-i.y);if(o<=25&&a<=25)return!0}return!1}w(ot,B,{handler:function(t){var e=it[t.type],n=at.call(this,t,e);n&&this.callback(this.manager,e,{pointers:n[0],changedPointers:n[1],pointerType:"touch",srcEvent:t})}}),w(st,B,{handler:function(t,e,n){var r="mouse"==n.pointerType;if(!(r&&n.sourceCapabilities&&n.sourceCapabilities.firesTouchEvents)){if("touch"==n.pointerType)ut.call(this,e,n);else if(r&&ct.call(this,n))return;this.callback(t,e,n)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});var ht=R(c.style,"touchAction"),dt=void 0!==ht,ft=function(){if(!dt)return!1;var t={},e=i.CSS&&i.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach((function(n){t[n]=!e||i.CSS.supports("touch-action",n)})),t}();function pt(t,e){this.manager=t,this.set(e)}function mt(t){this.options=u({},this.defaults,t||{}),this.id=I++,this.manager=null,this.options.enable=C(this.options.enable,!0),this.state=1,this.simultaneous={},this.requireFail=[]}function gt(t){return 16&t?"cancel":8&t?"end":4&t?"move":2&t?"start":""}function yt(t){return 16==t?"down":8==t?"up":2==t?"left":4==t?"right":""}function vt(t,e){var n=e.manager;return n?n.get(t):t}function bt(){mt.apply(this,arguments)}function wt(){bt.apply(this,arguments),this.pX=null,this.pY=null}function xt(){bt.apply(this,arguments)}function _t(){mt.apply(this,arguments),this._timer=null,this._input=null}function Ct(){bt.apply(this,arguments)}function kt(){bt.apply(this,arguments)}function St(){mt.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}function Et(t,e){return(e=e||{}).recognizers=C(e.recognizers,Et.defaults.preset),new Ot(t,e)}function Ot(t,e){var n;this.options=u({},Et.defaults,e||{}),this.options.inputTarget=this.options.inputTarget||t,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=t,this.input=new((n=this).options.inputClass||(P?tt:j?ot:F?st:K))(n,U),this.touchAction=new pt(this,this.options.touchAction),At(this,!0),g(this.options.recognizers,(function(t){var e=this.add(new t[0](t[1]));t[2]&&e.recognizeWith(t[2]),t[3]&&e.requireFailure(t[3])}),this)}function At(t,e){var n,r=t.element;r.style&&(g(t.options.cssProps,(function(i,o){n=R(r.style,o),e?(t.oldCssProps[n]=r.style[n],r.style[n]=i):r.style[n]=t.oldCssProps[n]||""})),e||(t.oldCssProps={}))}pt.prototype={set:function(t){"compute"==t&&(t=this.compute()),dt&&this.manager.element.style&&ft[t]&&(this.manager.element.style[ht]=t),this.actions=t.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var t=[];return g(this.manager.recognizers,(function(e){_(e.options.enable,[e])&&(t=t.concat(e.getTouchAction()))})),function(t){if(O(t,"none"))return"none";var e=O(t,"pan-x"),n=O(t,"pan-y");return e&&n?"none":e||n?e?"pan-x":"pan-y":O(t,"manipulation")?"manipulation":"auto"}(t.join(" "))},preventDefaults:function(t){var e=t.srcEvent,n=t.offsetDirection;if(this.manager.session.prevented)e.preventDefault();else{var r=this.actions,i=O(r,"none")&&!ft.none,o=O(r,"pan-y")&&!ft["pan-y"],a=O(r,"pan-x")&&!ft["pan-x"];if(i&&1===t.pointers.length&&t.distance<2&&t.deltaTime<250)return;if(!a||!o)return i||o&&6&n||a&&24&n?this.preventSrc(e):void 0}},preventSrc:function(t){this.manager.session.prevented=!0,t.preventDefault()}},mt.prototype={defaults:{},set:function(t){return u(this.options,t),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(t){if(m(t,"recognizeWith",this))return this;var e=this.simultaneous;return e[(t=vt(t,this)).id]||(e[t.id]=t,t.recognizeWith(this)),this},dropRecognizeWith:function(t){return m(t,"dropRecognizeWith",this)||(t=vt(t,this),delete this.simultaneous[t.id]),this},requireFailure:function(t){if(m(t,"requireFailure",this))return this;var e=this.requireFail;return-1===N(e,t=vt(t,this))&&(e.push(t),t.requireFailure(this)),this},dropRequireFailure:function(t){if(m(t,"dropRequireFailure",this))return this;t=vt(t,this);var e=N(this.requireFail,t);return e>-1&&this.requireFail.splice(e,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(t){return!!this.simultaneous[t.id]},emit:function(t){var e=this,n=this.state;function r(n){e.manager.emit(n,t)}n<8&&r(e.options.event+gt(n)),r(e.options.event),t.additionalEvent&&r(t.additionalEvent),n>=8&&r(e.options.event+gt(n))},tryEmit:function(t){if(this.canEmit())return this.emit(t);this.state=32},canEmit:function(){for(var t=0;t<this.requireFail.length;){if(!(33&this.requireFail[t].state))return!1;t++}return!0},recognize:function(t){var e=u({},t);if(!_(this.options.enable,[this,e]))return this.reset(),void(this.state=32);56&this.state&&(this.state=1),this.state=this.process(e),30&this.state&&this.tryEmit(e)},process:function(t){},getTouchAction:function(){},reset:function(){}},w(bt,mt,{defaults:{pointers:1},attrTest:function(t){var e=this.options.pointers;return 0===e||t.pointers.length===e},process:function(t){var e=this.state,n=t.eventType,r=6&e,i=this.attrTest(t);return r&&(8&n||!i)?16|e:r||i?4&n?8|e:2&e?4|e:2:32}}),w(wt,bt,{defaults:{event:"pan",threshold:10,pointers:1,direction:30},getTouchAction:function(){var t=this.options.direction,e=[];return 6&t&&e.push("pan-y"),24&t&&e.push("pan-x"),e},directionTest:function(t){var e=this.options,n=!0,r=t.distance,i=t.direction,o=t.deltaX,a=t.deltaY;return i&e.direction||(6&e.direction?(i=0===o?1:o<0?2:4,n=o!=this.pX,r=Math.abs(t.deltaX)):(i=0===a?1:a<0?8:16,n=a!=this.pY,r=Math.abs(t.deltaY))),t.direction=i,n&&r>e.threshold&&i&e.direction},attrTest:function(t){return bt.prototype.attrTest.call(this,t)&&(2&this.state||!(2&this.state)&&this.directionTest(t))},emit:function(t){this.pX=t.deltaX,this.pY=t.deltaY;var e=yt(t.direction);e&&(t.additionalEvent=this.options.event+e),this._super.emit.call(this,t)}}),w(xt,bt,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return["none"]},attrTest:function(t){return this._super.attrTest.call(this,t)&&(Math.abs(t.scale-1)>this.options.threshold||2&this.state)},emit:function(t){1!==t.scale&&(t.additionalEvent=this.options.event+(t.scale<1?"in":"out")),this._super.emit.call(this,t)}}),w(_t,mt,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return["auto"]},process:function(t){var e=this.options,n=t.pointers.length===e.pointers,r=t.distance<e.threshold,i=t.deltaTime>e.time;if(this._input=t,!r||!n||12&t.eventType&&!i)this.reset();else if(1&t.eventType)this.reset(),this._timer=p((function(){this.state=8,this.tryEmit()}),e.time,this);else if(4&t.eventType)return 8;return 32},reset:function(){clearTimeout(this._timer)},emit:function(t){8===this.state&&(t&&4&t.eventType?this.manager.emit(this.options.event+"up",t):(this._input.timeStamp=f(),this.manager.emit(this.options.event,this._input)))}}),w(Ct,bt,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return["none"]},attrTest:function(t){return this._super.attrTest.call(this,t)&&(Math.abs(t.rotation)>this.options.threshold||2&this.state)}}),w(kt,bt,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:30,pointers:1},getTouchAction:function(){return wt.prototype.getTouchAction.call(this)},attrTest:function(t){var e,n=this.options.direction;return 30&n?e=t.overallVelocity:6&n?e=t.overallVelocityX:24&n&&(e=t.overallVelocityY),this._super.attrTest.call(this,t)&&n&t.offsetDirection&&t.distance>this.options.threshold&&t.maxPointers==this.options.pointers&&d(e)>this.options.velocity&&4&t.eventType},emit:function(t){var e=yt(t.offsetDirection);e&&this.manager.emit(this.options.event+e,t),this.manager.emit(this.options.event,t)}}),w(St,mt,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return["manipulation"]},process:function(t){var e=this.options,n=t.pointers.length===e.pointers,r=t.distance<e.threshold,i=t.deltaTime<e.time;if(this.reset(),1&t.eventType&&0===this.count)return this.failTimeout();if(r&&i&&n){if(4!=t.eventType)return this.failTimeout();var o=!this.pTime||t.timeStamp-this.pTime<e.interval,a=!this.pCenter||H(this.pCenter,t.center)<e.posThreshold;if(this.pTime=t.timeStamp,this.pCenter=t.center,a&&o?this.count+=1:this.count=1,this._input=t,0==this.count%e.taps)return this.hasRequireFailures()?(this._timer=p((function(){this.state=8,this.tryEmit()}),e.interval,this),2):8}return 32},failTimeout:function(){return this._timer=p((function(){this.state=32}),this.options.interval,this),32},reset:function(){clearTimeout(this._timer)},emit:function(){8==this.state&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}}),Et.VERSION="2.0.7",Et.defaults={domEvents:!1,touchAction:"compute",enable:!0,inputTarget:null,inputClass:null,preset:[[Ct,{enable:!1}],[xt,{enable:!1},["rotate"]],[kt,{direction:6}],[wt,{direction:6},["swipe"]],[St],[St,{event:"doubletap",taps:2},["tap"]],[_t]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}},Ot.prototype={set:function(t){return u(this.options,t),t.touchAction&&this.touchAction.update(),t.inputTarget&&(this.input.destroy(),this.input.target=t.inputTarget,this.input.init()),this},stop:function(t){this.session.stopped=t?2:1},recognize:function(t){var e=this.session;if(!e.stopped){var n;this.touchAction.preventDefaults(t);var r=this.recognizers,i=e.curRecognizer;(!i||i&&8&i.state)&&(i=e.curRecognizer=null);for(var o=0;o<r.length;)n=r[o],2===e.stopped||i&&n!=i&&!n.canRecognizeWith(i)?n.reset():n.recognize(t),!i&&14&n.state&&(i=e.curRecognizer=n),o++}},get:function(t){if(t instanceof mt)return t;for(var e=this.recognizers,n=0;n<e.length;n++)if(e[n].options.event==t)return e[n];return null},add:function(t){if(m(t,"add",this))return this;var e=this.get(t.options.event);return e&&this.remove(e),this.recognizers.push(t),t.manager=this,this.touchAction.update(),t},remove:function(t){if(m(t,"remove",this))return this;if(t=this.get(t)){var e=this.recognizers,n=N(e,t);-1!==n&&(e.splice(n,1),this.touchAction.update())}return this},on:function(t,e){if(void 0!==t&&void 0!==e){var n=this.handlers;return g(A(t),(function(t){n[t]=n[t]||[],n[t].push(e)})),this}},off:function(t,e){if(void 0!==t){var n=this.handlers;return g(A(t),(function(t){e?n[t]&&n[t].splice(N(n[t],e),1):delete n[t]})),this}},emit:function(t,e){this.options.domEvents&&function(t,e){var n=o.createEvent("Event");n.initEvent(t,!0,!0),n.gesture=e,e.target.dispatchEvent(n)}(t,e);var n=this.handlers[t]&&this.handlers[t].slice();if(n&&n.length){e.type=t,e.preventDefault=function(){e.srcEvent.preventDefault()};for(var r=0;r<n.length;)n[r](e),r++}},destroy:function(){this.element&&At(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}},u(Et,{INPUT_START:1,INPUT_MOVE:2,INPUT_END:4,INPUT_CANCEL:8,STATE_POSSIBLE:1,STATE_BEGAN:2,STATE_CHANGED:4,STATE_ENDED:8,STATE_RECOGNIZED:8,STATE_CANCELLED:16,STATE_FAILED:32,DIRECTION_NONE:1,DIRECTION_LEFT:2,DIRECTION_RIGHT:4,DIRECTION_UP:8,DIRECTION_DOWN:16,DIRECTION_HORIZONTAL:6,DIRECTION_VERTICAL:24,DIRECTION_ALL:30,Manager:Ot,Input:B,TouchAction:pt,TouchInput:ot,MouseInput:K,PointerEventInput:tt,TouchMouseInput:st,SingleTouchInput:nt,Recognizer:mt,AttrRecognizer:bt,Tap:St,Pan:wt,Swipe:kt,Pinch:xt,Rotate:Ct,Press:_t,on:k,off:S,each:g,merge:b,extend:v,assign:u,inherit:w,bindFn:x,prefixed:R}),(void 0!==i?i:"undefined"!=typeof self?self:{}).Hammer=Et,void 0===(r=(function(){return Et}).call(e,n,e,t))||(t.exports=r)}(window,document)},ygsx:function(t,e,n){const r=n("3wIk"),i=n("ex/Z");t.exports=(t,e,n)=>{let o=null,a=null,s=null;try{s=new i(e,n)}catch(u){return null}return t.forEach(t=>{s.test(t)&&(o&&1!==a.compare(t)||(o=t,a=new r(o,n)))}),o}},"ytq/":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e,n){"flexDirection"===t&&"string"==typeof e&&(n.WebkitBoxOrient=e.indexOf("column")>-1?"vertical":"horizontal",n.WebkitBoxDirection=e.indexOf("reverse")>-1?"reverse":"normal"),i.hasOwnProperty(t)&&(n[i[t]]=r[e]||e)};var r={"space-around":"justify","space-between":"justify","flex-start":"start","flex-end":"end","wrap-reverse":"multiple",wrap:"multiple"},i={alignItems:"WebkitBoxAlign",justifyContent:"WebkitBoxPack",flexWrap:"WebkitBoxLines"};t.exports=e.default},zUnb:function(t,e,n){"use strict";function r(t){return"function"==typeof t}n.r(e);let i=!1;const o={Promise:void 0,set useDeprecatedSynchronousErrorHandling(t){if(t){const t=new Error;console.warn("DEPRECATED! RxJS was set to use deprecated synchronous error handling behavior by code at: \n"+t.stack)}else i&&console.log("RxJS: Back to a better error behavior. Thank you. <3");i=t},get useDeprecatedSynchronousErrorHandling(){return i}};function a(t){setTimeout(()=>{throw t},0)}const s={closed:!0,next(t){},error(t){if(o.useDeprecatedSynchronousErrorHandling)throw t;a(t)},complete(){}},u=(()=>Array.isArray||(t=>t&&"number"==typeof t.length))();function l(t){return null!==t&&"object"==typeof t}const c=(()=>{function t(t){return Error.call(this),this.message=t?`${t.length} errors occurred during unsubscription:\n${t.map((t,e)=>`${e+1}) ${t.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=t,this}return t.prototype=Object.create(Error.prototype),t})();let h=(()=>{class t{constructor(t){this.closed=!1,this._parentOrParents=null,this._subscriptions=null,t&&(this._unsubscribe=t)}unsubscribe(){let e;if(this.closed)return;let{_parentOrParents:n,_unsubscribe:i,_subscriptions:o}=this;if(this.closed=!0,this._parentOrParents=null,this._subscriptions=null,n instanceof t)n.remove(this);else if(null!==n)for(let t=0;t<n.length;++t)n[t].remove(this);if(r(i))try{i.call(this)}catch(a){e=a instanceof c?d(a.errors):[a]}if(u(o)){let t=-1,n=o.length;for(;++t<n;){const n=o[t];if(l(n))try{n.unsubscribe()}catch(a){e=e||[],a instanceof c?e=e.concat(d(a.errors)):e.push(a)}}}if(e)throw new c(e)}add(e){let n=e;if(!e)return t.EMPTY;switch(typeof e){case"function":n=new t(e);case"object":if(n===this||n.closed||"function"!=typeof n.unsubscribe)return n;if(this.closed)return n.unsubscribe(),n;if(!(n instanceof t)){const e=n;n=new t,n._subscriptions=[e]}break;default:throw new Error("unrecognized teardown "+e+" added to Subscription.")}let{_parentOrParents:r}=n;if(null===r)n._parentOrParents=this;else if(r instanceof t){if(r===this)return n;n._parentOrParents=[r,this]}else{if(-1!==r.indexOf(this))return n;r.push(this)}const i=this._subscriptions;return null===i?this._subscriptions=[n]:i.push(n),n}remove(t){const e=this._subscriptions;if(e){const n=e.indexOf(t);-1!==n&&e.splice(n,1)}}}return t.EMPTY=function(t){return t.closed=!0,t}(new t),t})();function d(t){return t.reduce((t,e)=>t.concat(e instanceof c?e.errors:e),[])}const f=(()=>"function"==typeof Symbol?Symbol("rxSubscriber"):"@@rxSubscriber_"+Math.random())();class p extends h{constructor(t,e,n){switch(super(),this.syncErrorValue=null,this.syncErrorThrown=!1,this.syncErrorThrowable=!1,this.isStopped=!1,arguments.length){case 0:this.destination=s;break;case 1:if(!t){this.destination=s;break}if("object"==typeof t){t instanceof p?(this.syncErrorThrowable=t.syncErrorThrowable,this.destination=t,t.add(this)):(this.syncErrorThrowable=!0,this.destination=new m(this,t));break}default:this.syncErrorThrowable=!0,this.destination=new m(this,t,e,n)}}[f](){return this}static create(t,e,n){const r=new p(t,e,n);return r.syncErrorThrowable=!1,r}next(t){this.isStopped||this._next(t)}error(t){this.isStopped||(this.isStopped=!0,this._error(t))}complete(){this.isStopped||(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe())}_next(t){this.destination.next(t)}_error(t){this.destination.error(t),this.unsubscribe()}_complete(){this.destination.complete(),this.unsubscribe()}_unsubscribeAndRecycle(){const{_parentOrParents:t}=this;return this._parentOrParents=null,this.unsubscribe(),this.closed=!1,this.isStopped=!1,this._parentOrParents=t,this}}class m extends p{constructor(t,e,n,i){let o;super(),this._parentSubscriber=t;let a=this;r(e)?o=e:e&&(o=e.next,n=e.error,i=e.complete,e!==s&&(a=Object.create(e),r(a.unsubscribe)&&this.add(a.unsubscribe.bind(a)),a.unsubscribe=this.unsubscribe.bind(this))),this._context=a,this._next=o,this._error=n,this._complete=i}next(t){if(!this.isStopped&&this._next){const{_parentSubscriber:e}=this;o.useDeprecatedSynchronousErrorHandling&&e.syncErrorThrowable?this.__tryOrSetError(e,this._next,t)&&this.unsubscribe():this.__tryOrUnsub(this._next,t)}}error(t){if(!this.isStopped){const{_parentSubscriber:e}=this,{useDeprecatedSynchronousErrorHandling:n}=o;if(this._error)n&&e.syncErrorThrowable?(this.__tryOrSetError(e,this._error,t),this.unsubscribe()):(this.__tryOrUnsub(this._error,t),this.unsubscribe());else if(e.syncErrorThrowable)n?(e.syncErrorValue=t,e.syncErrorThrown=!0):a(t),this.unsubscribe();else{if(this.unsubscribe(),n)throw t;a(t)}}}complete(){if(!this.isStopped){const{_parentSubscriber:t}=this;if(this._complete){const e=()=>this._complete.call(this._context);o.useDeprecatedSynchronousErrorHandling&&t.syncErrorThrowable?(this.__tryOrSetError(t,e),this.unsubscribe()):(this.__tryOrUnsub(e),this.unsubscribe())}else this.unsubscribe()}}__tryOrUnsub(t,e){try{t.call(this._context,e)}catch(n){if(this.unsubscribe(),o.useDeprecatedSynchronousErrorHandling)throw n;a(n)}}__tryOrSetError(t,e,n){if(!o.useDeprecatedSynchronousErrorHandling)throw new Error("bad call");try{e.call(this._context,n)}catch(r){return o.useDeprecatedSynchronousErrorHandling?(t.syncErrorValue=r,t.syncErrorThrown=!0,!0):(a(r),!0)}return!1}_unsubscribe(){const{_parentSubscriber:t}=this;this._context=null,this._parentSubscriber=null,t.unsubscribe()}}const g=(()=>"function"==typeof Symbol&&Symbol.observable||"@@observable")();function y(t){return t}let v=(()=>{class t{constructor(t){this._isScalar=!1,t&&(this._subscribe=t)}lift(e){const n=new t;return n.source=this,n.operator=e,n}subscribe(t,e,n){const{operator:r}=this,i=function(t,e,n){if(t){if(t instanceof p)return t;if(t[f])return t[f]()}return t||e||n?new p(t,e,n):new p(s)}(t,e,n);if(i.add(r?r.call(i,this.source):this.source||o.useDeprecatedSynchronousErrorHandling&&!i.syncErrorThrowable?this._subscribe(i):this._trySubscribe(i)),o.useDeprecatedSynchronousErrorHandling&&i.syncErrorThrowable&&(i.syncErrorThrowable=!1,i.syncErrorThrown))throw i.syncErrorValue;return i}_trySubscribe(t){try{return this._subscribe(t)}catch(e){o.useDeprecatedSynchronousErrorHandling&&(t.syncErrorThrown=!0,t.syncErrorValue=e),function(t){for(;t;){const{closed:e,destination:n,isStopped:r}=t;if(e||r)return!1;t=n&&n instanceof p?n:null}return!0}(t)?t.error(e):console.warn(e)}}forEach(t,e){return new(e=b(e))((e,n)=>{let r;r=this.subscribe(e=>{try{t(e)}catch(i){n(i),r&&r.unsubscribe()}},n,e)})}_subscribe(t){const{source:e}=this;return e&&e.subscribe(t)}[g](){return this}pipe(...t){return 0===t.length?this:(0===(e=t).length?y:1===e.length?e[0]:function(t){return e.reduce((t,e)=>e(t),t)})(this);var e}toPromise(t){return new(t=b(t))((t,e)=>{let n;this.subscribe(t=>n=t,t=>e(t),()=>t(n))})}}return t.create=e=>new t(e),t})();function b(t){if(t||(t=o.Promise||Promise),!t)throw new Error("no Promise impl found");return t}const w=(()=>{function t(){return Error.call(this),this.message="object unsubscribed",this.name="ObjectUnsubscribedError",this}return t.prototype=Object.create(Error.prototype),t})();class x extends h{constructor(t,e){super(),this.subject=t,this.subscriber=e,this.closed=!1}unsubscribe(){if(this.closed)return;this.closed=!0;const t=this.subject,e=t.observers;if(this.subject=null,!e||0===e.length||t.isStopped||t.closed)return;const n=e.indexOf(this.subscriber);-1!==n&&e.splice(n,1)}}class _ extends p{constructor(t){super(t),this.destination=t}}let C=(()=>{class t extends v{constructor(){super(),this.observers=[],this.closed=!1,this.isStopped=!1,this.hasError=!1,this.thrownError=null}[f](){return new _(this)}lift(t){const e=new k(this,this);return e.operator=t,e}next(t){if(this.closed)throw new w;if(!this.isStopped){const{observers:e}=this,n=e.length,r=e.slice();for(let i=0;i<n;i++)r[i].next(t)}}error(t){if(this.closed)throw new w;this.hasError=!0,this.thrownError=t,this.isStopped=!0;const{observers:e}=this,n=e.length,r=e.slice();for(let i=0;i<n;i++)r[i].error(t);this.observers.length=0}complete(){if(this.closed)throw new w;this.isStopped=!0;const{observers:t}=this,e=t.length,n=t.slice();for(let r=0;r<e;r++)n[r].complete();this.observers.length=0}unsubscribe(){this.isStopped=!0,this.closed=!0,this.observers=null}_trySubscribe(t){if(this.closed)throw new w;return super._trySubscribe(t)}_subscribe(t){if(this.closed)throw new w;return this.hasError?(t.error(this.thrownError),h.EMPTY):this.isStopped?(t.complete(),h.EMPTY):(this.observers.push(t),new x(this,t))}asObservable(){const t=new v;return t.source=this,t}}return t.create=(t,e)=>new k(t,e),t})();class k extends C{constructor(t,e){super(),this.destination=t,this.source=e}next(t){const{destination:e}=this;e&&e.next&&e.next(t)}error(t){const{destination:e}=this;e&&e.error&&this.destination.error(t)}complete(){const{destination:t}=this;t&&t.complete&&this.destination.complete()}_subscribe(t){const{source:e}=this;return e?this.source.subscribe(t):h.EMPTY}}function S(t){return t&&"function"==typeof t.schedule}class E extends p{constructor(t,e,n){super(),this.parent=t,this.outerValue=e,this.outerIndex=n,this.index=0}_next(t){this.parent.notifyNext(this.outerValue,t,this.outerIndex,this.index++,this)}_error(t){this.parent.notifyError(t,this),this.unsubscribe()}_complete(){this.parent.notifyComplete(this),this.unsubscribe()}}const O=t=>e=>{for(let n=0,r=t.length;n<r&&!e.closed;n++)e.next(t[n]);e.complete()};function A(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}const N=A(),T=t=>t&&"number"==typeof t.length&&"function"!=typeof t;function D(t){return!!t&&"function"!=typeof t.subscribe&&"function"==typeof t.then}const R=t=>{if(t&&"function"==typeof t[g])return r=t,t=>{const e=r[g]();if("function"!=typeof e.subscribe)throw new TypeError("Provided object does not correctly implement Symbol.observable");return e.subscribe(t)};if(T(t))return O(t);if(D(t))return n=t,t=>(n.then(e=>{t.closed||(t.next(e),t.complete())},e=>t.error(e)).then(null,a),t);if(t&&"function"==typeof t[N])return e=t,t=>{const n=e[N]();for(;;){const e=n.next();if(e.done){t.complete();break}if(t.next(e.value),t.closed)break}return"function"==typeof n.return&&t.add(()=>{n.return&&n.return()}),t};{const e=l(t)?"an invalid object":`'${t}'`;throw new TypeError(`You provided ${e} where a stream was expected. You can provide an Observable, Promise, Array, or Iterable.`)}var e,n,r};function I(t,e,n,r,i=new E(t,n,r)){if(!i.closed)return e instanceof v?e.subscribe(i):R(e)(i)}class M extends p{notifyNext(t,e,n,r,i){this.destination.next(e)}notifyError(t,e){this.destination.error(t)}notifyComplete(t){this.destination.complete()}}function F(t,e){return function(n){if("function"!=typeof t)throw new TypeError("argument is not a function. Are you looking for `mapTo()`?");return n.lift(new P(t,e))}}class P{constructor(t,e){this.project=t,this.thisArg=e}call(t,e){return e.subscribe(new j(t,this.project,this.thisArg))}}class j extends p{constructor(t,e,n){super(t),this.project=e,this.count=0,this.thisArg=n||this}_next(t){let e;try{e=this.project.call(this.thisArg,t,this.count++)}catch(n){return void this.destination.error(n)}this.destination.next(e)}}function z(t,e){return new v(n=>{const r=new h;let i=0;return r.add(e.schedule((function(){i!==t.length?(n.next(t[i++]),n.closed||r.add(this.schedule())):n.complete()}))),r})}function L(t,e){return e?function(t,e){if(null!=t){if(function(t){return t&&"function"==typeof t[g]}(t))return function(t,e){return new v(n=>{const r=new h;return r.add(e.schedule(()=>{const i=t[g]();r.add(i.subscribe({next(t){r.add(e.schedule(()=>n.next(t)))},error(t){r.add(e.schedule(()=>n.error(t)))},complete(){r.add(e.schedule(()=>n.complete()))}}))})),r})}(t,e);if(D(t))return function(t,e){return new v(n=>{const r=new h;return r.add(e.schedule(()=>t.then(t=>{r.add(e.schedule(()=>{n.next(t),r.add(e.schedule(()=>n.complete()))}))},t=>{r.add(e.schedule(()=>n.error(t)))}))),r})}(t,e);if(T(t))return z(t,e);if(function(t){return t&&"function"==typeof t[N]}(t)||"string"==typeof t)return function(t,e){if(!t)throw new Error("Iterable cannot be null");return new v(n=>{const r=new h;let i;return r.add(()=>{i&&"function"==typeof i.return&&i.return()}),r.add(e.schedule(()=>{i=t[N](),r.add(e.schedule((function(){if(n.closed)return;let t,e;try{const n=i.next();t=n.value,e=n.done}catch(r){return void n.error(r)}e?n.complete():(n.next(t),this.schedule())})))})),r})}(t,e)}throw new TypeError((null!==t&&typeof t||t)+" is not observable")}(t,e):t instanceof v?t:new v(R(t))}function B(t,e,n=Number.POSITIVE_INFINITY){return"function"==typeof e?r=>r.pipe(B((n,r)=>L(t(n,r)).pipe(F((t,i)=>e(n,t,r,i))),n)):("number"==typeof e&&(n=e),e=>e.lift(new U(t,n)))}class U{constructor(t,e=Number.POSITIVE_INFINITY){this.project=t,this.concurrent=e}call(t,e){return e.subscribe(new $(t,this.project,this.concurrent))}}class $ extends M{constructor(t,e,n=Number.POSITIVE_INFINITY){super(t),this.project=e,this.concurrent=n,this.hasCompleted=!1,this.buffer=[],this.active=0,this.index=0}_next(t){this.active<this.concurrent?this._tryNext(t):this.buffer.push(t)}_tryNext(t){let e;const n=this.index++;try{e=this.project(t,n)}catch(r){return void this.destination.error(r)}this.active++,this._innerSub(e,t,n)}_innerSub(t,e,n){const r=new E(this,e,n),i=this.destination;i.add(r);const o=I(this,t,void 0,void 0,r);o!==r&&i.add(o)}_complete(){this.hasCompleted=!0,0===this.active&&0===this.buffer.length&&this.destination.complete(),this.unsubscribe()}notifyNext(t,e,n,r,i){this.destination.next(e)}notifyComplete(t){const e=this.buffer;this.remove(t),this.active--,e.length>0?this._next(e.shift()):0===this.active&&this.hasCompleted&&this.destination.complete()}}function V(t=Number.POSITIVE_INFINITY){return B(y,t)}function W(t,e){return e?z(t,e):new v(O(t))}function q(...t){let e=Number.POSITIVE_INFINITY,n=null,r=t[t.length-1];return S(r)?(n=t.pop(),t.length>1&&"number"==typeof t[t.length-1]&&(e=t.pop())):"number"==typeof r&&(e=t.pop()),null===n&&1===t.length&&t[0]instanceof v?t[0]:V(e)(W(t,n))}function H(){return function(t){return t.lift(new G(t))}}class G{constructor(t){this.connectable=t}call(t,e){const{connectable:n}=this;n._refCount++;const r=new X(t,n),i=e.subscribe(r);return r.closed||(r.connection=n.connect()),i}}class X extends p{constructor(t,e){super(t),this.connectable=e}_unsubscribe(){const{connectable:t}=this;if(!t)return void(this.connection=null);this.connectable=null;const e=t._refCount;if(e<=0)return void(this.connection=null);if(t._refCount=e-1,e>1)return void(this.connection=null);const{connection:n}=this,r=t._connection;this.connection=null,!r||n&&r!==n||r.unsubscribe()}}class K extends v{constructor(t,e){super(),this.source=t,this.subjectFactory=e,this._refCount=0,this._isComplete=!1}_subscribe(t){return this.getSubject().subscribe(t)}getSubject(){const t=this._subject;return t&&!t.isStopped||(this._subject=this.subjectFactory()),this._subject}connect(){let t=this._connection;return t||(this._isComplete=!1,t=this._connection=new h,t.add(this.source.subscribe(new Z(this.getSubject(),this))),t.closed&&(this._connection=null,t=h.EMPTY)),t}refCount(){return H()(this)}}const Y=(()=>{const t=K.prototype;return{operator:{value:null},_refCount:{value:0,writable:!0},_subject:{value:null,writable:!0},_connection:{value:null,writable:!0},_subscribe:{value:t._subscribe},_isComplete:{value:t._isComplete,writable:!0},getSubject:{value:t.getSubject},connect:{value:t.connect},refCount:{value:t.refCount}}})();class Z extends _{constructor(t,e){super(t),this.connectable=e}_error(t){this._unsubscribe(),super._error(t)}_complete(){this.connectable._isComplete=!0,this._unsubscribe(),super._complete()}_unsubscribe(){const t=this.connectable;if(t){this.connectable=null;const e=t._connection;t._refCount=0,t._subject=null,t._connection=null,e&&e.unsubscribe()}}}function Q(t,e){return function(n){let r;if(r="function"==typeof t?t:function(){return t},"function"==typeof e)return n.lift(new J(r,e));const i=Object.create(n,Y);return i.source=n,i.subjectFactory=r,i}}class J{constructor(t,e){this.subjectFactory=t,this.selector=e}call(t,e){const{selector:n}=this,r=this.subjectFactory(),i=n(r).subscribe(t);return i.add(e.subscribe(r)),i}}function tt(){return new C}function et(){return t=>H()(Q(tt)(t))}function nt(t){return{toString:t}.toString()}function rt(t,e,n){return nt(()=>{const r=function(t){return function(...e){if(t){const n=t(...e);for(const t in n)this[t]=n[t]}}}(e);function i(...t){if(this instanceof i)return r.apply(this,t),this;const e=new i(...t);return n.annotation=e,n;function n(t,n,r){const i=t.hasOwnProperty("__parameters__")?t.__parameters__:Object.defineProperty(t,"__parameters__",{value:[]}).__parameters__;for(;i.length<=r;)i.push(null);return(i[r]=i[r]||[]).push(e),t}}return n&&(i.prototype=Object.create(n.prototype)),i.prototype.ngMetadataName=t,i.annotationCls=i,i})}const it=rt("Inject",t=>({token:t})),ot=rt("Optional"),at=rt("Self"),st=rt("SkipSelf");var ut=function(t){return t[t.Default=0]="Default",t[t.Host=1]="Host",t[t.Self=2]="Self",t[t.SkipSelf=4]="SkipSelf",t[t.Optional=8]="Optional",t}({});function lt(t){for(let e in t)if(t[e]===lt)return e;throw Error("Could not find renamed property on target object.")}function ct(t,e){for(const n in e)e.hasOwnProperty(n)&&!t.hasOwnProperty(n)&&(t[n]=e[n])}function ht(t){return{token:t.token,providedIn:t.providedIn||null,factory:t.factory,value:void 0}}function dt(t){return{factory:t.factory,providers:t.providers||[],imports:t.imports||[]}}function ft(t){return pt(t,t[gt])||pt(t,t[bt])}function pt(t,e){return e&&e.token===t?e:null}function mt(t){return t&&(t.hasOwnProperty(yt)||t.hasOwnProperty(wt))?t[yt]:null}const gt=lt({"\u0275prov":lt}),yt=lt({"\u0275inj":lt}),vt=lt({"\u0275provFallback":lt}),bt=lt({ngInjectableDef:lt}),wt=lt({ngInjectorDef:lt});function xt(t){if("string"==typeof t)return t;if(Array.isArray(t))return"["+t.map(xt).join(", ")+"]";if(null==t)return""+t;if(t.overriddenName)return""+t.overriddenName;if(t.name)return""+t.name;const e=t.toString();if(null==e)return""+e;const n=e.indexOf("\n");return-1===n?e:e.substring(0,n)}function _t(t,e){return null==t||""===t?null===e?"":e:null==e||""===e?t:t+" "+e}const Ct=lt({__forward_ref__:lt});function kt(t){return t.__forward_ref__=kt,t.toString=function(){return xt(this())},t}function St(t){return Et(t)?t():t}function Et(t){return"function"==typeof t&&t.hasOwnProperty(Ct)&&t.__forward_ref__===kt}const Ot="undefined"!=typeof globalThis&&globalThis,At="undefined"!=typeof window&&window,Nt="undefined"!=typeof self&&"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&self,Tt="undefined"!=typeof global&&global,Dt=Ot||Tt||At||Nt,Rt=lt({"\u0275cmp":lt}),It=lt({"\u0275dir":lt}),Mt=lt({"\u0275pipe":lt}),Ft=lt({"\u0275mod":lt}),Pt=lt({"\u0275loc":lt}),jt=lt({"\u0275fac":lt}),zt=lt({__NG_ELEMENT_ID__:lt});class Lt{constructor(t,e){this._desc=t,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof e?this.__NG_ELEMENT_ID__=e:void 0!==e&&(this.\u0275prov=ht({token:this,providedIn:e.providedIn||"root",factory:e.factory}))}toString(){return"InjectionToken "+this._desc}}const Bt=new Lt("INJECTOR",-1),Ut={},$t=/\n/gm,Vt=lt({provide:String,useValue:lt});let Wt,qt=void 0;function Ht(t){const e=qt;return qt=t,e}function Gt(t){const e=Wt;return Wt=t,e}function Xt(t,e=ut.Default){if(void 0===qt)throw new Error("inject() must be called from an injection context");return null===qt?Zt(t,void 0,e):qt.get(t,e&ut.Optional?null:void 0,e)}function Kt(t,e=ut.Default){return(Wt||Xt)(St(t),e)}const Yt=Kt;function Zt(t,e,n){const r=ft(t);if(r&&"root"==r.providedIn)return void 0===r.value?r.value=r.factory():r.value;if(n&ut.Optional)return null;if(void 0!==e)return e;throw new Error(`Injector: NOT_FOUND [${xt(t)}]`)}function Qt(t){const e=[];for(let n=0;n<t.length;n++){const r=St(t[n]);if(Array.isArray(r)){if(0===r.length)throw new Error("Arguments array must have arguments.");let t=void 0,n=ut.Default;for(let e=0;e<r.length;e++){const i=r[e];i instanceof ot||"Optional"===i.ngMetadataName||i===ot?n|=ut.Optional:i instanceof st||"SkipSelf"===i.ngMetadataName||i===st?n|=ut.SkipSelf:i instanceof at||"Self"===i.ngMetadataName||i===at?n|=ut.Self:t=i instanceof it||i===it?i.token:i}e.push(Kt(t,n))}else e.push(Kt(r))}return e}class Jt{get(t,e=Ut){if(e===Ut){const e=new Error(`NullInjectorError: No provider for ${xt(t)}!`);throw e.name="NullInjectorError",e}return e}}class te{}class ee{}function ne(t,e){t.forEach(t=>Array.isArray(t)?ne(t,e):e(t))}function re(t,e,n){e>=t.length?t.push(n):t.splice(e,0,n)}function ie(t,e){return e>=t.length-1?t.pop():t.splice(e,1)[0]}function oe(t,e){const n=[];for(let r=0;r<t;r++)n.push(e);return n}function ae(t,e,n){let r=ue(t,e);return r>=0?t[1|r]=n:(r=~r,function(t,e,n,r){let i=t.length;if(i==e)t.push(n,r);else if(1===i)t.push(r,t[0]),t[0]=n;else{for(i--,t.push(t[i-1],t[i]);i>e;)t[i]=t[i-2],i--;t[e]=n,t[e+1]=r}}(t,r,e,n)),r}function se(t,e){const n=ue(t,e);if(n>=0)return t[1|n]}function ue(t,e){return function(t,e,n){let r=0,i=t.length>>1;for(;i!==r;){const n=r+(i-r>>1),o=t[n<<1];if(e===o)return n<<1;o>e?i=n:r=n+1}return~(i<<1)}(t,e)}var le=function(t){return t[t.OnPush=0]="OnPush",t[t.Default=1]="Default",t}({}),ce=function(t){return t[t.Emulated=0]="Emulated",t[t.Native=1]="Native",t[t.None=2]="None",t[t.ShadowDom=3]="ShadowDom",t}({});const he={},de=[];let fe=0;function pe(t){return nt(()=>{const e={},n={type:t.type,providersResolver:null,decls:t.decls,vars:t.vars,factory:null,template:t.template||null,consts:t.consts||null,ngContentSelectors:t.ngContentSelectors,hostBindings:t.hostBindings||null,hostVars:t.hostVars||0,hostAttrs:t.hostAttrs||null,contentQueries:t.contentQueries||null,declaredInputs:e,inputs:null,outputs:null,exportAs:t.exportAs||null,onPush:t.changeDetection===le.OnPush,directiveDefs:null,pipeDefs:null,selectors:t.selectors||de,viewQuery:t.viewQuery||null,features:t.features||null,data:t.data||{},encapsulation:t.encapsulation||ce.Emulated,id:"c",styles:t.styles||de,_:null,setInput:null,schemas:t.schemas||null,tView:null},r=t.directives,i=t.features,o=t.pipes;return n.id+=fe++,n.inputs=be(t.inputs,e),n.outputs=be(t.outputs),i&&i.forEach(t=>t(n)),n.directiveDefs=r?()=>("function"==typeof r?r():r).map(me):null,n.pipeDefs=o?()=>("function"==typeof o?o():o).map(ge):null,n})}function me(t){return _e(t)||function(t){return t[It]||null}(t)}function ge(t){return function(t){return t[Mt]||null}(t)}const ye={};function ve(t){const e={type:t.type,bootstrap:t.bootstrap||de,declarations:t.declarations||de,imports:t.imports||de,exports:t.exports||de,transitiveCompileScopes:null,schemas:t.schemas||null,id:t.id||null};return null!=t.id&&nt(()=>{ye[t.id]=t.type}),e}function be(t,e){if(null==t)return he;const n={};for(const r in t)if(t.hasOwnProperty(r)){let i=t[r],o=i;Array.isArray(i)&&(o=i[1],i=i[0]),n[i]=r,e&&(e[i]=o)}return n}const we=pe;function xe(t){return{type:t.type,name:t.name,factory:null,pure:!1!==t.pure,onDestroy:t.type.prototype.ngOnDestroy||null}}function _e(t){return t[Rt]||null}function Ce(t,e){return t.hasOwnProperty(jt)?t[jt]:null}function ke(t,e){const n=t[Ft]||null;if(!n&&!0===e)throw new Error(`Type ${xt(t)} does not have '\u0275mod' property.`);return n}function Se(t){return Array.isArray(t)&&"object"==typeof t[1]}function Ee(t){return Array.isArray(t)&&!0===t[1]}function Oe(t){return 0!=(8&t.flags)}function Ae(t){return 2==(2&t.flags)}function Ne(t){return 1==(1&t.flags)}function Te(t){return null!==t.template}function De(t){return 0!=(512&t[2])}class Re{constructor(t,e,n){this.previousValue=t,this.currentValue=e,this.firstChange=n}isFirstChange(){return this.firstChange}}function Ie(){return Me}function Me(t){return t.type.prototype.ngOnChanges&&(t.setInput=Pe),Fe}function Fe(){const t=je(this),e=null==t?void 0:t.current;if(e){const n=t.previous;if(n===he)t.previous=e;else for(let t in e)n[t]=e[t];t.current=null,this.ngOnChanges(e)}}function Pe(t,e,n,r){const i=je(t)||function(t,e){return t.__ngSimpleChanges__=e}(t,{previous:he,current:null}),o=i.current||(i.current={}),a=i.previous,s=this.declaredInputs[n],u=a[s];o[s]=new Re(u&&u.currentValue,e,a===he),t[r]=e}function je(t){return t.__ngSimpleChanges__||null}Ie.ngInherit=!0;let ze=void 0;function Le(t){return!!t.listen}const Be={createRenderer:(t,e)=>void 0!==ze?ze:"undefined"!=typeof document?document:void 0};function Ue(t){for(;Array.isArray(t);)t=t[0];return t}function $e(t,e){return Ue(e[t+20])}function Ve(t,e){return Ue(e[t.index])}function We(t,e){return t.data[e+20]}function qe(t,e){return t[e+20]}function He(t,e){const n=e[t];return Se(n)?n:n[0]}function Ge(t){const e=function(t){return t.__ngContext__||null}(t);return e?Array.isArray(e)?e:e.lView:null}function Xe(t){return 4==(4&t[2])}function Ke(t){return 128==(128&t[2])}function Ye(t,e){return null===t||null==e?null:t[e]}function Ze(t){t[18]=0}function Qe(t,e){t[5]+=e;let n=t,r=t[3];for(;null!==r&&(1===e&&1===n[5]||-1===e&&0===n[5]);)r[5]+=e,n=r,r=r[3]}const Je={lFrame:Cn(null),bindingsEnabled:!0,checkNoChangesMode:!1};function tn(){return Je.bindingsEnabled}function en(){return Je.lFrame.lView}function nn(){return Je.lFrame.tView}function rn(t){Je.lFrame.contextLView=t}function on(){return Je.lFrame.previousOrParentTNode}function an(t,e){Je.lFrame.previousOrParentTNode=t,Je.lFrame.isParent=e}function sn(){return Je.lFrame.isParent}function un(){Je.lFrame.isParent=!1}function ln(){return Je.checkNoChangesMode}function cn(t){Je.checkNoChangesMode=t}function hn(){const t=Je.lFrame;let e=t.bindingRootIndex;return-1===e&&(e=t.bindingRootIndex=t.tView.bindingStartIndex),e}function dn(){return Je.lFrame.bindingIndex}function fn(){return Je.lFrame.bindingIndex++}function pn(t){const e=Je.lFrame,n=e.bindingIndex;return e.bindingIndex=e.bindingIndex+t,n}function mn(t,e){const n=Je.lFrame;n.bindingIndex=n.bindingRootIndex=t,gn(e)}function gn(t){Je.lFrame.currentDirectiveIndex=t}function yn(t){const e=Je.lFrame.currentDirectiveIndex;return-1===e?null:t[e]}function vn(){return Je.lFrame.currentQueryIndex}function bn(t){Je.lFrame.currentQueryIndex=t}function wn(t,e){const n=_n();Je.lFrame=n,n.previousOrParentTNode=e,n.lView=t}function xn(t,e){const n=_n(),r=t[1];Je.lFrame=n,n.previousOrParentTNode=e,n.lView=t,n.tView=r,n.contextLView=t,n.bindingIndex=r.bindingStartIndex}function _n(){const t=Je.lFrame,e=null===t?null:t.child;return null===e?Cn(t):e}function Cn(t){const e={previousOrParentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:0,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:t,child:null};return null!==t&&(t.child=e),e}function kn(){const t=Je.lFrame;return Je.lFrame=t.parent,t.previousOrParentTNode=null,t.lView=null,t}const Sn=kn;function En(){const t=kn();t.isParent=!0,t.tView=null,t.selectedIndex=0,t.contextLView=null,t.elementDepthCount=0,t.currentDirectiveIndex=-1,t.currentNamespace=null,t.bindingRootIndex=-1,t.bindingIndex=-1,t.currentQueryIndex=0}function On(){return Je.lFrame.selectedIndex}function An(t){Je.lFrame.selectedIndex=t}function Nn(){const t=Je.lFrame;return We(t.tView,t.selectedIndex)}function Tn(t,e){for(let n=e.directiveStart,r=e.directiveEnd;n<r;n++){const e=t.data[n].type.prototype,{ngAfterContentInit:r,ngAfterContentChecked:i,ngAfterViewInit:o,ngAfterViewChecked:a,ngOnDestroy:s}=e;r&&(t.contentHooks||(t.contentHooks=[])).push(-n,r),i&&((t.contentHooks||(t.contentHooks=[])).push(n,i),(t.contentCheckHooks||(t.contentCheckHooks=[])).push(n,i)),o&&(t.viewHooks||(t.viewHooks=[])).push(-n,o),a&&((t.viewHooks||(t.viewHooks=[])).push(n,a),(t.viewCheckHooks||(t.viewCheckHooks=[])).push(n,a)),null!=s&&(t.destroyHooks||(t.destroyHooks=[])).push(n,s)}}function Dn(t,e,n){Mn(t,e,3,n)}function Rn(t,e,n,r){(3&t[2])===n&&Mn(t,e,n,r)}function In(t,e){let n=t[2];(3&n)===e&&(n&=2047,n+=1,t[2]=n)}function Mn(t,e,n,r){const i=null!=r?r:-1;let o=0;for(let a=void 0!==r?65535&t[18]:0;a<e.length;a++)if("number"==typeof e[a+1]){if(o=e[a],null!=r&&o>=r)break}else e[a]<0&&(t[18]+=65536),(o<i||-1==i)&&(Fn(t,n,e,a),t[18]=(4294901760&t[18])+a+2),a++}function Fn(t,e,n,r){const i=n[r]<0,o=n[r+1],a=t[i?-n[r]:n[r]];i?t[2]>>11<t[18]>>16&&(3&t[2])===e&&(t[2]+=2048,o.call(a)):o.call(a)}class Pn{constructor(t,e,n){this.factory=t,this.resolving=!1,this.canSeeViewProviders=e,this.injectImpl=n}}function jn(t,e,n){const r=Le(t);let i=0;for(;i<n.length;){const o=n[i];if("number"==typeof o){if(0!==o)break;i++;const a=n[i++],s=n[i++],u=n[i++];r?t.setAttribute(e,s,u,a):e.setAttributeNS(a,s,u)}else{const a=o,s=n[++i];Ln(a)?r&&t.setProperty(e,a,s):r?t.setAttribute(e,a,s):e.setAttribute(a,s),i++}}return i}function zn(t){return 3===t||4===t||6===t}function Ln(t){return 64===t.charCodeAt(0)}function Bn(t,e){if(null===e||0===e.length);else if(null===t||0===t.length)t=e.slice();else{let n=-1;for(let r=0;r<e.length;r++){const i=e[r];"number"==typeof i?n=i:0===n||Un(t,n,i,null,-1===n||2===n?e[++r]:null)}}return t}function Un(t,e,n,r,i){let o=0,a=t.length;if(-1===e)a=-1;else for(;o<t.length;){const n=t[o++];if("number"==typeof n){if(n===e){a=-1;break}if(n>e){a=o-1;break}}}for(;o<t.length;){const e=t[o];if("number"==typeof e)break;if(e===n){if(null===r)return void(null!==i&&(t[o+1]=i));if(r===t[o+1])return void(t[o+2]=i)}o++,null!==r&&o++,null!==i&&o++}-1!==a&&(t.splice(a,0,e),o=a+1),t.splice(o++,0,n),null!==r&&t.splice(o++,0,r),null!==i&&t.splice(o++,0,i)}function $n(t){return-1!==t}function Vn(t){return 32767&t}function Wn(t){return t>>16}function qn(t,e){let n=Wn(t),r=e;for(;n>0;)r=r[15],n--;return r}function Hn(t){return"string"==typeof t?t:null==t?"":""+t}function Gn(t){return"function"==typeof t?t.name||t.toString():"object"==typeof t&&null!=t&&"function"==typeof t.type?t.type.name||t.type.toString():Hn(t)}const Xn=(()=>("undefined"!=typeof requestAnimationFrame&&requestAnimationFrame||setTimeout).bind(Dt))();function Kn(t){return t instanceof Function?t():t}let Yn=!0;function Zn(t){const e=Yn;return Yn=t,e}let Qn=0;function Jn(t,e){const n=er(t,e);if(-1!==n)return n;const r=e[1];r.firstCreatePass&&(t.injectorIndex=e.length,tr(r.data,t),tr(e,null),tr(r.blueprint,null));const i=nr(t,e),o=t.injectorIndex;if($n(i)){const t=Vn(i),n=qn(i,e),r=n[1].data;for(let i=0;i<8;i++)e[o+i]=n[t+i]|r[t+i]}return e[o+8]=i,o}function tr(t,e){t.push(0,0,0,0,0,0,0,0,e)}function er(t,e){return-1===t.injectorIndex||t.parent&&t.parent.injectorIndex===t.injectorIndex||null==e[t.injectorIndex+8]?-1:t.injectorIndex}function nr(t,e){if(t.parent&&-1!==t.parent.injectorIndex)return t.parent.injectorIndex;let n=e[6],r=1;for(;n&&-1===n.injectorIndex;)n=(e=e[15])?e[6]:null,r++;return n?n.injectorIndex|r<<16:-1}function rr(t,e,n){!function(t,e,n){let r;"string"==typeof n?r=n.charCodeAt(0)||0:n.hasOwnProperty(zt)&&(r=n[zt]),null==r&&(r=n[zt]=Qn++);const i=255&r,o=1<<i,a=64&i,s=32&i,u=e.data;128&i?a?s?u[t+7]|=o:u[t+6]|=o:s?u[t+5]|=o:u[t+4]|=o:a?s?u[t+3]|=o:u[t+2]|=o:s?u[t+1]|=o:u[t]|=o}(t,e,n)}function ir(t,e,n,r=ut.Default,i){if(null!==t){const i=function(t){if("string"==typeof t)return t.charCodeAt(0)||0;const e=t.hasOwnProperty(zt)?t[zt]:void 0;return"number"==typeof e&&e>0?255&e:e}(n);if("function"==typeof i){wn(e,t);try{const t=i();if(null!=t||r&ut.Optional)return t;throw new Error(`No provider for ${Gn(n)}!`)}finally{Sn()}}else if("number"==typeof i){if(-1===i)return new hr(t,e);let o=null,a=er(t,e),s=-1,u=r&ut.Host?e[16][6]:null;for((-1===a||r&ut.SkipSelf)&&(s=-1===a?nr(t,e):e[a+8],cr(r,!1)?(o=e[1],a=Vn(s),e=qn(s,e)):a=-1);-1!==a;){s=e[a+8];const t=e[1];if(lr(i,a,t.data)){const t=ar(a,e,n,o,r,u);if(t!==or)return t}cr(r,e[1].data[a+8]===u)&&lr(i,a,e)?(o=t,a=Vn(s),e=qn(s,e)):a=-1}}}if(r&ut.Optional&&void 0===i&&(i=null),0==(r&(ut.Self|ut.Host))){const t=e[9],o=Gt(void 0);try{return t?t.get(n,i,r&ut.Optional):Zt(n,i,r&ut.Optional)}finally{Gt(o)}}if(r&ut.Optional)return i;throw new Error(`NodeInjector: NOT_FOUND [${Gn(n)}]`)}const or={};function ar(t,e,n,r,i,o){const a=e[1],s=a.data[t+8],u=sr(s,a,n,null==r?Ae(s)&&Yn:r!=a&&3===s.type,i&ut.Host&&o===s);return null!==u?ur(e,a,u,s):or}function sr(t,e,n,r,i){const o=t.providerIndexes,a=e.data,s=1048575&o,u=t.directiveStart,l=o>>20,c=i?s+l:t.directiveEnd;for(let h=r?s:s+l;h<c;h++){const t=a[h];if(h<u&&n===t||h>=u&&t.type===n)return h}if(i){const t=a[u];if(t&&Te(t)&&t.type===n)return u}return null}function ur(t,e,n,r){let i=t[n];const o=e.data;if(i instanceof Pn){const a=i;if(a.resolving)throw new Error("Circular dep for "+Gn(o[n]));const s=Zn(a.canSeeViewProviders);let u;a.resolving=!0,a.injectImpl&&(u=Gt(a.injectImpl)),wn(t,r);try{i=t[n]=a.factory(void 0,o,t,r),e.firstCreatePass&&n>=r.directiveStart&&function(t,e,n){const{ngOnChanges:r,ngOnInit:i,ngDoCheck:o}=e.type.prototype;if(r){const r=Me(e);(n.preOrderHooks||(n.preOrderHooks=[])).push(t,r),(n.preOrderCheckHooks||(n.preOrderCheckHooks=[])).push(t,r)}i&&(n.preOrderHooks||(n.preOrderHooks=[])).push(0-t,i),o&&((n.preOrderHooks||(n.preOrderHooks=[])).push(t,o),(n.preOrderCheckHooks||(n.preOrderCheckHooks=[])).push(t,o))}(n,o[n],e)}finally{a.injectImpl&&Gt(u),Zn(s),a.resolving=!1,Sn()}}return i}function lr(t,e,n){const r=64&t,i=32&t;let o;return o=128&t?r?i?n[e+7]:n[e+6]:i?n[e+5]:n[e+4]:r?i?n[e+3]:n[e+2]:i?n[e+1]:n[e],!!(o&1<<t)}function cr(t,e){return!(t&ut.Self||t&ut.Host&&e)}class hr{constructor(t,e){this._tNode=t,this._lView=e}get(t,e){return ir(this._tNode,this._lView,t,void 0,e)}}function dr(t){const e=t;if(Et(t))return()=>{const t=dr(St(e));return t?t():null};let n=Ce(e);if(null===n){const t=mt(e);n=t&&t.factory}return n||null}function fr(t){return nt(()=>{const e=t.prototype.constructor,n=e[jt]||dr(e),r=Object.prototype;let i=Object.getPrototypeOf(t.prototype).constructor;for(;i&&i!==r;){const t=i[jt]||dr(i);if(t&&t!==n)return t;i=Object.getPrototypeOf(i)}return t=>new t})}function pr(t){return t.ngDebugContext}function mr(t){return t.ngOriginalError}function gr(t,...e){t.error(...e)}class yr{constructor(){this._console=console}handleError(t){const e=this._findOriginalError(t),n=this._findContext(t),r=function(t){return t.ngErrorLogger||gr}(t);r(this._console,"ERROR",t),e&&r(this._console,"ORIGINAL ERROR",e),n&&r(this._console,"ERROR CONTEXT",n)}_findContext(t){return t?pr(t)?pr(t):this._findContext(mr(t)):null}_findOriginalError(t){let e=mr(t);for(;e&&mr(e);)e=mr(e);return e}}class vr{constructor(t){this.changingThisBreaksApplicationSecurity=t}toString(){return"SafeValue must use [property]=binding: "+this.changingThisBreaksApplicationSecurity+" (see http://g.co/ng/security#xss)"}}class br extends vr{getTypeName(){return"HTML"}}class wr extends vr{getTypeName(){return"Style"}}class xr extends vr{getTypeName(){return"Script"}}class _r extends vr{getTypeName(){return"URL"}}class Cr extends vr{getTypeName(){return"ResourceURL"}}function kr(t){return t instanceof vr?t.changingThisBreaksApplicationSecurity:t}function Sr(t,e){const n=Er(t);if(null!=n&&n!==e){if("ResourceURL"===n&&"URL"===e)return!0;throw new Error(`Required a safe ${e}, got a ${n} (see http://g.co/ng/security#xss)`)}return n===e}function Er(t){return t instanceof vr&&t.getTypeName()||null}let Or=!0,Ar=!1;function Nr(){return Ar=!0,Or}class Tr{getInertBodyElement(t){t="<body><remove></remove>"+t+"</body>";try{const e=(new window.DOMParser).parseFromString(t,"text/html").body;return e.removeChild(e.firstChild),e}catch(e){return null}}}class Dr{constructor(t){if(this.defaultDoc=t,this.inertDocument=this.defaultDoc.implementation.createHTMLDocument("sanitization-inert"),null==this.inertDocument.body){const t=this.inertDocument.createElement("html");this.inertDocument.appendChild(t);const e=this.inertDocument.createElement("body");t.appendChild(e)}}getInertBodyElement(t){const e=this.inertDocument.createElement("template");if("content"in e)return e.innerHTML=t,e;const n=this.inertDocument.createElement("body");return n.innerHTML=t,this.defaultDoc.documentMode&&this.stripCustomNsAttrs(n),n}stripCustomNsAttrs(t){const e=t.attributes;for(let r=e.length-1;0<r;r--){const n=e.item(r).name;"xmlns:ns1"!==n&&0!==n.indexOf("ns1:")||t.removeAttribute(n)}let n=t.firstChild;for(;n;)n.nodeType===Node.ELEMENT_NODE&&this.stripCustomNsAttrs(n),n=n.nextSibling}}const Rr=/^(?:(?:https?|mailto|ftp|tel|file):|[^&:/?#]*(?:[/?#]|$))/gi,Ir=/^data:(?:image\/(?:bmp|gif|jpeg|jpg|png|tiff|webp)|video\/(?:mpeg|mp4|ogg|webm)|audio\/(?:mp3|oga|ogg|opus));base64,[a-z0-9+\/]+=*$/i;function Mr(t){return(t=String(t)).match(Rr)||t.match(Ir)?t:(Nr()&&console.warn(`WARNING: sanitizing unsafe URL value ${t} (see http://g.co/ng/security#xss)`),"unsafe:"+t)}function Fr(t){const e={};for(const n of t.split(","))e[n]=!0;return e}function Pr(...t){const e={};for(const n of t)for(const t in n)n.hasOwnProperty(t)&&(e[t]=!0);return e}const jr=Fr("area,br,col,hr,img,wbr"),zr=Fr("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),Lr=Fr("rp,rt"),Br=Pr(Lr,zr),Ur=Pr(jr,Pr(zr,Fr("address,article,aside,blockquote,caption,center,del,details,dialog,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,main,map,menu,nav,ol,pre,section,summary,table,ul")),Pr(Lr,Fr("a,abbr,acronym,audio,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,picture,q,ruby,rp,rt,s,samp,small,source,span,strike,strong,sub,sup,time,track,tt,u,var,video")),Br),$r=Fr("background,cite,href,itemtype,longdesc,poster,src,xlink:href"),Vr=Fr("srcset"),Wr=Pr($r,Vr,Fr("abbr,accesskey,align,alt,autoplay,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,controls,coords,datetime,default,dir,download,face,headers,height,hidden,hreflang,hspace,ismap,itemscope,itemprop,kind,label,lang,language,loop,media,muted,nohref,nowrap,open,preload,rel,rev,role,rows,rowspan,rules,scope,scrolling,shape,size,sizes,span,srclang,start,summary,tabindex,target,title,translate,type,usemap,valign,value,vspace,width"),Fr("aria-activedescendant,aria-atomic,aria-autocomplete,aria-busy,aria-checked,aria-colcount,aria-colindex,aria-colspan,aria-controls,aria-current,aria-describedby,aria-details,aria-disabled,aria-dropeffect,aria-errormessage,aria-expanded,aria-flowto,aria-grabbed,aria-haspopup,aria-hidden,aria-invalid,aria-keyshortcuts,aria-label,aria-labelledby,aria-level,aria-live,aria-modal,aria-multiline,aria-multiselectable,aria-orientation,aria-owns,aria-placeholder,aria-posinset,aria-pressed,aria-readonly,aria-relevant,aria-required,aria-roledescription,aria-rowcount,aria-rowindex,aria-rowspan,aria-selected,aria-setsize,aria-sort,aria-valuemax,aria-valuemin,aria-valuenow,aria-valuetext")),qr=Fr("script,style,template");class Hr{constructor(){this.sanitizedSomething=!1,this.buf=[]}sanitizeChildren(t){let e=t.firstChild,n=!0;for(;e;)if(e.nodeType===Node.ELEMENT_NODE?n=this.startElement(e):e.nodeType===Node.TEXT_NODE?this.chars(e.nodeValue):this.sanitizedSomething=!0,n&&e.firstChild)e=e.firstChild;else for(;e;){e.nodeType===Node.ELEMENT_NODE&&this.endElement(e);let t=this.checkClobberedElement(e,e.nextSibling);if(t){e=t;break}e=this.checkClobberedElement(e,e.parentNode)}return this.buf.join("")}startElement(t){const e=t.nodeName.toLowerCase();if(!Ur.hasOwnProperty(e))return this.sanitizedSomething=!0,!qr.hasOwnProperty(e);this.buf.push("<"),this.buf.push(e);const n=t.attributes;for(let i=0;i<n.length;i++){const t=n.item(i),e=t.name,o=e.toLowerCase();if(!Wr.hasOwnProperty(o)){this.sanitizedSomething=!0;continue}let a=t.value;$r[o]&&(a=Mr(a)),Vr[o]&&(r=a,a=(r=String(r)).split(",").map(t=>Mr(t.trim())).join(", ")),this.buf.push(" ",e,'="',Kr(a),'"')}var r;return this.buf.push(">"),!0}endElement(t){const e=t.nodeName.toLowerCase();Ur.hasOwnProperty(e)&&!jr.hasOwnProperty(e)&&(this.buf.push("</"),this.buf.push(e),this.buf.push(">"))}chars(t){this.buf.push(Kr(t))}checkClobberedElement(t,e){if(e&&(t.compareDocumentPosition(e)&Node.DOCUMENT_POSITION_CONTAINED_BY)===Node.DOCUMENT_POSITION_CONTAINED_BY)throw new Error("Failed to sanitize html because the element is clobbered: "+t.outerHTML);return e}}const Gr=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,Xr=/([^\#-~ |!])/g;function Kr(t){return t.replace(/&/g,"&amp;").replace(Gr,(function(t){return"&#"+(1024*(t.charCodeAt(0)-55296)+(t.charCodeAt(1)-56320)+65536)+";"})).replace(Xr,(function(t){return"&#"+t.charCodeAt(0)+";"})).replace(/</g,"&lt;").replace(/>/g,"&gt;")}let Yr;function Zr(t){return"content"in t&&function(t){return t.nodeType===Node.ELEMENT_NODE&&"TEMPLATE"===t.nodeName}(t)?t.content:null}var Qr=function(t){return t[t.NONE=0]="NONE",t[t.HTML=1]="HTML",t[t.STYLE=2]="STYLE",t[t.SCRIPT=3]="SCRIPT",t[t.URL=4]="URL",t[t.RESOURCE_URL=5]="RESOURCE_URL",t}({});function Jr(t){const e=function(){const t=en();return t&&t[12]}();return e?e.sanitize(Qr.URL,t)||"":Sr(t,"URL")?kr(t):Mr(Hn(t))}function ti(t,e){t.__ngContext__=e}function ei(t){throw new Error("Multiple components match node with tagname "+t.tagName)}function ni(){throw new Error("Cannot mix multi providers and regular providers")}function ri(t,e,n){let r=t.length;for(;;){const i=t.indexOf(e,n);if(-1===i)return i;if(0===i||t.charCodeAt(i-1)<=32){const n=e.length;if(i+n===r||t.charCodeAt(i+n)<=32)return i}n=i+1}}function ii(t,e,n){let r=0;for(;r<t.length;){let i=t[r++];if(n&&"class"===i){if(i=t[r],-1!==ri(i.toLowerCase(),e,0))return!0}else if(1===i){for(;r<t.length&&"string"==typeof(i=t[r++]);)if(i.toLowerCase()===e)return!0;return!1}}return!1}function oi(t){return 0===t.type&&"ng-template"!==t.tagName}function ai(t,e,n){return e===(0!==t.type||n?t.tagName:"ng-template")}function si(t,e,n){let r=4;const i=t.attrs||[],o=function(t){for(let e=0;e<t.length;e++)if(zn(t[e]))return e;return t.length}(i);let a=!1;for(let s=0;s<e.length;s++){const u=e[s];if("number"!=typeof u){if(!a)if(4&r){if(r=2|1&r,""!==u&&!ai(t,u,n)||""===u&&1===e.length){if(ui(r))return!1;a=!0}}else{const l=8&r?u:e[++s];if(8&r&&null!==t.attrs){if(!ii(t.attrs,l,n)){if(ui(r))return!1;a=!0}continue}const c=li(8&r?"class":u,i,oi(t),n);if(-1===c){if(ui(r))return!1;a=!0;continue}if(""!==l){let t;t=c>o?"":i[c+1].toLowerCase();const e=8&r?t:null;if(e&&-1!==ri(e,l,0)||2&r&&l!==t){if(ui(r))return!1;a=!0}}}}else{if(!a&&!ui(r)&&!ui(u))return!1;if(a&&ui(u))continue;a=!1,r=u|1&r}}return ui(r)||a}function ui(t){return 0==(1&t)}function li(t,e,n,r){if(null===e)return-1;let i=0;if(r||!n){let n=!1;for(;i<e.length;){const r=e[i];if(r===t)return i;if(3===r||6===r)n=!0;else{if(1===r||2===r){let t=e[++i];for(;"string"==typeof t;)t=e[++i];continue}if(4===r)break;if(0===r){i+=4;continue}}i+=n?1:2}return-1}return function(t,e){let n=t.indexOf(4);if(n>-1)for(n++;n<t.length;){const r=t[n];if("number"==typeof r)return-1;if(r===e)return n;n++}return-1}(e,t)}function ci(t,e,n=!1){for(let r=0;r<e.length;r++)if(si(t,e[r],n))return!0;return!1}function hi(t,e){t:for(let n=0;n<e.length;n++){const r=e[n];if(t.length===r.length){for(let e=0;e<t.length;e++)if(t[e]!==r[e])continue t;return!0}}return!1}function di(t,e){return t?":not("+e.trim()+")":e}function fi(t){let e=t[0],n=1,r=2,i="",o=!1;for(;n<t.length;){let a=t[n];if("string"==typeof a)if(2&r){const e=t[++n];i+="["+a+(e.length>0?'="'+e+'"':"")+"]"}else 8&r?i+="."+a:4&r&&(i+=" "+a);else""===i||ui(a)||(e+=di(o,i),i=""),r=a,o=o||!ui(r);n++}return""!==i&&(e+=di(o,i)),e}const pi={};function mi(t){const e=t[3];return Ee(e)?e[3]:e}function gi(t){return vi(t[13])}function yi(t){return vi(t[4])}function vi(t){for(;null!==t&&!Ee(t);)t=t[4];return t}function bi(t){wi(nn(),en(),On()+t,ln())}function wi(t,e,n,r){if(!r)if(3==(3&e[2])){const r=t.preOrderCheckHooks;null!==r&&Dn(e,r,n)}else{const r=t.preOrderHooks;null!==r&&Rn(e,r,0,n)}An(n)}function xi(t,e){return t<<17|e<<2}function _i(t){return t>>17&32767}function Ci(t){return 2|t}function ki(t){return(131068&t)>>2}function Si(t,e){return-131069&t|e<<2}function Ei(t){return 1|t}function Oi(t,e){const n=t.contentQueries;if(null!==n)for(let r=0;r<n.length;r+=2){const i=n[r],o=n[r+1];if(-1!==o){const n=t.data[o];bn(i),n.contentQueries(2,e[o],o)}}}function Ai(t,e,n){return Le(e)?e.createElement(t,n):null===n?e.createElement(t):e.createElementNS(n,t)}function Ni(t,e,n,r,i,o,a,s,u,l){const c=e.blueprint.slice();return c[0]=i,c[2]=140|r,Ze(c),c[3]=c[15]=t,c[8]=n,c[10]=a||t&&t[10],c[11]=s||t&&t[11],c[12]=u||t&&t[12]||null,c[9]=l||t&&t[9]||null,c[6]=o,c[16]=2==e.type?t[16]:c,c}function Ti(t,e,n,r,i,o){const a=n+20,s=t.data[a]||function(t,e,n,r,i,o){const a=on(),s=sn(),u=s?a:a&&a.parent,l=t.data[n]=Ui(0,u&&u!==e?u:null,r,n,i,o);return null===t.firstChild&&(t.firstChild=l),a&&(!s||null!=a.child||null===l.parent&&2!==a.type?s||(a.next=l):a.child=l),l}(t,e,a,r,i,o);return an(s,!0),s}function Di(t,e,n){xn(e,e[6]);try{const r=t.viewQuery;null!==r&&lo(1,r,n);const i=t.template;null!==i&&Mi(t,e,i,1,n),t.firstCreatePass&&(t.firstCreatePass=!1),t.staticContentQueries&&Oi(t,e),t.staticViewQueries&&lo(2,t.viewQuery,n);const o=t.components;null!==o&&function(t,e){for(let n=0;n<e.length;n++)io(t,e[n])}(e,o)}catch(r){throw t.firstCreatePass&&(t.incompleteFirstPass=!0),r}finally{e[2]&=-5,En()}}function Ri(t,e,n,r){const i=e[2];if(256==(256&i))return;xn(e,e[6]);const o=ln();try{Ze(e),Je.lFrame.bindingIndex=t.bindingStartIndex,null!==n&&Mi(t,e,n,2,r);const a=3==(3&i);if(!o)if(a){const n=t.preOrderCheckHooks;null!==n&&Dn(e,n,null)}else{const n=t.preOrderHooks;null!==n&&Rn(e,n,0,null),In(e,0)}if(function(t){for(let e=gi(t);null!==e;e=yi(e)){if(!e[2])continue;const t=e[9];for(let e=0;e<t.length;e++){const n=t[e],r=n[3];0==(1024&n[2])&&Qe(r,1),n[2]|=1024}}}(e),function(t){for(let e=gi(t);null!==e;e=yi(e))for(let t=10;t<e.length;t++){const n=e[t],r=n[1];Ke(n)&&Ri(r,n,r.template,n[8])}}(e),null!==t.contentQueries&&Oi(t,e),!o)if(a){const n=t.contentCheckHooks;null!==n&&Dn(e,n)}else{const n=t.contentHooks;null!==n&&Rn(e,n,1),In(e,1)}!function(t,e){try{const n=t.expandoInstructions;if(null!==n){let r=t.expandoStartIndex,i=-1,o=-1;for(let t=0;t<n.length;t++){const a=n[t];"number"==typeof a?a<=0?(o=0-a,An(o),r+=9+n[++t],i=r):r+=a:(null!==a&&(mn(r,i),a(2,e[i])),i++)}}}finally{An(-1)}}(t,e);const s=t.components;null!==s&&function(t,e){for(let n=0;n<e.length;n++)ro(t,e[n])}(e,s);const u=t.viewQuery;if(null!==u&&lo(2,u,r),!o)if(a){const n=t.viewCheckHooks;null!==n&&Dn(e,n)}else{const n=t.viewHooks;null!==n&&Rn(e,n,2),In(e,2)}!0===t.firstUpdatePass&&(t.firstUpdatePass=!1),o||(e[2]&=-73),1024&e[2]&&(e[2]&=-1025,Qe(e[3],-1))}finally{En()}}function Ii(t,e,n,r){const i=e[10],o=!ln(),a=Xe(e);try{o&&!a&&i.begin&&i.begin(),a&&Di(t,e,r),Ri(t,e,n,r)}finally{o&&!a&&i.end&&i.end()}}function Mi(t,e,n,r,i){const o=On();try{An(-1),2&r&&e.length>20&&wi(t,e,0,ln()),n(r,i)}finally{An(o)}}function Fi(t,e,n){if(Oe(e)){const r=e.directiveEnd;for(let i=e.directiveStart;i<r;i++){const e=t.data[i];e.contentQueries&&e.contentQueries(1,n[i],i)}}}function Pi(t,e,n){tn()&&(function(t,e,n,r){const i=n.directiveStart,o=n.directiveEnd;t.firstCreatePass||Jn(n,e),ti(r,e);const a=n.initialInputs;for(let s=i;s<o;s++){const r=t.data[s],o=Te(r);o&&Ji(e,n,r);const u=ur(e,t,s,n);ti(u,e),null!==a&&to(0,s-i,u,r,0,a),o&&(He(n.index,e)[8]=u)}}(t,e,n,Ve(n,e)),128==(128&n.flags)&&function(t,e,n){const r=n.directiveStart,i=n.directiveEnd,o=t.expandoInstructions,a=t.firstCreatePass,s=n.index-20,u=Je.lFrame.currentDirectiveIndex;try{An(s);for(let n=r;n<i;n++){const r=t.data[n],i=e[n];gn(n),null!==r.hostBindings||0!==r.hostVars||null!==r.hostAttrs?Gi(r,i):a&&o.push(null)}}finally{An(-1),gn(u)}}(t,e,n))}function ji(t,e,n=Ve){const r=e.localNames;if(null!==r){let i=e.index+1;for(let o=0;o<r.length;o+=2){const a=r[o+1],s=-1===a?n(e,t):t[a];t[i++]=s}}}function zi(t){const e=t.tView;return null===e||e.incompleteFirstPass?t.tView=Li(1,-1,t.template,t.decls,t.vars,t.directiveDefs,t.pipeDefs,t.viewQuery,t.schemas,t.consts):e}function Li(t,e,n,r,i,o,a,s,u,l){const c=20+r,h=c+i,d=function(t,e){const n=[];for(let r=0;r<e;r++)n.push(r<t?null:pi);return n}(c,h);return d[1]={type:t,id:e,blueprint:d,template:n,queries:null,viewQuery:s,node:null,data:d.slice().fill(null,c),bindingStartIndex:c,expandoStartIndex:h,expandoInstructions:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof o?o():o,pipeRegistry:"function"==typeof a?a():a,firstChild:null,schemas:u,consts:l,incompleteFirstPass:!1}}function Bi(t,e,n,r){const i=ho(e);i.push(n),t.firstCreatePass&&function(t){return t.cleanup||(t.cleanup=[])}(t).push(r,i.length-1)}function Ui(t,e,n,r,i,o){return{type:n,index:r,injectorIndex:e?e.injectorIndex:-1,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,propertyBindings:null,flags:0,providerIndexes:0,tagName:i,attrs:o,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tViews:null,next:null,projectionNext:null,child:null,parent:e,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}function $i(t,e,n){for(let r in t)if(t.hasOwnProperty(r)){const i=t[r];(n=null===n?{}:n).hasOwnProperty(r)?n[r].push(e,i):n[r]=[e,i]}return n}function Vi(t,e,n,r,i,o,a,s){const u=Ve(e,n);let l,c=e.inputs;var h;!s&&null!=c&&(l=c[r])?(mo(t,n,l,r,i),Ae(e)&&function(t,e){const n=He(e,t);16&n[2]||(n[2]|=64)}(n,e.index)):3===e.type&&(r="class"===(h=r)?"className":"for"===h?"htmlFor":"formaction"===h?"formAction":"innerHtml"===h?"innerHTML":"readonly"===h?"readOnly":"tabindex"===h?"tabIndex":h,i=null!=a?a(i,e.tagName||"",r):i,Le(o)?o.setProperty(u,r,i):Ln(r)||(u.setProperty?u.setProperty(r,i):u[r]=i))}function Wi(t,e,n,r){let i=!1;if(tn()){const o=function(t,e,n){const r=t.directiveRegistry;let i=null;if(r)for(let o=0;o<r.length;o++){const a=r[o];ci(n,a.selectors,!1)&&(i||(i=[]),rr(Jn(n,e),t,a.type),Te(a)?(2&n.flags&&ei(n),Ki(t,n),i.unshift(a)):i.push(a))}return i}(t,e,n),a=null===r?null:{"":-1};if(null!==o){let r=0;i=!0,Zi(n,t.data.length,o.length);for(let t=0;t<o.length;t++){const e=o[t];e.providersResolver&&e.providersResolver(e)}Xi(t,n,o.length);let s=!1,u=!1;for(let i=0;i<o.length;i++){const l=o[i];n.mergedAttrs=Bn(n.mergedAttrs,l.hostAttrs),Qi(t,e,l),Yi(t.data.length-1,l,a),null!==l.contentQueries&&(n.flags|=8),null===l.hostBindings&&null===l.hostAttrs&&0===l.hostVars||(n.flags|=128);const c=l.type.prototype;!s&&(c.ngOnChanges||c.ngOnInit||c.ngDoCheck)&&((t.preOrderHooks||(t.preOrderHooks=[])).push(n.index-20),s=!0),u||!c.ngOnChanges&&!c.ngDoCheck||((t.preOrderCheckHooks||(t.preOrderCheckHooks=[])).push(n.index-20),u=!0),qi(t,l),r+=l.hostVars}!function(t,e){const n=e.directiveEnd,r=t.data,i=e.attrs,o=[];let a=null,s=null;for(let u=e.directiveStart;u<n;u++){const t=r[u],n=t.inputs,l=null===i||oi(e)?null:eo(n,i);o.push(l),a=$i(n,u,a),s=$i(t.outputs,u,s)}null!==a&&(a.hasOwnProperty("class")&&(e.flags|=16),a.hasOwnProperty("style")&&(e.flags|=32)),e.initialInputs=o,e.inputs=a,e.outputs=s}(t,n),Hi(t,e,r)}a&&function(t,e,n){if(e){const r=t.localNames=[];for(let t=0;t<e.length;t+=2){const i=n[e[t+1]];if(null==i)throw new Error(`Export of name '${e[t+1]}' not found!`);r.push(e[t],i)}}}(n,r,a)}return n.mergedAttrs=Bn(n.mergedAttrs,n.attrs),i}function qi(t,e){const n=t.expandoInstructions;n.push(e.hostBindings),0!==e.hostVars&&n.push(e.hostVars)}function Hi(t,e,n){for(let r=0;r<n;r++)e.push(pi),t.blueprint.push(pi),t.data.push(null)}function Gi(t,e){null!==t.hostBindings&&t.hostBindings(1,e)}function Xi(t,e,n){const r=20-e.index,i=t.data.length-(1048575&e.providerIndexes);(t.expandoInstructions||(t.expandoInstructions=[])).push(r,i,n)}function Ki(t,e){e.flags|=2,(t.components||(t.components=[])).push(e.index)}function Yi(t,e,n){if(n){if(e.exportAs)for(let r=0;r<e.exportAs.length;r++)n[e.exportAs[r]]=t;Te(e)&&(n[""]=t)}}function Zi(t,e,n){t.flags|=1,t.directiveStart=e,t.directiveEnd=e+n,t.providerIndexes=e}function Qi(t,e,n){t.data.push(n);const r=n.factory||(n.factory=Ce(n.type)),i=new Pn(r,Te(n),null);t.blueprint.push(i),e.push(i)}function Ji(t,e,n){const r=Ve(e,t),i=zi(n),o=t[10],a=oo(t,Ni(t,i,null,n.onPush?64:16,r,e,o,o.createRenderer(r,n)));t[e.index]=a}function to(t,e,n,r,i,o){const a=o[e];if(null!==a){const t=r.setInput;for(let e=0;e<a.length;){const i=a[e++],o=a[e++],s=a[e++];null!==t?r.setInput(n,s,i,o):n[o]=s}}}function eo(t,e){let n=null,r=0;for(;r<e.length;){const i=e[r];if(0!==i)if(5!==i){if("number"==typeof i)break;t.hasOwnProperty(i)&&(null===n&&(n=[]),n.push(i,t[i],e[r+1])),r+=2}else r+=2;else r+=4}return n}function no(t,e,n,r){return new Array(t,!0,!1,e,null,0,r,n,null,null)}function ro(t,e){const n=He(e,t);if(Ke(n)){const t=n[1];80&n[2]?Ri(t,n,t.template,n[8]):n[5]>0&&function t(e){for(let r=gi(e);null!==r;r=yi(r))for(let e=10;e<r.length;e++){const n=r[e];if(1024&n[2]){const t=n[1];Ri(t,n,t.template,n[8])}else n[5]>0&&t(n)}const n=e[1].components;if(null!==n)for(let r=0;r<n.length;r++){const i=He(n[r],e);Ke(i)&&i[5]>0&&t(i)}}(n)}}function io(t,e){const n=He(e,t),r=n[1];!function(t,e){for(let n=e.length;n<t.blueprint.length;n++)e.push(t.blueprint[n])}(r,n),Di(r,n,n[8])}function oo(t,e){return t[13]?t[14][4]=e:t[13]=e,t[14]=e,e}function ao(t){for(;t;){t[2]|=64;const e=mi(t);if(De(t)&&!e)return t;t=e}return null}function so(t,e,n){const r=e[10];r.begin&&r.begin();try{Ri(t,e,t.template,n)}catch(i){throw po(e,i),i}finally{r.end&&r.end()}}function uo(t){!function(t){for(let e=0;e<t.components.length;e++){const n=t.components[e],r=Ge(n),i=r[1];Ii(i,r,i.template,n)}}(t[8])}function lo(t,e,n){bn(0),e(t,n)}const co=(()=>Promise.resolve(null))();function ho(t){return t[7]||(t[7]=[])}function fo(t,e,n){return(null===t||Te(t))&&(n=function(t){for(;Array.isArray(t);){if("object"==typeof t[1])return t;t=t[0]}return null}(n[e.index])),n[11]}function po(t,e){const n=t[9],r=n?n.get(yr,null):null;r&&r.handleError(e)}function mo(t,e,n,r,i){for(let o=0;o<n.length;){const a=n[o++],s=n[o++],u=e[a],l=t.data[a];null!==l.setInput?l.setInput(u,i,r,s):u[s]=i}}function go(t,e,n){const r=$e(e,t),i=t[11];Le(i)?i.setValue(r,n):r.textContent=n}function yo(t,e){const n=e[3];return-1===t.index?Ee(n)?n:null:n}function vo(t,e){const n=yo(t,e);return n?To(e[11],n[7]):null}function bo(t,e,n,r,i){if(null!=r){let o,a=!1;Ee(r)?o=r:Se(r)&&(a=!0,r=r[0]);const s=Ue(r);0===t&&null!==n?null==i?Ao(e,n,s):Oo(e,n,s,i||null):1===t&&null!==n?Oo(e,n,s,i||null):2===t?function(t,e,n){const r=To(t,e);r&&function(t,e,n,r){Le(t)?t.removeChild(e,n,r):e.removeChild(n)}(t,r,e,n)}(e,s,a):3===t&&e.destroyNode(s),null!=o&&function(t,e,n,r,i){const o=n[7];o!==Ue(n)&&bo(e,t,r,o,i);for(let a=10;a<n.length;a++){const i=n[a];Fo(i[1],i,t,e,r,o)}}(e,t,o,n,i)}}function wo(t,e,n,r){const i=vo(t.node,e);i&&Fo(t,e,e[11],n?1:2,i,r)}function xo(t,e){const n=t[9],r=n.indexOf(e);1024&e[2]&&Qe(e[3],-1),n.splice(r,1)}function _o(t,e){if(t.length<=10)return;const n=10+e,r=t[n];if(r){const i=r[17];null!==i&&i!==t&&xo(i,r),e>0&&(t[n-1][4]=r[4]);const o=ie(t,10+e);wo(r[1],r,!1,null);const a=o[19];null!==a&&a.detachView(o[1]),r[3]=null,r[4]=null,r[2]&=-129}return r}function Co(t,e){if(!(256&e[2])){const n=e[11];Le(n)&&n.destroyNode&&Fo(t,e,n,3,null,null),function(t){let e=t[13];if(!e)return So(t[1],t);for(;e;){let n=null;if(Se(e))n=e[13];else{const t=e[10];t&&(n=t)}if(!n){for(;e&&!e[4]&&e!==t;)Se(e)&&So(e[1],e),e=ko(e,t);null===e&&(e=t),Se(e)&&So(e[1],e),n=e&&e[4]}e=n}}(e)}}function ko(t,e){let n;return Se(t)&&(n=t[6])&&2===n.type?yo(n,t):t[3]===e?null:t[3]}function So(t,e){if(!(256&e[2])){e[2]&=-129,e[2]|=256,function(t,e){let n;if(null!=t&&null!=(n=t.destroyHooks))for(let r=0;r<n.length;r+=2){const t=e[n[r]];if(!(t instanceof Pn)){const e=n[r+1];if(Array.isArray(e))for(let n=0;n<e.length;n+=2)e[n+1].call(t[e[n]]);else e.call(t)}}}(t,e),function(t,e){const n=t.cleanup;if(null!==n){const t=e[7];for(let r=0;r<n.length-1;r+=2)if("string"==typeof n[r]){const i=n[r+1],o="function"==typeof i?i(e):Ue(e[i]),a=t[n[r+2]],s=n[r+3];"boolean"==typeof s?o.removeEventListener(n[r],a,s):s>=0?t[s]():t[-s].unsubscribe(),r+=2}else n[r].call(t[n[r+1]]);e[7]=null}}(t,e);const n=e[6];n&&3===n.type&&Le(e[11])&&e[11].destroy();const r=e[17];if(null!==r&&Ee(e[3])){r!==e[3]&&xo(r,e);const n=e[19];null!==n&&n.detachView(t)}}}function Eo(t,e,n){let r=e.parent;for(;null!=r&&(4===r.type||5===r.type);)r=(e=r).parent;if(null==r){const t=n[6];return 2===t.type?vo(t,n):n[0]}if(e&&5===e.type&&4&e.flags)return Ve(e,n).parentNode;if(2&r.flags){const e=t.data,n=e[e[r.index].directiveStart].encapsulation;if(n!==ce.ShadowDom&&n!==ce.Native)return null}return Ve(r,n)}function Oo(t,e,n,r){Le(t)?t.insertBefore(e,n,r):e.insertBefore(n,r,!0)}function Ao(t,e,n){Le(t)?t.appendChild(e,n):e.appendChild(n)}function No(t,e,n,r){null!==r?Oo(t,e,n,r):Ao(t,e,n)}function To(t,e){return Le(t)?t.parentNode(e):e.parentNode}function Do(t,e){if(2===t.type){const n=yo(t,e);return null===n?null:Io(n.indexOf(e,10)-10,n)}return 4===t.type||5===t.type?Ve(t,e):null}function Ro(t,e,n,r){const i=Eo(t,r,e);if(null!=i){const t=e[11],o=Do(r.parent||e[6],e);if(Array.isArray(n))for(let e=0;e<n.length;e++)No(t,i,n[e],o);else No(t,i,n,o)}}function Io(t,e){const n=10+t+1;if(n<e.length){const t=e[n],r=t[1].firstChild;if(null!==r)return function t(e,n){if(null!==n){const r=n.type;if(3===r)return Ve(n,e);if(0===r)return Io(-1,e[n.index]);if(4===r||5===r){const r=n.child;if(null!==r)return t(e,r);{const t=e[n.index];return Ee(t)?Io(-1,t):Ue(t)}}{const r=e[16],i=r[6],o=mi(r),a=i.projection[n.projection];return null!=a?t(o,a):t(e,n.next)}}return null}(t,r)}return e[7]}function Mo(t,e,n,r,i,o,a){for(;null!=n;){const s=r[n.index],u=n.type;a&&0===e&&(s&&ti(Ue(s),r),n.flags|=4),64!=(64&n.flags)&&(4===u||5===u?(Mo(t,e,n.child,r,i,o,!1),bo(e,t,i,s,o)):1===u?Po(t,e,r,n,i,o):bo(e,t,i,s,o)),n=a?n.projectionNext:n.next}}function Fo(t,e,n,r,i,o){Mo(n,r,t.node.child,e,i,o,!1)}function Po(t,e,n,r,i,o){const a=n[16],s=a[6].projection[r.projection];if(Array.isArray(s))for(let u=0;u<s.length;u++)bo(e,t,i,s[u],o);else Mo(t,e,s,a[3],i,o,!0)}function jo(t,e,n){Le(t)?t.setAttribute(e,"style",n):e.style.cssText=n}function zo(t,e,n){Le(t)?""===n?t.removeAttribute(e,"class"):t.setAttribute(e,"class",n):e.className=n}class Lo{constructor(t,e){this._lView=t,this._cdRefInjectingView=e,this._appRef=null,this._viewContainerRef=null}get rootNodes(){const t=this._lView;return null==t[0]?function t(e,n,r,i,o=!1){for(;null!==r;){const a=n[r.index];if(null!==a&&i.push(Ue(a)),Ee(a))for(let e=10;e<a.length;e++){const n=a[e],r=n[1].firstChild;null!==r&&t(n[1],n,r,i)}const s=r.type;if(4===s||5===s)t(e,n,r.child,i);else if(1===s){const e=n[16],o=e[6].projection[r.projection];if(Array.isArray(o))i.push(...o);else{const n=mi(e);t(n[1],n,o,i,!0)}}r=o?r.projectionNext:r.next}return i}(t[1],t,t[6].child,[]):[]}get context(){return this._lView[8]}get destroyed(){return 256==(256&this._lView[2])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._viewContainerRef){const t=this._viewContainerRef.indexOf(this);t>-1&&this._viewContainerRef.detach(t),this._viewContainerRef=null}Co(this._lView[1],this._lView)}onDestroy(t){Bi(this._lView[1],this._lView,null,t)}markForCheck(){ao(this._cdRefInjectingView||this._lView)}detach(){this._lView[2]&=-129}reattach(){this._lView[2]|=128}detectChanges(){so(this._lView[1],this._lView,this.context)}checkNoChanges(){!function(t,e,n){cn(!0);try{so(t,e,n)}finally{cn(!1)}}(this._lView[1],this._lView,this.context)}attachToViewContainerRef(t){if(this._appRef)throw new Error("This view is already attached directly to the ApplicationRef!");this._viewContainerRef=t}detachFromAppRef(){var t;this._appRef=null,Fo(this._lView[1],t=this._lView,t[11],2,null,null)}attachToAppRef(t){if(this._viewContainerRef)throw new Error("This view is already attached to a ViewContainer!");this._appRef=t}}class Bo extends Lo{constructor(t){super(t),this._view=t}detectChanges(){uo(this._view)}checkNoChanges(){!function(t){cn(!0);try{uo(t)}finally{cn(!1)}}(this._view)}get context(){return null}}let Uo,$o,Vo;function Wo(t,e,n){return Uo||(Uo=class extends t{}),new Uo(Ve(e,n))}function qo(t,e,n,r){return $o||($o=class extends t{constructor(t,e,n){super(),this._declarationView=t,this._declarationTContainer=e,this.elementRef=n}createEmbeddedView(t){const e=this._declarationTContainer.tViews,n=Ni(this._declarationView,e,t,16,null,e.node);n[17]=this._declarationView[this._declarationTContainer.index];const r=this._declarationView[19];return null!==r&&(n[19]=r.createEmbeddedView(e)),Di(e,n,t),new Lo(n)}}),0===n.type?new $o(r,n,Wo(e,n,r)):null}function Ho(t,e,n,r){let i;Vo||(Vo=class extends t{constructor(t,e,n){super(),this._lContainer=t,this._hostTNode=e,this._hostView=n}get element(){return Wo(e,this._hostTNode,this._hostView)}get injector(){return new hr(this._hostTNode,this._hostView)}get parentInjector(){const t=nr(this._hostTNode,this._hostView),e=qn(t,this._hostView),n=function(t,e,n){if(n.parent&&-1!==n.parent.injectorIndex){const t=n.parent.injectorIndex;let e=n.parent;for(;null!=e.parent&&t==e.parent.injectorIndex;)e=e.parent;return e}let r=Wn(t),i=e,o=e[6];for(;r>1;)i=i[15],o=i[6],r--;return o}(t,this._hostView,this._hostTNode);return $n(t)&&null!=n?new hr(n,e):new hr(null,this._hostView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(t){return null!==this._lContainer[8]&&this._lContainer[8][t]||null}get length(){return this._lContainer.length-10}createEmbeddedView(t,e,n){const r=t.createEmbeddedView(e||{});return this.insert(r,n),r}createComponent(t,e,n,r,i){const o=n||this.parentInjector;if(!i&&null==t.ngModule&&o){const t=o.get(te,null);t&&(i=t)}const a=t.create(o,r,void 0,i);return this.insert(a.hostView,e),a}insert(t,e){const n=t._lView,r=n[1];if(t.destroyed)throw new Error("Cannot insert a destroyed View in a ViewContainer!");if(this.allocateContainerIfNeeded(),Ee(n[3])){const e=this.indexOf(t);if(-1!==e)this.detach(e);else{const e=n[3],r=new Vo(e,e[6],e[3]);r.detach(r.indexOf(t))}}const i=this._adjustIndex(e);return function(t,e,n,r){const i=10+r,o=n.length;r>0&&(n[i-1][4]=e),r<o-10?(e[4]=n[i],re(n,10+r,e)):(n.push(e),e[4]=null),e[3]=n;const a=e[17];null!==a&&n!==a&&function(t,e){const n=t[9];e[16]!==e[3][3][16]&&(t[2]=!0),null===n?t[9]=[e]:n.push(e)}(a,e);const s=e[19];null!==s&&s.insertView(t),e[2]|=128}(r,n,this._lContainer,i),wo(r,n,!0,Io(i,this._lContainer)),t.attachToViewContainerRef(this),re(this._lContainer[8],i,t),t}move(t,e){if(t.destroyed)throw new Error("Cannot move a destroyed View in a ViewContainer!");return this.insert(t,e)}indexOf(t){const e=this._lContainer[8];return null!==e?e.indexOf(t):-1}remove(t){this.allocateContainerIfNeeded();const e=this._adjustIndex(t,-1);!function(t,e){const n=_o(t,e);n&&Co(n[1],n)}(this._lContainer,e),ie(this._lContainer[8],e)}detach(t){this.allocateContainerIfNeeded();const e=this._adjustIndex(t,-1),n=_o(this._lContainer,e);return n&&null!=ie(this._lContainer[8],e)?new Lo(n):null}_adjustIndex(t,e=0){return null==t?this.length+e:t}allocateContainerIfNeeded(){null===this._lContainer[8]&&(this._lContainer[8]=[])}});const o=r[n.index];if(Ee(o))i=o;else{let t;if(4===n.type)t=Ue(o);else if(t=r[11].createComment(""),De(r)){const e=r[11],i=Ve(n,r);Oo(e,To(e,i),t,function(t,e){return Le(t)?t.nextSibling(e):e.nextSibling}(e,i))}else Ro(r[1],r,t,n);r[n.index]=i=no(o,r,t,n),oo(r,i)}return new Vo(i,n,r)}let Go=(()=>{class t{}return t.__NG_ELEMENT_ID__=()=>Xo(),t})();const Xo=function(t=!1){return function(t,e,n){if(!n&&Ae(t)){const n=He(t.index,e);return new Lo(n,n)}return 3===t.type||0===t.type||4===t.type||5===t.type?new Lo(e[16],e):null}(on(),en(),t)},Ko=Function,Yo=new Lt("Set Injector scope."),Zo={},Qo={},Jo=[];let ta=void 0;function ea(){return void 0===ta&&(ta=new Jt),ta}function na(t,e=null,n=null,r){return new ra(t,n,e||ea(),r)}class ra{constructor(t,e,n,r=null){this.parent=n,this.records=new Map,this.injectorDefTypes=new Set,this.onDestroy=new Set,this._destroyed=!1;const i=[];e&&ne(e,n=>this.processProvider(n,t,e)),ne([t],t=>this.processInjectorType(t,[],i)),this.records.set(Bt,aa(void 0,this));const o=this.records.get(Yo);this.scope=null!=o?o.value:null,this.source=r||("object"==typeof t?null:xt(t))}get destroyed(){return this._destroyed}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{this.onDestroy.forEach(t=>t.ngOnDestroy())}finally{this.records.clear(),this.onDestroy.clear(),this.injectorDefTypes.clear()}}get(t,e=Ut,n=ut.Default){this.assertNotDestroyed();const r=Ht(this);try{if(!(n&ut.SkipSelf)){let e=this.records.get(t);if(void 0===e){const n=("function"==typeof(i=t)||"object"==typeof i&&i instanceof Lt)&&ft(t);e=n&&this.injectableDefInScope(n)?aa(ia(t),Zo):null,this.records.set(t,e)}if(null!=e)return this.hydrate(t,e)}return(n&ut.Self?ea():this.parent).get(t,e=n&ut.Optional&&e===Ut?null:e)}catch(o){if("NullInjectorError"===o.name){if((o.ngTempTokenPath=o.ngTempTokenPath||[]).unshift(xt(t)),r)throw o;return function(t,e,n,r){const i=t.ngTempTokenPath;throw e.__source&&i.unshift(e.__source),t.message=function(t,e,n,r=null){t=t&&"\n"===t.charAt(0)&&"\u0275"==t.charAt(1)?t.substr(2):t;let i=xt(e);if(Array.isArray(e))i=e.map(xt).join(" -> ");else if("object"==typeof e){let t=[];for(let n in e)if(e.hasOwnProperty(n)){let r=e[n];t.push(n+":"+("string"==typeof r?JSON.stringify(r):xt(r)))}i=`{${t.join(", ")}}`}return`${n}${r?"("+r+")":""}[${i}]: ${t.replace($t,"\n  ")}`}("\n"+t.message,i,n,r),t.ngTokenPath=i,t.ngTempTokenPath=null,t}(o,t,"R3InjectorError",this.source)}throw o}finally{Ht(r)}var i}_resolveInjectorDefTypes(){this.injectorDefTypes.forEach(t=>this.get(t))}toString(){const t=[];return this.records.forEach((e,n)=>t.push(xt(n))),`R3Injector[${t.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new Error("Injector has already been destroyed.")}processInjectorType(t,e,n){if(!(t=St(t)))return!1;let r=mt(t);const i=null==r&&t.ngModule||void 0,o=void 0===i?t:i,a=-1!==n.indexOf(o);if(void 0!==i&&(r=mt(i)),null==r)return!1;if(null!=r.imports&&!a){let t;n.push(o);try{ne(r.imports,r=>{this.processInjectorType(r,e,n)&&(void 0===t&&(t=[]),t.push(r))})}finally{}if(void 0!==t)for(let e=0;e<t.length;e++){const{ngModule:n,providers:r}=t[e];ne(r,t=>this.processProvider(t,n,r||Jo))}}this.injectorDefTypes.add(o),this.records.set(o,aa(r.factory,Zo));const s=r.providers;if(null!=s&&!a){const e=t;ne(s,t=>this.processProvider(t,e,s))}return void 0!==i&&void 0!==t.providers}processProvider(t,e,n){let r=ua(t=St(t))?t:St(t&&t.provide);const i=function(t,e,n){return sa(t)?aa(void 0,t.useValue):aa(oa(t,e,n),Zo)}(t,e,n);if(ua(t)||!0!==t.multi){const t=this.records.get(r);t&&void 0!==t.multi&&ni()}else{let e=this.records.get(r);e?void 0===e.multi&&ni():(e=aa(void 0,Zo,!0),e.factory=()=>Qt(e.multi),this.records.set(r,e)),r=t,e.multi.push(t)}this.records.set(r,i)}hydrate(t,e){var n;return e.value===Qo?function(t){throw new Error("Cannot instantiate cyclic dependency! "+t)}(xt(t)):e.value===Zo&&(e.value=Qo,e.value=e.factory()),"object"==typeof e.value&&e.value&&null!==(n=e.value)&&"object"==typeof n&&"function"==typeof n.ngOnDestroy&&this.onDestroy.add(e.value),e.value}injectableDefInScope(t){return!!t.providedIn&&("string"==typeof t.providedIn?"any"===t.providedIn||t.providedIn===this.scope:this.injectorDefTypes.has(t.providedIn))}}function ia(t){const e=ft(t),n=null!==e?e.factory:Ce(t);if(null!==n)return n;const r=mt(t);if(null!==r)return r.factory;if(t instanceof Lt)throw new Error(`Token ${xt(t)} is missing a \u0275prov definition.`);if(t instanceof Function)return function(t){const e=t.length;if(e>0){const n=oe(e,"?");throw new Error(`Can't resolve all parameters for ${xt(t)}: (${n.join(", ")}).`)}const n=function(t){const e=t&&(t[gt]||t[bt]||t[vt]&&t[vt]());if(e){const n=function(t){if(t.hasOwnProperty("name"))return t.name;const e=(""+t).match(/^function\s*([^\s(]+)/);return null===e?"":e[1]}(t);return console.warn(`DEPRECATED: DI is instantiating a token "${n}" that inherits its @Injectable decorator but does not provide one itself.\nThis will become an error in a future version of Angular. Please add @Injectable() to the "${n}" class.`),e}return null}(t);return null!==n?()=>n.factory(t):()=>new t}(t);throw new Error("unreachable")}function oa(t,e,n){let r=void 0;if(ua(t)){const e=St(t);return Ce(e)||ia(e)}if(sa(t))r=()=>St(t.useValue);else if((i=t)&&i.useFactory)r=()=>t.useFactory(...Qt(t.deps||[]));else if(function(t){return!(!t||!t.useExisting)}(t))r=()=>Kt(St(t.useExisting));else{const i=St(t&&(t.useClass||t.provide));if(i||function(t,e,n){let r="";throw t&&e&&(r=` - only instances of Provider and Type are allowed, got: [${e.map(t=>t==n?"?"+n+"?":"...").join(", ")}]`),new Error(`Invalid provider for the NgModule '${xt(t)}'`+r)}(e,n,t),!function(t){return!!t.deps}(t))return Ce(i)||ia(i);r=()=>new i(...Qt(t.deps))}var i;return r}function aa(t,e,n=!1){return{factory:t,value:e,multi:n?[]:void 0}}function sa(t){return null!==t&&"object"==typeof t&&Vt in t}function ua(t){return"function"==typeof t}const la=function(t,e,n){return function(t,e=null,n=null,r){const i=na(t,e,n,r);return i._resolveInjectorDefTypes(),i}({name:n},e,t,n)};let ca=(()=>{class t{static create(t,e){return Array.isArray(t)?la(t,e,""):la(t.providers,t.parent,t.name||"")}}return t.THROW_IF_NOT_FOUND=Ut,t.NULL=new Jt,t.\u0275prov=ht({token:t,providedIn:"any",factory:()=>Kt(Bt)}),t.__NG_ELEMENT_ID__=-1,t})();const ha=new Lt("AnalyzeForEntryComponents");function da(t,e,n){let r=n?t.styles:null,i=n?t.classes:null,o=0;if(null!==e)for(let a=0;a<e.length;a++){const t=e[a];"number"==typeof t?o=t:1==o?i=_t(i,t):2==o&&(r=_t(r,t+": "+e[++a]+";"))}n?t.styles=r:t.stylesWithoutHost=r,n?t.classes=i:t.classesWithoutHost=i}let fa=null;function pa(){if(!fa){const t=Dt.Symbol;if(t&&t.iterator)fa=t.iterator;else{const t=Object.getOwnPropertyNames(Map.prototype);for(let e=0;e<t.length;++e){const n=t[e];"entries"!==n&&"size"!==n&&Map.prototype[n]===Map.prototype.entries&&(fa=n)}}}return fa}class ma{constructor(t){this.wrapped=t}static wrap(t){return new ma(t)}static unwrap(t){return ma.isWrapped(t)?t.wrapped:t}static isWrapped(t){return t instanceof ma}}function ga(t){return!!ya(t)&&(Array.isArray(t)||!(t instanceof Map)&&pa()in t)}function ya(t){return null!==t&&("function"==typeof t||"object"==typeof t)}function va(t,e,n){return t[e]=n}function ba(t,e,n){return!Object.is(t[e],n)&&(t[e]=n,!0)}function wa(t,e,n,r){const i=en();return ba(i,fn(),e)&&(nn(),function(t,e,n,r,i,o){const a=Ve(t,e),s=e[11];if(null==r)Le(s)?s.removeAttribute(a,n,o):a.removeAttribute(n);else{const e=null==i?Hn(r):i(r,t.tagName||"",n);Le(s)?s.setAttribute(a,n,e,o):o?a.setAttributeNS(o,n,e):a.setAttribute(n,e)}}(Nn(),i,t,e,n,r)),wa}function xa(t,e,n,r){return ba(t,fn(),n)?e+Hn(n)+r:pi}function _a(t,e,n,r,i,o,a,s){const u=en(),l=nn(),c=t+20,h=l.firstCreatePass?function(t,e,n,r,i,o,a,s,u){const l=e.consts,c=Ti(e,n[6],t,0,a||null,Ye(l,s));Wi(e,n,c,Ye(l,u)),Tn(e,c);const h=c.tViews=Li(2,-1,r,i,o,e.directiveRegistry,e.pipeRegistry,null,e.schemas,l),d=Ui(0,null,2,-1,null,null);return d.injectorIndex=c.injectorIndex,h.node=d,null!==e.queries&&(e.queries.template(e,c),h.queries=e.queries.embeddedTView(c)),c}(t,l,u,e,n,r,i,o,a):l.data[c];an(h,!1);const d=u[11].createComment("");Ro(l,u,d,h),ti(d,u),oo(u,u[c]=no(d,u,d,h)),Ne(h)&&Pi(l,u,h),null!=a&&ji(u,h,s)}function Ca(t){return qe(Je.lFrame.contextLView,t)}function ka(t,e=ut.Default){const n=en();return null==n?Kt(t,e):ir(on(),n,St(t),e)}function Sa(t){return function(t,e){if("class"===e)return t.classes;if("style"===e)return t.styles;const n=t.attrs;if(n){const t=n.length;let r=0;for(;r<t;){const i=n[r];if(zn(i))break;if(0===i)r+=2;else if("number"==typeof i)for(r++;r<t&&"string"==typeof n[r];)r++;else{if(i===e)return n[r+1];r+=2}}}return null}(on(),t)}function Ea(t,e,n){const r=en();return ba(r,fn(),e)&&Vi(nn(),Nn(),r,t,e,r[11],n,!1),Ea}function Oa(t,e,n,r,i){const o=i?"class":"style";mo(t,n,e.inputs[o],o,r)}function Aa(t,e,n,r){const i=en(),o=nn(),a=20+t,s=i[11],u=i[a]=Ai(e,s,Je.lFrame.currentNamespace),l=o.firstCreatePass?function(t,e,n,r,i,o,a){const s=e.consts,u=Ye(s,o),l=Ti(e,n[6],t,3,i,u);return Wi(e,n,l,Ye(s,a)),null!==l.attrs&&da(l,l.attrs,!1),null!==l.mergedAttrs&&da(l,l.mergedAttrs,!0),null!==e.queries&&e.queries.elementStart(e,l),l}(t,o,i,0,e,n,r):o.data[a];an(l,!0);const c=l.mergedAttrs;null!==c&&jn(s,u,c);const h=l.classes;null!==h&&zo(s,u,h);const d=l.styles;null!==d&&jo(s,u,d),Ro(o,i,u,l),0===Je.lFrame.elementDepthCount&&ti(u,i),Je.lFrame.elementDepthCount++,Ne(l)&&(Pi(o,i,l),Fi(o,l,i)),null!==r&&ji(i,l)}function Na(){let t=on();sn()?un():(t=t.parent,an(t,!1));const e=t;Je.lFrame.elementDepthCount--;const n=nn();n.firstCreatePass&&(Tn(n,t),Oe(t)&&n.queries.elementEnd(t)),null!=e.classesWithoutHost&&function(t){return 0!=(16&t.flags)}(e)&&Oa(n,e,en(),e.classesWithoutHost,!0),null!=e.stylesWithoutHost&&function(t){return 0!=(32&t.flags)}(e)&&Oa(n,e,en(),e.stylesWithoutHost,!1)}function Ta(t,e,n,r){Aa(t,e,n,r),Na()}function Da(t,e,n){const r=en(),i=nn(),o=t+20,a=i.firstCreatePass?function(t,e,n,r,i){const o=e.consts,a=Ye(o,r),s=Ti(e,n[6],t,4,"ng-container",a);return null!==a&&da(s,a,!0),Wi(e,n,s,Ye(o,i)),null!==e.queries&&e.queries.elementStart(e,s),s}(t,i,r,e,n):i.data[o];an(a,!0);const s=r[o]=r[11].createComment("");Ro(i,r,s,a),ti(s,r),Ne(a)&&(Pi(i,r,a),Fi(i,a,r)),null!=n&&ji(r,a)}function Ra(){let t=on();const e=nn();sn()?un():(t=t.parent,an(t,!1)),e.firstCreatePass&&(Tn(e,t),Oe(t)&&e.queries.elementEnd(t))}function Ia(){return en()}function Ma(t){return!!t&&"function"==typeof t.then}function Fa(t){return!!t&&"function"==typeof t.subscribe}function Pa(t,e,n=!1,r){const i=en(),o=nn(),a=on();return za(o,i,i[11],a,t,e,n,r),Pa}function ja(t,e,n=!1,r){const i=on(),o=en(),a=nn();return za(a,o,fo(yn(a.data),i,o),i,t,e,n,r),ja}function za(t,e,n,r,i,o,a=!1,s){const u=Ne(r),l=t.firstCreatePass&&(t.cleanup||(t.cleanup=[])),c=ho(e);let h=!0;if(3===r.type){const d=Ve(r,e),f=s?s(d):he,p=f.target||d,m=c.length,g=s?t=>s(Ue(t[r.index])).target:r.index;if(Le(n)){let a=null;if(!s&&u&&(a=function(t,e,n,r){const i=t.cleanup;if(null!=i)for(let o=0;o<i.length-1;o+=2){const t=i[o];if(t===n&&i[o+1]===r){const t=e[7],n=i[o+2];return t.length>n?t[n]:null}"string"==typeof t&&(o+=2)}return null}(t,e,i,r.index)),null!==a)(a.__ngLastListenerFn__||a).__ngNextListenerFn__=o,a.__ngLastListenerFn__=o,h=!1;else{o=Ba(r,e,o,!1);const t=n.listen(f.name||p,i,o);c.push(o,t),l&&l.push(i,g,m,m+1)}}else o=Ba(r,e,o,!0),p.addEventListener(i,o,a),c.push(o),l&&l.push(i,g,m,a)}const d=r.outputs;let f;if(h&&null!==d&&(f=d[i])){const t=f.length;if(t)for(let n=0;n<t;n+=2){const t=e[f[n]][f[n+1]].subscribe(o),a=c.length;c.push(o,t),l&&l.push(i,r.index,a,-(a+1))}}}function La(t,e,n){try{return!1!==e(n)}catch(r){return po(t,r),!1}}function Ba(t,e,n,r){return function i(o){if(o===Function)return n;const a=2&t.flags?He(t.index,e):e;0==(32&e[2])&&ao(a);let s=La(e,n,o),u=i.__ngNextListenerFn__;for(;u;)s=La(e,u,o)&&s,u=u.__ngNextListenerFn__;return r&&!1===s&&(o.preventDefault(),o.returnValue=!1),s}}function Ua(t=1){return function(t){return(Je.lFrame.contextLView=function(t,e){for(;t>0;)e=e[15],t--;return e}(t,Je.lFrame.contextLView))[8]}(t)}function $a(t,e){let n=null;const r=function(t){const e=t.attrs;if(null!=e){const t=e.indexOf(5);if(0==(1&t))return e[t+1]}return null}(t);for(let i=0;i<e.length;i++){const o=e[i];if("*"!==o){if(null===r?ci(t,o,!0):hi(r,o))return i}else n=i}return n}function Va(t){const e=en()[16][6];if(!e.projection){const n=e.projection=oe(t?t.length:1,null),r=n.slice();let i=e.child;for(;null!==i;){const e=t?$a(i,t):0;null!==e&&(r[e]?r[e].projectionNext=i:n[e]=i,r[e]=i),i=i.next}}}function Wa(t,e=0,n){const r=en(),i=nn(),o=Ti(i,r[6],t,1,null,n||null);null===o.projection&&(o.projection=e),un(),function(t,e,n){Po(e[11],0,e,n,Eo(t,n,e),Do(n.parent||e[6],e))}(i,r,o)}function qa(t,e,n){return Ha(t,"",e,"",n),qa}function Ha(t,e,n,r,i){const o=en(),a=xa(o,e,n,r);return a!==pi&&Vi(nn(),Nn(),o,t,a,o[11],i,!1),Ha}const Ga=[];function Xa(t,e,n,r,i){const o=t[n+1],a=null===e;let s=r?_i(o):ki(o),u=!1;for(;0!==s&&(!1===u||a);){const n=t[s+1];Ka(t[s],e)&&(u=!0,t[s+1]=r?Ei(n):Ci(n)),s=r?_i(n):ki(n)}u&&(t[n+1]=r?Ci(o):Ei(o))}function Ka(t,e){return null===t||null==e||(Array.isArray(t)?t[1]:t)===e||!(!Array.isArray(t)||"string"!=typeof e)&&ue(t,e)>=0}function Ya(t,e){return function(t,e,n,r){const i=en(),o=nn(),a=pn(2);o.firstUpdatePass&&function(t,e,n,r){const i=t.data;if(null===i[n+1]){const r=i[On()+20],o=function(t,e){return e>=t.expandoStartIndex}(t,n);(function(t,e){return 0!=(16&t.flags)})(r)&&null===e&&!o&&(e=!1),e=function(t,e,n,r){const i=yn(t);let o=e.residualClasses;if(null===i)0===e.classBindings&&(n=Qa(n=Za(null,t,e,n,!0),e.attrs,!0),o=null);else{const r=e.directiveStylingLast;if(-1===r||t[r]!==i)if(n=Za(i,t,e,n,!0),null===o){let n=function(t,e,n){const r=e.classBindings;if(0!==ki(r))return t[_i(r)]}(t,e);void 0!==n&&Array.isArray(n)&&(n=Za(null,t,e,n[1],!0),n=Qa(n,e.attrs,!0),function(t,e,n,r){t[_i(e.classBindings)]=r}(t,e,0,n))}else o=function(t,e,n){let r=void 0;const i=e.directiveEnd;for(let o=1+e.directiveStylingLast;o<i;o++)r=Qa(r,t[o].hostAttrs,!0);return Qa(r,e.attrs,!0)}(t,e)}return void 0!==o&&(e.residualClasses=o),n}(i,r,e),function(t,e,n,r,i,o){let a=e.classBindings,s=_i(a),u=ki(a);t[r]=n;let l,c=!1;if(Array.isArray(n)){const t=n;l=t[1],(null===l||ue(t,l)>0)&&(c=!0)}else l=n;if(i)if(0!==u){const e=_i(t[s+1]);t[r+1]=xi(e,s),0!==e&&(t[e+1]=Si(t[e+1],r)),t[s+1]=131071&t[s+1]|r<<17}else t[r+1]=xi(s,0),0!==s&&(t[s+1]=Si(t[s+1],r)),s=r;else t[r+1]=xi(u,0),0===s?s=r:t[u+1]=Si(t[u+1],r),u=r;c&&(t[r+1]=Ci(t[r+1])),Xa(t,l,r,!0),Xa(t,l,r,!1),function(t,e,n,r,i){const o=t.residualClasses;null!=o&&"string"==typeof e&&ue(o,e)>=0&&(n[r+1]=Ei(n[r+1]))}(e,l,t,r),a=xi(s,u),e.classBindings=a}(i,r,e,n,o)}}(o,t,a),e!==pi&&ba(i,a,e)&&function(t,e,n,r,i,o,a,s){if(3!==e.type)return;const u=t.data,l=u[s+1];ts(1==(1&l)?Ja(u,e,n,i,ki(l),!0):void 0)||(ts(o)||function(t){return 2==(2&t)}(l)&&(o=Ja(u,null,n,i,s,!0)),function(t,e,n,r,i){const o=Le(t);i?o?t.addClass(n,r):n.classList.add(r):o?t.removeClass(n,r):n.classList.remove(r)}(r,0,$e(On(),n),i,o))}(o,o.data[On()+20],i,i[11],t,i[a+1]=function(t,e){return null==t||"object"==typeof t&&(t=xt(kr(t))),t}(e),0,a)}(t,e),Ya}function Za(t,e,n,r,i){let o=null;const a=n.directiveEnd;let s=n.directiveStylingLast;for(-1===s?s=n.directiveStart:s++;s<a&&(o=e[s],r=Qa(r,o.hostAttrs,i),o!==t);)s++;return null!==t&&(n.directiveStylingLast=s),r}function Qa(t,e,n){const r=n?1:2;let i=-1;if(null!==e)for(let o=0;o<e.length;o++){const a=e[o];"number"==typeof a?i=a:i===r&&(Array.isArray(t)||(t=void 0===t?[]:["",t]),ae(t,a,!!n||e[++o]))}return void 0===t?null:t}function Ja(t,e,n,r,i,o){const a=null===e;let s=void 0;for(;i>0;){const e=t[i],o=Array.isArray(e),u=o?e[1]:e,l=null===u;let c=n[i+1];c===pi&&(c=l?Ga:void 0);let h=l?se(c,r):u===r?c:void 0;if(o&&!ts(h)&&(h=se(e,r)),ts(h)&&(s=h,a))return s;const d=t[i+1];i=a?_i(d):ki(d)}if(null!==e){let t=o?e.residualClasses:e.residualStyles;null!=t&&(s=se(t,r))}return s}function ts(t){return void 0!==t}function es(t,e=""){const n=en(),r=nn(),i=t+20,o=r.firstCreatePass?Ti(r,n[6],t,3,null,null):r.data[i],a=n[i]=function(t,e){return Le(e)?e.createText(t):e.createTextNode(t)}(e,n[11]);Ro(r,n,a,o),an(o,!1)}function ns(t){return rs("",t,""),ns}function rs(t,e,n){const r=en(),i=xa(r,t,e,n);return i!==pi&&go(r,On(),i),rs}function is(t,e,n,r,i){const o=en(),a=function(t,e,n,r,i,o){const a=function(t,e,n,r){const i=ba(t,e,n);return ba(t,e+1,r)||i}(t,dn(),n,i);return pn(2),a?e+Hn(n)+r+Hn(i)+o:pi}(o,t,e,n,r,i);return a!==pi&&go(o,On(),a),is}function os(t,e,n){const r=en();return ba(r,fn(),e)&&Vi(nn(),Nn(),r,t,e,r[11],n,!0),os}function as(t,e,n){const r=en();if(ba(r,fn(),e)){const i=nn(),o=Nn();Vi(i,o,r,t,e,fo(yn(i.data),o,r),n,!0)}return as}function ss(t,e){const n=Ge(t)[1],r=n.data.length-1;Tn(n,{directiveStart:r,directiveEnd:r+1})}function us(t){let e=Object.getPrototypeOf(t.type.prototype).constructor,n=!0;const r=[t];for(;e;){let i=void 0;if(Te(t))i=e.\u0275cmp||e.\u0275dir;else{if(e.\u0275cmp)throw new Error("Directives cannot inherit Components");i=e.\u0275dir}if(i){if(n){r.push(i);const e=t;e.inputs=ls(t.inputs),e.declaredInputs=ls(t.declaredInputs),e.outputs=ls(t.outputs);const n=i.hostBindings;n&&ds(t,n);const o=i.viewQuery,a=i.contentQueries;if(o&&cs(t,o),a&&hs(t,a),ct(t.inputs,i.inputs),ct(t.declaredInputs,i.declaredInputs),ct(t.outputs,i.outputs),Te(i)&&i.data.animation){const e=t.data;e.animation=(e.animation||[]).concat(i.data.animation)}}const e=i.features;if(e)for(let r=0;r<e.length;r++){const i=e[r];i&&i.ngInherit&&i(t),i===us&&(n=!1)}}e=Object.getPrototypeOf(e)}!function(t){let e=0,n=null;for(let r=t.length-1;r>=0;r--){const i=t[r];i.hostVars=e+=i.hostVars,i.hostAttrs=Bn(i.hostAttrs,n=Bn(n,i.hostAttrs))}}(r)}function ls(t){return t===he?{}:t===de?[]:t}function cs(t,e){const n=t.viewQuery;t.viewQuery=n?(t,r)=>{e(t,r),n(t,r)}:e}function hs(t,e){const n=t.contentQueries;t.contentQueries=n?(t,r,i)=>{e(t,r,i),n(t,r,i)}:e}function ds(t,e){const n=t.hostBindings;t.hostBindings=n?(t,r)=>{e(t,r),n(t,r)}:e}function fs(t,e,n,r,i){if(t=St(t),Array.isArray(t))for(let o=0;o<t.length;o++)fs(t[o],e,n,r,i);else{const o=nn(),a=en();let s=ua(t)?t:St(t.provide),u=oa(t);const l=on(),c=1048575&l.providerIndexes,h=l.directiveStart,d=l.providerIndexes>>20;if(ua(t)||!t.multi){const r=new Pn(u,i,ka),f=gs(s,e,i?c:c+d,h);-1===f?(rr(Jn(l,a),o,s),ps(o,t,e.length),e.push(s),l.directiveStart++,l.directiveEnd++,i&&(l.providerIndexes+=1048576),n.push(r),a.push(r)):(n[f]=r,a[f]=r)}else{const f=gs(s,e,c+d,h),p=gs(s,e,c,c+d),m=f>=0&&n[f],g=p>=0&&n[p];if(i&&!g||!i&&!m){rr(Jn(l,a),o,s);const c=function(t,e,n,r,i){const o=new Pn(t,n,ka);return o.multi=[],o.index=e,o.componentProviders=0,ms(o,i,r&&!n),o}(i?vs:ys,n.length,i,r,u);!i&&g&&(n[p].providerFactory=c),ps(o,t,e.length,0),e.push(s),l.directiveStart++,l.directiveEnd++,i&&(l.providerIndexes+=1048576),n.push(c),a.push(c)}else ps(o,t,f>-1?f:p,ms(n[i?p:f],u,!i&&r));!i&&r&&g&&n[p].componentProviders++}}}function ps(t,e,n,r){const i=ua(e);if(i||e.useClass){const o=(e.useClass||e).prototype.ngOnDestroy;if(o){const a=t.destroyHooks||(t.destroyHooks=[]);if(!i&&e.multi){const t=a.indexOf(n);-1===t?a.push(n,[r,o]):a[t+1].push(r,o)}else a.push(n,o)}}}function ms(t,e,n){return n&&t.componentProviders++,t.multi.push(e)-1}function gs(t,e,n,r){for(let i=n;i<r;i++)if(e[i]===t)return i;return-1}function ys(t,e,n,r){return bs(this.multi,[])}function vs(t,e,n,r){const i=this.multi;let o;if(this.providerFactory){const t=this.providerFactory.componentProviders,e=ur(n,n[1],this.providerFactory.index,r);o=e.slice(0,t),bs(i,o);for(let n=t;n<e.length;n++)o.push(e[n])}else o=[],bs(i,o);return o}function bs(t,e){for(let n=0;n<t.length;n++)e.push((0,t[n])());return e}function ws(t,e=[]){return n=>{n.providersResolver=(n,r)=>function(t,e,n){const r=nn();if(r.firstCreatePass){const i=Te(t);fs(n,r.data,r.blueprint,i,!0),fs(e,r.data,r.blueprint,i,!1)}}(n,r?r(t):t,e)}}class xs{}class _s{resolveComponentFactory(t){throw function(t){const e=Error(`No component factory found for ${xt(t)}. Did you add it to @NgModule.entryComponents?`);return e.ngComponent=t,e}(t)}}let Cs=(()=>{class t{}return t.NULL=new _s,t})(),ks=(()=>{class t{constructor(t){this.nativeElement=t}}return t.__NG_ELEMENT_ID__=()=>Ss(t),t})();const Ss=function(t){return Wo(t,on(),en())};class Es{}var Os=function(t){return t[t.Important=1]="Important",t[t.DashCase=2]="DashCase",t}({});let As=(()=>{class t{}return t.__NG_ELEMENT_ID__=()=>Ns(),t})();const Ns=function(){const t=en(),e=He(on().index,t);return function(t){const e=t[11];if(Le(e))return e;throw new Error("Cannot inject Renderer2 when the application uses Renderer3!")}(Se(e)?e:t)};let Ts=(()=>{class t{}return t.\u0275prov=ht({token:t,providedIn:"root",factory:()=>null}),t})();class Ds{constructor(t){this.full=t,this.major=t.split(".")[0],this.minor=t.split(".")[1],this.patch=t.split(".").slice(2).join(".")}}const Rs=new Ds("10.0.8");class Is{constructor(){}supports(t){return ga(t)}create(t){return new Fs(t)}}const Ms=(t,e)=>e;class Fs{constructor(t){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=t||Ms}forEachItem(t){let e;for(e=this._itHead;null!==e;e=e._next)t(e)}forEachOperation(t){let e=this._itHead,n=this._removalsHead,r=0,i=null;for(;e||n;){const o=!n||e&&e.currentIndex<Ls(n,r,i)?e:n,a=Ls(o,r,i),s=o.currentIndex;if(o===n)r--,n=n._nextRemoved;else if(e=e._next,null==o.previousIndex)r++;else{i||(i=[]);const t=a-r,e=s-r;if(t!=e){for(let n=0;n<t;n++){const r=n<i.length?i[n]:i[n]=0,o=r+n;e<=o&&o<t&&(i[n]=r+1)}i[o.previousIndex]=e-t}}a!==s&&t(o,a,s)}}forEachPreviousItem(t){let e;for(e=this._previousItHead;null!==e;e=e._nextPrevious)t(e)}forEachAddedItem(t){let e;for(e=this._additionsHead;null!==e;e=e._nextAdded)t(e)}forEachMovedItem(t){let e;for(e=this._movesHead;null!==e;e=e._nextMoved)t(e)}forEachRemovedItem(t){let e;for(e=this._removalsHead;null!==e;e=e._nextRemoved)t(e)}forEachIdentityChange(t){let e;for(e=this._identityChangesHead;null!==e;e=e._nextIdentityChange)t(e)}diff(t){if(null==t&&(t=[]),!ga(t))throw new Error(`Error trying to diff '${xt(t)}'. Only arrays and iterables are allowed`);return this.check(t)?this:null}onDestroy(){}check(t){this._reset();let e,n,r,i=this._itHead,o=!1;if(Array.isArray(t)){this.length=t.length;for(let e=0;e<this.length;e++)n=t[e],r=this._trackByFn(e,n),null!==i&&Object.is(i.trackById,r)?(o&&(i=this._verifyReinsertion(i,n,r,e)),Object.is(i.item,n)||this._addIdentityChange(i,n)):(i=this._mismatch(i,n,r,e),o=!0),i=i._next}else e=0,function(t,e){if(Array.isArray(t))for(let n=0;n<t.length;n++)e(t[n]);else{const n=t[pa()]();let r;for(;!(r=n.next()).done;)e(r.value)}}(t,t=>{r=this._trackByFn(e,t),null!==i&&Object.is(i.trackById,r)?(o&&(i=this._verifyReinsertion(i,t,r,e)),Object.is(i.item,t)||this._addIdentityChange(i,t)):(i=this._mismatch(i,t,r,e),o=!0),i=i._next,e++}),this.length=e;return this._truncate(i),this.collection=t,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let t,e;for(t=this._previousItHead=this._itHead;null!==t;t=t._next)t._nextPrevious=t._next;for(t=this._additionsHead;null!==t;t=t._nextAdded)t.previousIndex=t.currentIndex;for(this._additionsHead=this._additionsTail=null,t=this._movesHead;null!==t;t=e)t.previousIndex=t.currentIndex,e=t._nextMoved;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(t,e,n,r){let i;return null===t?i=this._itTail:(i=t._prev,this._remove(t)),null!==(t=null===this._linkedRecords?null:this._linkedRecords.get(n,r))?(Object.is(t.item,e)||this._addIdentityChange(t,e),this._moveAfter(t,i,r)):null!==(t=null===this._unlinkedRecords?null:this._unlinkedRecords.get(n,null))?(Object.is(t.item,e)||this._addIdentityChange(t,e),this._reinsertAfter(t,i,r)):t=this._addAfter(new Ps(e,n),i,r),t}_verifyReinsertion(t,e,n,r){let i=null===this._unlinkedRecords?null:this._unlinkedRecords.get(n,null);return null!==i?t=this._reinsertAfter(i,t._prev,r):t.currentIndex!=r&&(t.currentIndex=r,this._addToMoves(t,r)),t}_truncate(t){for(;null!==t;){const e=t._next;this._addToRemovals(this._unlink(t)),t=e}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(t,e,n){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(t);const r=t._prevRemoved,i=t._nextRemoved;return null===r?this._removalsHead=i:r._nextRemoved=i,null===i?this._removalsTail=r:i._prevRemoved=r,this._insertAfter(t,e,n),this._addToMoves(t,n),t}_moveAfter(t,e,n){return this._unlink(t),this._insertAfter(t,e,n),this._addToMoves(t,n),t}_addAfter(t,e,n){return this._insertAfter(t,e,n),this._additionsTail=null===this._additionsTail?this._additionsHead=t:this._additionsTail._nextAdded=t,t}_insertAfter(t,e,n){const r=null===e?this._itHead:e._next;return t._next=r,t._prev=e,null===r?this._itTail=t:r._prev=t,null===e?this._itHead=t:e._next=t,null===this._linkedRecords&&(this._linkedRecords=new zs),this._linkedRecords.put(t),t.currentIndex=n,t}_remove(t){return this._addToRemovals(this._unlink(t))}_unlink(t){null!==this._linkedRecords&&this._linkedRecords.remove(t);const e=t._prev,n=t._next;return null===e?this._itHead=n:e._next=n,null===n?this._itTail=e:n._prev=e,t}_addToMoves(t,e){return t.previousIndex===e||(this._movesTail=null===this._movesTail?this._movesHead=t:this._movesTail._nextMoved=t),t}_addToRemovals(t){return null===this._unlinkedRecords&&(this._unlinkedRecords=new zs),this._unlinkedRecords.put(t),t.currentIndex=null,t._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=t,t._prevRemoved=null):(t._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=t),t}_addIdentityChange(t,e){return t.item=e,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=t:this._identityChangesTail._nextIdentityChange=t,t}}class Ps{constructor(t,e){this.item=t,this.trackById=e,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class js{constructor(){this._head=null,this._tail=null}add(t){null===this._head?(this._head=this._tail=t,t._nextDup=null,t._prevDup=null):(this._tail._nextDup=t,t._prevDup=this._tail,t._nextDup=null,this._tail=t)}get(t,e){let n;for(n=this._head;null!==n;n=n._nextDup)if((null===e||e<=n.currentIndex)&&Object.is(n.trackById,t))return n;return null}remove(t){const e=t._prevDup,n=t._nextDup;return null===e?this._head=n:e._nextDup=n,null===n?this._tail=e:n._prevDup=e,null===this._head}}class zs{constructor(){this.map=new Map}put(t){const e=t.trackById;let n=this.map.get(e);n||(n=new js,this.map.set(e,n)),n.add(t)}get(t,e){const n=this.map.get(t);return n?n.get(t,e):null}remove(t){const e=t.trackById;return this.map.get(e).remove(t)&&this.map.delete(e),t}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function Ls(t,e,n){const r=t.previousIndex;if(null===r)return r;let i=0;return n&&r<n.length&&(i=n[r]),r+e+i}class Bs{constructor(){}supports(t){return t instanceof Map||ya(t)}create(){return new Us}}class Us{constructor(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}get isDirty(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}forEachItem(t){let e;for(e=this._mapHead;null!==e;e=e._next)t(e)}forEachPreviousItem(t){let e;for(e=this._previousMapHead;null!==e;e=e._nextPrevious)t(e)}forEachChangedItem(t){let e;for(e=this._changesHead;null!==e;e=e._nextChanged)t(e)}forEachAddedItem(t){let e;for(e=this._additionsHead;null!==e;e=e._nextAdded)t(e)}forEachRemovedItem(t){let e;for(e=this._removalsHead;null!==e;e=e._nextRemoved)t(e)}diff(t){if(t){if(!(t instanceof Map||ya(t)))throw new Error(`Error trying to diff '${xt(t)}'. Only maps and objects are allowed`)}else t=new Map;return this.check(t)?this:null}onDestroy(){}check(t){this._reset();let e=this._mapHead;if(this._appendAfter=null,this._forEach(t,(t,n)=>{if(e&&e.key===n)this._maybeAddToChanges(e,t),this._appendAfter=e,e=e._next;else{const r=this._getOrCreateRecordForKey(n,t);e=this._insertBeforeOrAppend(e,r)}}),e){e._prev&&(e._prev._next=null),this._removalsHead=e;for(let t=e;null!==t;t=t._nextRemoved)t===this._mapHead&&(this._mapHead=null),this._records.delete(t.key),t._nextRemoved=t._next,t.previousValue=t.currentValue,t.currentValue=null,t._prev=null,t._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(t,e){if(t){const n=t._prev;return e._next=t,e._prev=n,t._prev=e,n&&(n._next=e),t===this._mapHead&&(this._mapHead=e),this._appendAfter=t,t}return this._appendAfter?(this._appendAfter._next=e,e._prev=this._appendAfter):this._mapHead=e,this._appendAfter=e,null}_getOrCreateRecordForKey(t,e){if(this._records.has(t)){const n=this._records.get(t);this._maybeAddToChanges(n,e);const r=n._prev,i=n._next;return r&&(r._next=i),i&&(i._prev=r),n._next=null,n._prev=null,n}const n=new $s(t);return this._records.set(t,n),n.currentValue=e,this._addToAdditions(n),n}_reset(){if(this.isDirty){let t;for(this._previousMapHead=this._mapHead,t=this._previousMapHead;null!==t;t=t._next)t._nextPrevious=t._next;for(t=this._changesHead;null!==t;t=t._nextChanged)t.previousValue=t.currentValue;for(t=this._additionsHead;null!=t;t=t._nextAdded)t.previousValue=t.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(t,e){Object.is(e,t.currentValue)||(t.previousValue=t.currentValue,t.currentValue=e,this._addToChanges(t))}_addToAdditions(t){null===this._additionsHead?this._additionsHead=this._additionsTail=t:(this._additionsTail._nextAdded=t,this._additionsTail=t)}_addToChanges(t){null===this._changesHead?this._changesHead=this._changesTail=t:(this._changesTail._nextChanged=t,this._changesTail=t)}_forEach(t,e){t instanceof Map?t.forEach(e):Object.keys(t).forEach(n=>e(t[n],n))}}class $s{constructor(t){this.key=t,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null}}let Vs=(()=>{class t{constructor(t){this.factories=t}static create(e,n){if(null!=n){const t=n.factories.slice();e=e.concat(t)}return new t(e)}static extend(e){return{provide:t,useFactory:n=>{if(!n)throw new Error("Cannot extend IterableDiffers without a parent injector");return t.create(e,n)},deps:[[t,new st,new ot]]}}find(t){const e=this.factories.find(e=>e.supports(t));if(null!=e)return e;throw new Error(`Cannot find a differ supporting object '${t}' of type '${n=t,n.name||typeof n}'`);var n}}return t.\u0275prov=ht({token:t,providedIn:"root",factory:()=>new t([new Is])}),t})(),Ws=(()=>{class t{constructor(t){this.factories=t}static create(e,n){if(n){const t=n.factories.slice();e=e.concat(t)}return new t(e)}static extend(e){return{provide:t,useFactory:n=>{if(!n)throw new Error("Cannot extend KeyValueDiffers without a parent injector");return t.create(e,n)},deps:[[t,new st,new ot]]}}find(t){const e=this.factories.find(e=>e.supports(t));if(e)return e;throw new Error(`Cannot find a differ supporting object '${t}'`)}}return t.\u0275prov=ht({token:t,providedIn:"root",factory:()=>new t([new Bs])}),t})();const qs=[new Bs],Hs=new Vs([new Is]),Gs=new Ws(qs);let Xs=(()=>{class t{}return t.__NG_ELEMENT_ID__=()=>Ks(t,ks),t})();const Ks=function(t,e){return qo(t,e,on(),en())};let Ys=(()=>{class t{}return t.__NG_ELEMENT_ID__=()=>Zs(t,ks),t})();const Zs=function(t,e){return Ho(t,e,on(),en())},Qs={};class Js extends Cs{constructor(t){super(),this.ngModule=t}resolveComponentFactory(t){const e=_e(t);return new nu(e,this.ngModule)}}function tu(t){const e=[];for(let n in t)t.hasOwnProperty(n)&&e.push({propName:t[n],templateName:n});return e}const eu=new Lt("SCHEDULER_TOKEN",{providedIn:"root",factory:()=>Xn});class nu extends xs{constructor(t,e){super(),this.componentDef=t,this.ngModule=e,this.componentType=t.type,this.selector=t.selectors.map(fi).join(","),this.ngContentSelectors=t.ngContentSelectors?t.ngContentSelectors:[],this.isBoundToModule=!!e}get inputs(){return tu(this.componentDef.inputs)}get outputs(){return tu(this.componentDef.outputs)}create(t,e,n,r){const i=(r=r||this.ngModule)?function(t,e){return{get:(n,r,i)=>{const o=t.get(n,Qs,i);return o!==Qs||r===Qs?o:e.get(n,r,i)}}}(t,r.injector):t,o=i.get(Es,Be),a=i.get(Ts,null),s=o.createRenderer(null,this.componentDef),u=this.componentDef.selectors[0][0]||"div",l=n?function(t,e,n){if(Le(t))return t.selectRootElement(e,n===ce.ShadowDom);let r="string"==typeof e?t.querySelector(e):e;return r.textContent="",r}(s,n,this.componentDef.encapsulation):Ai(u,o.createRenderer(null,this.componentDef),function(t){const e=t.toLowerCase();return"svg"===e?"http://www.w3.org/2000/svg":"math"===e?"http://www.w3.org/1998/MathML/":null}(u)),c=this.componentDef.onPush?576:528,h={components:[],scheduler:Xn,clean:co,playerHandler:null,flags:0},d=Li(0,-1,null,1,0,null,null,null,null,null),f=Ni(null,d,h,c,null,null,o,s,a,i);let p,m;xn(f,null);try{const t=function(t,e,n,r,i,o){const a=n[1];n[20]=t;const s=Ti(a,null,0,3,null,null),u=s.mergedAttrs=e.hostAttrs;null!==u&&(da(s,u,!0),null!==t&&(jn(i,t,u),null!==s.classes&&zo(i,t,s.classes),null!==s.styles&&jo(i,t,s.styles)));const l=r.createRenderer(t,e),c=Ni(n,zi(e),null,e.onPush?64:16,n[20],s,r,l,void 0);return a.firstCreatePass&&(rr(Jn(s,n),a,e.type),Ki(a,s),Zi(s,n.length,1)),oo(n,c),n[20]=c}(l,this.componentDef,f,o,s);if(l)if(n)jn(s,l,["ng-version",Rs.full]);else{const{attrs:t,classes:e}=function(t){const e=[],n=[];let r=1,i=2;for(;r<t.length;){let o=t[r];if("string"==typeof o)2===i?""!==o&&e.push(o,t[++r]):8===i&&n.push(o);else{if(!ui(i))break;i=o}r++}return{attrs:e,classes:n}}(this.componentDef.selectors[0]);t&&jn(s,l,t),e&&e.length>0&&zo(s,l,e.join(" "))}if(m=We(d,0),void 0!==e){const t=m.projection=[];for(let n=0;n<this.ngContentSelectors.length;n++){const r=e[n];t.push(null!=r?Array.from(r):null)}}p=function(t,e,n,r,i){const o=n[1],a=function(t,e,n){const r=on();t.firstCreatePass&&(n.providersResolver&&n.providersResolver(n),Xi(t,r,1),Qi(t,e,n));const i=ur(e,t,e.length-1,r);ti(i,e);const o=Ve(r,e);return o&&ti(o,e),i}(o,n,e);r.components.push(a),t[8]=a,i&&i.forEach(t=>t(a,e)),e.contentQueries&&e.contentQueries(1,a,n.length-1);const s=on();if(o.firstCreatePass&&(null!==e.hostBindings||null!==e.hostAttrs)){An(s.index-20);const t=n[1];qi(t,e),Hi(t,n,e.hostVars),Gi(e,a)}return a}(t,this.componentDef,f,h,[ss]),Di(d,f,null)}finally{En()}const g=new ru(this.componentType,p,Wo(ks,m,f),f,m);return d.node.child=m,g}}class ru extends class{}{constructor(t,e,n,r,i){super(),this.location=n,this._rootLView=r,this._tNode=i,this.destroyCbs=[],this.instance=e,this.hostView=this.changeDetectorRef=new Bo(r),function(t,e,n,r){let i=t.node;null==i&&(t.node=i=Ui(0,null,2,-1,null,null)),r[6]=i}(r[1],0,0,r),this.componentType=t}get injector(){return new hr(this._tNode,this._rootLView)}destroy(){this.destroyCbs&&(this.destroyCbs.forEach(t=>t()),this.destroyCbs=null,!this.hostView.destroyed&&this.hostView.destroy())}onDestroy(t){this.destroyCbs&&this.destroyCbs.push(t)}}const iu=void 0;var ou=["en",[["a","p"],["AM","PM"],iu],[["AM","PM"],iu,iu],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],iu,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],iu,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",iu,"{1} 'at' {0}",iu],[".",",",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0%","\xa4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",function(t){let e=Math.floor(Math.abs(t)),n=t.toString().replace(/^[^.]*\.?/,"").length;return 1===e&&0===n?1:5}];let au={};function su(t){const e=function(t){return t.toLowerCase().replace(/_/g,"-")}(t);let n=uu(e);if(n)return n;const r=e.split("-")[0];if(n=uu(r),n)return n;if("en"===r)return ou;throw new Error(`Missing locale data for the locale "${t}".`)}function uu(t){return t in au||(au[t]=Dt.ng&&Dt.ng.common&&Dt.ng.common.locales&&Dt.ng.common.locales[t]),au[t]}var lu=function(t){return t[t.LocaleId=0]="LocaleId",t[t.DayPeriodsFormat=1]="DayPeriodsFormat",t[t.DayPeriodsStandalone=2]="DayPeriodsStandalone",t[t.DaysFormat=3]="DaysFormat",t[t.DaysStandalone=4]="DaysStandalone",t[t.MonthsFormat=5]="MonthsFormat",t[t.MonthsStandalone=6]="MonthsStandalone",t[t.Eras=7]="Eras",t[t.FirstDayOfWeek=8]="FirstDayOfWeek",t[t.WeekendRange=9]="WeekendRange",t[t.DateFormat=10]="DateFormat",t[t.TimeFormat=11]="TimeFormat",t[t.DateTimeFormat=12]="DateTimeFormat",t[t.NumberSymbols=13]="NumberSymbols",t[t.NumberFormats=14]="NumberFormats",t[t.CurrencyCode=15]="CurrencyCode",t[t.CurrencySymbol=16]="CurrencySymbol",t[t.CurrencyName=17]="CurrencyName",t[t.Currencies=18]="Currencies",t[t.Directionality=19]="Directionality",t[t.PluralCase=20]="PluralCase",t[t.ExtraData=21]="ExtraData",t}({});let cu="en-US";function hu(t){var e,n;n="Expected localeId to be defined",null==(e=t)&&function(t,e,n,r){throw new Error("ASSERTION ERROR: "+t+` [Expected=> null != ${e} <=Actual]`)}(n,e),"string"==typeof t&&(cu=t.toLowerCase().replace(/_/g,"-"))}const du=new Map;class fu extends te{constructor(t,e){super(),this._parent=e,this._bootstrapComponents=[],this.injector=this,this.destroyCbs=[],this.componentFactoryResolver=new Js(this);const n=ke(t),r=t[Pt]||null;r&&hu(r),this._bootstrapComponents=Kn(n.bootstrap),this._r3Injector=na(t,e,[{provide:te,useValue:this},{provide:Cs,useValue:this.componentFactoryResolver}],xt(t)),this._r3Injector._resolveInjectorDefTypes(),this.instance=this.get(t)}get(t,e=ca.THROW_IF_NOT_FOUND,n=ut.Default){return t===ca||t===te||t===Bt?this:this._r3Injector.get(t,e,n)}destroy(){const t=this._r3Injector;!t.destroyed&&t.destroy(),this.destroyCbs.forEach(t=>t()),this.destroyCbs=null}onDestroy(t){this.destroyCbs.push(t)}}class pu extends ee{constructor(t){super(),this.moduleType=t,null!==ke(t)&&function t(e){if(null!==e.\u0275mod.id){const t=e.\u0275mod.id;(function(t,e,n){if(e&&e!==n)throw new Error(`Duplicate module registered for ${t} - ${xt(e)} vs ${xt(e.name)}`)})(t,du.get(t),e),du.set(t,e)}let n=e.\u0275mod.imports;n instanceof Function&&(n=n()),n&&n.forEach(e=>t(e))}(t)}create(t){return new fu(this.moduleType,t)}}function mu(t,e,n){const r=hn()+t,i=en();return i[r]===pi?va(i,r,n?e.call(n):e()):function(t,e){return t[e]}(i,r)}function gu(t,e){const n=nn();let r;const i=t+20;n.firstCreatePass?(r=function(t,e){if(e)for(let n=e.length-1;n>=0;n--){const r=e[n];if(t===r.name)return r}throw new Error(`The pipe '${t}' could not be found!`)}(e,n.pipeRegistry),n.data[i]=r,r.onDestroy&&(n.destroyHooks||(n.destroyHooks=[])).push(i,r.onDestroy)):r=n.data[i];const o=r.factory||(r.factory=Ce(r.type)),a=Gt(ka),s=Zn(!1),u=o();return Zn(s),Gt(a),function(t,e,n,r){const i=n+20;i>=t.data.length&&(t.data[i]=null,t.blueprint[i]=null),e[i]=r}(n,en(),t,u),u}function yu(t,e,n){const r=en(),i=qe(r,t);return function(t,e){return ma.isWrapped(e)&&(e=ma.unwrap(e),t[dn()]=pi),e}(r,function(t,e){return t[1].data[e+20].pure}(r,t)?function(t,e,n,r,i,o){const a=e+n;return ba(t,a,i)?va(t,a+1,o?r.call(o,i):r(i)):function(t,e){const n=t[e];return n===pi?void 0:n}(t,a+1)}(r,hn(),e,i.transform,n,i):i.transform(n))}const vu=class extends C{constructor(t=!1){super(),this.__isAsync=t}emit(t){super.next(t)}subscribe(t,e,n){let r,i=t=>null,o=()=>null;t&&"object"==typeof t?(r=this.__isAsync?e=>{setTimeout(()=>t.next(e))}:e=>{t.next(e)},t.error&&(i=this.__isAsync?e=>{setTimeout(()=>t.error(e))}:e=>{t.error(e)}),t.complete&&(o=this.__isAsync?()=>{setTimeout(()=>t.complete())}:()=>{t.complete()})):(r=this.__isAsync?e=>{setTimeout(()=>t(e))}:e=>{t(e)},e&&(i=this.__isAsync?t=>{setTimeout(()=>e(t))}:t=>{e(t)}),n&&(o=this.__isAsync?()=>{setTimeout(()=>n())}:()=>{n()}));const a=super.subscribe(r,i,o);return t instanceof h&&t.add(a),a}};function bu(){return this._results[pa()]()}class wu{constructor(){this.dirty=!0,this._results=[],this.changes=new vu,this.length=0;const t=pa(),e=wu.prototype;e[t]||(e[t]=bu)}map(t){return this._results.map(t)}filter(t){return this._results.filter(t)}find(t){return this._results.find(t)}reduce(t,e){return this._results.reduce(t,e)}forEach(t){this._results.forEach(t)}some(t){return this._results.some(t)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(t){this._results=function t(e,n){void 0===n&&(n=e);for(let r=0;r<e.length;r++){let i=e[r];Array.isArray(i)?(n===e&&(n=e.slice(0,r)),t(i,n)):n!==e&&n.push(i)}return n}(t),this.dirty=!1,this.length=this._results.length,this.last=this._results[this.length-1],this.first=this._results[0]}notifyOnChanges(){this.changes.emit(this)}setDirty(){this.dirty=!0}destroy(){this.changes.complete(),this.changes.unsubscribe()}}class xu{constructor(t){this.queryList=t,this.matches=null}clone(){return new xu(this.queryList)}setDirty(){this.queryList.setDirty()}}class _u{constructor(t=[]){this.queries=t}createEmbeddedView(t){const e=t.queries;if(null!==e){const n=null!==t.contentQueries?t.contentQueries[0]:e.length,r=[];for(let t=0;t<n;t++){const n=e.getByIndex(t);r.push(this.queries[n.indexInDeclarationView].clone())}return new _u(r)}return null}insertView(t){this.dirtyQueriesWithMatches(t)}detachView(t){this.dirtyQueriesWithMatches(t)}dirtyQueriesWithMatches(t){for(let e=0;e<this.queries.length;e++)null!==Lu(t,e).matches&&this.queries[e].setDirty()}}class Cu{constructor(t,e,n,r=null){this.predicate=t,this.descendants=e,this.isStatic=n,this.read=r}}class ku{constructor(t=[]){this.queries=t}elementStart(t,e){for(let n=0;n<this.queries.length;n++)this.queries[n].elementStart(t,e)}elementEnd(t){for(let e=0;e<this.queries.length;e++)this.queries[e].elementEnd(t)}embeddedTView(t){let e=null;for(let n=0;n<this.length;n++){const r=null!==e?e.length:0,i=this.getByIndex(n).embeddedTView(t,r);i&&(i.indexInDeclarationView=n,null!==e?e.push(i):e=[i])}return null!==e?new ku(e):null}template(t,e){for(let n=0;n<this.queries.length;n++)this.queries[n].template(t,e)}getByIndex(t){return this.queries[t]}get length(){return this.queries.length}track(t){this.queries.push(t)}}class Su{constructor(t,e=-1){this.metadata=t,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=e}elementStart(t,e){this.isApplyingToNode(e)&&this.matchTNode(t,e)}elementEnd(t){this._declarationNodeIndex===t.index&&(this._appliesToNextNode=!1)}template(t,e){this.elementStart(t,e)}embeddedTView(t,e){return this.isApplyingToNode(t)?(this.crossesNgTemplate=!0,this.addMatch(-t.index,e),new Su(this.metadata)):null}isApplyingToNode(t){if(this._appliesToNextNode&&!1===this.metadata.descendants){const e=this._declarationNodeIndex;let n=t.parent;for(;null!==n&&4===n.type&&n.index!==e;)n=n.parent;return e===(null!==n?n.index:-1)}return this._appliesToNextNode}matchTNode(t,e){if(Array.isArray(this.metadata.predicate)){const n=this.metadata.predicate;for(let r=0;r<n.length;r++)this.matchTNodeWithReadOption(t,e,Eu(e,n[r]))}else{const n=this.metadata.predicate;n===Xs?0===e.type&&this.matchTNodeWithReadOption(t,e,-1):this.matchTNodeWithReadOption(t,e,sr(e,t,n,!1,!1))}}matchTNodeWithReadOption(t,e,n){if(null!==n){const r=this.metadata.read;if(null!==r)if(r===ks||r===Ys||r===Xs&&0===e.type)this.addMatch(e.index,-2);else{const n=sr(e,t,r,!1,!1);null!==n&&this.addMatch(e.index,n)}else this.addMatch(e.index,n)}}addMatch(t,e){null===this.matches?this.matches=[t,e]:this.matches.push(t,e)}}function Eu(t,e){const n=t.localNames;if(null!==n)for(let r=0;r<n.length;r+=2)if(n[r]===e)return n[r+1];return null}function Ou(t,e,n,r){return-1===n?function(t,e){return 3===t.type||4===t.type?Wo(ks,t,e):0===t.type?qo(Xs,ks,t,e):null}(e,t):-2===n?function(t,e,n){return n===ks?Wo(ks,e,t):n===Xs?qo(Xs,ks,e,t):n===Ys?Ho(Ys,ks,e,t):void 0}(t,e,r):ur(t,t[1],n,e)}function Au(t,e,n,r){const i=e[19].queries[r];if(null===i.matches){const r=t.data,o=n.matches,a=[];for(let t=0;t<o.length;t+=2){const i=o[t];a.push(i<0?null:Ou(e,r[i],o[t+1],n.metadata.read))}i.matches=a}return i.matches}function Nu(t){const e=en(),n=nn(),r=vn();bn(r+1);const i=Lu(n,r);if(t.dirty&&Xe(e)===i.metadata.isStatic){if(null===i.matches)t.reset([]);else{const o=i.crossesNgTemplate?function t(e,n,r,i){const o=e.queries.getByIndex(r),a=o.matches;if(null!==a){const s=Au(e,n,o,r);for(let e=0;e<a.length;e+=2){const r=a[e];if(r>0)i.push(s[e/2]);else{const o=a[e+1],s=n[-r];for(let e=10;e<s.length;e++){const n=s[e];n[17]===n[3]&&t(n[1],n,o,i)}if(null!==s[9]){const e=s[9];for(let n=0;n<e.length;n++){const r=e[n];t(r[1],r,o,i)}}}}}return i}(n,e,r,[]):Au(n,e,i,r);t.reset(o),t.notifyOnChanges()}return!0}return!1}function Tu(t,e,n){Ru(nn(),en(),t,e,n,!0)}function Du(t,e,n){Ru(nn(),en(),t,e,n,!1)}function Ru(t,e,n,r,i,o){t.firstCreatePass&&(zu(t,new Cu(n,r,o,i),-1),o&&(t.staticViewQueries=!0)),ju(t,e)}function Iu(t,e,n,r){Fu(nn(),en(),e,n,r,!1,on(),t)}function Mu(t,e,n,r){Fu(nn(),en(),e,n,r,!0,on(),t)}function Fu(t,e,n,r,i,o,a,s){t.firstCreatePass&&(zu(t,new Cu(n,r,o,i),a.index),function(t,e){const n=t.contentQueries||(t.contentQueries=[]);e!==(t.contentQueries.length?n[n.length-1]:-1)&&n.push(t.queries.length-1,e)}(t,s),o&&(t.staticContentQueries=!0)),ju(t,e)}function Pu(){return t=en(),e=vn(),t[19].queries[e].queryList;var t,e}function ju(t,e){const n=new wu;Bi(t,e,n,n.destroy),null===e[19]&&(e[19]=new _u),e[19].queries.push(new xu(n))}function zu(t,e,n){null===t.queries&&(t.queries=new ku),t.queries.track(new Su(e,n))}function Lu(t,e){return t.queries.getByIndex(e)}const Bu=new Lt("Application Initializer");let Uu=(()=>{class t{constructor(t){this.appInits=t,this.initialized=!1,this.done=!1,this.donePromise=new Promise((t,e)=>{this.resolve=t,this.reject=e})}runInitializers(){if(this.initialized)return;const t=[],e=()=>{this.done=!0,this.resolve()};if(this.appInits)for(let n=0;n<this.appInits.length;n++){const e=this.appInits[n]();Ma(e)&&t.push(e)}Promise.all(t).then(()=>{e()}).catch(t=>{this.reject(t)}),0===t.length&&e(),this.initialized=!0}}return t.\u0275fac=function(e){return new(e||t)(Kt(Bu,8))},t.\u0275prov=ht({token:t,factory:t.\u0275fac}),t})();const $u=new Lt("AppId"),Vu={provide:$u,useFactory:function(){return`${Wu()}${Wu()}${Wu()}`},deps:[]};function Wu(){return String.fromCharCode(97+Math.floor(25*Math.random()))}const qu=new Lt("Platform Initializer"),Hu=new Lt("Platform ID"),Gu=new Lt("appBootstrapListener");let Xu=(()=>{class t{log(t){console.log(t)}warn(t){console.warn(t)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=ht({token:t,factory:t.\u0275fac}),t})();const Ku=new Lt("LocaleId"),Yu=new Lt("DefaultCurrencyCode");class Zu{constructor(t,e){this.ngModuleFactory=t,this.componentFactories=e}}const Qu=function(t){return new pu(t)},Ju=Qu,tl=function(t){return Promise.resolve(Qu(t))},el=function(t){const e=Qu(t),n=Kn(ke(t).declarations).reduce((t,e)=>{const n=_e(e);return n&&t.push(new nu(n)),t},[]);return new Zu(e,n)},nl=el,rl=function(t){return Promise.resolve(el(t))};let il=(()=>{class t{constructor(){this.compileModuleSync=Ju,this.compileModuleAsync=tl,this.compileModuleAndAllComponentsSync=nl,this.compileModuleAndAllComponentsAsync=rl}clearCache(){}clearCacheFor(t){}getModuleId(t){}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=ht({token:t,factory:t.\u0275fac}),t})();const ol=(()=>Promise.resolve(0))();function al(t){"undefined"==typeof Zone?ol.then(()=>{t&&t.apply(null,null)}):Zone.current.scheduleMicroTask("scheduleMicrotask",t)}class sl{constructor({enableLongStackTrace:t=!1,shouldCoalesceEventChangeDetection:e=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new vu(!1),this.onMicrotaskEmpty=new vu(!1),this.onStable=new vu(!1),this.onError=new vu(!1),"undefined"==typeof Zone)throw new Error("In this configuration Angular requires Zone.js");Zone.assertZonePatched(),this._nesting=0,this._outer=this._inner=Zone.current,Zone.wtfZoneSpec&&(this._inner=this._inner.fork(Zone.wtfZoneSpec)),Zone.TaskTrackingZoneSpec&&(this._inner=this._inner.fork(new Zone.TaskTrackingZoneSpec)),t&&Zone.longStackTraceZoneSpec&&(this._inner=this._inner.fork(Zone.longStackTraceZoneSpec)),this.shouldCoalesceEventChangeDetection=e,this.lastRequestAnimationFrameId=-1,this.nativeRequestAnimationFrame=function(){let t=Dt.requestAnimationFrame,e=Dt.cancelAnimationFrame;if("undefined"!=typeof Zone&&t&&e){const n=t[Zone.__symbol__("OriginalDelegate")];n&&(t=n);const r=e[Zone.__symbol__("OriginalDelegate")];r&&(e=r)}return{nativeRequestAnimationFrame:t,nativeCancelAnimationFrame:e}}().nativeRequestAnimationFrame,function(t){const e=!!t.shouldCoalesceEventChangeDetection&&t.nativeRequestAnimationFrame&&(()=>{!function(t){-1===t.lastRequestAnimationFrameId&&(t.lastRequestAnimationFrameId=t.nativeRequestAnimationFrame.call(Dt,()=>{t.fakeTopEventTask||(t.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{t.lastRequestAnimationFrameId=-1,hl(t),cl(t)},void 0,()=>{},()=>{})),t.fakeTopEventTask.invoke()}),hl(t))}(t)});t._inner=t._inner.fork({name:"angular",properties:{isAngularZone:!0,maybeDelayChangeDetection:e},onInvokeTask:(n,r,i,o,a,s)=>{try{return dl(t),n.invokeTask(i,o,a,s)}finally{e&&"eventTask"===o.type&&e(),fl(t)}},onInvoke:(e,n,r,i,o,a,s)=>{try{return dl(t),e.invoke(r,i,o,a,s)}finally{fl(t)}},onHasTask:(e,n,r,i)=>{e.hasTask(r,i),n===r&&("microTask"==i.change?(t._hasPendingMicrotasks=i.microTask,hl(t),cl(t)):"macroTask"==i.change&&(t.hasPendingMacrotasks=i.macroTask))},onHandleError:(e,n,r,i)=>(e.handleError(r,i),t.runOutsideAngular(()=>t.onError.emit(i)),!1)})}(this)}static isInAngularZone(){return!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!sl.isInAngularZone())throw new Error("Expected to be in Angular Zone, but it is not!")}static assertNotInAngularZone(){if(sl.isInAngularZone())throw new Error("Expected to not be in Angular Zone, but it is!")}run(t,e,n){return this._inner.run(t,e,n)}runTask(t,e,n,r){const i=this._inner,o=i.scheduleEventTask("NgZoneEvent: "+r,t,ll,ul,ul);try{return i.runTask(o,e,n)}finally{i.cancelTask(o)}}runGuarded(t,e,n){return this._inner.runGuarded(t,e,n)}runOutsideAngular(t){return this._outer.run(t)}}function ul(){}const ll={};function cl(t){if(0==t._nesting&&!t.hasPendingMicrotasks&&!t.isStable)try{t._nesting++,t.onMicrotaskEmpty.emit(null)}finally{if(t._nesting--,!t.hasPendingMicrotasks)try{t.runOutsideAngular(()=>t.onStable.emit(null))}finally{t.isStable=!0}}}function hl(t){t.hasPendingMicrotasks=!!(t._hasPendingMicrotasks||t.shouldCoalesceEventChangeDetection&&-1!==t.lastRequestAnimationFrameId)}function dl(t){t._nesting++,t.isStable&&(t.isStable=!1,t.onUnstable.emit(null))}function fl(t){t._nesting--,cl(t)}class pl{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new vu,this.onMicrotaskEmpty=new vu,this.onStable=new vu,this.onError=new vu}run(t,e,n){return t.apply(e,n)}runGuarded(t,e,n){return t.apply(e,n)}runOutsideAngular(t){return t()}runTask(t,e,n,r){return t.apply(e,n)}}let ml=(()=>{class t{constructor(t){this._ngZone=t,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,this._watchAngularEvents(),t.run(()=>{this.taskTrackingZone="undefined"==typeof Zone?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{sl.assertNotInAngularZone(),al(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())al(()=>{for(;0!==this._callbacks.length;){let t=this._callbacks.pop();clearTimeout(t.timeoutId),t.doneCb(this._didWork)}this._didWork=!1});else{let t=this.getPendingTasks();this._callbacks=this._callbacks.filter(e=>!e.updateCb||!e.updateCb(t)||(clearTimeout(e.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(t=>({source:t.source,creationLocation:t.creationLocation,data:t.data})):[]}addCallback(t,e,n){let r=-1;e&&e>0&&(r=setTimeout(()=>{this._callbacks=this._callbacks.filter(t=>t.timeoutId!==r),t(this._didWork,this.getPendingTasks())},e)),this._callbacks.push({doneCb:t,timeoutId:r,updateCb:n})}whenStable(t,e,n){if(n&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/dist/task-tracking.js" loaded?');this.addCallback(t,e,n),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}findProviders(t,e,n){return[]}}return t.\u0275fac=function(e){return new(e||t)(Kt(sl))},t.\u0275prov=ht({token:t,factory:t.\u0275fac}),t})(),gl=(()=>{class t{constructor(){this._applications=new Map,bl.addToWindow(this)}registerApplication(t,e){this._applications.set(t,e)}unregisterApplication(t){this._applications.delete(t)}unregisterAllApplications(){this._applications.clear()}getTestability(t){return this._applications.get(t)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(t,e=!0){return bl.findTestabilityInTree(this,t,e)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=ht({token:t,factory:t.\u0275fac}),t})();class yl{addToWindow(t){}findTestabilityInTree(t,e,n){return null}}let vl,bl=new yl;const wl=new Lt("AllowMultipleToken");class xl{constructor(t,e){this.name=t,this.token=e}}function _l(t,e,n=[]){const r="Platform: "+e,i=new Lt(r);return(e=[])=>{let o=Cl();if(!o||o.injector.get(wl,!1))if(t)t(n.concat(e).concat({provide:i,useValue:!0}));else{const t=n.concat(e).concat({provide:i,useValue:!0},{provide:Yo,useValue:"platform"});!function(t){if(vl&&!vl.destroyed&&!vl.injector.get(wl,!1))throw new Error("There can be only one platform. Destroy the previous one to create a new one.");vl=t.get(kl);const e=t.get(qu,null);e&&e.forEach(t=>t())}(ca.create({providers:t,name:r}))}return function(t){const e=Cl();if(!e)throw new Error("No platform exists!");if(!e.injector.get(t,null))throw new Error("A platform with a different configuration has been created. Please destroy it first.");return e}(i)}}function Cl(){return vl&&!vl.destroyed?vl:null}let kl=(()=>{class t{constructor(t){this._injector=t,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(t,e){const n=function(t,e){let n;return n="noop"===t?new pl:("zone.js"===t?void 0:t)||new sl({enableLongStackTrace:Nr(),shouldCoalesceEventChangeDetection:e}),n}(e?e.ngZone:void 0,e&&e.ngZoneEventCoalescing||!1),r=[{provide:sl,useValue:n}];return n.run(()=>{const e=ca.create({providers:r,parent:this.injector,name:t.moduleType.name}),i=t.create(e),o=i.injector.get(yr,null);if(!o)throw new Error("No ErrorHandler. Is platform module (BrowserModule) included?");return i.onDestroy(()=>Ol(this._modules,i)),n.runOutsideAngular(()=>n.onError.subscribe({next:t=>{o.handleError(t)}})),function(t,e,n){try{const r=n();return Ma(r)?r.catch(n=>{throw e.runOutsideAngular(()=>t.handleError(n)),n}):r}catch(r){throw e.runOutsideAngular(()=>t.handleError(r)),r}}(o,n,()=>{const t=i.injector.get(Uu);return t.runInitializers(),t.donePromise.then(()=>(hu(i.injector.get(Ku,"en-US")||"en-US"),this._moduleDoBootstrap(i),i))})})}bootstrapModule(t,e=[]){const n=Sl({},e);return function(t,e,n){const r=new pu(n);return Promise.resolve(r)}(0,0,t).then(t=>this.bootstrapModuleFactory(t,n))}_moduleDoBootstrap(t){const e=t.injector.get(El);if(t._bootstrapComponents.length>0)t._bootstrapComponents.forEach(t=>e.bootstrap(t));else{if(!t.instance.ngDoBootstrap)throw new Error(`The module ${xt(t.instance.constructor)} was bootstrapped, but it does not declare "@NgModule.bootstrap" components nor a "ngDoBootstrap" method. Please define one of these.`);t.instance.ngDoBootstrap(e)}this._modules.push(t)}onDestroy(t){this._destroyListeners.push(t)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new Error("The platform has already been destroyed!");this._modules.slice().forEach(t=>t.destroy()),this._destroyListeners.forEach(t=>t()),this._destroyed=!0}get destroyed(){return this._destroyed}}return t.\u0275fac=function(e){return new(e||t)(Kt(ca))},t.\u0275prov=ht({token:t,factory:t.\u0275fac}),t})();function Sl(t,e){return Array.isArray(e)?e.reduce(Sl,t):Object.assign(Object.assign({},t),e)}let El=(()=>{class t{constructor(t,e,n,r,i,o){this._zone=t,this._console=e,this._injector=n,this._exceptionHandler=r,this._componentFactoryResolver=i,this._initStatus=o,this._bootstrapListeners=[],this._views=[],this._runningTick=!1,this._enforceNoNewChanges=!1,this._stable=!0,this.componentTypes=[],this.components=[],this._enforceNoNewChanges=Nr(),this._zone.onMicrotaskEmpty.subscribe({next:()=>{this._zone.run(()=>{this.tick()})}});const a=new v(t=>{this._stable=this._zone.isStable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks,this._zone.runOutsideAngular(()=>{t.next(this._stable),t.complete()})}),s=new v(t=>{let e;this._zone.runOutsideAngular(()=>{e=this._zone.onStable.subscribe(()=>{sl.assertNotInAngularZone(),al(()=>{this._stable||this._zone.hasPendingMacrotasks||this._zone.hasPendingMicrotasks||(this._stable=!0,t.next(!0))})})});const n=this._zone.onUnstable.subscribe(()=>{sl.assertInAngularZone(),this._stable&&(this._stable=!1,this._zone.runOutsideAngular(()=>{t.next(!1)}))});return()=>{e.unsubscribe(),n.unsubscribe()}});this.isStable=q(a,s.pipe(et()))}bootstrap(t,e){if(!this._initStatus.done)throw new Error("Cannot bootstrap as there are still asynchronous initializers running. Bootstrap components in the `ngDoBootstrap` method of the root module.");let n;n=t instanceof xs?t:this._componentFactoryResolver.resolveComponentFactory(t),this.componentTypes.push(n.componentType);const r=n.isBoundToModule?void 0:this._injector.get(te),i=n.create(ca.NULL,[],e||n.selector,r);i.onDestroy(()=>{this._unloadComponent(i)});const o=i.injector.get(ml,null);return o&&i.injector.get(gl).registerApplication(i.location.nativeElement,o),this._loadComponent(i),Nr()&&this._console.log("Angular is running in development mode. Call enableProdMode() to enable production mode."),i}tick(){if(this._runningTick)throw new Error("ApplicationRef.tick is called recursively");try{this._runningTick=!0;for(let t of this._views)t.detectChanges();if(this._enforceNoNewChanges)for(let t of this._views)t.checkNoChanges()}catch(t){this._zone.runOutsideAngular(()=>this._exceptionHandler.handleError(t))}finally{this._runningTick=!1}}attachView(t){const e=t;this._views.push(e),e.attachToAppRef(this)}detachView(t){const e=t;Ol(this._views,e),e.detachFromAppRef()}_loadComponent(t){this.attachView(t.hostView),this.tick(),this.components.push(t),this._injector.get(Gu,[]).concat(this._bootstrapListeners).forEach(e=>e(t))}_unloadComponent(t){this.detachView(t.hostView),Ol(this.components,t)}ngOnDestroy(){this._views.slice().forEach(t=>t.destroy())}get viewCount(){return this._views.length}}return t.\u0275fac=function(e){return new(e||t)(Kt(sl),Kt(Xu),Kt(ca),Kt(yr),Kt(Cs),Kt(Uu))},t.\u0275prov=ht({token:t,factory:t.\u0275fac}),t})();function Ol(t,e){const n=t.indexOf(e);n>-1&&t.splice(n,1)}class Al{}class Nl{}const Tl={factoryPathPrefix:"",factoryPathSuffix:".ngfactory"};let Dl=(()=>{class t{constructor(t,e){this._compiler=t,this._config=e||Tl}load(t){return this.loadAndCompile(t)}loadAndCompile(t){let[e,r]=t.split("#");return void 0===r&&(r="default"),n("zn8P")(e).then(t=>t[r]).then(t=>Rl(t,e,r)).then(t=>this._compiler.compileModuleAsync(t))}loadFactory(t){let[e,r]=t.split("#"),i="NgFactory";return void 0===r&&(r="default",i=""),n("zn8P")(this._config.factoryPathPrefix+e+this._config.factoryPathSuffix).then(t=>t[r+i]).then(t=>Rl(t,e,r))}}return t.\u0275fac=function(e){return new(e||t)(Kt(il),Kt(Nl,8))},t.\u0275prov=ht({token:t,factory:t.\u0275fac}),t})();function Rl(t,e,n){if(!t)throw new Error(`Cannot find '${n}' in '${e}'`);return t}const Il=_l(null,"core",[{provide:Hu,useValue:"unknown"},{provide:kl,deps:[ca]},{provide:gl,deps:[]},{provide:Xu,deps:[]}]),Ml=[{provide:El,useClass:El,deps:[sl,Xu,ca,yr,Cs,Uu]},{provide:eu,deps:[sl],useFactory:function(t){let e=[];return t.onStable.subscribe(()=>{for(;e.length;)e.pop()()}),function(t){e.push(t)}}},{provide:Uu,useClass:Uu,deps:[[new ot,Bu]]},{provide:il,useClass:il,deps:[]},Vu,{provide:Vs,useFactory:function(){return Hs},deps:[]},{provide:Ws,useFactory:function(){return Gs},deps:[]},{provide:Ku,useFactory:function(t){return hu(t=t||"undefined"!=typeof $localize&&$localize.locale||"en-US"),t},deps:[[new it(Ku),new ot,new st]]},{provide:Yu,useValue:"USD"}];let Fl=(()=>{class t{constructor(t){}}return t.\u0275mod=ve({type:t}),t.\u0275inj=dt({factory:function(e){return new(e||t)(Kt(El))},providers:Ml}),t})(),Pl=null;function jl(){return Pl}const zl=new Lt("DocumentToken");let Ll=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=ht({factory:Bl,token:t,providedIn:"platform"}),t})();function Bl(){return Kt($l)}const Ul=new Lt("Location Initialized");let $l=(()=>{class t extends Ll{constructor(t){super(),this._doc=t,this._init()}_init(){this.location=jl().getLocation(),this._history=jl().getHistory()}getBaseHrefFromDOM(){return jl().getBaseHref(this._doc)}onPopState(t){jl().getGlobalEventTarget(this._doc,"window").addEventListener("popstate",t,!1)}onHashChange(t){jl().getGlobalEventTarget(this._doc,"window").addEventListener("hashchange",t,!1)}get href(){return this.location.href}get protocol(){return this.location.protocol}get hostname(){return this.location.hostname}get port(){return this.location.port}get pathname(){return this.location.pathname}get search(){return this.location.search}get hash(){return this.location.hash}set pathname(t){this.location.pathname=t}pushState(t,e,n){Vl()?this._history.pushState(t,e,n):this.location.hash=n}replaceState(t,e,n){Vl()?this._history.replaceState(t,e,n):this.location.hash=n}forward(){this._history.forward()}back(){this._history.back()}getState(){return this._history.state}}return t.\u0275fac=function(e){return new(e||t)(Kt(zl))},t.\u0275prov=ht({factory:Wl,token:t,providedIn:"platform"}),t})();function Vl(){return!!window.history.pushState}function Wl(){return new $l(Kt(zl))}function ql(t,e){if(0==t.length)return e;if(0==e.length)return t;let n=0;return t.endsWith("/")&&n++,e.startsWith("/")&&n++,2==n?t+e.substring(1):1==n?t+e:t+"/"+e}function Hl(t){const e=t.match(/#|\?|$/),n=e&&e.index||t.length;return t.slice(0,n-("/"===t[n-1]?1:0))+t.slice(n)}function Gl(t){return t&&"?"!==t[0]?"?"+t:t}let Xl=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=ht({factory:Kl,token:t,providedIn:"root"}),t})();function Kl(t){const e=Kt(zl).location;return new Zl(Kt(Ll),e&&e.origin||"")}const Yl=new Lt("appBaseHref");let Zl=(()=>{class t extends Xl{constructor(t,e){if(super(),this._platformLocation=t,null==e&&(e=this._platformLocation.getBaseHrefFromDOM()),null==e)throw new Error("No base href set. Please provide a value for the APP_BASE_HREF token or add a base element to the document.");this._baseHref=e}onPopState(t){this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t)}getBaseHref(){return this._baseHref}prepareExternalUrl(t){return ql(this._baseHref,t)}path(t=!1){const e=this._platformLocation.pathname+Gl(this._platformLocation.search),n=this._platformLocation.hash;return n&&t?`${e}${n}`:e}pushState(t,e,n,r){const i=this.prepareExternalUrl(n+Gl(r));this._platformLocation.pushState(t,e,i)}replaceState(t,e,n,r){const i=this.prepareExternalUrl(n+Gl(r));this._platformLocation.replaceState(t,e,i)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}}return t.\u0275fac=function(e){return new(e||t)(Kt(Ll),Kt(Yl,8))},t.\u0275prov=ht({token:t,factory:t.\u0275fac}),t})(),Ql=(()=>{class t extends Xl{constructor(t,e){super(),this._platformLocation=t,this._baseHref="",null!=e&&(this._baseHref=e)}onPopState(t){this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t)}getBaseHref(){return this._baseHref}path(t=!1){let e=this._platformLocation.hash;return null==e&&(e="#"),e.length>0?e.substring(1):e}prepareExternalUrl(t){const e=ql(this._baseHref,t);return e.length>0?"#"+e:e}pushState(t,e,n,r){let i=this.prepareExternalUrl(n+Gl(r));0==i.length&&(i=this._platformLocation.pathname),this._platformLocation.pushState(t,e,i)}replaceState(t,e,n,r){let i=this.prepareExternalUrl(n+Gl(r));0==i.length&&(i=this._platformLocation.pathname),this._platformLocation.replaceState(t,e,i)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}}return t.\u0275fac=function(e){return new(e||t)(Kt(Ll),Kt(Yl,8))},t.\u0275prov=ht({token:t,factory:t.\u0275fac}),t})(),Jl=(()=>{class t{constructor(t,e){this._subject=new vu,this._urlChangeListeners=[],this._platformStrategy=t;const n=this._platformStrategy.getBaseHref();this._platformLocation=e,this._baseHref=Hl(ec(n)),this._platformStrategy.onPopState(t=>{this._subject.emit({url:this.path(!0),pop:!0,state:t.state,type:t.type})})}path(t=!1){return this.normalize(this._platformStrategy.path(t))}getState(){return this._platformLocation.getState()}isCurrentPathEqualTo(t,e=""){return this.path()==this.normalize(t+Gl(e))}normalize(e){return t.stripTrailingSlash(function(t,e){return t&&e.startsWith(t)?e.substring(t.length):e}(this._baseHref,ec(e)))}prepareExternalUrl(t){return t&&"/"!==t[0]&&(t="/"+t),this._platformStrategy.prepareExternalUrl(t)}go(t,e="",n=null){this._platformStrategy.pushState(n,"",t,e),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+Gl(e)),n)}replaceState(t,e="",n=null){this._platformStrategy.replaceState(n,"",t,e),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+Gl(e)),n)}forward(){this._platformStrategy.forward()}back(){this._platformStrategy.back()}onUrlChange(t){this._urlChangeListeners.push(t),this._urlChangeSubscription||(this._urlChangeSubscription=this.subscribe(t=>{this._notifyUrlChangeListeners(t.url,t.state)}))}_notifyUrlChangeListeners(t="",e){this._urlChangeListeners.forEach(n=>n(t,e))}subscribe(t,e,n){return this._subject.subscribe({next:t,error:e,complete:n})}}return t.\u0275fac=function(e){return new(e||t)(Kt(Xl),Kt(Ll))},t.normalizeQueryParams=Gl,t.joinWithSlash=ql,t.stripTrailingSlash=Hl,t.\u0275prov=ht({factory:tc,token:t,providedIn:"root"}),t})();function tc(){return new Jl(Kt(Xl),Kt(Ll))}function ec(t){return t.replace(/\/index.html$/,"")}var nc=function(t){return t[t.Decimal=0]="Decimal",t[t.Percent=1]="Percent",t[t.Currency=2]="Currency",t[t.Scientific=3]="Scientific",t}({}),rc=function(t){return t[t.Zero=0]="Zero",t[t.One=1]="One",t[t.Two=2]="Two",t[t.Few=3]="Few",t[t.Many=4]="Many",t[t.Other=5]="Other",t}({}),ic=function(t){return t[t.Decimal=0]="Decimal",t[t.Group=1]="Group",t[t.List=2]="List",t[t.PercentSign=3]="PercentSign",t[t.PlusSign=4]="PlusSign",t[t.MinusSign=5]="MinusSign",t[t.Exponential=6]="Exponential",t[t.SuperscriptingExponent=7]="SuperscriptingExponent",t[t.PerMille=8]="PerMille",t[t[1/0]=9]="Infinity",t[t.NaN=10]="NaN",t[t.TimeSeparator=11]="TimeSeparator",t[t.CurrencyDecimal=12]="CurrencyDecimal",t[t.CurrencyGroup=13]="CurrencyGroup",t}({});function oc(t,e){const n=su(t),r=n[lu.NumberSymbols][e];if(void 0===r){if(e===ic.CurrencyDecimal)return n[lu.NumberSymbols][ic.Decimal];if(e===ic.CurrencyGroup)return n[lu.NumberSymbols][ic.Group]}return r}const ac=/^(\d+)?\.((\d+)(-(\d+))?)?$/;function sc(t){const e=parseInt(t);if(isNaN(e))throw new Error("Invalid integer literal when parsing "+t);return e}class uc{}let lc=(()=>{class t extends uc{constructor(t){super(),this.locale=t}getPluralCategory(t,e){switch(function(t){return su(t)[lu.PluralCase]}(e||this.locale)(t)){case rc.Zero:return"zero";case rc.One:return"one";case rc.Two:return"two";case rc.Few:return"few";case rc.Many:return"many";default:return"other"}}}return t.\u0275fac=function(e){return new(e||t)(Kt(Ku))},t.\u0275prov=ht({token:t,factory:t.\u0275fac}),t})();function cc(t,e){e=encodeURIComponent(e);for(const n of t.split(";")){const t=n.indexOf("="),[r,i]=-1==t?[n,""]:[n.slice(0,t),n.slice(t+1)];if(r.trim()===e)return decodeURIComponent(i)}return null}class hc{constructor(t,e,n,r){this.$implicit=t,this.ngForOf=e,this.index=n,this.count=r}get first(){return 0===this.index}get last(){return this.index===this.count-1}get even(){return this.index%2==0}get odd(){return!this.even}}let dc=(()=>{class t{constructor(t,e,n){this._viewContainer=t,this._template=e,this._differs=n,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForOf(t){this._ngForOf=t,this._ngForOfDirty=!0}set ngForTrackBy(t){Nr()&&null!=t&&"function"!=typeof t&&console&&console.warn&&console.warn(`trackBy must be a function, but received ${JSON.stringify(t)}. See https://angular.io/api/common/NgForOf#change-propagation for more information.`),this._trackByFn=t}get ngForTrackBy(){return this._trackByFn}set ngForTemplate(t){t&&(this._template=t)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;const n=this._ngForOf;if(!this._differ&&n)try{this._differ=this._differs.find(n).create(this.ngForTrackBy)}catch(e){throw new Error(`Cannot find a differ supporting object '${n}' of type '${t=n,t.name||typeof t}'. NgFor only supports binding to Iterables such as Arrays.`)}}var t;if(this._differ){const t=this._differ.diff(this._ngForOf);t&&this._applyChanges(t)}}_applyChanges(t){const e=[];t.forEachOperation((t,n,r)=>{if(null==t.previousIndex){const n=this._viewContainer.createEmbeddedView(this._template,new hc(null,this._ngForOf,-1,-1),null===r?void 0:r),i=new fc(t,n);e.push(i)}else if(null==r)this._viewContainer.remove(null===n?void 0:n);else if(null!==n){const i=this._viewContainer.get(n);this._viewContainer.move(i,r);const o=new fc(t,i);e.push(o)}});for(let n=0;n<e.length;n++)this._perViewChange(e[n].view,e[n].record);for(let n=0,r=this._viewContainer.length;n<r;n++){const t=this._viewContainer.get(n);t.context.index=n,t.context.count=r,t.context.ngForOf=this._ngForOf}t.forEachIdentityChange(t=>{this._viewContainer.get(t.currentIndex).context.$implicit=t.item})}_perViewChange(t,e){t.context.$implicit=e.item}static ngTemplateContextGuard(t,e){return!0}}return t.\u0275fac=function(e){return new(e||t)(ka(Ys),ka(Xs),ka(Vs))},t.\u0275dir=we({type:t,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"}}),t})();class fc{constructor(t,e){this.record=t,this.view=e}}let pc=(()=>{class t{constructor(t,e){this._viewContainer=t,this._context=new mc,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=e}set ngIf(t){this._context.$implicit=this._context.ngIf=t,this._updateView()}set ngIfThen(t){gc("ngIfThen",t),this._thenTemplateRef=t,this._thenViewRef=null,this._updateView()}set ngIfElse(t){gc("ngIfElse",t),this._elseTemplateRef=t,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(t,e){return!0}}return t.\u0275fac=function(e){return new(e||t)(ka(Ys),ka(Xs))},t.\u0275dir=we({type:t,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"}}),t})();class mc{constructor(){this.$implicit=null,this.ngIf=null}}function gc(t,e){if(e&&!e.createEmbeddedView)throw new Error(`${t} must be a TemplateRef, but received '${xt(e)}'.`)}class yc{constructor(t,e){this._viewContainerRef=t,this._templateRef=e,this._created=!1}create(){this._created=!0,this._viewContainerRef.createEmbeddedView(this._templateRef)}destroy(){this._created=!1,this._viewContainerRef.clear()}enforceState(t){t&&!this._created?this.create():!t&&this._created&&this.destroy()}}let vc=(()=>{class t{constructor(){this._defaultUsed=!1,this._caseCount=0,this._lastCaseCheckIndex=0,this._lastCasesMatched=!1}set ngSwitch(t){this._ngSwitch=t,0===this._caseCount&&this._updateDefaultCases(!0)}_addCase(){return this._caseCount++}_addDefault(t){this._defaultViews||(this._defaultViews=[]),this._defaultViews.push(t)}_matchCase(t){const e=t==this._ngSwitch;return this._lastCasesMatched=this._lastCasesMatched||e,this._lastCaseCheckIndex++,this._lastCaseCheckIndex===this._caseCount&&(this._updateDefaultCases(!this._lastCasesMatched),this._lastCaseCheckIndex=0,this._lastCasesMatched=!1),e}_updateDefaultCases(t){if(this._defaultViews&&t!==this._defaultUsed){this._defaultUsed=t;for(let e=0;e<this._defaultViews.length;e++)this._defaultViews[e].enforceState(t)}}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275dir=we({type:t,selectors:[["","ngSwitch",""]],inputs:{ngSwitch:"ngSwitch"}}),t})(),bc=(()=>{class t{constructor(t,e,n){this.ngSwitch=n,n._addCase(),this._view=new yc(t,e)}ngDoCheck(){this._view.enforceState(this.ngSwitch._matchCase(this.ngSwitchCase))}}return t.\u0275fac=function(e){return new(e||t)(ka(Ys),ka(Xs),ka(vc,1))},t.\u0275dir=we({type:t,selectors:[["","ngSwitchCase",""]],inputs:{ngSwitchCase:"ngSwitchCase"}}),t})(),wc=(()=>{class t{constructor(t){this._locale=t}transform(e,n,r){if(function(t){return null==t||""===t||t!=t}(e))return null;r=r||this._locale;try{return function(t,e,n){return function(t,e,n,r,i,o,a=!1){let s="",u=!1;if(isFinite(t)){let l=function(t){let e,n,r,i,o,a=Math.abs(t)+"",s=0;for((n=a.indexOf("."))>-1&&(a=a.replace(".","")),(r=a.search(/e/i))>0?(n<0&&(n=r),n+=+a.slice(r+1),a=a.substring(0,r)):n<0&&(n=a.length),r=0;"0"===a.charAt(r);r++);if(r===(o=a.length))e=[0],n=1;else{for(o--;"0"===a.charAt(o);)o--;for(n-=r,e=[],i=0;r<=o;r++,i++)e[i]=Number(a.charAt(r))}return n>22&&(e=e.splice(0,21),s=n-1,n=1),{digits:e,exponent:s,integerLen:n}}(t);a&&(l=function(t){if(0===t.digits[0])return t;const e=t.digits.length-t.integerLen;return t.exponent?t.exponent+=2:(0===e?t.digits.push(0,0):1===e&&t.digits.push(0),t.integerLen+=2),t}(l));let c=e.minInt,h=e.minFrac,d=e.maxFrac;if(o){const t=o.match(ac);if(null===t)throw new Error(o+" is not a valid digit info");const e=t[1],n=t[3],r=t[5];null!=e&&(c=sc(e)),null!=n&&(h=sc(n)),null!=r?d=sc(r):null!=n&&h>d&&(d=h)}!function(t,e,n){if(e>n)throw new Error(`The minimum number of digits after fraction (${e}) is higher than the maximum (${n}).`);let r=t.digits,i=r.length-t.integerLen;const o=Math.min(Math.max(e,i),n);let a=o+t.integerLen,s=r[a];if(a>0){r.splice(Math.max(t.integerLen,a));for(let t=a;t<r.length;t++)r[t]=0}else{i=Math.max(0,i),t.integerLen=1,r.length=Math.max(1,a=o+1),r[0]=0;for(let t=1;t<a;t++)r[t]=0}if(s>=5)if(a-1<0){for(let e=0;e>a;e--)r.unshift(0),t.integerLen++;r.unshift(1),t.integerLen++}else r[a-1]++;for(;i<Math.max(0,o);i++)r.push(0);let u=0!==o;const l=e+t.integerLen,c=r.reduceRight((function(t,e,n,r){return r[n]=(e+=t)<10?e:e-10,u&&(0===r[n]&&n>=l?r.pop():u=!1),e>=10?1:0}),0);c&&(r.unshift(c),t.integerLen++)}(l,h,d);let f=l.digits,p=l.integerLen;const m=l.exponent;let g=[];for(u=f.every(t=>!t);p<c;p++)f.unshift(0);for(;p<0;p++)f.unshift(0);p>0?g=f.splice(p,f.length):(g=f,f=[0]);const y=[];for(f.length>=e.lgSize&&y.unshift(f.splice(-e.lgSize,f.length).join(""));f.length>e.gSize;)y.unshift(f.splice(-e.gSize,f.length).join(""));f.length&&y.unshift(f.join("")),s=y.join(oc(n,r)),g.length&&(s+=oc(n,i)+g.join("")),m&&(s+=oc(n,ic.Exponential)+"+"+m)}else s=oc(n,ic.Infinity);return s=t<0&&!u?e.negPre+s+e.negSuf:e.posPre+s+e.posSuf,s}(t,function(t,e="-"){const n={minInt:1,minFrac:0,maxFrac:0,posPre:"",posSuf:"",negPre:"",negSuf:"",gSize:0,lgSize:0},r=t.split(";"),i=r[0],o=r[1],a=-1!==i.indexOf(".")?i.split("."):[i.substring(0,i.lastIndexOf("0")+1),i.substring(i.lastIndexOf("0")+1)],s=a[0],u=a[1]||"";n.posPre=s.substr(0,s.indexOf("#"));for(let c=0;c<u.length;c++){const t=u.charAt(c);"0"===t?n.minFrac=n.maxFrac=c+1:"#"===t?n.maxFrac=c+1:n.posSuf+=t}const l=s.split(",");if(n.gSize=l[1]?l[1].length:0,n.lgSize=l[2]||l[1]?(l[2]||l[1]).length:0,o){const t=i.length-n.posPre.length-n.posSuf.length,e=o.indexOf("#");n.negPre=o.substr(0,e).replace(/'/g,""),n.negSuf=o.substr(e+t).replace(/'/g,"")}else n.negPre=e+n.posPre,n.negSuf=n.posSuf;return n}(function(t,e){return su(t)[lu.NumberFormats][e]}(e,nc.Percent),oc(e,ic.MinusSign)),e,ic.Group,ic.Decimal,n,!0).replace(new RegExp("%","g"),oc(e,ic.PercentSign))}(function(t){if("string"==typeof t&&!isNaN(Number(t)-parseFloat(t)))return Number(t);if("number"!=typeof t)throw new Error(t+" is not a number");return t}(e),r,n)}catch(i){throw function(t,e){return Error(`InvalidPipeArgument: '${e}' for pipe '${xt(t)}'`)}(t,i.message)}}}return t.\u0275fac=function(e){return new(e||t)(ka(Ku))},t.\u0275pipe=xe({name:"percent",type:t,pure:!0}),t})(),xc=(()=>{class t{}return t.\u0275mod=ve({type:t}),t.\u0275inj=dt({factory:function(e){return new(e||t)},providers:[{provide:uc,useClass:lc}]}),t})();function _c(t){return"browser"===t}let Cc=(()=>{class t{}return t.\u0275prov=ht({token:t,providedIn:"root",factory:()=>new kc(Kt(zl),window,Kt(yr))}),t})();class kc{constructor(t,e,n){this.document=t,this.window=e,this.errorHandler=n,this.offset=()=>[0,0]}setOffset(t){this.offset=Array.isArray(t)?()=>t:t}getScrollPosition(){return this.supportScrollRestoration()?[this.window.scrollX,this.window.scrollY]:[0,0]}scrollToPosition(t){this.supportScrollRestoration()&&this.window.scrollTo(t[0],t[1])}scrollToAnchor(t){if(this.supportScrollRestoration()){t=this.window.CSS&&this.window.CSS.escape?this.window.CSS.escape(t):t.replace(/(\"|\'\ |:|\.|\[|\]|,|=)/g,"\\$1");try{const e=this.document.querySelector("#"+t);if(e)return void this.scrollToElement(e);const n=this.document.querySelector(`[name='${t}']`);if(n)return void this.scrollToElement(n)}catch(e){this.errorHandler.handleError(e)}}}setHistoryScrollRestoration(t){if(this.supportScrollRestoration()){const e=this.window.history;e&&e.scrollRestoration&&(e.scrollRestoration=t)}}scrollToElement(t){const e=t.getBoundingClientRect(),n=e.left+this.window.pageXOffset,r=e.top+this.window.pageYOffset,i=this.offset();this.window.scrollTo(n-i[0],r-i[1])}supportScrollRestoration(){try{return!!this.window&&!!this.window.scrollTo}catch(t){return!1}}}class Sc extends class extends class{}{constructor(){super()}supportsDOMEvents(){return!0}}{static makeCurrent(){var t;t=new Sc,Pl||(Pl=t)}getProperty(t,e){return t[e]}log(t){window.console&&window.console.log&&window.console.log(t)}logGroup(t){window.console&&window.console.group&&window.console.group(t)}logGroupEnd(){window.console&&window.console.groupEnd&&window.console.groupEnd()}onAndCancel(t,e,n){return t.addEventListener(e,n,!1),()=>{t.removeEventListener(e,n,!1)}}dispatchEvent(t,e){t.dispatchEvent(e)}remove(t){return t.parentNode&&t.parentNode.removeChild(t),t}getValue(t){return t.value}createElement(t,e){return(e=e||this.getDefaultDocument()).createElement(t)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(t){return t.nodeType===Node.ELEMENT_NODE}isShadowRoot(t){return t instanceof DocumentFragment}getGlobalEventTarget(t,e){return"window"===e?window:"document"===e?t:"body"===e?t.body:null}getHistory(){return window.history}getLocation(){return window.location}getBaseHref(t){const e=Oc||(Oc=document.querySelector("base"),Oc)?Oc.getAttribute("href"):null;return null==e?null:(n=e,Ec||(Ec=document.createElement("a")),Ec.setAttribute("href",n),"/"===Ec.pathname.charAt(0)?Ec.pathname:"/"+Ec.pathname);var n}resetBaseElement(){Oc=null}getUserAgent(){return window.navigator.userAgent}performanceNow(){return window.performance&&window.performance.now?window.performance.now():(new Date).getTime()}supportsCookies(){return!0}getCookie(t){return cc(document.cookie,t)}}let Ec,Oc=null;const Ac=new Lt("TRANSITION_ID"),Nc=[{provide:Bu,useFactory:function(t,e,n){return()=>{n.get(Uu).donePromise.then(()=>{const n=jl();Array.prototype.slice.apply(e.querySelectorAll("style[ng-transition]")).filter(e=>e.getAttribute("ng-transition")===t).forEach(t=>n.remove(t))})}},deps:[Ac,zl,ca],multi:!0}];class Tc{static init(){var t;t=new Tc,bl=t}addToWindow(t){Dt.getAngularTestability=(e,n=!0)=>{const r=t.findTestabilityInTree(e,n);if(null==r)throw new Error("Could not find testability for element.");return r},Dt.getAllAngularTestabilities=()=>t.getAllTestabilities(),Dt.getAllAngularRootElements=()=>t.getAllRootElements(),Dt.frameworkStabilizers||(Dt.frameworkStabilizers=[]),Dt.frameworkStabilizers.push(t=>{const e=Dt.getAllAngularTestabilities();let n=e.length,r=!1;const i=function(e){r=r||e,n--,0==n&&t(r)};e.forEach((function(t){t.whenStable(i)}))})}findTestabilityInTree(t,e,n){if(null==e)return null;const r=t.getTestability(e);return null!=r?r:n?jl().isShadowRoot(e)?this.findTestabilityInTree(t,e.host,!0):this.findTestabilityInTree(t,e.parentElement,!0):null}}const Dc=new Lt("EventManagerPlugins");let Rc=(()=>{class t{constructor(t,e){this._zone=e,this._eventNameToPlugin=new Map,t.forEach(t=>t.manager=this),this._plugins=t.slice().reverse()}addEventListener(t,e,n){return this._findPluginFor(e).addEventListener(t,e,n)}addGlobalEventListener(t,e,n){return this._findPluginFor(e).addGlobalEventListener(t,e,n)}getZone(){return this._zone}_findPluginFor(t){const e=this._eventNameToPlugin.get(t);if(e)return e;const n=this._plugins;for(let r=0;r<n.length;r++){const e=n[r];if(e.supports(t))return this._eventNameToPlugin.set(t,e),e}throw new Error("No event manager plugin found for event "+t)}}return t.\u0275fac=function(e){return new(e||t)(Kt(Dc),Kt(sl))},t.\u0275prov=ht({token:t,factory:t.\u0275fac}),t})();class Ic{constructor(t){this._doc=t}addGlobalEventListener(t,e,n){const r=jl().getGlobalEventTarget(this._doc,t);if(!r)throw new Error(`Unsupported event target ${r} for event ${e}`);return this.addEventListener(r,e,n)}}let Mc=(()=>{class t{constructor(){this._stylesSet=new Set}addStyles(t){const e=new Set;t.forEach(t=>{this._stylesSet.has(t)||(this._stylesSet.add(t),e.add(t))}),this.onStylesAdded(e)}onStylesAdded(t){}getAllStyles(){return Array.from(this._stylesSet)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=ht({token:t,factory:t.\u0275fac}),t})(),Fc=(()=>{class t extends Mc{constructor(t){super(),this._doc=t,this._hostNodes=new Set,this._styleNodes=new Set,this._hostNodes.add(t.head)}_addStylesToHost(t,e){t.forEach(t=>{const n=this._doc.createElement("style");n.textContent=t,this._styleNodes.add(e.appendChild(n))})}addHost(t){this._addStylesToHost(this._stylesSet,t),this._hostNodes.add(t)}removeHost(t){this._hostNodes.delete(t)}onStylesAdded(t){this._hostNodes.forEach(e=>this._addStylesToHost(t,e))}ngOnDestroy(){this._styleNodes.forEach(t=>jl().remove(t))}}return t.\u0275fac=function(e){return new(e||t)(Kt(zl))},t.\u0275prov=ht({token:t,factory:t.\u0275fac}),t})();const Pc={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"},jc=/%COMP%/g;function zc(t,e,n){for(let r=0;r<e.length;r++){let i=e[r];Array.isArray(i)?zc(t,i,n):(i=i.replace(jc,t),n.push(i))}return n}function Lc(t){return e=>{if("__ngUnwrap__"===e)return t;!1===t(e)&&(e.preventDefault(),e.returnValue=!1)}}let Bc=(()=>{class t{constructor(t,e,n){this.eventManager=t,this.sharedStylesHost=e,this.appId=n,this.rendererByCompId=new Map,this.defaultRenderer=new Uc(t)}createRenderer(t,e){if(!t||!e)return this.defaultRenderer;switch(e.encapsulation){case ce.Emulated:{let n=this.rendererByCompId.get(e.id);return n||(n=new $c(this.eventManager,this.sharedStylesHost,e,this.appId),this.rendererByCompId.set(e.id,n)),n.applyToHost(t),n}case ce.Native:case ce.ShadowDom:return new Vc(this.eventManager,this.sharedStylesHost,t,e);default:if(!this.rendererByCompId.has(e.id)){const t=zc(e.id,e.styles,[]);this.sharedStylesHost.addStyles(t),this.rendererByCompId.set(e.id,this.defaultRenderer)}return this.defaultRenderer}}begin(){}end(){}}return t.\u0275fac=function(e){return new(e||t)(Kt(Rc),Kt(Fc),Kt($u))},t.\u0275prov=ht({token:t,factory:t.\u0275fac}),t})();class Uc{constructor(t){this.eventManager=t,this.data=Object.create(null)}destroy(){}createElement(t,e){return e?document.createElementNS(Pc[e]||e,t):document.createElement(t)}createComment(t){return document.createComment(t)}createText(t){return document.createTextNode(t)}appendChild(t,e){t.appendChild(e)}insertBefore(t,e,n){t&&t.insertBefore(e,n)}removeChild(t,e){t&&t.removeChild(e)}selectRootElement(t,e){let n="string"==typeof t?document.querySelector(t):t;if(!n)throw new Error(`The selector "${t}" did not match any elements`);return e||(n.textContent=""),n}parentNode(t){return t.parentNode}nextSibling(t){return t.nextSibling}setAttribute(t,e,n,r){if(r){e=r+":"+e;const i=Pc[r];i?t.setAttributeNS(i,e,n):t.setAttribute(e,n)}else t.setAttribute(e,n)}removeAttribute(t,e,n){if(n){const r=Pc[n];r?t.removeAttributeNS(r,e):t.removeAttribute(`${n}:${e}`)}else t.removeAttribute(e)}addClass(t,e){t.classList.add(e)}removeClass(t,e){t.classList.remove(e)}setStyle(t,e,n,r){r&Os.DashCase?t.style.setProperty(e,n,r&Os.Important?"important":""):t.style[e]=n}removeStyle(t,e,n){n&Os.DashCase?t.style.removeProperty(e):t.style[e]=""}setProperty(t,e,n){t[e]=n}setValue(t,e){t.nodeValue=e}listen(t,e,n){return"string"==typeof t?this.eventManager.addGlobalEventListener(t,e,Lc(n)):this.eventManager.addEventListener(t,e,Lc(n))}}class $c extends Uc{constructor(t,e,n,r){super(t),this.component=n;const i=zc(r+"-"+n.id,n.styles,[]);e.addStyles(i),this.contentAttr="_ngcontent-%COMP%".replace(jc,r+"-"+n.id),this.hostAttr=function(t){return"_nghost-%COMP%".replace(jc,t)}(r+"-"+n.id)}applyToHost(t){super.setAttribute(t,this.hostAttr,"")}createElement(t,e){const n=super.createElement(t,e);return super.setAttribute(n,this.contentAttr,""),n}}class Vc extends Uc{constructor(t,e,n,r){super(t),this.sharedStylesHost=e,this.hostEl=n,this.component=r,this.shadowRoot=r.encapsulation===ce.ShadowDom?n.attachShadow({mode:"open"}):n.createShadowRoot(),this.sharedStylesHost.addHost(this.shadowRoot);const i=zc(r.id,r.styles,[]);for(let o=0;o<i.length;o++){const t=document.createElement("style");t.textContent=i[o],this.shadowRoot.appendChild(t)}}nodeOrShadowRoot(t){return t===this.hostEl?this.shadowRoot:t}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}appendChild(t,e){return super.appendChild(this.nodeOrShadowRoot(t),e)}insertBefore(t,e,n){return super.insertBefore(this.nodeOrShadowRoot(t),e,n)}removeChild(t,e){return super.removeChild(this.nodeOrShadowRoot(t),e)}parentNode(t){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(t)))}}let Wc=(()=>{class t extends Ic{constructor(t){super(t)}supports(t){return!0}addEventListener(t,e,n){return t.addEventListener(e,n,!1),()=>this.removeEventListener(t,e,n)}removeEventListener(t,e,n){return t.removeEventListener(e,n)}}return t.\u0275fac=function(e){return new(e||t)(Kt(zl))},t.\u0275prov=ht({token:t,factory:t.\u0275fac}),t})();const qc=["alt","control","meta","shift"],Hc={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},Gc={A:"1",B:"2",C:"3",D:"4",E:"5",F:"6",G:"7",H:"8",I:"9",J:"*",K:"+",M:"-",N:".",O:"/","`":"0","\x90":"NumLock"},Xc={alt:t=>t.altKey,control:t=>t.ctrlKey,meta:t=>t.metaKey,shift:t=>t.shiftKey};let Kc=(()=>{class t extends Ic{constructor(t){super(t)}supports(e){return null!=t.parseEventName(e)}addEventListener(e,n,r){const i=t.parseEventName(n),o=t.eventCallback(i.fullKey,r,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>jl().onAndCancel(e,i.domEventName,o))}static parseEventName(e){const n=e.toLowerCase().split("."),r=n.shift();if(0===n.length||"keydown"!==r&&"keyup"!==r)return null;const i=t._normalizeKey(n.pop());let o="";if(qc.forEach(t=>{const e=n.indexOf(t);e>-1&&(n.splice(e,1),o+=t+".")}),o+=i,0!=n.length||0===i.length)return null;const a={};return a.domEventName=r,a.fullKey=o,a}static getEventFullKey(t){let e="",n=function(t){let e=t.key;if(null==e){if(e=t.keyIdentifier,null==e)return"Unidentified";e.startsWith("U+")&&(e=String.fromCharCode(parseInt(e.substring(2),16)),3===t.location&&Gc.hasOwnProperty(e)&&(e=Gc[e]))}return Hc[e]||e}(t);return n=n.toLowerCase()," "===n?n="space":"."===n&&(n="dot"),qc.forEach(r=>{r!=n&&(0,Xc[r])(t)&&(e+=r+".")}),e+=n,e}static eventCallback(e,n,r){return i=>{t.getEventFullKey(i)===e&&r.runGuarded(()=>n(i))}}static _normalizeKey(t){switch(t){case"esc":return"escape";default:return t}}}return t.\u0275fac=function(e){return new(e||t)(Kt(zl))},t.\u0275prov=ht({token:t,factory:t.\u0275fac}),t})(),Yc=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=ht({factory:function(){return Kt(Zc)},token:t,providedIn:"root"}),t})(),Zc=(()=>{class t extends Yc{constructor(t){super(),this._doc=t}sanitize(t,e){if(null==e)return null;switch(t){case Qr.NONE:return e;case Qr.HTML:return Sr(e,"HTML")?kr(e):function(t,e){let n=null;try{Yr=Yr||function(t){return function(){try{return!!(new window.DOMParser).parseFromString("","text/html")}catch(t){return!1}}()?new Tr:new Dr(t)}(t);let r=e?String(e):"";n=Yr.getInertBodyElement(r);let i=5,o=r;do{if(0===i)throw new Error("Failed to sanitize html because the input is unstable");i--,r=o,o=n.innerHTML,n=Yr.getInertBodyElement(r)}while(r!==o);const a=new Hr,s=a.sanitizeChildren(Zr(n)||n);return Nr()&&a.sanitizedSomething&&console.warn("WARNING: sanitizing HTML stripped some content, see http://g.co/ng/security#xss"),s}finally{if(n){const t=Zr(n)||n;for(;t.firstChild;)t.removeChild(t.firstChild)}}}(this._doc,String(e));case Qr.STYLE:return Sr(e,"Style")?kr(e):e;case Qr.SCRIPT:if(Sr(e,"Script"))return kr(e);throw new Error("unsafe value used in a script context");case Qr.URL:return Er(e),Sr(e,"URL")?kr(e):Mr(String(e));case Qr.RESOURCE_URL:if(Sr(e,"ResourceURL"))return kr(e);throw new Error("unsafe value used in a resource URL context (see http://g.co/ng/security#xss)");default:throw new Error(`Unexpected SecurityContext ${t} (see http://g.co/ng/security#xss)`)}}bypassSecurityTrustHtml(t){return new br(t)}bypassSecurityTrustStyle(t){return new wr(t)}bypassSecurityTrustScript(t){return new xr(t)}bypassSecurityTrustUrl(t){return new _r(t)}bypassSecurityTrustResourceUrl(t){return new Cr(t)}}return t.\u0275fac=function(e){return new(e||t)(Kt(zl))},t.\u0275prov=ht({factory:function(){return t=Kt(Bt),new Zc(t.get(zl));var t},token:t,providedIn:"root"}),t})();const Qc=_l(Il,"browser",[{provide:Hu,useValue:"browser"},{provide:qu,useValue:function(){Sc.makeCurrent(),Tc.init()},multi:!0},{provide:zl,useFactory:function(){return function(t){ze=t}(document),document},deps:[]}]),Jc=[[],{provide:Yo,useValue:"root"},{provide:yr,useFactory:function(){return new yr},deps:[]},{provide:Dc,useClass:Wc,multi:!0,deps:[zl,sl,Hu]},{provide:Dc,useClass:Kc,multi:!0,deps:[zl]},[],{provide:Bc,useClass:Bc,deps:[Rc,Fc,$u]},{provide:Es,useExisting:Bc},{provide:Mc,useExisting:Fc},{provide:Fc,useClass:Fc,deps:[zl]},{provide:ml,useClass:ml,deps:[sl]},{provide:Rc,useClass:Rc,deps:[Dc,sl]},[]];let th=(()=>{class t{constructor(t){if(t)throw new Error("BrowserModule has already been loaded. If you need access to common directives such as NgIf and NgFor from a lazy loaded module, import CommonModule instead.")}static withServerTransition(e){return{ngModule:t,providers:[{provide:$u,useValue:e.appId},{provide:Ac,useExisting:$u},Nc]}}}return t.\u0275mod=ve({type:t}),t.\u0275inj=dt({factory:function(e){return new(e||t)(Kt(t,12))},providers:Jc,imports:[xc,Fl]}),t})();"undefined"!=typeof window&&window;class eh{}function nh(t,e){return{type:7,name:t,definitions:e,options:{}}}function rh(t,e=null){return{type:4,styles:e,timings:t}}function ih(t,e=null){return{type:2,steps:t,options:e}}function oh(t){return{type:6,styles:t,offset:null}}function ah(t,e,n){return{type:0,name:t,styles:e,options:n}}function sh(t,e,n=null){return{type:1,expr:t,animation:e,options:n}}function uh(t){Promise.resolve(null).then(t)}class lh{constructor(t=0,e=0){this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._started=!1,this._destroyed=!1,this._finished=!1,this.parentPlayer=null,this.totalTime=t+e}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(t=>t()),this._onDoneFns=[])}onStart(t){this._onStartFns.push(t)}onDone(t){this._onDoneFns.push(t)}onDestroy(t){this._onDestroyFns.push(t)}hasStarted(){return this._started}init(){}play(){this.hasStarted()||(this._onStart(),this.triggerMicrotask()),this._started=!0}triggerMicrotask(){uh(()=>this._onFinish())}_onStart(){this._onStartFns.forEach(t=>t()),this._onStartFns=[]}pause(){}restart(){}finish(){this._onFinish()}destroy(){this._destroyed||(this._destroyed=!0,this.hasStarted()||this._onStart(),this.finish(),this._onDestroyFns.forEach(t=>t()),this._onDestroyFns=[])}reset(){}setPosition(t){}getPosition(){return 0}triggerCallback(t){const e="start"==t?this._onStartFns:this._onDoneFns;e.forEach(t=>t()),e.length=0}}class ch{constructor(t){this._onDoneFns=[],this._onStartFns=[],this._finished=!1,this._started=!1,this._destroyed=!1,this._onDestroyFns=[],this.parentPlayer=null,this.totalTime=0,this.players=t;let e=0,n=0,r=0;const i=this.players.length;0==i?uh(()=>this._onFinish()):this.players.forEach(t=>{t.onDone(()=>{++e==i&&this._onFinish()}),t.onDestroy(()=>{++n==i&&this._onDestroy()}),t.onStart(()=>{++r==i&&this._onStart()})}),this.totalTime=this.players.reduce((t,e)=>Math.max(t,e.totalTime),0)}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(t=>t()),this._onDoneFns=[])}init(){this.players.forEach(t=>t.init())}onStart(t){this._onStartFns.push(t)}_onStart(){this.hasStarted()||(this._started=!0,this._onStartFns.forEach(t=>t()),this._onStartFns=[])}onDone(t){this._onDoneFns.push(t)}onDestroy(t){this._onDestroyFns.push(t)}hasStarted(){return this._started}play(){this.parentPlayer||this.init(),this._onStart(),this.players.forEach(t=>t.play())}pause(){this.players.forEach(t=>t.pause())}restart(){this.players.forEach(t=>t.restart())}finish(){this._onFinish(),this.players.forEach(t=>t.finish())}destroy(){this._onDestroy()}_onDestroy(){this._destroyed||(this._destroyed=!0,this._onFinish(),this.players.forEach(t=>t.destroy()),this._onDestroyFns.forEach(t=>t()),this._onDestroyFns=[])}reset(){this.players.forEach(t=>t.reset()),this._destroyed=!1,this._finished=!1,this._started=!1}setPosition(t){const e=t*this.totalTime;this.players.forEach(t=>{const n=t.totalTime?Math.min(1,e/t.totalTime):1;t.setPosition(n)})}getPosition(){let t=0;return this.players.forEach(e=>{const n=e.getPosition();t=Math.min(n,t)}),t}beforeDestroy(){this.players.forEach(t=>{t.beforeDestroy&&t.beforeDestroy()})}triggerCallback(t){const e="start"==t?this._onStartFns:this._onDoneFns;e.forEach(t=>t()),e.length=0}}function hh(){return"undefined"!=typeof process&&"[object process]"==={}.toString.call(process)}function dh(t){switch(t.length){case 0:return new lh;case 1:return t[0];default:return new ch(t)}}function fh(t,e,n,r,i={},o={}){const a=[],s=[];let u=-1,l=null;if(r.forEach(t=>{const n=t.offset,r=n==u,c=r&&l||{};Object.keys(t).forEach(n=>{let r=n,s=t[n];if("offset"!==n)switch(r=e.normalizePropertyName(r,a),s){case"!":s=i[n];break;case"*":s=o[n];break;default:s=e.normalizeStyleValue(n,r,s,a)}c[r]=s}),r||s.push(c),l=c,u=n}),a.length){const t="\n - ";throw new Error(`Unable to animate due to the following errors:${t}${a.join(t)}`)}return s}function ph(t,e,n,r){switch(e){case"start":t.onStart(()=>r(n&&mh(n,"start",t)));break;case"done":t.onDone(()=>r(n&&mh(n,"done",t)));break;case"destroy":t.onDestroy(()=>r(n&&mh(n,"destroy",t)))}}function mh(t,e,n){const r=n.totalTime,i=gh(t.element,t.triggerName,t.fromState,t.toState,e||t.phaseName,null==r?t.totalTime:r,!!n.disabled),o=t._data;return null!=o&&(i._data=o),i}function gh(t,e,n,r,i="",o=0,a){return{element:t,triggerName:e,fromState:n,toState:r,phaseName:i,totalTime:o,disabled:!!a}}function yh(t,e,n){let r;return t instanceof Map?(r=t.get(e),r||t.set(e,r=n)):(r=t[e],r||(r=t[e]=n)),r}function vh(t){const e=t.indexOf(":");return[t.substring(1,e),t.substr(e+1)]}let bh=(t,e)=>!1,wh=(t,e)=>!1,xh=(t,e,n)=>[];const _h=hh();(_h||"undefined"!=typeof Element)&&(bh=(t,e)=>t.contains(e),wh=(()=>{if(_h||Element.prototype.matches)return(t,e)=>t.matches(e);{const t=Element.prototype,e=t.matchesSelector||t.mozMatchesSelector||t.msMatchesSelector||t.oMatchesSelector||t.webkitMatchesSelector;return e?(t,n)=>e.apply(t,[n]):wh}})(),xh=(t,e,n)=>{let r=[];if(n)r.push(...t.querySelectorAll(e));else{const n=t.querySelector(e);n&&r.push(n)}return r});let Ch=null,kh=!1;function Sh(t){Ch||(Ch=("undefined"!=typeof document?document.body:null)||{},kh=!!Ch.style&&"WebkitAppearance"in Ch.style);let e=!0;return Ch.style&&!function(t){return"ebkit"==t.substring(1,6)}(t)&&(e=t in Ch.style,!e&&kh)&&(e="Webkit"+t.charAt(0).toUpperCase()+t.substr(1)in Ch.style),e}const Eh=wh,Oh=bh,Ah=xh;function Nh(t){const e={};return Object.keys(t).forEach(n=>{const r=n.replace(/([a-z])([A-Z])/g,"$1-$2");e[r]=t[n]}),e}let Th=(()=>{class t{validateStyleProperty(t){return Sh(t)}matchesElement(t,e){return Eh(t,e)}containsElement(t,e){return Oh(t,e)}query(t,e,n){return Ah(t,e,n)}computeStyle(t,e,n){return n||""}animate(t,e,n,r,i,o=[],a){return new lh(n,r)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=ht({token:t,factory:t.\u0275fac}),t})(),Dh=(()=>{class t{}return t.NOOP=new Th,t})();function Rh(t){if("number"==typeof t)return t;const e=t.match(/^(-?[\.\d]+)(m?s)/);return!e||e.length<2?0:Ih(parseFloat(e[1]),e[2])}function Ih(t,e){switch(e){case"s":return 1e3*t;default:return t}}function Mh(t,e,n){return t.hasOwnProperty("duration")?t:function(t,e,n){let r,i=0,o="";if("string"==typeof t){const n=t.match(/^(-?[\.\d]+)(m?s)(?:\s+(-?[\.\d]+)(m?s))?(?:\s+([-a-z]+(?:\(.+?\))?))?$/i);if(null===n)return e.push(`The provided timing value "${t}" is invalid.`),{duration:0,delay:0,easing:""};r=Ih(parseFloat(n[1]),n[2]);const a=n[3];null!=a&&(i=Ih(parseFloat(a),n[4]));const s=n[5];s&&(o=s)}else r=t;if(!n){let n=!1,o=e.length;r<0&&(e.push("Duration values below 0 are not allowed for this animation step."),n=!0),i<0&&(e.push("Delay values below 0 are not allowed for this animation step."),n=!0),n&&e.splice(o,0,`The provided timing value "${t}" is invalid.`)}return{duration:r,delay:i,easing:o}}(t,e,n)}function Fh(t,e={}){return Object.keys(t).forEach(n=>{e[n]=t[n]}),e}function Ph(t,e,n={}){if(e)for(let r in t)n[r]=t[r];else Fh(t,n);return n}function jh(t,e,n){return n?e+":"+n+";":""}function zh(t){let e="";for(let n=0;n<t.style.length;n++){const r=t.style.item(n);e+=jh(0,r,t.style.getPropertyValue(r))}for(const n in t.style)t.style.hasOwnProperty(n)&&!n.startsWith("_")&&(e+=jh(0,n.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase(),t.style[n]));t.setAttribute("style",e)}function Lh(t,e,n){t.style&&(Object.keys(e).forEach(r=>{const i=Gh(r);n&&!n.hasOwnProperty(r)&&(n[r]=t.style[i]),t.style[i]=e[r]}),hh()&&zh(t))}function Bh(t,e){t.style&&(Object.keys(e).forEach(e=>{const n=Gh(e);t.style[n]=""}),hh()&&zh(t))}function Uh(t){return Array.isArray(t)?1==t.length?t[0]:ih(t):t}const $h=new RegExp("{{\\s*(.+?)\\s*}}","g");function Vh(t){let e=[];if("string"==typeof t){let n;for(;n=$h.exec(t);)e.push(n[1]);$h.lastIndex=0}return e}function Wh(t,e,n){const r=t.toString(),i=r.replace($h,(t,r)=>{let i=e[r];return e.hasOwnProperty(r)||(n.push("Please provide a value for the animation param "+r),i=""),i.toString()});return i==r?t:i}function qh(t){const e=[];let n=t.next();for(;!n.done;)e.push(n.value),n=t.next();return e}const Hh=/-+([a-z0-9])/g;function Gh(t){return t.replace(Hh,(...t)=>t[1].toUpperCase())}function Xh(t,e){return 0===t||0===e}function Kh(t,e,n){const r=Object.keys(n);if(r.length&&e.length){let o=e[0],a=[];if(r.forEach(t=>{o.hasOwnProperty(t)||a.push(t),o[t]=n[t]}),a.length)for(var i=1;i<e.length;i++){let n=e[i];a.forEach((function(e){n[e]=Zh(t,e)}))}}return e}function Yh(t,e,n){switch(e.type){case 7:return t.visitTrigger(e,n);case 0:return t.visitState(e,n);case 1:return t.visitTransition(e,n);case 2:return t.visitSequence(e,n);case 3:return t.visitGroup(e,n);case 4:return t.visitAnimate(e,n);case 5:return t.visitKeyframes(e,n);case 6:return t.visitStyle(e,n);case 8:return t.visitReference(e,n);case 9:return t.visitAnimateChild(e,n);case 10:return t.visitAnimateRef(e,n);case 11:return t.visitQuery(e,n);case 12:return t.visitStagger(e,n);default:throw new Error("Unable to resolve animation metadata node #"+e.type)}}function Zh(t,e){return window.getComputedStyle(t)[e]}function Qh(t,e){const n=[];return"string"==typeof t?t.split(/\s*,\s*/).forEach(t=>function(t,e,n){if(":"==t[0]){const r=function(t,e){switch(t){case":enter":return"void => *";case":leave":return"* => void";case":increment":return(t,e)=>parseFloat(e)>parseFloat(t);case":decrement":return(t,e)=>parseFloat(e)<parseFloat(t);default:return e.push(`The transition alias value "${t}" is not supported`),"* => *"}}(t,n);if("function"==typeof r)return void e.push(r);t=r}const r=t.match(/^(\*|[-\w]+)\s*(<?[=-]>)\s*(\*|[-\w]+)$/);if(null==r||r.length<4)return n.push(`The provided transition expression "${t}" is not supported`),e;const i=r[1],o=r[2],a=r[3];e.push(ed(i,a)),"<"!=o[0]||"*"==i&&"*"==a||e.push(ed(a,i))}(t,n,e)):n.push(t),n}const Jh=new Set(["true","1"]),td=new Set(["false","0"]);function ed(t,e){const n=Jh.has(t)||td.has(t),r=Jh.has(e)||td.has(e);return(i,o)=>{let a="*"==t||t==i,s="*"==e||e==o;return!a&&n&&"boolean"==typeof i&&(a=i?Jh.has(t):td.has(t)),!s&&r&&"boolean"==typeof o&&(s=o?Jh.has(e):td.has(e)),a&&s}}const nd=new RegExp("s*:selfs*,?","g");function rd(t,e,n){return new id(t).build(e,n)}class id{constructor(t){this._driver=t}build(t,e){const n=new od(e);return this._resetContextStyleTimingState(n),Yh(this,Uh(t),n)}_resetContextStyleTimingState(t){t.currentQuerySelector="",t.collectedStyles={},t.collectedStyles[""]={},t.currentTime=0}visitTrigger(t,e){let n=e.queryCount=0,r=e.depCount=0;const i=[],o=[];return"@"==t.name.charAt(0)&&e.errors.push("animation triggers cannot be prefixed with an `@` sign (e.g. trigger('@foo', [...]))"),t.definitions.forEach(t=>{if(this._resetContextStyleTimingState(e),0==t.type){const n=t,r=n.name;r.toString().split(/\s*,\s*/).forEach(t=>{n.name=t,i.push(this.visitState(n,e))}),n.name=r}else if(1==t.type){const i=this.visitTransition(t,e);n+=i.queryCount,r+=i.depCount,o.push(i)}else e.errors.push("only state() and transition() definitions can sit inside of a trigger()")}),{type:7,name:t.name,states:i,transitions:o,queryCount:n,depCount:r,options:null}}visitState(t,e){const n=this.visitStyle(t.styles,e),r=t.options&&t.options.params||null;if(n.containsDynamicStyles){const i=new Set,o=r||{};if(n.styles.forEach(t=>{if(ad(t)){const e=t;Object.keys(e).forEach(t=>{Vh(e[t]).forEach(t=>{o.hasOwnProperty(t)||i.add(t)})})}}),i.size){const n=qh(i.values());e.errors.push(`state("${t.name}", ...) must define default values for all the following style substitutions: ${n.join(", ")}`)}}return{type:0,name:t.name,style:n,options:r?{params:r}:null}}visitTransition(t,e){e.queryCount=0,e.depCount=0;const n=Yh(this,Uh(t.animation),e);return{type:1,matchers:Qh(t.expr,e.errors),animation:n,queryCount:e.queryCount,depCount:e.depCount,options:sd(t.options)}}visitSequence(t,e){return{type:2,steps:t.steps.map(t=>Yh(this,t,e)),options:sd(t.options)}}visitGroup(t,e){const n=e.currentTime;let r=0;const i=t.steps.map(t=>{e.currentTime=n;const i=Yh(this,t,e);return r=Math.max(r,e.currentTime),i});return e.currentTime=r,{type:3,steps:i,options:sd(t.options)}}visitAnimate(t,e){const n=function(t,e){let n=null;if(t.hasOwnProperty("duration"))n=t;else if("number"==typeof t)return ud(Mh(t,e).duration,0,"");const r=t;if(r.split(/\s+/).some(t=>"{"==t.charAt(0)&&"{"==t.charAt(1))){const t=ud(0,0,"");return t.dynamic=!0,t.strValue=r,t}return n=n||Mh(r,e),ud(n.duration,n.delay,n.easing)}(t.timings,e.errors);let r;e.currentAnimateTimings=n;let i=t.styles?t.styles:oh({});if(5==i.type)r=this.visitKeyframes(i,e);else{let i=t.styles,o=!1;if(!i){o=!0;const t={};n.easing&&(t.easing=n.easing),i=oh(t)}e.currentTime+=n.duration+n.delay;const a=this.visitStyle(i,e);a.isEmptyStep=o,r=a}return e.currentAnimateTimings=null,{type:4,timings:n,style:r,options:null}}visitStyle(t,e){const n=this._makeStyleAst(t,e);return this._validateStyleAst(n,e),n}_makeStyleAst(t,e){const n=[];Array.isArray(t.styles)?t.styles.forEach(t=>{"string"==typeof t?"*"==t?n.push(t):e.errors.push(`The provided style string value ${t} is not allowed.`):n.push(t)}):n.push(t.styles);let r=!1,i=null;return n.forEach(t=>{if(ad(t)){const e=t,n=e.easing;if(n&&(i=n,delete e.easing),!r)for(let t in e)if(e[t].toString().indexOf("{{")>=0){r=!0;break}}}),{type:6,styles:n,easing:i,offset:t.offset,containsDynamicStyles:r,options:null}}_validateStyleAst(t,e){const n=e.currentAnimateTimings;let r=e.currentTime,i=e.currentTime;n&&i>0&&(i-=n.duration+n.delay),t.styles.forEach(t=>{"string"!=typeof t&&Object.keys(t).forEach(n=>{if(!this._driver.validateStyleProperty(n))return void e.errors.push(`The provided animation property "${n}" is not a supported CSS property for animations`);const o=e.collectedStyles[e.currentQuerySelector],a=o[n];let s=!0;a&&(i!=r&&i>=a.startTime&&r<=a.endTime&&(e.errors.push(`The CSS property "${n}" that exists between the times of "${a.startTime}ms" and "${a.endTime}ms" is also being animated in a parallel animation between the times of "${i}ms" and "${r}ms"`),s=!1),i=a.startTime),s&&(o[n]={startTime:i,endTime:r}),e.options&&function(t,e,n){const r=e.params||{},i=Vh(t);i.length&&i.forEach(t=>{r.hasOwnProperty(t)||n.push(`Unable to resolve the local animation param ${t} in the given list of values`)})}(t[n],e.options,e.errors)})})}visitKeyframes(t,e){const n={type:5,styles:[],options:null};if(!e.currentAnimateTimings)return e.errors.push("keyframes() must be placed inside of a call to animate()"),n;let r=0;const i=[];let o=!1,a=!1,s=0;const u=t.steps.map(t=>{const n=this._makeStyleAst(t,e);let u=null!=n.offset?n.offset:function(t){if("string"==typeof t)return null;let e=null;if(Array.isArray(t))t.forEach(t=>{if(ad(t)&&t.hasOwnProperty("offset")){const n=t;e=parseFloat(n.offset),delete n.offset}});else if(ad(t)&&t.hasOwnProperty("offset")){const n=t;e=parseFloat(n.offset),delete n.offset}return e}(n.styles),l=0;return null!=u&&(r++,l=n.offset=u),a=a||l<0||l>1,o=o||l<s,s=l,i.push(l),n});a&&e.errors.push("Please ensure that all keyframe offsets are between 0 and 1"),o&&e.errors.push("Please ensure that all keyframe offsets are in order");const l=t.steps.length;let c=0;r>0&&r<l?e.errors.push("Not all style() steps within the declared keyframes() contain offsets"):0==r&&(c=1/(l-1));const h=l-1,d=e.currentTime,f=e.currentAnimateTimings,p=f.duration;return u.forEach((t,r)=>{const o=c>0?r==h?1:c*r:i[r],a=o*p;e.currentTime=d+f.delay+a,f.duration=a,this._validateStyleAst(t,e),t.offset=o,n.styles.push(t)}),n}visitReference(t,e){return{type:8,animation:Yh(this,Uh(t.animation),e),options:sd(t.options)}}visitAnimateChild(t,e){return e.depCount++,{type:9,options:sd(t.options)}}visitAnimateRef(t,e){return{type:10,animation:this.visitReference(t.animation,e),options:sd(t.options)}}visitQuery(t,e){const n=e.currentQuerySelector,r=t.options||{};e.queryCount++,e.currentQuery=t;const[i,o]=function(t){const e=!!t.split(/\s*,\s*/).find(t=>":self"==t);return e&&(t=t.replace(nd,"")),[t=t.replace(/@\*/g,".ng-trigger").replace(/@\w+/g,t=>".ng-trigger-"+t.substr(1)).replace(/:animating/g,".ng-animating"),e]}(t.selector);e.currentQuerySelector=n.length?n+" "+i:i,yh(e.collectedStyles,e.currentQuerySelector,{});const a=Yh(this,Uh(t.animation),e);return e.currentQuery=null,e.currentQuerySelector=n,{type:11,selector:i,limit:r.limit||0,optional:!!r.optional,includeSelf:o,animation:a,originalSelector:t.selector,options:sd(t.options)}}visitStagger(t,e){e.currentQuery||e.errors.push("stagger() can only be used inside of query()");const n="full"===t.timings?{duration:0,delay:0,easing:"full"}:Mh(t.timings,e.errors,!0);return{type:12,animation:Yh(this,Uh(t.animation),e),timings:n,options:null}}}class od{constructor(t){this.errors=t,this.queryCount=0,this.depCount=0,this.currentTransition=null,this.currentQuery=null,this.currentQuerySelector=null,this.currentAnimateTimings=null,this.currentTime=0,this.collectedStyles={},this.options=null}}function ad(t){return!Array.isArray(t)&&"object"==typeof t}function sd(t){var e;return t?(t=Fh(t)).params&&(t.params=(e=t.params)?Fh(e):null):t={},t}function ud(t,e,n){return{duration:t,delay:e,easing:n}}function ld(t,e,n,r,i,o,a=null,s=!1){return{type:1,element:t,keyframes:e,preStyleProps:n,postStyleProps:r,duration:i,delay:o,totalTime:i+o,easing:a,subTimeline:s}}class cd{constructor(){this._map=new Map}consume(t){let e=this._map.get(t);return e?this._map.delete(t):e=[],e}append(t,e){let n=this._map.get(t);n||this._map.set(t,n=[]),n.push(...e)}has(t){return this._map.has(t)}clear(){this._map.clear()}}const hd=new RegExp(":enter","g"),dd=new RegExp(":leave","g");function fd(t,e,n,r,i,o={},a={},s,u,l=[]){return(new pd).buildKeyframes(t,e,n,r,i,o,a,s,u,l)}class pd{buildKeyframes(t,e,n,r,i,o,a,s,u,l=[]){u=u||new cd;const c=new gd(t,e,u,r,i,l,[]);c.options=s,c.currentTimeline.setStyles([o],null,c.errors,s),Yh(this,n,c);const h=c.timelines.filter(t=>t.containsAnimation());if(h.length&&Object.keys(a).length){const t=h[h.length-1];t.allowOnlyTimelineStyles()||t.setStyles([a],null,c.errors,s)}return h.length?h.map(t=>t.buildKeyframes()):[ld(e,[],[],[],0,0,"",!1)]}visitTrigger(t,e){}visitState(t,e){}visitTransition(t,e){}visitAnimateChild(t,e){const n=e.subInstructions.consume(e.element);if(n){const r=e.createSubContext(t.options),i=e.currentTimeline.currentTime,o=this._visitSubInstructions(n,r,r.options);i!=o&&e.transformIntoNewTimeline(o)}e.previousNode=t}visitAnimateRef(t,e){const n=e.createSubContext(t.options);n.transformIntoNewTimeline(),this.visitReference(t.animation,n),e.transformIntoNewTimeline(n.currentTimeline.currentTime),e.previousNode=t}_visitSubInstructions(t,e,n){let r=e.currentTimeline.currentTime;const i=null!=n.duration?Rh(n.duration):null,o=null!=n.delay?Rh(n.delay):null;return 0!==i&&t.forEach(t=>{const n=e.appendInstructionToTimeline(t,i,o);r=Math.max(r,n.duration+n.delay)}),r}visitReference(t,e){e.updateOptions(t.options,!0),Yh(this,t.animation,e),e.previousNode=t}visitSequence(t,e){const n=e.subContextCount;let r=e;const i=t.options;if(i&&(i.params||i.delay)&&(r=e.createSubContext(i),r.transformIntoNewTimeline(),null!=i.delay)){6==r.previousNode.type&&(r.currentTimeline.snapshotCurrentStyles(),r.previousNode=md);const t=Rh(i.delay);r.delayNextStep(t)}t.steps.length&&(t.steps.forEach(t=>Yh(this,t,r)),r.currentTimeline.applyStylesToKeyframe(),r.subContextCount>n&&r.transformIntoNewTimeline()),e.previousNode=t}visitGroup(t,e){const n=[];let r=e.currentTimeline.currentTime;const i=t.options&&t.options.delay?Rh(t.options.delay):0;t.steps.forEach(o=>{const a=e.createSubContext(t.options);i&&a.delayNextStep(i),Yh(this,o,a),r=Math.max(r,a.currentTimeline.currentTime),n.push(a.currentTimeline)}),n.forEach(t=>e.currentTimeline.mergeTimelineCollectedStyles(t)),e.transformIntoNewTimeline(r),e.previousNode=t}_visitTiming(t,e){if(t.dynamic){const n=t.strValue;return Mh(e.params?Wh(n,e.params,e.errors):n,e.errors)}return{duration:t.duration,delay:t.delay,easing:t.easing}}visitAnimate(t,e){const n=e.currentAnimateTimings=this._visitTiming(t.timings,e),r=e.currentTimeline;n.delay&&(e.incrementTime(n.delay),r.snapshotCurrentStyles());const i=t.style;5==i.type?this.visitKeyframes(i,e):(e.incrementTime(n.duration),this.visitStyle(i,e),r.applyStylesToKeyframe()),e.currentAnimateTimings=null,e.previousNode=t}visitStyle(t,e){const n=e.currentTimeline,r=e.currentAnimateTimings;!r&&n.getCurrentStyleProperties().length&&n.forwardFrame();const i=r&&r.easing||t.easing;t.isEmptyStep?n.applyEmptyStep(i):n.setStyles(t.styles,i,e.errors,e.options),e.previousNode=t}visitKeyframes(t,e){const n=e.currentAnimateTimings,r=e.currentTimeline.duration,i=n.duration,o=e.createSubContext().currentTimeline;o.easing=n.easing,t.styles.forEach(t=>{o.forwardTime((t.offset||0)*i),o.setStyles(t.styles,t.easing,e.errors,e.options),o.applyStylesToKeyframe()}),e.currentTimeline.mergeTimelineCollectedStyles(o),e.transformIntoNewTimeline(r+i),e.previousNode=t}visitQuery(t,e){const n=e.currentTimeline.currentTime,r=t.options||{},i=r.delay?Rh(r.delay):0;i&&(6===e.previousNode.type||0==n&&e.currentTimeline.getCurrentStyleProperties().length)&&(e.currentTimeline.snapshotCurrentStyles(),e.previousNode=md);let o=n;const a=e.invokeQuery(t.selector,t.originalSelector,t.limit,t.includeSelf,!!r.optional,e.errors);e.currentQueryTotal=a.length;let s=null;a.forEach((n,r)=>{e.currentQueryIndex=r;const a=e.createSubContext(t.options,n);i&&a.delayNextStep(i),n===e.element&&(s=a.currentTimeline),Yh(this,t.animation,a),a.currentTimeline.applyStylesToKeyframe(),o=Math.max(o,a.currentTimeline.currentTime)}),e.currentQueryIndex=0,e.currentQueryTotal=0,e.transformIntoNewTimeline(o),s&&(e.currentTimeline.mergeTimelineCollectedStyles(s),e.currentTimeline.snapshotCurrentStyles()),e.previousNode=t}visitStagger(t,e){const n=e.parentContext,r=e.currentTimeline,i=t.timings,o=Math.abs(i.duration),a=o*(e.currentQueryTotal-1);let s=o*e.currentQueryIndex;switch(i.duration<0?"reverse":i.easing){case"reverse":s=a-s;break;case"full":s=n.currentStaggerTime}const u=e.currentTimeline;s&&u.delayNextStep(s);const l=u.currentTime;Yh(this,t.animation,e),e.previousNode=t,n.currentStaggerTime=r.currentTime-l+(r.startTime-n.currentTimeline.startTime)}}const md={};class gd{constructor(t,e,n,r,i,o,a,s){this._driver=t,this.element=e,this.subInstructions=n,this._enterClassName=r,this._leaveClassName=i,this.errors=o,this.timelines=a,this.parentContext=null,this.currentAnimateTimings=null,this.previousNode=md,this.subContextCount=0,this.options={},this.currentQueryIndex=0,this.currentQueryTotal=0,this.currentStaggerTime=0,this.currentTimeline=s||new yd(this._driver,e,0),a.push(this.currentTimeline)}get params(){return this.options.params}updateOptions(t,e){if(!t)return;const n=t;let r=this.options;null!=n.duration&&(r.duration=Rh(n.duration)),null!=n.delay&&(r.delay=Rh(n.delay));const i=n.params;if(i){let t=r.params;t||(t=this.options.params={}),Object.keys(i).forEach(n=>{e&&t.hasOwnProperty(n)||(t[n]=Wh(i[n],t,this.errors))})}}_copyOptions(){const t={};if(this.options){const e=this.options.params;if(e){const n=t.params={};Object.keys(e).forEach(t=>{n[t]=e[t]})}}return t}createSubContext(t=null,e,n){const r=e||this.element,i=new gd(this._driver,r,this.subInstructions,this._enterClassName,this._leaveClassName,this.errors,this.timelines,this.currentTimeline.fork(r,n||0));return i.previousNode=this.previousNode,i.currentAnimateTimings=this.currentAnimateTimings,i.options=this._copyOptions(),i.updateOptions(t),i.currentQueryIndex=this.currentQueryIndex,i.currentQueryTotal=this.currentQueryTotal,i.parentContext=this,this.subContextCount++,i}transformIntoNewTimeline(t){return this.previousNode=md,this.currentTimeline=this.currentTimeline.fork(this.element,t),this.timelines.push(this.currentTimeline),this.currentTimeline}appendInstructionToTimeline(t,e,n){const r={duration:null!=e?e:t.duration,delay:this.currentTimeline.currentTime+(null!=n?n:0)+t.delay,easing:""},i=new vd(this._driver,t.element,t.keyframes,t.preStyleProps,t.postStyleProps,r,t.stretchStartingKeyframe);return this.timelines.push(i),r}incrementTime(t){this.currentTimeline.forwardTime(this.currentTimeline.duration+t)}delayNextStep(t){t>0&&this.currentTimeline.delayNextStep(t)}invokeQuery(t,e,n,r,i,o){let a=[];if(r&&a.push(this.element),t.length>0){t=(t=t.replace(hd,"."+this._enterClassName)).replace(dd,"."+this._leaveClassName);let e=this._driver.query(this.element,t,1!=n);0!==n&&(e=n<0?e.slice(e.length+n,e.length):e.slice(0,n)),a.push(...e)}return i||0!=a.length||o.push(`\`query("${e}")\` returned zero elements. (Use \`query("${e}", { optional: true })\` if you wish to allow this.)`),a}}class yd{constructor(t,e,n,r){this._driver=t,this.element=e,this.startTime=n,this._elementTimelineStylesLookup=r,this.duration=0,this._previousKeyframe={},this._currentKeyframe={},this._keyframes=new Map,this._styleSummary={},this._pendingStyles={},this._backFill={},this._currentEmptyStepKeyframe=null,this._elementTimelineStylesLookup||(this._elementTimelineStylesLookup=new Map),this._localTimelineStyles=Object.create(this._backFill,{}),this._globalTimelineStyles=this._elementTimelineStylesLookup.get(e),this._globalTimelineStyles||(this._globalTimelineStyles=this._localTimelineStyles,this._elementTimelineStylesLookup.set(e,this._localTimelineStyles)),this._loadKeyframe()}containsAnimation(){switch(this._keyframes.size){case 0:return!1;case 1:return this.getCurrentStyleProperties().length>0;default:return!0}}getCurrentStyleProperties(){return Object.keys(this._currentKeyframe)}get currentTime(){return this.startTime+this.duration}delayNextStep(t){const e=1==this._keyframes.size&&Object.keys(this._pendingStyles).length;this.duration||e?(this.forwardTime(this.currentTime+t),e&&this.snapshotCurrentStyles()):this.startTime+=t}fork(t,e){return this.applyStylesToKeyframe(),new yd(this._driver,t,e||this.currentTime,this._elementTimelineStylesLookup)}_loadKeyframe(){this._currentKeyframe&&(this._previousKeyframe=this._currentKeyframe),this._currentKeyframe=this._keyframes.get(this.duration),this._currentKeyframe||(this._currentKeyframe=Object.create(this._backFill,{}),this._keyframes.set(this.duration,this._currentKeyframe))}forwardFrame(){this.duration+=1,this._loadKeyframe()}forwardTime(t){this.applyStylesToKeyframe(),this.duration=t,this._loadKeyframe()}_updateStyle(t,e){this._localTimelineStyles[t]=e,this._globalTimelineStyles[t]=e,this._styleSummary[t]={time:this.currentTime,value:e}}allowOnlyTimelineStyles(){return this._currentEmptyStepKeyframe!==this._currentKeyframe}applyEmptyStep(t){t&&(this._previousKeyframe.easing=t),Object.keys(this._globalTimelineStyles).forEach(t=>{this._backFill[t]=this._globalTimelineStyles[t]||"*",this._currentKeyframe[t]="*"}),this._currentEmptyStepKeyframe=this._currentKeyframe}setStyles(t,e,n,r){e&&(this._previousKeyframe.easing=e);const i=r&&r.params||{},o=function(t,e){const n={};let r;return t.forEach(t=>{"*"===t?(r=r||Object.keys(e),r.forEach(t=>{n[t]="*"})):Ph(t,!1,n)}),n}(t,this._globalTimelineStyles);Object.keys(o).forEach(t=>{const e=Wh(o[t],i,n);this._pendingStyles[t]=e,this._localTimelineStyles.hasOwnProperty(t)||(this._backFill[t]=this._globalTimelineStyles.hasOwnProperty(t)?this._globalTimelineStyles[t]:"*"),this._updateStyle(t,e)})}applyStylesToKeyframe(){const t=this._pendingStyles,e=Object.keys(t);0!=e.length&&(this._pendingStyles={},e.forEach(e=>{this._currentKeyframe[e]=t[e]}),Object.keys(this._localTimelineStyles).forEach(t=>{this._currentKeyframe.hasOwnProperty(t)||(this._currentKeyframe[t]=this._localTimelineStyles[t])}))}snapshotCurrentStyles(){Object.keys(this._localTimelineStyles).forEach(t=>{const e=this._localTimelineStyles[t];this._pendingStyles[t]=e,this._updateStyle(t,e)})}getFinalKeyframe(){return this._keyframes.get(this.duration)}get properties(){const t=[];for(let e in this._currentKeyframe)t.push(e);return t}mergeTimelineCollectedStyles(t){Object.keys(t._styleSummary).forEach(e=>{const n=this._styleSummary[e],r=t._styleSummary[e];(!n||r.time>n.time)&&this._updateStyle(e,r.value)})}buildKeyframes(){this.applyStylesToKeyframe();const t=new Set,e=new Set,n=1===this._keyframes.size&&0===this.duration;let r=[];this._keyframes.forEach((i,o)=>{const a=Ph(i,!0);Object.keys(a).forEach(n=>{const r=a[n];"!"==r?t.add(n):"*"==r&&e.add(n)}),n||(a.offset=o/this.duration),r.push(a)});const i=t.size?qh(t.values()):[],o=e.size?qh(e.values()):[];if(n){const t=r[0],e=Fh(t);t.offset=0,e.offset=1,r=[t,e]}return ld(this.element,r,i,o,this.duration,this.startTime,this.easing,!1)}}class vd extends yd{constructor(t,e,n,r,i,o,a=!1){super(t,e,o.delay),this.element=e,this.keyframes=n,this.preStyleProps=r,this.postStyleProps=i,this._stretchStartingKeyframe=a,this.timings={duration:o.duration,delay:o.delay,easing:o.easing}}containsAnimation(){return this.keyframes.length>1}buildKeyframes(){let t=this.keyframes,{delay:e,duration:n,easing:r}=this.timings;if(this._stretchStartingKeyframe&&e){const i=[],o=n+e,a=e/o,s=Ph(t[0],!1);s.offset=0,i.push(s);const u=Ph(t[0],!1);u.offset=bd(a),i.push(u);const l=t.length-1;for(let r=1;r<=l;r++){let a=Ph(t[r],!1);a.offset=bd((e+a.offset*n)/o),i.push(a)}n=o,e=0,r="",t=i}return ld(this.element,t,this.preStyleProps,this.postStyleProps,n,e,r,!0)}}function bd(t,e=3){const n=Math.pow(10,e-1);return Math.round(t*n)/n}class wd{}class xd extends wd{normalizePropertyName(t,e){return Gh(t)}normalizeStyleValue(t,e,n,r){let i="";const o=n.toString().trim();if(_d[e]&&0!==n&&"0"!==n)if("number"==typeof n)i="px";else{const e=n.match(/^[+-]?[\d\.]+([a-z]*)$/);e&&0==e[1].length&&r.push(`Please provide a CSS unit value for ${t}:${n}`)}return o+i}}const _d=(()=>function(t){const e={};return t.forEach(t=>e[t]=!0),e}("width,height,minWidth,minHeight,maxWidth,maxHeight,left,top,bottom,right,fontSize,outlineWidth,outlineOffset,paddingTop,paddingLeft,paddingBottom,paddingRight,marginTop,marginLeft,marginBottom,marginRight,borderRadius,borderWidth,borderTopWidth,borderLeftWidth,borderRightWidth,borderBottomWidth,textIndent,perspective".split(",")))();function Cd(t,e,n,r,i,o,a,s,u,l,c,h,d){return{type:0,element:t,triggerName:e,isRemovalTransition:i,fromState:n,fromStyles:o,toState:r,toStyles:a,timelines:s,queriedElements:u,preStyleProps:l,postStyleProps:c,totalTime:h,errors:d}}const kd={};class Sd{constructor(t,e,n){this._triggerName=t,this.ast=e,this._stateStyles=n}match(t,e,n,r){return function(t,e,n,r,i){return t.some(t=>t(e,n,r,i))}(this.ast.matchers,t,e,n,r)}buildStyles(t,e,n){const r=this._stateStyles["*"],i=this._stateStyles[t],o=r?r.buildStyles(e,n):{};return i?i.buildStyles(e,n):o}build(t,e,n,r,i,o,a,s,u,l){const c=[],h=this.ast.options&&this.ast.options.params||kd,d=this.buildStyles(n,a&&a.params||kd,c),f=s&&s.params||kd,p=this.buildStyles(r,f,c),m=new Set,g=new Map,y=new Map,v="void"===r,b={params:Object.assign(Object.assign({},h),f)},w=l?[]:fd(t,e,this.ast.animation,i,o,d,p,b,u,c);let x=0;if(w.forEach(t=>{x=Math.max(t.duration+t.delay,x)}),c.length)return Cd(e,this._triggerName,n,r,v,d,p,[],[],g,y,x,c);w.forEach(t=>{const n=t.element,r=yh(g,n,{});t.preStyleProps.forEach(t=>r[t]=!0);const i=yh(y,n,{});t.postStyleProps.forEach(t=>i[t]=!0),n!==e&&m.add(n)});const _=qh(m.values());return Cd(e,this._triggerName,n,r,v,d,p,w,_,g,y,x)}}class Ed{constructor(t,e){this.styles=t,this.defaultParams=e}buildStyles(t,e){const n={},r=Fh(this.defaultParams);return Object.keys(t).forEach(e=>{const n=t[e];null!=n&&(r[e]=n)}),this.styles.styles.forEach(t=>{if("string"!=typeof t){const i=t;Object.keys(i).forEach(t=>{let o=i[t];o.length>1&&(o=Wh(o,r,e)),n[t]=o})}}),n}}class Od{constructor(t,e){this.name=t,this.ast=e,this.transitionFactories=[],this.states={},e.states.forEach(t=>{this.states[t.name]=new Ed(t.style,t.options&&t.options.params||{})}),Ad(this.states,"true","1"),Ad(this.states,"false","0"),e.transitions.forEach(e=>{this.transitionFactories.push(new Sd(t,e,this.states))}),this.fallbackTransition=new Sd(t,{type:1,animation:{type:2,steps:[],options:null},matchers:[(t,e)=>!0],options:null,queryCount:0,depCount:0},this.states)}get containsQueries(){return this.ast.queryCount>0}matchTransition(t,e,n,r){return this.transitionFactories.find(i=>i.match(t,e,n,r))||null}matchStyles(t,e,n){return this.fallbackTransition.buildStyles(t,e,n)}}function Ad(t,e,n){t.hasOwnProperty(e)?t.hasOwnProperty(n)||(t[n]=t[e]):t.hasOwnProperty(n)&&(t[e]=t[n])}const Nd=new cd;class Td{constructor(t,e,n){this.bodyNode=t,this._driver=e,this._normalizer=n,this._animations={},this._playersById={},this.players=[]}register(t,e){const n=[],r=rd(this._driver,e,n);if(n.length)throw new Error("Unable to build the animation due to the following errors: "+n.join("\n"));this._animations[t]=r}_buildPlayer(t,e,n){const r=t.element,i=fh(0,this._normalizer,0,t.keyframes,e,n);return this._driver.animate(r,i,t.duration,t.delay,t.easing,[],!0)}create(t,e,n={}){const r=[],i=this._animations[t];let o;const a=new Map;if(i?(o=fd(this._driver,e,i,"ng-enter","ng-leave",{},{},n,Nd,r),o.forEach(t=>{const e=yh(a,t.element,{});t.postStyleProps.forEach(t=>e[t]=null)})):(r.push("The requested animation doesn't exist or has already been destroyed"),o=[]),r.length)throw new Error("Unable to create the animation due to the following errors: "+r.join("\n"));a.forEach((t,e)=>{Object.keys(t).forEach(n=>{t[n]=this._driver.computeStyle(e,n,"*")})});const s=dh(o.map(t=>{const e=a.get(t.element);return this._buildPlayer(t,{},e)}));return this._playersById[t]=s,s.onDestroy(()=>this.destroy(t)),this.players.push(s),s}destroy(t){const e=this._getPlayer(t);e.destroy(),delete this._playersById[t];const n=this.players.indexOf(e);n>=0&&this.players.splice(n,1)}_getPlayer(t){const e=this._playersById[t];if(!e)throw new Error("Unable to find the timeline player referenced by "+t);return e}listen(t,e,n,r){const i=gh(e,"","","");return ph(this._getPlayer(t),n,i,r),()=>{}}command(t,e,n,r){if("register"==n)return void this.register(t,r[0]);if("create"==n)return void this.create(t,e,r[0]||{});const i=this._getPlayer(t);switch(n){case"play":i.play();break;case"pause":i.pause();break;case"reset":i.reset();break;case"restart":i.restart();break;case"finish":i.finish();break;case"init":i.init();break;case"setPosition":i.setPosition(parseFloat(r[0]));break;case"destroy":this.destroy(t)}}}const Dd=[],Rd={namespaceId:"",setForRemoval:!1,setForMove:!1,hasAnimation:!1,removedBeforeQueried:!1},Id={namespaceId:"",setForMove:!1,setForRemoval:!1,hasAnimation:!1,removedBeforeQueried:!0};class Md{constructor(t,e=""){this.namespaceId=e;const n=t&&t.hasOwnProperty("value");if(this.value=null!=(r=n?t.value:t)?r:null,n){const e=Fh(t);delete e.value,this.options=e}else this.options={};var r;this.options.params||(this.options.params={})}get params(){return this.options.params}absorbOptions(t){const e=t.params;if(e){const t=this.options.params;Object.keys(e).forEach(n=>{null==t[n]&&(t[n]=e[n])})}}}const Fd=new Md("void");class Pd{constructor(t,e,n){this.id=t,this.hostElement=e,this._engine=n,this.players=[],this._triggers={},this._queue=[],this._elementListeners=new Map,this._hostClassName="ng-tns-"+t,Vd(e,this._hostClassName)}listen(t,e,n,r){if(!this._triggers.hasOwnProperty(e))throw new Error(`Unable to listen on the animation trigger event "${n}" because the animation trigger "${e}" doesn't exist!`);if(null==n||0==n.length)throw new Error(`Unable to listen on the animation trigger "${e}" because the provided event is undefined!`);if("start"!=(i=n)&&"done"!=i)throw new Error(`The provided animation trigger event "${n}" for the animation trigger "${e}" is not supported!`);var i;const o=yh(this._elementListeners,t,[]),a={name:e,phase:n,callback:r};o.push(a);const s=yh(this._engine.statesByElement,t,{});return s.hasOwnProperty(e)||(Vd(t,"ng-trigger"),Vd(t,"ng-trigger-"+e),s[e]=Fd),()=>{this._engine.afterFlush(()=>{const t=o.indexOf(a);t>=0&&o.splice(t,1),this._triggers[e]||delete s[e]})}}register(t,e){return!this._triggers[t]&&(this._triggers[t]=e,!0)}_getTrigger(t){const e=this._triggers[t];if(!e)throw new Error(`The provided animation trigger "${t}" has not been registered!`);return e}trigger(t,e,n,r=!0){const i=this._getTrigger(e),o=new zd(this.id,e,t);let a=this._engine.statesByElement.get(t);a||(Vd(t,"ng-trigger"),Vd(t,"ng-trigger-"+e),this._engine.statesByElement.set(t,a={}));let s=a[e];const u=new Md(n,this.id);if(!(n&&n.hasOwnProperty("value"))&&s&&u.absorbOptions(s.options),a[e]=u,s||(s=Fd),"void"!==u.value&&s.value===u.value){if(!function(t,e){const n=Object.keys(t),r=Object.keys(e);if(n.length!=r.length)return!1;for(let i=0;i<n.length;i++){const r=n[i];if(!e.hasOwnProperty(r)||t[r]!==e[r])return!1}return!0}(s.params,u.params)){const e=[],n=i.matchStyles(s.value,s.params,e),r=i.matchStyles(u.value,u.params,e);e.length?this._engine.reportError(e):this._engine.afterFlush(()=>{Bh(t,n),Lh(t,r)})}return}const l=yh(this._engine.playersByElement,t,[]);l.forEach(t=>{t.namespaceId==this.id&&t.triggerName==e&&t.queued&&t.destroy()});let c=i.matchTransition(s.value,u.value,t,u.params),h=!1;if(!c){if(!r)return;c=i.fallbackTransition,h=!0}return this._engine.totalQueuedPlayers++,this._queue.push({element:t,triggerName:e,transition:c,fromState:s,toState:u,player:o,isFallbackTransition:h}),h||(Vd(t,"ng-animate-queued"),o.onStart(()=>{Wd(t,"ng-animate-queued")})),o.onDone(()=>{let e=this.players.indexOf(o);e>=0&&this.players.splice(e,1);const n=this._engine.playersByElement.get(t);if(n){let t=n.indexOf(o);t>=0&&n.splice(t,1)}}),this.players.push(o),l.push(o),o}deregister(t){delete this._triggers[t],this._engine.statesByElement.forEach((e,n)=>{delete e[t]}),this._elementListeners.forEach((e,n)=>{this._elementListeners.set(n,e.filter(e=>e.name!=t))})}clearElementCache(t){this._engine.statesByElement.delete(t),this._elementListeners.delete(t);const e=this._engine.playersByElement.get(t);e&&(e.forEach(t=>t.destroy()),this._engine.playersByElement.delete(t))}_signalRemovalForInnerTriggers(t,e){const n=this._engine.driver.query(t,".ng-trigger",!0);n.forEach(t=>{if(t.__ng_removed)return;const n=this._engine.fetchNamespacesByElement(t);n.size?n.forEach(n=>n.triggerLeaveAnimation(t,e,!1,!0)):this.clearElementCache(t)}),this._engine.afterFlushAnimationsDone(()=>n.forEach(t=>this.clearElementCache(t)))}triggerLeaveAnimation(t,e,n,r){const i=this._engine.statesByElement.get(t);if(i){const o=[];if(Object.keys(i).forEach(e=>{if(this._triggers[e]){const n=this.trigger(t,e,"void",r);n&&o.push(n)}}),o.length)return this._engine.markElementAsRemoved(this.id,t,!0,e),n&&dh(o).onDone(()=>this._engine.processLeaveNode(t)),!0}return!1}prepareLeaveAnimationListeners(t){const e=this._elementListeners.get(t);if(e){const n=new Set;e.forEach(e=>{const r=e.name;if(n.has(r))return;n.add(r);const i=this._triggers[r].fallbackTransition,o=this._engine.statesByElement.get(t)[r]||Fd,a=new Md("void"),s=new zd(this.id,r,t);this._engine.totalQueuedPlayers++,this._queue.push({element:t,triggerName:r,transition:i,fromState:o,toState:a,player:s,isFallbackTransition:!0})})}}removeNode(t,e){const n=this._engine;if(t.childElementCount&&this._signalRemovalForInnerTriggers(t,e),this.triggerLeaveAnimation(t,e,!0))return;let r=!1;if(n.totalAnimations){const e=n.players.length?n.playersByQueriedElement.get(t):[];if(e&&e.length)r=!0;else{let e=t;for(;e=e.parentNode;)if(n.statesByElement.get(e)){r=!0;break}}}if(this.prepareLeaveAnimationListeners(t),r)n.markElementAsRemoved(this.id,t,!1,e);else{const r=t.__ng_removed;r&&r!==Rd||(n.afterFlush(()=>this.clearElementCache(t)),n.destroyInnerAnimations(t),n._onRemovalComplete(t,e))}}insertNode(t,e){Vd(t,this._hostClassName)}drainQueuedTransitions(t){const e=[];return this._queue.forEach(n=>{const r=n.player;if(r.destroyed)return;const i=n.element,o=this._elementListeners.get(i);o&&o.forEach(e=>{if(e.name==n.triggerName){const r=gh(i,n.triggerName,n.fromState.value,n.toState.value);r._data=t,ph(n.player,e.phase,r,e.callback)}}),r.markedForDestroy?this._engine.afterFlush(()=>{r.destroy()}):e.push(n)}),this._queue=[],e.sort((t,e)=>{const n=t.transition.ast.depCount,r=e.transition.ast.depCount;return 0==n||0==r?n-r:this._engine.driver.containsElement(t.element,e.element)?1:-1})}destroy(t){this.players.forEach(t=>t.destroy()),this._signalRemovalForInnerTriggers(this.hostElement,t)}elementContainsData(t){let e=!1;return this._elementListeners.has(t)&&(e=!0),e=!!this._queue.find(e=>e.element===t)||e,e}}class jd{constructor(t,e,n){this.bodyNode=t,this.driver=e,this._normalizer=n,this.players=[],this.newHostElements=new Map,this.playersByElement=new Map,this.playersByQueriedElement=new Map,this.statesByElement=new Map,this.disabledNodes=new Set,this.totalAnimations=0,this.totalQueuedPlayers=0,this._namespaceLookup={},this._namespaceList=[],this._flushFns=[],this._whenQuietFns=[],this.namespacesByHostElement=new Map,this.collectedEnterElements=[],this.collectedLeaveElements=[],this.onRemovalComplete=(t,e)=>{}}_onRemovalComplete(t,e){this.onRemovalComplete(t,e)}get queuedPlayers(){const t=[];return this._namespaceList.forEach(e=>{e.players.forEach(e=>{e.queued&&t.push(e)})}),t}createNamespace(t,e){const n=new Pd(t,e,this);return e.parentNode?this._balanceNamespaceList(n,e):(this.newHostElements.set(e,n),this.collectEnterElement(e)),this._namespaceLookup[t]=n}_balanceNamespaceList(t,e){const n=this._namespaceList.length-1;if(n>=0){let r=!1;for(let i=n;i>=0;i--)if(this.driver.containsElement(this._namespaceList[i].hostElement,e)){this._namespaceList.splice(i+1,0,t),r=!0;break}r||this._namespaceList.splice(0,0,t)}else this._namespaceList.push(t);return this.namespacesByHostElement.set(e,t),t}register(t,e){let n=this._namespaceLookup[t];return n||(n=this.createNamespace(t,e)),n}registerTrigger(t,e,n){let r=this._namespaceLookup[t];r&&r.register(e,n)&&this.totalAnimations++}destroy(t,e){if(!t)return;const n=this._fetchNamespace(t);this.afterFlush(()=>{this.namespacesByHostElement.delete(n.hostElement),delete this._namespaceLookup[t];const e=this._namespaceList.indexOf(n);e>=0&&this._namespaceList.splice(e,1)}),this.afterFlushAnimationsDone(()=>n.destroy(e))}_fetchNamespace(t){return this._namespaceLookup[t]}fetchNamespacesByElement(t){const e=new Set,n=this.statesByElement.get(t);if(n){const t=Object.keys(n);for(let r=0;r<t.length;r++){const i=n[t[r]].namespaceId;if(i){const t=this._fetchNamespace(i);t&&e.add(t)}}}return e}trigger(t,e,n,r){if(Ld(e)){const i=this._fetchNamespace(t);if(i)return i.trigger(e,n,r),!0}return!1}insertNode(t,e,n,r){if(!Ld(e))return;const i=e.__ng_removed;if(i&&i.setForRemoval){i.setForRemoval=!1,i.setForMove=!0;const t=this.collectedLeaveElements.indexOf(e);t>=0&&this.collectedLeaveElements.splice(t,1)}if(t){const r=this._fetchNamespace(t);r&&r.insertNode(e,n)}r&&this.collectEnterElement(e)}collectEnterElement(t){this.collectedEnterElements.push(t)}markElementAsDisabled(t,e){e?this.disabledNodes.has(t)||(this.disabledNodes.add(t),Vd(t,"ng-animate-disabled")):this.disabledNodes.has(t)&&(this.disabledNodes.delete(t),Wd(t,"ng-animate-disabled"))}removeNode(t,e,n,r){if(Ld(e)){const i=t?this._fetchNamespace(t):null;if(i?i.removeNode(e,r):this.markElementAsRemoved(t,e,!1,r),n){const n=this.namespacesByHostElement.get(e);n&&n.id!==t&&n.removeNode(e,r)}}else this._onRemovalComplete(e,r)}markElementAsRemoved(t,e,n,r){this.collectedLeaveElements.push(e),e.__ng_removed={namespaceId:t,setForRemoval:r,hasAnimation:n,removedBeforeQueried:!1}}listen(t,e,n,r,i){return Ld(e)?this._fetchNamespace(t).listen(e,n,r,i):()=>{}}_buildInstruction(t,e,n,r,i){return t.transition.build(this.driver,t.element,t.fromState.value,t.toState.value,n,r,t.fromState.options,t.toState.options,e,i)}destroyInnerAnimations(t){let e=this.driver.query(t,".ng-trigger",!0);e.forEach(t=>this.destroyActiveAnimationsForElement(t)),0!=this.playersByQueriedElement.size&&(e=this.driver.query(t,".ng-animating",!0),e.forEach(t=>this.finishActiveQueriedAnimationOnElement(t)))}destroyActiveAnimationsForElement(t){const e=this.playersByElement.get(t);e&&e.forEach(t=>{t.queued?t.markedForDestroy=!0:t.destroy()})}finishActiveQueriedAnimationOnElement(t){const e=this.playersByQueriedElement.get(t);e&&e.forEach(t=>t.finish())}whenRenderingDone(){return new Promise(t=>{if(this.players.length)return dh(this.players).onDone(()=>t());t()})}processLeaveNode(t){const e=t.__ng_removed;if(e&&e.setForRemoval){if(t.__ng_removed=Rd,e.namespaceId){this.destroyInnerAnimations(t);const n=this._fetchNamespace(e.namespaceId);n&&n.clearElementCache(t)}this._onRemovalComplete(t,e.setForRemoval)}this.driver.matchesElement(t,".ng-animate-disabled")&&this.markElementAsDisabled(t,!1),this.driver.query(t,".ng-animate-disabled",!0).forEach(t=>{this.markElementAsDisabled(t,!1)})}flush(t=-1){let e=[];if(this.newHostElements.size&&(this.newHostElements.forEach((t,e)=>this._balanceNamespaceList(t,e)),this.newHostElements.clear()),this.totalAnimations&&this.collectedEnterElements.length)for(let n=0;n<this.collectedEnterElements.length;n++)Vd(this.collectedEnterElements[n],"ng-star-inserted");if(this._namespaceList.length&&(this.totalQueuedPlayers||this.collectedLeaveElements.length)){const n=[];try{e=this._flushAnimations(n,t)}finally{for(let t=0;t<n.length;t++)n[t]()}}else for(let n=0;n<this.collectedLeaveElements.length;n++)this.processLeaveNode(this.collectedLeaveElements[n]);if(this.totalQueuedPlayers=0,this.collectedEnterElements.length=0,this.collectedLeaveElements.length=0,this._flushFns.forEach(t=>t()),this._flushFns=[],this._whenQuietFns.length){const t=this._whenQuietFns;this._whenQuietFns=[],e.length?dh(e).onDone(()=>{t.forEach(t=>t())}):t.forEach(t=>t())}}reportError(t){throw new Error("Unable to process animations due to the following failed trigger transitions\n "+t.join("\n"))}_flushAnimations(t,e){const n=new cd,r=[],i=new Map,o=[],a=new Map,s=new Map,u=new Map,l=new Set;this.disabledNodes.forEach(t=>{l.add(t);const e=this.driver.query(t,".ng-animate-queued",!0);for(let n=0;n<e.length;n++)l.add(e[n])});const c=this.bodyNode,h=Array.from(this.statesByElement.keys()),d=$d(h,this.collectedEnterElements),f=new Map;let p=0;d.forEach((t,e)=>{const n="ng-enter"+p++;f.set(e,n),t.forEach(t=>Vd(t,n))});const m=[],g=new Set,y=new Set;for(let T=0;T<this.collectedLeaveElements.length;T++){const t=this.collectedLeaveElements[T],e=t.__ng_removed;e&&e.setForRemoval&&(m.push(t),g.add(t),e.hasAnimation?this.driver.query(t,".ng-star-inserted",!0).forEach(t=>g.add(t)):y.add(t))}const v=new Map,b=$d(h,Array.from(g));b.forEach((t,e)=>{const n="ng-leave"+p++;v.set(e,n),t.forEach(t=>Vd(t,n))}),t.push(()=>{d.forEach((t,e)=>{const n=f.get(e);t.forEach(t=>Wd(t,n))}),b.forEach((t,e)=>{const n=v.get(e);t.forEach(t=>Wd(t,n))}),m.forEach(t=>{this.processLeaveNode(t)})});const w=[],x=[];for(let T=this._namespaceList.length-1;T>=0;T--)this._namespaceList[T].drainQueuedTransitions(e).forEach(t=>{const e=t.player,i=t.element;if(w.push(e),this.collectedEnterElements.length){const t=i.__ng_removed;if(t&&t.setForMove)return void e.destroy()}const l=!c||!this.driver.containsElement(c,i),h=v.get(i),d=f.get(i),p=this._buildInstruction(t,n,d,h,l);if(p.errors&&p.errors.length)x.push(p);else{if(l)return e.onStart(()=>Bh(i,p.fromStyles)),e.onDestroy(()=>Lh(i,p.toStyles)),void r.push(e);if(t.isFallbackTransition)return e.onStart(()=>Bh(i,p.fromStyles)),e.onDestroy(()=>Lh(i,p.toStyles)),void r.push(e);p.timelines.forEach(t=>t.stretchStartingKeyframe=!0),n.append(i,p.timelines),o.push({instruction:p,player:e,element:i}),p.queriedElements.forEach(t=>yh(a,t,[]).push(e)),p.preStyleProps.forEach((t,e)=>{const n=Object.keys(t);if(n.length){let t=s.get(e);t||s.set(e,t=new Set),n.forEach(e=>t.add(e))}}),p.postStyleProps.forEach((t,e)=>{const n=Object.keys(t);let r=u.get(e);r||u.set(e,r=new Set),n.forEach(t=>r.add(t))})}});if(x.length){const t=[];x.forEach(e=>{t.push(`@${e.triggerName} has failed due to:\n`),e.errors.forEach(e=>t.push(`- ${e}\n`))}),w.forEach(t=>t.destroy()),this.reportError(t)}const _=new Map,C=new Map;o.forEach(t=>{const e=t.element;n.has(e)&&(C.set(e,e),this._beforeAnimationBuild(t.player.namespaceId,t.instruction,_))}),r.forEach(t=>{const e=t.element;this._getPreviousPlayers(e,!1,t.namespaceId,t.triggerName,null).forEach(t=>{yh(_,e,[]).push(t),t.destroy()})});const k=m.filter(t=>Hd(t,s,u)),S=new Map;Ud(S,this.driver,y,u,"*").forEach(t=>{Hd(t,s,u)&&k.push(t)});const E=new Map;d.forEach((t,e)=>{Ud(E,this.driver,new Set(t),s,"!")}),k.forEach(t=>{const e=S.get(t),n=E.get(t);S.set(t,Object.assign(Object.assign({},e),n))});const O=[],A=[],N={};o.forEach(t=>{const{element:e,player:o,instruction:a}=t;if(n.has(e)){if(l.has(e))return o.onDestroy(()=>Lh(e,a.toStyles)),o.disabled=!0,o.overrideTotalTime(a.totalTime),void r.push(o);let t=N;if(C.size>1){let n=e;const r=[];for(;n=n.parentNode;){const e=C.get(n);if(e){t=e;break}r.push(n)}r.forEach(e=>C.set(e,t))}const n=this._buildAnimation(o.namespaceId,a,_,i,E,S);if(o.setRealPlayer(n),t===N)O.push(o);else{const e=this.playersByElement.get(t);e&&e.length&&(o.parentPlayer=dh(e)),r.push(o)}}else Bh(e,a.fromStyles),o.onDestroy(()=>Lh(e,a.toStyles)),A.push(o),l.has(e)&&r.push(o)}),A.forEach(t=>{const e=i.get(t.element);if(e&&e.length){const n=dh(e);t.setRealPlayer(n)}}),r.forEach(t=>{t.parentPlayer?t.syncPlayerEvents(t.parentPlayer):t.destroy()});for(let T=0;T<m.length;T++){const t=m[T],e=t.__ng_removed;if(Wd(t,"ng-leave"),e&&e.hasAnimation)continue;let n=[];if(a.size){let e=a.get(t);e&&e.length&&n.push(...e);let r=this.driver.query(t,".ng-animating",!0);for(let t=0;t<r.length;t++){let e=a.get(r[t]);e&&e.length&&n.push(...e)}}const r=n.filter(t=>!t.destroyed);r.length?qd(this,t,r):this.processLeaveNode(t)}return m.length=0,O.forEach(t=>{this.players.push(t),t.onDone(()=>{t.destroy();const e=this.players.indexOf(t);this.players.splice(e,1)}),t.play()}),O}elementContainsData(t,e){let n=!1;const r=e.__ng_removed;return r&&r.setForRemoval&&(n=!0),this.playersByElement.has(e)&&(n=!0),this.playersByQueriedElement.has(e)&&(n=!0),this.statesByElement.has(e)&&(n=!0),this._fetchNamespace(t).elementContainsData(e)||n}afterFlush(t){this._flushFns.push(t)}afterFlushAnimationsDone(t){this._whenQuietFns.push(t)}_getPreviousPlayers(t,e,n,r,i){let o=[];if(e){const e=this.playersByQueriedElement.get(t);e&&(o=e)}else{const e=this.playersByElement.get(t);if(e){const t=!i||"void"==i;e.forEach(e=>{e.queued||(t||e.triggerName==r)&&o.push(e)})}}return(n||r)&&(o=o.filter(t=>!(n&&n!=t.namespaceId||r&&r!=t.triggerName))),o}_beforeAnimationBuild(t,e,n){const r=e.element,i=e.isRemovalTransition?void 0:t,o=e.isRemovalTransition?void 0:e.triggerName;for(const a of e.timelines){const t=a.element,s=t!==r,u=yh(n,t,[]);this._getPreviousPlayers(t,s,i,o,e.toState).forEach(t=>{const e=t.getRealPlayer();e.beforeDestroy&&e.beforeDestroy(),t.destroy(),u.push(t)})}Bh(r,e.fromStyles)}_buildAnimation(t,e,n,r,i,o){const a=e.triggerName,s=e.element,u=[],l=new Set,c=new Set,h=e.timelines.map(e=>{const h=e.element;l.add(h);const d=h.__ng_removed;if(d&&d.removedBeforeQueried)return new lh(e.duration,e.delay);const f=h!==s,p=function(t){const e=[];return function t(e,n){for(let r=0;r<e.length;r++){const i=e[r];i instanceof ch?t(i.players,n):n.push(i)}}(t,e),e}((n.get(h)||Dd).map(t=>t.getRealPlayer())).filter(t=>!!t.element&&t.element===h),m=i.get(h),g=o.get(h),y=fh(0,this._normalizer,0,e.keyframes,m,g),v=this._buildPlayer(e,y,p);if(e.subTimeline&&r&&c.add(h),f){const e=new zd(t,a,h);e.setRealPlayer(v),u.push(e)}return v});u.forEach(t=>{yh(this.playersByQueriedElement,t.element,[]).push(t),t.onDone(()=>function(t,e,n){let r;if(t instanceof Map){if(r=t.get(e),r){if(r.length){const t=r.indexOf(n);r.splice(t,1)}0==r.length&&t.delete(e)}}else if(r=t[e],r){if(r.length){const t=r.indexOf(n);r.splice(t,1)}0==r.length&&delete t[e]}return r}(this.playersByQueriedElement,t.element,t))}),l.forEach(t=>Vd(t,"ng-animating"));const d=dh(h);return d.onDestroy(()=>{l.forEach(t=>Wd(t,"ng-animating")),Lh(s,e.toStyles)}),c.forEach(t=>{yh(r,t,[]).push(d)}),d}_buildPlayer(t,e,n){return e.length>0?this.driver.animate(t.element,e,t.duration,t.delay,t.easing,n):new lh(t.duration,t.delay)}}class zd{constructor(t,e,n){this.namespaceId=t,this.triggerName=e,this.element=n,this._player=new lh,this._containsRealPlayer=!1,this._queuedCallbacks={},this.destroyed=!1,this.markedForDestroy=!1,this.disabled=!1,this.queued=!0,this.totalTime=0}setRealPlayer(t){this._containsRealPlayer||(this._player=t,Object.keys(this._queuedCallbacks).forEach(e=>{this._queuedCallbacks[e].forEach(n=>ph(t,e,void 0,n))}),this._queuedCallbacks={},this._containsRealPlayer=!0,this.overrideTotalTime(t.totalTime),this.queued=!1)}getRealPlayer(){return this._player}overrideTotalTime(t){this.totalTime=t}syncPlayerEvents(t){const e=this._player;e.triggerCallback&&t.onStart(()=>e.triggerCallback("start")),t.onDone(()=>this.finish()),t.onDestroy(()=>this.destroy())}_queueEvent(t,e){yh(this._queuedCallbacks,t,[]).push(e)}onDone(t){this.queued&&this._queueEvent("done",t),this._player.onDone(t)}onStart(t){this.queued&&this._queueEvent("start",t),this._player.onStart(t)}onDestroy(t){this.queued&&this._queueEvent("destroy",t),this._player.onDestroy(t)}init(){this._player.init()}hasStarted(){return!this.queued&&this._player.hasStarted()}play(){!this.queued&&this._player.play()}pause(){!this.queued&&this._player.pause()}restart(){!this.queued&&this._player.restart()}finish(){this._player.finish()}destroy(){this.destroyed=!0,this._player.destroy()}reset(){!this.queued&&this._player.reset()}setPosition(t){this.queued||this._player.setPosition(t)}getPosition(){return this.queued?0:this._player.getPosition()}triggerCallback(t){const e=this._player;e.triggerCallback&&e.triggerCallback(t)}}function Ld(t){return t&&1===t.nodeType}function Bd(t,e){const n=t.style.display;return t.style.display=null!=e?e:"none",n}function Ud(t,e,n,r,i){const o=[];n.forEach(t=>o.push(Bd(t)));const a=[];r.forEach((n,r)=>{const o={};n.forEach(t=>{const n=o[t]=e.computeStyle(r,t,i);n&&0!=n.length||(r.__ng_removed=Id,a.push(r))}),t.set(r,o)});let s=0;return n.forEach(t=>Bd(t,o[s++])),a}function $d(t,e){const n=new Map;if(t.forEach(t=>n.set(t,[])),0==e.length)return n;const r=new Set(e),i=new Map;return e.forEach(t=>{const e=function t(e){if(!e)return 1;let o=i.get(e);if(o)return o;const a=e.parentNode;return o=n.has(a)?a:r.has(a)?1:t(a),i.set(e,o),o}(t);1!==e&&n.get(e).push(t)}),n}function Vd(t,e){if(t.classList)t.classList.add(e);else{let n=t.$$classes;n||(n=t.$$classes={}),n[e]=!0}}function Wd(t,e){if(t.classList)t.classList.remove(e);else{let n=t.$$classes;n&&delete n[e]}}function qd(t,e,n){dh(n).onDone(()=>t.processLeaveNode(e))}function Hd(t,e,n){const r=n.get(t);if(!r)return!1;let i=e.get(t);return i?r.forEach(t=>i.add(t)):e.set(t,r),n.delete(t),!0}class Gd{constructor(t,e,n){this.bodyNode=t,this._driver=e,this._triggerCache={},this.onRemovalComplete=(t,e)=>{},this._transitionEngine=new jd(t,e,n),this._timelineEngine=new Td(t,e,n),this._transitionEngine.onRemovalComplete=(t,e)=>this.onRemovalComplete(t,e)}registerTrigger(t,e,n,r,i){const o=t+"-"+r;let a=this._triggerCache[o];if(!a){const t=[],e=rd(this._driver,i,t);if(t.length)throw new Error(`The animation trigger "${r}" has failed to build due to the following errors:\n - ${t.join("\n - ")}`);a=function(t,e){return new Od(t,e)}(r,e),this._triggerCache[o]=a}this._transitionEngine.registerTrigger(e,r,a)}register(t,e){this._transitionEngine.register(t,e)}destroy(t,e){this._transitionEngine.destroy(t,e)}onInsert(t,e,n,r){this._transitionEngine.insertNode(t,e,n,r)}onRemove(t,e,n,r){this._transitionEngine.removeNode(t,e,r||!1,n)}disableAnimations(t,e){this._transitionEngine.markElementAsDisabled(t,e)}process(t,e,n,r){if("@"==n.charAt(0)){const[t,i]=vh(n);this._timelineEngine.command(t,e,i,r)}else this._transitionEngine.trigger(t,e,n,r)}listen(t,e,n,r,i){if("@"==n.charAt(0)){const[t,r]=vh(n);return this._timelineEngine.listen(t,e,r,i)}return this._transitionEngine.listen(t,e,n,r,i)}flush(t=-1){this._transitionEngine.flush(t)}get players(){return this._transitionEngine.players.concat(this._timelineEngine.players)}whenRenderingDone(){return this._transitionEngine.whenRenderingDone()}}function Xd(t,e){let n=null,r=null;return Array.isArray(e)&&e.length?(n=Yd(e[0]),e.length>1&&(r=Yd(e[e.length-1]))):e&&(n=Yd(e)),n||r?new Kd(t,n,r):null}let Kd=(()=>{class t{constructor(e,n,r){this._element=e,this._startStyles=n,this._endStyles=r,this._state=0;let i=t.initialStylesByElement.get(e);i||t.initialStylesByElement.set(e,i={}),this._initialStyles=i}start(){this._state<1&&(this._startStyles&&Lh(this._element,this._startStyles,this._initialStyles),this._state=1)}finish(){this.start(),this._state<2&&(Lh(this._element,this._initialStyles),this._endStyles&&(Lh(this._element,this._endStyles),this._endStyles=null),this._state=1)}destroy(){this.finish(),this._state<3&&(t.initialStylesByElement.delete(this._element),this._startStyles&&(Bh(this._element,this._startStyles),this._endStyles=null),this._endStyles&&(Bh(this._element,this._endStyles),this._endStyles=null),Lh(this._element,this._initialStyles),this._state=3)}}return t.initialStylesByElement=new WeakMap,t})();function Yd(t){let e=null;const n=Object.keys(t);for(let r=0;r<n.length;r++){const i=n[r];Zd(i)&&(e=e||{},e[i]=t[i])}return e}function Zd(t){return"display"===t||"position"===t}class Qd{constructor(t,e,n,r,i,o,a){this._element=t,this._name=e,this._duration=n,this._delay=r,this._easing=i,this._fillMode=o,this._onDoneFn=a,this._finished=!1,this._destroyed=!1,this._startTime=0,this._position=0,this._eventFn=t=>this._handleCallback(t)}apply(){!function(t,e){const n=of(t,"").trim();n.length&&(function(t,e){let n=0;for(let r=0;r<t.length;r++)","===t.charAt(r)&&n++}(n),e=`${n}, ${e}`),rf(t,"",e)}(this._element,`${this._duration}ms ${this._easing} ${this._delay}ms 1 normal ${this._fillMode} ${this._name}`),nf(this._element,this._eventFn,!1),this._startTime=Date.now()}pause(){Jd(this._element,this._name,"paused")}resume(){Jd(this._element,this._name,"running")}setPosition(t){const e=tf(this._element,this._name);this._position=t*this._duration,rf(this._element,"Delay",`-${this._position}ms`,e)}getPosition(){return this._position}_handleCallback(t){const e=t._ngTestManualTimestamp||Date.now(),n=1e3*parseFloat(t.elapsedTime.toFixed(3));t.animationName==this._name&&Math.max(e-this._startTime,0)>=this._delay&&n>=this._duration&&this.finish()}finish(){this._finished||(this._finished=!0,this._onDoneFn(),nf(this._element,this._eventFn,!0))}destroy(){this._destroyed||(this._destroyed=!0,this.finish(),function(t,e){const n=of(t,"").split(","),r=ef(n,e);r>=0&&(n.splice(r,1),rf(t,"",n.join(",")))}(this._element,this._name))}}function Jd(t,e,n){rf(t,"PlayState",n,tf(t,e))}function tf(t,e){const n=of(t,"");return n.indexOf(",")>0?ef(n.split(","),e):ef([n],e)}function ef(t,e){for(let n=0;n<t.length;n++)if(t[n].indexOf(e)>=0)return n;return-1}function nf(t,e,n){n?t.removeEventListener("animationend",e):t.addEventListener("animationend",e)}function rf(t,e,n,r){const i="animation"+e;if(null!=r){const e=t.style[i];if(e.length){const t=e.split(",");t[r]=n,n=t.join(",")}}t.style[i]=n}function of(t,e){return t.style["animation"+e]}class af{constructor(t,e,n,r,i,o,a,s){this.element=t,this.keyframes=e,this.animationName=n,this._duration=r,this._delay=i,this._finalStyles=a,this._specialStyles=s,this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._started=!1,this.currentSnapshot={},this._state=0,this.easing=o||"linear",this.totalTime=r+i,this._buildStyler()}onStart(t){this._onStartFns.push(t)}onDone(t){this._onDoneFns.push(t)}onDestroy(t){this._onDestroyFns.push(t)}destroy(){this.init(),this._state>=4||(this._state=4,this._styler.destroy(),this._flushStartFns(),this._flushDoneFns(),this._specialStyles&&this._specialStyles.destroy(),this._onDestroyFns.forEach(t=>t()),this._onDestroyFns=[])}_flushDoneFns(){this._onDoneFns.forEach(t=>t()),this._onDoneFns=[]}_flushStartFns(){this._onStartFns.forEach(t=>t()),this._onStartFns=[]}finish(){this.init(),this._state>=3||(this._state=3,this._styler.finish(),this._flushStartFns(),this._specialStyles&&this._specialStyles.finish(),this._flushDoneFns())}setPosition(t){this._styler.setPosition(t)}getPosition(){return this._styler.getPosition()}hasStarted(){return this._state>=2}init(){this._state>=1||(this._state=1,this._styler.apply(),this._delay&&this._styler.pause())}play(){this.init(),this.hasStarted()||(this._flushStartFns(),this._state=2,this._specialStyles&&this._specialStyles.start()),this._styler.resume()}pause(){this.init(),this._styler.pause()}restart(){this.reset(),this.play()}reset(){this._styler.destroy(),this._buildStyler(),this._styler.apply()}_buildStyler(){this._styler=new Qd(this.element,this.animationName,this._duration,this._delay,this.easing,"forwards",()=>this.finish())}triggerCallback(t){const e="start"==t?this._onStartFns:this._onDoneFns;e.forEach(t=>t()),e.length=0}beforeDestroy(){this.init();const t={};if(this.hasStarted()){const e=this._state>=3;Object.keys(this._finalStyles).forEach(n=>{"offset"!=n&&(t[n]=e?this._finalStyles[n]:Zh(this.element,n))})}this.currentSnapshot=t}}class sf extends lh{constructor(t,e){super(),this.element=t,this._startingStyles={},this.__initialized=!1,this._styles=Nh(e)}init(){!this.__initialized&&this._startingStyles&&(this.__initialized=!0,Object.keys(this._styles).forEach(t=>{this._startingStyles[t]=this.element.style[t]}),super.init())}play(){this._startingStyles&&(this.init(),Object.keys(this._styles).forEach(t=>this.element.style.setProperty(t,this._styles[t])),super.play())}destroy(){this._startingStyles&&(Object.keys(this._startingStyles).forEach(t=>{const e=this._startingStyles[t];e?this.element.style.setProperty(t,e):this.element.style.removeProperty(t)}),this._startingStyles=null,super.destroy())}}class uf{constructor(){this._count=0,this._head=document.querySelector("head"),this._warningIssued=!1}validateStyleProperty(t){return Sh(t)}matchesElement(t,e){return Eh(t,e)}containsElement(t,e){return Oh(t,e)}query(t,e,n){return Ah(t,e,n)}computeStyle(t,e,n){return window.getComputedStyle(t)[e]}buildKeyframeElement(t,e,n){n=n.map(t=>Nh(t));let r=`@keyframes ${e} {\n`,i="";n.forEach(t=>{i=" ";const e=parseFloat(t.offset);r+=`${i}${100*e}% {\n`,i+=" ",Object.keys(t).forEach(e=>{const n=t[e];switch(e){case"offset":return;case"easing":return void(n&&(r+=`${i}animation-timing-function: ${n};\n`));default:return void(r+=`${i}${e}: ${n};\n`)}}),r+=i+"}\n"}),r+="}\n";const o=document.createElement("style");return o.innerHTML=r,o}animate(t,e,n,r,i,o=[],a){a&&this._notifyFaultyScrubber();const s=o.filter(t=>t instanceof af),u={};Xh(n,r)&&s.forEach(t=>{let e=t.currentSnapshot;Object.keys(e).forEach(t=>u[t]=e[t])});const l=function(t){let e={};return t&&(Array.isArray(t)?t:[t]).forEach(t=>{Object.keys(t).forEach(n=>{"offset"!=n&&"easing"!=n&&(e[n]=t[n])})}),e}(e=Kh(t,e,u));if(0==n)return new sf(t,l);const c="gen_css_kf_"+this._count++,h=this.buildKeyframeElement(t,c,e);document.querySelector("head").appendChild(h);const d=Xd(t,e),f=new af(t,e,c,n,r,i,l,d);return f.onDestroy(()=>{var t;(t=h).parentNode.removeChild(t)}),f}_notifyFaultyScrubber(){this._warningIssued||(console.warn("@angular/animations: please load the web-animations.js polyfill to allow programmatic access...\n","  visit http://bit.ly/IWukam to learn more about using the web-animation-js polyfill."),this._warningIssued=!0)}}class lf{constructor(t,e,n,r){this.element=t,this.keyframes=e,this.options=n,this._specialStyles=r,this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._initialized=!1,this._finished=!1,this._started=!1,this._destroyed=!1,this.time=0,this.parentPlayer=null,this.currentSnapshot={},this._duration=n.duration,this._delay=n.delay||0,this.time=this._duration+this._delay}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(t=>t()),this._onDoneFns=[])}init(){this._buildPlayer(),this._preparePlayerBeforeStart()}_buildPlayer(){if(this._initialized)return;this._initialized=!0;const t=this.keyframes;this.domPlayer=this._triggerWebAnimation(this.element,t,this.options),this._finalKeyframe=t.length?t[t.length-1]:{},this.domPlayer.addEventListener("finish",()=>this._onFinish())}_preparePlayerBeforeStart(){this._delay?this._resetDomPlayerState():this.domPlayer.pause()}_triggerWebAnimation(t,e,n){return t.animate(e,n)}onStart(t){this._onStartFns.push(t)}onDone(t){this._onDoneFns.push(t)}onDestroy(t){this._onDestroyFns.push(t)}play(){this._buildPlayer(),this.hasStarted()||(this._onStartFns.forEach(t=>t()),this._onStartFns=[],this._started=!0,this._specialStyles&&this._specialStyles.start()),this.domPlayer.play()}pause(){this.init(),this.domPlayer.pause()}finish(){this.init(),this._specialStyles&&this._specialStyles.finish(),this._onFinish(),this.domPlayer.finish()}reset(){this._resetDomPlayerState(),this._destroyed=!1,this._finished=!1,this._started=!1}_resetDomPlayerState(){this.domPlayer&&this.domPlayer.cancel()}restart(){this.reset(),this.play()}hasStarted(){return this._started}destroy(){this._destroyed||(this._destroyed=!0,this._resetDomPlayerState(),this._onFinish(),this._specialStyles&&this._specialStyles.destroy(),this._onDestroyFns.forEach(t=>t()),this._onDestroyFns=[])}setPosition(t){this.domPlayer.currentTime=t*this.time}getPosition(){return this.domPlayer.currentTime/this.time}get totalTime(){return this._delay+this._duration}beforeDestroy(){const t={};this.hasStarted()&&Object.keys(this._finalKeyframe).forEach(e=>{"offset"!=e&&(t[e]=this._finished?this._finalKeyframe[e]:Zh(this.element,e))}),this.currentSnapshot=t}triggerCallback(t){const e="start"==t?this._onStartFns:this._onDoneFns;e.forEach(t=>t()),e.length=0}}class cf{constructor(){this._isNativeImpl=/\{\s*\[native\s+code\]\s*\}/.test(hf().toString()),this._cssKeyframesDriver=new uf}validateStyleProperty(t){return Sh(t)}matchesElement(t,e){return Eh(t,e)}containsElement(t,e){return Oh(t,e)}query(t,e,n){return Ah(t,e,n)}computeStyle(t,e,n){return window.getComputedStyle(t)[e]}overrideWebAnimationsSupport(t){this._isNativeImpl=t}animate(t,e,n,r,i,o=[],a){if(!a&&!this._isNativeImpl)return this._cssKeyframesDriver.animate(t,e,n,r,i,o);const s={duration:n,delay:r,fill:0==r?"both":"forwards"};i&&(s.easing=i);const u={},l=o.filter(t=>t instanceof lf);Xh(n,r)&&l.forEach(t=>{let e=t.currentSnapshot;Object.keys(e).forEach(t=>u[t]=e[t])});const c=Xd(t,e=Kh(t,e=e.map(t=>Ph(t,!1)),u));return new lf(t,e,s,c)}}function hf(){return"undefined"!=typeof window&&void 0!==window.document&&Element.prototype.animate||{}}let df=(()=>{class t extends eh{constructor(t,e){super(),this._nextAnimationId=0,this._renderer=t.createRenderer(e.body,{id:"0",encapsulation:ce.None,styles:[],data:{animation:[]}})}build(t){const e=this._nextAnimationId.toString();this._nextAnimationId++;const n=Array.isArray(t)?ih(t):t;return mf(this._renderer,null,e,"register",[n]),new ff(e,this._renderer)}}return t.\u0275fac=function(e){return new(e||t)(Kt(Es),Kt(zl))},t.\u0275prov=ht({token:t,factory:t.\u0275fac}),t})();class ff extends class{}{constructor(t,e){super(),this._id=t,this._renderer=e}create(t,e){return new pf(this._id,t,e||{},this._renderer)}}class pf{constructor(t,e,n,r){this.id=t,this.element=e,this._renderer=r,this.parentPlayer=null,this._started=!1,this.totalTime=0,this._command("create",n)}_listen(t,e){return this._renderer.listen(this.element,`@@${this.id}:${t}`,e)}_command(t,...e){return mf(this._renderer,this.element,this.id,t,e)}onDone(t){this._listen("done",t)}onStart(t){this._listen("start",t)}onDestroy(t){this._listen("destroy",t)}init(){this._command("init")}hasStarted(){return this._started}play(){this._command("play"),this._started=!0}pause(){this._command("pause")}restart(){this._command("restart")}finish(){this._command("finish")}destroy(){this._command("destroy")}reset(){this._command("reset")}setPosition(t){this._command("setPosition",t)}getPosition(){return 0}}function mf(t,e,n,r,i){return t.setProperty(e,`@@${n}:${r}`,i)}let gf=(()=>{class t{constructor(t,e,n){this.delegate=t,this.engine=e,this._zone=n,this._currentId=0,this._microtaskId=1,this._animationCallbacksBuffer=[],this._rendererCache=new Map,this._cdRecurDepth=0,this.promise=Promise.resolve(0),e.onRemovalComplete=(t,e)=>{e&&e.parentNode(t)&&e.removeChild(t.parentNode,t)}}createRenderer(t,e){const n=this.delegate.createRenderer(t,e);if(!(t&&e&&e.data&&e.data.animation)){let t=this._rendererCache.get(n);return t||(t=new yf("",n,this.engine),this._rendererCache.set(n,t)),t}const r=e.id,i=e.id+"-"+this._currentId;this._currentId++,this.engine.register(i,t);const o=e=>{Array.isArray(e)?e.forEach(o):this.engine.registerTrigger(r,i,t,e.name,e)};return e.data.animation.forEach(o),new vf(this,i,n,this.engine)}begin(){this._cdRecurDepth++,this.delegate.begin&&this.delegate.begin()}_scheduleCountTask(){this.promise.then(()=>{this._microtaskId++})}scheduleListenerCallback(t,e,n){t>=0&&t<this._microtaskId?this._zone.run(()=>e(n)):(0==this._animationCallbacksBuffer.length&&Promise.resolve(null).then(()=>{this._zone.run(()=>{this._animationCallbacksBuffer.forEach(t=>{const[e,n]=t;e(n)}),this._animationCallbacksBuffer=[]})}),this._animationCallbacksBuffer.push([e,n]))}end(){this._cdRecurDepth--,0==this._cdRecurDepth&&this._zone.runOutsideAngular(()=>{this._scheduleCountTask(),this.engine.flush(this._microtaskId)}),this.delegate.end&&this.delegate.end()}whenRenderingDone(){return this.engine.whenRenderingDone()}}return t.\u0275fac=function(e){return new(e||t)(Kt(Es),Kt(Gd),Kt(sl))},t.\u0275prov=ht({token:t,factory:t.\u0275fac}),t})();class yf{constructor(t,e,n){this.namespaceId=t,this.delegate=e,this.engine=n,this.destroyNode=this.delegate.destroyNode?t=>e.destroyNode(t):null}get data(){return this.delegate.data}destroy(){this.engine.destroy(this.namespaceId,this.delegate),this.delegate.destroy()}createElement(t,e){return this.delegate.createElement(t,e)}createComment(t){return this.delegate.createComment(t)}createText(t){return this.delegate.createText(t)}appendChild(t,e){this.delegate.appendChild(t,e),this.engine.onInsert(this.namespaceId,e,t,!1)}insertBefore(t,e,n){this.delegate.insertBefore(t,e,n),this.engine.onInsert(this.namespaceId,e,t,!0)}removeChild(t,e,n){this.engine.onRemove(this.namespaceId,e,this.delegate,n)}selectRootElement(t,e){return this.delegate.selectRootElement(t,e)}parentNode(t){return this.delegate.parentNode(t)}nextSibling(t){return this.delegate.nextSibling(t)}setAttribute(t,e,n,r){this.delegate.setAttribute(t,e,n,r)}removeAttribute(t,e,n){this.delegate.removeAttribute(t,e,n)}addClass(t,e){this.delegate.addClass(t,e)}removeClass(t,e){this.delegate.removeClass(t,e)}setStyle(t,e,n,r){this.delegate.setStyle(t,e,n,r)}removeStyle(t,e,n){this.delegate.removeStyle(t,e,n)}setProperty(t,e,n){"@"==e.charAt(0)&&"@.disabled"==e?this.disableAnimations(t,!!n):this.delegate.setProperty(t,e,n)}setValue(t,e){this.delegate.setValue(t,e)}listen(t,e,n){return this.delegate.listen(t,e,n)}disableAnimations(t,e){this.engine.disableAnimations(t,e)}}class vf extends yf{constructor(t,e,n,r){super(e,n,r),this.factory=t,this.namespaceId=e}setProperty(t,e,n){"@"==e.charAt(0)?"."==e.charAt(1)&&"@.disabled"==e?this.disableAnimations(t,n=void 0===n||!!n):this.engine.process(this.namespaceId,t,e.substr(1),n):this.delegate.setProperty(t,e,n)}listen(t,e,n){if("@"==e.charAt(0)){const r=function(t){switch(t){case"body":return document.body;case"document":return document;case"window":return window;default:return t}}(t);let i=e.substr(1),o="";return"@"!=i.charAt(0)&&([i,o]=function(t){const e=t.indexOf(".");return[t.substring(0,e),t.substr(e+1)]}(i)),this.engine.listen(this.namespaceId,r,i,o,t=>{this.factory.scheduleListenerCallback(t._data||-1,n,t)})}return this.delegate.listen(t,e,n)}}let bf=(()=>{class t extends Gd{constructor(t,e,n){super(t.body,e,n)}}return t.\u0275fac=function(e){return new(e||t)(Kt(zl),Kt(Dh),Kt(wd))},t.\u0275prov=ht({token:t,factory:t.\u0275fac}),t})();const wf=new Lt("AnimationModuleType"),xf=[{provide:Dh,useFactory:function(){return"function"==typeof hf()?new cf:new uf}},{provide:wf,useValue:"BrowserAnimations"},{provide:eh,useClass:df},{provide:wd,useFactory:function(){return new xd}},{provide:Gd,useClass:bf},{provide:Es,useFactory:function(t,e,n){return new gf(t,e,n)},deps:[Bc,Gd,sl]}];let _f=(()=>{class t{}return t.\u0275mod=ve({type:t}),t.\u0275inj=dt({factory:function(e){return new(e||t)},providers:xf,imports:[th]}),t})();function Cf(...t){if(1===t.length){const e=t[0];if(u(e))return kf(e,null);if(l(e)&&Object.getPrototypeOf(e)===Object.prototype){const t=Object.keys(e);return kf(t.map(t=>e[t]),t)}}if("function"==typeof t[t.length-1]){const e=t.pop();return kf(t=1===t.length&&u(t[0])?t[0]:t,null).pipe(F(t=>e(...t)))}return kf(t,null)}function kf(t,e){return new v(n=>{const r=t.length;if(0===r)return void n.complete();const i=new Array(r);let o=0,a=0;for(let s=0;s<r;s++){const u=L(t[s]);let l=!1;n.add(u.subscribe({next:t=>{l||(l=!0,a++),i[s]=t},error:t=>n.error(t),complete:()=>{o++,o!==r&&l||(a===r&&n.next(e?e.reduce((t,e,n)=>(t[e]=i[n],t),{}):i),n.complete())}}))}})}const Sf=new Lt("NgValueAccessor"),Ef={provide:Sf,useExisting:kt(()=>Of),multi:!0};let Of=(()=>{class t{constructor(t,e){this._renderer=t,this._elementRef=e,this.onChange=t=>{},this.onTouched=()=>{}}writeValue(t){this._renderer.setProperty(this._elementRef.nativeElement,"checked",t)}registerOnChange(t){this.onChange=t}registerOnTouched(t){this.onTouched=t}setDisabledState(t){this._renderer.setProperty(this._elementRef.nativeElement,"disabled",t)}}return t.\u0275fac=function(e){return new(e||t)(ka(As),ka(ks))},t.\u0275dir=we({type:t,selectors:[["input","type","checkbox","formControlName",""],["input","type","checkbox","formControl",""],["input","type","checkbox","ngModel",""]],hostBindings:function(t,e){1&t&&Pa("change",(function(t){return e.onChange(t.target.checked)}))("blur",(function(){return e.onTouched()}))},features:[ws([Ef])]}),t})();const Af={provide:Sf,useExisting:kt(()=>Tf),multi:!0},Nf=new Lt("CompositionEventMode");let Tf=(()=>{class t{constructor(t,e,n){this._renderer=t,this._elementRef=e,this._compositionMode=n,this.onChange=t=>{},this.onTouched=()=>{},this._composing=!1,null==this._compositionMode&&(this._compositionMode=!function(){const t=jl()?jl().getUserAgent():"";return/android (\d+)/.test(t.toLowerCase())}())}writeValue(t){this._renderer.setProperty(this._elementRef.nativeElement,"value",null==t?"":t)}registerOnChange(t){this.onChange=t}registerOnTouched(t){this.onTouched=t}setDisabledState(t){this._renderer.setProperty(this._elementRef.nativeElement,"disabled",t)}_handleInput(t){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(t)}_compositionStart(){this._composing=!0}_compositionEnd(t){this._composing=!1,this._compositionMode&&this.onChange(t)}}return t.\u0275fac=function(e){return new(e||t)(ka(As),ka(ks),ka(Nf,8))},t.\u0275dir=we({type:t,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(t,e){1&t&&Pa("input",(function(t){return e._handleInput(t.target.value)}))("blur",(function(){return e.onTouched()}))("compositionstart",(function(){return e._compositionStart()}))("compositionend",(function(t){return e._compositionEnd(t.target.value)}))},features:[ws([Af])]}),t})(),Df=(()=>{class t{get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}reset(t){this.control&&this.control.reset(t)}hasError(t,e){return!!this.control&&this.control.hasError(t,e)}getError(t,e){return this.control?this.control.getError(t,e):null}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275dir=we({type:t}),t})(),Rf=(()=>{class t extends Df{get formDirective(){return null}get path(){return null}}return t.\u0275fac=function(e){return If(e||t)},t.\u0275dir=we({type:t,features:[us]}),t})();const If=fr(Rf);function Mf(){throw new Error("unimplemented")}class Ff extends Df{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null,this._rawValidators=[],this._rawAsyncValidators=[]}get validator(){return Mf()}get asyncValidator(){return Mf()}}class Pf{constructor(t){this._cd=t}get ngClassUntouched(){return!!this._cd.control&&this._cd.control.untouched}get ngClassTouched(){return!!this._cd.control&&this._cd.control.touched}get ngClassPristine(){return!!this._cd.control&&this._cd.control.pristine}get ngClassDirty(){return!!this._cd.control&&this._cd.control.dirty}get ngClassValid(){return!!this._cd.control&&this._cd.control.valid}get ngClassInvalid(){return!!this._cd.control&&this._cd.control.invalid}get ngClassPending(){return!!this._cd.control&&this._cd.control.pending}}let jf=(()=>{class t extends Pf{constructor(t){super(t)}}return t.\u0275fac=function(e){return new(e||t)(ka(Ff,2))},t.\u0275dir=we({type:t,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(t,e){2&t&&Ya("ng-untouched",e.ngClassUntouched)("ng-touched",e.ngClassTouched)("ng-pristine",e.ngClassPristine)("ng-dirty",e.ngClassDirty)("ng-valid",e.ngClassValid)("ng-invalid",e.ngClassInvalid)("ng-pending",e.ngClassPending)},features:[us]}),t})(),zf=(()=>{class t extends Pf{constructor(t){super(t)}}return t.\u0275fac=function(e){return new(e||t)(ka(Rf,2))},t.\u0275dir=we({type:t,selectors:[["","formGroupName",""],["","formArrayName",""],["","ngModelGroup",""],["","formGroup",""],["form",3,"ngNoForm",""],["","ngForm",""]],hostVars:14,hostBindings:function(t,e){2&t&&Ya("ng-untouched",e.ngClassUntouched)("ng-touched",e.ngClassTouched)("ng-pristine",e.ngClassPristine)("ng-dirty",e.ngClassDirty)("ng-valid",e.ngClassValid)("ng-invalid",e.ngClassInvalid)("ng-pending",e.ngClassPending)},features:[us]}),t})();function Lf(t){return null==t||0===t.length}function Bf(t){return null!=t&&"number"==typeof t.length}const Uf=new Lt("NgValidators"),$f=new Lt("NgAsyncValidators"),Vf=/^(?=.{1,254}$)(?=.{1,64}@)[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+)*@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/;class Wf{static min(t){return e=>{if(Lf(e.value)||Lf(t))return null;const n=parseFloat(e.value);return!isNaN(n)&&n<t?{min:{min:t,actual:e.value}}:null}}static max(t){return e=>{if(Lf(e.value)||Lf(t))return null;const n=parseFloat(e.value);return!isNaN(n)&&n>t?{max:{max:t,actual:e.value}}:null}}static required(t){return Lf(t.value)?{required:!0}:null}static requiredTrue(t){return!0===t.value?null:{required:!0}}static email(t){return Lf(t.value)||Vf.test(t.value)?null:{email:!0}}static minLength(t){return e=>Lf(e.value)||!Bf(e.value)?null:e.value.length<t?{minlength:{requiredLength:t,actualLength:e.value.length}}:null}static maxLength(t){return e=>Bf(e.value)&&e.value.length>t?{maxlength:{requiredLength:t,actualLength:e.value.length}}:null}static pattern(t){if(!t)return Wf.nullValidator;let e,n;return"string"==typeof t?(n="","^"!==t.charAt(0)&&(n+="^"),n+=t,"$"!==t.charAt(t.length-1)&&(n+="$"),e=new RegExp(n)):(n=t.toString(),e=t),t=>{if(Lf(t.value))return null;const r=t.value;return e.test(r)?null:{pattern:{requiredPattern:n,actualValue:r}}}}static nullValidator(t){return null}static compose(t){if(!t)return null;const e=t.filter(qf);return 0==e.length?null:function(t){return Gf(function(t,e){return e.map(e=>e(t))}(t,e))}}static composeAsync(t){if(!t)return null;const e=t.filter(qf);return 0==e.length?null:function(t){return Cf(function(t,e){return e.map(e=>e(t))}(t,e).map(Hf)).pipe(F(Gf))}}}function qf(t){return null!=t}function Hf(t){const e=Ma(t)?L(t):t;if(!Fa(e))throw new Error("Expected validator to return Promise or Observable.");return e}function Gf(t){let e={};return t.forEach(t=>{e=null!=t?Object.assign(Object.assign({},e),t):e}),0===Object.keys(e).length?null:e}function Xf(t){return t.validate?e=>t.validate(e):t}function Kf(t){return t.validate?e=>t.validate(e):t}const Yf={provide:Sf,useExisting:kt(()=>Zf),multi:!0};let Zf=(()=>{class t{constructor(t,e){this._renderer=t,this._elementRef=e,this.onChange=t=>{},this.onTouched=()=>{}}writeValue(t){this._renderer.setProperty(this._elementRef.nativeElement,"value",null==t?"":t)}registerOnChange(t){this.onChange=e=>{t(""==e?null:parseFloat(e))}}registerOnTouched(t){this.onTouched=t}setDisabledState(t){this._renderer.setProperty(this._elementRef.nativeElement,"disabled",t)}}return t.\u0275fac=function(e){return new(e||t)(ka(As),ka(ks))},t.\u0275dir=we({type:t,selectors:[["input","type","number","formControlName",""],["input","type","number","formControl",""],["input","type","number","ngModel",""]],hostBindings:function(t,e){1&t&&Pa("input",(function(t){return e.onChange(t.target.value)}))("blur",(function(){return e.onTouched()}))},features:[ws([Yf])]}),t})();const Qf={provide:Sf,useExisting:kt(()=>tp),multi:!0};let Jf=(()=>{class t{constructor(){this._accessors=[]}add(t,e){this._accessors.push([t,e])}remove(t){for(let e=this._accessors.length-1;e>=0;--e)if(this._accessors[e][1]===t)return void this._accessors.splice(e,1)}select(t){this._accessors.forEach(e=>{this._isSameGroup(e,t)&&e[1]!==t&&e[1].fireUncheck(t.value)})}_isSameGroup(t,e){return!!t[0].control&&t[0]._parent===e._control._parent&&t[1].name===e.name}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=ht({token:t,factory:t.\u0275fac}),t})(),tp=(()=>{class t{constructor(t,e,n,r){this._renderer=t,this._elementRef=e,this._registry=n,this._injector=r,this.onChange=()=>{},this.onTouched=()=>{}}ngOnInit(){this._control=this._injector.get(Ff),this._checkName(),this._registry.add(this._control,this)}ngOnDestroy(){this._registry.remove(this)}writeValue(t){this._state=t===this.value,this._renderer.setProperty(this._elementRef.nativeElement,"checked",this._state)}registerOnChange(t){this._fn=t,this.onChange=()=>{t(this.value),this._registry.select(this)}}fireUncheck(t){this.writeValue(t)}registerOnTouched(t){this.onTouched=t}setDisabledState(t){this._renderer.setProperty(this._elementRef.nativeElement,"disabled",t)}_checkName(){this.name&&this.formControlName&&this.name!==this.formControlName&&this._throwNameError(),!this.name&&this.formControlName&&(this.name=this.formControlName)}_throwNameError(){throw new Error('\n      If you define both a name and a formControlName attribute on your radio button, their values\n      must match. Ex: <input type="radio" formControlName="food" name="food">\n    ')}}return t.\u0275fac=function(e){return new(e||t)(ka(As),ka(ks),ka(Jf),ka(ca))},t.\u0275dir=we({type:t,selectors:[["input","type","radio","formControlName",""],["input","type","radio","formControl",""],["input","type","radio","ngModel",""]],hostBindings:function(t,e){1&t&&Pa("change",(function(){return e.onChange()}))("blur",(function(){return e.onTouched()}))},inputs:{name:"name",formControlName:"formControlName",value:"value"},features:[ws([Qf])]}),t})();const ep={provide:Sf,useExisting:kt(()=>np),multi:!0};let np=(()=>{class t{constructor(t,e){this._renderer=t,this._elementRef=e,this.onChange=t=>{},this.onTouched=()=>{}}writeValue(t){this._renderer.setProperty(this._elementRef.nativeElement,"value",parseFloat(t))}registerOnChange(t){this.onChange=e=>{t(""==e?null:parseFloat(e))}}registerOnTouched(t){this.onTouched=t}setDisabledState(t){this._renderer.setProperty(this._elementRef.nativeElement,"disabled",t)}}return t.\u0275fac=function(e){return new(e||t)(ka(As),ka(ks))},t.\u0275dir=we({type:t,selectors:[["input","type","range","formControlName",""],["input","type","range","formControl",""],["input","type","range","ngModel",""]],hostBindings:function(t,e){1&t&&Pa("change",(function(t){return e.onChange(t.target.value)}))("input",(function(t){return e.onChange(t.target.value)}))("blur",(function(){return e.onTouched()}))},features:[ws([ep])]}),t})();const rp='\n    <div [formGroup]="myGroup">\n      <input formControlName="firstName">\n    </div>\n\n    In your class:\n\n    this.myGroup = new FormGroup({\n       firstName: new FormControl()\n    });',ip='\n    <div [formGroup]="myGroup">\n       <div formGroupName="person">\n          <input formControlName="firstName">\n       </div>\n    </div>\n\n    In your class:\n\n    this.myGroup = new FormGroup({\n       person: new FormGroup({ firstName: new FormControl() })\n    });';class op{static controlParentException(){throw new Error("formControlName must be used with a parent formGroup directive.  You'll want to add a formGroup\n       directive and pass it an existing FormGroup instance (you can create one in your class).\n\n      Example:\n\n      "+rp)}static ngModelGroupException(){throw new Error(`formControlName cannot be used with an ngModelGroup parent. It is only compatible with parents\n       that also have a "form" prefix: formGroupName, formArrayName, or formGroup.\n\n       Option 1:  Update the parent to be formGroupName (reactive form strategy)\n\n        ${ip}\n\n        Option 2: Use ngModel instead of formControlName (template-driven strategy)\n\n        \n    <form>\n       <div ngModelGroup="person">\n          <input [(ngModel)]="person.name" name="firstName">\n       </div>\n    </form>`)}static missingFormException(){throw new Error("formGroup expects a FormGroup instance. Please pass one in.\n\n       Example:\n\n       "+rp)}static groupParentException(){throw new Error("formGroupName must be used with a parent formGroup directive.  You'll want to add a formGroup\n      directive and pass it an existing FormGroup instance (you can create one in your class).\n\n      Example:\n\n      "+ip)}static arrayParentException(){throw new Error('formArrayName must be used with a parent formGroup directive.  You\'ll want to add a formGroup\n       directive and pass it an existing FormGroup instance (you can create one in your class).\n\n        Example:\n\n        \n    <div [formGroup]="myGroup">\n      <div formArrayName="cities">\n        <div *ngFor="let city of cityArray.controls; index as i">\n          <input [formControlName]="i">\n        </div>\n      </div>\n    </div>\n\n    In your class:\n\n    this.cityArray = new FormArray([new FormControl(\'SF\')]);\n    this.myGroup = new FormGroup({\n      cities: this.cityArray\n    });')}static disabledAttrWarning(){console.warn("\n      It looks like you're using the disabled attribute with a reactive form directive. If you set disabled to true\n      when you set up this control in your component class, the disabled attribute will actually be set in the DOM for\n      you. We recommend using this approach to avoid 'changed after checked' errors.\n\n      Example:\n      form = new FormGroup({\n        first: new FormControl({value: 'Nancy', disabled: true}, Validators.required),\n        last: new FormControl('Drew', Validators.required)\n      });\n    ")}static ngModelWarning(t){console.warn(`\n    It looks like you're using ngModel on the same form field as ${t}.\n    Support for using the ngModel input property and ngModelChange event with\n    reactive form directives has been deprecated in Angular v6 and will be removed\n    in a future version of Angular.\n\n    For more information on this, see our API docs here:\n    https://angular.io/api/forms/${"formControl"===t?"FormControlDirective":"FormControlName"}#use-with-ngmodel\n    `)}}const ap={provide:Sf,useExisting:kt(()=>sp),multi:!0};let sp=(()=>{class t{constructor(t,e){this._renderer=t,this._elementRef=e,this._optionMap=new Map,this._idCounter=0,this.onChange=t=>{},this.onTouched=()=>{},this._compareWith=Object.is}set compareWith(t){if("function"!=typeof t)throw new Error("compareWith must be a function, but received "+JSON.stringify(t));this._compareWith=t}writeValue(t){this.value=t;const e=this._getOptionId(t);null==e&&this._renderer.setProperty(this._elementRef.nativeElement,"selectedIndex",-1);const n=function(t,e){return null==t?""+e:(e&&"object"==typeof e&&(e="Object"),`${t}: ${e}`.slice(0,50))}(e,t);this._renderer.setProperty(this._elementRef.nativeElement,"value",n)}registerOnChange(t){this.onChange=e=>{this.value=this._getOptionValue(e),t(this.value)}}registerOnTouched(t){this.onTouched=t}setDisabledState(t){this._renderer.setProperty(this._elementRef.nativeElement,"disabled",t)}_registerOption(){return(this._idCounter++).toString()}_getOptionId(t){for(const e of Array.from(this._optionMap.keys()))if(this._compareWith(this._optionMap.get(e),t))return e;return null}_getOptionValue(t){const e=function(t){return t.split(":")[0]}(t);return this._optionMap.has(e)?this._optionMap.get(e):t}}return t.\u0275fac=function(e){return new(e||t)(ka(As),ka(ks))},t.\u0275dir=we({type:t,selectors:[["select","formControlName","",3,"multiple",""],["select","formControl","",3,"multiple",""],["select","ngModel","",3,"multiple",""]],hostBindings:function(t,e){1&t&&Pa("change",(function(t){return e.onChange(t.target.value)}))("blur",(function(){return e.onTouched()}))},inputs:{compareWith:"compareWith"},features:[ws([ap])]}),t})();const up={provide:Sf,useExisting:kt(()=>lp),multi:!0};let lp=(()=>{class t{constructor(t,e){this._renderer=t,this._elementRef=e,this._optionMap=new Map,this._idCounter=0,this.onChange=t=>{},this.onTouched=()=>{},this._compareWith=Object.is}set compareWith(t){if("function"!=typeof t)throw new Error("compareWith must be a function, but received "+JSON.stringify(t));this._compareWith=t}writeValue(t){let e;if(this.value=t,Array.isArray(t)){const n=t.map(t=>this._getOptionId(t));e=(t,e)=>{t._setSelected(n.indexOf(e.toString())>-1)}}else e=(t,e)=>{t._setSelected(!1)};this._optionMap.forEach(e)}registerOnChange(t){this.onChange=e=>{const n=[];if(void 0!==e.selectedOptions){const t=e.selectedOptions;for(let e=0;e<t.length;e++){const r=t.item(e),i=this._getOptionValue(r.value);n.push(i)}}else{const t=e.options;for(let e=0;e<t.length;e++){const r=t.item(e);if(r.selected){const t=this._getOptionValue(r.value);n.push(t)}}}this.value=n,t(n)}}registerOnTouched(t){this.onTouched=t}setDisabledState(t){this._renderer.setProperty(this._elementRef.nativeElement,"disabled",t)}_registerOption(t){const e=(this._idCounter++).toString();return this._optionMap.set(e,t),e}_getOptionId(t){for(const e of Array.from(this._optionMap.keys()))if(this._compareWith(this._optionMap.get(e)._value,t))return e;return null}_getOptionValue(t){const e=function(t){return t.split(":")[0]}(t);return this._optionMap.has(e)?this._optionMap.get(e)._value:t}}return t.\u0275fac=function(e){return new(e||t)(ka(As),ka(ks))},t.\u0275dir=we({type:t,selectors:[["select","multiple","","formControlName",""],["select","multiple","","formControl",""],["select","multiple","","ngModel",""]],hostBindings:function(t,e){1&t&&Pa("change",(function(t){return e.onChange(t.target)}))("blur",(function(){return e.onTouched()}))},inputs:{compareWith:"compareWith"},features:[ws([up])]}),t})();function cp(t,e){return[...e.path,t]}function hp(t,e){t||mp(e,"Cannot find control with"),e.valueAccessor||mp(e,"No value accessor for form control with"),t.validator=Wf.compose([t.validator,e.validator]),t.asyncValidator=Wf.composeAsync([t.asyncValidator,e.asyncValidator]),e.valueAccessor.writeValue(t.value),function(t,e){e.valueAccessor.registerOnChange(n=>{t._pendingValue=n,t._pendingChange=!0,t._pendingDirty=!0,"change"===t.updateOn&&dp(t,e)})}(t,e),function(t,e){t.registerOnChange((t,n)=>{e.valueAccessor.writeValue(t),n&&e.viewToModelUpdate(t)})}(t,e),function(t,e){e.valueAccessor.registerOnTouched(()=>{t._pendingTouched=!0,"blur"===t.updateOn&&t._pendingChange&&dp(t,e),"submit"!==t.updateOn&&t.markAsTouched()})}(t,e),e.valueAccessor.setDisabledState&&t.registerOnDisabledChange(t=>{e.valueAccessor.setDisabledState(t)}),e._rawValidators.forEach(e=>{e.registerOnValidatorChange&&e.registerOnValidatorChange(()=>t.updateValueAndValidity())}),e._rawAsyncValidators.forEach(e=>{e.registerOnValidatorChange&&e.registerOnValidatorChange(()=>t.updateValueAndValidity())})}function dp(t,e){t._pendingDirty&&t.markAsDirty(),t.setValue(t._pendingValue,{emitModelToViewChange:!1}),e.viewToModelUpdate(t._pendingValue),t._pendingChange=!1}function fp(t,e){null==t&&mp(e,"Cannot find control with"),t.validator=Wf.compose([t.validator,e.validator]),t.asyncValidator=Wf.composeAsync([t.asyncValidator,e.asyncValidator])}function pp(t){return mp(t,"There is no FormControl instance attached to form control element with")}function mp(t,e){let n;throw n=t.path.length>1?`path: '${t.path.join(" -> ")}'`:t.path[0]?`name: '${t.path}'`:"unspecified name attribute",new Error(`${e} ${n}`)}function gp(t){return null!=t?Wf.compose(t.map(Xf)):null}function yp(t){return null!=t?Wf.composeAsync(t.map(Kf)):null}const vp=[Of,np,Zf,sp,lp,tp];function bp(t,e){t._syncPendingControls(),e.forEach(t=>{const e=t.control;"submit"===e.updateOn&&e._pendingChange&&(t.viewToModelUpdate(e._pendingValue),e._pendingChange=!1)})}function wp(t,e){const n=t.indexOf(e);n>-1&&t.splice(n,1)}function xp(t){const e=Cp(t)?t.validators:t;return Array.isArray(e)?gp(e):e||null}function _p(t,e){const n=Cp(e)?e.asyncValidators:t;return Array.isArray(n)?yp(n):n||null}function Cp(t){return null!=t&&!Array.isArray(t)&&"object"==typeof t}class kp{constructor(t,e){this.validator=t,this.asyncValidator=e,this._onCollectionChange=()=>{},this.pristine=!0,this.touched=!1,this._onDisabledChange=[]}get parent(){return this._parent}get valid(){return"VALID"===this.status}get invalid(){return"INVALID"===this.status}get pending(){return"PENDING"==this.status}get disabled(){return"DISABLED"===this.status}get enabled(){return"DISABLED"!==this.status}get dirty(){return!this.pristine}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(t){this.validator=xp(t)}setAsyncValidators(t){this.asyncValidator=_p(t)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(t={}){this.touched=!0,this._parent&&!t.onlySelf&&this._parent.markAsTouched(t)}markAllAsTouched(){this.markAsTouched({onlySelf:!0}),this._forEachChild(t=>t.markAllAsTouched())}markAsUntouched(t={}){this.touched=!1,this._pendingTouched=!1,this._forEachChild(t=>{t.markAsUntouched({onlySelf:!0})}),this._parent&&!t.onlySelf&&this._parent._updateTouched(t)}markAsDirty(t={}){this.pristine=!1,this._parent&&!t.onlySelf&&this._parent.markAsDirty(t)}markAsPristine(t={}){this.pristine=!0,this._pendingDirty=!1,this._forEachChild(t=>{t.markAsPristine({onlySelf:!0})}),this._parent&&!t.onlySelf&&this._parent._updatePristine(t)}markAsPending(t={}){this.status="PENDING",!1!==t.emitEvent&&this.statusChanges.emit(this.status),this._parent&&!t.onlySelf&&this._parent.markAsPending(t)}disable(t={}){const e=this._parentMarkedDirty(t.onlySelf);this.status="DISABLED",this.errors=null,this._forEachChild(e=>{e.disable(Object.assign(Object.assign({},t),{onlySelf:!0}))}),this._updateValue(),!1!==t.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors(Object.assign(Object.assign({},t),{skipPristineCheck:e})),this._onDisabledChange.forEach(t=>t(!0))}enable(t={}){const e=this._parentMarkedDirty(t.onlySelf);this.status="VALID",this._forEachChild(e=>{e.enable(Object.assign(Object.assign({},t),{onlySelf:!0}))}),this.updateValueAndValidity({onlySelf:!0,emitEvent:t.emitEvent}),this._updateAncestors(Object.assign(Object.assign({},t),{skipPristineCheck:e})),this._onDisabledChange.forEach(t=>t(!1))}_updateAncestors(t){this._parent&&!t.onlySelf&&(this._parent.updateValueAndValidity(t),t.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}setParent(t){this._parent=t}updateValueAndValidity(t={}){this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),"VALID"!==this.status&&"PENDING"!==this.status||this._runAsyncValidator(t.emitEvent)),!1!==t.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!t.onlySelf&&this._parent.updateValueAndValidity(t)}_updateTreeValidity(t={emitEvent:!0}){this._forEachChild(e=>e._updateTreeValidity(t)),this.updateValueAndValidity({onlySelf:!0,emitEvent:t.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?"DISABLED":"VALID"}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(t){if(this.asyncValidator){this.status="PENDING";const e=Hf(this.asyncValidator(this));this._asyncValidationSubscription=e.subscribe(e=>this.setErrors(e,{emitEvent:t}))}}_cancelExistingSubscription(){this._asyncValidationSubscription&&this._asyncValidationSubscription.unsubscribe()}setErrors(t,e={}){this.errors=t,this._updateControlsErrors(!1!==e.emitEvent)}get(t){return function(t,e,n){if(null==e)return null;if(Array.isArray(e)||(e=e.split(".")),Array.isArray(e)&&0===e.length)return null;let r=t;return e.forEach(t=>{r=r instanceof Ep?r.controls.hasOwnProperty(t)?r.controls[t]:null:r instanceof Op&&r.at(t)||null}),r}(this,t)}getError(t,e){const n=e?this.get(e):this;return n&&n.errors?n.errors[t]:null}hasError(t,e){return!!this.getError(t,e)}get root(){let t=this;for(;t._parent;)t=t._parent;return t}_updateControlsErrors(t){this.status=this._calculateStatus(),t&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(t)}_initObservables(){this.valueChanges=new vu,this.statusChanges=new vu}_calculateStatus(){return this._allControlsDisabled()?"DISABLED":this.errors?"INVALID":this._anyControlsHaveStatus("PENDING")?"PENDING":this._anyControlsHaveStatus("INVALID")?"INVALID":"VALID"}_anyControlsHaveStatus(t){return this._anyControls(e=>e.status===t)}_anyControlsDirty(){return this._anyControls(t=>t.dirty)}_anyControlsTouched(){return this._anyControls(t=>t.touched)}_updatePristine(t={}){this.pristine=!this._anyControlsDirty(),this._parent&&!t.onlySelf&&this._parent._updatePristine(t)}_updateTouched(t={}){this.touched=this._anyControlsTouched(),this._parent&&!t.onlySelf&&this._parent._updateTouched(t)}_isBoxedValue(t){return"object"==typeof t&&null!==t&&2===Object.keys(t).length&&"value"in t&&"disabled"in t}_registerOnCollectionChange(t){this._onCollectionChange=t}_setUpdateStrategy(t){Cp(t)&&null!=t.updateOn&&(this._updateOn=t.updateOn)}_parentMarkedDirty(t){return!t&&this._parent&&this._parent.dirty&&!this._parent._anyControlsDirty()}}class Sp extends kp{constructor(t=null,e,n){super(xp(e),_p(n,e)),this._onChange=[],this._applyFormState(t),this._setUpdateStrategy(e),this.updateValueAndValidity({onlySelf:!0,emitEvent:!1}),this._initObservables()}setValue(t,e={}){this.value=this._pendingValue=t,this._onChange.length&&!1!==e.emitModelToViewChange&&this._onChange.forEach(t=>t(this.value,!1!==e.emitViewToModelChange)),this.updateValueAndValidity(e)}patchValue(t,e={}){this.setValue(t,e)}reset(t=null,e={}){this._applyFormState(t),this.markAsPristine(e),this.markAsUntouched(e),this.setValue(this.value,e),this._pendingChange=!1}_updateValue(){}_anyControls(t){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(t){this._onChange.push(t)}_clearChangeFns(){this._onChange=[],this._onDisabledChange=[],this._onCollectionChange=()=>{}}registerOnDisabledChange(t){this._onDisabledChange.push(t)}_forEachChild(t){}_syncPendingControls(){return!("submit"!==this.updateOn||(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),!this._pendingChange)||(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),0))}_applyFormState(t){this._isBoxedValue(t)?(this.value=this._pendingValue=t.value,t.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=t}}class Ep extends kp{constructor(t,e,n){super(xp(e),_p(n,e)),this.controls=t,this._initObservables(),this._setUpdateStrategy(e),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!1})}registerControl(t,e){return this.controls[t]?this.controls[t]:(this.controls[t]=e,e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange),e)}addControl(t,e){this.registerControl(t,e),this.updateValueAndValidity(),this._onCollectionChange()}removeControl(t){this.controls[t]&&this.controls[t]._registerOnCollectionChange(()=>{}),delete this.controls[t],this.updateValueAndValidity(),this._onCollectionChange()}setControl(t,e){this.controls[t]&&this.controls[t]._registerOnCollectionChange(()=>{}),delete this.controls[t],e&&this.registerControl(t,e),this.updateValueAndValidity(),this._onCollectionChange()}contains(t){return this.controls.hasOwnProperty(t)&&this.controls[t].enabled}setValue(t,e={}){this._checkAllValuesPresent(t),Object.keys(t).forEach(n=>{this._throwIfControlMissing(n),this.controls[n].setValue(t[n],{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e)}patchValue(t,e={}){Object.keys(t).forEach(n=>{this.controls[n]&&this.controls[n].patchValue(t[n],{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e)}reset(t={},e={}){this._forEachChild((n,r)=>{n.reset(t[r],{onlySelf:!0,emitEvent:e.emitEvent})}),this._updatePristine(e),this._updateTouched(e),this.updateValueAndValidity(e)}getRawValue(){return this._reduceChildren({},(t,e,n)=>(t[n]=e instanceof Sp?e.value:e.getRawValue(),t))}_syncPendingControls(){let t=this._reduceChildren(!1,(t,e)=>!!e._syncPendingControls()||t);return t&&this.updateValueAndValidity({onlySelf:!0}),t}_throwIfControlMissing(t){if(!Object.keys(this.controls).length)throw new Error("\n        There are no form controls registered with this group yet.  If you're using ngModel,\n        you may want to check next tick (e.g. use setTimeout).\n      ");if(!this.controls[t])throw new Error(`Cannot find form control with name: ${t}.`)}_forEachChild(t){Object.keys(this.controls).forEach(e=>t(this.controls[e],e))}_setUpControls(){this._forEachChild(t=>{t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(t){for(const e of Object.keys(this.controls)){const n=this.controls[e];if(this.contains(e)&&t(n))return!0}return!1}_reduceValue(){return this._reduceChildren({},(t,e,n)=>((e.enabled||this.disabled)&&(t[n]=e.value),t))}_reduceChildren(t,e){let n=t;return this._forEachChild((t,r)=>{n=e(n,t,r)}),n}_allControlsDisabled(){for(const t of Object.keys(this.controls))if(this.controls[t].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}_checkAllValuesPresent(t){this._forEachChild((e,n)=>{if(void 0===t[n])throw new Error(`Must supply a value for form control with name: '${n}'.`)})}}class Op extends kp{constructor(t,e,n){super(xp(e),_p(n,e)),this.controls=t,this._initObservables(),this._setUpdateStrategy(e),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!1})}at(t){return this.controls[t]}push(t){this.controls.push(t),this._registerControl(t),this.updateValueAndValidity(),this._onCollectionChange()}insert(t,e){this.controls.splice(t,0,e),this._registerControl(e),this.updateValueAndValidity()}removeAt(t){this.controls[t]&&this.controls[t]._registerOnCollectionChange(()=>{}),this.controls.splice(t,1),this.updateValueAndValidity()}setControl(t,e){this.controls[t]&&this.controls[t]._registerOnCollectionChange(()=>{}),this.controls.splice(t,1),e&&(this.controls.splice(t,0,e),this._registerControl(e)),this.updateValueAndValidity(),this._onCollectionChange()}get length(){return this.controls.length}setValue(t,e={}){this._checkAllValuesPresent(t),t.forEach((t,n)=>{this._throwIfControlMissing(n),this.at(n).setValue(t,{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e)}patchValue(t,e={}){t.forEach((t,n)=>{this.at(n)&&this.at(n).patchValue(t,{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e)}reset(t=[],e={}){this._forEachChild((n,r)=>{n.reset(t[r],{onlySelf:!0,emitEvent:e.emitEvent})}),this._updatePristine(e),this._updateTouched(e),this.updateValueAndValidity(e)}getRawValue(){return this.controls.map(t=>t instanceof Sp?t.value:t.getRawValue())}clear(){this.controls.length<1||(this._forEachChild(t=>t._registerOnCollectionChange(()=>{})),this.controls.splice(0),this.updateValueAndValidity())}_syncPendingControls(){let t=this.controls.reduce((t,e)=>!!e._syncPendingControls()||t,!1);return t&&this.updateValueAndValidity({onlySelf:!0}),t}_throwIfControlMissing(t){if(!this.controls.length)throw new Error("\n        There are no form controls registered with this array yet.  If you're using ngModel,\n        you may want to check next tick (e.g. use setTimeout).\n      ");if(!this.at(t))throw new Error("Cannot find form control at index "+t)}_forEachChild(t){this.controls.forEach((e,n)=>{t(e,n)})}_updateValue(){this.value=this.controls.filter(t=>t.enabled||this.disabled).map(t=>t.value)}_anyControls(t){return this.controls.some(e=>e.enabled&&t(e))}_setUpControls(){this._forEachChild(t=>this._registerControl(t))}_checkAllValuesPresent(t){this._forEachChild((e,n)=>{if(void 0===t[n])throw new Error(`Must supply a value for form control at index: ${n}.`)})}_allControlsDisabled(){for(const t of this.controls)if(t.enabled)return!1;return this.controls.length>0||this.disabled}_registerControl(t){t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange)}}const Ap={provide:Rf,useExisting:kt(()=>Tp)},Np=(()=>Promise.resolve(null))();let Tp=(()=>{class t extends Rf{constructor(t,e){super(),this.submitted=!1,this._directives=[],this.ngSubmit=new vu,this.form=new Ep({},gp(t),yp(e))}ngAfterViewInit(){this._setUpdateStrategy()}get formDirective(){return this}get control(){return this.form}get path(){return[]}get controls(){return this.form.controls}addControl(t){Np.then(()=>{const e=this._findContainer(t.path);t.control=e.registerControl(t.name,t.control),hp(t.control,t),t.control.updateValueAndValidity({emitEvent:!1}),this._directives.push(t)})}getControl(t){return this.form.get(t.path)}removeControl(t){Np.then(()=>{const e=this._findContainer(t.path);e&&e.removeControl(t.name),wp(this._directives,t)})}addFormGroup(t){Np.then(()=>{const e=this._findContainer(t.path),n=new Ep({});fp(n,t),e.registerControl(t.name,n),n.updateValueAndValidity({emitEvent:!1})})}removeFormGroup(t){Np.then(()=>{const e=this._findContainer(t.path);e&&e.removeControl(t.name)})}getFormGroup(t){return this.form.get(t.path)}updateModel(t,e){Np.then(()=>{this.form.get(t.path).setValue(e)})}setValue(t){this.control.setValue(t)}onSubmit(t){return this.submitted=!0,bp(this.form,this._directives),this.ngSubmit.emit(t),!1}onReset(){this.resetForm()}resetForm(t){this.form.reset(t),this.submitted=!1}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.form._updateOn=this.options.updateOn)}_findContainer(t){return t.pop(),t.length?this.form.get(t):this.form}}return t.\u0275fac=function(e){return new(e||t)(ka(Uf,10),ka($f,10))},t.\u0275dir=we({type:t,selectors:[["form",3,"ngNoForm","",3,"formGroup",""],["ng-form"],["","ngForm",""]],hostBindings:function(t,e){1&t&&Pa("submit",(function(t){return e.onSubmit(t)}))("reset",(function(){return e.onReset()}))},inputs:{options:["ngFormOptions","options"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[ws([Ap]),us]}),t})(),Dp=(()=>{class t extends Rf{ngOnInit(){this._checkParentType(),this.formDirective.addFormGroup(this)}ngOnDestroy(){this.formDirective&&this.formDirective.removeFormGroup(this)}get control(){return this.formDirective.getFormGroup(this)}get path(){return cp(null==this.name?this.name:this.name.toString(),this._parent)}get formDirective(){return this._parent?this._parent.formDirective:null}get validator(){return gp(this._validators)}get asyncValidator(){return yp(this._asyncValidators)}_checkParentType(){}}return t.\u0275fac=function(e){return Rp(e||t)},t.\u0275dir=we({type:t,features:[us]}),t})();const Rp=fr(Dp);let Ip=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275dir=we({type:t,selectors:[["form",3,"ngNoForm","",3,"ngNativeValidate",""]],hostAttrs:["novalidate",""]}),t})();const Mp=new Lt("NgModelWithFormControlWarning"),Fp={provide:Rf,useExisting:kt(()=>Pp)};let Pp=(()=>{class t extends Rf{constructor(t,e){super(),this._validators=t,this._asyncValidators=e,this.submitted=!1,this.directives=[],this.form=null,this.ngSubmit=new vu}ngOnChanges(t){this._checkFormPresent(),t.hasOwnProperty("form")&&(this._updateValidators(),this._updateDomValue(),this._updateRegistrations())}get formDirective(){return this}get control(){return this.form}get path(){return[]}addControl(t){const e=this.form.get(t.path);return hp(e,t),e.updateValueAndValidity({emitEvent:!1}),this.directives.push(t),e}getControl(t){return this.form.get(t.path)}removeControl(t){wp(this.directives,t)}addFormGroup(t){const e=this.form.get(t.path);fp(e,t),e.updateValueAndValidity({emitEvent:!1})}removeFormGroup(t){}getFormGroup(t){return this.form.get(t.path)}addFormArray(t){const e=this.form.get(t.path);fp(e,t),e.updateValueAndValidity({emitEvent:!1})}removeFormArray(t){}getFormArray(t){return this.form.get(t.path)}updateModel(t,e){this.form.get(t.path).setValue(e)}onSubmit(t){return this.submitted=!0,bp(this.form,this.directives),this.ngSubmit.emit(t),!1}onReset(){this.resetForm()}resetForm(t){this.form.reset(t),this.submitted=!1}_updateDomValue(){this.directives.forEach(t=>{const e=this.form.get(t.path);t.control!==e&&(function(t,e){e.valueAccessor.registerOnChange(()=>pp(e)),e.valueAccessor.registerOnTouched(()=>pp(e)),e._rawValidators.forEach(t=>{t.registerOnValidatorChange&&t.registerOnValidatorChange(null)}),e._rawAsyncValidators.forEach(t=>{t.registerOnValidatorChange&&t.registerOnValidatorChange(null)}),t&&t._clearChangeFns()}(t.control,t),e&&hp(e,t),t.control=e)}),this.form._updateTreeValidity({emitEvent:!1})}_updateRegistrations(){this.form._registerOnCollectionChange(()=>this._updateDomValue()),this._oldForm&&this._oldForm._registerOnCollectionChange(()=>{}),this._oldForm=this.form}_updateValidators(){const t=gp(this._validators);this.form.validator=Wf.compose([this.form.validator,t]);const e=yp(this._asyncValidators);this.form.asyncValidator=Wf.composeAsync([this.form.asyncValidator,e])}_checkFormPresent(){this.form||op.missingFormException()}}return t.\u0275fac=function(e){return new(e||t)(ka(Uf,10),ka($f,10))},t.\u0275dir=we({type:t,selectors:[["","formGroup",""]],hostBindings:function(t,e){1&t&&Pa("submit",(function(t){return e.onSubmit(t)}))("reset",(function(){return e.onReset()}))},inputs:{form:["formGroup","form"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[ws([Fp]),us,Ie]}),t})();const jp={provide:Rf,useExisting:kt(()=>zp)};let zp=(()=>{class t extends Dp{constructor(t,e,n){super(),this._parent=t,this._validators=e,this._asyncValidators=n}_checkParentType(){Up(this._parent)&&op.groupParentException()}}return t.\u0275fac=function(e){return new(e||t)(ka(Rf,13),ka(Uf,10),ka($f,10))},t.\u0275dir=we({type:t,selectors:[["","formGroupName",""]],inputs:{name:["formGroupName","name"]},features:[ws([jp]),us]}),t})();const Lp={provide:Rf,useExisting:kt(()=>Bp)};let Bp=(()=>{class t extends Rf{constructor(t,e,n){super(),this._parent=t,this._validators=e,this._asyncValidators=n}ngOnInit(){this._checkParentType(),this.formDirective.addFormArray(this)}ngOnDestroy(){this.formDirective&&this.formDirective.removeFormArray(this)}get control(){return this.formDirective.getFormArray(this)}get formDirective(){return this._parent?this._parent.formDirective:null}get path(){return cp(null==this.name?this.name:this.name.toString(),this._parent)}get validator(){return gp(this._validators)}get asyncValidator(){return yp(this._asyncValidators)}_checkParentType(){Up(this._parent)&&op.arrayParentException()}}return t.\u0275fac=function(e){return new(e||t)(ka(Rf,13),ka(Uf,10),ka($f,10))},t.\u0275dir=we({type:t,selectors:[["","formArrayName",""]],inputs:{name:["formArrayName","name"]},features:[ws([Lp]),us]}),t})();function Up(t){return!(t instanceof zp||t instanceof Pp||t instanceof Bp)}const $p={provide:Ff,useExisting:kt(()=>Vp)};let Vp=(()=>{class t extends Ff{constructor(t,e,n,r,i){super(),this._ngModelWarningConfig=i,this._added=!1,this.update=new vu,this._ngModelWarningSent=!1,this._parent=t,this._rawValidators=e||[],this._rawAsyncValidators=n||[],this.valueAccessor=function(t,e){if(!e)return null;Array.isArray(e)||mp(t,"Value accessor was not provided as an array for form control with");let n=void 0,r=void 0,i=void 0;return e.forEach(e=>{var o;e.constructor===Tf?n=e:(o=e,vp.some(t=>o.constructor===t)?(r&&mp(t,"More than one built-in value accessor matches form control with"),r=e):(i&&mp(t,"More than one custom value accessor matches form control with"),i=e))}),i||r||n||(mp(t,"No valid value accessor for form control with"),null)}(this,r)}set isDisabled(t){op.disabledAttrWarning()}ngOnChanges(e){var n,r;this._added||this._setUpControl(),function(t,e){if(!t.hasOwnProperty("model"))return!1;const n=t.model;return!!n.isFirstChange()||!Object.is(e,n.currentValue)}(e,this.viewModel)&&("formControlName",n=t,this,r=this._ngModelWarningConfig,Nr()&&"never"!==r&&((null!==r&&"once"!==r||n._ngModelWarningSentOnce)&&("always"!==r||this._ngModelWarningSent)||(op.ngModelWarning("formControlName"),n._ngModelWarningSentOnce=!0,this._ngModelWarningSent=!0)),this.viewModel=this.model,this.formDirective.updateModel(this,this.model))}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}viewToModelUpdate(t){this.viewModel=t,this.update.emit(t)}get path(){return cp(null==this.name?this.name:this.name.toString(),this._parent)}get formDirective(){return this._parent?this._parent.formDirective:null}get validator(){return gp(this._rawValidators)}get asyncValidator(){return yp(this._rawAsyncValidators)}_checkParentType(){!(this._parent instanceof zp)&&this._parent instanceof Dp?op.ngModelGroupException():this._parent instanceof zp||this._parent instanceof Pp||this._parent instanceof Bp||op.controlParentException()}_setUpControl(){this._checkParentType(),this.control=this.formDirective.addControl(this),this.control.disabled&&this.valueAccessor.setDisabledState&&this.valueAccessor.setDisabledState(!0),this._added=!0}}return t.\u0275fac=function(e){return new(e||t)(ka(Rf,13),ka(Uf,10),ka($f,10),ka(Sf,10),ka(Mp,8))},t.\u0275dir=we({type:t,selectors:[["","formControlName",""]],inputs:{isDisabled:["disabled","isDisabled"],name:["formControlName","name"],model:["ngModel","model"]},outputs:{update:"ngModelChange"},features:[ws([$p]),us,Ie]}),t._ngModelWarningSentOnce=!1,t})(),Wp=(()=>{class t{}return t.\u0275mod=ve({type:t}),t.\u0275inj=dt({factory:function(e){return new(e||t)}}),t})(),qp=(()=>{class t{group(t,e=null){const n=this._reduceControls(t);let r=null,i=null,o=void 0;return null!=e&&(function(t){return void 0!==t.asyncValidators||void 0!==t.validators||void 0!==t.updateOn}(e)?(r=null!=e.validators?e.validators:null,i=null!=e.asyncValidators?e.asyncValidators:null,o=null!=e.updateOn?e.updateOn:void 0):(r=null!=e.validator?e.validator:null,i=null!=e.asyncValidator?e.asyncValidator:null)),new Ep(n,{asyncValidators:i,updateOn:o,validators:r})}control(t,e,n){return new Sp(t,e,n)}array(t,e,n){const r=t.map(t=>this._createControl(t));return new Op(r,e,n)}_reduceControls(t){const e={};return Object.keys(t).forEach(n=>{e[n]=this._createControl(t[n])}),e}_createControl(t){return t instanceof Sp||t instanceof Ep||t instanceof Op?t:Array.isArray(t)?this.control(t[0],t.length>1?t[1]:null,t.length>2?t[2]:null):this.control(t)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=ht({token:t,factory:t.\u0275fac}),t})(),Hp=(()=>{class t{}return t.\u0275mod=ve({type:t}),t.\u0275inj=dt({factory:function(e){return new(e||t)},providers:[Jf],imports:[Wp]}),t})(),Gp=(()=>{class t{static withConfig(e){return{ngModule:t,providers:[{provide:Mp,useValue:e.warnOnNgModelWithFormControl}]}}}return t.\u0275mod=ve({type:t}),t.\u0275inj=dt({factory:function(e){return new(e||t)},providers:[qp,Jf],imports:[Wp]}),t})();function Xp(...t){let e=t[t.length-1];return S(e)?(t.pop(),z(t,e)):W(t)}function Kp(t,e){return B(t,e,1)}function Yp(t,e){return function(n){return n.lift(new Zp(t,e))}}class Zp{constructor(t,e){this.predicate=t,this.thisArg=e}call(t,e){return e.subscribe(new Qp(t,this.predicate,this.thisArg))}}class Qp extends p{constructor(t,e,n){super(t),this.predicate=e,this.thisArg=n,this.count=0}_next(t){let e;try{e=this.predicate.call(this.thisArg,t,this.count++)}catch(n){return void this.destination.error(n)}e&&this.destination.next(t)}}class Jp{}class tm{}class em{constructor(t){this.normalizedNames=new Map,this.lazyUpdate=null,t?this.lazyInit="string"==typeof t?()=>{this.headers=new Map,t.split("\n").forEach(t=>{const e=t.indexOf(":");if(e>0){const n=t.slice(0,e),r=n.toLowerCase(),i=t.slice(e+1).trim();this.maybeSetNormalizedName(n,r),this.headers.has(r)?this.headers.get(r).push(i):this.headers.set(r,[i])}})}:()=>{this.headers=new Map,Object.keys(t).forEach(e=>{let n=t[e];const r=e.toLowerCase();"string"==typeof n&&(n=[n]),n.length>0&&(this.headers.set(r,n),this.maybeSetNormalizedName(e,r))})}:this.headers=new Map}has(t){return this.init(),this.headers.has(t.toLowerCase())}get(t){this.init();const e=this.headers.get(t.toLowerCase());return e&&e.length>0?e[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(t){return this.init(),this.headers.get(t.toLowerCase())||null}append(t,e){return this.clone({name:t,value:e,op:"a"})}set(t,e){return this.clone({name:t,value:e,op:"s"})}delete(t,e){return this.clone({name:t,value:e,op:"d"})}maybeSetNormalizedName(t,e){this.normalizedNames.has(e)||this.normalizedNames.set(e,t)}init(){this.lazyInit&&(this.lazyInit instanceof em?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(t=>this.applyUpdate(t)),this.lazyUpdate=null))}copyFrom(t){t.init(),Array.from(t.headers.keys()).forEach(e=>{this.headers.set(e,t.headers.get(e)),this.normalizedNames.set(e,t.normalizedNames.get(e))})}clone(t){const e=new em;return e.lazyInit=this.lazyInit&&this.lazyInit instanceof em?this.lazyInit:this,e.lazyUpdate=(this.lazyUpdate||[]).concat([t]),e}applyUpdate(t){const e=t.name.toLowerCase();switch(t.op){case"a":case"s":let n=t.value;if("string"==typeof n&&(n=[n]),0===n.length)return;this.maybeSetNormalizedName(t.name,e);const r=("a"===t.op?this.headers.get(e):void 0)||[];r.push(...n),this.headers.set(e,r);break;case"d":const i=t.value;if(i){let t=this.headers.get(e);if(!t)return;t=t.filter(t=>-1===i.indexOf(t)),0===t.length?(this.headers.delete(e),this.normalizedNames.delete(e)):this.headers.set(e,t)}else this.headers.delete(e),this.normalizedNames.delete(e)}}forEach(t){this.init(),Array.from(this.normalizedNames.keys()).forEach(e=>t(this.normalizedNames.get(e),this.headers.get(e)))}}class nm{encodeKey(t){return rm(t)}encodeValue(t){return rm(t)}decodeKey(t){return decodeURIComponent(t)}decodeValue(t){return decodeURIComponent(t)}}function rm(t){return encodeURIComponent(t).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/gi,"$").replace(/%2C/gi,",").replace(/%3B/gi,";").replace(/%2B/gi,"+").replace(/%3D/gi,"=").replace(/%3F/gi,"?").replace(/%2F/gi,"/")}class im{constructor(t={}){if(this.updates=null,this.cloneFrom=null,this.encoder=t.encoder||new nm,t.fromString){if(t.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=function(t,e){const n=new Map;return t.length>0&&t.split("&").forEach(t=>{const r=t.indexOf("="),[i,o]=-1==r?[e.decodeKey(t),""]:[e.decodeKey(t.slice(0,r)),e.decodeValue(t.slice(r+1))],a=n.get(i)||[];a.push(o),n.set(i,a)}),n}(t.fromString,this.encoder)}else t.fromObject?(this.map=new Map,Object.keys(t.fromObject).forEach(e=>{const n=t.fromObject[e];this.map.set(e,Array.isArray(n)?n:[n])})):this.map=null}has(t){return this.init(),this.map.has(t)}get(t){this.init();const e=this.map.get(t);return e?e[0]:null}getAll(t){return this.init(),this.map.get(t)||null}keys(){return this.init(),Array.from(this.map.keys())}append(t,e){return this.clone({param:t,value:e,op:"a"})}set(t,e){return this.clone({param:t,value:e,op:"s"})}delete(t,e){return this.clone({param:t,value:e,op:"d"})}toString(){return this.init(),this.keys().map(t=>{const e=this.encoder.encodeKey(t);return this.map.get(t).map(t=>e+"="+this.encoder.encodeValue(t)).join("&")}).filter(t=>""!==t).join("&")}clone(t){const e=new im({encoder:this.encoder});return e.cloneFrom=this.cloneFrom||this,e.updates=(this.updates||[]).concat([t]),e}init(){null===this.map&&(this.map=new Map),null!==this.cloneFrom&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(t=>this.map.set(t,this.cloneFrom.map.get(t))),this.updates.forEach(t=>{switch(t.op){case"a":case"s":const e=("a"===t.op?this.map.get(t.param):void 0)||[];e.push(t.value),this.map.set(t.param,e);break;case"d":if(void 0===t.value){this.map.delete(t.param);break}{let e=this.map.get(t.param)||[];const n=e.indexOf(t.value);-1!==n&&e.splice(n,1),e.length>0?this.map.set(t.param,e):this.map.delete(t.param)}}}),this.cloneFrom=this.updates=null)}}function om(t){return"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer}function am(t){return"undefined"!=typeof Blob&&t instanceof Blob}function sm(t){return"undefined"!=typeof FormData&&t instanceof FormData}class um{constructor(t,e,n,r){let i;if(this.url=e,this.body=null,this.reportProgress=!1,this.withCredentials=!1,this.responseType="json",this.method=t.toUpperCase(),function(t){switch(t){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}(this.method)||r?(this.body=void 0!==n?n:null,i=r):i=n,i&&(this.reportProgress=!!i.reportProgress,this.withCredentials=!!i.withCredentials,i.responseType&&(this.responseType=i.responseType),i.headers&&(this.headers=i.headers),i.params&&(this.params=i.params)),this.headers||(this.headers=new em),this.params){const t=this.params.toString();if(0===t.length)this.urlWithParams=e;else{const n=e.indexOf("?");this.urlWithParams=e+(-1===n?"?":n<e.length-1?"&":"")+t}}else this.params=new im,this.urlWithParams=e}serializeBody(){return null===this.body?null:om(this.body)||am(this.body)||sm(this.body)||"string"==typeof this.body?this.body:this.body instanceof im?this.body.toString():"object"==typeof this.body||"boolean"==typeof this.body||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return null===this.body||sm(this.body)?null:am(this.body)?this.body.type||null:om(this.body)?null:"string"==typeof this.body?"text/plain":this.body instanceof im?"application/x-www-form-urlencoded;charset=UTF-8":"object"==typeof this.body||"number"==typeof this.body||Array.isArray(this.body)?"application/json":null}clone(t={}){const e=t.method||this.method,n=t.url||this.url,r=t.responseType||this.responseType,i=void 0!==t.body?t.body:this.body,o=void 0!==t.withCredentials?t.withCredentials:this.withCredentials,a=void 0!==t.reportProgress?t.reportProgress:this.reportProgress;let s=t.headers||this.headers,u=t.params||this.params;return void 0!==t.setHeaders&&(s=Object.keys(t.setHeaders).reduce((e,n)=>e.set(n,t.setHeaders[n]),s)),t.setParams&&(u=Object.keys(t.setParams).reduce((e,n)=>e.set(n,t.setParams[n]),u)),new um(e,n,i,{params:u,headers:s,reportProgress:a,responseType:r,withCredentials:o})}}var lm=function(t){return t[t.Sent=0]="Sent",t[t.UploadProgress=1]="UploadProgress",t[t.ResponseHeader=2]="ResponseHeader",t[t.DownloadProgress=3]="DownloadProgress",t[t.Response=4]="Response",t[t.User=5]="User",t}({});class cm{constructor(t,e=200,n="OK"){this.headers=t.headers||new em,this.status=void 0!==t.status?t.status:e,this.statusText=t.statusText||n,this.url=t.url||null,this.ok=this.status>=200&&this.status<300}}class hm extends cm{constructor(t={}){super(t),this.type=lm.ResponseHeader}clone(t={}){return new hm({headers:t.headers||this.headers,status:void 0!==t.status?t.status:this.status,statusText:t.statusText||this.statusText,url:t.url||this.url||void 0})}}class dm extends cm{constructor(t={}){super(t),this.type=lm.Response,this.body=void 0!==t.body?t.body:null}clone(t={}){return new dm({body:void 0!==t.body?t.body:this.body,headers:t.headers||this.headers,status:void 0!==t.status?t.status:this.status,statusText:t.statusText||this.statusText,url:t.url||this.url||void 0})}}class fm extends cm{constructor(t){super(t,0,"Unknown Error"),this.name="HttpErrorResponse",this.ok=!1,this.message=this.status>=200&&this.status<300?"Http failure during parsing for "+(t.url||"(unknown url)"):`Http failure response for ${t.url||"(unknown url)"}: ${t.status} ${t.statusText}`,this.error=t.error||null}}function pm(t,e){return{body:e,headers:t.headers,observe:t.observe,params:t.params,reportProgress:t.reportProgress,responseType:t.responseType,withCredentials:t.withCredentials}}let mm=(()=>{class t{constructor(t){this.handler=t}request(t,e,n={}){let r;if(t instanceof um)r=t;else{let i=void 0;i=n.headers instanceof em?n.headers:new em(n.headers);let o=void 0;n.params&&(o=n.params instanceof im?n.params:new im({fromObject:n.params})),r=new um(t,e,void 0!==n.body?n.body:null,{headers:i,params:o,reportProgress:n.reportProgress,responseType:n.responseType||"json",withCredentials:n.withCredentials})}const i=Xp(r).pipe(Kp(t=>this.handler.handle(t)));if(t instanceof um||"events"===n.observe)return i;const o=i.pipe(Yp(t=>t instanceof dm));switch(n.observe||"body"){case"body":switch(r.responseType){case"arraybuffer":return o.pipe(F(t=>{if(null!==t.body&&!(t.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return t.body}));case"blob":return o.pipe(F(t=>{if(null!==t.body&&!(t.body instanceof Blob))throw new Error("Response is not a Blob.");return t.body}));case"text":return o.pipe(F(t=>{if(null!==t.body&&"string"!=typeof t.body)throw new Error("Response is not a string.");return t.body}));case"json":default:return o.pipe(F(t=>t.body))}case"response":return o;default:throw new Error(`Unreachable: unhandled observe type ${n.observe}}`)}}delete(t,e={}){return this.request("DELETE",t,e)}get(t,e={}){return this.request("GET",t,e)}head(t,e={}){return this.request("HEAD",t,e)}jsonp(t,e){return this.request("JSONP",t,{params:(new im).append(e,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(t,e={}){return this.request("OPTIONS",t,e)}patch(t,e,n={}){return this.request("PATCH",t,pm(n,e))}post(t,e,n={}){return this.request("POST",t,pm(n,e))}put(t,e,n={}){return this.request("PUT",t,pm(n,e))}}return t.\u0275fac=function(e){return new(e||t)(Kt(Jp))},t.\u0275prov=ht({token:t,factory:t.\u0275fac}),t})();class gm{constructor(t,e){this.next=t,this.interceptor=e}handle(t){return this.interceptor.intercept(t,this.next)}}const ym=new Lt("HTTP_INTERCEPTORS");let vm=(()=>{class t{intercept(t,e){return e.handle(t)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=ht({token:t,factory:t.\u0275fac}),t})();const bm=/^\)\]\}',?\n/;class wm{}let xm=(()=>{class t{constructor(){}build(){return new XMLHttpRequest}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=ht({token:t,factory:t.\u0275fac}),t})(),_m=(()=>{class t{constructor(t){this.xhrFactory=t}handle(t){if("JSONP"===t.method)throw new Error("Attempted to construct Jsonp request without JsonpClientModule installed.");return new v(e=>{const n=this.xhrFactory.build();if(n.open(t.method,t.urlWithParams),t.withCredentials&&(n.withCredentials=!0),t.headers.forEach((t,e)=>n.setRequestHeader(t,e.join(","))),t.headers.has("Accept")||n.setRequestHeader("Accept","application/json, text/plain, */*"),!t.headers.has("Content-Type")){const e=t.detectContentTypeHeader();null!==e&&n.setRequestHeader("Content-Type",e)}if(t.responseType){const e=t.responseType.toLowerCase();n.responseType="json"!==e?e:"text"}const r=t.serializeBody();let i=null;const o=()=>{if(null!==i)return i;const e=1223===n.status?204:n.status,r=n.statusText||"OK",o=new em(n.getAllResponseHeaders()),a=function(t){return"responseURL"in t&&t.responseURL?t.responseURL:/^X-Request-URL:/m.test(t.getAllResponseHeaders())?t.getResponseHeader("X-Request-URL"):null}(n)||t.url;return i=new hm({headers:o,status:e,statusText:r,url:a}),i},a=()=>{let{headers:r,status:i,statusText:a,url:s}=o(),u=null;204!==i&&(u=void 0===n.response?n.responseText:n.response),0===i&&(i=u?200:0);let l=i>=200&&i<300;if("json"===t.responseType&&"string"==typeof u){const t=u;u=u.replace(bm,"");try{u=""!==u?JSON.parse(u):null}catch(c){u=t,l&&(l=!1,u={error:c,text:u})}}l?(e.next(new dm({body:u,headers:r,status:i,statusText:a,url:s||void 0})),e.complete()):e.error(new fm({error:u,headers:r,status:i,statusText:a,url:s||void 0}))},s=t=>{const{url:r}=o(),i=new fm({error:t,status:n.status||0,statusText:n.statusText||"Unknown Error",url:r||void 0});e.error(i)};let u=!1;const l=r=>{u||(e.next(o()),u=!0);let i={type:lm.DownloadProgress,loaded:r.loaded};r.lengthComputable&&(i.total=r.total),"text"===t.responseType&&n.responseText&&(i.partialText=n.responseText),e.next(i)},c=t=>{let n={type:lm.UploadProgress,loaded:t.loaded};t.lengthComputable&&(n.total=t.total),e.next(n)};return n.addEventListener("load",a),n.addEventListener("error",s),t.reportProgress&&(n.addEventListener("progress",l),null!==r&&n.upload&&n.upload.addEventListener("progress",c)),n.send(r),e.next({type:lm.Sent}),()=>{n.removeEventListener("error",s),n.removeEventListener("load",a),t.reportProgress&&(n.removeEventListener("progress",l),null!==r&&n.upload&&n.upload.removeEventListener("progress",c)),n.readyState!==n.DONE&&n.abort()}})}}return t.\u0275fac=function(e){return new(e||t)(Kt(wm))},t.\u0275prov=ht({token:t,factory:t.\u0275fac}),t})();const Cm=new Lt("XSRF_COOKIE_NAME"),km=new Lt("XSRF_HEADER_NAME");class Sm{}let Em,Om=(()=>{class t{constructor(t,e,n){this.doc=t,this.platform=e,this.cookieName=n,this.lastCookieString="",this.lastToken=null,this.parseCount=0}getToken(){if("server"===this.platform)return null;const t=this.doc.cookie||"";return t!==this.lastCookieString&&(this.parseCount++,this.lastToken=cc(t,this.cookieName),this.lastCookieString=t),this.lastToken}}return t.\u0275fac=function(e){return new(e||t)(Kt(zl),Kt(Hu),Kt(Cm))},t.\u0275prov=ht({token:t,factory:t.\u0275fac}),t})(),Am=(()=>{class t{constructor(t,e){this.tokenService=t,this.headerName=e}intercept(t,e){const n=t.url.toLowerCase();if("GET"===t.method||"HEAD"===t.method||n.startsWith("http://")||n.startsWith("https://"))return e.handle(t);const r=this.tokenService.getToken();return null===r||t.headers.has(this.headerName)||(t=t.clone({headers:t.headers.set(this.headerName,r)})),e.handle(t)}}return t.\u0275fac=function(e){return new(e||t)(Kt(Sm),Kt(km))},t.\u0275prov=ht({token:t,factory:t.\u0275fac}),t})(),Nm=(()=>{class t{constructor(t,e){this.backend=t,this.injector=e,this.chain=null}handle(t){if(null===this.chain){const t=this.injector.get(ym,[]);this.chain=t.reduceRight((t,e)=>new gm(t,e),this.backend)}return this.chain.handle(t)}}return t.\u0275fac=function(e){return new(e||t)(Kt(tm),Kt(ca))},t.\u0275prov=ht({token:t,factory:t.\u0275fac}),t})(),Tm=(()=>{class t{static disable(){return{ngModule:t,providers:[{provide:Am,useClass:vm}]}}static withOptions(e={}){return{ngModule:t,providers:[e.cookieName?{provide:Cm,useValue:e.cookieName}:[],e.headerName?{provide:km,useValue:e.headerName}:[]]}}}return t.\u0275mod=ve({type:t}),t.\u0275inj=dt({factory:function(e){return new(e||t)},providers:[Am,{provide:ym,useExisting:Am,multi:!0},{provide:Sm,useClass:Om},{provide:Cm,useValue:"XSRF-TOKEN"},{provide:km,useValue:"X-XSRF-TOKEN"}]}),t})(),Dm=(()=>{class t{}return t.\u0275mod=ve({type:t}),t.\u0275inj=dt({factory:function(e){return new(e||t)},providers:[mm,{provide:Jp,useClass:Nm},_m,{provide:tm,useExisting:_m},xm,{provide:wm,useExisting:xm}],imports:[[Tm.withOptions({cookieName:"XSRF-TOKEN",headerName:"X-XSRF-TOKEN"})]]}),t})();try{Em="undefined"!=typeof Intl&&Intl.v8BreakIterator}catch(uO){Em=!1}let Rm,Im=(()=>{class t{constructor(t){this._platformId=t,this.isBrowser=this._platformId?_c(this._platformId):"object"==typeof document&&!!document,this.EDGE=this.isBrowser&&/(edge)/i.test(navigator.userAgent),this.TRIDENT=this.isBrowser&&/(msie|trident)/i.test(navigator.userAgent),this.BLINK=this.isBrowser&&!(!window.chrome&&!Em)&&"undefined"!=typeof CSS&&!this.EDGE&&!this.TRIDENT,this.WEBKIT=this.isBrowser&&/AppleWebKit/i.test(navigator.userAgent)&&!this.BLINK&&!this.EDGE&&!this.TRIDENT,this.IOS=this.isBrowser&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!("MSStream"in window),this.FIREFOX=this.isBrowser&&/(firefox|minefield)/i.test(navigator.userAgent),this.ANDROID=this.isBrowser&&/android/i.test(navigator.userAgent)&&!this.TRIDENT,this.SAFARI=this.isBrowser&&/safari/i.test(navigator.userAgent)&&this.WEBKIT}}return t.\u0275fac=function(e){return new(e||t)(Kt(Hu))},t.\u0275prov=ht({factory:function(){return new t(Kt(Hu))},token:t,providedIn:"root"}),t})(),Mm=(()=>{class t{}return t.\u0275mod=ve({type:t}),t.\u0275inj=dt({factory:function(e){return new(e||t)}}),t})();const Fm=["color","button","checkbox","date","datetime-local","email","file","hidden","image","month","number","password","radio","range","reset","search","submit","tel","text","time","url","week"];function Pm(){if(Rm)return Rm;if("object"!=typeof document||!document)return Rm=new Set(Fm),Rm;let t=document.createElement("input");return Rm=new Set(Fm.filter(e=>(t.setAttribute("type",e),t.type===e))),Rm}let jm,zm;function Lm(t){return function(){if(null==jm&&"undefined"!=typeof window)try{window.addEventListener("test",null,Object.defineProperty({},"passive",{get:()=>jm=!0}))}finally{jm=jm||!1}return jm}()?t:!!t.capture}function Bm(t){if(function(){if(null==zm){const t="undefined"!=typeof document?document.head:null;zm=!(!t||!t.createShadowRoot&&!t.attachShadow)}return zm}()){const e=t.getRootNode?t.getRootNode():null;if("undefined"!=typeof ShadowRoot&&ShadowRoot&&e instanceof ShadowRoot)return e}return null}function Um(){}function $m(t,e,n){return function(r){return r.lift(new Vm(t,e,n))}}class Vm{constructor(t,e,n){this.nextOrObserver=t,this.error=e,this.complete=n}call(t,e){return e.subscribe(new Wm(t,this.nextOrObserver,this.error,this.complete))}}class Wm extends p{constructor(t,e,n,i){super(t),this._tapNext=Um,this._tapError=Um,this._tapComplete=Um,this._tapError=n||Um,this._tapComplete=i||Um,r(e)?(this._context=this,this._tapNext=e):e&&(this._context=e,this._tapNext=e.next||Um,this._tapError=e.error||Um,this._tapComplete=e.complete||Um)}_next(t){try{this._tapNext.call(this._context,t)}catch(e){return void this.destination.error(e)}this.destination.next(t)}_error(t){try{this._tapError.call(this._context,t)}catch(t){return void this.destination.error(t)}this.destination.error(t)}_complete(){try{this._tapComplete.call(this._context)}catch(t){return void this.destination.error(t)}return this.destination.complete()}}class qm extends h{constructor(t,e){super()}schedule(t,e=0){return this}}class Hm extends qm{constructor(t,e){super(t,e),this.scheduler=t,this.work=e,this.pending=!1}schedule(t,e=0){if(this.closed)return this;this.state=t;const n=this.id,r=this.scheduler;return null!=n&&(this.id=this.recycleAsyncId(r,n,e)),this.pending=!0,this.delay=e,this.id=this.id||this.requestAsyncId(r,this.id,e),this}requestAsyncId(t,e,n=0){return setInterval(t.flush.bind(t,this),n)}recycleAsyncId(t,e,n=0){if(null!==n&&this.delay===n&&!1===this.pending)return e;clearInterval(e)}execute(t,e){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const n=this._execute(t,e);if(n)return n;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(t,e){let n=!1,r=void 0;try{this.work(t)}catch(i){n=!0,r=!!i&&i||new Error(i)}if(n)return this.unsubscribe(),r}_unsubscribe(){const t=this.id,e=this.scheduler,n=e.actions,r=n.indexOf(this);this.work=null,this.state=null,this.pending=!1,this.scheduler=null,-1!==r&&n.splice(r,1),null!=t&&(this.id=this.recycleAsyncId(e,t,null)),this.delay=null}}let Gm=(()=>{class t{constructor(e,n=t.now){this.SchedulerAction=e,this.now=n}schedule(t,e=0,n){return new this.SchedulerAction(this,t).schedule(n,e)}}return t.now=()=>Date.now(),t})();class Xm extends Gm{constructor(t,e=Gm.now){super(t,()=>Xm.delegate&&Xm.delegate!==this?Xm.delegate.now():e()),this.actions=[],this.active=!1,this.scheduled=void 0}schedule(t,e=0,n){return Xm.delegate&&Xm.delegate!==this?Xm.delegate.schedule(t,e,n):super.schedule(t,e,n)}flush(t){const{actions:e}=this;if(this.active)return void e.push(t);let n;this.active=!0;do{if(n=t.execute(t.state,t.delay))break}while(t=e.shift());if(this.active=!1,n){for(;t=e.shift();)t.unsubscribe();throw n}}}const Km=new Xm(Hm);class Ym{constructor(t,e){this.dueTime=t,this.scheduler=e}call(t,e){return e.subscribe(new Zm(t,this.dueTime,this.scheduler))}}class Zm extends p{constructor(t,e,n){super(t),this.dueTime=e,this.scheduler=n,this.debouncedSubscription=null,this.lastValue=null,this.hasValue=!1}_next(t){this.clearDebounce(),this.lastValue=t,this.hasValue=!0,this.add(this.debouncedSubscription=this.scheduler.schedule(Qm,this.dueTime,this))}_complete(){this.debouncedNext(),this.destination.complete()}debouncedNext(){if(this.clearDebounce(),this.hasValue){const{lastValue:t}=this;this.lastValue=null,this.hasValue=!1,this.destination.next(t)}}clearDebounce(){const t=this.debouncedSubscription;null!==t&&(this.remove(t),t.unsubscribe(),this.debouncedSubscription=null)}}function Qm(t){t.debouncedNext()}const Jm=(()=>{function t(){return Error.call(this),this.message="argument out of range",this.name="ArgumentOutOfRangeError",this}return t.prototype=Object.create(Error.prototype),t})(),tg=new v(t=>t.complete());function eg(t){return t?function(t){return new v(e=>t.schedule(()=>e.complete()))}(t):tg}function ng(t){return e=>0===t?eg():e.lift(new rg(t))}class rg{constructor(t){if(this.total=t,this.total<0)throw new Jm}call(t,e){return e.subscribe(new ig(t,this.total))}}class ig extends p{constructor(t,e){super(t),this.total=e,this.count=0}_next(t){const e=this.total,n=++this.count;n<=e&&(this.destination.next(t),n===e&&(this.destination.complete(),this.unsubscribe()))}}function og(t){return null!=t&&""+t!="false"}function ag(t,e=0){return function(t){return!isNaN(parseFloat(t))&&!isNaN(Number(t))}(t)?Number(t):e}function sg(t){return Array.isArray(t)?t:[t]}function ug(t){return null==t?"":"string"==typeof t?t:t+"px"}function lg(t){return t instanceof ks?t.nativeElement:t}let cg=(()=>{class t{create(t){return"undefined"==typeof MutationObserver?null:new MutationObserver(t)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=ht({factory:function(){return new t},token:t,providedIn:"root"}),t})(),hg=(()=>{class t{constructor(t){this._mutationObserverFactory=t,this._observedElements=new Map}ngOnDestroy(){this._observedElements.forEach((t,e)=>this._cleanupObserver(e))}observe(t){const e=lg(t);return new v(t=>{const n=this._observeElement(e).subscribe(t);return()=>{n.unsubscribe(),this._unobserveElement(e)}})}_observeElement(t){if(this._observedElements.has(t))this._observedElements.get(t).count++;else{const e=new C,n=this._mutationObserverFactory.create(t=>e.next(t));n&&n.observe(t,{characterData:!0,childList:!0,subtree:!0}),this._observedElements.set(t,{observer:n,stream:e,count:1})}return this._observedElements.get(t).stream}_unobserveElement(t){this._observedElements.has(t)&&(this._observedElements.get(t).count--,this._observedElements.get(t).count||this._cleanupObserver(t))}_cleanupObserver(t){if(this._observedElements.has(t)){const{observer:e,stream:n}=this._observedElements.get(t);e&&e.disconnect(),n.complete(),this._observedElements.delete(t)}}}return t.\u0275fac=function(e){return new(e||t)(Kt(cg))},t.\u0275prov=ht({factory:function(){return new t(Kt(cg))},token:t,providedIn:"root"}),t})(),dg=(()=>{class t{constructor(t,e,n){this._contentObserver=t,this._elementRef=e,this._ngZone=n,this.event=new vu,this._disabled=!1,this._currentSubscription=null}get disabled(){return this._disabled}set disabled(t){this._disabled=og(t),this._disabled?this._unsubscribe():this._subscribe()}get debounce(){return this._debounce}set debounce(t){this._debounce=ag(t),this._subscribe()}ngAfterContentInit(){this._currentSubscription||this.disabled||this._subscribe()}ngOnDestroy(){this._unsubscribe()}_subscribe(){this._unsubscribe();const t=this._contentObserver.observe(this._elementRef);this._ngZone.runOutsideAngular(()=>{this._currentSubscription=(this.debounce?t.pipe(function(t,e=Km){return n=>n.lift(new Ym(t,e))}(this.debounce)):t).subscribe(this.event)})}_unsubscribe(){this._currentSubscription&&this._currentSubscription.unsubscribe()}}return t.\u0275fac=function(e){return new(e||t)(ka(hg),ka(ks),ka(sl))},t.\u0275dir=we({type:t,selectors:[["","cdkObserveContent",""]],inputs:{disabled:["cdkObserveContentDisabled","disabled"],debounce:"debounce"},outputs:{event:"cdkObserveContent"},exportAs:["cdkObserveContent"]}),t})(),fg=(()=>{class t{}return t.\u0275mod=ve({type:t}),t.\u0275inj=dt({factory:function(e){return new(e||t)},providers:[cg]}),t})(),pg=(()=>{class t{constructor(t){this._platform=t}isDisabled(t){return t.hasAttribute("disabled")}isVisible(t){return function(t){return!!(t.offsetWidth||t.offsetHeight||"function"==typeof t.getClientRects&&t.getClientRects().length)}(t)&&"visible"===getComputedStyle(t).visibility}isTabbable(t){if(!this._platform.isBrowser)return!1;const e=function(t){try{return t.frameElement}catch(uO){return null}}((n=t).ownerDocument&&n.ownerDocument.defaultView||window);var n;if(e){if(-1===gg(e))return!1;if(!this.isVisible(e))return!1}let r=t.nodeName.toLowerCase(),i=gg(t);return t.hasAttribute("contenteditable")?-1!==i:"iframe"!==r&&"object"!==r&&!(this._platform.WEBKIT&&this._platform.IOS&&!function(t){let e=t.nodeName.toLowerCase(),n="input"===e&&t.type;return"text"===n||"password"===n||"select"===e||"textarea"===e}(t))&&("audio"===r?!!t.hasAttribute("controls")&&-1!==i:"video"===r?-1!==i&&(null!==i||this._platform.FIREFOX||t.hasAttribute("controls")):t.tabIndex>=0)}isFocusable(t,e){return function(t){return!function(t){return function(t){return"input"==t.nodeName.toLowerCase()}(t)&&"hidden"==t.type}(t)&&(function(t){let e=t.nodeName.toLowerCase();return"input"===e||"select"===e||"button"===e||"textarea"===e}(t)||function(t){return function(t){return"a"==t.nodeName.toLowerCase()}(t)&&t.hasAttribute("href")}(t)||t.hasAttribute("contenteditable")||mg(t))}(t)&&!this.isDisabled(t)&&((null==e?void 0:e.ignoreVisibility)||this.isVisible(t))}}return t.\u0275fac=function(e){return new(e||t)(Kt(Im))},t.\u0275prov=ht({factory:function(){return new t(Kt(Im))},token:t,providedIn:"root"}),t})();function mg(t){if(!t.hasAttribute("tabindex")||void 0===t.tabIndex)return!1;let e=t.getAttribute("tabindex");return"-32768"!=e&&!(!e||isNaN(parseInt(e,10)))}function gg(t){if(!mg(t))return null;const e=parseInt(t.getAttribute("tabindex")||"",10);return isNaN(e)?-1:e}class yg{constructor(t,e,n,r,i=!1){this._element=t,this._checker=e,this._ngZone=n,this._document=r,this._hasAttached=!1,this.startAnchorListener=()=>this.focusLastTabbableElement(),this.endAnchorListener=()=>this.focusFirstTabbableElement(),this._enabled=!0,i||this.attachAnchors()}get enabled(){return this._enabled}set enabled(t){this._enabled=t,this._startAnchor&&this._endAnchor&&(this._toggleAnchorTabIndex(t,this._startAnchor),this._toggleAnchorTabIndex(t,this._endAnchor))}destroy(){const t=this._startAnchor,e=this._endAnchor;t&&(t.removeEventListener("focus",this.startAnchorListener),t.parentNode&&t.parentNode.removeChild(t)),e&&(e.removeEventListener("focus",this.endAnchorListener),e.parentNode&&e.parentNode.removeChild(e)),this._startAnchor=this._endAnchor=null,this._hasAttached=!1}attachAnchors(){return!!this._hasAttached||(this._ngZone.runOutsideAngular(()=>{this._startAnchor||(this._startAnchor=this._createAnchor(),this._startAnchor.addEventListener("focus",this.startAnchorListener)),this._endAnchor||(this._endAnchor=this._createAnchor(),this._endAnchor.addEventListener("focus",this.endAnchorListener))}),this._element.parentNode&&(this._element.parentNode.insertBefore(this._startAnchor,this._element),this._element.parentNode.insertBefore(this._endAnchor,this._element.nextSibling),this._hasAttached=!0),this._hasAttached)}focusInitialElementWhenReady(){return new Promise(t=>{this._executeOnStable(()=>t(this.focusInitialElement()))})}focusFirstTabbableElementWhenReady(){return new Promise(t=>{this._executeOnStable(()=>t(this.focusFirstTabbableElement()))})}focusLastTabbableElementWhenReady(){return new Promise(t=>{this._executeOnStable(()=>t(this.focusLastTabbableElement()))})}_getRegionBoundary(t){let e=this._element.querySelectorAll(`[cdk-focus-region-${t}], [cdkFocusRegion${t}], [cdk-focus-${t}]`);for(let n=0;n<e.length;n++)e[n].hasAttribute("cdk-focus-"+t)?console.warn(`Found use of deprecated attribute 'cdk-focus-${t}', use 'cdkFocusRegion${t}' instead. The deprecated attribute will be removed in 8.0.0.`,e[n]):e[n].hasAttribute("cdk-focus-region-"+t)&&console.warn(`Found use of deprecated attribute 'cdk-focus-region-${t}', use 'cdkFocusRegion${t}' instead. The deprecated attribute will be removed in 8.0.0.`,e[n]);return"start"==t?e.length?e[0]:this._getFirstTabbableElement(this._element):e.length?e[e.length-1]:this._getLastTabbableElement(this._element)}focusInitialElement(){const t=this._element.querySelector("[cdk-focus-initial], [cdkFocusInitial]");return t?(t.hasAttribute("cdk-focus-initial")&&console.warn("Found use of deprecated attribute 'cdk-focus-initial', use 'cdkFocusInitial' instead. The deprecated attribute will be removed in 8.0.0",t),Nr()&&!this._checker.isFocusable(t)&&console.warn("Element matching '[cdkFocusInitial]' is not focusable.",t),t.focus(),!0):this.focusFirstTabbableElement()}focusFirstTabbableElement(){const t=this._getRegionBoundary("start");return t&&t.focus(),!!t}focusLastTabbableElement(){const t=this._getRegionBoundary("end");return t&&t.focus(),!!t}hasAttached(){return this._hasAttached}_getFirstTabbableElement(t){if(this._checker.isFocusable(t)&&this._checker.isTabbable(t))return t;let e=t.children||t.childNodes;for(let n=0;n<e.length;n++){let t=e[n].nodeType===this._document.ELEMENT_NODE?this._getFirstTabbableElement(e[n]):null;if(t)return t}return null}_getLastTabbableElement(t){if(this._checker.isFocusable(t)&&this._checker.isTabbable(t))return t;let e=t.children||t.childNodes;for(let n=e.length-1;n>=0;n--){let t=e[n].nodeType===this._document.ELEMENT_NODE?this._getLastTabbableElement(e[n]):null;if(t)return t}return null}_createAnchor(){const t=this._document.createElement("div");return this._toggleAnchorTabIndex(this._enabled,t),t.classList.add("cdk-visually-hidden"),t.classList.add("cdk-focus-trap-anchor"),t.setAttribute("aria-hidden","true"),t}_toggleAnchorTabIndex(t,e){t?e.setAttribute("tabindex","0"):e.removeAttribute("tabindex")}toggleAnchors(t){this._startAnchor&&this._endAnchor&&(this._toggleAnchorTabIndex(t,this._startAnchor),this._toggleAnchorTabIndex(t,this._endAnchor))}_executeOnStable(t){this._ngZone.isStable?t():this._ngZone.onStable.asObservable().pipe(ng(1)).subscribe(t)}}let vg=(()=>{class t{constructor(t,e,n){this._checker=t,this._ngZone=e,this._document=n}create(t,e=!1){return new yg(t,this._checker,this._ngZone,this._document,e)}}return t.\u0275fac=function(e){return new(e||t)(Kt(pg),Kt(sl),Kt(zl))},t.\u0275prov=ht({factory:function(){return new t(Kt(pg),Kt(sl),Kt(zl))},token:t,providedIn:"root"}),t})();function bg(t){return 0===t.buttons}"undefined"!=typeof Element&&Element;const wg=new Lt("cdk-focus-monitor-default-options"),xg=Lm({passive:!0,capture:!0});let _g=(()=>{class t{constructor(t,e,n,r){this._ngZone=t,this._platform=e,this._origin=null,this._windowFocused=!1,this._elementInfo=new Map,this._monitoredElementCount=0,this._rootNodeFocusListenerCount=new Map,this._documentKeydownListener=()=>{this._lastTouchTarget=null,this._setOriginForCurrentEventQueue("keyboard")},this._documentMousedownListener=t=>{if(!this._lastTouchTarget){const e=bg(t)?"keyboard":"mouse";this._setOriginForCurrentEventQueue(e)}},this._documentTouchstartListener=t=>{null!=this._touchTimeoutId&&clearTimeout(this._touchTimeoutId),this._lastTouchTarget=Cg(t),this._touchTimeoutId=setTimeout(()=>this._lastTouchTarget=null,650)},this._windowFocusListener=()=>{this._windowFocused=!0,this._windowFocusTimeoutId=setTimeout(()=>this._windowFocused=!1)},this._rootNodeFocusAndBlurListener=t=>{const e=Cg(t),n="focus"===t.type?this._onFocus:this._onBlur;for(let r=e;r;r=r.parentElement)n.call(this,t,r)},this._document=n,this._detectionMode=(null==r?void 0:r.detectionMode)||0}monitor(t,e=!1){if(!this._platform.isBrowser)return Xp(null);const n=lg(t),r=Bm(n)||this._getDocument(),i=this._elementInfo.get(n);if(i)return e&&(i.checkChildren=!0),i.subject.asObservable();const o={checkChildren:e,subject:new C,rootNode:r};return this._elementInfo.set(n,o),this._registerGlobalListeners(o),o.subject.asObservable()}stopMonitoring(t){const e=lg(t),n=this._elementInfo.get(e);n&&(n.subject.complete(),this._setClasses(e),this._elementInfo.delete(e),this._removeGlobalListeners(n))}focusVia(t,e,n){const r=lg(t);this._setOriginForCurrentEventQueue(e),"function"==typeof r.focus&&r.focus(n)}ngOnDestroy(){this._elementInfo.forEach((t,e)=>this.stopMonitoring(e))}_getDocument(){return this._document||document}_getWindow(){return this._getDocument().defaultView||window}_toggleClass(t,e,n){n?t.classList.add(e):t.classList.remove(e)}_getFocusOrigin(t){return this._origin?this._origin:this._windowFocused&&this._lastFocusOrigin?this._lastFocusOrigin:this._wasCausedByTouch(t)?"touch":"program"}_setClasses(t,e){this._toggleClass(t,"cdk-focused",!!e),this._toggleClass(t,"cdk-touch-focused","touch"===e),this._toggleClass(t,"cdk-keyboard-focused","keyboard"===e),this._toggleClass(t,"cdk-mouse-focused","mouse"===e),this._toggleClass(t,"cdk-program-focused","program"===e)}_setOriginForCurrentEventQueue(t){this._ngZone.runOutsideAngular(()=>{this._origin=t,0===this._detectionMode&&(this._originTimeoutId=setTimeout(()=>this._origin=null,1))})}_wasCausedByTouch(t){const e=Cg(t);return this._lastTouchTarget instanceof Node&&e instanceof Node&&(e===this._lastTouchTarget||e.contains(this._lastTouchTarget))}_onFocus(t,e){const n=this._elementInfo.get(e);if(!n||!n.checkChildren&&e!==Cg(t))return;const r=this._getFocusOrigin(t);this._setClasses(e,r),this._emitOrigin(n.subject,r),this._lastFocusOrigin=r}_onBlur(t,e){const n=this._elementInfo.get(e);!n||n.checkChildren&&t.relatedTarget instanceof Node&&e.contains(t.relatedTarget)||(this._setClasses(e),this._emitOrigin(n.subject,null))}_emitOrigin(t,e){this._ngZone.run(()=>t.next(e))}_registerGlobalListeners(t){if(!this._platform.isBrowser)return;const e=t.rootNode,n=this._rootNodeFocusListenerCount.get(e)||0;n||this._ngZone.runOutsideAngular(()=>{e.addEventListener("focus",this._rootNodeFocusAndBlurListener,xg),e.addEventListener("blur",this._rootNodeFocusAndBlurListener,xg)}),this._rootNodeFocusListenerCount.set(e,n+1),1==++this._monitoredElementCount&&this._ngZone.runOutsideAngular(()=>{const t=this._getDocument(),e=this._getWindow();t.addEventListener("keydown",this._documentKeydownListener,xg),t.addEventListener("mousedown",this._documentMousedownListener,xg),t.addEventListener("touchstart",this._documentTouchstartListener,xg),e.addEventListener("focus",this._windowFocusListener)})}_removeGlobalListeners(t){const e=t.rootNode;if(this._rootNodeFocusListenerCount.has(e)){const t=this._rootNodeFocusListenerCount.get(e);t>1?this._rootNodeFocusListenerCount.set(e,t-1):(e.removeEventListener("focus",this._rootNodeFocusAndBlurListener,xg),e.removeEventListener("blur",this._rootNodeFocusAndBlurListener,xg),this._rootNodeFocusListenerCount.delete(e))}if(!--this._monitoredElementCount){const t=this._getDocument(),e=this._getWindow();t.removeEventListener("keydown",this._documentKeydownListener,xg),t.removeEventListener("mousedown",this._documentMousedownListener,xg),t.removeEventListener("touchstart",this._documentTouchstartListener,xg),e.removeEventListener("focus",this._windowFocusListener),clearTimeout(this._windowFocusTimeoutId),clearTimeout(this._touchTimeoutId),clearTimeout(this._originTimeoutId)}}}return t.\u0275fac=function(e){return new(e||t)(Kt(sl),Kt(Im),Kt(zl,8),Kt(wg,8))},t.\u0275prov=ht({factory:function(){return new t(Kt(sl),Kt(Im),Kt(zl,8),Kt(wg,8))},token:t,providedIn:"root"}),t})();function Cg(t){return t.composedPath?t.composedPath()[0]:t.target}let kg=(()=>{class t{constructor(t,e){this._platform=t,this._document=e}getHighContrastMode(){if(!this._platform.isBrowser)return 0;const t=this._document.createElement("div");t.style.backgroundColor="rgb(1,2,3)",t.style.position="absolute",this._document.body.appendChild(t);const e=this._document.defaultView||window,n=e&&e.getComputedStyle?e.getComputedStyle(t):null,r=(n&&n.backgroundColor||"").replace(/ /g,"");switch(this._document.body.removeChild(t),r){case"rgb(0,0,0)":return 2;case"rgb(255,255,255)":return 1}return 0}_applyBodyHighContrastModeCssClasses(){if(this._platform.isBrowser&&this._document.body){const t=this._document.body.classList;t.remove("cdk-high-contrast-active"),t.remove("cdk-high-contrast-black-on-white"),t.remove("cdk-high-contrast-white-on-black");const e=this.getHighContrastMode();1===e?(t.add("cdk-high-contrast-active"),t.add("cdk-high-contrast-black-on-white")):2===e&&(t.add("cdk-high-contrast-active"),t.add("cdk-high-contrast-white-on-black"))}}}return t.\u0275fac=function(e){return new(e||t)(Kt(Im),Kt(zl))},t.\u0275prov=ht({factory:function(){return new t(Kt(Im),Kt(zl))},token:t,providedIn:"root"}),t})(),Sg=(()=>{class t{constructor(t){t._applyBodyHighContrastModeCssClasses()}}return t.\u0275mod=ve({type:t}),t.\u0275inj=dt({factory:function(e){return new(e||t)(Kt(kg))},imports:[[Mm,fg]]}),t})(),Eg=(()=>{class t{}return t.\u0275mod=ve({type:t}),t.\u0275inj=dt({factory:function(e){return new(e||t)}}),t})();function Og(t,e,n,i){return r(n)&&(i=n,n=void 0),i?Og(t,e,n).pipe(F(t=>u(t)?i(...t):i(t))):new v(r=>{!function t(e,n,r,i,o){let a;if(function(t){return t&&"function"==typeof t.addEventListener&&"function"==typeof t.removeEventListener}(e)){const t=e;e.addEventListener(n,r,o),a=()=>t.removeEventListener(n,r,o)}else if(function(t){return t&&"function"==typeof t.on&&"function"==typeof t.off}(e)){const t=e;e.on(n,r),a=()=>t.off(n,r)}else if(function(t){return t&&"function"==typeof t.addListener&&"function"==typeof t.removeListener}(e)){const t=e;e.addListener(n,r),a=()=>t.removeListener(n,r)}else{if(!e||!e.length)throw new TypeError("Invalid event target");for(let a=0,s=e.length;a<s;a++)t(e[a],n,r,i,o)}i.add(a)}(t,e,(function(t){r.next(arguments.length>1?Array.prototype.slice.call(arguments):t)}),r,n)})}class Ag extends Hm{constructor(t,e){super(t,e),this.scheduler=t,this.work=e}requestAsyncId(t,e,n=0){return null!==n&&n>0?super.requestAsyncId(t,e,n):(t.actions.push(this),t.scheduled||(t.scheduled=requestAnimationFrame(()=>t.flush(null))))}recycleAsyncId(t,e,n=0){if(null!==n&&n>0||null===n&&this.delay>0)return super.recycleAsyncId(t,e,n);0===t.actions.length&&(cancelAnimationFrame(e),t.scheduled=void 0)}}class Ng extends Xm{flush(t){this.active=!0,this.scheduled=void 0;const{actions:e}=this;let n,r=-1,i=e.length;t=t||e.shift();do{if(n=t.execute(t.state,t.delay))break}while(++r<i&&(t=e.shift()));if(this.active=!1,n){for(;++r<i&&(t=e.shift());)t.unsubscribe();throw n}}}const Tg=new Ng(Ag);class Dg{constructor(t){this.durationSelector=t}call(t,e){return e.subscribe(new Rg(t,this.durationSelector))}}class Rg extends M{constructor(t,e){super(t),this.durationSelector=e,this.hasValue=!1}_next(t){if(this.value=t,this.hasValue=!0,!this.throttled){let n;try{const{durationSelector:e}=this;n=e(t)}catch(e){return this.destination.error(e)}const r=I(this,n);!r||r.closed?this.clearThrottle():this.add(this.throttled=r)}}clearThrottle(){const{value:t,hasValue:e,throttled:n}=this;n&&(this.remove(n),this.throttled=null,n.unsubscribe()),e&&(this.value=null,this.hasValue=!1,this.destination.next(t))}notifyNext(t,e,n,r){this.clearThrottle()}notifyComplete(){this.clearThrottle()}}function Ig(t){return!u(t)&&t-parseFloat(t)+1>=0}function Mg(t){const{index:e,period:n,subscriber:r}=t;if(r.next(e),!r.closed){if(-1===n)return r.complete();t.index=e+1,this.schedule(t,n)}}function Fg(t,e=Km){return n=()=>function(t=0,e,n){let r=-1;return Ig(e)?r=Number(e)<1?1:Number(e):S(e)&&(n=e),S(n)||(n=Km),new v(e=>{const i=Ig(t)?t:+t-n.now();return n.schedule(Mg,i,{index:0,period:r,subscriber:e})})}(t,e),function(t){return t.lift(new Dg(n))};var n}function Pg(t){return e=>e.lift(new jg(t))}class jg{constructor(t){this.notifier=t}call(t,e){const n=new zg(t),r=I(n,this.notifier);return r&&!n.seenValue?(n.add(r),e.subscribe(n)):n}}class zg extends M{constructor(t){super(t),this.seenValue=!1}notifyNext(t,e,n,r,i){this.seenValue=!0,this.complete()}notifyComplete(){}}function Lg(){return V(1)}function Bg(...t){return Lg()(Xp(...t))}function Ug(...t){const e=t[t.length-1];return S(e)?(t.pop(),n=>Bg(t,n,e)):e=>Bg(t,e)}function $g(t,e){return"function"==typeof e?n=>n.pipe($g((n,r)=>L(t(n,r)).pipe(F((t,i)=>e(n,t,r,i))))):e=>e.lift(new Vg(t))}class Vg{constructor(t){this.project=t}call(t,e){return e.subscribe(new Wg(t,this.project))}}class Wg extends M{constructor(t,e){super(t),this.project=e,this.index=0}_next(t){let e;const n=this.index++;try{e=this.project(t,n)}catch(r){return void this.destination.error(r)}this._innerSub(e,t,n)}_innerSub(t,e,n){const r=this.innerSubscription;r&&r.unsubscribe();const i=new E(this,e,n),o=this.destination;o.add(i),this.innerSubscription=I(this,t,void 0,void 0,i),this.innerSubscription!==i&&o.add(this.innerSubscription)}_complete(){const{innerSubscription:t}=this;t&&!t.closed||super._complete(),this.unsubscribe()}_unsubscribe(){this.innerSubscription=null}notifyComplete(t){this.destination.remove(t),this.innerSubscription=null,this.isStopped&&super._complete()}notifyNext(t,e,n,r,i){this.destination.next(e)}}function qg(t,e){return new v(e?n=>e.schedule(Hg,0,{error:t,subscriber:n}):e=>e.error(t))}function Hg({error:t,subscriber:e}){e.error(t)}let Gg=(()=>{class t{constructor(t,e,n){this.kind=t,this.value=e,this.error=n,this.hasValue="N"===t}observe(t){switch(this.kind){case"N":return t.next&&t.next(this.value);case"E":return t.error&&t.error(this.error);case"C":return t.complete&&t.complete()}}do(t,e,n){switch(this.kind){case"N":return t&&t(this.value);case"E":return e&&e(this.error);case"C":return n&&n()}}accept(t,e,n){return t&&"function"==typeof t.next?this.observe(t):this.do(t,e,n)}toObservable(){switch(this.kind){case"N":return Xp(this.value);case"E":return qg(this.error);case"C":return eg()}throw new Error("unexpected notification kind value")}static createNext(e){return void 0!==e?new t("N",e):t.undefinedValueNotification}static createError(e){return new t("E",void 0,e)}static createComplete(){return t.completeNotification}}return t.completeNotification=new t("C"),t.undefinedValueNotification=new t("N",void 0),t})();const Xg=new Lt("cdk-dir-doc",{providedIn:"root",factory:function(){return Yt(zl)}});let Kg=(()=>{class t{constructor(t){if(this.value="ltr",this.change=new vu,t){const e=t.documentElement?t.documentElement.dir:null,n=(t.body?t.body.dir:null)||e;this.value="ltr"===n||"rtl"===n?n:"ltr"}}ngOnDestroy(){this.change.complete()}}return t.\u0275fac=function(e){return new(e||t)(Kt(Xg,8))},t.\u0275prov=ht({factory:function(){return new t(Kt(Xg,8))},token:t,providedIn:"root"}),t})(),Yg=(()=>{class t{}return t.\u0275mod=ve({type:t}),t.\u0275inj=dt({factory:function(e){return new(e||t)}}),t})(),Zg=(()=>{class t{constructor(){this._listeners=[]}notify(t,e){for(let n of this._listeners)n(t,e)}listen(t){return this._listeners.push(t),()=>{this._listeners=this._listeners.filter(e=>t!==e)}}ngOnDestroy(){this._listeners=[]}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=ht({factory:function(){return new t},token:t,providedIn:"root"}),t})(),Qg=(()=>{class t{constructor(t,e,n){this._ngZone=t,this._platform=e,this._scrolled=new C,this._globalSubscription=null,this._scrolledCount=0,this.scrollContainers=new Map,this._document=n}register(t){this.scrollContainers.has(t)||this.scrollContainers.set(t,t.elementScrolled().subscribe(()=>this._scrolled.next(t)))}deregister(t){const e=this.scrollContainers.get(t);e&&(e.unsubscribe(),this.scrollContainers.delete(t))}scrolled(t=20){return this._platform.isBrowser?new v(e=>{this._globalSubscription||this._addGlobalListener();const n=t>0?this._scrolled.pipe(Fg(t)).subscribe(e):this._scrolled.subscribe(e);return this._scrolledCount++,()=>{n.unsubscribe(),this._scrolledCount--,this._scrolledCount||this._removeGlobalListener()}}):Xp()}ngOnDestroy(){this._removeGlobalListener(),this.scrollContainers.forEach((t,e)=>this.deregister(e)),this._scrolled.complete()}ancestorScrolled(t,e){const n=this.getAncestorScrollContainers(t);return this.scrolled(e).pipe(Yp(t=>!t||n.indexOf(t)>-1))}getAncestorScrollContainers(t){const e=[];return this.scrollContainers.forEach((n,r)=>{this._scrollableContainsElement(r,t)&&e.push(r)}),e}_getDocument(){return this._document||document}_getWindow(){return this._getDocument().defaultView||window}_scrollableContainsElement(t,e){let n=e.nativeElement,r=t.getElementRef().nativeElement;do{if(n==r)return!0}while(n=n.parentElement);return!1}_addGlobalListener(){this._globalSubscription=this._ngZone.runOutsideAngular(()=>Og(this._getWindow().document,"scroll").subscribe(()=>this._scrolled.next()))}_removeGlobalListener(){this._globalSubscription&&(this._globalSubscription.unsubscribe(),this._globalSubscription=null)}}return t.\u0275fac=function(e){return new(e||t)(Kt(sl),Kt(Im),Kt(zl,8))},t.\u0275prov=ht({factory:function(){return new t(Kt(sl),Kt(Im),Kt(zl,8))},token:t,providedIn:"root"}),t})(),Jg=(()=>{class t{constructor(t,e,n){this._platform=t,this._change=new C,this._changeListener=t=>{this._change.next(t)},this._document=n,e.runOutsideAngular(()=>{if(t.isBrowser){const t=this._getWindow();t.addEventListener("resize",this._changeListener),t.addEventListener("orientationchange",this._changeListener)}this.change().subscribe(()=>this._updateViewportSize())})}ngOnDestroy(){if(this._platform.isBrowser){const t=this._getWindow();t.removeEventListener("resize",this._changeListener),t.removeEventListener("orientationchange",this._changeListener)}this._change.complete()}getViewportSize(){this._viewportSize||this._updateViewportSize();const t={width:this._viewportSize.width,height:this._viewportSize.height};return this._platform.isBrowser||(this._viewportSize=null),t}getViewportRect(){const t=this.getViewportScrollPosition(),{width:e,height:n}=this.getViewportSize();return{top:t.top,left:t.left,bottom:t.top+n,right:t.left+e,height:n,width:e}}getViewportScrollPosition(){if(!this._platform.isBrowser)return{top:0,left:0};const t=this._getDocument(),e=this._getWindow(),n=t.documentElement,r=n.getBoundingClientRect();return{top:-r.top||t.body.scrollTop||e.scrollY||n.scrollTop||0,left:-r.left||t.body.scrollLeft||e.scrollX||n.scrollLeft||0}}change(t=20){return t>0?this._change.pipe(Fg(t)):this._change}_getDocument(){return this._document||document}_getWindow(){return this._getDocument().defaultView||window}_updateViewportSize(){const t=this._getWindow();this._viewportSize=this._platform.isBrowser?{width:t.innerWidth,height:t.innerHeight}:{width:0,height:0}}}return t.\u0275fac=function(e){return new(e||t)(Kt(Im),Kt(sl),Kt(zl,8))},t.\u0275prov=ht({factory:function(){return new t(Kt(Im),Kt(sl),Kt(zl,8))},token:t,providedIn:"root"}),t})(),ty=(()=>{class t{}return t.\u0275mod=ve({type:t}),t.\u0275inj=dt({factory:function(e){return new(e||t)}}),t})(),ey=(()=>{class t{}return t.\u0275mod=ve({type:t}),t.\u0275inj=dt({factory:function(e){return new(e||t)},imports:[[Yg,Mm,ty],Yg,ty]}),t})();function ny(t){const{subscriber:e,counter:n,period:r}=t;e.next(n),this.schedule({subscriber:e,counter:n+1,period:r},r)}function ry(t,e){for(let n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t}function iy(t,e){const n=e?"":"none";ry(t.style,{touchAction:e?"":"none",webkitUserDrag:e?"":"none",webkitTapHighlightColor:e?"":"transparent",userSelect:n,msUserSelect:n,webkitUserSelect:n,MozUserSelect:n})}function oy(t){const e=t.toLowerCase().indexOf("ms")>-1?1:1e3;return parseFloat(t)*e}function ay(t,e){return t.getPropertyValue(e).split(",").map(t=>t.trim())}function sy(t){const e=t.getBoundingClientRect();return{top:e.top,right:e.right,bottom:e.bottom,left:e.left,width:e.width,height:e.height}}function uy(t,e,n){const{top:r,bottom:i,left:o,right:a}=t;return n>=r&&n<=i&&e>=o&&e<=a}function ly(t,e,n){t.top+=e,t.bottom=t.top+t.height,t.left+=n,t.right=t.left+t.width}function cy(t,e,n,r){const{top:i,right:o,bottom:a,left:s,width:u,height:l}=t,c=u*e,h=l*e;return r>i-h&&r<a+h&&n>s-c&&n<o+c}class hy{constructor(t,e){this._document=t,this._viewportRuler=e,this.positions=new Map}clear(){this.positions.clear()}cache(t){this.clear(),this.positions.set(this._document,{scrollPosition:this._viewportRuler.getViewportScrollPosition()}),t.forEach(t=>{this.positions.set(t,{scrollPosition:{top:t.scrollTop,left:t.scrollLeft},clientRect:sy(t)})})}handleScroll(t){const e=t.target,n=this.positions.get(e);if(!n)return null;const r=e===this._document?e.documentElement:e,i=n.scrollPosition;let o,a;if(e===this._document){const t=this._viewportRuler.getViewportScrollPosition();o=t.top,a=t.left}else o=e.scrollTop,a=e.scrollLeft;const s=i.top-o,u=i.left-a;return this.positions.forEach((t,n)=>{t.clientRect&&e!==n&&r.contains(n)&&ly(t.clientRect,s,u)}),i.top=o,i.left=a,{top:s,left:u}}}function dy(t){const e=t.cloneNode(!0),n=e.querySelectorAll("[id]"),r=t.nodeName.toLowerCase();e.removeAttribute("id");for(let i=0;i<n.length;i++)n[i].removeAttribute("id");return"canvas"===r?my(t,e):"input"!==r&&"select"!==r&&"textarea"!==r||py(t,e),fy("canvas",t,e,my),fy("input, textarea, select",t,e,py),e}function fy(t,e,n,r){const i=e.querySelectorAll(t);if(i.length){const e=n.querySelectorAll(t);for(let t=0;t<i.length;t++)r(i[t],e[t])}}function py(t,e){e.value=t.value}function my(t,e){const n=e.getContext("2d");if(n)try{n.drawImage(t,0,0)}catch(uO){}}const gy=Lm({passive:!0}),yy=Lm({passive:!1});class vy{constructor(t,e,n,r,i,o){this._config=e,this._document=n,this._ngZone=r,this._viewportRuler=i,this._dragDropRegistry=o,this._passiveTransform={x:0,y:0},this._activeTransform={x:0,y:0},this._moveEvents=new C,this._pointerMoveSubscription=h.EMPTY,this._pointerUpSubscription=h.EMPTY,this._scrollSubscription=h.EMPTY,this._resizeSubscription=h.EMPTY,this._boundaryElement=null,this._nativeInteractionsEnabled=!0,this._handles=[],this._disabledHandles=new Set,this._direction="ltr",this.dragStartDelay=0,this._disabled=!1,this.beforeStarted=new C,this.started=new C,this.released=new C,this.ended=new C,this.entered=new C,this.exited=new C,this.dropped=new C,this.moved=this._moveEvents.asObservable(),this._pointerDown=t=>{if(this.beforeStarted.next(),this._handles.length){const e=this._handles.find(e=>{const n=t.target;return!!n&&(n===e||e.contains(n))});!e||this._disabledHandles.has(e)||this.disabled||this._initializeDragSequence(e,t)}else this.disabled||this._initializeDragSequence(this._rootElement,t)},this._pointerMove=t=>{t.preventDefault();const e=this._getPointerPositionOnPage(t);if(!this._hasStartedDragging){if(Math.abs(e.x-this._pickupPositionOnPage.x)+Math.abs(e.y-this._pickupPositionOnPage.y)>=this._config.dragStartThreshold){if(!(Date.now()>=this._dragStartTime+this._getDragStartDelay(t)))return void this._endDragSequence(t);this._dropContainer&&this._dropContainer.isDragging()||(this._hasStartedDragging=!0,this._ngZone.run(()=>this._startDragSequence(t)))}return}this._boundaryElement&&(this._previewRect&&(this._previewRect.width||this._previewRect.height)||(this._previewRect=(this._preview||this._rootElement).getBoundingClientRect()));const n=this._getConstrainedPointerPosition(e);if(this._hasMoved=!0,this._lastKnownPointerPosition=e,this._updatePointerDirectionDelta(n),this._dropContainer)this._updateActiveDropContainer(n,e);else{const t=this._activeTransform;t.x=n.x-this._pickupPositionOnPage.x+this._passiveTransform.x,t.y=n.y-this._pickupPositionOnPage.y+this._passiveTransform.y,this._applyRootElementTransform(t.x,t.y),"undefined"!=typeof SVGElement&&this._rootElement instanceof SVGElement&&this._rootElement.setAttribute("transform",`translate(${t.x} ${t.y})`)}this._moveEvents.observers.length&&this._ngZone.run(()=>{this._moveEvents.next({source:this,pointerPosition:n,event:t,distance:this._getDragDistance(n),delta:this._pointerDirectionDelta})})},this._pointerUp=t=>{this._endDragSequence(t)},this.withRootElement(t),this._parentPositions=new hy(n,i),o.registerDragItem(this)}get disabled(){return this._disabled||!(!this._dropContainer||!this._dropContainer.disabled)}set disabled(t){const e=og(t);e!==this._disabled&&(this._disabled=e,this._toggleNativeDragInteractions())}getPlaceholderElement(){return this._placeholder}getRootElement(){return this._rootElement}getVisibleElement(){return this.isDragging()?this.getPlaceholderElement():this.getRootElement()}withHandles(t){return this._handles=t.map(t=>lg(t)),this._handles.forEach(t=>iy(t,!1)),this._toggleNativeDragInteractions(),this}withPreviewTemplate(t){return this._previewTemplate=t,this}withPlaceholderTemplate(t){return this._placeholderTemplate=t,this}withRootElement(t){const e=lg(t);return e!==this._rootElement&&(this._rootElement&&this._removeRootElementListeners(this._rootElement),this._ngZone.runOutsideAngular(()=>{e.addEventListener("mousedown",this._pointerDown,yy),e.addEventListener("touchstart",this._pointerDown,gy)}),this._initialTransform=void 0,this._rootElement=e),"undefined"!=typeof SVGElement&&this._rootElement instanceof SVGElement&&(this._ownerSVGElement=this._rootElement.ownerSVGElement),this}withBoundaryElement(t){return this._boundaryElement=t?lg(t):null,this._resizeSubscription.unsubscribe(),t&&(this._resizeSubscription=this._viewportRuler.change(10).subscribe(()=>this._containInsideBoundaryOnResize())),this}dispose(){this._removeRootElementListeners(this._rootElement),this.isDragging()&&xy(this._rootElement),xy(this._anchor),this._destroyPreview(),this._destroyPlaceholder(),this._dragDropRegistry.removeDragItem(this),this._removeSubscriptions(),this.beforeStarted.complete(),this.started.complete(),this.released.complete(),this.ended.complete(),this.entered.complete(),this.exited.complete(),this.dropped.complete(),this._moveEvents.complete(),this._handles=[],this._disabledHandles.clear(),this._dropContainer=void 0,this._resizeSubscription.unsubscribe(),this._parentPositions.clear(),this._boundaryElement=this._rootElement=this._ownerSVGElement=this._placeholderTemplate=this._previewTemplate=this._anchor=null}isDragging(){return this._hasStartedDragging&&this._dragDropRegistry.isDragging(this)}reset(){this._rootElement.style.transform=this._initialTransform||"",this._activeTransform={x:0,y:0},this._passiveTransform={x:0,y:0}}disableHandle(t){this._handles.indexOf(t)>-1&&this._disabledHandles.add(t)}enableHandle(t){this._disabledHandles.delete(t)}withDirection(t){return this._direction=t,this}_withDropContainer(t){this._dropContainer=t}getFreeDragPosition(){const t=this.isDragging()?this._activeTransform:this._passiveTransform;return{x:t.x,y:t.y}}setFreeDragPosition(t){return this._activeTransform={x:0,y:0},this._passiveTransform.x=t.x,this._passiveTransform.y=t.y,this._dropContainer||this._applyRootElementTransform(t.x,t.y),this}_sortFromLastPointerPosition(){const t=this._lastKnownPointerPosition;t&&this._dropContainer&&this._updateActiveDropContainer(this._getConstrainedPointerPosition(t),t)}_removeSubscriptions(){this._pointerMoveSubscription.unsubscribe(),this._pointerUpSubscription.unsubscribe(),this._scrollSubscription.unsubscribe()}_destroyPreview(){this._preview&&xy(this._preview),this._previewRef&&this._previewRef.destroy(),this._preview=this._previewRef=null}_destroyPlaceholder(){this._placeholder&&xy(this._placeholder),this._placeholderRef&&this._placeholderRef.destroy(),this._placeholder=this._placeholderRef=null}_endDragSequence(t){this._dragDropRegistry.isDragging(this)&&(this._removeSubscriptions(),this._dragDropRegistry.stopDragging(this),this._toggleNativeDragInteractions(),this._handles&&(this._rootElement.style.webkitTapHighlightColor=this._rootElementTapHighlight),this._hasStartedDragging&&(this.released.next({source:this}),this._dropContainer?(this._dropContainer._stopScrolling(),this._animatePreviewToPlaceholder().then(()=>{this._cleanupDragArtifacts(t),this._cleanupCachedDimensions(),this._dragDropRegistry.stopDragging(this)})):(this._passiveTransform.x=this._activeTransform.x,this._passiveTransform.y=this._activeTransform.y,this._ngZone.run(()=>{this.ended.next({source:this,distance:this._getDragDistance(this._getPointerPositionOnPage(t))})}),this._cleanupCachedDimensions(),this._dragDropRegistry.stopDragging(this))))}_startDragSequence(t){_y(t)&&(this._lastTouchEventTime=Date.now()),this._toggleNativeDragInteractions();const e=this._dropContainer;if(e){const t=this._rootElement,r=t.parentNode,i=this._preview=this._createPreviewElement(),o=this._placeholder=this._createPlaceholderElement(),a=this._anchor=this._anchor||this._document.createComment("");r.insertBefore(a,t),t.style.display="none",this._document.body.appendChild(r.replaceChild(o,t)),(n=this._document,n.fullscreenElement||n.webkitFullscreenElement||n.mozFullScreenElement||n.msFullscreenElement||n.body).appendChild(i),this.started.next({source:this}),e.start(),this._initialContainer=e,this._initialIndex=e.getItemIndex(this)}else this.started.next({source:this}),this._initialContainer=this._initialIndex=void 0;var n;this._parentPositions.cache(e?e.getScrollableParents():[])}_initializeDragSequence(t,e){e.stopPropagation();const n=this.isDragging(),r=_y(e),i=!r&&0!==e.button,o=this._rootElement,a=!r&&this._lastTouchEventTime&&this._lastTouchEventTime+800>Date.now();if(e.target&&e.target.draggable&&"mousedown"===e.type&&e.preventDefault(),n||i||a)return;this._handles.length&&(this._rootElementTapHighlight=o.style.webkitTapHighlightColor||"",o.style.webkitTapHighlightColor="transparent"),this._hasStartedDragging=this._hasMoved=!1,this._removeSubscriptions(),this._pointerMoveSubscription=this._dragDropRegistry.pointerMove.subscribe(this._pointerMove),this._pointerUpSubscription=this._dragDropRegistry.pointerUp.subscribe(this._pointerUp),this._scrollSubscription=this._dragDropRegistry.scroll.subscribe(t=>{this._updateOnScroll(t)}),this._boundaryElement&&(this._boundaryRect=sy(this._boundaryElement));const s=this._previewTemplate;this._pickupPositionInElement=s&&s.template&&!s.matchSize?{x:0,y:0}:this._getPointerPositionInElement(t,e);const u=this._pickupPositionOnPage=this._lastKnownPointerPosition=this._getPointerPositionOnPage(e);this._pointerDirectionDelta={x:0,y:0},this._pointerPositionAtLastDirectionChange={x:u.x,y:u.y},this._dragStartTime=Date.now(),this._dragDropRegistry.startDragging(this,e)}_cleanupDragArtifacts(t){this._rootElement.style.display="",this._anchor.parentNode.replaceChild(this._rootElement,this._anchor),this._destroyPreview(),this._destroyPlaceholder(),this._boundaryRect=this._previewRect=void 0,this._ngZone.run(()=>{const e=this._dropContainer,n=e.getItemIndex(this),r=this._getPointerPositionOnPage(t),i=this._getDragDistance(this._getPointerPositionOnPage(t)),o=e._isOverContainer(r.x,r.y);this.ended.next({source:this,distance:i}),this.dropped.next({item:this,currentIndex:n,previousIndex:this._initialIndex,container:e,previousContainer:this._initialContainer,isPointerOverContainer:o,distance:i}),e.drop(this,n,this._initialContainer,o,i,this._initialIndex),this._dropContainer=this._initialContainer})}_updateActiveDropContainer({x:t,y:e},{x:n,y:r}){let i=this._initialContainer._getSiblingContainerFromPosition(this,t,e);!i&&this._dropContainer!==this._initialContainer&&this._initialContainer._isOverContainer(t,e)&&(i=this._initialContainer),i&&i!==this._dropContainer&&this._ngZone.run(()=>{this.exited.next({item:this,container:this._dropContainer}),this._dropContainer.exit(this),this._dropContainer=i,this._dropContainer.enter(this,t,e,i===this._initialContainer&&i.sortingDisabled?this._initialIndex:void 0),this.entered.next({item:this,container:i,currentIndex:i.getItemIndex(this)})}),this._dropContainer._startScrollingIfNecessary(n,r),this._dropContainer._sortItem(this,t,e,this._pointerDirectionDelta),this._preview.style.transform=by(t-this._pickupPositionInElement.x,e-this._pickupPositionInElement.y)}_createPreviewElement(){const t=this._previewTemplate,e=this.previewClass,n=t?t.template:null;let r;if(n&&t){const e=t.matchSize?this._rootElement.getBoundingClientRect():null,i=t.viewContainer.createEmbeddedView(n,t.context);i.detectChanges(),r=Cy(i,this._document),this._previewRef=i,t.matchSize?ky(r,e):r.style.transform=by(this._pickupPositionOnPage.x,this._pickupPositionOnPage.y)}else{const t=this._rootElement;r=dy(t),ky(r,t.getBoundingClientRect())}return ry(r.style,{pointerEvents:"none",margin:"0",position:"fixed",top:"0",left:"0",zIndex:""+(this._config.zIndex||1e3)}),iy(r,!1),r.classList.add("cdk-drag-preview"),r.setAttribute("dir",this._direction),e&&(Array.isArray(e)?e.forEach(t=>r.classList.add(t)):r.classList.add(e)),r}_animatePreviewToPlaceholder(){if(!this._hasMoved)return Promise.resolve();const t=this._placeholder.getBoundingClientRect();this._preview.classList.add("cdk-drag-animating"),this._preview.style.transform=by(t.left,t.top);const e=function(t){const e=getComputedStyle(t),n=ay(e,"transition-property"),r=n.find(t=>"transform"===t||"all"===t);if(!r)return 0;const i=n.indexOf(r),o=ay(e,"transition-duration"),a=ay(e,"transition-delay");return oy(o[i])+oy(a[i])}(this._preview);return 0===e?Promise.resolve():this._ngZone.runOutsideAngular(()=>new Promise(t=>{const n=e=>{(!e||e.target===this._preview&&"transform"===e.propertyName)&&(this._preview.removeEventListener("transitionend",n),t(),clearTimeout(r))},r=setTimeout(n,1.5*e);this._preview.addEventListener("transitionend",n)}))}_createPlaceholderElement(){const t=this._placeholderTemplate,e=t?t.template:null;let n;return e?(this._placeholderRef=t.viewContainer.createEmbeddedView(e,t.context),this._placeholderRef.detectChanges(),n=Cy(this._placeholderRef,this._document)):n=dy(this._rootElement),n.classList.add("cdk-drag-placeholder"),n}_getPointerPositionInElement(t,e){const n=this._rootElement.getBoundingClientRect(),r=t===this._rootElement?null:t,i=r?r.getBoundingClientRect():n,o=_y(e)?e.targetTouches[0]:e,a=this._getViewportScrollPosition();return{x:i.left-n.left+(o.pageX-i.left-a.left),y:i.top-n.top+(o.pageY-i.top-a.top)}}_getPointerPositionOnPage(t){const e=this._getViewportScrollPosition(),n=_y(t)?t.touches[0]||t.changedTouches[0]||{pageX:0,pageY:0}:t,r=n.pageX-e.left,i=n.pageY-e.top;if(this._ownerSVGElement){const t=this._ownerSVGElement.getScreenCTM();if(t){const e=this._ownerSVGElement.createSVGPoint();return e.x=r,e.y=i,e.matrixTransform(t.inverse())}}return{x:r,y:i}}_getConstrainedPointerPosition(t){const e=this._dropContainer?this._dropContainer.lockAxis:null;let{x:n,y:r}=this.constrainPosition?this.constrainPosition(t,this):t;if("x"===this.lockAxis||"x"===e?r=this._pickupPositionOnPage.y:"y"!==this.lockAxis&&"y"!==e||(n=this._pickupPositionOnPage.x),this._boundaryRect){const{x:t,y:e}=this._pickupPositionInElement,i=this._boundaryRect,o=this._previewRect,a=i.top+e,s=i.bottom-(o.height-e);n=wy(n,i.left+t,i.right-(o.width-t)),r=wy(r,a,s)}return{x:n,y:r}}_updatePointerDirectionDelta(t){const{x:e,y:n}=t,r=this._pointerDirectionDelta,i=this._pointerPositionAtLastDirectionChange,o=Math.abs(e-i.x),a=Math.abs(n-i.y);return o>this._config.pointerDirectionChangeThreshold&&(r.x=e>i.x?1:-1,i.x=e),a>this._config.pointerDirectionChangeThreshold&&(r.y=n>i.y?1:-1,i.y=n),r}_toggleNativeDragInteractions(){if(!this._rootElement||!this._handles)return;const t=this._handles.length>0||!this.isDragging();t!==this._nativeInteractionsEnabled&&(this._nativeInteractionsEnabled=t,iy(this._rootElement,t))}_removeRootElementListeners(t){t.removeEventListener("mousedown",this._pointerDown,yy),t.removeEventListener("touchstart",this._pointerDown,gy)}_applyRootElementTransform(t,e){const n=by(t,e);null==this._initialTransform&&(this._initialTransform=this._rootElement.style.transform||""),this._rootElement.style.transform=this._initialTransform?n+" "+this._initialTransform:n}_getDragDistance(t){const e=this._pickupPositionOnPage;return e?{x:t.x-e.x,y:t.y-e.y}:{x:0,y:0}}_cleanupCachedDimensions(){this._boundaryRect=this._previewRect=void 0,this._parentPositions.clear()}_containInsideBoundaryOnResize(){let{x:t,y:e}=this._passiveTransform;if(0===t&&0===e||this.isDragging()||!this._boundaryElement)return;const n=this._boundaryElement.getBoundingClientRect(),r=this._rootElement.getBoundingClientRect();if(0===n.width&&0===n.height||0===r.width&&0===r.height)return;const i=n.left-r.left,o=r.right-n.right,a=n.top-r.top,s=r.bottom-n.bottom;n.width>r.width?(i>0&&(t+=i),o>0&&(t-=o)):t=0,n.height>r.height?(a>0&&(e+=a),s>0&&(e-=s)):e=0,t===this._passiveTransform.x&&e===this._passiveTransform.y||this.setFreeDragPosition({y:e,x:t})}_getDragStartDelay(t){const e=this.dragStartDelay;return"number"==typeof e?e:_y(t)?e.touch:e?e.mouse:0}_updateOnScroll(t){const e=this._parentPositions.handleScroll(t);if(e){const n=t.target;this._boundaryRect&&(n===this._document||n!==this._boundaryElement&&n.contains(this._boundaryElement))&&ly(this._boundaryRect,e.top,e.left),this._pickupPositionOnPage.x+=e.left,this._pickupPositionOnPage.y+=e.top,this._dropContainer||(this._activeTransform.x-=e.left,this._activeTransform.y-=e.top,this._applyRootElementTransform(this._activeTransform.x,this._activeTransform.y))}}_getViewportScrollPosition(){const t=this._parentPositions.positions.get(this._document);return t?t.scrollPosition:this._viewportRuler.getViewportScrollPosition()}}function by(t,e){return`translate3d(${Math.round(t)}px, ${Math.round(e)}px, 0)`}function wy(t,e,n){return Math.max(e,Math.min(n,t))}function xy(t){t&&t.parentNode&&t.parentNode.removeChild(t)}function _y(t){return"t"===t.type[0]}function Cy(t,e){const n=t.rootNodes;if(1===n.length&&n[0].nodeType===e.ELEMENT_NODE)return n[0];const r=e.createElement("div");return n.forEach(t=>r.appendChild(t)),r}function ky(t,e){t.style.width=e.width+"px",t.style.height=e.height+"px",t.style.transform=by(e.left,e.top)}function Sy(t,e){return Math.max(0,Math.min(e,t))}class Ey{constructor(t,e,n,r,i){this._dragDropRegistry=e,this._ngZone=r,this._viewportRuler=i,this.disabled=!1,this.sortingDisabled=!1,this.autoScrollDisabled=!1,this.enterPredicate=()=>!0,this.beforeStarted=new C,this.entered=new C,this.exited=new C,this.dropped=new C,this.sorted=new C,this._isDragging=!1,this._itemPositions=[],this._previousSwap={drag:null,delta:0,overlaps:!1},this._siblings=[],this._orientation="vertical",this._activeSiblings=new Set,this._direction="ltr",this._viewportScrollSubscription=h.EMPTY,this._verticalScrollDirection=0,this._horizontalScrollDirection=0,this._stopScrollTimers=new C,this._cachedShadowRoot=null,this._startScrollInterval=()=>{this._stopScrolling(),function(t=0,e=Km){return(!Ig(t)||t<0)&&(t=0),e&&"function"==typeof e.schedule||(e=Km),new v(n=>(n.add(e.schedule(ny,t,{subscriber:n,counter:0,period:t})),n))}(0,Tg).pipe(Pg(this._stopScrollTimers)).subscribe(()=>{const t=this._scrollNode;1===this._verticalScrollDirection?Ay(t,-2):2===this._verticalScrollDirection&&Ay(t,2),1===this._horizontalScrollDirection?Ny(t,-2):2===this._horizontalScrollDirection&&Ny(t,2)})},this.element=lg(t),this._document=n,this.withScrollableParents([this.element]),e.registerDropContainer(this),this._parentPositions=new hy(n,i)}dispose(){this._stopScrolling(),this._stopScrollTimers.complete(),this._viewportScrollSubscription.unsubscribe(),this.beforeStarted.complete(),this.entered.complete(),this.exited.complete(),this.dropped.complete(),this.sorted.complete(),this._activeSiblings.clear(),this._scrollNode=null,this._parentPositions.clear(),this._dragDropRegistry.removeDropContainer(this)}isDragging(){return this._isDragging}start(){const t=lg(this.element).style;this.beforeStarted.next(),this._isDragging=!0,this._initialScrollSnap=t.msScrollSnapType||t.scrollSnapType||"",t.scrollSnapType=t.msScrollSnapType="none",this._cacheItems(),this._siblings.forEach(t=>t._startReceiving(this)),this._viewportScrollSubscription.unsubscribe(),this._listenToScrollEvents()}enter(t,e,n,r){let i;this.start(),null==r?(i=this.sortingDisabled?this._draggables.indexOf(t):-1,-1===i&&(i=this._getItemIndexFromPointerPosition(t,e,n))):i=r;const o=this._activeDraggables,a=o.indexOf(t),s=t.getPlaceholderElement();let u=o[i];if(u===t&&(u=o[i+1]),a>-1&&o.splice(a,1),u&&!this._dragDropRegistry.isDragging(u)){const e=u.getRootElement();e.parentElement.insertBefore(s,e),o.splice(i,0,t)}else if(this._shouldEnterAsFirstChild(e,n)){const e=o[0].getRootElement();e.parentNode.insertBefore(s,e),o.unshift(t)}else lg(this.element).appendChild(s),o.push(t);s.style.transform="",this._cacheItemPositions(),this._cacheParentPositions(),this.entered.next({item:t,container:this,currentIndex:this.getItemIndex(t)})}exit(t){this._reset(),this.exited.next({item:t,container:this})}drop(t,e,n,r,i,o){this._reset(),null==o&&(o=n.getItemIndex(t)),this.dropped.next({item:t,currentIndex:e,previousIndex:o,container:this,previousContainer:n,isPointerOverContainer:r,distance:i})}withItems(t){const e=this._draggables;return this._draggables=t,t.forEach(t=>t._withDropContainer(this)),this.isDragging()&&(e.filter(t=>t.isDragging()).every(e=>-1===t.indexOf(e))?this._reset():this._cacheItems()),this}withDirection(t){return this._direction=t,this}connectedTo(t){return this._siblings=t.slice(),this}withOrientation(t){return this._orientation=t,this}withScrollableParents(t){const e=lg(this.element);return this._scrollableElements=-1===t.indexOf(e)?[e,...t]:t.slice(),this}getScrollableParents(){return this._scrollableElements}getItemIndex(t){return this._isDragging?Oy("horizontal"===this._orientation&&"rtl"===this._direction?this._itemPositions.slice().reverse():this._itemPositions,e=>e.drag===t):this._draggables.indexOf(t)}isReceiving(){return this._activeSiblings.size>0}_sortItem(t,e,n,r){if(this.sortingDisabled||!cy(this._clientRect,.05,e,n))return;const i=this._itemPositions,o=this._getItemIndexFromPointerPosition(t,e,n,r);if(-1===o&&i.length>0)return;const a="horizontal"===this._orientation,s=Oy(i,e=>e.drag===t),u=i[o],l=u.clientRect,c=s>o?1:-1,h=this._getItemOffsetPx(i[s].clientRect,l,c),d=this._getSiblingOffsetPx(s,i,c),f=i.slice();!function(t,e,n){const r=Sy(e,t.length-1),i=Sy(n,t.length-1);if(r===i)return;const o=t[r],a=i<r?-1:1;for(let s=r;s!==i;s+=a)t[s]=t[s+a];t[i]=o}(i,s,o),this.sorted.next({previousIndex:s,currentIndex:o,container:this,item:t}),i.forEach((e,n)=>{if(f[n]===e)return;const r=e.drag===t,i=r?h:d,o=r?t.getPlaceholderElement():e.drag.getRootElement();e.offset+=i,a?(o.style.transform=`translate3d(${Math.round(e.offset)}px, 0, 0)`,ly(e.clientRect,0,i)):(o.style.transform=`translate3d(0, ${Math.round(e.offset)}px, 0)`,ly(e.clientRect,i,0))}),this._previousSwap.overlaps=uy(l,e,n),this._previousSwap.drag=u.drag,this._previousSwap.delta=a?r.x:r.y}_startScrollingIfNecessary(t,e){if(this.autoScrollDisabled)return;let n,r=0,i=0;if(this._parentPositions.positions.forEach((o,a)=>{a!==this._document&&o.clientRect&&!n&&cy(o.clientRect,.05,t,e)&&([r,i]=function(t,e,n,r){const i=Ty(e,r),o=Dy(e,n);let a=0,s=0;if(i){const e=t.scrollTop;1===i?e>0&&(a=1):t.scrollHeight-e>t.clientHeight&&(a=2)}if(o){const e=t.scrollLeft;1===o?e>0&&(s=1):t.scrollWidth-e>t.clientWidth&&(s=2)}return[a,s]}(a,o.clientRect,t,e),(r||i)&&(n=a))}),!r&&!i){const{width:o,height:a}=this._viewportRuler.getViewportSize(),s={width:o,height:a,top:0,right:o,bottom:a,left:0};r=Ty(s,e),i=Dy(s,t),n=window}!n||r===this._verticalScrollDirection&&i===this._horizontalScrollDirection&&n===this._scrollNode||(this._verticalScrollDirection=r,this._horizontalScrollDirection=i,this._scrollNode=n,(r||i)&&n?this._ngZone.runOutsideAngular(this._startScrollInterval):this._stopScrolling())}_stopScrolling(){this._stopScrollTimers.next()}_cacheParentPositions(){const t=lg(this.element);this._parentPositions.cache(this._scrollableElements),this._clientRect=this._parentPositions.positions.get(t).clientRect}_cacheItemPositions(){const t="horizontal"===this._orientation;this._itemPositions=this._activeDraggables.map(t=>{const e=t.getVisibleElement();return{drag:t,offset:0,clientRect:sy(e)}}).sort((e,n)=>t?e.clientRect.left-n.clientRect.left:e.clientRect.top-n.clientRect.top)}_reset(){this._isDragging=!1;const t=lg(this.element).style;t.scrollSnapType=t.msScrollSnapType=this._initialScrollSnap,this._activeDraggables.forEach(t=>{const e=t.getRootElement();e&&(e.style.transform="")}),this._siblings.forEach(t=>t._stopReceiving(this)),this._activeDraggables=[],this._itemPositions=[],this._previousSwap.drag=null,this._previousSwap.delta=0,this._previousSwap.overlaps=!1,this._stopScrolling(),this._viewportScrollSubscription.unsubscribe(),this._parentPositions.clear()}_getSiblingOffsetPx(t,e,n){const r="horizontal"===this._orientation,i=e[t].clientRect,o=e[t+-1*n];let a=i[r?"width":"height"]*n;if(o){const t=r?"left":"top",e=r?"right":"bottom";-1===n?a-=o.clientRect[t]-i[e]:a+=i[t]-o.clientRect[e]}return a}_getItemOffsetPx(t,e,n){const r="horizontal"===this._orientation;let i=r?e.left-t.left:e.top-t.top;return-1===n&&(i+=r?e.width-t.width:e.height-t.height),i}_shouldEnterAsFirstChild(t,e){if(!this._activeDraggables.length)return!1;const n=this._itemPositions,r="horizontal"===this._orientation;if(n[0].drag!==this._activeDraggables[0]){const i=n[n.length-1].clientRect;return r?t>=i.right:e>=i.bottom}{const i=n[0].clientRect;return r?t<=i.left:e<=i.top}}_getItemIndexFromPointerPosition(t,e,n,r){const i="horizontal"===this._orientation;return Oy(this._itemPositions,({drag:o,clientRect:a},s,u)=>{if(o===t)return u.length<2;if(r){const t=i?r.x:r.y;if(o===this._previousSwap.drag&&this._previousSwap.overlaps&&t===this._previousSwap.delta)return!1}return i?e>=Math.floor(a.left)&&e<Math.floor(a.right):n>=Math.floor(a.top)&&n<Math.floor(a.bottom)})}_cacheItems(){this._activeDraggables=this._draggables.slice(),this._cacheItemPositions(),this._cacheParentPositions()}_isOverContainer(t,e){return uy(this._clientRect,t,e)}_getSiblingContainerFromPosition(t,e,n){return this._siblings.find(r=>r._canReceive(t,e,n))}_canReceive(t,e,n){if(!uy(this._clientRect,e,n)||!this.enterPredicate(t,this))return!1;const r=this._getShadowRoot().elementFromPoint(e,n);if(!r)return!1;const i=lg(this.element);return r===i||i.contains(r)}_startReceiving(t){const e=this._activeSiblings;e.has(t)||(e.add(t),this._cacheParentPositions(),this._listenToScrollEvents())}_stopReceiving(t){this._activeSiblings.delete(t),this._viewportScrollSubscription.unsubscribe()}_listenToScrollEvents(){this._viewportScrollSubscription=this._dragDropRegistry.scroll.subscribe(t=>{if(this.isDragging()){const e=this._parentPositions.handleScroll(t);e&&(this._itemPositions.forEach(({clientRect:t})=>{ly(t,e.top,e.left)}),this._itemPositions.forEach(({drag:t})=>{this._dragDropRegistry.isDragging(t)&&t._sortFromLastPointerPosition()}))}else this.isReceiving()&&this._cacheParentPositions()})}_getShadowRoot(){if(!this._cachedShadowRoot){const t=Bm(lg(this.element));this._cachedShadowRoot=t||this._document}return this._cachedShadowRoot}}function Oy(t,e){for(let n=0;n<t.length;n++)if(e(t[n],n,t))return n;return-1}function Ay(t,e){t===window?t.scrollBy(0,e):t.scrollTop+=e}function Ny(t,e){t===window?t.scrollBy(e,0):t.scrollLeft+=e}function Ty(t,e){const{top:n,bottom:r,height:i}=t,o=.05*i;return e>=n-o&&e<=n+o?1:e>=r-o&&e<=r+o?2:0}function Dy(t,e){const{left:n,right:r,width:i}=t,o=.05*i;return e>=n-o&&e<=n+o?1:e>=r-o&&e<=r+o?2:0}const Ry=Lm({passive:!1,capture:!0});let Iy=(()=>{class t{constructor(t,e){this._ngZone=t,this._dropInstances=new Set,this._dragInstances=new Set,this._activeDragInstances=new Set,this._globalListeners=new Map,this.pointerMove=new C,this.pointerUp=new C,this.scroll=new C,this._preventDefaultWhileDragging=t=>{this._activeDragInstances.size&&t.preventDefault()},this._document=e}registerDropContainer(t){this._dropInstances.has(t)||this._dropInstances.add(t)}registerDragItem(t){this._dragInstances.add(t),1===this._dragInstances.size&&this._ngZone.runOutsideAngular(()=>{this._document.addEventListener("touchmove",this._preventDefaultWhileDragging,Ry)})}removeDropContainer(t){this._dropInstances.delete(t)}removeDragItem(t){this._dragInstances.delete(t),this.stopDragging(t),0===this._dragInstances.size&&this._document.removeEventListener("touchmove",this._preventDefaultWhileDragging,Ry)}startDragging(t,e){if(!this._activeDragInstances.has(t)&&(this._activeDragInstances.add(t),1===this._activeDragInstances.size)){const t=e.type.startsWith("touch"),n=t?"touchend":"mouseup";this._globalListeners.set(t?"touchmove":"mousemove",{handler:t=>this.pointerMove.next(t),options:Ry}).set(n,{handler:t=>this.pointerUp.next(t),options:!0}).set("scroll",{handler:t=>this.scroll.next(t),options:!0}).set("selectstart",{handler:this._preventDefaultWhileDragging,options:Ry}),this._ngZone.runOutsideAngular(()=>{this._globalListeners.forEach((t,e)=>{this._document.addEventListener(e,t.handler,t.options)})})}}stopDragging(t){this._activeDragInstances.delete(t),0===this._activeDragInstances.size&&this._clearGlobalListeners()}isDragging(t){return this._activeDragInstances.has(t)}ngOnDestroy(){this._dragInstances.forEach(t=>this.removeDragItem(t)),this._dropInstances.forEach(t=>this.removeDropContainer(t)),this._clearGlobalListeners(),this.pointerMove.complete(),this.pointerUp.complete()}_clearGlobalListeners(){this._globalListeners.forEach((t,e)=>{this._document.removeEventListener(e,t.handler,t.options)}),this._globalListeners.clear()}}return t.\u0275fac=function(e){return new(e||t)(Kt(sl),Kt(zl))},t.\u0275prov=ht({factory:function(){return new t(Kt(sl),Kt(zl))},token:t,providedIn:"root"}),t})();const My={dragStartThreshold:5,pointerDirectionChangeThreshold:5};let Fy=(()=>{class t{constructor(t,e,n,r){this._document=t,this._ngZone=e,this._viewportRuler=n,this._dragDropRegistry=r}createDrag(t,e=My){return new vy(t,e,this._document,this._ngZone,this._viewportRuler,this._dragDropRegistry)}createDropList(t){return new Ey(t,this._dragDropRegistry,this._document,this._ngZone,this._viewportRuler)}}return t.\u0275fac=function(e){return new(e||t)(Kt(zl),Kt(sl),Kt(Jg),Kt(Iy))},t.\u0275prov=ht({factory:function(){return new t(Kt(zl),Kt(sl),Kt(Jg),Kt(Iy))},token:t,providedIn:"root"}),t})();const Py=new Lt("CDK_DRAG_CONFIG"),jy=new Lt("CdkDropList"),zy=new Lt("CDK_DRAG_PARENT"),Ly=new Lt("CdkDragHandle"),By=new Lt("CdkDragPlaceholder"),Uy=new Lt("CdkDragPreview");let $y=(()=>{class t{constructor(t,e,n,r,i,o,a,s,u,l){this.element=t,this.dropContainer=e,this._document=n,this._ngZone=r,this._viewContainerRef=i,this._dir=a,this._changeDetectorRef=u,this._selfHandle=l,this._destroyed=new C,this.started=new vu,this.released=new vu,this.ended=new vu,this.entered=new vu,this.exited=new vu,this.dropped=new vu,this.moved=new v(t=>{const e=this._dragRef.moved.pipe(F(t=>({source:this,pointerPosition:t.pointerPosition,event:t.event,delta:t.delta,distance:t.distance}))).subscribe(t);return()=>{e.unsubscribe()}}),this._dragRef=s.createDrag(t,{dragStartThreshold:o&&null!=o.dragStartThreshold?o.dragStartThreshold:5,pointerDirectionChangeThreshold:o&&null!=o.pointerDirectionChangeThreshold?o.pointerDirectionChangeThreshold:5,zIndex:null==o?void 0:o.zIndex}),this._dragRef.data=this,o&&this._assignDefaults(o),e&&(this._dragRef._withDropContainer(e._dropListRef),e.addItem(this)),this._syncInputs(this._dragRef),this._handleEvents(this._dragRef)}get disabled(){return this._disabled||this.dropContainer&&this.dropContainer.disabled}set disabled(t){this._disabled=og(t),this._dragRef.disabled=this._disabled}getPlaceholderElement(){return this._dragRef.getPlaceholderElement()}getRootElement(){return this._dragRef.getRootElement()}reset(){this._dragRef.reset()}getFreeDragPosition(){return this._dragRef.getFreeDragPosition()}ngAfterViewInit(){this._ngZone.onStable.asObservable().pipe(ng(1),Pg(this._destroyed)).subscribe(()=>{this._updateRootElement(),this._handles.changes.pipe(Ug(this._handles),$m(t=>{const e=t.filter(t=>t._parentDrag===this).map(t=>t.element);this._selfHandle&&this.rootElementSelector&&e.push(this.element),this._dragRef.withHandles(e)}),$g(t=>q(...t.map(t=>t._stateChanges.pipe(Ug(t))))),Pg(this._destroyed)).subscribe(t=>{const e=this._dragRef,n=t.element.nativeElement;t.disabled?e.disableHandle(n):e.enableHandle(n)}),this.freeDragPosition&&this._dragRef.setFreeDragPosition(this.freeDragPosition)})}ngOnChanges(t){const e=t.rootElementSelector,n=t.freeDragPosition;e&&!e.firstChange&&this._updateRootElement(),n&&!n.firstChange&&this.freeDragPosition&&this._dragRef.setFreeDragPosition(this.freeDragPosition)}ngOnDestroy(){this.dropContainer&&this.dropContainer.removeItem(this),this._destroyed.next(),this._destroyed.complete(),this._dragRef.dispose()}_updateRootElement(){const t=this.element.nativeElement,e=this.rootElementSelector?Vy(t,this.rootElementSelector):t;if(e&&e.nodeType!==this._document.ELEMENT_NODE)throw Error(`cdkDrag must be attached to an element node. Currently attached to "${e.nodeName}".`);this._dragRef.withRootElement(e||t)}_getBoundaryElement(){const t=this.boundaryElement;if(!t)return null;if("string"==typeof t)return Vy(this.element.nativeElement,t);const e=lg(t);if(Nr()&&!e.contains(this.element.nativeElement))throw Error("Draggable element is not inside of the node passed into cdkDragBoundary.");return e}_syncInputs(t){t.beforeStarted.subscribe(()=>{if(!t.isDragging()){const e=this._dir,n=this.dragStartDelay,r=this._placeholderTemplate?{template:this._placeholderTemplate.templateRef,context:this._placeholderTemplate.data,viewContainer:this._viewContainerRef}:null,i=this._previewTemplate?{template:this._previewTemplate.templateRef,context:this._previewTemplate.data,matchSize:this._previewTemplate.matchSize,viewContainer:this._viewContainerRef}:null;t.disabled=this.disabled,t.lockAxis=this.lockAxis,t.dragStartDelay="object"==typeof n&&n?n:ag(n),t.constrainPosition=this.constrainPosition,t.previewClass=this.previewClass,t.withBoundaryElement(this._getBoundaryElement()).withPlaceholderTemplate(r).withPreviewTemplate(i),e&&t.withDirection(e.value)}})}_handleEvents(t){t.started.subscribe(()=>{this.started.emit({source:this}),this._changeDetectorRef.markForCheck()}),t.released.subscribe(()=>{this.released.emit({source:this})}),t.ended.subscribe(t=>{this.ended.emit({source:this,distance:t.distance}),this._changeDetectorRef.markForCheck()}),t.entered.subscribe(t=>{this.entered.emit({container:t.container.data,item:this,currentIndex:t.currentIndex})}),t.exited.subscribe(t=>{this.exited.emit({container:t.container.data,item:this})}),t.dropped.subscribe(t=>{this.dropped.emit({previousIndex:t.previousIndex,currentIndex:t.currentIndex,previousContainer:t.previousContainer.data,container:t.container.data,isPointerOverContainer:t.isPointerOverContainer,item:this,distance:t.distance})})}_assignDefaults(t){const{lockAxis:e,dragStartDelay:n,constrainPosition:r,previewClass:i,boundaryElement:o,draggingDisabled:a,rootElementSelector:s}=t;this.disabled=null!=a&&a,this.dragStartDelay=n||0,e&&(this.lockAxis=e),r&&(this.constrainPosition=r),i&&(this.previewClass=i),o&&(this.boundaryElement=o),s&&(this.rootElementSelector=s)}}return t.\u0275fac=function(e){return new(e||t)(ka(ks),ka(jy,12),ka(zl),ka(sl),ka(Ys),ka(Py,8),ka(Kg,8),ka(Fy),ka(Go),ka(Ly,10))},t.\u0275dir=we({type:t,selectors:[["","cdkDrag",""]],contentQueries:function(t,e,n){var r;1&t&&(Iu(n,Uy,!0),Iu(n,By,!0),Iu(n,Ly,!0)),2&t&&(Nu(r=Pu())&&(e._previewTemplate=r.first),Nu(r=Pu())&&(e._placeholderTemplate=r.first),Nu(r=Pu())&&(e._handles=r))},hostAttrs:[1,"cdk-drag"],hostVars:4,hostBindings:function(t,e){2&t&&Ya("cdk-drag-disabled",e.disabled)("cdk-drag-dragging",e._dragRef.isDragging())},inputs:{disabled:["cdkDragDisabled","disabled"],dragStartDelay:["cdkDragStartDelay","dragStartDelay"],lockAxis:["cdkDragLockAxis","lockAxis"],constrainPosition:["cdkDragConstrainPosition","constrainPosition"],previewClass:["cdkDragPreviewClass","previewClass"],boundaryElement:["cdkDragBoundary","boundaryElement"],rootElementSelector:["cdkDragRootElement","rootElementSelector"],data:["cdkDragData","data"],freeDragPosition:["cdkDragFreeDragPosition","freeDragPosition"]},outputs:{started:"cdkDragStarted",released:"cdkDragReleased",ended:"cdkDragEnded",entered:"cdkDragEntered",exited:"cdkDragExited",dropped:"cdkDragDropped",moved:"cdkDragMoved"},exportAs:["cdkDrag"],features:[ws([{provide:zy,useExisting:t}]),Ie]}),t})();function Vy(t,e){let n=t.parentElement;for(;n;){if(n.matches?n.matches(e):n.msMatchesSelector(e))return n;n=n.parentElement}return null}let Wy=(()=>{class t{}return t.\u0275mod=ve({type:t}),t.\u0275inj=dt({factory:function(e){return new(e||t)},providers:[Fy],imports:[ty]}),t})();function qy(){throw Error("Host already has a portal attached")}class Hy{attach(t){return null==t&&function(){throw Error("Attempting to attach a portal to a null PortalOutlet")}(),t.hasAttached()&&qy(),this._attachedHost=t,t.attach(this)}detach(){let t=this._attachedHost;null==t?function(){throw Error("Attempting to detach a portal that is not attached to a host")}():(this._attachedHost=null,t.detach())}get isAttached(){return null!=this._attachedHost}setAttachedHost(t){this._attachedHost=t}}class Gy extends Hy{constructor(t,e,n,r){super(),this.component=t,this.viewContainerRef=e,this.injector=n,this.componentFactoryResolver=r}}class Xy extends Hy{constructor(t,e,n){super(),this.templateRef=t,this.viewContainerRef=e,this.context=n}get origin(){return this.templateRef.elementRef}attach(t,e=this.context){return this.context=e,super.attach(t)}detach(){return this.context=void 0,super.detach()}}class Ky extends Hy{constructor(t){super(),this.element=t instanceof ks?t.nativeElement:t}}class Yy{constructor(){this._isDisposed=!1,this.attachDomPortal=null}hasAttached(){return!!this._attachedPortal}attach(t){return t||function(){throw Error("Must provide a portal to attach")}(),this.hasAttached()&&qy(),this._isDisposed&&function(){throw Error("This PortalOutlet has already been disposed")}(),t instanceof Gy?(this._attachedPortal=t,this.attachComponentPortal(t)):t instanceof Xy?(this._attachedPortal=t,this.attachTemplatePortal(t)):this.attachDomPortal&&t instanceof Ky?(this._attachedPortal=t,this.attachDomPortal(t)):void function(){throw Error("Attempting to attach an unknown Portal type. BasePortalOutlet accepts either a ComponentPortal or a TemplatePortal.")}()}detach(){this._attachedPortal&&(this._attachedPortal.setAttachedHost(null),this._attachedPortal=null),this._invokeDisposeFn()}dispose(){this.hasAttached()&&this.detach(),this._invokeDisposeFn(),this._isDisposed=!0}setDisposeFn(t){this._disposeFn=t}_invokeDisposeFn(){this._disposeFn&&(this._disposeFn(),this._disposeFn=null)}}class Zy extends Yy{constructor(t,e,n,r,i){super(),this.outletElement=t,this._componentFactoryResolver=e,this._appRef=n,this._defaultInjector=r,this.attachDomPortal=t=>{if(!this._document)throw Error("Cannot attach DOM portal without _document constructor parameter");const e=t.element;if(!e.parentNode)throw Error("DOM portal content must be attached to a parent node.");const n=this._document.createComment("dom-portal");e.parentNode.insertBefore(n,e),this.outletElement.appendChild(e),super.setDisposeFn(()=>{n.parentNode&&n.parentNode.replaceChild(e,n)})},this._document=i}attachComponentPortal(t){const e=(t.componentFactoryResolver||this._componentFactoryResolver).resolveComponentFactory(t.component);let n;return t.viewContainerRef?(n=t.viewContainerRef.createComponent(e,t.viewContainerRef.length,t.injector||t.viewContainerRef.injector),this.setDisposeFn(()=>n.destroy())):(n=e.create(t.injector||this._defaultInjector),this._appRef.attachView(n.hostView),this.setDisposeFn(()=>{this._appRef.detachView(n.hostView),n.destroy()})),this.outletElement.appendChild(this._getComponentRootNode(n)),n}attachTemplatePortal(t){let e=t.viewContainerRef,n=e.createEmbeddedView(t.templateRef,t.context);return n.rootNodes.forEach(t=>this.outletElement.appendChild(t)),n.detectChanges(),this.setDisposeFn(()=>{let t=e.indexOf(n);-1!==t&&e.remove(t)}),n}dispose(){super.dispose(),null!=this.outletElement.parentNode&&this.outletElement.parentNode.removeChild(this.outletElement)}_getComponentRootNode(t){return t.hostView.rootNodes[0]}}let Qy=(()=>{class t extends Yy{constructor(t,e,n){super(),this._componentFactoryResolver=t,this._viewContainerRef=e,this._isInitialized=!1,this.attached=new vu,this.attachDomPortal=t=>{if(!this._document)throw Error("Cannot attach DOM portal without _document constructor parameter");const e=t.element;if(!e.parentNode)throw Error("DOM portal content must be attached to a parent node.");const n=this._document.createComment("dom-portal");t.setAttachedHost(this),e.parentNode.insertBefore(n,e),this._getRootNode().appendChild(e),super.setDisposeFn(()=>{n.parentNode&&n.parentNode.replaceChild(e,n)})},this._document=n}get portal(){return this._attachedPortal}set portal(t){(!this.hasAttached()||t||this._isInitialized)&&(this.hasAttached()&&super.detach(),t&&super.attach(t),this._attachedPortal=t)}get attachedRef(){return this._attachedRef}ngOnInit(){this._isInitialized=!0}ngOnDestroy(){super.dispose(),this._attachedPortal=null,this._attachedRef=null}attachComponentPortal(t){t.setAttachedHost(this);const e=null!=t.viewContainerRef?t.viewContainerRef:this._viewContainerRef,n=(t.componentFactoryResolver||this._componentFactoryResolver).resolveComponentFactory(t.component),r=e.createComponent(n,e.length,t.injector||e.injector);return e!==this._viewContainerRef&&this._getRootNode().appendChild(r.hostView.rootNodes[0]),super.setDisposeFn(()=>r.destroy()),this._attachedPortal=t,this._attachedRef=r,this.attached.emit(r),r}attachTemplatePortal(t){t.setAttachedHost(this);const e=this._viewContainerRef.createEmbeddedView(t.templateRef,t.context);return super.setDisposeFn(()=>this._viewContainerRef.clear()),this._attachedPortal=t,this._attachedRef=e,this.attached.emit(e),e}_getRootNode(){const t=this._viewContainerRef.element.nativeElement;return t.nodeType===t.ELEMENT_NODE?t:t.parentNode}}return t.\u0275fac=function(e){return new(e||t)(ka(Cs),ka(Ys),ka(zl))},t.\u0275dir=we({type:t,selectors:[["","cdkPortalOutlet",""]],inputs:{portal:["cdkPortalOutlet","portal"]},outputs:{attached:"attached"},exportAs:["cdkPortalOutlet"],features:[us]}),t})(),Jy=(()=>{class t{}return t.\u0275mod=ve({type:t}),t.\u0275inj=dt({factory:function(e){return new(e||t)}}),t})(),tv=(()=>{class t{}return t.\u0275mod=ve({type:t}),t.\u0275inj=dt({factory:function(e){return new(e||t)},imports:[[Yg]]}),t})();class ev extends C{constructor(t){super(),this._value=t}get value(){return this.getValue()}_subscribe(t){const e=super._subscribe(t);return e&&!e.closed&&t.next(this._value),e}getValue(){if(this.hasError)throw this.thrownError;if(this.closed)throw new w;return this._value}next(t){super.next(this._value=t)}}let nv=(()=>{class t{}return t.\u0275mod=ve({type:t}),t.\u0275inj=dt({factory:function(e){return new(e||t)}}),t})(),rv=(()=>{class t{constructor(t){this.template=t}}return t.\u0275fac=function(e){return new(e||t)(ka(Xs))},t.\u0275dir=we({type:t,selectors:[["","cdkTreeNodeDef",""]],inputs:{when:["cdkTreeNodeDefWhen","when"]}}),t})(),iv=(()=>{class t{}return t.\u0275mod=ve({type:t}),t.\u0275inj=dt({factory:function(e){return new(e||t)},providers:[_g,rv]}),t})();const ov=new Ds("10.1.3"),av=new Ds("10.1.3"),sv=new Lt("mat-sanity-checks",{providedIn:"root",factory:function(){return!0}});let uv=(()=>{class t{constructor(t,e,n){this._hasDoneGlobalChecks=!1,this._document=n,t._applyBodyHighContrastModeCssClasses(),this._sanityChecks=e,this._hasDoneGlobalChecks||(this._checkDoctypeIsDefined(),this._checkThemeIsPresent(),this._checkCdkVersionMatch(),this._hasDoneGlobalChecks=!0)}_getDocument(){const t=this._document||document;return"object"==typeof t&&t?t:null}_getWindow(){const t=this._getDocument(),e=(null==t?void 0:t.defaultView)||window;return"object"==typeof e&&e?e:null}_checksAreEnabled(){return Nr()&&!this._isTestEnv()}_isTestEnv(){const t=this._getWindow();return t&&(t.__karma__||t.jasmine)}_checkDoctypeIsDefined(){const t=this._checksAreEnabled()&&(!0===this._sanityChecks||this._sanityChecks.doctype),e=this._getDocument();t&&e&&!e.doctype&&console.warn("Current document does not have a doctype. This may cause some Angular Material components not to behave as expected.")}_checkThemeIsPresent(){const t=!this._checksAreEnabled()||!1===this._sanityChecks||!this._sanityChecks.theme,e=this._getDocument();if(t||!e||!e.body||"function"!=typeof getComputedStyle)return;const n=e.createElement("div");n.classList.add("mat-theme-loaded-marker"),e.body.appendChild(n);const r=getComputedStyle(n);r&&"none"!==r.display&&console.warn("Could not find Angular Material core theme. Most Material components may not work as expected. For more info refer to the theming guide: https://material.angular.io/guide/theming"),e.body.removeChild(n)}_checkCdkVersionMatch(){this._checksAreEnabled()&&(!0===this._sanityChecks||this._sanityChecks.version)&&av.full!==ov.full&&console.warn("The Angular Material version ("+av.full+") does not match the Angular CDK version ("+ov.full+").\nPlease ensure the versions of these two packages exactly match.")}}return t.\u0275mod=ve({type:t}),t.\u0275inj=dt({factory:function(e){return new(e||t)(Kt(kg),Kt(sv,8),Kt(zl,8))},imports:[[Yg],Yg]}),t})();function lv(t){return class extends t{constructor(...t){super(...t),this._disabled=!1}get disabled(){return this._disabled}set disabled(t){this._disabled=og(t)}}}function cv(t,e){return class extends t{constructor(...t){super(...t),this.color=e}get color(){return this._color}set color(t){const n=t||e;n!==this._color&&(this._color&&this._elementRef.nativeElement.classList.remove("mat-"+this._color),n&&this._elementRef.nativeElement.classList.add("mat-"+n),this._color=n)}}}function hv(t){return class extends t{constructor(...t){super(...t),this._disableRipple=!1}get disableRipple(){return this._disableRipple}set disableRipple(t){this._disableRipple=og(t)}}}function dv(t,e=0){return class extends t{constructor(...t){super(...t),this._tabIndex=e}get tabIndex(){return this.disabled?-1:this._tabIndex}set tabIndex(t){this._tabIndex=null!=t?ag(t):e}}}function fv(t){return class extends t{constructor(...t){super(...t),this.errorState=!1,this.stateChanges=new C}updateErrorState(){const t=this.errorState,e=(this.errorStateMatcher||this._defaultErrorStateMatcher).isErrorState(this.ngControl?this.ngControl.control:null,this._parentFormGroup||this._parentForm);e!==t&&(this.errorState=e,this.stateChanges.next())}}}const pv=new Lt("MAT_DATE_LOCALE",{providedIn:"root",factory:function(){return Yt(Ku)}});class mv{constructor(){this._localeChanges=new C}get localeChanges(){return this._localeChanges}deserialize(t){return null==t||this.isDateInstance(t)&&this.isValid(t)?t:this.invalid()}setLocale(t){this.locale=t,this._localeChanges.next()}compareDate(t,e){return this.getYear(t)-this.getYear(e)||this.getMonth(t)-this.getMonth(e)||this.getDate(t)-this.getDate(e)}sameDate(t,e){if(t&&e){let n=this.isValid(t),r=this.isValid(e);return n&&r?!this.compareDate(t,e):n==r}return t==e}clampDate(t,e,n){return e&&this.compareDate(t,e)<0?e:n&&this.compareDate(t,n)>0?n:t}}const gv=new Lt("mat-date-formats");let yv;try{yv="undefined"!=typeof Intl}catch(uO){yv=!1}const vv={long:["January","February","March","April","May","June","July","August","September","October","November","December"],short:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],narrow:["J","F","M","A","M","J","J","A","S","O","N","D"]},bv=_v(31,t=>String(t+1)),wv={long:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],short:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],narrow:["S","M","T","W","T","F","S"]},xv=/^\d{4}-\d{2}-\d{2}(?:T\d{2}:\d{2}:\d{2}(?:\.\d+)?(?:Z|(?:(?:\+|-)\d{2}:\d{2}))?)?$/;function _v(t,e){const n=Array(t);for(let r=0;r<t;r++)n[r]=e(r);return n}let Cv=(()=>{class t extends mv{constructor(t,e){super(),this.useUtcForDisplay=!0,super.setLocale(t),this.useUtcForDisplay=!e.TRIDENT,this._clampDate=e.TRIDENT||e.EDGE}getYear(t){return t.getFullYear()}getMonth(t){return t.getMonth()}getDate(t){return t.getDate()}getDayOfWeek(t){return t.getDay()}getMonthNames(t){if(yv){const e=new Intl.DateTimeFormat(this.locale,{month:t,timeZone:"utc"});return _v(12,t=>this._stripDirectionalityCharacters(this._format(e,new Date(2017,t,1))))}return vv[t]}getDateNames(){if(yv){const t=new Intl.DateTimeFormat(this.locale,{day:"numeric",timeZone:"utc"});return _v(31,e=>this._stripDirectionalityCharacters(this._format(t,new Date(2017,0,e+1))))}return bv}getDayOfWeekNames(t){if(yv){const e=new Intl.DateTimeFormat(this.locale,{weekday:t,timeZone:"utc"});return _v(7,t=>this._stripDirectionalityCharacters(this._format(e,new Date(2017,0,t+1))))}return wv[t]}getYearName(t){if(yv){const e=new Intl.DateTimeFormat(this.locale,{year:"numeric",timeZone:"utc"});return this._stripDirectionalityCharacters(this._format(e,t))}return String(this.getYear(t))}getFirstDayOfWeek(){return 0}getNumDaysInMonth(t){return this.getDate(this._createDateWithOverflow(this.getYear(t),this.getMonth(t)+1,0))}clone(t){return new Date(t.getTime())}createDate(t,e,n){if(e<0||e>11)throw Error(`Invalid month index "${e}". Month index has to be between 0 and 11.`);if(n<1)throw Error(`Invalid date "${n}". Date has to be greater than 0.`);let r=this._createDateWithOverflow(t,e,n);if(r.getMonth()!=e)throw Error(`Invalid date "${n}" for month with index "${e}".`);return r}today(){return new Date}parse(t){return"number"==typeof t?new Date(t):t?new Date(Date.parse(t)):null}format(t,e){if(!this.isValid(t))throw Error("NativeDateAdapter: Cannot format invalid date.");if(yv){this._clampDate&&(t.getFullYear()<1||t.getFullYear()>9999)&&(t=this.clone(t)).setFullYear(Math.max(1,Math.min(9999,t.getFullYear()))),e=Object.assign(Object.assign({},e),{timeZone:"utc"});const n=new Intl.DateTimeFormat(this.locale,e);return this._stripDirectionalityCharacters(this._format(n,t))}return this._stripDirectionalityCharacters(t.toDateString())}addCalendarYears(t,e){return this.addCalendarMonths(t,12*e)}addCalendarMonths(t,e){let n=this._createDateWithOverflow(this.getYear(t),this.getMonth(t)+e,this.getDate(t));return this.getMonth(n)!=((this.getMonth(t)+e)%12+12)%12&&(n=this._createDateWithOverflow(this.getYear(n),this.getMonth(n),0)),n}addCalendarDays(t,e){return this._createDateWithOverflow(this.getYear(t),this.getMonth(t),this.getDate(t)+e)}toIso8601(t){return[t.getUTCFullYear(),this._2digit(t.getUTCMonth()+1),this._2digit(t.getUTCDate())].join("-")}deserialize(t){if("string"==typeof t){if(!t)return null;if(xv.test(t)){let e=new Date(t);if(this.isValid(e))return e}}return super.deserialize(t)}isDateInstance(t){return t instanceof Date}isValid(t){return!isNaN(t.getTime())}invalid(){return new Date(NaN)}_createDateWithOverflow(t,e,n){const r=new Date(t,e,n);return t>=0&&t<100&&r.setFullYear(this.getYear(r)-1900),r}_2digit(t){return("00"+t).slice(-2)}_stripDirectionalityCharacters(t){return t.replace(/[\u200e\u200f]/g,"")}_format(t,e){const n=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()));return t.format(n)}}return t.\u0275fac=function(e){return new(e||t)(Kt(pv,8),Kt(Im))},t.\u0275prov=ht({token:t,factory:t.\u0275fac}),t})(),kv=(()=>{class t{}return t.\u0275mod=ve({type:t}),t.\u0275inj=dt({factory:function(e){return new(e||t)},providers:[{provide:mv,useClass:Cv}],imports:[[Mm]]}),t})();const Sv={parse:{dateInput:null},display:{dateInput:{year:"numeric",month:"numeric",day:"numeric"},monthYearLabel:{year:"numeric",month:"short"},dateA11yLabel:{year:"numeric",month:"long",day:"numeric"},monthYearA11yLabel:{year:"numeric",month:"long"}}};let Ev=(()=>{class t{}return t.\u0275mod=ve({type:t}),t.\u0275inj=dt({factory:function(e){return new(e||t)},providers:[{provide:gv,useValue:Sv}],imports:[[kv]]}),t})(),Ov=(()=>{class t{isErrorState(t,e){return!!(t&&t.invalid&&(t.touched||e&&e.submitted))}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=ht({factory:function(){return new t},token:t,providedIn:"root"}),t})(),Av=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275dir=we({type:t,selectors:[["","mat-line",""],["","matLine",""]],hostAttrs:[1,"mat-line"]}),t})();function Nv(t,e,n){const r=t.nativeElement.classList;n?r.add(e):r.remove(e)}let Tv=(()=>{class t{}return t.\u0275mod=ve({type:t}),t.\u0275inj=dt({factory:function(e){return new(e||t)},imports:[[uv],uv]}),t})();class Dv{constructor(t,e,n){this._renderer=t,this.element=e,this.config=n,this.state=3}fadeOut(){this._renderer.fadeOutRipple(this)}}const Rv={enterDuration:450,exitDuration:400},Iv=Lm({passive:!0}),Mv=["mousedown","touchstart"],Fv=["mouseup","mouseleave","touchend","touchcancel"];class Pv{constructor(t,e,n,r){this._target=t,this._ngZone=e,this._isPointerDown=!1,this._activeRipples=new Set,this._pointerUpEventsRegistered=!1,r.isBrowser&&(this._containerElement=lg(n))}fadeInRipple(t,e,n={}){const r=this._containerRect=this._containerRect||this._containerElement.getBoundingClientRect(),i=Object.assign(Object.assign({},Rv),n.animation);n.centered&&(t=r.left+r.width/2,e=r.top+r.height/2);const o=n.radius||function(t,e,n){const r=Math.max(Math.abs(t-n.left),Math.abs(t-n.right)),i=Math.max(Math.abs(e-n.top),Math.abs(e-n.bottom));return Math.sqrt(r*r+i*i)}(t,e,r),a=t-r.left,s=e-r.top,u=i.enterDuration,l=document.createElement("div");l.classList.add("mat-ripple-element"),l.style.left=a-o+"px",l.style.top=s-o+"px",l.style.height=2*o+"px",l.style.width=2*o+"px",null!=n.color&&(l.style.backgroundColor=n.color),l.style.transitionDuration=u+"ms",this._containerElement.appendChild(l),window.getComputedStyle(l).getPropertyValue("opacity"),l.style.transform="scale(1)";const c=new Dv(this,l,n);return c.state=0,this._activeRipples.add(c),n.persistent||(this._mostRecentTransientRipple=c),this._runTimeoutOutsideZone(()=>{const t=c===this._mostRecentTransientRipple;c.state=1,n.persistent||t&&this._isPointerDown||c.fadeOut()},u),c}fadeOutRipple(t){const e=this._activeRipples.delete(t);if(t===this._mostRecentTransientRipple&&(this._mostRecentTransientRipple=null),this._activeRipples.size||(this._containerRect=null),!e)return;const n=t.element,r=Object.assign(Object.assign({},Rv),t.config.animation);n.style.transitionDuration=r.exitDuration+"ms",n.style.opacity="0",t.state=2,this._runTimeoutOutsideZone(()=>{t.state=3,n.parentNode.removeChild(n)},r.exitDuration)}fadeOutAll(){this._activeRipples.forEach(t=>t.fadeOut())}setupTriggerEvents(t){const e=lg(t);e&&e!==this._triggerElement&&(this._removeTriggerEvents(),this._triggerElement=e,this._registerEvents(Mv))}handleEvent(t){"mousedown"===t.type?this._onMousedown(t):"touchstart"===t.type?this._onTouchStart(t):this._onPointerUp(),this._pointerUpEventsRegistered||(this._registerEvents(Fv),this._pointerUpEventsRegistered=!0)}_onMousedown(t){const e=bg(t),n=this._lastTouchStartEvent&&Date.now()<this._lastTouchStartEvent+800;this._target.rippleDisabled||e||n||(this._isPointerDown=!0,this.fadeInRipple(t.clientX,t.clientY,this._target.rippleConfig))}_onTouchStart(t){if(!this._target.rippleDisabled){this._lastTouchStartEvent=Date.now(),this._isPointerDown=!0;const e=t.changedTouches;for(let t=0;t<e.length;t++)this.fadeInRipple(e[t].clientX,e[t].clientY,this._target.rippleConfig)}}_onPointerUp(){this._isPointerDown&&(this._isPointerDown=!1,this._activeRipples.forEach(t=>{!t.config.persistent&&(1===t.state||t.config.terminateOnPointerUp&&0===t.state)&&t.fadeOut()}))}_runTimeoutOutsideZone(t,e=0){this._ngZone.runOutsideAngular(()=>setTimeout(t,e))}_registerEvents(t){this._ngZone.runOutsideAngular(()=>{t.forEach(t=>{this._triggerElement.addEventListener(t,this,Iv)})})}_removeTriggerEvents(){this._triggerElement&&(Mv.forEach(t=>{this._triggerElement.removeEventListener(t,this,Iv)}),this._pointerUpEventsRegistered&&Fv.forEach(t=>{this._triggerElement.removeEventListener(t,this,Iv)}))}}const jv=new Lt("mat-ripple-global-options");let zv=(()=>{class t{constructor(t,e,n,r,i){this._elementRef=t,this._animationMode=i,this.radius=0,this._disabled=!1,this._isInitialized=!1,this._globalOptions=r||{},this._rippleRenderer=new Pv(this,e,t,n)}get disabled(){return this._disabled}set disabled(t){this._disabled=t,this._setupTriggerEventsIfEnabled()}get trigger(){return this._trigger||this._elementRef.nativeElement}set trigger(t){this._trigger=t,this._setupTriggerEventsIfEnabled()}ngOnInit(){this._isInitialized=!0,this._setupTriggerEventsIfEnabled()}ngOnDestroy(){this._rippleRenderer._removeTriggerEvents()}fadeOutAll(){this._rippleRenderer.fadeOutAll()}get rippleConfig(){return{centered:this.centered,radius:this.radius,color:this.color,animation:Object.assign(Object.assign(Object.assign({},this._globalOptions.animation),"NoopAnimations"===this._animationMode?{enterDuration:0,exitDuration:0}:{}),this.animation),terminateOnPointerUp:this._globalOptions.terminateOnPointerUp}}get rippleDisabled(){return this.disabled||!!this._globalOptions.disabled}_setupTriggerEventsIfEnabled(){!this.disabled&&this._isInitialized&&this._rippleRenderer.setupTriggerEvents(this.trigger)}launch(t,e=0,n){return"number"==typeof t?this._rippleRenderer.fadeInRipple(t,e,Object.assign(Object.assign({},this.rippleConfig),n)):this._rippleRenderer.fadeInRipple(0,0,Object.assign(Object.assign({},this.rippleConfig),t))}}return t.\u0275fac=function(e){return new(e||t)(ka(ks),ka(sl),ka(Im),ka(jv,8),ka(wf,8))},t.\u0275dir=we({type:t,selectors:[["","mat-ripple",""],["","matRipple",""]],hostAttrs:[1,"mat-ripple"],hostVars:2,hostBindings:function(t,e){2&t&&Ya("mat-ripple-unbounded",e.unbounded)},inputs:{radius:["matRippleRadius","radius"],disabled:["matRippleDisabled","disabled"],trigger:["matRippleTrigger","trigger"],color:["matRippleColor","color"],unbounded:["matRippleUnbounded","unbounded"],centered:["matRippleCentered","centered"],animation:["matRippleAnimation","animation"]},exportAs:["matRipple"]}),t})(),Lv=(()=>{class t{}return t.\u0275mod=ve({type:t}),t.\u0275inj=dt({factory:function(e){return new(e||t)},imports:[[uv,Mm],uv]}),t})(),Bv=(()=>{class t{}return t.\u0275mod=ve({type:t}),t.\u0275inj=dt({factory:function(e){return new(e||t)}}),t})(),Uv=(()=>{class t{}return t.\u0275mod=ve({type:t}),t.\u0275inj=dt({factory:function(e){return new(e||t)},imports:[[Lv,xc,Bv]]}),t})();const $v=new Lt("mat-label-global-options");function Vv(t){return new v(e=>{let n;try{n=t()}catch(r){return void e.error(r)}return(n?L(n):eg()).subscribe(e)})}class Wv{constructor(t,e){this._viewportRuler=t,this._previousHTMLStyles={top:"",left:""},this._isEnabled=!1,this._document=e}attach(){}enable(){if(this._canBeEnabled()){const t=this._document.documentElement;this._previousScrollPosition=this._viewportRuler.getViewportScrollPosition(),this._previousHTMLStyles.left=t.style.left||"",this._previousHTMLStyles.top=t.style.top||"",t.style.left=ug(-this._previousScrollPosition.left),t.style.top=ug(-this._previousScrollPosition.top),t.classList.add("cdk-global-scrollblock"),this._isEnabled=!0}}disable(){if(this._isEnabled){const t=this._document.documentElement,e=t.style,n=this._document.body.style,r=e.scrollBehavior||"",i=n.scrollBehavior||"";this._isEnabled=!1,e.left=this._previousHTMLStyles.left,e.top=this._previousHTMLStyles.top,t.classList.remove("cdk-global-scrollblock"),e.scrollBehavior=n.scrollBehavior="auto",window.scroll(this._previousScrollPosition.left,this._previousScrollPosition.top),e.scrollBehavior=r,n.scrollBehavior=i}}_canBeEnabled(){if(this._document.documentElement.classList.contains("cdk-global-scrollblock")||this._isEnabled)return!1;const t=this._document.body,e=this._viewportRuler.getViewportSize();return t.scrollHeight>e.height||t.scrollWidth>e.width}}function qv(){return Error("Scroll strategy has already been attached.")}class Hv{constructor(t,e,n,r){this._scrollDispatcher=t,this._ngZone=e,this._viewportRuler=n,this._config=r,this._scrollSubscription=null,this._detach=()=>{this.disable(),this._overlayRef.hasAttached()&&this._ngZone.run(()=>this._overlayRef.detach())}}attach(t){if(this._overlayRef)throw qv();this._overlayRef=t}enable(){if(this._scrollSubscription)return;const t=this._scrollDispatcher.scrolled(0);this._config&&this._config.threshold&&this._config.threshold>1?(this._initialScrollPosition=this._viewportRuler.getViewportScrollPosition().top,this._scrollSubscription=t.subscribe(()=>{const t=this._viewportRuler.getViewportScrollPosition().top;Math.abs(t-this._initialScrollPosition)>this._config.threshold?this._detach():this._overlayRef.updatePosition()})):this._scrollSubscription=t.subscribe(this._detach)}disable(){this._scrollSubscription&&(this._scrollSubscription.unsubscribe(),this._scrollSubscription=null)}detach(){this.disable(),this._overlayRef=null}}class Gv{enable(){}disable(){}attach(){}}function Xv(t,e){return e.some(e=>t.bottom<e.top||t.top>e.bottom||t.right<e.left||t.left>e.right)}function Kv(t,e){return e.some(e=>t.top<e.top||t.bottom>e.bottom||t.left<e.left||t.right>e.right)}class Yv{constructor(t,e,n,r){this._scrollDispatcher=t,this._viewportRuler=e,this._ngZone=n,this._config=r,this._scrollSubscription=null}attach(t){if(this._overlayRef)throw qv();this._overlayRef=t}enable(){this._scrollSubscription||(this._scrollSubscription=this._scrollDispatcher.scrolled(this._config?this._config.scrollThrottle:0).subscribe(()=>{if(this._overlayRef.updatePosition(),this._config&&this._config.autoClose){const t=this._overlayRef.overlayElement.getBoundingClientRect(),{width:e,height:n}=this._viewportRuler.getViewportSize();Xv(t,[{width:e,height:n,bottom:n,right:e,top:0,left:0}])&&(this.disable(),this._ngZone.run(()=>this._overlayRef.detach()))}}))}disable(){this._scrollSubscription&&(this._scrollSubscription.unsubscribe(),this._scrollSubscription=null)}detach(){this.disable(),this._overlayRef=null}}let Zv=(()=>{class t{constructor(t,e,n,r){this._scrollDispatcher=t,this._viewportRuler=e,this._ngZone=n,this.noop=()=>new Gv,this.close=t=>new Hv(this._scrollDispatcher,this._ngZone,this._viewportRuler,t),this.block=()=>new Wv(this._viewportRuler,this._document),this.reposition=t=>new Yv(this._scrollDispatcher,this._viewportRuler,this._ngZone,t),this._document=r}}return t.\u0275fac=function(e){return new(e||t)(Kt(Qg),Kt(Jg),Kt(sl),Kt(zl))},t.\u0275prov=ht({factory:function(){return new t(Kt(Qg),Kt(Jg),Kt(sl),Kt(zl))},token:t,providedIn:"root"}),t})();class Qv{constructor(t){if(this.scrollStrategy=new Gv,this.panelClass="",this.hasBackdrop=!1,this.backdropClass="cdk-overlay-dark-backdrop",this.disposeOnNavigation=!1,this.excludeFromOutsideClick=[],t){const e=Object.keys(t);for(const n of e)void 0!==t[n]&&(this[n]=t[n])}}}class Jv{constructor(t,e,n,r,i){this.offsetX=n,this.offsetY=r,this.panelClass=i,this.originX=t.originX,this.originY=t.originY,this.overlayX=e.overlayX,this.overlayY=e.overlayY}}class tb{constructor(t,e){this.connectionPair=t,this.scrollableViewProperties=e}}function eb(t,e){if("top"!==e&&"bottom"!==e&&"center"!==e)throw Error(`ConnectedPosition: Invalid ${t} "${e}". Expected "top", "bottom" or "center".`)}function nb(t,e){if("start"!==e&&"end"!==e&&"center"!==e)throw Error(`ConnectedPosition: Invalid ${t} "${e}". Expected "start", "end" or "center".`)}let rb=(()=>{class t{constructor(t){this._attachedOverlays=[],this._document=t}ngOnDestroy(){this.detach()}add(t){this.remove(t),this._attachedOverlays.push(t)}remove(t){const e=this._attachedOverlays.indexOf(t);e>-1&&this._attachedOverlays.splice(e,1),0===this._attachedOverlays.length&&this.detach()}}return t.\u0275fac=function(e){return new(e||t)(Kt(zl))},t.\u0275prov=ht({factory:function(){return new t(Kt(zl))},token:t,providedIn:"root"}),t})(),ib=(()=>{class t extends rb{constructor(t){super(t),this._keydownListener=t=>{const e=this._attachedOverlays;for(let n=e.length-1;n>-1;n--)if(e[n]._keydownEvents.observers.length>0){e[n]._keydownEvents.next(t);break}}}add(t){super.add(t),this._isAttached||(this._document.body.addEventListener("keydown",this._keydownListener),this._isAttached=!0)}detach(){this._isAttached&&(this._document.body.removeEventListener("keydown",this._keydownListener),this._isAttached=!1)}}return t.\u0275fac=function(e){return new(e||t)(Kt(zl))},t.\u0275prov=ht({factory:function(){return new t(Kt(zl))},token:t,providedIn:"root"}),t})(),ob=(()=>{class t extends rb{constructor(t,e){super(t),this._platform=e,this._cursorStyleIsSet=!1,this._clickListener=t=>{const e=t.composedPath?t.composedPath()[0]:t.target,n=this._attachedOverlays;for(let r=n.length-1;r>-1;r--){const i=n[r];if(!(i._outsidePointerEvents.observers.length<1)){if([...i.getConfig().excludeFromOutsideClick,i.overlayElement].some(t=>t.contains(e)))break;i._outsidePointerEvents.next(t)}}}}add(t){super.add(t),this._isAttached||(this._document.body.addEventListener("click",this._clickListener,!0),this._platform.IOS&&!this._cursorStyleIsSet&&(this._cursorOriginalValue=this._document.body.style.cursor,this._document.body.style.cursor="pointer",this._cursorStyleIsSet=!0),this._isAttached=!0)}detach(){this._isAttached&&(this._document.body.removeEventListener("click",this._clickListener,!0),this._platform.IOS&&this._cursorStyleIsSet&&(this._document.body.style.cursor=this._cursorOriginalValue,this._cursorStyleIsSet=!1),this._isAttached=!1)}}return t.\u0275fac=function(e){return new(e||t)(Kt(zl),Kt(Im))},t.\u0275prov=ht({factory:function(){return new t(Kt(zl),Kt(Im))},token:t,providedIn:"root"}),t})();const ab=!("undefined"==typeof window||!window||!window.__karma__&&!window.jasmine);let sb=(()=>{class t{constructor(t,e){this._platform=e,this._document=t}ngOnDestroy(){const t=this._containerElement;t&&t.parentNode&&t.parentNode.removeChild(t)}getContainerElement(){return this._containerElement||this._createContainer(),this._containerElement}_createContainer(){const t=this._platform?this._platform.isBrowser:"undefined"!=typeof window;if(t||ab){const t=this._document.querySelectorAll('.cdk-overlay-container[platform="server"], .cdk-overlay-container[platform="test"]');for(let e=0;e<t.length;e++)t[e].parentNode.removeChild(t[e])}const e=this._document.createElement("div");e.classList.add("cdk-overlay-container"),ab?e.setAttribute("platform","test"):t||e.setAttribute("platform","server"),this._document.body.appendChild(e),this._containerElement=e}}return t.\u0275fac=function(e){return new(e||t)(Kt(zl),Kt(Im))},t.\u0275prov=ht({factory:function(){return new t(Kt(zl),Kt(Im))},token:t,providedIn:"root"}),t})();class ub{constructor(t,e,n,r,i,o,a,s,u){this._portalOutlet=t,this._host=e,this._pane=n,this._config=r,this._ngZone=i,this._keyboardDispatcher=o,this._document=a,this._location=s,this._outsideClickDispatcher=u,this._backdropElement=null,this._backdropClick=new C,this._attachments=new C,this._detachments=new C,this._locationChanges=h.EMPTY,this._backdropClickHandler=t=>this._backdropClick.next(t),this._keydownEvents=new C,this._outsidePointerEvents=new C,r.scrollStrategy&&(this._scrollStrategy=r.scrollStrategy,this._scrollStrategy.attach(this)),this._positionStrategy=r.positionStrategy}get overlayElement(){return this._pane}get backdropElement(){return this._backdropElement}get hostElement(){return this._host}attach(t){let e=this._portalOutlet.attach(t);return!this._host.parentElement&&this._previousHostParent&&this._previousHostParent.appendChild(this._host),this._positionStrategy&&this._positionStrategy.attach(this),this._updateStackingOrder(),this._updateElementSize(),this._updateElementDirection(),this._scrollStrategy&&this._scrollStrategy.enable(),this._ngZone.onStable.asObservable().pipe(ng(1)).subscribe(()=>{this.hasAttached()&&this.updatePosition()}),this._togglePointerEvents(!0),this._config.hasBackdrop&&this._attachBackdrop(),this._config.panelClass&&this._toggleClasses(this._pane,this._config.panelClass,!0),this._attachments.next(),this._keyboardDispatcher.add(this),this._config.disposeOnNavigation&&this._location&&(this._locationChanges=this._location.subscribe(()=>this.dispose())),this._outsideClickDispatcher&&this._outsideClickDispatcher.add(this),e}detach(){if(!this.hasAttached())return;this.detachBackdrop(),this._togglePointerEvents(!1),this._positionStrategy&&this._positionStrategy.detach&&this._positionStrategy.detach(),this._scrollStrategy&&this._scrollStrategy.disable();const t=this._portalOutlet.detach();return this._detachments.next(),this._keyboardDispatcher.remove(this),this._detachContentWhenStable(),this._locationChanges.unsubscribe(),this._outsideClickDispatcher&&this._outsideClickDispatcher.remove(this),t}dispose(){const t=this.hasAttached();this._positionStrategy&&this._positionStrategy.dispose(),this._disposeScrollStrategy(),this.detachBackdrop(),this._locationChanges.unsubscribe(),this._keyboardDispatcher.remove(this),this._portalOutlet.dispose(),this._attachments.complete(),this._backdropClick.complete(),this._keydownEvents.complete(),this._outsidePointerEvents.complete(),this._outsideClickDispatcher&&this._outsideClickDispatcher.remove(this),this._host&&this._host.parentNode&&(this._host.parentNode.removeChild(this._host),this._host=null),this._previousHostParent=this._pane=null,t&&this._detachments.next(),this._detachments.complete()}hasAttached(){return this._portalOutlet.hasAttached()}backdropClick(){return this._backdropClick.asObservable()}attachments(){return this._attachments.asObservable()}detachments(){return this._detachments.asObservable()}keydownEvents(){return this._keydownEvents.asObservable()}outsidePointerEvents(){return this._outsidePointerEvents.asObservable()}getConfig(){return this._config}updatePosition(){this._positionStrategy&&this._positionStrategy.apply()}updatePositionStrategy(t){t!==this._positionStrategy&&(this._positionStrategy&&this._positionStrategy.dispose(),this._positionStrategy=t,this.hasAttached()&&(t.attach(this),this.updatePosition()))}updateSize(t){this._config=Object.assign(Object.assign({},this._config),t),this._updateElementSize()}setDirection(t){this._config=Object.assign(Object.assign({},this._config),{direction:t}),this._updateElementDirection()}addPanelClass(t){this._pane&&this._toggleClasses(this._pane,t,!0)}removePanelClass(t){this._pane&&this._toggleClasses(this._pane,t,!1)}getDirection(){const t=this._config.direction;return t?"string"==typeof t?t:t.value:"ltr"}updateScrollStrategy(t){t!==this._scrollStrategy&&(this._disposeScrollStrategy(),this._scrollStrategy=t,this.hasAttached()&&(t.attach(this),t.enable()))}_updateElementDirection(){this._host.setAttribute("dir",this.getDirection())}_updateElementSize(){if(!this._pane)return;const t=this._pane.style;t.width=ug(this._config.width),t.height=ug(this._config.height),t.minWidth=ug(this._config.minWidth),t.minHeight=ug(this._config.minHeight),t.maxWidth=ug(this._config.maxWidth),t.maxHeight=ug(this._config.maxHeight)}_togglePointerEvents(t){this._pane.style.pointerEvents=t?"auto":"none"}_attachBackdrop(){this._backdropElement=this._document.createElement("div"),this._backdropElement.classList.add("cdk-overlay-backdrop"),this._config.backdropClass&&this._toggleClasses(this._backdropElement,this._config.backdropClass,!0),this._host.parentElement.insertBefore(this._backdropElement,this._host),this._backdropElement.addEventListener("click",this._backdropClickHandler),"undefined"!=typeof requestAnimationFrame?this._ngZone.runOutsideAngular(()=>{requestAnimationFrame(()=>{this._backdropElement&&this._backdropElement.classList.add("cdk-overlay-backdrop-showing")})}):this._backdropElement.classList.add("cdk-overlay-backdrop-showing")}_updateStackingOrder(){this._host.nextSibling&&this._host.parentNode.appendChild(this._host)}detachBackdrop(){let t,e=this._backdropElement;if(!e)return;let n=()=>{e&&(e.removeEventListener("click",this._backdropClickHandler),e.removeEventListener("transitionend",n),e.parentNode&&e.parentNode.removeChild(e)),this._backdropElement==e&&(this._backdropElement=null),this._config.backdropClass&&this._toggleClasses(e,this._config.backdropClass,!1),clearTimeout(t)};e.classList.remove("cdk-overlay-backdrop-showing"),this._ngZone.runOutsideAngular(()=>{e.addEventListener("transitionend",n)}),e.style.pointerEvents="none",t=this._ngZone.runOutsideAngular(()=>setTimeout(n,500))}_toggleClasses(t,e,n){const r=t.classList;sg(e).forEach(t=>{t&&(n?r.add(t):r.remove(t))})}_detachContentWhenStable(){this._ngZone.runOutsideAngular(()=>{const t=this._ngZone.onStable.asObservable().pipe(Pg(q(this._attachments,this._detachments))).subscribe(()=>{this._pane&&this._host&&0!==this._pane.children.length||(this._pane&&this._config.panelClass&&this._toggleClasses(this._pane,this._config.panelClass,!1),this._host&&this._host.parentElement&&(this._previousHostParent=this._host.parentElement,this._previousHostParent.removeChild(this._host)),t.unsubscribe())})})}_disposeScrollStrategy(){const t=this._scrollStrategy;t&&(t.disable(),t.detach&&t.detach())}}const lb=/([A-Za-z%]+)$/;class cb{constructor(t,e,n,r,i){this._viewportRuler=e,this._document=n,this._platform=r,this._overlayContainer=i,this._lastBoundingBoxSize={width:0,height:0},this._isPushed=!1,this._canPush=!0,this._growAfterOpen=!1,this._hasFlexibleDimensions=!0,this._positionLocked=!1,this._viewportMargin=0,this._scrollables=[],this._preferredPositions=[],this._positionChanges=new C,this._resizeSubscription=h.EMPTY,this._offsetX=0,this._offsetY=0,this._appliedPanelClasses=[],this.positionChanges=this._positionChanges.asObservable(),this.setOrigin(t)}get positions(){return this._preferredPositions}attach(t){if(this._overlayRef&&t!==this._overlayRef)throw Error("This position strategy is already attached to an overlay");this._validatePositions(),t.hostElement.classList.add("cdk-overlay-connected-position-bounding-box"),this._overlayRef=t,this._boundingBox=t.hostElement,this._pane=t.overlayElement,this._isDisposed=!1,this._isInitialRender=!0,this._lastPosition=null,this._resizeSubscription.unsubscribe(),this._resizeSubscription=this._viewportRuler.change().subscribe(()=>{this._isInitialRender=!0,this.apply()})}apply(){if(this._isDisposed||!this._platform.isBrowser)return;if(!this._isInitialRender&&this._positionLocked&&this._lastPosition)return void this.reapplyLastPosition();this._clearPanelClasses(),this._resetOverlayElementStyles(),this._resetBoundingBoxStyles(),this._viewportRect=this._getNarrowedViewportRect(),this._originRect=this._getOriginRect(),this._overlayRect=this._pane.getBoundingClientRect();const t=this._originRect,e=this._overlayRect,n=this._viewportRect,r=[];let i;for(let o of this._preferredPositions){let a=this._getOriginPoint(t,o),s=this._getOverlayPoint(a,e,o),u=this._getOverlayFit(s,e,n,o);if(u.isCompletelyWithinViewport)return this._isPushed=!1,void this._applyPosition(o,a);this._canFitWithFlexibleDimensions(u,s,n)?r.push({position:o,origin:a,overlayRect:e,boundingBoxRect:this._calculateBoundingBoxRect(a,o)}):(!i||i.overlayFit.visibleArea<u.visibleArea)&&(i={overlayFit:u,overlayPoint:s,originPoint:a,position:o,overlayRect:e})}if(r.length){let t=null,e=-1;for(const n of r){const r=n.boundingBoxRect.width*n.boundingBoxRect.height*(n.position.weight||1);r>e&&(e=r,t=n)}return this._isPushed=!1,void this._applyPosition(t.position,t.origin)}if(this._canPush)return this._isPushed=!0,void this._applyPosition(i.position,i.originPoint);this._applyPosition(i.position,i.originPoint)}detach(){this._clearPanelClasses(),this._lastPosition=null,this._previousPushAmount=null,this._resizeSubscription.unsubscribe()}dispose(){this._isDisposed||(this._boundingBox&&hb(this._boundingBox.style,{top:"",left:"",right:"",bottom:"",height:"",width:"",alignItems:"",justifyContent:""}),this._pane&&this._resetOverlayElementStyles(),this._overlayRef&&this._overlayRef.hostElement.classList.remove("cdk-overlay-connected-position-bounding-box"),this.detach(),this._positionChanges.complete(),this._overlayRef=this._boundingBox=null,this._isDisposed=!0)}reapplyLastPosition(){if(!this._isDisposed&&(!this._platform||this._platform.isBrowser)){this._originRect=this._getOriginRect(),this._overlayRect=this._pane.getBoundingClientRect(),this._viewportRect=this._getNarrowedViewportRect();const t=this._lastPosition||this._preferredPositions[0],e=this._getOriginPoint(this._originRect,t);this._applyPosition(t,e)}}withScrollableContainers(t){return this._scrollables=t,this}withPositions(t){return this._preferredPositions=t,-1===t.indexOf(this._lastPosition)&&(this._lastPosition=null),this._validatePositions(),this}withViewportMargin(t){return this._viewportMargin=t,this}withFlexibleDimensions(t=!0){return this._hasFlexibleDimensions=t,this}withGrowAfterOpen(t=!0){return this._growAfterOpen=t,this}withPush(t=!0){return this._canPush=t,this}withLockedPosition(t=!0){return this._positionLocked=t,this}setOrigin(t){return this._origin=t,this}withDefaultOffsetX(t){return this._offsetX=t,this}withDefaultOffsetY(t){return this._offsetY=t,this}withTransformOriginOn(t){return this._transformOriginSelector=t,this}_getOriginPoint(t,e){let n,r;if("center"==e.originX)n=t.left+t.width/2;else{const r=this._isRtl()?t.right:t.left,i=this._isRtl()?t.left:t.right;n="start"==e.originX?r:i}return r="center"==e.originY?t.top+t.height/2:"top"==e.originY?t.top:t.bottom,{x:n,y:r}}_getOverlayPoint(t,e,n){let r,i;return r="center"==n.overlayX?-e.width/2:"start"===n.overlayX?this._isRtl()?-e.width:0:this._isRtl()?0:-e.width,i="center"==n.overlayY?-e.height/2:"top"==n.overlayY?0:-e.height,{x:t.x+r,y:t.y+i}}_getOverlayFit(t,e,n,r){let{x:i,y:o}=t,a=this._getOffset(r,"x"),s=this._getOffset(r,"y");a&&(i+=a),s&&(o+=s);let u=0-o,l=o+e.height-n.height,c=this._subtractOverflows(e.width,0-i,i+e.width-n.width),h=this._subtractOverflows(e.height,u,l),d=c*h;return{visibleArea:d,isCompletelyWithinViewport:e.width*e.height===d,fitsInViewportVertically:h===e.height,fitsInViewportHorizontally:c==e.width}}_canFitWithFlexibleDimensions(t,e,n){if(this._hasFlexibleDimensions){const r=n.bottom-e.y,i=n.right-e.x,o=db(this._overlayRef.getConfig().minHeight),a=db(this._overlayRef.getConfig().minWidth),s=t.fitsInViewportHorizontally||null!=a&&a<=i;return(t.fitsInViewportVertically||null!=o&&o<=r)&&s}return!1}_pushOverlayOnScreen(t,e,n){if(this._previousPushAmount&&this._positionLocked)return{x:t.x+this._previousPushAmount.x,y:t.y+this._previousPushAmount.y};const r=this._viewportRect,i=Math.max(t.x+e.width-r.width,0),o=Math.max(t.y+e.height-r.height,0),a=Math.max(r.top-n.top-t.y,0),s=Math.max(r.left-n.left-t.x,0);let u=0,l=0;return u=e.width<=r.width?s||-i:t.x<this._viewportMargin?r.left-n.left-t.x:0,l=e.height<=r.height?a||-o:t.y<this._viewportMargin?r.top-n.top-t.y:0,this._previousPushAmount={x:u,y:l},{x:t.x+u,y:t.y+l}}_applyPosition(t,e){if(this._setTransformOrigin(t),this._setOverlayElementStyles(e,t),this._setBoundingBoxStyles(e,t),t.panelClass&&this._addPanelClasses(t.panelClass),this._lastPosition=t,this._positionChanges.observers.length){const e=this._getScrollVisibility(),n=new tb(t,e);this._positionChanges.next(n)}this._isInitialRender=!1}_setTransformOrigin(t){if(!this._transformOriginSelector)return;const e=this._boundingBox.querySelectorAll(this._transformOriginSelector);let n,r=t.overlayY;n="center"===t.overlayX?"center":this._isRtl()?"start"===t.overlayX?"right":"left":"start"===t.overlayX?"left":"right";for(let i=0;i<e.length;i++)e[i].style.transformOrigin=`${n} ${r}`}_calculateBoundingBoxRect(t,e){const n=this._viewportRect,r=this._isRtl();let i,o,a,s,u,l;if("top"===e.overlayY)o=t.y,i=n.height-o+this._viewportMargin;else if("bottom"===e.overlayY)a=n.height-t.y+2*this._viewportMargin,i=n.height-a+this._viewportMargin;else{const e=Math.min(n.bottom-t.y+n.top,t.y),r=this._lastBoundingBoxSize.height;i=2*e,o=t.y-e,i>r&&!this._isInitialRender&&!this._growAfterOpen&&(o=t.y-r/2)}if("end"===e.overlayX&&!r||"start"===e.overlayX&&r)l=n.width-t.x+this._viewportMargin,s=t.x-this._viewportMargin;else if("start"===e.overlayX&&!r||"end"===e.overlayX&&r)u=t.x,s=n.right-t.x;else{const e=Math.min(n.right-t.x+n.left,t.x),r=this._lastBoundingBoxSize.width;s=2*e,u=t.x-e,s>r&&!this._isInitialRender&&!this._growAfterOpen&&(u=t.x-r/2)}return{top:o,left:u,bottom:a,right:l,width:s,height:i}}_setBoundingBoxStyles(t,e){const n=this._calculateBoundingBoxRect(t,e);this._isInitialRender||this._growAfterOpen||(n.height=Math.min(n.height,this._lastBoundingBoxSize.height),n.width=Math.min(n.width,this._lastBoundingBoxSize.width));const r={};if(this._hasExactPosition())r.top=r.left="0",r.bottom=r.right=r.maxHeight=r.maxWidth="",r.width=r.height="100%";else{const t=this._overlayRef.getConfig().maxHeight,i=this._overlayRef.getConfig().maxWidth;r.height=ug(n.height),r.top=ug(n.top),r.bottom=ug(n.bottom),r.width=ug(n.width),r.left=ug(n.left),r.right=ug(n.right),r.alignItems="center"===e.overlayX?"center":"end"===e.overlayX?"flex-end":"flex-start",r.justifyContent="center"===e.overlayY?"center":"bottom"===e.overlayY?"flex-end":"flex-start",t&&(r.maxHeight=ug(t)),i&&(r.maxWidth=ug(i))}this._lastBoundingBoxSize=n,hb(this._boundingBox.style,r)}_resetBoundingBoxStyles(){hb(this._boundingBox.style,{top:"0",left:"0",right:"0",bottom:"0",height:"",width:"",alignItems:"",justifyContent:""})}_resetOverlayElementStyles(){hb(this._pane.style,{top:"",left:"",bottom:"",right:"",position:"",transform:""})}_setOverlayElementStyles(t,e){const n={},r=this._hasExactPosition(),i=this._hasFlexibleDimensions,o=this._overlayRef.getConfig();if(r){const r=this._viewportRuler.getViewportScrollPosition();hb(n,this._getExactOverlayY(e,t,r)),hb(n,this._getExactOverlayX(e,t,r))}else n.position="static";let a="",s=this._getOffset(e,"x"),u=this._getOffset(e,"y");s&&(a+=`translateX(${s}px) `),u&&(a+=`translateY(${u}px)`),n.transform=a.trim(),o.maxHeight&&(r?n.maxHeight=ug(o.maxHeight):i&&(n.maxHeight="")),o.maxWidth&&(r?n.maxWidth=ug(o.maxWidth):i&&(n.maxWidth="")),hb(this._pane.style,n)}_getExactOverlayY(t,e,n){let r={top:"",bottom:""},i=this._getOverlayPoint(e,this._overlayRect,t);this._isPushed&&(i=this._pushOverlayOnScreen(i,this._overlayRect,n));let o=this._overlayContainer.getContainerElement().getBoundingClientRect().top;return i.y-=o,"bottom"===t.overlayY?r.bottom=this._document.documentElement.clientHeight-(i.y+this._overlayRect.height)+"px":r.top=ug(i.y),r}_getExactOverlayX(t,e,n){let r,i={left:"",right:""},o=this._getOverlayPoint(e,this._overlayRect,t);return this._isPushed&&(o=this._pushOverlayOnScreen(o,this._overlayRect,n)),r=this._isRtl()?"end"===t.overlayX?"left":"right":"end"===t.overlayX?"right":"left","right"===r?i.right=this._document.documentElement.clientWidth-(o.x+this._overlayRect.width)+"px":i.left=ug(o.x),i}_getScrollVisibility(){const t=this._getOriginRect(),e=this._pane.getBoundingClientRect(),n=this._scrollables.map(t=>t.getElementRef().nativeElement.getBoundingClientRect());return{isOriginClipped:Kv(t,n),isOriginOutsideView:Xv(t,n),isOverlayClipped:Kv(e,n),isOverlayOutsideView:Xv(e,n)}}_subtractOverflows(t,...e){return e.reduce((t,e)=>t-Math.max(e,0),t)}_getNarrowedViewportRect(){const t=this._document.documentElement.clientWidth,e=this._document.documentElement.clientHeight,n=this._viewportRuler.getViewportScrollPosition();return{top:n.top+this._viewportMargin,left:n.left+this._viewportMargin,right:n.left+t-this._viewportMargin,bottom:n.top+e-this._viewportMargin,width:t-2*this._viewportMargin,height:e-2*this._viewportMargin}}_isRtl(){return"rtl"===this._overlayRef.getDirection()}_hasExactPosition(){return!this._hasFlexibleDimensions||this._isPushed}_getOffset(t,e){return"x"===e?null==t.offsetX?this._offsetX:t.offsetX:null==t.offsetY?this._offsetY:t.offsetY}_validatePositions(){if(!this._preferredPositions.length)throw Error("FlexibleConnectedPositionStrategy: At least one position is required.");this._preferredPositions.forEach(t=>{nb("originX",t.originX),eb("originY",t.originY),nb("overlayX",t.overlayX),eb("overlayY",t.overlayY)})}_addPanelClasses(t){this._pane&&sg(t).forEach(t=>{""!==t&&-1===this._appliedPanelClasses.indexOf(t)&&(this._appliedPanelClasses.push(t),this._pane.classList.add(t))})}_clearPanelClasses(){this._pane&&(this._appliedPanelClasses.forEach(t=>{this._pane.classList.remove(t)}),this._appliedPanelClasses=[])}_getOriginRect(){const t=this._origin;if(t instanceof ks)return t.nativeElement.getBoundingClientRect();if(t instanceof Element)return t.getBoundingClientRect();const e=t.width||0,n=t.height||0;return{top:t.y,bottom:t.y+n,left:t.x,right:t.x+e,height:n,width:e}}}function hb(t,e){for(let n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t}function db(t){if("number"!=typeof t&&null!=t){const[e,n]=t.split(lb);return n&&"px"!==n?null:parseFloat(e)}return t||null}class fb{constructor(t,e,n,r,i,o,a){this._preferredPositions=[],this._positionStrategy=new cb(n,r,i,o,a).withFlexibleDimensions(!1).withPush(!1).withViewportMargin(0),this.withFallbackPosition(t,e)}get onPositionChange(){return this._positionStrategy.positionChanges}get positions(){return this._preferredPositions}attach(t){this._overlayRef=t,this._positionStrategy.attach(t),this._direction&&(t.setDirection(this._direction),this._direction=null)}dispose(){this._positionStrategy.dispose()}detach(){this._positionStrategy.detach()}apply(){this._positionStrategy.apply()}recalculateLastPosition(){this._positionStrategy.reapplyLastPosition()}withScrollableContainers(t){this._positionStrategy.withScrollableContainers(t)}withFallbackPosition(t,e,n,r){const i=new Jv(t,e,n,r);return this._preferredPositions.push(i),this._positionStrategy.withPositions(this._preferredPositions),this}withDirection(t){return this._overlayRef?this._overlayRef.setDirection(t):this._direction=t,this}withOffsetX(t){return this._positionStrategy.withDefaultOffsetX(t),this}withOffsetY(t){return this._positionStrategy.withDefaultOffsetY(t),this}withLockedPosition(t){return this._positionStrategy.withLockedPosition(t),this}withPositions(t){return this._preferredPositions=t.slice(),this._positionStrategy.withPositions(this._preferredPositions),this}setOrigin(t){return this._positionStrategy.setOrigin(t),this}}class pb{constructor(){this._cssPosition="static",this._topOffset="",this._bottomOffset="",this._leftOffset="",this._rightOffset="",this._alignItems="",this._justifyContent="",this._width="",this._height=""}attach(t){const e=t.getConfig();this._overlayRef=t,this._width&&!e.width&&t.updateSize({width:this._width}),this._height&&!e.height&&t.updateSize({height:this._height}),t.hostElement.classList.add("cdk-global-overlay-wrapper"),this._isDisposed=!1}top(t=""){return this._bottomOffset="",this._topOffset=t,this._alignItems="flex-start",this}left(t=""){return this._rightOffset="",this._leftOffset=t,this._justifyContent="flex-start",this}bottom(t=""){return this._topOffset="",this._bottomOffset=t,this._alignItems="flex-end",this}right(t=""){return this._leftOffset="",this._rightOffset=t,this._justifyContent="flex-end",this}width(t=""){return this._overlayRef?this._overlayRef.updateSize({width:t}):this._width=t,this}height(t=""){return this._overlayRef?this._overlayRef.updateSize({height:t}):this._height=t,this}centerHorizontally(t=""){return this.left(t),this._justifyContent="center",this}centerVertically(t=""){return this.top(t),this._alignItems="center",this}apply(){if(!this._overlayRef||!this._overlayRef.hasAttached())return;const t=this._overlayRef.overlayElement.style,e=this._overlayRef.hostElement.style,n=this._overlayRef.getConfig(),{width:r,height:i,maxWidth:o,maxHeight:a}=n,s=!("100%"!==r&&"100vw"!==r||o&&"100%"!==o&&"100vw"!==o),u=!("100%"!==i&&"100vh"!==i||a&&"100%"!==a&&"100vh"!==a);t.position=this._cssPosition,t.marginLeft=s?"0":this._leftOffset,t.marginTop=u?"0":this._topOffset,t.marginBottom=this._bottomOffset,t.marginRight=this._rightOffset,s?e.justifyContent="flex-start":"center"===this._justifyContent?e.justifyContent="center":"rtl"===this._overlayRef.getConfig().direction?"flex-start"===this._justifyContent?e.justifyContent="flex-end":"flex-end"===this._justifyContent&&(e.justifyContent="flex-start"):e.justifyContent=this._justifyContent,e.alignItems=u?"flex-start":this._alignItems}dispose(){if(this._isDisposed||!this._overlayRef)return;const t=this._overlayRef.overlayElement.style,e=this._overlayRef.hostElement,n=e.style;e.classList.remove("cdk-global-overlay-wrapper"),n.justifyContent=n.alignItems=t.marginTop=t.marginBottom=t.marginLeft=t.marginRight=t.position="",this._overlayRef=null,this._isDisposed=!0}}let mb=(()=>{class t{constructor(t,e,n,r){this._viewportRuler=t,this._document=e,this._platform=n,this._overlayContainer=r}global(){return new pb}connectedTo(t,e,n){return new fb(e,n,t,this._viewportRuler,this._document,this._platform,this._overlayContainer)}flexibleConnectedTo(t){return new cb(t,this._viewportRuler,this._document,this._platform,this._overlayContainer)}}return t.\u0275fac=function(e){return new(e||t)(Kt(Jg),Kt(zl),Kt(Im),Kt(sb))},t.\u0275prov=ht({factory:function(){return new t(Kt(Jg),Kt(zl),Kt(Im),Kt(sb))},token:t,providedIn:"root"}),t})(),gb=0,yb=(()=>{class t{constructor(t,e,n,r,i,o,a,s,u,l,c){this.scrollStrategies=t,this._overlayContainer=e,this._componentFactoryResolver=n,this._positionBuilder=r,this._keyboardDispatcher=i,this._injector=o,this._ngZone=a,this._document=s,this._directionality=u,this._location=l,this._outsideClickDispatcher=c}create(t){const e=this._createHostElement(),n=this._createPaneElement(e),r=this._createPortalOutlet(n),i=new Qv(t);return i.direction=i.direction||this._directionality.value,new ub(r,e,n,i,this._ngZone,this._keyboardDispatcher,this._document,this._location,this._outsideClickDispatcher)}position(){return this._positionBuilder}_createPaneElement(t){const e=this._document.createElement("div");return e.id="cdk-overlay-"+gb++,e.classList.add("cdk-overlay-pane"),t.appendChild(e),e}_createHostElement(){const t=this._document.createElement("div");return this._overlayContainer.getContainerElement().appendChild(t),t}_createPortalOutlet(t){return this._appRef||(this._appRef=this._injector.get(El)),new Zy(t,this._componentFactoryResolver,this._appRef,this._injector,this._document)}}return t.\u0275fac=function(e){return new(e||t)(Kt(Zv),Kt(sb),Kt(Cs),Kt(mb),Kt(ib),Kt(ca),Kt(sl),Kt(zl),Kt(Kg),Kt(Jl,8),Kt(ob,8))},t.\u0275prov=ht({token:t,factory:t.\u0275fac}),t})();const vb={provide:new Lt("cdk-connected-overlay-scroll-strategy"),deps:[yb],useFactory:function(t){return()=>t.scrollStrategies.reposition()}};let bb=(()=>{class t{}return t.\u0275mod=ve({type:t}),t.\u0275inj=dt({factory:function(e){return new(e||t)},providers:[yb,vb],imports:[[Yg,Jy,ey],ey]}),t})();const wb=["underline"],xb=["connectionContainer"],_b=["inputContainer"],Cb=["label"];function kb(t,e){1&t&&(Da(0),Aa(1,"div",14),Ta(2,"div",15),Ta(3,"div",16),Ta(4,"div",17),Na(),Aa(5,"div",18),Ta(6,"div",15),Ta(7,"div",16),Ta(8,"div",17),Na(),Ra())}function Sb(t,e){1&t&&(Aa(0,"div",19),Wa(1,1),Na())}function Eb(t,e){if(1&t&&(Da(0),Wa(1,2),Aa(2,"span"),es(3),Na(),Ra()),2&t){const t=Ua(2);bi(3),ns(t._control.placeholder)}}function Ob(t,e){1&t&&Wa(0,3,["*ngSwitchCase","true"])}function Ab(t,e){1&t&&(Aa(0,"span",23),es(1," *"),Na())}function Nb(t,e){if(1&t){const t=Ia();Aa(0,"label",20,21),Pa("cdkObserveContent",(function(){return rn(t),Ua().updateOutlineGap()})),_a(2,Eb,4,1,"ng-container",12),_a(3,Ob,1,0,"ng-content",12),_a(4,Ab,2,0,"span",22),Na()}if(2&t){const t=Ua();Ya("mat-empty",t._control.empty&&!t._shouldAlwaysFloat())("mat-form-field-empty",t._control.empty&&!t._shouldAlwaysFloat())("mat-accent","accent"==t.color)("mat-warn","warn"==t.color),Ea("cdkObserveContentDisabled","outline"!=t.appearance)("id",t._labelId)("ngSwitch",t._hasLabel()),wa("for",t._control.id)("aria-owns",t._control.id),bi(2),Ea("ngSwitchCase",!1),bi(1),Ea("ngSwitchCase",!0),bi(1),Ea("ngIf",!t.hideRequiredMarker&&t._control.required&&!t._control.disabled)}}function Tb(t,e){1&t&&(Aa(0,"div",24),Wa(1,4),Na())}function Db(t,e){if(1&t&&(Aa(0,"div",25,26),Ta(2,"span",27),Na()),2&t){const t=Ua();bi(2),Ya("mat-accent","accent"==t.color)("mat-warn","warn"==t.color)}}function Rb(t,e){1&t&&(Aa(0,"div"),Wa(1,5),Na()),2&t&&Ea("@transitionMessages",Ua()._subscriptAnimationState)}function Ib(t,e){if(1&t&&(Aa(0,"div",31),es(1),Na()),2&t){const t=Ua(2);Ea("id",t._hintLabelId),bi(1),ns(t.hintLabel)}}function Mb(t,e){if(1&t&&(Aa(0,"div",28),_a(1,Ib,2,2,"div",29),Wa(2,6),Ta(3,"div",30),Wa(4,7),Na()),2&t){const t=Ua();Ea("@transitionMessages",t._subscriptAnimationState),bi(1),Ea("ngIf",t.hintLabel)}}const Fb=["*",[["","matPrefix",""]],[["mat-placeholder"]],[["mat-label"]],[["","matSuffix",""]],[["mat-error"]],[["mat-hint",3,"align","end"]],[["mat-hint","align","end"]]],Pb=["*","[matPrefix]","mat-placeholder","mat-label","[matSuffix]","mat-error","mat-hint:not([align='end'])","mat-hint[align='end']"],jb=new Lt("MatError"),zb={transitionMessages:nh("transitionMessages",[ah("enter",oh({opacity:1,transform:"translateY(0%)"})),sh("void => enter",[oh({opacity:0,transform:"translateY(-100%)"}),rh("300ms cubic-bezier(0.55, 0, 0.55, 0.2)")])])};let Lb=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275dir=we({type:t}),t})();function Bb(t){return Error(`A hint was already declared for 'align="${t}"'.`)}const Ub=new Lt("MatHint");let $b=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275dir=we({type:t,selectors:[["mat-label"]]}),t})(),Vb=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275dir=we({type:t,selectors:[["mat-placeholder"]]}),t})();const Wb=new Lt("MatPrefix"),qb=new Lt("MatSuffix");let Hb=0;class Gb{constructor(t){this._elementRef=t}}const Xb=cv(Gb,"primary"),Kb=new Lt("MAT_FORM_FIELD_DEFAULT_OPTIONS"),Yb=new Lt("MatFormField");let Zb=(()=>{class t extends Xb{constructor(t,e,n,r,i,o,a,s){super(t),this._elementRef=t,this._changeDetectorRef=e,this._dir=r,this._defaults=i,this._platform=o,this._ngZone=a,this._outlineGapCalculationNeededImmediately=!1,this._outlineGapCalculationNeededOnStable=!1,this._destroyed=new C,this._showAlwaysAnimate=!1,this._subscriptAnimationState="",this._hintLabel="",this._hintLabelId="mat-hint-"+Hb++,this._labelId="mat-form-field-label-"+Hb++,this._labelOptions=n||{},this.floatLabel=this._getDefaultFloatLabelState(),this._animationsEnabled="NoopAnimations"!==s,this.appearance=i&&i.appearance?i.appearance:"legacy",this._hideRequiredMarker=!(!i||null==i.hideRequiredMarker)&&i.hideRequiredMarker}get appearance(){return this._appearance}set appearance(t){const e=this._appearance;this._appearance=t||this._defaults&&this._defaults.appearance||"legacy","outline"===this._appearance&&e!==t&&(this._outlineGapCalculationNeededOnStable=!0)}get hideRequiredMarker(){return this._hideRequiredMarker}set hideRequiredMarker(t){this._hideRequiredMarker=og(t)}_shouldAlwaysFloat(){return"always"===this.floatLabel&&!this._showAlwaysAnimate}_canLabelFloat(){return"never"!==this.floatLabel}get hintLabel(){return this._hintLabel}set hintLabel(t){this._hintLabel=t,this._processHints()}get floatLabel(){return"legacy"!==this.appearance&&"never"===this._floatLabel?"auto":this._floatLabel}set floatLabel(t){t!==this._floatLabel&&(this._floatLabel=t||this._getDefaultFloatLabelState(),this._changeDetectorRef.markForCheck())}get _control(){return this._explicitFormFieldControl||this._controlNonStatic||this._controlStatic}set _control(t){this._explicitFormFieldControl=t}getConnectedOverlayOrigin(){return this._connectionContainerRef||this._elementRef}ngAfterContentInit(){this._validateControlChild();const t=this._control;t.controlType&&this._elementRef.nativeElement.classList.add("mat-form-field-type-"+t.controlType),t.stateChanges.pipe(Ug(null)).subscribe(()=>{this._validatePlaceholders(),this._syncDescribedByIds(),this._changeDetectorRef.markForCheck()}),t.ngControl&&t.ngControl.valueChanges&&t.ngControl.valueChanges.pipe(Pg(this._destroyed)).subscribe(()=>this._changeDetectorRef.markForCheck()),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.asObservable().pipe(Pg(this._destroyed)).subscribe(()=>{this._outlineGapCalculationNeededOnStable&&this.updateOutlineGap()})}),q(this._prefixChildren.changes,this._suffixChildren.changes).subscribe(()=>{this._outlineGapCalculationNeededOnStable=!0,this._changeDetectorRef.markForCheck()}),this._hintChildren.changes.pipe(Ug(null)).subscribe(()=>{this._processHints(),this._changeDetectorRef.markForCheck()}),this._errorChildren.changes.pipe(Ug(null)).subscribe(()=>{this._syncDescribedByIds(),this._changeDetectorRef.markForCheck()}),this._dir&&this._dir.change.pipe(Pg(this._destroyed)).subscribe(()=>{"function"==typeof requestAnimationFrame?this._ngZone.runOutsideAngular(()=>{requestAnimationFrame(()=>this.updateOutlineGap())}):this.updateOutlineGap()})}ngAfterContentChecked(){this._validateControlChild(),this._outlineGapCalculationNeededImmediately&&this.updateOutlineGap()}ngAfterViewInit(){this._subscriptAnimationState="enter",this._changeDetectorRef.detectChanges()}ngOnDestroy(){this._destroyed.next(),this._destroyed.complete()}_shouldForward(t){const e=this._control?this._control.ngControl:null;return e&&e[t]}_hasPlaceholder(){return!!(this._control&&this._control.placeholder||this._placeholderChild)}_hasLabel(){return!(!this._labelChildNonStatic&&!this._labelChildStatic)}_shouldLabelFloat(){return this._canLabelFloat()&&(this._control&&this._control.shouldLabelFloat||this._shouldAlwaysFloat())}_hideControlPlaceholder(){return"legacy"===this.appearance&&!this._hasLabel()||this._hasLabel()&&!this._shouldLabelFloat()}_hasFloatingLabel(){return this._hasLabel()||"legacy"===this.appearance&&this._hasPlaceholder()}_getDisplayedMessages(){return this._errorChildren&&this._errorChildren.length>0&&this._control.errorState?"error":"hint"}_animateAndLockLabel(){this._hasFloatingLabel()&&this._canLabelFloat()&&(this._animationsEnabled&&this._label&&(this._showAlwaysAnimate=!0,Og(this._label.nativeElement,"transitionend").pipe(ng(1)).subscribe(()=>{this._showAlwaysAnimate=!1})),this.floatLabel="always",this._changeDetectorRef.markForCheck())}_validatePlaceholders(){if(this._control.placeholder&&this._placeholderChild)throw Error("Placeholder attribute and child element were both specified.")}_processHints(){this._validateHints(),this._syncDescribedByIds()}_validateHints(){if(this._hintChildren){let t,e;this._hintChildren.forEach(n=>{if("start"===n.align){if(t||this.hintLabel)throw Bb("start");t=n}else if("end"===n.align){if(e)throw Bb("end");e=n}})}}_getDefaultFloatLabelState(){return this._defaults&&this._defaults.floatLabel||this._labelOptions.float||"auto"}_syncDescribedByIds(){if(this._control){let t=[];if("hint"===this._getDisplayedMessages()){const e=this._hintChildren?this._hintChildren.find(t=>"start"===t.align):null,n=this._hintChildren?this._hintChildren.find(t=>"end"===t.align):null;e?t.push(e.id):this._hintLabel&&t.push(this._hintLabelId),n&&t.push(n.id)}else this._errorChildren&&(t=this._errorChildren.map(t=>t.id));this._control.setDescribedByIds(t)}}_validateControlChild(){if(!this._control)throw Error("mat-form-field must contain a MatFormFieldControl.")}updateOutlineGap(){const t=this._label?this._label.nativeElement:null;if("outline"!==this.appearance||!t||!t.children.length||!t.textContent.trim())return;if(!this._platform.isBrowser)return;if(!this._isAttachedToDOM())return void(this._outlineGapCalculationNeededImmediately=!0);let e=0,n=0;const r=this._connectionContainerRef.nativeElement,i=r.querySelectorAll(".mat-form-field-outline-start"),o=r.querySelectorAll(".mat-form-field-outline-gap");if(this._label&&this._label.nativeElement.children.length){const i=r.getBoundingClientRect();if(0===i.width&&0===i.height)return this._outlineGapCalculationNeededOnStable=!0,void(this._outlineGapCalculationNeededImmediately=!1);const o=this._getStartEnd(i),a=t.children,s=this._getStartEnd(a[0].getBoundingClientRect());let u=0;for(let t=0;t<a.length;t++)u+=a[t].offsetWidth;e=Math.abs(s-o)-5,n=u>0?.75*u+10:0}for(let a=0;a<i.length;a++)i[a].style.width=e+"px";for(let a=0;a<o.length;a++)o[a].style.width=n+"px";this._outlineGapCalculationNeededOnStable=this._outlineGapCalculationNeededImmediately=!1}_getStartEnd(t){return this._dir&&"rtl"===this._dir.value?t.right:t.left}_isAttachedToDOM(){const t=this._elementRef.nativeElement;if(t.getRootNode){const e=t.getRootNode();return e&&e!==t}return document.documentElement.contains(t)}}return t.\u0275fac=function(e){return new(e||t)(ka(ks),ka(Go),ka($v,8),ka(Kg,8),ka(Kb,8),ka(Im),ka(sl),ka(wf,8))},t.\u0275cmp=pe({type:t,selectors:[["mat-form-field"]],contentQueries:function(t,e,n){var r;1&t&&(Iu(n,Lb,!0),Mu(n,Lb,!0),Iu(n,$b,!0),Mu(n,$b,!0),Iu(n,Vb,!0),Iu(n,jb,!0),Iu(n,Ub,!0),Iu(n,Wb,!0),Iu(n,qb,!0)),2&t&&(Nu(r=Pu())&&(e._controlNonStatic=r.first),Nu(r=Pu())&&(e._controlStatic=r.first),Nu(r=Pu())&&(e._labelChildNonStatic=r.first),Nu(r=Pu())&&(e._labelChildStatic=r.first),Nu(r=Pu())&&(e._placeholderChild=r.first),Nu(r=Pu())&&(e._errorChildren=r),Nu(r=Pu())&&(e._hintChildren=r),Nu(r=Pu())&&(e._prefixChildren=r),Nu(r=Pu())&&(e._suffixChildren=r))},viewQuery:function(t,e){var n;1&t&&(Du(wb,!0),Tu(xb,!0),Du(_b,!0),Du(Cb,!0)),2&t&&(Nu(n=Pu())&&(e.underlineRef=n.first),Nu(n=Pu())&&(e._connectionContainerRef=n.first),Nu(n=Pu())&&(e._inputContainerRef=n.first),Nu(n=Pu())&&(e._label=n.first))},hostAttrs:[1,"mat-form-field"],hostVars:44,hostBindings:function(t,e){2&t&&Ya("mat-form-field-appearance-standard","standard"==e.appearance)("mat-form-field-appearance-fill","fill"==e.appearance)("mat-form-field-appearance-outline","outline"==e.appearance)("mat-form-field-appearance-legacy","legacy"==e.appearance)("mat-form-field-invalid",e._control.errorState)("mat-form-field-can-float",e._canLabelFloat())("mat-form-field-should-float",e._shouldLabelFloat())("mat-form-field-has-label",e._hasFloatingLabel())("mat-form-field-hide-placeholder",e._hideControlPlaceholder())("mat-form-field-disabled",e._control.disabled)("mat-form-field-autofilled",e._control.autofilled)("mat-focused",e._control.focused)("mat-accent","accent"==e.color)("mat-warn","warn"==e.color)("ng-untouched",e._shouldForward("untouched"))("ng-touched",e._shouldForward("touched"))("ng-pristine",e._shouldForward("pristine"))("ng-dirty",e._shouldForward("dirty"))("ng-valid",e._shouldForward("valid"))("ng-invalid",e._shouldForward("invalid"))("ng-pending",e._shouldForward("pending"))("_mat-animation-noopable",!e._animationsEnabled)},inputs:{color:"color",floatLabel:"floatLabel",appearance:"appearance",hideRequiredMarker:"hideRequiredMarker",hintLabel:"hintLabel"},exportAs:["matFormField"],features:[ws([{provide:Yb,useExisting:t}]),us],ngContentSelectors:Pb,decls:15,vars:8,consts:[[1,"mat-form-field-wrapper"],[1,"mat-form-field-flex",3,"click"],["connectionContainer",""],[4,"ngIf"],["class","mat-form-field-prefix",4,"ngIf"],[1,"mat-form-field-infix"],["inputContainer",""],[1,"mat-form-field-label-wrapper"],["class","mat-form-field-label",3,"cdkObserveContentDisabled","id","mat-empty","mat-form-field-empty","mat-accent","mat-warn","ngSwitch","cdkObserveContent",4,"ngIf"],["class","mat-form-field-suffix",4,"ngIf"],["class","mat-form-field-underline",4,"ngIf"],[1,"mat-form-field-subscript-wrapper",3,"ngSwitch"],[4,"ngSwitchCase"],["class","mat-form-field-hint-wrapper",4,"ngSwitchCase"],[1,"mat-form-field-outline"],[1,"mat-form-field-outline-start"],[1,"mat-form-field-outline-gap"],[1,"mat-form-field-outline-end"],[1,"mat-form-field-outline","mat-form-field-outline-thick"],[1,"mat-form-field-prefix"],[1,"mat-form-field-label",3,"cdkObserveContentDisabled","id","ngSwitch","cdkObserveContent"],["label",""],["class","mat-placeholder-required mat-form-field-required-marker","aria-hidden","true",4,"ngIf"],["aria-hidden","true",1,"mat-placeholder-required","mat-form-field-required-marker"],[1,"mat-form-field-suffix"],[1,"mat-form-field-underline"],["underline",""],[1,"mat-form-field-ripple"],[1,"mat-form-field-hint-wrapper"],["class","mat-hint",3,"id",4,"ngIf"],[1,"mat-form-field-hint-spacer"],[1,"mat-hint",3,"id"]],template:function(t,e){1&t&&(Va(Fb),Aa(0,"div",0),Aa(1,"div",1,2),Pa("click",(function(t){return e._control.onContainerClick&&e._control.onContainerClick(t)})),_a(3,kb,9,0,"ng-container",3),_a(4,Sb,2,0,"div",4),Aa(5,"div",5,6),Wa(7),Aa(8,"span",7),_a(9,Nb,5,16,"label",8),Na(),Na(),_a(10,Tb,2,0,"div",9),Na(),_a(11,Db,3,4,"div",10),Aa(12,"div",11),_a(13,Rb,2,1,"div",12),_a(14,Mb,5,2,"div",13),Na(),Na()),2&t&&(bi(3),Ea("ngIf","outline"==e.appearance),bi(1),Ea("ngIf",e._prefixChildren.length),bi(5),Ea("ngIf",e._hasFloatingLabel()),bi(1),Ea("ngIf",e._suffixChildren.length),bi(1),Ea("ngIf","outline"!=e.appearance),bi(1),Ea("ngSwitch",e._getDisplayedMessages()),bi(1),Ea("ngSwitchCase","error"),bi(1),Ea("ngSwitchCase","hint"))},directives:[pc,vc,bc,dg],styles:[".mat-form-field{display:inline-block;position:relative;text-align:left}[dir=rtl] .mat-form-field{text-align:right}.mat-form-field-wrapper{position:relative}.mat-form-field-flex{display:inline-flex;align-items:baseline;box-sizing:border-box;width:100%}.mat-form-field-prefix,.mat-form-field-suffix{white-space:nowrap;flex:none;position:relative}.mat-form-field-infix{display:block;position:relative;flex:auto;min-width:0;width:180px}.cdk-high-contrast-active .mat-form-field-infix{border-image:linear-gradient(transparent, transparent)}.mat-form-field-label-wrapper{position:absolute;left:0;box-sizing:content-box;width:100%;height:100%;overflow:hidden;pointer-events:none}[dir=rtl] .mat-form-field-label-wrapper{left:auto;right:0}.mat-form-field-label{position:absolute;left:0;font:inherit;pointer-events:none;width:100%;white-space:nowrap;text-overflow:ellipsis;overflow:hidden;transform-origin:0 0;transition:transform 400ms cubic-bezier(0.25, 0.8, 0.25, 1),color 400ms cubic-bezier(0.25, 0.8, 0.25, 1),width 400ms cubic-bezier(0.25, 0.8, 0.25, 1);display:none}[dir=rtl] .mat-form-field-label{transform-origin:100% 0;left:auto;right:0}.mat-form-field-empty.mat-form-field-label,.mat-form-field-can-float.mat-form-field-should-float .mat-form-field-label{display:block}.mat-form-field-autofill-control:-webkit-autofill+.mat-form-field-label-wrapper .mat-form-field-label{display:none}.mat-form-field-can-float .mat-form-field-autofill-control:-webkit-autofill+.mat-form-field-label-wrapper .mat-form-field-label{display:block;transition:none}.mat-input-server:focus+.mat-form-field-label-wrapper .mat-form-field-label,.mat-input-server[placeholder]:not(:placeholder-shown)+.mat-form-field-label-wrapper .mat-form-field-label{display:none}.mat-form-field-can-float .mat-input-server:focus+.mat-form-field-label-wrapper .mat-form-field-label,.mat-form-field-can-float .mat-input-server[placeholder]:not(:placeholder-shown)+.mat-form-field-label-wrapper .mat-form-field-label{display:block}.mat-form-field-label:not(.mat-form-field-empty){transition:none}.mat-form-field-underline{position:absolute;width:100%;pointer-events:none;transform:scale3d(1, 1.0001, 1)}.mat-form-field-ripple{position:absolute;left:0;width:100%;transform-origin:50%;transform:scaleX(0.5);opacity:0;transition:background-color 300ms cubic-bezier(0.55, 0, 0.55, 0.2)}.mat-form-field.mat-focused .mat-form-field-ripple,.mat-form-field.mat-form-field-invalid .mat-form-field-ripple{opacity:1;transform:scaleX(1);transition:transform 300ms cubic-bezier(0.25, 0.8, 0.25, 1),opacity 100ms cubic-bezier(0.25, 0.8, 0.25, 1),background-color 300ms cubic-bezier(0.25, 0.8, 0.25, 1)}.mat-form-field-subscript-wrapper{position:absolute;box-sizing:border-box;width:100%;overflow:hidden}.mat-form-field-subscript-wrapper .mat-icon,.mat-form-field-label-wrapper .mat-icon{width:1em;height:1em;font-size:inherit;vertical-align:baseline}.mat-form-field-hint-wrapper{display:flex}.mat-form-field-hint-spacer{flex:1 0 1em}.mat-error{display:block}.mat-form-field-control-wrapper{position:relative}.mat-form-field._mat-animation-noopable .mat-form-field-label,.mat-form-field._mat-animation-noopable .mat-form-field-ripple{transition:none}\n",'.mat-form-field-appearance-fill .mat-form-field-flex{border-radius:4px 4px 0 0;padding:.75em .75em 0 .75em}.cdk-high-contrast-active .mat-form-field-appearance-fill .mat-form-field-flex{outline:solid 1px}.mat-form-field-appearance-fill .mat-form-field-underline::before{content:"";display:block;position:absolute;bottom:0;height:1px;width:100%}.mat-form-field-appearance-fill .mat-form-field-ripple{bottom:0;height:2px}.cdk-high-contrast-active .mat-form-field-appearance-fill .mat-form-field-ripple{height:0;border-top:solid 2px}.mat-form-field-appearance-fill:not(.mat-form-field-disabled) .mat-form-field-flex:hover~.mat-form-field-underline .mat-form-field-ripple{opacity:1;transform:none;transition:opacity 600ms cubic-bezier(0.25, 0.8, 0.25, 1)}.mat-form-field-appearance-fill._mat-animation-noopable:not(.mat-form-field-disabled) .mat-form-field-flex:hover~.mat-form-field-underline .mat-form-field-ripple{transition:none}.mat-form-field-appearance-fill .mat-form-field-subscript-wrapper{padding:0 1em}\n','.mat-input-element{font:inherit;background:transparent;color:currentColor;border:none;outline:none;padding:0;margin:0;width:100%;max-width:100%;vertical-align:bottom;text-align:inherit}.mat-input-element:-moz-ui-invalid{box-shadow:none}.mat-input-element::-ms-clear,.mat-input-element::-ms-reveal{display:none}.mat-input-element,.mat-input-element::-webkit-search-cancel-button,.mat-input-element::-webkit-search-decoration,.mat-input-element::-webkit-search-results-button,.mat-input-element::-webkit-search-results-decoration{-webkit-appearance:none}.mat-input-element::-webkit-contacts-auto-fill-button,.mat-input-element::-webkit-caps-lock-indicator,.mat-input-element::-webkit-credentials-auto-fill-button{visibility:hidden}.mat-input-element[type=date],.mat-input-element[type=datetime],.mat-input-element[type=datetime-local],.mat-input-element[type=month],.mat-input-element[type=week],.mat-input-element[type=time]{line-height:1}.mat-input-element[type=date]::after,.mat-input-element[type=datetime]::after,.mat-input-element[type=datetime-local]::after,.mat-input-element[type=month]::after,.mat-input-element[type=week]::after,.mat-input-element[type=time]::after{content:" ";white-space:pre;width:1px}.mat-input-element::-webkit-inner-spin-button,.mat-input-element::-webkit-calendar-picker-indicator,.mat-input-element::-webkit-clear-button{font-size:.75em}.mat-input-element::placeholder{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;transition:color 400ms 133.3333333333ms cubic-bezier(0.25, 0.8, 0.25, 1)}.mat-input-element::placeholder:-ms-input-placeholder{-ms-user-select:text}.mat-input-element::-moz-placeholder{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;transition:color 400ms 133.3333333333ms cubic-bezier(0.25, 0.8, 0.25, 1)}.mat-input-element::-moz-placeholder:-ms-input-placeholder{-ms-user-select:text}.mat-input-element::-webkit-input-placeholder{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;transition:color 400ms 133.3333333333ms cubic-bezier(0.25, 0.8, 0.25, 1)}.mat-input-element::-webkit-input-placeholder:-ms-input-placeholder{-ms-user-select:text}.mat-input-element:-ms-input-placeholder{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;transition:color 400ms 133.3333333333ms cubic-bezier(0.25, 0.8, 0.25, 1)}.mat-input-element:-ms-input-placeholder:-ms-input-placeholder{-ms-user-select:text}.mat-form-field-hide-placeholder .mat-input-element::placeholder{color:transparent !important;-webkit-text-fill-color:transparent;transition:none}.mat-form-field-hide-placeholder .mat-input-element::-moz-placeholder{color:transparent !important;-webkit-text-fill-color:transparent;transition:none}.mat-form-field-hide-placeholder .mat-input-element::-webkit-input-placeholder{color:transparent !important;-webkit-text-fill-color:transparent;transition:none}.mat-form-field-hide-placeholder .mat-input-element:-ms-input-placeholder{color:transparent !important;-webkit-text-fill-color:transparent;transition:none}textarea.mat-input-element{resize:vertical;overflow:auto}textarea.mat-input-element.cdk-textarea-autosize{resize:none}textarea.mat-input-element{padding:2px 0;margin:-2px 0}select.mat-input-element{-moz-appearance:none;-webkit-appearance:none;position:relative;background-color:transparent;display:inline-flex;box-sizing:border-box;padding-top:1em;top:-1em;margin-bottom:-1em}select.mat-input-element::-ms-expand{display:none}select.mat-input-element::-moz-focus-inner{border:0}select.mat-input-element:not(:disabled){cursor:pointer}select.mat-input-element::-ms-value{color:inherit;background:none}.mat-focused .cdk-high-contrast-active select.mat-input-element::-ms-value{color:inherit}.mat-form-field-type-mat-native-select .mat-form-field-infix::after{content:"";width:0;height:0;border-left:5px solid transparent;border-right:5px solid transparent;border-top:5px solid;position:absolute;top:50%;right:0;margin-top:-2.5px;pointer-events:none}[dir=rtl] .mat-form-field-type-mat-native-select .mat-form-field-infix::after{right:auto;left:0}.mat-form-field-type-mat-native-select .mat-input-element{padding-right:15px}[dir=rtl] .mat-form-field-type-mat-native-select .mat-input-element{padding-right:0;padding-left:15px}.mat-form-field-type-mat-native-select .mat-form-field-label-wrapper{max-width:calc(100% - 10px)}.mat-form-field-type-mat-native-select.mat-form-field-appearance-outline .mat-form-field-infix::after{margin-top:-5px}.mat-form-field-type-mat-native-select.mat-form-field-appearance-fill .mat-form-field-infix::after{margin-top:-10px}\n',".mat-form-field-appearance-legacy .mat-form-field-label{transform:perspective(100px);-ms-transform:none}.mat-form-field-appearance-legacy .mat-form-field-prefix .mat-icon,.mat-form-field-appearance-legacy .mat-form-field-suffix .mat-icon{width:1em}.mat-form-field-appearance-legacy .mat-form-field-prefix .mat-icon-button,.mat-form-field-appearance-legacy .mat-form-field-suffix .mat-icon-button{font:inherit;vertical-align:baseline}.mat-form-field-appearance-legacy .mat-form-field-prefix .mat-icon-button .mat-icon,.mat-form-field-appearance-legacy .mat-form-field-suffix .mat-icon-button .mat-icon{font-size:inherit}.mat-form-field-appearance-legacy .mat-form-field-underline{height:1px}.cdk-high-contrast-active .mat-form-field-appearance-legacy .mat-form-field-underline{height:0;border-top:solid 1px}.mat-form-field-appearance-legacy .mat-form-field-ripple{top:0;height:2px;overflow:hidden}.cdk-high-contrast-active .mat-form-field-appearance-legacy .mat-form-field-ripple{height:0;border-top:solid 2px}.mat-form-field-appearance-legacy.mat-form-field-disabled .mat-form-field-underline{background-position:0;background-color:transparent}.cdk-high-contrast-active .mat-form-field-appearance-legacy.mat-form-field-disabled .mat-form-field-underline{border-top-style:dotted;border-top-width:2px}.mat-form-field-appearance-legacy.mat-form-field-invalid:not(.mat-focused) .mat-form-field-ripple{height:1px}\n",".mat-form-field-appearance-outline .mat-form-field-wrapper{margin:.25em 0}.mat-form-field-appearance-outline .mat-form-field-flex{padding:0 .75em 0 .75em;margin-top:-0.25em;position:relative}.mat-form-field-appearance-outline .mat-form-field-prefix,.mat-form-field-appearance-outline .mat-form-field-suffix{top:.25em}.mat-form-field-appearance-outline .mat-form-field-outline{display:flex;position:absolute;top:.25em;left:0;right:0;bottom:0;pointer-events:none}.mat-form-field-appearance-outline .mat-form-field-outline-start,.mat-form-field-appearance-outline .mat-form-field-outline-end{border:1px solid currentColor;min-width:5px}.mat-form-field-appearance-outline .mat-form-field-outline-start{border-radius:5px 0 0 5px;border-right-style:none}[dir=rtl] .mat-form-field-appearance-outline .mat-form-field-outline-start{border-right-style:solid;border-left-style:none;border-radius:0 5px 5px 0}.mat-form-field-appearance-outline .mat-form-field-outline-end{border-radius:0 5px 5px 0;border-left-style:none;flex-grow:1}[dir=rtl] .mat-form-field-appearance-outline .mat-form-field-outline-end{border-left-style:solid;border-right-style:none;border-radius:5px 0 0 5px}.mat-form-field-appearance-outline .mat-form-field-outline-gap{border-radius:.000001px;border:1px solid currentColor;border-left-style:none;border-right-style:none}.mat-form-field-appearance-outline.mat-form-field-can-float.mat-form-field-should-float .mat-form-field-outline-gap{border-top-color:transparent}.mat-form-field-appearance-outline .mat-form-field-outline-thick{opacity:0}.mat-form-field-appearance-outline .mat-form-field-outline-thick .mat-form-field-outline-start,.mat-form-field-appearance-outline .mat-form-field-outline-thick .mat-form-field-outline-end,.mat-form-field-appearance-outline .mat-form-field-outline-thick .mat-form-field-outline-gap{border-width:2px}.mat-form-field-appearance-outline.mat-focused .mat-form-field-outline,.mat-form-field-appearance-outline.mat-form-field-invalid .mat-form-field-outline{opacity:0;transition:opacity 100ms cubic-bezier(0.25, 0.8, 0.25, 1)}.mat-form-field-appearance-outline.mat-focused .mat-form-field-outline-thick,.mat-form-field-appearance-outline.mat-form-field-invalid .mat-form-field-outline-thick{opacity:1}.mat-form-field-appearance-outline:not(.mat-form-field-disabled) .mat-form-field-flex:hover .mat-form-field-outline{opacity:0;transition:opacity 600ms cubic-bezier(0.25, 0.8, 0.25, 1)}.mat-form-field-appearance-outline:not(.mat-form-field-disabled) .mat-form-field-flex:hover .mat-form-field-outline-thick{opacity:1}.mat-form-field-appearance-outline .mat-form-field-subscript-wrapper{padding:0 1em}.mat-form-field-appearance-outline._mat-animation-noopable:not(.mat-form-field-disabled) .mat-form-field-flex:hover~.mat-form-field-outline,.mat-form-field-appearance-outline._mat-animation-noopable .mat-form-field-outline,.mat-form-field-appearance-outline._mat-animation-noopable .mat-form-field-outline-start,.mat-form-field-appearance-outline._mat-animation-noopable .mat-form-field-outline-end,.mat-form-field-appearance-outline._mat-animation-noopable .mat-form-field-outline-gap{transition:none}\n",".mat-form-field-appearance-standard .mat-form-field-flex{padding-top:.75em}.mat-form-field-appearance-standard .mat-form-field-underline{height:1px}.cdk-high-contrast-active .mat-form-field-appearance-standard .mat-form-field-underline{height:0;border-top:solid 1px}.mat-form-field-appearance-standard .mat-form-field-ripple{bottom:0;height:2px}.cdk-high-contrast-active .mat-form-field-appearance-standard .mat-form-field-ripple{height:0;border-top:2px}.mat-form-field-appearance-standard.mat-form-field-disabled .mat-form-field-underline{background-position:0;background-color:transparent}.cdk-high-contrast-active .mat-form-field-appearance-standard.mat-form-field-disabled .mat-form-field-underline{border-top-style:dotted;border-top-width:2px}.mat-form-field-appearance-standard:not(.mat-form-field-disabled) .mat-form-field-flex:hover~.mat-form-field-underline .mat-form-field-ripple{opacity:1;transform:none;transition:opacity 600ms cubic-bezier(0.25, 0.8, 0.25, 1)}.mat-form-field-appearance-standard._mat-animation-noopable:not(.mat-form-field-disabled) .mat-form-field-flex:hover~.mat-form-field-underline .mat-form-field-ripple{transition:none}\n"],encapsulation:2,data:{animation:[zb.transitionMessages]},changeDetection:0}),t})(),Qb=(()=>{class t{}return t.\u0275mod=ve({type:t}),t.\u0275inj=dt({factory:function(e){return new(e||t)},imports:[[xc,uv,fg],uv]}),t})();class Jb{constructor(t,e){this.delay=t,this.scheduler=e}call(t,e){return e.subscribe(new tw(t,this.delay,this.scheduler))}}class tw extends p{constructor(t,e,n){super(t),this.delay=e,this.scheduler=n,this.queue=[],this.active=!1,this.errored=!1}static dispatch(t){const e=t.source,n=e.queue,r=t.scheduler,i=t.destination;for(;n.length>0&&n[0].time-r.now()<=0;)n.shift().notification.observe(i);if(n.length>0){const e=Math.max(0,n[0].time-r.now());this.schedule(t,e)}else this.unsubscribe(),e.active=!1}_schedule(t){this.active=!0,this.destination.add(t.schedule(tw.dispatch,this.delay,{source:this,destination:this.destination,scheduler:t}))}scheduleNotification(t){if(!0===this.errored)return;const e=this.scheduler,n=new ew(e.now()+this.delay,t);this.queue.push(n),!1===this.active&&this._schedule(e)}_next(t){this.scheduleNotification(Gg.createNext(t))}_error(t){this.errored=!0,this.queue=[],this.destination.error(t),this.unsubscribe()}_complete(){this.scheduleNotification(Gg.createComplete()),this.unsubscribe()}}class ew{constructor(t,e){this.time=t,this.notification=e}}const nw={provide:new Lt("mat-autocomplete-scroll-strategy"),deps:[yb],useFactory:function(t){return()=>t.scrollStrategies.reposition()}};let rw=(()=>{class t{}return t.\u0275mod=ve({type:t}),t.\u0275inj=dt({factory:function(e){return new(e||t)},providers:[nw],imports:[[Uv,bb,uv,xc],ty,Uv,uv]}),t})(),iw=(()=>{class t{}return t.\u0275mod=ve({type:t}),t.\u0275inj=dt({factory:function(e){return new(e||t)},imports:[[Sg,uv],uv]}),t})();const ow={};class aw{constructor(t){this.resultSelector=t}call(t,e){return e.subscribe(new sw(t,this.resultSelector))}}class sw extends M{constructor(t,e){super(t),this.resultSelector=e,this.active=0,this.values=[],this.observables=[]}_next(t){this.values.push(ow),this.observables.push(t)}_complete(){const t=this.observables,e=t.length;if(0===e)this.destination.complete();else{this.active=e,this.toRespond=e;for(let n=0;n<e;n++){const e=t[n];this.add(I(this,e,e,n))}}}notifyComplete(t){0==(this.active-=1)&&this.destination.complete()}notifyNext(t,e,n,r,i){const o=this.values,a=this.toRespond?o[n]===ow?--this.toRespond:this.toRespond:0;o[n]=e,0===a&&(this.resultSelector?this._tryResultSelector(o):this.destination.next(o.slice()))}_tryResultSelector(t){let e;try{e=this.resultSelector.apply(this,t)}catch(n){return void this.destination.error(n)}this.destination.next(e)}}let uw=(()=>{class t{}return t.\u0275mod=ve({type:t}),t.\u0275inj=dt({factory:function(e){return new(e||t)},imports:[[bb,uv,Jy],uv]}),t})();const lw=["mat-button",""],cw=["*"],hw=".mat-button .mat-button-focus-overlay,.mat-icon-button .mat-button-focus-overlay{opacity:0}.mat-button:hover:not(.mat-button-disabled) .mat-button-focus-overlay,.mat-stroked-button:hover:not(.mat-button-disabled) .mat-button-focus-overlay{opacity:.04}@media(hover: none){.mat-button:hover:not(.mat-button-disabled) .mat-button-focus-overlay,.mat-stroked-button:hover:not(.mat-button-disabled) .mat-button-focus-overlay{opacity:0}}.mat-button,.mat-icon-button,.mat-stroked-button,.mat-flat-button{box-sizing:border-box;position:relative;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;cursor:pointer;outline:none;border:none;-webkit-tap-highlight-color:transparent;display:inline-block;white-space:nowrap;text-decoration:none;vertical-align:baseline;text-align:center;margin:0;min-width:64px;line-height:36px;padding:0 16px;border-radius:4px;overflow:visible}.mat-button::-moz-focus-inner,.mat-icon-button::-moz-focus-inner,.mat-stroked-button::-moz-focus-inner,.mat-flat-button::-moz-focus-inner{border:0}.mat-button.mat-button-disabled,.mat-icon-button.mat-button-disabled,.mat-stroked-button.mat-button-disabled,.mat-flat-button.mat-button-disabled{cursor:default}.mat-button.cdk-keyboard-focused .mat-button-focus-overlay,.mat-button.cdk-program-focused .mat-button-focus-overlay,.mat-icon-button.cdk-keyboard-focused .mat-button-focus-overlay,.mat-icon-button.cdk-program-focused .mat-button-focus-overlay,.mat-stroked-button.cdk-keyboard-focused .mat-button-focus-overlay,.mat-stroked-button.cdk-program-focused .mat-button-focus-overlay,.mat-flat-button.cdk-keyboard-focused .mat-button-focus-overlay,.mat-flat-button.cdk-program-focused .mat-button-focus-overlay{opacity:.12}.mat-button::-moz-focus-inner,.mat-icon-button::-moz-focus-inner,.mat-stroked-button::-moz-focus-inner,.mat-flat-button::-moz-focus-inner{border:0}.mat-raised-button{box-sizing:border-box;position:relative;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;cursor:pointer;outline:none;border:none;-webkit-tap-highlight-color:transparent;display:inline-block;white-space:nowrap;text-decoration:none;vertical-align:baseline;text-align:center;margin:0;min-width:64px;line-height:36px;padding:0 16px;border-radius:4px;overflow:visible;transform:translate3d(0, 0, 0);transition:background 400ms cubic-bezier(0.25, 0.8, 0.25, 1),box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1)}.mat-raised-button::-moz-focus-inner{border:0}.mat-raised-button.mat-button-disabled{cursor:default}.mat-raised-button.cdk-keyboard-focused .mat-button-focus-overlay,.mat-raised-button.cdk-program-focused .mat-button-focus-overlay{opacity:.12}.mat-raised-button::-moz-focus-inner{border:0}._mat-animation-noopable.mat-raised-button{transition:none;animation:none}.mat-stroked-button{border:1px solid currentColor;padding:0 15px;line-height:34px}.mat-stroked-button .mat-button-ripple.mat-ripple,.mat-stroked-button .mat-button-focus-overlay{top:-1px;left:-1px;right:-1px;bottom:-1px}.mat-fab{box-sizing:border-box;position:relative;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;cursor:pointer;outline:none;border:none;-webkit-tap-highlight-color:transparent;display:inline-block;white-space:nowrap;text-decoration:none;vertical-align:baseline;text-align:center;margin:0;min-width:64px;line-height:36px;padding:0 16px;border-radius:4px;overflow:visible;transform:translate3d(0, 0, 0);transition:background 400ms cubic-bezier(0.25, 0.8, 0.25, 1),box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1);min-width:0;border-radius:50%;width:56px;height:56px;padding:0;flex-shrink:0}.mat-fab::-moz-focus-inner{border:0}.mat-fab.mat-button-disabled{cursor:default}.mat-fab.cdk-keyboard-focused .mat-button-focus-overlay,.mat-fab.cdk-program-focused .mat-button-focus-overlay{opacity:.12}.mat-fab::-moz-focus-inner{border:0}._mat-animation-noopable.mat-fab{transition:none;animation:none}.mat-fab .mat-button-wrapper{padding:16px 0;display:inline-block;line-height:24px}.mat-mini-fab{box-sizing:border-box;position:relative;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;cursor:pointer;outline:none;border:none;-webkit-tap-highlight-color:transparent;display:inline-block;white-space:nowrap;text-decoration:none;vertical-align:baseline;text-align:center;margin:0;min-width:64px;line-height:36px;padding:0 16px;border-radius:4px;overflow:visible;transform:translate3d(0, 0, 0);transition:background 400ms cubic-bezier(0.25, 0.8, 0.25, 1),box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1);min-width:0;border-radius:50%;width:40px;height:40px;padding:0;flex-shrink:0}.mat-mini-fab::-moz-focus-inner{border:0}.mat-mini-fab.mat-button-disabled{cursor:default}.mat-mini-fab.cdk-keyboard-focused .mat-button-focus-overlay,.mat-mini-fab.cdk-program-focused .mat-button-focus-overlay{opacity:.12}.mat-mini-fab::-moz-focus-inner{border:0}._mat-animation-noopable.mat-mini-fab{transition:none;animation:none}.mat-mini-fab .mat-button-wrapper{padding:8px 0;display:inline-block;line-height:24px}.mat-icon-button{padding:0;min-width:0;width:40px;height:40px;flex-shrink:0;line-height:40px;border-radius:50%}.mat-icon-button i,.mat-icon-button .mat-icon{line-height:24px}.mat-button-ripple.mat-ripple,.mat-button-focus-overlay{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none;border-radius:inherit}.mat-button-ripple.mat-ripple:not(:empty){transform:translateZ(0)}.mat-button-focus-overlay{opacity:0;transition:opacity 200ms cubic-bezier(0.35, 0, 0.25, 1),background-color 200ms cubic-bezier(0.35, 0, 0.25, 1)}._mat-animation-noopable .mat-button-focus-overlay{transition:none}.cdk-high-contrast-active .mat-button-focus-overlay{background-color:#fff}.cdk-high-contrast-black-on-white .mat-button-focus-overlay{background-color:#000}.mat-button-ripple-round{border-radius:50%;z-index:1}.mat-button .mat-button-wrapper>*,.mat-flat-button .mat-button-wrapper>*,.mat-stroked-button .mat-button-wrapper>*,.mat-raised-button .mat-button-wrapper>*,.mat-icon-button .mat-button-wrapper>*,.mat-fab .mat-button-wrapper>*,.mat-mini-fab .mat-button-wrapper>*{vertical-align:middle}.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-prefix .mat-icon-button,.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-suffix .mat-icon-button{display:block;font-size:inherit;width:2.5em;height:2.5em}.cdk-high-contrast-active .mat-button,.cdk-high-contrast-active .mat-flat-button,.cdk-high-contrast-active .mat-raised-button,.cdk-high-contrast-active .mat-icon-button,.cdk-high-contrast-active .mat-fab,.cdk-high-contrast-active .mat-mini-fab{outline:solid 1px}\n",dw=["mat-button","mat-flat-button","mat-icon-button","mat-raised-button","mat-stroked-button","mat-mini-fab","mat-fab"];class fw{constructor(t){this._elementRef=t}}const pw=cv(lv(hv(fw)));let mw=(()=>{class t extends pw{constructor(t,e,n){super(t),this._focusMonitor=e,this._animationMode=n,this.isRoundButton=this._hasHostAttributes("mat-fab","mat-mini-fab"),this.isIconButton=this._hasHostAttributes("mat-icon-button");for(const r of dw)this._hasHostAttributes(r)&&this._getHostElement().classList.add(r);t.nativeElement.classList.add("mat-button-base"),this.isRoundButton&&(this.color="accent")}ngAfterViewInit(){this._focusMonitor.monitor(this._elementRef,!0)}ngOnDestroy(){this._focusMonitor.stopMonitoring(this._elementRef)}focus(t="program",e){this._focusMonitor.focusVia(this._getHostElement(),t,e)}_getHostElement(){return this._elementRef.nativeElement}_isRippleDisabled(){return this.disableRipple||this.disabled}_hasHostAttributes(...t){return t.some(t=>this._getHostElement().hasAttribute(t))}}return t.\u0275fac=function(e){return new(e||t)(ka(ks),ka(_g),ka(wf,8))},t.\u0275cmp=pe({type:t,selectors:[["button","mat-button",""],["button","mat-raised-button",""],["button","mat-icon-button",""],["button","mat-fab",""],["button","mat-mini-fab",""],["button","mat-stroked-button",""],["button","mat-flat-button",""]],viewQuery:function(t,e){var n;1&t&&Du(zv,!0),2&t&&Nu(n=Pu())&&(e.ripple=n.first)},hostAttrs:[1,"mat-focus-indicator"],hostVars:5,hostBindings:function(t,e){2&t&&(wa("disabled",e.disabled||null),Ya("_mat-animation-noopable","NoopAnimations"===e._animationMode)("mat-button-disabled",e.disabled))},inputs:{disabled:"disabled",disableRipple:"disableRipple",color:"color"},exportAs:["matButton"],features:[us],attrs:lw,ngContentSelectors:cw,decls:4,vars:5,consts:[[1,"mat-button-wrapper"],["matRipple","",1,"mat-button-ripple",3,"matRippleDisabled","matRippleCentered","matRippleTrigger"],[1,"mat-button-focus-overlay"]],template:function(t,e){1&t&&(Va(),Aa(0,"span",0),Wa(1),Na(),Ta(2,"div",1),Ta(3,"div",2)),2&t&&(bi(2),Ya("mat-button-ripple-round",e.isRoundButton||e.isIconButton),Ea("matRippleDisabled",e._isRippleDisabled())("matRippleCentered",e.isIconButton)("matRippleTrigger",e._getHostElement()))},directives:[zv],styles:[hw],encapsulation:2,changeDetection:0}),t})(),gw=(()=>{class t extends mw{constructor(t,e,n){super(e,t,n)}_haltDisabledEvents(t){this.disabled&&(t.preventDefault(),t.stopImmediatePropagation())}}return t.\u0275fac=function(e){return new(e||t)(ka(_g),ka(ks),ka(wf,8))},t.\u0275cmp=pe({type:t,selectors:[["a","mat-button",""],["a","mat-raised-button",""],["a","mat-icon-button",""],["a","mat-fab",""],["a","mat-mini-fab",""],["a","mat-stroked-button",""],["a","mat-flat-button",""]],hostAttrs:[1,"mat-focus-indicator"],hostVars:7,hostBindings:function(t,e){1&t&&Pa("click",(function(t){return e._haltDisabledEvents(t)})),2&t&&(wa("tabindex",e.disabled?-1:e.tabIndex||0)("disabled",e.disabled||null)("aria-disabled",e.disabled.toString()),Ya("_mat-animation-noopable","NoopAnimations"===e._animationMode)("mat-button-disabled",e.disabled))},inputs:{disabled:"disabled",disableRipple:"disableRipple",color:"color",tabIndex:"tabIndex"},exportAs:["matButton","matAnchor"],features:[us],attrs:lw,ngContentSelectors:cw,decls:4,vars:5,consts:[[1,"mat-button-wrapper"],["matRipple","",1,"mat-button-ripple",3,"matRippleDisabled","matRippleCentered","matRippleTrigger"],[1,"mat-button-focus-overlay"]],template:function(t,e){1&t&&(Va(),Aa(0,"span",0),Wa(1),Na(),Ta(2,"div",1),Ta(3,"div",2)),2&t&&(bi(2),Ya("mat-button-ripple-round",e.isRoundButton||e.isIconButton),Ea("matRippleDisabled",e._isRippleDisabled())("matRippleCentered",e.isIconButton)("matRippleTrigger",e._getHostElement()))},directives:[zv],styles:[hw],encapsulation:2,changeDetection:0}),t})(),yw=(()=>{class t{}return t.\u0275mod=ve({type:t}),t.\u0275inj=dt({factory:function(e){return new(e||t)},imports:[[Lv,uv],uv]}),t})(),vw=(()=>{class t{}return t.\u0275mod=ve({type:t}),t.\u0275inj=dt({factory:function(e){return new(e||t)},imports:[[uv,Lv],uv]}),t})();const bw=["*",[["mat-card-footer"]]],ww=["*","mat-card-footer"],xw=[[["mat-card-title"],["mat-card-subtitle"],["","mat-card-title",""],["","mat-card-subtitle",""],["","matCardTitle",""],["","matCardSubtitle",""]],[["img"]],"*"],_w=["mat-card-title, mat-card-subtitle,\n      [mat-card-title], [mat-card-subtitle],\n      [matCardTitle], [matCardSubtitle]","img","*"];let Cw=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275dir=we({type:t,selectors:[["mat-card-content"],["","mat-card-content",""],["","matCardContent",""]],hostAttrs:[1,"mat-card-content"]}),t})(),kw=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275dir=we({type:t,selectors:[["mat-card-title"],["","mat-card-title",""],["","matCardTitle",""]],hostAttrs:[1,"mat-card-title"]}),t})(),Sw=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275dir=we({type:t,selectors:[["mat-card-subtitle"],["","mat-card-subtitle",""],["","matCardSubtitle",""]],hostAttrs:[1,"mat-card-subtitle"]}),t})(),Ew=(()=>{class t{constructor(t){this._animationMode=t}}return t.\u0275fac=function(e){return new(e||t)(ka(wf,8))},t.\u0275cmp=pe({type:t,selectors:[["mat-card"]],hostAttrs:[1,"mat-card","mat-focus-indicator"],hostVars:2,hostBindings:function(t,e){2&t&&Ya("_mat-animation-noopable","NoopAnimations"===e._animationMode)},exportAs:["matCard"],ngContentSelectors:ww,decls:2,vars:0,template:function(t,e){1&t&&(Va(bw),Wa(0),Wa(1,1))},styles:[".mat-card{transition:box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1);display:block;position:relative;padding:16px;border-radius:4px}._mat-animation-noopable.mat-card{transition:none;animation:none}.mat-card .mat-divider-horizontal{position:absolute;left:0;width:100%}[dir=rtl] .mat-card .mat-divider-horizontal{left:auto;right:0}.mat-card .mat-divider-horizontal.mat-divider-inset{position:static;margin:0}[dir=rtl] .mat-card .mat-divider-horizontal.mat-divider-inset{margin-right:0}.cdk-high-contrast-active .mat-card{outline:solid 1px}.mat-card-actions,.mat-card-subtitle,.mat-card-content{display:block;margin-bottom:16px}.mat-card-title{display:block;margin-bottom:8px}.mat-card-actions{margin-left:-8px;margin-right:-8px;padding:8px 0}.mat-card-actions-align-end{display:flex;justify-content:flex-end}.mat-card-image{width:calc(100% + 32px);margin:0 -16px 16px -16px}.mat-card-footer{display:block;margin:0 -16px -16px -16px}.mat-card-actions .mat-button,.mat-card-actions .mat-raised-button,.mat-card-actions .mat-stroked-button{margin:0 8px}.mat-card-header{display:flex;flex-direction:row}.mat-card-header .mat-card-title{margin-bottom:12px}.mat-card-header-text{margin:0 16px}.mat-card-avatar{height:40px;width:40px;border-radius:50%;flex-shrink:0;object-fit:cover}.mat-card-title-group{display:flex;justify-content:space-between}.mat-card-sm-image{width:80px;height:80px}.mat-card-md-image{width:112px;height:112px}.mat-card-lg-image{width:152px;height:152px}.mat-card-xl-image{width:240px;height:240px;margin:-8px}.mat-card-title-group>.mat-card-xl-image{margin:-8px 0 8px}@media(max-width: 599px){.mat-card-title-group{margin:0}.mat-card-xl-image{margin-left:0;margin-right:0}}.mat-card>:first-child,.mat-card-content>:first-child{margin-top:0}.mat-card>:last-child:not(.mat-card-footer),.mat-card-content>:last-child:not(.mat-card-footer){margin-bottom:0}.mat-card-image:first-child{margin-top:-16px;border-top-left-radius:inherit;border-top-right-radius:inherit}.mat-card>.mat-card-actions:last-child{margin-bottom:-8px;padding-bottom:0}.mat-card-actions .mat-button:first-child,.mat-card-actions .mat-raised-button:first-child,.mat-card-actions .mat-stroked-button:first-child{margin-left:0;margin-right:0}.mat-card-title:not(:first-child),.mat-card-subtitle:not(:first-child){margin-top:-4px}.mat-card-header .mat-card-subtitle:not(:first-child){margin-top:-8px}.mat-card>.mat-card-xl-image:first-child{margin-top:-8px}.mat-card>.mat-card-xl-image:last-child{margin-bottom:-8px}\n"],encapsulation:2,changeDetection:0}),t})(),Ow=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=pe({type:t,selectors:[["mat-card-title-group"]],hostAttrs:[1,"mat-card-title-group"],ngContentSelectors:_w,decls:4,vars:0,template:function(t,e){1&t&&(Va(xw),Aa(0,"div"),Wa(1),Na(),Wa(2,1),Wa(3,2))},encapsulation:2,changeDetection:0}),t})(),Aw=(()=>{class t{}return t.\u0275mod=ve({type:t}),t.\u0275inj=dt({factory:function(e){return new(e||t)},imports:[[uv],uv]}),t})(),Nw=(()=>{class t{}return t.\u0275mod=ve({type:t}),t.\u0275inj=dt({factory:function(e){return new(e||t)}}),t})(),Tw=(()=>{class t{}return t.\u0275mod=ve({type:t}),t.\u0275inj=dt({factory:function(e){return new(e||t)},imports:[[Lv,uv,fg,Nw],uv,Nw]}),t})();const Dw=new Lt("mat-chips-default-options"),Rw={separatorKeyCodes:[13]};let Iw=(()=>{class t{}return t.\u0275mod=ve({type:t}),t.\u0275inj=dt({factory:function(e){return new(e||t)},providers:[Ov,{provide:Dw,useValue:Rw}]}),t})();function Mw(t){return function(e){const n=new Fw(t),r=e.lift(n);return n.caught=r}}class Fw{constructor(t){this.selector=t}call(t,e){return e.subscribe(new Pw(t,this.selector,this.caught))}}class Pw extends M{constructor(t,e,n){super(t),this.selector=e,this.caught=n}error(t){if(!this.isStopped){let n;try{n=this.selector(t,this.caught)}catch(e){return void super.error(e)}this._unsubscribeAndRecycle();const r=new E(this,void 0,void 0);this.add(r);const i=I(this,n,void 0,void 0,r);i!==r&&this.add(i)}}}function jw(t){return e=>e.lift(new zw(t))}class zw{constructor(t){this.callback=t}call(t,e){return e.subscribe(new Lw(t,this.callback))}}class Lw extends p{constructor(t,e){super(t),this.add(new h(e))}}const Bw=["*"];function Uw(t){return Error(`Unable to find icon with the name "${t}"`)}function $w(t){return Error(`The URL provided to MatIconRegistry was not trusted as a resource URL via Angular's DomSanitizer. Attempted URL was "${t}".`)}function Vw(t){return Error(`The literal provided to MatIconRegistry was not trusted as safe HTML by Angular's DomSanitizer. Attempted literal was "${t}".`)}class Ww{constructor(t,e){this.options=e,t.nodeName?this.svgElement=t:this.url=t}}let qw=(()=>{class t{constructor(t,e,n,r){this._httpClient=t,this._sanitizer=e,this._errorHandler=r,this._svgIconConfigs=new Map,this._iconSetConfigs=new Map,this._cachedIconsByUrl=new Map,this._inProgressUrlFetches=new Map,this._fontCssClassesByAlias=new Map,this._defaultFontSetClass="material-icons",this._document=n}addSvgIcon(t,e,n){return this.addSvgIconInNamespace("",t,e,n)}addSvgIconLiteral(t,e,n){return this.addSvgIconLiteralInNamespace("",t,e,n)}addSvgIconInNamespace(t,e,n,r){return this._addSvgIconConfig(t,e,new Ww(n,r))}addSvgIconLiteralInNamespace(t,e,n,r){const i=this._sanitizer.sanitize(Qr.HTML,n);if(!i)throw Vw(n);const o=this._createSvgElementForSingleIcon(i,r);return this._addSvgIconConfig(t,e,new Ww(o,r))}addSvgIconSet(t,e){return this.addSvgIconSetInNamespace("",t,e)}addSvgIconSetLiteral(t,e){return this.addSvgIconSetLiteralInNamespace("",t,e)}addSvgIconSetInNamespace(t,e,n){return this._addSvgIconSetConfig(t,new Ww(e,n))}addSvgIconSetLiteralInNamespace(t,e,n){const r=this._sanitizer.sanitize(Qr.HTML,e);if(!r)throw Vw(e);const i=this._svgElementFromString(r);return this._addSvgIconSetConfig(t,new Ww(i,n))}registerFontClassAlias(t,e=t){return this._fontCssClassesByAlias.set(t,e),this}classNameForFontAlias(t){return this._fontCssClassesByAlias.get(t)||t}setDefaultFontSetClass(t){return this._defaultFontSetClass=t,this}getDefaultFontSetClass(){return this._defaultFontSetClass}getSvgIconFromUrl(t){const e=this._sanitizer.sanitize(Qr.RESOURCE_URL,t);if(!e)throw $w(t);const n=this._cachedIconsByUrl.get(e);return n?Xp(Hw(n)):this._loadSvgIconFromConfig(new Ww(t)).pipe($m(t=>this._cachedIconsByUrl.set(e,t)),F(t=>Hw(t)))}getNamedSvgIcon(t,e=""){const n=Gw(e,t),r=this._svgIconConfigs.get(n);if(r)return this._getSvgFromConfig(r);const i=this._iconSetConfigs.get(e);return i?this._getSvgFromIconSetConfigs(t,i):qg(Uw(n))}ngOnDestroy(){this._svgIconConfigs.clear(),this._iconSetConfigs.clear(),this._cachedIconsByUrl.clear()}_getSvgFromConfig(t){return t.svgElement?Xp(Hw(t.svgElement)):this._loadSvgIconFromConfig(t).pipe($m(e=>t.svgElement=e),F(t=>Hw(t)))}_getSvgFromIconSetConfigs(t,e){const n=this._extractIconWithNameFromAnySet(t,e);return n?Xp(n):Cf(e.filter(t=>!t.svgElement).map(t=>this._loadSvgIconSetFromConfig(t).pipe(Mw(e=>{const n=this._sanitizer.sanitize(Qr.RESOURCE_URL,t.url);return this._errorHandler.handleError(new Error(`Loading icon set URL: ${n} failed: ${e.message}`)),Xp(null)})))).pipe(F(()=>{const n=this._extractIconWithNameFromAnySet(t,e);if(!n)throw Uw(t);return n}))}_extractIconWithNameFromAnySet(t,e){for(let n=e.length-1;n>=0;n--){const r=e[n];if(r.svgElement){const e=this._extractSvgIconFromSet(r.svgElement,t,r.options);if(e)return e}}return null}_loadSvgIconFromConfig(t){return this._fetchIcon(t).pipe(F(e=>this._createSvgElementForSingleIcon(e,t.options)))}_loadSvgIconSetFromConfig(t){return t.svgElement?Xp(t.svgElement):this._fetchIcon(t).pipe(F(e=>(t.svgElement||(t.svgElement=this._svgElementFromString(e)),t.svgElement)))}_createSvgElementForSingleIcon(t,e){const n=this._svgElementFromString(t);return this._setSvgAttributes(n,e),n}_extractSvgIconFromSet(t,e,n){const r=t.querySelector(`[id="${e}"]`);if(!r)return null;const i=r.cloneNode(!0);if(i.removeAttribute("id"),"svg"===i.nodeName.toLowerCase())return this._setSvgAttributes(i,n);if("symbol"===i.nodeName.toLowerCase())return this._setSvgAttributes(this._toSvgElement(i),n);const o=this._svgElementFromString("<svg></svg>");return o.appendChild(i),this._setSvgAttributes(o,n)}_svgElementFromString(t){const e=this._document.createElement("DIV");e.innerHTML=t;const n=e.querySelector("svg");if(!n)throw Error("<svg> tag not found");return n}_toSvgElement(t){const e=this._svgElementFromString("<svg></svg>"),n=t.attributes;for(let r=0;r<n.length;r++){const{name:t,value:i}=n[r];"id"!==t&&e.setAttribute(t,i)}for(let r=0;r<t.childNodes.length;r++)t.childNodes[r].nodeType===this._document.ELEMENT_NODE&&e.appendChild(t.childNodes[r].cloneNode(!0));return e}_setSvgAttributes(t,e){return t.setAttribute("fit",""),t.setAttribute("height","100%"),t.setAttribute("width","100%"),t.setAttribute("preserveAspectRatio","xMidYMid meet"),t.setAttribute("focusable","false"),e&&e.viewBox&&t.setAttribute("viewBox",e.viewBox),t}_fetchIcon(t){var e;const{url:n,options:r}=t,i=null!==(e=null==r?void 0:r.withCredentials)&&void 0!==e&&e;if(!this._httpClient)throw Error("Could not find HttpClient provider for use with Angular Material icons. Please include the HttpClientModule from @angular/common/http in your app imports.");if(null==n)throw Error(`Cannot fetch icon from URL "${n}".`);const o=this._sanitizer.sanitize(Qr.RESOURCE_URL,n);if(!o)throw $w(n);const a=this._inProgressUrlFetches.get(o);if(a)return a;const s=this._httpClient.get(o,{responseType:"text",withCredentials:i}).pipe(jw(()=>this._inProgressUrlFetches.delete(o)),et());return this._inProgressUrlFetches.set(o,s),s}_addSvgIconConfig(t,e,n){return this._svgIconConfigs.set(Gw(t,e),n),this}_addSvgIconSetConfig(t,e){const n=this._iconSetConfigs.get(t);return n?n.push(e):this._iconSetConfigs.set(t,[e]),this}}return t.\u0275fac=function(e){return new(e||t)(Kt(mm,8),Kt(Yc),Kt(zl,8),Kt(yr))},t.\u0275prov=ht({factory:function(){return new t(Kt(mm,8),Kt(Yc),Kt(zl,8),Kt(yr))},token:t,providedIn:"root"}),t})();function Hw(t){return t.cloneNode(!0)}function Gw(t,e){return t+":"+e}class Xw{constructor(t){this._elementRef=t}}const Kw=cv(Xw),Yw=new Lt("mat-icon-location",{providedIn:"root",factory:function(){const t=Yt(zl),e=t?t.location:null;return{getPathname:()=>e?e.pathname+e.search:""}}}),Zw=["clip-path","color-profile","src","cursor","fill","filter","marker","marker-start","marker-mid","marker-end","mask","stroke"],Qw=Zw.map(t=>`[${t}]`).join(", "),Jw=/^url\(['"]?#(.*?)['"]?\)$/;let tx=(()=>{class t extends Kw{constructor(t,e,n,r,i){super(t),this._iconRegistry=e,this._location=r,this._errorHandler=i,this._inline=!1,this._currentIconFetch=h.EMPTY,n||t.nativeElement.setAttribute("aria-hidden","true")}get inline(){return this._inline}set inline(t){this._inline=og(t)}get fontSet(){return this._fontSet}set fontSet(t){this._fontSet=this._cleanupFontValue(t)}get fontIcon(){return this._fontIcon}set fontIcon(t){this._fontIcon=this._cleanupFontValue(t)}_splitIconName(t){if(!t)return["",""];const e=t.split(":");switch(e.length){case 1:return["",e[0]];case 2:return e;default:throw Error(`Invalid icon name: "${t}"`)}}ngOnChanges(t){const e=t.svgIcon;if(e)if(this._currentIconFetch.unsubscribe(),this.svgIcon){const[t,e]=this._splitIconName(this.svgIcon);this._currentIconFetch=this._iconRegistry.getNamedSvgIcon(e,t).pipe(ng(1)).subscribe(t=>this._setSvgElement(t),n=>{this._errorHandler.handleError(new Error(`Error retrieving icon ${t}:${e}! ${n.message}`))})}else e.previousValue&&this._clearSvgElement();this._usingFontIcon()&&this._updateFontIconClasses()}ngOnInit(){this._usingFontIcon()&&this._updateFontIconClasses()}ngAfterViewChecked(){const t=this._elementsWithExternalReferences;if(t&&t.size){const t=this._location.getPathname();t!==this._previousPath&&(this._previousPath=t,this._prependPathToReferences(t))}}ngOnDestroy(){this._currentIconFetch.unsubscribe(),this._elementsWithExternalReferences&&this._elementsWithExternalReferences.clear()}_usingFontIcon(){return!this.svgIcon}_setSvgElement(t){this._clearSvgElement();const e=t.querySelectorAll("style");for(let r=0;r<e.length;r++)e[r].textContent+=" ";const n=this._location.getPathname();this._previousPath=n,this._cacheChildrenWithExternalReferences(t),this._prependPathToReferences(n),this._elementRef.nativeElement.appendChild(t)}_clearSvgElement(){const t=this._elementRef.nativeElement;let e=t.childNodes.length;for(this._elementsWithExternalReferences&&this._elementsWithExternalReferences.clear();e--;){const n=t.childNodes[e];1===n.nodeType&&"svg"!==n.nodeName.toLowerCase()||t.removeChild(n)}}_updateFontIconClasses(){if(!this._usingFontIcon())return;const t=this._elementRef.nativeElement,e=this.fontSet?this._iconRegistry.classNameForFontAlias(this.fontSet):this._iconRegistry.getDefaultFontSetClass();e!=this._previousFontSetClass&&(this._previousFontSetClass&&t.classList.remove(this._previousFontSetClass),e&&t.classList.add(e),this._previousFontSetClass=e),this.fontIcon!=this._previousFontIconClass&&(this._previousFontIconClass&&t.classList.remove(this._previousFontIconClass),this.fontIcon&&t.classList.add(this.fontIcon),this._previousFontIconClass=this.fontIcon)}_cleanupFontValue(t){return"string"==typeof t?t.trim().split(" ")[0]:t}_prependPathToReferences(t){const e=this._elementsWithExternalReferences;e&&e.forEach((e,n)=>{e.forEach(e=>{n.setAttribute(e.name,`url('${t}#${e.value}')`)})})}_cacheChildrenWithExternalReferences(t){const e=t.querySelectorAll(Qw),n=this._elementsWithExternalReferences=this._elementsWithExternalReferences||new Map;for(let r=0;r<e.length;r++)Zw.forEach(t=>{const i=e[r],o=i.getAttribute(t),a=o?o.match(Jw):null;if(a){let e=n.get(i);e||(e=[],n.set(i,e)),e.push({name:t,value:a[1]})}})}}return t.\u0275fac=function(e){return new(e||t)(ka(ks),ka(qw),Sa("aria-hidden"),ka(Yw),ka(yr))},t.\u0275cmp=pe({type:t,selectors:[["mat-icon"]],hostAttrs:["role","img",1,"mat-icon","notranslate"],hostVars:4,hostBindings:function(t,e){2&t&&Ya("mat-icon-inline",e.inline)("mat-icon-no-color","primary"!==e.color&&"accent"!==e.color&&"warn"!==e.color)},inputs:{color:"color",inline:"inline",fontSet:"fontSet",fontIcon:"fontIcon",svgIcon:"svgIcon"},exportAs:["matIcon"],features:[us,Ie],ngContentSelectors:Bw,decls:1,vars:0,template:function(t,e){1&t&&(Va(),Wa(0))},styles:[".mat-icon{background-repeat:no-repeat;display:inline-block;fill:currentColor;height:24px;width:24px}.mat-icon.mat-icon-inline{font-size:inherit;height:inherit;line-height:inherit;width:inherit}[dir=rtl] .mat-icon-rtl-mirror{transform:scale(-1, 1)}.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-prefix .mat-icon,.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-suffix .mat-icon{display:block}.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-prefix .mat-icon-button .mat-icon,.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-suffix .mat-icon-button .mat-icon{margin:auto}\n"],encapsulation:2,changeDetection:0}),t})(),ex=(()=>{class t{}return t.\u0275mod=ve({type:t}),t.\u0275inj=dt({factory:function(e){return new(e||t)},imports:[[uv],uv]}),t})(),nx=(()=>{class t{constructor(){this.changes=new C,this.optionalLabel="Optional"}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=ht({factory:function(){return new t},token:t,providedIn:"root"}),t})();const rx={provide:nx,deps:[[new ot,new st,nx]],useFactory:function(t){return t||new nx}};let ix=(()=>{class t{}return t.\u0275mod=ve({type:t}),t.\u0275inj=dt({factory:function(e){return new(e||t)},providers:[rx,Ov],imports:[[uv,xc,Jy,yw,tv,ex,Lv],uv]}),t})();function ox(t,e){}class ax{constructor(){this.role="dialog",this.panelClass="",this.hasBackdrop=!0,this.backdropClass="",this.disableClose=!1,this.width="",this.height="",this.maxWidth="80vw",this.data=null,this.ariaDescribedBy=null,this.ariaLabelledBy=null,this.ariaLabel=null,this.autoFocus=!0,this.restoreFocus=!0,this.closeOnNavigation=!0}}const sx={dialogContainer:nh("dialogContainer",[ah("void, exit",oh({opacity:0,transform:"scale(0.7)"})),ah("enter",oh({transform:"none"})),sh("* => enter",rh("150ms cubic-bezier(0, 0, 0.2, 1)",oh({transform:"none",opacity:1}))),sh("* => void, * => exit",rh("75ms cubic-bezier(0.4, 0.0, 0.2, 1)",oh({opacity:0})))])};function ux(){throw Error("Attempting to attach dialog content after content is already attached")}let lx=(()=>{class t extends Yy{constructor(t,e,n,r,i,o){super(),this._elementRef=t,this._focusTrapFactory=e,this._changeDetectorRef=n,this._config=i,this._focusMonitor=o,this._elementFocusedBeforeDialogWasOpened=null,this._closeInteractionType=null,this._state="enter",this._animationStateChanged=new vu,this.attachDomPortal=t=>(this._portalOutlet.hasAttached()&&ux(),this._setupFocusTrap(),this._portalOutlet.attachDomPortal(t)),this._ariaLabelledBy=i.ariaLabelledBy||null,this._document=r}attachComponentPortal(t){return this._portalOutlet.hasAttached()&&ux(),this._setupFocusTrap(),this._portalOutlet.attachComponentPortal(t)}attachTemplatePortal(t){return this._portalOutlet.hasAttached()&&ux(),this._setupFocusTrap(),this._portalOutlet.attachTemplatePortal(t)}_recaptureFocus(){this._containsFocus()||(!this._config.autoFocus||!this._focusTrap.focusInitialElement())&&this._elementRef.nativeElement.focus()}_trapFocus(){this._config.autoFocus?this._focusTrap.focusInitialElementWhenReady():this._containsFocus()||this._elementRef.nativeElement.focus()}_restoreFocus(){const t=this._elementFocusedBeforeDialogWasOpened;if(this._config.restoreFocus&&t&&"function"==typeof t.focus){const e=this._document.activeElement,n=this._elementRef.nativeElement;e&&e!==this._document.body&&e!==n&&!n.contains(e)||(this._focusMonitor?(this._focusMonitor.focusVia(t,this._closeInteractionType),this._closeInteractionType=null):t.focus())}this._focusTrap&&this._focusTrap.destroy()}_setupFocusTrap(){this._focusTrap||(this._focusTrap=this._focusTrapFactory.create(this._elementRef.nativeElement)),this._document&&(this._elementFocusedBeforeDialogWasOpened=this._document.activeElement,this._elementRef.nativeElement.focus&&Promise.resolve().then(()=>this._elementRef.nativeElement.focus()))}_containsFocus(){const t=this._elementRef.nativeElement,e=this._document.activeElement;return t===e||t.contains(e)}_onAnimationDone(t){"enter"===t.toState?this._trapFocus():"exit"===t.toState&&this._restoreFocus(),this._animationStateChanged.emit(t)}_onAnimationStart(t){this._animationStateChanged.emit(t)}_startExitAnimation(){this._state="exit",this._changeDetectorRef.markForCheck()}}return t.\u0275fac=function(e){return new(e||t)(ka(ks),ka(vg),ka(Go),ka(zl,8),ka(ax),ka(_g))},t.\u0275cmp=pe({type:t,selectors:[["mat-dialog-container"]],viewQuery:function(t,e){var n;1&t&&Tu(Qy,!0),2&t&&Nu(n=Pu())&&(e._portalOutlet=n.first)},hostAttrs:["tabindex","-1","aria-modal","true",1,"mat-dialog-container"],hostVars:6,hostBindings:function(t,e){1&t&&ja("@dialogContainer.start",(function(t){return e._onAnimationStart(t)}))("@dialogContainer.done",(function(t){return e._onAnimationDone(t)})),2&t&&(wa("id",e._id)("role",e._config.role)("aria-labelledby",e._config.ariaLabel?null:e._ariaLabelledBy)("aria-label",e._config.ariaLabel)("aria-describedby",e._config.ariaDescribedBy||null),as("@dialogContainer",e._state))},features:[us],decls:1,vars:0,consts:[["cdkPortalOutlet",""]],template:function(t,e){1&t&&_a(0,ox,0,0,"ng-template",0)},directives:[Qy],styles:[".mat-dialog-container{display:block;padding:24px;border-radius:4px;box-sizing:border-box;overflow:auto;outline:0;width:100%;height:100%;min-height:inherit;max-height:inherit}.cdk-high-contrast-active .mat-dialog-container{outline:solid 1px}.mat-dialog-content{display:block;margin:0 -24px;padding:0 24px;max-height:65vh;overflow:auto;-webkit-overflow-scrolling:touch}.mat-dialog-title{margin:0 0 20px;display:block}.mat-dialog-actions{padding:8px 0;display:flex;flex-wrap:wrap;min-height:52px;align-items:center;margin-bottom:-24px}.mat-dialog-actions[align=end]{justify-content:flex-end}.mat-dialog-actions[align=center]{justify-content:center}.mat-dialog-actions .mat-button-base+.mat-button-base,.mat-dialog-actions .mat-mdc-button-base+.mat-mdc-button-base{margin-left:8px}[dir=rtl] .mat-dialog-actions .mat-button-base+.mat-button-base,[dir=rtl] .mat-dialog-actions .mat-mdc-button-base+.mat-mdc-button-base{margin-left:0;margin-right:8px}\n"],encapsulation:2,data:{animation:[sx.dialogContainer]}}),t})(),cx=0;class hx{constructor(t,e,n="mat-dialog-"+cx++){this._overlayRef=t,this._containerInstance=e,this.id=n,this.disableClose=this._containerInstance._config.disableClose,this._afterOpened=new C,this._afterClosed=new C,this._beforeClosed=new C,this._state=0,e._id=n,e._animationStateChanged.pipe(Yp(t=>"done"===t.phaseName&&"enter"===t.toState),ng(1)).subscribe(()=>{this._afterOpened.next(),this._afterOpened.complete()}),e._animationStateChanged.pipe(Yp(t=>"done"===t.phaseName&&"exit"===t.toState),ng(1)).subscribe(()=>{clearTimeout(this._closeFallbackTimeout),this._finishDialogClose()}),t.detachments().subscribe(()=>{this._beforeClosed.next(this._result),this._beforeClosed.complete(),this._afterClosed.next(this._result),this._afterClosed.complete(),this.componentInstance=null,this._overlayRef.dispose()}),t.keydownEvents().pipe(Yp(t=>27===t.keyCode&&!this.disableClose&&!function(t,...e){return e.length?e.some(e=>t[e]):t.altKey||t.shiftKey||t.ctrlKey||t.metaKey}(t))).subscribe(t=>{t.preventDefault(),dx(this,"keyboard")}),t.backdropClick().subscribe(()=>{this.disableClose?this._containerInstance._recaptureFocus():dx(this,"mouse")})}close(t){this._result=t,this._containerInstance._animationStateChanged.pipe(Yp(t=>"start"===t.phaseName),ng(1)).subscribe(e=>{this._beforeClosed.next(t),this._beforeClosed.complete(),this._overlayRef.detachBackdrop(),this._closeFallbackTimeout=setTimeout(()=>this._finishDialogClose(),e.totalTime+100)}),this._containerInstance._startExitAnimation(),this._state=1}afterOpened(){return this._afterOpened.asObservable()}afterClosed(){return this._afterClosed.asObservable()}beforeClosed(){return this._beforeClosed.asObservable()}backdropClick(){return this._overlayRef.backdropClick()}keydownEvents(){return this._overlayRef.keydownEvents()}updatePosition(t){let e=this._getPositionStrategy();return t&&(t.left||t.right)?t.left?e.left(t.left):e.right(t.right):e.centerHorizontally(),t&&(t.top||t.bottom)?t.top?e.top(t.top):e.bottom(t.bottom):e.centerVertically(),this._overlayRef.updatePosition(),this}updateSize(t="",e=""){return this._getPositionStrategy().width(t).height(e),this._overlayRef.updatePosition(),this}addPanelClass(t){return this._overlayRef.addPanelClass(t),this}removePanelClass(t){return this._overlayRef.removePanelClass(t),this}getState(){return this._state}_finishDialogClose(){this._state=2,this._overlayRef.dispose()}_getPositionStrategy(){return this._overlayRef.getConfig().positionStrategy}}function dx(t,e,n){return void 0!==t._containerInstance&&(t._containerInstance._closeInteractionType=e),t.close(n)}const fx=new Lt("MatDialogData"),px=new Lt("mat-dialog-default-options"),mx=new Lt("mat-dialog-scroll-strategy"),gx={provide:mx,deps:[yb],useFactory:function(t){return()=>t.scrollStrategies.block()}};let yx=(()=>{class t{constructor(t,e,n,r,i,o,a){this._overlay=t,this._injector=e,this._defaultOptions=r,this._parentDialog=o,this._overlayContainer=a,this._openDialogsAtThisLevel=[],this._afterAllClosedAtThisLevel=new C,this._afterOpenedAtThisLevel=new C,this._ariaHiddenElements=new Map,this.afterAllClosed=Vv(()=>this.openDialogs.length?this._getAfterAllClosed():this._getAfterAllClosed().pipe(Ug(void 0))),this._scrollStrategy=i}get openDialogs(){return this._parentDialog?this._parentDialog.openDialogs:this._openDialogsAtThisLevel}get afterOpened(){return this._parentDialog?this._parentDialog.afterOpened:this._afterOpenedAtThisLevel}_getAfterAllClosed(){const t=this._parentDialog;return t?t._getAfterAllClosed():this._afterAllClosedAtThisLevel}open(t,e){if((e=function(t,e){return Object.assign(Object.assign({},e),t)}(e,this._defaultOptions||new ax)).id&&this.getDialogById(e.id))throw Error(`Dialog with id "${e.id}" exists already. The dialog id must be unique.`);const n=this._createOverlay(e),r=this._attachDialogContainer(n,e),i=this._attachDialogContent(t,r,n,e);return this.openDialogs.length||this._hideNonDialogContentFromAssistiveTechnology(),this.openDialogs.push(i),i.afterClosed().subscribe(()=>this._removeOpenDialog(i)),this.afterOpened.next(i),i}closeAll(){this._closeDialogs(this.openDialogs)}getDialogById(t){return this.openDialogs.find(e=>e.id===t)}ngOnDestroy(){this._closeDialogs(this._openDialogsAtThisLevel),this._afterAllClosedAtThisLevel.complete(),this._afterOpenedAtThisLevel.complete()}_createOverlay(t){const e=this._getOverlayConfig(t);return this._overlay.create(e)}_getOverlayConfig(t){const e=new Qv({positionStrategy:this._overlay.position().global(),scrollStrategy:t.scrollStrategy||this._scrollStrategy(),panelClass:t.panelClass,hasBackdrop:t.hasBackdrop,direction:t.direction,minWidth:t.minWidth,minHeight:t.minHeight,maxWidth:t.maxWidth,maxHeight:t.maxHeight,disposeOnNavigation:t.closeOnNavigation});return t.backdropClass&&(e.backdropClass=t.backdropClass),e}_attachDialogContainer(t,e){const n=ca.create({parent:e&&e.viewContainerRef&&e.viewContainerRef.injector||this._injector,providers:[{provide:ax,useValue:e}]}),r=new Gy(lx,e.viewContainerRef,n,e.componentFactoryResolver);return t.attach(r).instance}_attachDialogContent(t,e,n,r){const i=new hx(n,e,r.id);if(t instanceof Xs)e.attachTemplatePortal(new Xy(t,null,{$implicit:r.data,dialogRef:i}));else{const n=this._createInjector(r,i,e),o=e.attachComponentPortal(new Gy(t,r.viewContainerRef,n));i.componentInstance=o.instance}return i.updateSize(r.width,r.height).updatePosition(r.position),i}_createInjector(t,e,n){const r=t&&t.viewContainerRef&&t.viewContainerRef.injector,i=[{provide:lx,useValue:n},{provide:fx,useValue:t.data},{provide:hx,useValue:e}];return!t.direction||r&&r.get(Kg,null)||i.push({provide:Kg,useValue:{value:t.direction,change:Xp()}}),ca.create({parent:r||this._injector,providers:i})}_removeOpenDialog(t){const e=this.openDialogs.indexOf(t);e>-1&&(this.openDialogs.splice(e,1),this.openDialogs.length||(this._ariaHiddenElements.forEach((t,e)=>{t?e.setAttribute("aria-hidden",t):e.removeAttribute("aria-hidden")}),this._ariaHiddenElements.clear(),this._getAfterAllClosed().next()))}_hideNonDialogContentFromAssistiveTechnology(){const t=this._overlayContainer.getContainerElement();if(t.parentElement){const e=t.parentElement.children;for(let n=e.length-1;n>-1;n--){let r=e[n];r===t||"SCRIPT"===r.nodeName||"STYLE"===r.nodeName||r.hasAttribute("aria-live")||(this._ariaHiddenElements.set(r,r.getAttribute("aria-hidden")),r.setAttribute("aria-hidden","true"))}}}_closeDialogs(t){let e=t.length;for(;e--;)t[e].close()}}return t.\u0275fac=function(e){return new(e||t)(Kt(yb),Kt(ca),Kt(Jl,8),Kt(px,8),Kt(mx),Kt(t,12),Kt(sb))},t.\u0275prov=ht({token:t,factory:t.\u0275fac}),t})(),vx=(()=>{class t{}return t.\u0275mod=ve({type:t}),t.\u0275inj=dt({factory:function(e){return new(e||t)},providers:[yx,gx],imports:[[bb,Jy,uv],uv]}),t})();const bx=Lm({passive:!0});let wx=(()=>{class t{constructor(t,e){this._platform=t,this._ngZone=e,this._monitoredElements=new Map}monitor(t){if(!this._platform.isBrowser)return tg;const e=lg(t),n=this._monitoredElements.get(e);if(n)return n.subject.asObservable();const r=new C,i="cdk-text-field-autofilled",o=t=>{"cdk-text-field-autofill-start"!==t.animationName||e.classList.contains(i)?"cdk-text-field-autofill-end"===t.animationName&&e.classList.contains(i)&&(e.classList.remove(i),this._ngZone.run(()=>r.next({target:t.target,isAutofilled:!1}))):(e.classList.add(i),this._ngZone.run(()=>r.next({target:t.target,isAutofilled:!0})))};return this._ngZone.runOutsideAngular(()=>{e.addEventListener("animationstart",o,bx),e.classList.add("cdk-text-field-autofill-monitored")}),this._monitoredElements.set(e,{subject:r,unlisten:()=>{e.removeEventListener("animationstart",o,bx)}}),r.asObservable()}stopMonitoring(t){const e=lg(t),n=this._monitoredElements.get(e);n&&(n.unlisten(),n.subject.complete(),e.classList.remove("cdk-text-field-autofill-monitored"),e.classList.remove("cdk-text-field-autofilled"),this._monitoredElements.delete(e))}ngOnDestroy(){this._monitoredElements.forEach((t,e)=>this.stopMonitoring(e))}}return t.\u0275fac=function(e){return new(e||t)(Kt(Im),Kt(sl))},t.\u0275prov=ht({factory:function(){return new t(Kt(Im),Kt(sl))},token:t,providedIn:"root"}),t})(),xx=(()=>{class t{}return t.\u0275mod=ve({type:t}),t.\u0275inj=dt({factory:function(e){return new(e||t)},imports:[[Mm]]}),t})();const _x=new Lt("MAT_INPUT_VALUE_ACCESSOR"),Cx=["button","checkbox","file","hidden","image","radio","range","reset","submit"];let kx=0;class Sx{constructor(t,e,n,r){this._defaultErrorStateMatcher=t,this._parentForm=e,this._parentFormGroup=n,this.ngControl=r}}const Ex=fv(Sx);let Ox=(()=>{class t extends Ex{constructor(t,e,n,r,i,o,a,s,u,l){super(o,r,i,n),this._elementRef=t,this._platform=e,this.ngControl=n,this._autofillMonitor=s,this._formField=l,this._uid="mat-input-"+kx++,this.focused=!1,this.stateChanges=new C,this.controlType="mat-input",this.autofilled=!1,this._disabled=!1,this._required=!1,this._type="text",this._readonly=!1,this._neverEmptyInputTypes=["date","datetime","datetime-local","month","time","week"].filter(t=>Pm().has(t));const c=this._elementRef.nativeElement,h=c.nodeName.toLowerCase();this._inputValueAccessor=a||c,this._previousNativeValue=this.value,this.id=this.id,e.IOS&&u.runOutsideAngular(()=>{t.nativeElement.addEventListener("keyup",t=>{let e=t.target;e.value||e.selectionStart||e.selectionEnd||(e.setSelectionRange(1,1),e.setSelectionRange(0,0))})}),this._isServer=!this._platform.isBrowser,this._isNativeSelect="select"===h,this._isTextarea="textarea"===h,this._isNativeSelect&&(this.controlType=c.multiple?"mat-native-select-multiple":"mat-native-select")}get disabled(){return this.ngControl&&null!==this.ngControl.disabled?this.ngControl.disabled:this._disabled}set disabled(t){this._disabled=og(t),this.focused&&(this.focused=!1,this.stateChanges.next())}get id(){return this._id}set id(t){this._id=t||this._uid}get required(){return this._required}set required(t){this._required=og(t)}get type(){return this._type}set type(t){this._type=t||"text",this._validateType(),!this._isTextarea&&Pm().has(this._type)&&(this._elementRef.nativeElement.type=this._type)}get value(){return this._inputValueAccessor.value}set value(t){t!==this.value&&(this._inputValueAccessor.value=t,this.stateChanges.next())}get readonly(){return this._readonly}set readonly(t){this._readonly=og(t)}ngAfterViewInit(){this._platform.isBrowser&&this._autofillMonitor.monitor(this._elementRef.nativeElement).subscribe(t=>{this.autofilled=t.isAutofilled,this.stateChanges.next()})}ngOnChanges(){this.stateChanges.next()}ngOnDestroy(){this.stateChanges.complete(),this._platform.isBrowser&&this._autofillMonitor.stopMonitoring(this._elementRef.nativeElement)}ngDoCheck(){this.ngControl&&this.updateErrorState(),this._dirtyCheckNativeValue(),this._dirtyCheckPlaceholder()}focus(t){this._elementRef.nativeElement.focus(t)}_focusChanged(t){t===this.focused||this.readonly&&t||(this.focused=t,this.stateChanges.next())}_onInput(){}_dirtyCheckPlaceholder(){const t=this._formField,e=t&&t._hideControlPlaceholder()?null:this.placeholder;if(e!==this._previousPlaceholder){const t=this._elementRef.nativeElement;this._previousPlaceholder=e,e?t.setAttribute("placeholder",e):t.removeAttribute("placeholder")}}_dirtyCheckNativeValue(){const t=this._elementRef.nativeElement.value;this._previousNativeValue!==t&&(this._previousNativeValue=t,this.stateChanges.next())}_validateType(){if(Cx.indexOf(this._type)>-1)throw Error(`Input type "${this._type}" isn't supported by matInput.`)}_isNeverEmpty(){return this._neverEmptyInputTypes.indexOf(this._type)>-1}_isBadInput(){let t=this._elementRef.nativeElement.validity;return t&&t.badInput}get empty(){return!(this._isNeverEmpty()||this._elementRef.nativeElement.value||this._isBadInput()||this.autofilled)}get shouldLabelFloat(){if(this._isNativeSelect){const t=this._elementRef.nativeElement,e=t.options[0];return this.focused||t.multiple||!this.empty||!!(t.selectedIndex>-1&&e&&e.label)}return this.focused||!this.empty}setDescribedByIds(t){this._ariaDescribedby=t.join(" ")}onContainerClick(){this.focused||this.focus()}}return t.\u0275fac=function(e){return new(e||t)(ka(ks),ka(Im),ka(Ff,10),ka(Tp,8),ka(Pp,8),ka(Ov),ka(_x,10),ka(wx),ka(sl),ka(Zb,8))},t.\u0275dir=we({type:t,selectors:[["input","matInput",""],["textarea","matInput",""],["select","matNativeControl",""],["input","matNativeControl",""],["textarea","matNativeControl",""]],hostAttrs:[1,"mat-input-element","mat-form-field-autofill-control"],hostVars:10,hostBindings:function(t,e){1&t&&Pa("focus",(function(){return e._focusChanged(!0)}))("blur",(function(){return e._focusChanged(!1)}))("input",(function(){return e._onInput()})),2&t&&(os("disabled",e.disabled)("required",e.required),wa("id",e.id)("data-placeholder",e.placeholder)("readonly",e.readonly&&!e._isNativeSelect||null)("aria-describedby",e._ariaDescribedby||null)("aria-invalid",e.errorState)("aria-required",e.required.toString()),Ya("mat-input-server",e._isServer))},inputs:{id:"id",disabled:"disabled",required:"required",type:"type",value:"value",readonly:"readonly",placeholder:"placeholder",errorStateMatcher:"errorStateMatcher"},exportAs:["matInput"],features:[ws([{provide:Lb,useExisting:t}]),us,Ie]}),t})(),Ax=(()=>{class t{}return t.\u0275mod=ve({type:t}),t.\u0275inj=dt({factory:function(e){return new(e||t)},providers:[Ov],imports:[[xx,Qb],xx,Qb]}),t})(),Nx=(()=>{class t{constructor(){this.changes=new C,this.calendarLabel="Calendar",this.openCalendarLabel="Open calendar",this.prevMonthLabel="Previous month",this.nextMonthLabel="Next month",this.prevYearLabel="Previous year",this.nextYearLabel="Next year",this.prevMultiYearLabel="Previous 20 years",this.nextMultiYearLabel="Next 20 years",this.switchToMonthViewLabel="Choose date",this.switchToMultiYearViewLabel="Choose month and year"}formatYearRange(t,e){return`${t} \u2013 ${e}`}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=ht({factory:function(){return new t},token:t,providedIn:"root"}),t})();class Tx{constructor(t,e){this.start=t,this.end=e}}const Dx=new Lt("MAT_DATE_RANGE_SELECTION_STRATEGY");let Rx=(()=>{class t{constructor(t){this._dateAdapter=t}selectionFinished(t,e){let{start:n,end:r}=e;return null==n?n=t:null==r&&t&&this._dateAdapter.compareDate(t,n)>=0?r=t:(n=t,r=null),new Tx(n,r)}createPreview(t,e){let n=null,r=null;return e.start&&!e.end&&t&&(n=e.start,r=t),new Tx(n,r)}}return t.\u0275fac=function(e){return new(e||t)(Kt(mv))},t.\u0275prov=ht({token:t,factory:t.\u0275fac}),t})();const Ix={provide:new Lt("mat-datepicker-scroll-strategy"),deps:[yb],useFactory:function(t){return()=>t.scrollStrategies.reposition()}};let Mx=(()=>{class t{}return t.\u0275mod=ve({type:t}),t.\u0275inj=dt({factory:function(e){return new(e||t)},providers:[Nx,Ix,{provide:Dx,useClass:Rx}],imports:[[xc,yw,vx,bb,Sg,Jy],ty]}),t})(),Fx=(()=>{class t{}return t.\u0275mod=ve({type:t}),t.\u0275inj=dt({factory:function(e){return new(e||t)},imports:[[uv],uv]}),t})(),Px=(()=>{class t{}return t.\u0275mod=ve({type:t}),t.\u0275inj=dt({factory:function(e){return new(e||t)}}),t})(),jx=(()=>{class t{}return t.\u0275mod=ve({type:t}),t.\u0275inj=dt({factory:function(e){return new(e||t)},imports:[[xc,Px,Jy]]}),t})(),zx=(()=>{class t{}return t.\u0275mod=ve({type:t}),t.\u0275inj=dt({factory:function(e){return new(e||t)},imports:[[Tv,uv],Tv,uv]}),t})();const Lx=[[["","mat-list-avatar",""],["","mat-list-icon",""],["","matListAvatar",""],["","matListIcon",""]],[["","mat-line",""],["","matLine",""]],"*"],Bx=["[mat-list-avatar], [mat-list-icon], [matListAvatar], [matListIcon]","[mat-line], [matLine]","*"];class Ux{}const $x=hv(Ux),Vx=new Lt("MatList"),Wx=new Lt("MatNavList");let qx=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275dir=we({type:t,selectors:[["","mat-list-avatar",""],["","matListAvatar",""]],hostAttrs:[1,"mat-list-avatar"]}),t})(),Hx=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275dir=we({type:t,selectors:[["","mat-list-icon",""],["","matListIcon",""]],hostAttrs:[1,"mat-list-icon"]}),t})(),Gx=(()=>{class t extends $x{constructor(t,e,n,r){super(),this._element=t,this._isInteractiveList=!1,this._destroyed=new C,this._disabled=!1,this._isInteractiveList=!!(n||r&&"action-list"===r._getListType()),this._list=n||r;const i=this._getHostElement();"button"!==i.nodeName.toLowerCase()||i.hasAttribute("type")||i.setAttribute("type","button"),this._list&&this._list._stateChanges.pipe(Pg(this._destroyed)).subscribe(()=>{e.markForCheck()})}get disabled(){return this._disabled||!(!this._list||!this._list.disabled)}set disabled(t){this._disabled=og(t)}ngAfterContentInit(){!function(t,e,n="mat"){t.changes.pipe(Ug(t)).subscribe(({length:t})=>{Nv(e,n+"-2-line",!1),Nv(e,n+"-3-line",!1),Nv(e,n+"-multi-line",!1),2===t||3===t?Nv(e,`${n}-${t}-line`,!0):t>3&&Nv(e,n+"-multi-line",!0)})}(this._lines,this._element)}ngOnDestroy(){this._destroyed.next(),this._destroyed.complete()}_isRippleDisabled(){return!this._isInteractiveList||this.disableRipple||!(!this._list||!this._list.disableRipple)}_getHostElement(){return this._element.nativeElement}}return t.\u0275fac=function(e){return new(e||t)(ka(ks),ka(Go),ka(Wx,8),ka(Vx,8))},t.\u0275cmp=pe({type:t,selectors:[["mat-list-item"],["a","mat-list-item",""],["button","mat-list-item",""]],contentQueries:function(t,e,n){var r;1&t&&(Iu(n,qx,!0),Iu(n,Hx,!0),Iu(n,Av,!0)),2&t&&(Nu(r=Pu())&&(e._avatar=r.first),Nu(r=Pu())&&(e._icon=r.first),Nu(r=Pu())&&(e._lines=r))},hostAttrs:[1,"mat-list-item","mat-focus-indicator"],hostVars:6,hostBindings:function(t,e){2&t&&Ya("mat-list-item-disabled",e.disabled)("mat-list-item-avatar",e._avatar||e._icon)("mat-list-item-with-avatar",e._avatar||e._icon)},inputs:{disableRipple:"disableRipple",disabled:"disabled"},exportAs:["matListItem"],features:[us],ngContentSelectors:Bx,decls:6,vars:2,consts:[[1,"mat-list-item-content"],["mat-ripple","",1,"mat-list-item-ripple",3,"matRippleTrigger","matRippleDisabled"],[1,"mat-list-text"]],template:function(t,e){1&t&&(Va(Lx),Aa(0,"div",0),Ta(1,"div",1),Wa(2),Aa(3,"div",2),Wa(4,1),Na(),Wa(5,2),Na()),2&t&&(bi(1),Ea("matRippleTrigger",e._getHostElement())("matRippleDisabled",e._isRippleDisabled()))},directives:[zv],encapsulation:2,changeDetection:0}),t})(),Xx=(()=>{class t{}return t.\u0275mod=ve({type:t}),t.\u0275inj=dt({factory:function(e){return new(e||t)},imports:[[Tv,Lv,uv,Bv,xc],Tv,uv,Bv,Fx]}),t})();const Kx={provide:new Lt("mat-menu-scroll-strategy"),deps:[yb],useFactory:function(t){return()=>t.scrollStrategies.reposition()}};let Yx=(()=>{class t{}return t.\u0275mod=ve({type:t}),t.\u0275inj=dt({factory:function(e){return new(e||t)},providers:[Kx],imports:[uv]}),t})(),Zx=(()=>{class t{}return t.\u0275mod=ve({type:t}),t.\u0275inj=dt({factory:function(e){return new(e||t)},providers:[Kx],imports:[[xc,uv,Lv,bb,Yx],ty,uv,Yx]}),t})();const Qx={provide:new Lt("mat-select-scroll-strategy"),deps:[yb],useFactory:function(t){return()=>t.scrollStrategies.reposition()}};let Jx=(()=>{class t{}return t.\u0275mod=ve({type:t}),t.\u0275inj=dt({factory:function(e){return new(e||t)},providers:[Qx],imports:[[xc,bb,Uv,uv],ty,Qb,Uv,uv]}),t})();const t_={provide:new Lt("mat-tooltip-scroll-strategy"),deps:[yb],useFactory:function(t){return()=>t.scrollStrategies.reposition({scrollThrottle:20})}};let e_=(()=>{class t{}return t.\u0275mod=ve({type:t}),t.\u0275inj=dt({factory:function(e){return new(e||t)},providers:[t_],imports:[[Sg,xc,bb,uv],uv,ty]}),t})(),n_=(()=>{class t{constructor(){this.changes=new C,this.itemsPerPageLabel="Items per page:",this.nextPageLabel="Next page",this.previousPageLabel="Previous page",this.firstPageLabel="First page",this.lastPageLabel="Last page",this.getRangeLabel=(t,e,n)=>{if(0==n||0==e)return"0 of "+n;const r=t*e;return`${r+1} \u2013 ${r<(n=Math.max(n,0))?Math.min(r+e,n):r+e} of ${n}`}}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=ht({factory:function(){return new t},token:t,providedIn:"root"}),t})();const r_={provide:n_,deps:[[new ot,new st,n_]],useFactory:function(t){return t||new n_}};let i_=(()=>{class t{}return t.\u0275mod=ve({type:t}),t.\u0275inj=dt({factory:function(e){return new(e||t)},providers:[r_],imports:[[xc,yw,Jx,e_]]}),t})(),o_=(()=>{class t{}return t.\u0275mod=ve({type:t}),t.\u0275inj=dt({factory:function(e){return new(e||t)},imports:[[xc,uv],uv]}),t})(),a_=(()=>{class t{}return t.\u0275mod=ve({type:t}),t.\u0275inj=dt({factory:function(e){return new(e||t)},imports:[[uv,xc],uv]}),t})();const s_=["input"],u_=function(){return{enterDuration:150}},l_=["*"],c_=new Lt("mat-radio-default-options",{providedIn:"root",factory:function(){return{color:"accent"}}});let h_=0;class d_{constructor(t,e){this.source=t,this.value=e}}const f_=new Lt("MatRadioGroup");let p_=(()=>{class t{constructor(t){this._changeDetector=t,this._value=null,this._name="mat-radio-group-"+h_++,this._selected=null,this._isInitialized=!1,this._labelPosition="after",this._disabled=!1,this._required=!1,this._controlValueAccessorChangeFn=()=>{},this.onTouched=()=>{},this.change=new vu}get name(){return this._name}set name(t){this._name=t,this._updateRadioButtonNames()}get labelPosition(){return this._labelPosition}set labelPosition(t){this._labelPosition="before"===t?"before":"after",this._markRadiosForCheck()}get value(){return this._value}set value(t){this._value!==t&&(this._value=t,this._updateSelectedRadioFromValue(),this._checkSelectedRadioButton())}_checkSelectedRadioButton(){this._selected&&!this._selected.checked&&(this._selected.checked=!0)}get selected(){return this._selected}set selected(t){this._selected=t,this.value=t?t.value:null,this._checkSelectedRadioButton()}get disabled(){return this._disabled}set disabled(t){this._disabled=og(t),this._markRadiosForCheck()}get required(){return this._required}set required(t){this._required=og(t),this._markRadiosForCheck()}ngAfterContentInit(){this._isInitialized=!0}_touch(){this.onTouched&&this.onTouched()}_updateRadioButtonNames(){this._radios&&this._radios.forEach(t=>{t.name=this.name,t._markForCheck()})}_updateSelectedRadioFromValue(){this._radios&&(null===this._selected||this._selected.value!==this._value)&&(this._selected=null,this._radios.forEach(t=>{t.checked=this.value===t.value,t.checked&&(this._selected=t)}))}_emitChangeEvent(){this._isInitialized&&this.change.emit(new d_(this._selected,this._value))}_markRadiosForCheck(){this._radios&&this._radios.forEach(t=>t._markForCheck())}writeValue(t){this.value=t,this._changeDetector.markForCheck()}registerOnChange(t){this._controlValueAccessorChangeFn=t}registerOnTouched(t){this.onTouched=t}setDisabledState(t){this.disabled=t,this._changeDetector.markForCheck()}}return t.\u0275fac=function(e){return new(e||t)(ka(Go))},t.\u0275dir=we({type:t,inputs:{name:"name",labelPosition:"labelPosition",value:"value",selected:"selected",disabled:"disabled",required:"required",color:"color"},outputs:{change:"change"}}),t})();class m_{constructor(t){this._elementRef=t}}const g_=hv(dv(m_));let y_=(()=>{class t extends g_{constructor(t,e,n,r,i,o,a){super(e),this._changeDetector=n,this._focusMonitor=r,this._radioDispatcher=i,this._animationMode=o,this._providerOverride=a,this._uniqueId="mat-radio-"+ ++h_,this.id=this._uniqueId,this.change=new vu,this._checked=!1,this._value=null,this._removeUniqueSelectionListener=()=>{},this.radioGroup=t,this._removeUniqueSelectionListener=i.listen((t,e)=>{t!==this.id&&e===this.name&&(this.checked=!1)})}get checked(){return this._checked}set checked(t){const e=og(t);this._checked!==e&&(this._checked=e,e&&this.radioGroup&&this.radioGroup.value!==this.value?this.radioGroup.selected=this:!e&&this.radioGroup&&this.radioGroup.value===this.value&&(this.radioGroup.selected=null),e&&this._radioDispatcher.notify(this.id,this.name),this._changeDetector.markForCheck())}get value(){return this._value}set value(t){this._value!==t&&(this._value=t,null!==this.radioGroup&&(this.checked||(this.checked=this.radioGroup.value===t),this.checked&&(this.radioGroup.selected=this)))}get labelPosition(){return this._labelPosition||this.radioGroup&&this.radioGroup.labelPosition||"after"}set labelPosition(t){this._labelPosition=t}get disabled(){return this._disabled||null!==this.radioGroup&&this.radioGroup.disabled}set disabled(t){this._setDisabled(og(t))}get required(){return this._required||this.radioGroup&&this.radioGroup.required}set required(t){this._required=og(t)}get color(){return this._color||this.radioGroup&&this.radioGroup.color||this._providerOverride&&this._providerOverride.color||"accent"}set color(t){this._color=t}get inputId(){return(this.id||this._uniqueId)+"-input"}focus(t){this._focusMonitor.focusVia(this._inputElement,"keyboard",t)}_markForCheck(){this._changeDetector.markForCheck()}ngOnInit(){this.radioGroup&&(this.checked=this.radioGroup.value===this._value,this.name=this.radioGroup.name)}ngAfterViewInit(){this._focusMonitor.monitor(this._elementRef,!0).subscribe(t=>{!t&&this.radioGroup&&this.radioGroup._touch()})}ngOnDestroy(){this._focusMonitor.stopMonitoring(this._elementRef),this._removeUniqueSelectionListener()}_emitChangeEvent(){this.change.emit(new d_(this,this._value))}_isRippleDisabled(){return this.disableRipple||this.disabled}_onInputClick(t){t.stopPropagation()}_onInputChange(t){t.stopPropagation();const e=this.radioGroup&&this.value!==this.radioGroup.value;this.checked=!0,this._emitChangeEvent(),this.radioGroup&&(this.radioGroup._controlValueAccessorChangeFn(this.value),e&&this.radioGroup._emitChangeEvent())}_setDisabled(t){this._disabled!==t&&(this._disabled=t,this._changeDetector.markForCheck())}}return t.\u0275fac=function(e){return new(e||t)(ka(p_),ka(ks),ka(Go),ka(_g),ka(Zg),ka(String),ka(void 0))},t.\u0275dir=we({type:t,viewQuery:function(t,e){var n;1&t&&Du(s_,!0),2&t&&Nu(n=Pu())&&(e._inputElement=n.first)},inputs:{id:"id",checked:"checked",value:"value",labelPosition:"labelPosition",disabled:"disabled",required:"required",color:"color",name:"name",ariaLabel:["aria-label","ariaLabel"],ariaLabelledby:["aria-labelledby","ariaLabelledby"],ariaDescribedby:["aria-describedby","ariaDescribedby"]},outputs:{change:"change"},features:[us]}),t})(),v_=(()=>{class t extends y_{constructor(t,e,n,r,i,o,a){super(t,e,n,r,i,o,a)}}return t.\u0275fac=function(e){return new(e||t)(ka(f_,8),ka(ks),ka(Go),ka(_g),ka(Zg),ka(wf,8),ka(c_,8))},t.\u0275cmp=pe({type:t,selectors:[["mat-radio-button"]],hostAttrs:[1,"mat-radio-button"],hostVars:17,hostBindings:function(t,e){1&t&&Pa("focus",(function(){return e._inputElement.nativeElement.focus()})),2&t&&(wa("tabindex",-1)("id",e.id)("aria-label",null)("aria-labelledby",null)("aria-describedby",null),Ya("mat-radio-checked",e.checked)("mat-radio-disabled",e.disabled)("_mat-animation-noopable","NoopAnimations"===e._animationMode)("mat-primary","primary"===e.color)("mat-accent","accent"===e.color)("mat-warn","warn"===e.color))},inputs:{disableRipple:"disableRipple",tabIndex:"tabIndex"},exportAs:["matRadioButton"],features:[us],ngContentSelectors:l_,decls:13,vars:19,consts:[[1,"mat-radio-label"],["label",""],[1,"mat-radio-container"],[1,"mat-radio-outer-circle"],[1,"mat-radio-inner-circle"],["type","radio",1,"mat-radio-input","cdk-visually-hidden",3,"id","checked","disabled","tabIndex","required","change","click"],["input",""],["mat-ripple","",1,"mat-radio-ripple","mat-focus-indicator",3,"matRippleTrigger","matRippleDisabled","matRippleCentered","matRippleRadius","matRippleAnimation"],[1,"mat-ripple-element","mat-radio-persistent-ripple"],[1,"mat-radio-label-content"],[2,"display","none"]],template:function(t,e){if(1&t&&(Va(),Aa(0,"label",0,1),Aa(2,"div",2),Ta(3,"div",3),Ta(4,"div",4),Aa(5,"input",5,6),Pa("change",(function(t){return e._onInputChange(t)}))("click",(function(t){return e._onInputClick(t)})),Na(),Aa(7,"div",7),Ta(8,"div",8),Na(),Na(),Aa(9,"div",9),Aa(10,"span",10),es(11,"\xa0"),Na(),Wa(12),Na(),Na()),2&t){const t=Ca(1);wa("for",e.inputId),bi(5),Ea("id",e.inputId)("checked",e.checked)("disabled",e.disabled)("tabIndex",e.tabIndex)("required",e.required),wa("name",e.name)("value",e.value)("aria-label",e.ariaLabel)("aria-labelledby",e.ariaLabelledby)("aria-describedby",e.ariaDescribedby),bi(2),Ea("matRippleTrigger",t)("matRippleDisabled",e._isRippleDisabled())("matRippleCentered",!0)("matRippleRadius",20)("matRippleAnimation",mu(18,u_)),bi(2),Ya("mat-radio-label-before","before"==e.labelPosition)}},directives:[zv],styles:[".mat-radio-button{display:inline-block;-webkit-tap-highlight-color:transparent;outline:0}.mat-radio-label{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;cursor:pointer;display:inline-flex;align-items:center;white-space:nowrap;vertical-align:middle;width:100%}.mat-radio-container{box-sizing:border-box;display:inline-block;position:relative;width:20px;height:20px;flex-shrink:0}.mat-radio-outer-circle{box-sizing:border-box;height:20px;left:0;position:absolute;top:0;transition:border-color ease 280ms;width:20px;border-width:2px;border-style:solid;border-radius:50%}._mat-animation-noopable .mat-radio-outer-circle{transition:none}.mat-radio-inner-circle{border-radius:50%;box-sizing:border-box;height:20px;left:0;position:absolute;top:0;transition:transform ease 280ms,background-color ease 280ms;width:20px;transform:scale(0.001)}._mat-animation-noopable .mat-radio-inner-circle{transition:none}.mat-radio-checked .mat-radio-inner-circle{transform:scale(0.5)}.cdk-high-contrast-active .mat-radio-checked .mat-radio-inner-circle{border:solid 10px}.mat-radio-label-content{-webkit-user-select:auto;-moz-user-select:auto;-ms-user-select:auto;user-select:auto;display:inline-block;order:0;line-height:inherit;padding-left:8px;padding-right:0}[dir=rtl] .mat-radio-label-content{padding-right:8px;padding-left:0}.mat-radio-label-content.mat-radio-label-before{order:-1;padding-left:0;padding-right:8px}[dir=rtl] .mat-radio-label-content.mat-radio-label-before{padding-right:0;padding-left:8px}.mat-radio-disabled,.mat-radio-disabled .mat-radio-label{cursor:default}.mat-radio-button .mat-radio-ripple{position:absolute;left:calc(50% - 20px);top:calc(50% - 20px);height:40px;width:40px;z-index:1;pointer-events:none}.mat-radio-button .mat-radio-ripple .mat-ripple-element:not(.mat-radio-persistent-ripple){opacity:.16}.mat-radio-persistent-ripple{width:100%;height:100%;transform:none}.mat-radio-container:hover .mat-radio-persistent-ripple{opacity:.04}.mat-radio-button:not(.mat-radio-disabled).cdk-keyboard-focused .mat-radio-persistent-ripple,.mat-radio-button:not(.mat-radio-disabled).cdk-program-focused .mat-radio-persistent-ripple{opacity:.12}.mat-radio-persistent-ripple,.mat-radio-disabled .mat-radio-container:hover .mat-radio-persistent-ripple{opacity:0}@media(hover: none){.mat-radio-container:hover .mat-radio-persistent-ripple{display:none}}.mat-radio-input{bottom:0;left:50%}.cdk-high-contrast-active .mat-radio-disabled{opacity:.5}\n"],encapsulation:2,changeDetection:0}),t})(),b_=(()=>{class t{}return t.\u0275mod=ve({type:t}),t.\u0275inj=dt({factory:function(e){return new(e||t)},imports:[[Lv,uv],uv]}),t})(),w_=(()=>{class t{}return t.\u0275mod=ve({type:t}),t.\u0275inj=dt({factory:function(e){return new(e||t)},imports:[[xc,uv,Mm,ty],ty,uv]}),t})(),x_=(()=>{class t{}return t.\u0275mod=ve({type:t}),t.\u0275inj=dt({factory:function(e){return new(e||t)},imports:[[xc,uv],uv]}),t})();const __=["thumbContainer"],C_=["toggleBar"],k_=["input"],S_=function(){return{enterDuration:150}},E_=["*"],O_=new Lt("mat-slide-toggle-default-options",{providedIn:"root",factory:()=>({disableToggleValue:!1})});let A_=0;const N_={provide:Sf,useExisting:kt(()=>I_),multi:!0};class T_{constructor(t,e){this.source=t,this.checked=e}}class D_{constructor(t){this._elementRef=t}}const R_=dv(cv(hv(lv(D_)),"accent"));let I_=(()=>{class t extends R_{constructor(t,e,n,r,i,o){super(t),this._focusMonitor=e,this._changeDetectorRef=n,this.defaults=i,this._animationMode=o,this._onChange=t=>{},this._onTouched=()=>{},this._uniqueId="mat-slide-toggle-"+ ++A_,this._required=!1,this._checked=!1,this.name=null,this.id=this._uniqueId,this.labelPosition="after",this.ariaLabel=null,this.ariaLabelledby=null,this.change=new vu,this.toggleChange=new vu,this.tabIndex=parseInt(r)||0}get required(){return this._required}set required(t){this._required=og(t)}get checked(){return this._checked}set checked(t){this._checked=og(t),this._changeDetectorRef.markForCheck()}get inputId(){return(this.id||this._uniqueId)+"-input"}ngAfterContentInit(){this._focusMonitor.monitor(this._elementRef,!0).subscribe(t=>{"keyboard"===t||"program"===t?this._inputElement.nativeElement.focus():t||Promise.resolve().then(()=>this._onTouched())})}ngOnDestroy(){this._focusMonitor.stopMonitoring(this._elementRef)}_onChangeEvent(t){t.stopPropagation(),this.toggleChange.emit(),this.defaults.disableToggleValue?this._inputElement.nativeElement.checked=this.checked:(this.checked=this._inputElement.nativeElement.checked,this._emitChangeEvent())}_onInputClick(t){t.stopPropagation()}writeValue(t){this.checked=!!t}registerOnChange(t){this._onChange=t}registerOnTouched(t){this._onTouched=t}setDisabledState(t){this.disabled=t,this._changeDetectorRef.markForCheck()}focus(t){this._focusMonitor.focusVia(this._inputElement,"keyboard",t)}toggle(){this.checked=!this.checked,this._onChange(this.checked)}_emitChangeEvent(){this._onChange(this.checked),this.change.emit(new T_(this,this.checked))}_onLabelTextChange(){this._changeDetectorRef.detectChanges()}}return t.\u0275fac=function(e){return new(e||t)(ka(ks),ka(_g),ka(Go),Sa("tabindex"),ka(O_),ka(wf,8))},t.\u0275cmp=pe({type:t,selectors:[["mat-slide-toggle"]],viewQuery:function(t,e){var n;1&t&&(Du(__,!0),Du(C_,!0),Du(k_,!0)),2&t&&(Nu(n=Pu())&&(e._thumbEl=n.first),Nu(n=Pu())&&(e._thumbBarEl=n.first),Nu(n=Pu())&&(e._inputElement=n.first))},hostAttrs:[1,"mat-slide-toggle"],hostVars:12,hostBindings:function(t,e){2&t&&(os("id",e.id),wa("tabindex",e.disabled?null:-1)("aria-label",null)("aria-labelledby",null),Ya("mat-checked",e.checked)("mat-disabled",e.disabled)("mat-slide-toggle-label-before","before"==e.labelPosition)("_mat-animation-noopable","NoopAnimations"===e._animationMode))},inputs:{disabled:"disabled",disableRipple:"disableRipple",color:"color",tabIndex:"tabIndex",name:"name",id:"id",labelPosition:"labelPosition",ariaLabel:["aria-label","ariaLabel"],ariaLabelledby:["aria-labelledby","ariaLabelledby"],required:"required",checked:"checked"},outputs:{change:"change",toggleChange:"toggleChange"},exportAs:["matSlideToggle"],features:[ws([N_]),us],ngContentSelectors:E_,decls:16,vars:18,consts:[[1,"mat-slide-toggle-label"],["label",""],[1,"mat-slide-toggle-bar"],["toggleBar",""],["type","checkbox","role","switch",1,"mat-slide-toggle-input","cdk-visually-hidden",3,"id","required","tabIndex","checked","disabled","change","click"],["input",""],[1,"mat-slide-toggle-thumb-container"],["thumbContainer",""],[1,"mat-slide-toggle-thumb"],["mat-ripple","",1,"mat-slide-toggle-ripple","mat-focus-indicator",3,"matRippleTrigger","matRippleDisabled","matRippleCentered","matRippleRadius","matRippleAnimation"],[1,"mat-ripple-element","mat-slide-toggle-persistent-ripple"],[1,"mat-slide-toggle-content",3,"cdkObserveContent"],["labelContent",""],[2,"display","none"]],template:function(t,e){if(1&t&&(Va(),Aa(0,"label",0,1),Aa(2,"div",2,3),Aa(4,"input",4,5),Pa("change",(function(t){return e._onChangeEvent(t)}))("click",(function(t){return e._onInputClick(t)})),Na(),Aa(6,"div",6,7),Ta(8,"div",8),Aa(9,"div",9),Ta(10,"div",10),Na(),Na(),Na(),Aa(11,"span",11,12),Pa("cdkObserveContent",(function(){return e._onLabelTextChange()})),Aa(13,"span",13),es(14,"\xa0"),Na(),Wa(15),Na(),Na()),2&t){const t=Ca(1),n=Ca(12);wa("for",e.inputId),bi(2),Ya("mat-slide-toggle-bar-no-side-margin",!n.textContent||!n.textContent.trim()),bi(2),Ea("id",e.inputId)("required",e.required)("tabIndex",e.tabIndex)("checked",e.checked)("disabled",e.disabled),wa("name",e.name)("aria-checked",e.checked.toString())("aria-label",e.ariaLabel)("aria-labelledby",e.ariaLabelledby),bi(5),Ea("matRippleTrigger",t)("matRippleDisabled",e.disableRipple||e.disabled)("matRippleCentered",!0)("matRippleRadius",20)("matRippleAnimation",mu(17,S_))}},directives:[zv,dg],styles:[".mat-slide-toggle{display:inline-block;height:24px;max-width:100%;line-height:24px;white-space:nowrap;outline:none;-webkit-tap-highlight-color:transparent}.mat-slide-toggle.mat-checked .mat-slide-toggle-thumb-container{transform:translate3d(16px, 0, 0)}[dir=rtl] .mat-slide-toggle.mat-checked .mat-slide-toggle-thumb-container{transform:translate3d(-16px, 0, 0)}.mat-slide-toggle.mat-disabled{opacity:.38}.mat-slide-toggle.mat-disabled .mat-slide-toggle-label,.mat-slide-toggle.mat-disabled .mat-slide-toggle-thumb-container{cursor:default}.mat-slide-toggle-label{display:flex;flex:1;flex-direction:row;align-items:center;height:inherit;cursor:pointer}.mat-slide-toggle-content{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.mat-slide-toggle-label-before .mat-slide-toggle-label{order:1}.mat-slide-toggle-label-before .mat-slide-toggle-bar{order:2}[dir=rtl] .mat-slide-toggle-label-before .mat-slide-toggle-bar,.mat-slide-toggle-bar{margin-right:8px;margin-left:0}[dir=rtl] .mat-slide-toggle-bar,.mat-slide-toggle-label-before .mat-slide-toggle-bar{margin-left:8px;margin-right:0}.mat-slide-toggle-bar-no-side-margin{margin-left:0;margin-right:0}.mat-slide-toggle-thumb-container{position:absolute;z-index:1;width:20px;height:20px;top:-3px;left:0;transform:translate3d(0, 0, 0);transition:all 80ms linear;transition-property:transform}._mat-animation-noopable .mat-slide-toggle-thumb-container{transition:none}[dir=rtl] .mat-slide-toggle-thumb-container{left:auto;right:0}.mat-slide-toggle-thumb{height:20px;width:20px;border-radius:50%}.mat-slide-toggle-bar{position:relative;width:36px;height:14px;flex-shrink:0;border-radius:8px}.mat-slide-toggle-input{bottom:0;left:10px}[dir=rtl] .mat-slide-toggle-input{left:auto;right:10px}.mat-slide-toggle-bar,.mat-slide-toggle-thumb{transition:all 80ms linear;transition-property:background-color;transition-delay:50ms}._mat-animation-noopable .mat-slide-toggle-bar,._mat-animation-noopable .mat-slide-toggle-thumb{transition:none}.mat-slide-toggle .mat-slide-toggle-ripple{position:absolute;top:calc(50% - 20px);left:calc(50% - 20px);height:40px;width:40px;z-index:1;pointer-events:none}.mat-slide-toggle .mat-slide-toggle-ripple .mat-ripple-element:not(.mat-slide-toggle-persistent-ripple){opacity:.12}.mat-slide-toggle-persistent-ripple{width:100%;height:100%;transform:none}.mat-slide-toggle-bar:hover .mat-slide-toggle-persistent-ripple{opacity:.04}.mat-slide-toggle:not(.mat-disabled).cdk-keyboard-focused .mat-slide-toggle-persistent-ripple{opacity:.12}.mat-slide-toggle-persistent-ripple,.mat-slide-toggle.mat-disabled .mat-slide-toggle-bar:hover .mat-slide-toggle-persistent-ripple{opacity:0}@media(hover: none){.mat-slide-toggle-bar:hover .mat-slide-toggle-persistent-ripple{display:none}}.cdk-high-contrast-active .mat-slide-toggle-thumb,.cdk-high-contrast-active .mat-slide-toggle-bar{border:1px solid}.cdk-high-contrast-active .mat-slide-toggle.cdk-keyboard-focused .mat-slide-toggle-bar{outline:2px dotted;outline-offset:5px}\n"],encapsulation:2,changeDetection:0}),t})(),M_=(()=>{class t{}return t.\u0275mod=ve({type:t}),t.\u0275inj=dt({factory:function(e){return new(e||t)}}),t})(),F_=(()=>{class t{}return t.\u0275mod=ve({type:t}),t.\u0275inj=dt({factory:function(e){return new(e||t)},imports:[[M_,Lv,uv,fg],M_,uv]}),t})(),P_=(()=>{class t{}return t.\u0275mod=ve({type:t}),t.\u0275inj=dt({factory:function(e){return new(e||t)},imports:[[bb,Jy,xc,yw,uv],uv]}),t})(),j_=(()=>{class t{constructor(){this.changes=new C,this.sortButtonLabel=t=>"Change sorting for "+t}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=ht({factory:function(){return new t},token:t,providedIn:"root"}),t})();const z_={provide:j_,deps:[[new ot,new st,j_]],useFactory:function(t){return t||new j_}};let L_=(()=>{class t{}return t.\u0275mod=ve({type:t}),t.\u0275inj=dt({factory:function(e){return new(e||t)},providers:[z_],imports:[[xc]]}),t})(),B_=(()=>{class t{}return t.\u0275mod=ve({type:t}),t.\u0275inj=dt({factory:function(e){return new(e||t)},imports:[[nv,uv],uv]}),t})(),U_=(()=>{class t{}return t.\u0275mod=ve({type:t}),t.\u0275inj=dt({factory:function(e){return new(e||t)},imports:[[xc,uv,Jy,Lv,fg,Sg],uv]}),t})();const $_=["*",[["mat-toolbar-row"]]],V_=["*","mat-toolbar-row"];class W_{constructor(t){this._elementRef=t}}const q_=cv(W_);let H_=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275dir=we({type:t,selectors:[["mat-toolbar-row"]],hostAttrs:[1,"mat-toolbar-row"],exportAs:["matToolbarRow"]}),t})(),G_=(()=>{class t extends q_{constructor(t,e,n){super(t),this._platform=e,this._document=n}ngAfterViewInit(){Nr()&&this._platform.isBrowser&&(this._checkToolbarMixedModes(),this._toolbarRows.changes.subscribe(()=>this._checkToolbarMixedModes()))}_checkToolbarMixedModes(){this._toolbarRows.length&&Array.from(this._elementRef.nativeElement.childNodes).filter(t=>!(t.classList&&t.classList.contains("mat-toolbar-row"))).filter(t=>t.nodeType!==(this._document?this._document.COMMENT_NODE:8)).some(t=>!(!t.textContent||!t.textContent.trim()))&&function(){throw Error("MatToolbar: Attempting to combine different toolbar modes. Either specify multiple `<mat-toolbar-row>` elements explicitly or just place content inside of a `<mat-toolbar>` for a single row.")}()}}return t.\u0275fac=function(e){return new(e||t)(ka(ks),ka(Im),ka(zl))},t.\u0275cmp=pe({type:t,selectors:[["mat-toolbar"]],contentQueries:function(t,e,n){var r;1&t&&Iu(n,H_,!0),2&t&&Nu(r=Pu())&&(e._toolbarRows=r)},hostAttrs:[1,"mat-toolbar"],hostVars:4,hostBindings:function(t,e){2&t&&Ya("mat-toolbar-multiple-rows",e._toolbarRows.length>0)("mat-toolbar-single-row",0===e._toolbarRows.length)},inputs:{color:"color"},exportAs:["matToolbar"],features:[us],ngContentSelectors:V_,decls:2,vars:0,template:function(t,e){1&t&&(Va($_),Wa(0),Wa(1,1))},styles:[".cdk-high-contrast-active .mat-toolbar{outline:solid 1px}.mat-toolbar-row,.mat-toolbar-single-row{display:flex;box-sizing:border-box;padding:0 16px;width:100%;flex-direction:row;align-items:center;white-space:nowrap}.mat-toolbar-multiple-rows{display:flex;box-sizing:border-box;flex-direction:column;width:100%}\n"],encapsulation:2,changeDetection:0}),t})(),X_=(()=>{class t{}return t.\u0275mod=ve({type:t}),t.\u0275inj=dt({factory:function(e){return new(e||t)},imports:[[uv],uv]}),t})(),K_=(()=>{class t{}return t.\u0275mod=ve({type:t}),t.\u0275inj=dt({factory:function(e){return new(e||t)},imports:[[iv,uv],uv]}),t})();const Y_={provide:Gu,useFactory:function(t,e){return()=>{if(_c(e)){const e=Array.from(t.querySelectorAll(`[class*=${Z_}]`)),n=/\bflex-layout-.+?\b/g;e.forEach(t=>{t.classList.contains(Z_+"ssr")&&t.parentNode?t.parentNode.removeChild(t):t.className.replace(n,"")})}}},deps:[zl,Hu],multi:!0},Z_="flex-layout-";let Q_=(()=>{class t{}return t.\u0275mod=ve({type:t}),t.\u0275inj=dt({factory:function(e){return new(e||t)},providers:[Y_]}),t})();const J_={addFlexToParent:!0,addOrientationBps:!1,disableDefaultBps:!1,disableVendorPrefixes:!1,serverLoaded:!1,useColumnBasisZero:!0,printWithBreakpoints:[],mediaTriggerAutoRestore:!0,ssrObserveBreakpoints:[]},tC=new Lt("Flex Layout token, config options for the library",{providedIn:"root",factory:()=>J_}),eC=new Lt("FlexLayoutServerLoaded",{providedIn:"root",factory:()=>!1}),nC=new Lt("Flex Layout token, collect all breakpoints into one provider",{providedIn:"root",factory:()=>null});let rC=(()=>{class t{}return t.\u0275mod=ve({type:t}),t.\u0275inj=dt({factory:function(e){return new(e||t)},imports:[[Q_]]}),t})(),iC=(()=>{class t{}return t.\u0275mod=ve({type:t}),t.\u0275inj=dt({factory:function(e){return new(e||t)},imports:[[Q_,Yg]]}),t})(),oC=(()=>{class t{}return t.\u0275mod=ve({type:t}),t.\u0275inj=dt({factory:function(e){return new(e||t)},imports:[[Q_]]}),t})(),aC=(()=>{class t{constructor(t,e){(function(t){return"server"===t})(e)&&!t&&console.warn("Warning: Flex Layout loaded on the server without FlexLayoutServerModule")}static withConfig(e,n=[]){return{ngModule:t,providers:e.serverLoaded?[{provide:tC,useValue:Object.assign(Object.assign({},J_),e)},{provide:nC,useValue:n,multi:!0},{provide:eC,useValue:!0}]:[{provide:tC,useValue:Object.assign(Object.assign({},J_),e)},{provide:nC,useValue:n,multi:!0}]}}}return t.\u0275mod=ve({type:t}),t.\u0275inj=dt({factory:function(e){return new(e||t)(Kt(eC),Kt(Hu))},imports:[[iC,rC,oC],iC,rC,oC]}),t})();n("yLV6");const sC=(()=>{function t(){return Error.call(this),this.message="no elements in sequence",this.name="EmptyError",this}return t.prototype=Object.create(Error.prototype),t})();function uC(t){return function(e){return 0===t?eg():e.lift(new lC(t))}}class lC{constructor(t){if(this.total=t,this.total<0)throw new Jm}call(t,e){return e.subscribe(new cC(t,this.total))}}class cC extends p{constructor(t,e){super(t),this.total=e,this.ring=new Array,this.count=0}_next(t){const e=this.ring,n=this.total,r=this.count++;e.length<n?e.push(t):e[r%n]=t}_complete(){const t=this.destination;let e=this.count;if(e>0){const n=this.count>=this.total?this.total:this.count,r=this.ring;for(let i=0;i<n;i++){const i=e++%n;t.next(r[i])}}t.complete()}}function hC(t=pC){return e=>e.lift(new dC(t))}class dC{constructor(t){this.errorFactory=t}call(t,e){return e.subscribe(new fC(t,this.errorFactory))}}class fC extends p{constructor(t,e){super(t),this.errorFactory=e,this.hasValue=!1}_next(t){this.hasValue=!0,this.destination.next(t)}_complete(){if(this.hasValue)return this.destination.complete();{let e;try{e=this.errorFactory()}catch(t){e=t}this.destination.error(e)}}}function pC(){return new sC}function mC(t=null){return e=>e.lift(new gC(t))}class gC{constructor(t){this.defaultValue=t}call(t,e){return e.subscribe(new yC(t,this.defaultValue))}}class yC extends p{constructor(t,e){super(t),this.defaultValue=e,this.isEmpty=!0}_next(t){this.isEmpty=!1,this.destination.next(t)}_complete(){this.isEmpty&&this.destination.next(this.defaultValue),this.destination.complete()}}function vC(t,e){const n=arguments.length>=2;return r=>r.pipe(t?Yp((e,n)=>t(e,n,r)):y,ng(1),n?mC(e):hC(()=>new sC))}class bC{constructor(t,e,n){this.predicate=t,this.thisArg=e,this.source=n}call(t,e){return e.subscribe(new wC(t,this.predicate,this.thisArg,this.source))}}class wC extends p{constructor(t,e,n,r){super(t),this.predicate=e,this.thisArg=n,this.source=r,this.index=0,this.thisArg=n||this}notifyComplete(t){this.destination.next(t),this.destination.complete()}_next(t){let e=!1;try{e=this.predicate.call(this.thisArg,t,this.index++,this.source)}catch(n){return void this.destination.error(n)}e||this.notifyComplete(!1)}_complete(){this.notifyComplete(!0)}}class xC{constructor(t,e,n=!1){this.accumulator=t,this.seed=e,this.hasSeed=n}call(t,e){return e.subscribe(new _C(t,this.accumulator,this.seed,this.hasSeed))}}class _C extends p{constructor(t,e,n,r){super(t),this.accumulator=e,this._seed=n,this.hasSeed=r,this.index=0}get seed(){return this._seed}set seed(t){this.hasSeed=!0,this._seed=t}_next(t){if(this.hasSeed)return this._tryNext(t);this.seed=t,this.destination.next(t)}_tryNext(t){const e=this.index++;let n;try{n=this.accumulator(this.seed,t,e)}catch(r){this.destination.error(r)}this.seed=n,this.destination.next(n)}}class CC{constructor(t,e){this.id=t,this.url=e}}class kC extends CC{constructor(t,e,n="imperative",r=null){super(t,e),this.navigationTrigger=n,this.restoredState=r}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}}class SC extends CC{constructor(t,e,n){super(t,e),this.urlAfterRedirects=n}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}}class EC extends CC{constructor(t,e,n){super(t,e),this.reason=n}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}}class OC extends CC{constructor(t,e,n){super(t,e),this.error=n}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}}class AC extends CC{constructor(t,e,n,r){super(t,e),this.urlAfterRedirects=n,this.state=r}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class NC extends CC{constructor(t,e,n,r){super(t,e),this.urlAfterRedirects=n,this.state=r}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class TC extends CC{constructor(t,e,n,r,i){super(t,e),this.urlAfterRedirects=n,this.state=r,this.shouldActivate=i}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}}class DC extends CC{constructor(t,e,n,r){super(t,e),this.urlAfterRedirects=n,this.state=r}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class RC extends CC{constructor(t,e,n,r){super(t,e),this.urlAfterRedirects=n,this.state=r}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class IC{constructor(t){this.route=t}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}}class MC{constructor(t){this.route=t}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}}class FC{constructor(t){this.snapshot=t}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class PC{constructor(t){this.snapshot=t}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class jC{constructor(t){this.snapshot=t}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class zC{constructor(t){this.snapshot=t}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class LC{constructor(t,e,n){this.routerEvent=t,this.position=e,this.anchor=n}toString(){return`Scroll(anchor: '${this.anchor}', position: '${this.position?`${this.position[0]}, ${this.position[1]}`:null}')`}}class BC{constructor(t){this.params=t||{}}has(t){return Object.prototype.hasOwnProperty.call(this.params,t)}get(t){if(this.has(t)){const e=this.params[t];return Array.isArray(e)?e[0]:e}return null}getAll(t){if(this.has(t)){const e=this.params[t];return Array.isArray(e)?e:[e]}return[]}get keys(){return Object.keys(this.params)}}function UC(t){return new BC(t)}function $C(t){const e=Error("NavigationCancelingError: "+t);return e.ngNavigationCancelingError=!0,e}function VC(t,e,n){const r=n.path.split("/");if(r.length>t.length)return null;if("full"===n.pathMatch&&(e.hasChildren()||r.length<t.length))return null;const i={};for(let o=0;o<r.length;o++){const e=r[o],n=t[o];if(e.startsWith(":"))i[e.substring(1)]=n;else if(e!==n.path)return null}return{consumed:t.slice(0,r.length),posParams:i}}function WC(t,e){const n=Object.keys(t),r=Object.keys(e);if(!n||!r||n.length!=r.length)return!1;let i;for(let o=0;o<n.length;o++)if(i=n[o],!qC(t[i],e[i]))return!1;return!0}function qC(t,e){return Array.isArray(t)&&Array.isArray(e)?t.length==e.length&&t.every(t=>e.indexOf(t)>-1):t===e}function HC(t){return Array.prototype.concat.apply([],t)}function GC(t){return t.length>0?t[t.length-1]:null}function XC(t,e){for(const n in t)t.hasOwnProperty(n)&&e(t[n],n)}function KC(t){return Fa(t)?t:Ma(t)?L(Promise.resolve(t)):Xp(t)}function YC(t,e,n){return n?function(t,e){return WC(t,e)}(t.queryParams,e.queryParams)&&function t(e,n){if(!tk(e.segments,n.segments))return!1;if(e.numberOfChildren!==n.numberOfChildren)return!1;for(const r in n.children){if(!e.children[r])return!1;if(!t(e.children[r],n.children[r]))return!1}return!0}(t.root,e.root):function(t,e){return Object.keys(e).length<=Object.keys(t).length&&Object.keys(e).every(n=>qC(t[n],e[n]))}(t.queryParams,e.queryParams)&&function t(e,n){return function e(n,r,i){if(n.segments.length>i.length)return!!tk(n.segments.slice(0,i.length),i)&&!r.hasChildren();if(n.segments.length===i.length){if(!tk(n.segments,i))return!1;for(const e in r.children){if(!n.children[e])return!1;if(!t(n.children[e],r.children[e]))return!1}return!0}{const t=i.slice(0,n.segments.length),o=i.slice(n.segments.length);return!!tk(n.segments,t)&&!!n.children.primary&&e(n.children.primary,r,o)}}(e,n,n.segments)}(t.root,e.root)}class ZC{constructor(t,e,n){this.root=t,this.queryParams=e,this.fragment=n}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=UC(this.queryParams)),this._queryParamMap}toString(){return ik.serialize(this)}}class QC{constructor(t,e){this.segments=t,this.children=e,this.parent=null,XC(e,(t,e)=>t.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return ok(this)}}class JC{constructor(t,e){this.path=t,this.parameters=e}get parameterMap(){return this._parameterMap||(this._parameterMap=UC(this.parameters)),this._parameterMap}toString(){return hk(this)}}function tk(t,e){return t.length===e.length&&t.every((t,n)=>t.path===e[n].path)}function ek(t,e){let n=[];return XC(t.children,(t,r)=>{"primary"===r&&(n=n.concat(e(t,r)))}),XC(t.children,(t,r)=>{"primary"!==r&&(n=n.concat(e(t,r)))}),n}class nk{}class rk{parse(t){const e=new gk(t);return new ZC(e.parseRootSegment(),e.parseQueryParams(),e.parseFragment())}serialize(t){return`${"/"+function t(e,n){if(!e.hasChildren())return ok(e);if(n){const n=e.children.primary?t(e.children.primary,!1):"",r=[];return XC(e.children,(e,n)=>{"primary"!==n&&r.push(`${n}:${t(e,!1)}`)}),r.length>0?`${n}(${r.join("//")})`:n}{const n=ek(e,(n,r)=>"primary"===r?[t(e.children.primary,!1)]:[`${r}:${t(n,!1)}`]);return`${ok(e)}/(${n.join("//")})`}}(t.root,!0)}${function(t){const e=Object.keys(t).map(e=>{const n=t[e];return Array.isArray(n)?n.map(t=>`${sk(e)}=${sk(t)}`).join("&"):`${sk(e)}=${sk(n)}`});return e.length?"?"+e.join("&"):""}(t.queryParams)}${"string"==typeof t.fragment?"#"+encodeURI(t.fragment):""}`}}const ik=new rk;function ok(t){return t.segments.map(t=>hk(t)).join("/")}function ak(t){return encodeURIComponent(t).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function sk(t){return ak(t).replace(/%3B/gi,";")}function uk(t){return ak(t).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function lk(t){return decodeURIComponent(t)}function ck(t){return lk(t.replace(/\+/g,"%20"))}function hk(t){return`${uk(t.path)}${e=t.parameters,Object.keys(e).map(t=>`;${uk(t)}=${uk(e[t])}`).join("")}`;var e}const dk=/^[^\/()?;=#]+/;function fk(t){const e=t.match(dk);return e?e[0]:""}const pk=/^[^=?&#]+/,mk=/^[^?&#]+/;class gk{constructor(t){this.url=t,this.remaining=t}parseRootSegment(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new QC([],{}):new QC([],this.parseChildren())}parseQueryParams(){const t={};if(this.consumeOptional("?"))do{this.parseQueryParam(t)}while(this.consumeOptional("&"));return t}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(""===this.remaining)return{};this.consumeOptional("/");const t=[];for(this.peekStartsWith("(")||t.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),t.push(this.parseSegment());let e={};this.peekStartsWith("/(")&&(this.capture("/"),e=this.parseParens(!0));let n={};return this.peekStartsWith("(")&&(n=this.parseParens(!1)),(t.length>0||Object.keys(e).length>0)&&(n.primary=new QC(t,e)),n}parseSegment(){const t=fk(this.remaining);if(""===t&&this.peekStartsWith(";"))throw new Error(`Empty path url segment cannot have parameters: '${this.remaining}'.`);return this.capture(t),new JC(lk(t),this.parseMatrixParams())}parseMatrixParams(){const t={};for(;this.consumeOptional(";");)this.parseParam(t);return t}parseParam(t){const e=fk(this.remaining);if(!e)return;this.capture(e);let n="";if(this.consumeOptional("=")){const t=fk(this.remaining);t&&(n=t,this.capture(n))}t[lk(e)]=lk(n)}parseQueryParam(t){const e=function(t){const e=t.match(pk);return e?e[0]:""}(this.remaining);if(!e)return;this.capture(e);let n="";if(this.consumeOptional("=")){const t=function(t){const e=t.match(mk);return e?e[0]:""}(this.remaining);t&&(n=t,this.capture(n))}const r=ck(e),i=ck(n);if(t.hasOwnProperty(r)){let e=t[r];Array.isArray(e)||(e=[e],t[r]=e),e.push(i)}else t[r]=i}parseParens(t){const e={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){const n=fk(this.remaining),r=this.remaining[n.length];if("/"!==r&&")"!==r&&";"!==r)throw new Error(`Cannot parse url '${this.url}'`);let i=void 0;n.indexOf(":")>-1?(i=n.substr(0,n.indexOf(":")),this.capture(i),this.capture(":")):t&&(i="primary");const o=this.parseChildren();e[i]=1===Object.keys(o).length?o.primary:new QC([],o),this.consumeOptional("//")}return e}peekStartsWith(t){return this.remaining.startsWith(t)}consumeOptional(t){return!!this.peekStartsWith(t)&&(this.remaining=this.remaining.substring(t.length),!0)}capture(t){if(!this.consumeOptional(t))throw new Error(`Expected "${t}".`)}}class yk{constructor(t){this._root=t}get root(){return this._root.value}parent(t){const e=this.pathFromRoot(t);return e.length>1?e[e.length-2]:null}children(t){const e=vk(t,this._root);return e?e.children.map(t=>t.value):[]}firstChild(t){const e=vk(t,this._root);return e&&e.children.length>0?e.children[0].value:null}siblings(t){const e=bk(t,this._root);return e.length<2?[]:e[e.length-2].children.map(t=>t.value).filter(e=>e!==t)}pathFromRoot(t){return bk(t,this._root).map(t=>t.value)}}function vk(t,e){if(t===e.value)return e;for(const n of e.children){const e=vk(t,n);if(e)return e}return null}function bk(t,e){if(t===e.value)return[e];for(const n of e.children){const r=bk(t,n);if(r.length)return r.unshift(e),r}return[]}class wk{constructor(t,e){this.value=t,this.children=e}toString(){return`TreeNode(${this.value})`}}function xk(t){const e={};return t&&t.children.forEach(t=>e[t.value.outlet]=t),e}class _k extends yk{constructor(t,e){super(t),this.snapshot=e,Ak(this,t)}toString(){return this.snapshot.toString()}}function Ck(t,e){const n=function(t,e){const n=new Ek([],{},{},"",{},"primary",e,null,t.root,-1,{});return new Ok("",new wk(n,[]))}(t,e),r=new ev([new JC("",{})]),i=new ev({}),o=new ev({}),a=new ev({}),s=new ev(""),u=new kk(r,i,a,s,o,"primary",e,n.root);return u.snapshot=n.root,new _k(new wk(u,[]),n)}class kk{constructor(t,e,n,r,i,o,a,s){this.url=t,this.params=e,this.queryParams=n,this.fragment=r,this.data=i,this.outlet=o,this.component=a,this._futureSnapshot=s}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=this.params.pipe(F(t=>UC(t)))),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=this.queryParams.pipe(F(t=>UC(t)))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}}function Sk(t,e="emptyOnly"){const n=t.pathFromRoot;let r=0;if("always"!==e)for(r=n.length-1;r>=1;){const t=n[r],e=n[r-1];if(t.routeConfig&&""===t.routeConfig.path)r--;else{if(e.component)break;r--}}return function(t){return t.reduce((t,e)=>({params:Object.assign(Object.assign({},t.params),e.params),data:Object.assign(Object.assign({},t.data),e.data),resolve:Object.assign(Object.assign({},t.resolve),e._resolvedData)}),{params:{},data:{},resolve:{}})}(n.slice(r))}class Ek{constructor(t,e,n,r,i,o,a,s,u,l,c){this.url=t,this.params=e,this.queryParams=n,this.fragment=r,this.data=i,this.outlet=o,this.component=a,this.routeConfig=s,this._urlSegment=u,this._lastPathIndex=l,this._resolve=c}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=UC(this.params)),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=UC(this.queryParams)),this._queryParamMap}toString(){return`Route(url:'${this.url.map(t=>t.toString()).join("/")}', path:'${this.routeConfig?this.routeConfig.path:""}')`}}class Ok extends yk{constructor(t,e){super(e),this.url=t,Ak(this,e)}toString(){return Nk(this._root)}}function Ak(t,e){e.value._routerState=t,e.children.forEach(e=>Ak(t,e))}function Nk(t){const e=t.children.length>0?` { ${t.children.map(Nk).join(", ")} } `:"";return`${t.value}${e}`}function Tk(t){if(t.snapshot){const e=t.snapshot,n=t._futureSnapshot;t.snapshot=n,WC(e.queryParams,n.queryParams)||t.queryParams.next(n.queryParams),e.fragment!==n.fragment&&t.fragment.next(n.fragment),WC(e.params,n.params)||t.params.next(n.params),function(t,e){if(t.length!==e.length)return!1;for(let n=0;n<t.length;++n)if(!WC(t[n],e[n]))return!1;return!0}(e.url,n.url)||t.url.next(n.url),WC(e.data,n.data)||t.data.next(n.data)}else t.snapshot=t._futureSnapshot,t.data.next(t._futureSnapshot.data)}function Dk(t,e){var n,r;return WC(t.params,e.params)&&tk(n=t.url,r=e.url)&&n.every((t,e)=>WC(t.parameters,r[e].parameters))&&!(!t.parent!=!e.parent)&&(!t.parent||Dk(t.parent,e.parent))}function Rk(t){return"object"==typeof t&&null!=t&&!t.outlets&&!t.segmentPath}function Ik(t,e,n,r,i){let o={};return r&&XC(r,(t,e)=>{o[e]=Array.isArray(t)?t.map(t=>""+t):""+t}),new ZC(n.root===t?e:function t(e,n,r){const i={};return XC(e.children,(e,o)=>{i[o]=e===n?r:t(e,n,r)}),new QC(e.segments,i)}(n.root,t,e),o,i)}class Mk{constructor(t,e,n){if(this.isAbsolute=t,this.numberOfDoubleDots=e,this.commands=n,t&&n.length>0&&Rk(n[0]))throw new Error("Root segment cannot have matrix parameters");const r=n.find(t=>"object"==typeof t&&null!=t&&t.outlets);if(r&&r!==GC(n))throw new Error("{outlets:{}} has to be the last command")}toRoot(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}class Fk{constructor(t,e,n){this.segmentGroup=t,this.processChildren=e,this.index=n}}function Pk(t){return"object"==typeof t&&null!=t&&t.outlets?t.outlets.primary:""+t}function jk(t,e,n){if(t||(t=new QC([],{})),0===t.segments.length&&t.hasChildren())return zk(t,e,n);const r=function(t,e,n){let r=0,i=e;const o={match:!1,pathIndex:0,commandIndex:0};for(;i<t.segments.length;){if(r>=n.length)return o;const e=t.segments[i],a=Pk(n[r]),s=r<n.length-1?n[r+1]:null;if(i>0&&void 0===a)break;if(a&&s&&"object"==typeof s&&void 0===s.outlets){if(!$k(a,s,e))return o;r+=2}else{if(!$k(a,{},e))return o;r++}i++}return{match:!0,pathIndex:i,commandIndex:r}}(t,e,n),i=n.slice(r.commandIndex);if(r.match&&r.pathIndex<t.segments.length){const e=new QC(t.segments.slice(0,r.pathIndex),{});return e.children.primary=new QC(t.segments.slice(r.pathIndex),t.children),zk(e,0,i)}return r.match&&0===i.length?new QC(t.segments,{}):r.match&&!t.hasChildren()?Lk(t,e,n):r.match?zk(t,0,i):Lk(t,e,n)}function zk(t,e,n){if(0===n.length)return new QC(t.segments,{});{const r=function(t){return"object"==typeof t[0]&&null!==t[0]&&t[0].outlets?t[0].outlets:{primary:t}}(n),i={};return XC(r,(n,r)=>{null!==n&&(i[r]=jk(t.children[r],e,n))}),XC(t.children,(t,e)=>{void 0===r[e]&&(i[e]=t)}),new QC(t.segments,i)}}function Lk(t,e,n){const r=t.segments.slice(0,e);let i=0;for(;i<n.length;){if("object"==typeof n[i]&&null!==n[i]&&void 0!==n[i].outlets){const t=Bk(n[i].outlets);return new QC(r,t)}if(0===i&&Rk(n[0])){r.push(new JC(t.segments[e].path,n[0])),i++;continue}const o=Pk(n[i]),a=i<n.length-1?n[i+1]:null;o&&a&&Rk(a)?(r.push(new JC(o,Uk(a))),i+=2):(r.push(new JC(o,{})),i++)}return new QC(r,{})}function Bk(t){const e={};return XC(t,(t,n)=>{null!==t&&(e[n]=Lk(new QC([],{}),0,t))}),e}function Uk(t){const e={};return XC(t,(t,n)=>e[n]=""+t),e}function $k(t,e,n){return t==n.path&&WC(e,n.parameters)}class Vk{constructor(t,e,n,r){this.routeReuseStrategy=t,this.futureState=e,this.currState=n,this.forwardEvent=r}activate(t){const e=this.futureState._root,n=this.currState?this.currState._root:null;this.deactivateChildRoutes(e,n,t),Tk(this.futureState.root),this.activateChildRoutes(e,n,t)}deactivateChildRoutes(t,e,n){const r=xk(e);t.children.forEach(t=>{const e=t.value.outlet;this.deactivateRoutes(t,r[e],n),delete r[e]}),XC(r,(t,e)=>{this.deactivateRouteAndItsChildren(t,n)})}deactivateRoutes(t,e,n){const r=t.value,i=e?e.value:null;if(r===i)if(r.component){const i=n.getContext(r.outlet);i&&this.deactivateChildRoutes(t,e,i.children)}else this.deactivateChildRoutes(t,e,n);else i&&this.deactivateRouteAndItsChildren(e,n)}deactivateRouteAndItsChildren(t,e){this.routeReuseStrategy.shouldDetach(t.value.snapshot)?this.detachAndStoreRouteSubtree(t,e):this.deactivateRouteAndOutlet(t,e)}detachAndStoreRouteSubtree(t,e){const n=e.getContext(t.value.outlet);if(n&&n.outlet){const e=n.outlet.detach(),r=n.children.onOutletDeactivated();this.routeReuseStrategy.store(t.value.snapshot,{componentRef:e,route:t,contexts:r})}}deactivateRouteAndOutlet(t,e){const n=e.getContext(t.value.outlet);if(n){const r=xk(t),i=t.value.component?n.children:e;XC(r,(t,e)=>this.deactivateRouteAndItsChildren(t,i)),n.outlet&&(n.outlet.deactivate(),n.children.onOutletDeactivated())}}activateChildRoutes(t,e,n){const r=xk(e);t.children.forEach(t=>{this.activateRoutes(t,r[t.value.outlet],n),this.forwardEvent(new zC(t.value.snapshot))}),t.children.length&&this.forwardEvent(new PC(t.value.snapshot))}activateRoutes(t,e,n){const r=t.value,i=e?e.value:null;if(Tk(r),r===i)if(r.component){const i=n.getOrCreateContext(r.outlet);this.activateChildRoutes(t,e,i.children)}else this.activateChildRoutes(t,e,n);else if(r.component){const e=n.getOrCreateContext(r.outlet);if(this.routeReuseStrategy.shouldAttach(r.snapshot)){const t=this.routeReuseStrategy.retrieve(r.snapshot);this.routeReuseStrategy.store(r.snapshot,null),e.children.onOutletReAttached(t.contexts),e.attachRef=t.componentRef,e.route=t.route.value,e.outlet&&e.outlet.attach(t.componentRef,t.route.value),Wk(t.route)}else{const n=function(t){for(let e=t.parent;e;e=e.parent){const t=e.routeConfig;if(t&&t._loadedConfig)return t._loadedConfig;if(t&&t.component)return null}return null}(r.snapshot),i=n?n.module.componentFactoryResolver:null;e.attachRef=null,e.route=r,e.resolver=i,e.outlet&&e.outlet.activateWith(r,i),this.activateChildRoutes(t,null,e.children)}}else this.activateChildRoutes(t,null,n)}}function Wk(t){Tk(t.value),t.children.forEach(Wk)}class qk{constructor(t,e){this.routes=t,this.module=e}}function Hk(t){return"function"==typeof t}function Gk(t){return t instanceof ZC}class Xk{constructor(t){this.segmentGroup=t||null}}class Kk{constructor(t){this.urlTree=t}}function Yk(t){return new v(e=>e.error(new Xk(t)))}function Zk(t){return new v(e=>e.error(new Kk(t)))}function Qk(t){return new v(e=>e.error(new Error(`Only absolute redirects can have named outlets. redirectTo: '${t}'`)))}class Jk{constructor(t,e,n,r,i){this.configLoader=e,this.urlSerializer=n,this.urlTree=r,this.config=i,this.allowRedirects=!0,this.ngModule=t.get(te)}apply(){return this.expandSegmentGroup(this.ngModule,this.config,this.urlTree.root,"primary").pipe(F(t=>this.createUrlTree(t,this.urlTree.queryParams,this.urlTree.fragment))).pipe(Mw(t=>{if(t instanceof Kk)return this.allowRedirects=!1,this.match(t.urlTree);if(t instanceof Xk)throw this.noMatchError(t);throw t}))}match(t){return this.expandSegmentGroup(this.ngModule,this.config,t.root,"primary").pipe(F(e=>this.createUrlTree(e,t.queryParams,t.fragment))).pipe(Mw(t=>{if(t instanceof Xk)throw this.noMatchError(t);throw t}))}noMatchError(t){return new Error(`Cannot match any routes. URL Segment: '${t.segmentGroup}'`)}createUrlTree(t,e,n){const r=t.segments.length>0?new QC([],{primary:t}):t;return new ZC(r,e,n)}expandSegmentGroup(t,e,n,r){return 0===n.segments.length&&n.hasChildren()?this.expandChildren(t,e,n).pipe(F(t=>new QC([],t))):this.expandSegment(t,n,e,n.segments,r,!0)}expandChildren(t,e,n){return function(t,e){if(0===Object.keys(t).length)return Xp({});const n=[],r=[],i={};return XC(t,(t,o)=>{const a=e(o,t).pipe(F(t=>i[o]=t));"primary"===o?n.push(a):r.push(a)}),Xp.apply(null,n.concat(r)).pipe(Lg(),function(t,e){const n=arguments.length>=2;return r=>r.pipe(t?Yp((e,n)=>t(e,n,r)):y,uC(1),n?mC(e):hC(()=>new sC))}(),F(()=>i))}(n.children,(n,r)=>this.expandSegmentGroup(t,e,r,n))}expandSegment(t,e,n,r,i,o){return Xp(...n).pipe(F(a=>this.expandSegmentAgainstRoute(t,e,n,a,r,i,o).pipe(Mw(t=>{if(t instanceof Xk)return Xp(null);throw t}))),Lg(),vC(t=>!!t),Mw((t,n)=>{if(t instanceof sC||"EmptyError"===t.name){if(this.noLeftoversInUrl(e,r,i))return Xp(new QC([],{}));throw new Xk(e)}throw t}))}noLeftoversInUrl(t,e,n){return 0===e.length&&!t.children[n]}expandSegmentAgainstRoute(t,e,n,r,i,o,a){return rS(r)!==o?Yk(e):void 0===r.redirectTo?this.matchSegmentAgainstRoute(t,e,r,i):a&&this.allowRedirects?this.expandSegmentAgainstRouteUsingRedirect(t,e,n,r,i,o):Yk(e)}expandSegmentAgainstRouteUsingRedirect(t,e,n,r,i,o){return"**"===r.path?this.expandWildCardWithParamsAgainstRouteUsingRedirect(t,n,r,o):this.expandRegularSegmentAgainstRouteUsingRedirect(t,e,n,r,i,o)}expandWildCardWithParamsAgainstRouteUsingRedirect(t,e,n,r){const i=this.applyRedirectCommands([],n.redirectTo,{});return n.redirectTo.startsWith("/")?Zk(i):this.lineralizeSegments(n,i).pipe(B(n=>{const i=new QC(n,{});return this.expandSegment(t,i,e,n,r,!1)}))}expandRegularSegmentAgainstRouteUsingRedirect(t,e,n,r,i,o){const{matched:a,consumedSegments:s,lastChild:u,positionalParamSegments:l}=tS(e,r,i);if(!a)return Yk(e);const c=this.applyRedirectCommands(s,r.redirectTo,l);return r.redirectTo.startsWith("/")?Zk(c):this.lineralizeSegments(r,c).pipe(B(r=>this.expandSegment(t,e,n,r.concat(i.slice(u)),o,!1)))}matchSegmentAgainstRoute(t,e,n,r){if("**"===n.path)return n.loadChildren?this.configLoader.load(t.injector,n).pipe(F(t=>(n._loadedConfig=t,new QC(r,{})))):Xp(new QC(r,{}));const{matched:i,consumedSegments:o,lastChild:a}=tS(e,n,r);if(!i)return Yk(e);const s=r.slice(a);return this.getChildConfig(t,n,r).pipe(B(t=>{const n=t.module,r=t.routes,{segmentGroup:i,slicedSegments:a}=function(t,e,n,r){return n.length>0&&function(t,e,n){return n.some(n=>nS(t,e,n)&&"primary"!==rS(n))}(t,n,r)?{segmentGroup:eS(new QC(e,function(t,e){const n={};n.primary=e;for(const r of t)""===r.path&&"primary"!==rS(r)&&(n[rS(r)]=new QC([],{}));return n}(r,new QC(n,t.children)))),slicedSegments:[]}:0===n.length&&function(t,e,n){return n.some(n=>nS(t,e,n))}(t,n,r)?{segmentGroup:eS(new QC(t.segments,function(t,e,n,r){const i={};for(const o of n)nS(t,e,o)&&!r[rS(o)]&&(i[rS(o)]=new QC([],{}));return Object.assign(Object.assign({},r),i)}(t,n,r,t.children))),slicedSegments:n}:{segmentGroup:t,slicedSegments:n}}(e,o,s,r);return 0===a.length&&i.hasChildren()?this.expandChildren(n,r,i).pipe(F(t=>new QC(o,t))):0===r.length&&0===a.length?Xp(new QC(o,{})):this.expandSegment(n,i,r,a,"primary",!0).pipe(F(t=>new QC(o.concat(t.segments),t.children)))}))}getChildConfig(t,e,n){return e.children?Xp(new qk(e.children,t)):e.loadChildren?void 0!==e._loadedConfig?Xp(e._loadedConfig):this.runCanLoadGuards(t.injector,e,n).pipe(B(n=>n?this.configLoader.load(t.injector,e).pipe(F(t=>(e._loadedConfig=t,t))):function(t){return new v(e=>e.error($C(`Cannot load children because the guard of the route "path: '${t.path}'" returned false`)))}(e))):Xp(new qk([],t))}runCanLoadGuards(t,e,n){const r=e.canLoad;return r&&0!==r.length?L(r).pipe(F(r=>{const i=t.get(r);let o;if(function(t){return t&&Hk(t.canLoad)}(i))o=i.canLoad(e,n);else{if(!Hk(i))throw new Error("Invalid CanLoad guard");o=i(e,n)}return KC(o)})).pipe(Lg(),$m(t=>{if(!Gk(t))return;const e=$C(`Redirecting to "${this.urlSerializer.serialize(t)}"`);throw e.url=t,e}),(i=t=>!0===t,t=>t.lift(new bC(i,void 0,t)))):Xp(!0);var i}lineralizeSegments(t,e){let n=[],r=e.root;for(;;){if(n=n.concat(r.segments),0===r.numberOfChildren)return Xp(n);if(r.numberOfChildren>1||!r.children.primary)return Qk(t.redirectTo);r=r.children.primary}}applyRedirectCommands(t,e,n){return this.applyRedirectCreatreUrlTree(e,this.urlSerializer.parse(e),t,n)}applyRedirectCreatreUrlTree(t,e,n,r){const i=this.createSegmentGroup(t,e.root,n,r);return new ZC(i,this.createQueryParams(e.queryParams,this.urlTree.queryParams),e.fragment)}createQueryParams(t,e){const n={};return XC(t,(t,r)=>{if("string"==typeof t&&t.startsWith(":")){const i=t.substring(1);n[r]=e[i]}else n[r]=t}),n}createSegmentGroup(t,e,n,r){const i=this.createSegments(t,e.segments,n,r);let o={};return XC(e.children,(e,i)=>{o[i]=this.createSegmentGroup(t,e,n,r)}),new QC(i,o)}createSegments(t,e,n,r){return e.map(e=>e.path.startsWith(":")?this.findPosParam(t,e,r):this.findOrReturn(e,n))}findPosParam(t,e,n){const r=n[e.path.substring(1)];if(!r)throw new Error(`Cannot redirect to '${t}'. Cannot find '${e.path}'.`);return r}findOrReturn(t,e){let n=0;for(const r of e){if(r.path===t.path)return e.splice(n),r;n++}return t}}function tS(t,e,n){if(""===e.path)return"full"===e.pathMatch&&(t.hasChildren()||n.length>0)?{matched:!1,consumedSegments:[],lastChild:0,positionalParamSegments:{}}:{matched:!0,consumedSegments:[],lastChild:0,positionalParamSegments:{}};const r=(e.matcher||VC)(n,t,e);return r?{matched:!0,consumedSegments:r.consumed,lastChild:r.consumed.length,positionalParamSegments:r.posParams}:{matched:!1,consumedSegments:[],lastChild:0,positionalParamSegments:{}}}function eS(t){if(1===t.numberOfChildren&&t.children.primary){const e=t.children.primary;return new QC(t.segments.concat(e.segments),e.children)}return t}function nS(t,e,n){return(!(t.hasChildren()||e.length>0)||"full"!==n.pathMatch)&&""===n.path&&void 0!==n.redirectTo}function rS(t){return t.outlet||"primary"}class iS{constructor(t){this.path=t,this.route=this.path[this.path.length-1]}}class oS{constructor(t,e){this.component=t,this.route=e}}function aS(t,e,n){const r=t._root;return function t(e,n,r,i,o={canDeactivateChecks:[],canActivateChecks:[]}){const a=xk(n);return e.children.forEach(e=>{!function(e,n,r,i,o={canDeactivateChecks:[],canActivateChecks:[]}){const a=e.value,s=n?n.value:null,u=r?r.getContext(e.value.outlet):null;if(s&&a.routeConfig===s.routeConfig){const l=function(t,e,n){if("function"==typeof n)return n(t,e);switch(n){case"pathParamsChange":return!tk(t.url,e.url);case"pathParamsOrQueryParamsChange":return!tk(t.url,e.url)||!WC(t.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!Dk(t,e)||!WC(t.queryParams,e.queryParams);case"paramsChange":default:return!Dk(t,e)}}(s,a,a.routeConfig.runGuardsAndResolvers);l?o.canActivateChecks.push(new iS(i)):(a.data=s.data,a._resolvedData=s._resolvedData),t(e,n,a.component?u?u.children:null:r,i,o),l&&o.canDeactivateChecks.push(new oS(u&&u.outlet&&u.outlet.component||null,s))}else s&&uS(n,u,o),o.canActivateChecks.push(new iS(i)),t(e,null,a.component?u?u.children:null:r,i,o)}(e,a[e.value.outlet],r,i.concat([e.value]),o),delete a[e.value.outlet]}),XC(a,(t,e)=>uS(t,r.getContext(e),o)),o}(r,e?e._root:null,n,[r.value])}function sS(t,e,n){const r=function(t){if(!t)return null;for(let e=t.parent;e;e=e.parent){const t=e.routeConfig;if(t&&t._loadedConfig)return t._loadedConfig}return null}(e);return(r?r.module.injector:n).get(t)}function uS(t,e,n){const r=xk(t),i=t.value;XC(r,(t,r)=>{uS(t,i.component?e?e.children.getContext(r):null:e,n)}),n.canDeactivateChecks.push(new oS(i.component&&e&&e.outlet&&e.outlet.isActivated?e.outlet.component:null,i))}const lS=Symbol("INITIAL_VALUE");function cS(){return $g(t=>function(...t){let e=null,n=null;return S(t[t.length-1])&&(n=t.pop()),"function"==typeof t[t.length-1]&&(e=t.pop()),1===t.length&&u(t[0])&&(t=t[0]),W(t,n).lift(new aw(e))}(...t.map(t=>t.pipe(ng(1),Ug(lS)))).pipe(function(t,e){let n=!1;return arguments.length>=2&&(n=!0),function(r){return r.lift(new xC(t,e,n))}}((t,e)=>{let n=!1;return e.reduce((t,r,i)=>{if(t!==lS)return t;if(r===lS&&(n=!0),!n){if(!1===r)return r;if(i===e.length-1||Gk(r))return r}return t},t)},lS),Yp(t=>t!==lS),F(t=>Gk(t)?t:!0===t),ng(1)))}function hS(t,e){return null!==t&&e&&e(new jC(t)),Xp(!0)}function dS(t,e){return null!==t&&e&&e(new FC(t)),Xp(!0)}function fS(t,e,n){const r=e.routeConfig?e.routeConfig.canActivate:null;return r&&0!==r.length?Xp(r.map(r=>Vv(()=>{const i=sS(r,e,n);let o;if(function(t){return t&&Hk(t.canActivate)}(i))o=KC(i.canActivate(e,t));else{if(!Hk(i))throw new Error("Invalid CanActivate guard");o=KC(i(e,t))}return o.pipe(vC())}))).pipe(cS()):Xp(!0)}function pS(t,e,n){const r=e[e.length-1],i=e.slice(0,e.length-1).reverse().map(t=>function(t){const e=t.routeConfig?t.routeConfig.canActivateChild:null;return e&&0!==e.length?{node:t,guards:e}:null}(t)).filter(t=>null!==t).map(e=>Vv(()=>Xp(e.guards.map(i=>{const o=sS(i,e.node,n);let a;if(function(t){return t&&Hk(t.canActivateChild)}(o))a=KC(o.canActivateChild(r,t));else{if(!Hk(o))throw new Error("Invalid CanActivateChild guard");a=KC(o(r,t))}return a.pipe(vC())})).pipe(cS())));return Xp(i).pipe(cS())}class mS{}class gS{constructor(t,e,n,r,i,o){this.rootComponentType=t,this.config=e,this.urlTree=n,this.url=r,this.paramsInheritanceStrategy=i,this.relativeLinkResolution=o}recognize(){try{const t=bS(this.urlTree.root,[],[],this.config,this.relativeLinkResolution).segmentGroup,e=this.processSegmentGroup(this.config,t,"primary"),n=new Ek([],Object.freeze({}),Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,{},"primary",this.rootComponentType,null,this.urlTree.root,-1,{}),r=new wk(n,e),i=new Ok(this.url,r);return this.inheritParamsAndData(i._root),Xp(i)}catch(t){return new v(e=>e.error(t))}}inheritParamsAndData(t){const e=t.value,n=Sk(e,this.paramsInheritanceStrategy);e.params=Object.freeze(n.params),e.data=Object.freeze(n.data),t.children.forEach(t=>this.inheritParamsAndData(t))}processSegmentGroup(t,e,n){return 0===e.segments.length&&e.hasChildren()?this.processChildren(t,e):this.processSegment(t,e,e.segments,n)}processChildren(t,e){const n=ek(e,(e,n)=>this.processSegmentGroup(t,e,n));return function(t){const e={};t.forEach(t=>{const n=e[t.value.outlet];if(n){const e=n.url.map(t=>t.toString()).join("/"),r=t.value.url.map(t=>t.toString()).join("/");throw new Error(`Two segments cannot have the same outlet name: '${e}' and '${r}'.`)}e[t.value.outlet]=t.value})}(n),n.sort((t,e)=>"primary"===t.value.outlet?-1:"primary"===e.value.outlet?1:t.value.outlet.localeCompare(e.value.outlet)),n}processSegment(t,e,n,r){for(const o of t)try{return this.processSegmentAgainstRoute(o,e,n,r)}catch(i){if(!(i instanceof mS))throw i}if(this.noLeftoversInUrl(e,n,r))return[];throw new mS}noLeftoversInUrl(t,e,n){return 0===e.length&&!t.children[n]}processSegmentAgainstRoute(t,e,n,r){if(t.redirectTo)throw new mS;if((t.outlet||"primary")!==r)throw new mS;let i,o=[],a=[];if("**"===t.path){const o=n.length>0?GC(n).parameters:{};i=new Ek(n,o,Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,_S(t),r,t.component,t,yS(e),vS(e)+n.length,CS(t))}else{const s=function(t,e,n){if(""===e.path){if("full"===e.pathMatch&&(t.hasChildren()||n.length>0))throw new mS;return{consumedSegments:[],lastChild:0,parameters:{}}}const r=(e.matcher||VC)(n,t,e);if(!r)throw new mS;const i={};XC(r.posParams,(t,e)=>{i[e]=t.path});const o=r.consumed.length>0?Object.assign(Object.assign({},i),r.consumed[r.consumed.length-1].parameters):i;return{consumedSegments:r.consumed,lastChild:r.consumed.length,parameters:o}}(e,t,n);o=s.consumedSegments,a=n.slice(s.lastChild),i=new Ek(o,s.parameters,Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,_S(t),r,t.component,t,yS(e),vS(e)+o.length,CS(t))}const s=function(t){return t.children?t.children:t.loadChildren?t._loadedConfig.routes:[]}(t),{segmentGroup:u,slicedSegments:l}=bS(e,o,a,s,this.relativeLinkResolution);if(0===l.length&&u.hasChildren()){const t=this.processChildren(s,u);return[new wk(i,t)]}if(0===s.length&&0===l.length)return[new wk(i,[])];const c=this.processSegment(s,u,l,"primary");return[new wk(i,c)]}}function yS(t){let e=t;for(;e._sourceSegment;)e=e._sourceSegment;return e}function vS(t){let e=t,n=e._segmentIndexShift?e._segmentIndexShift:0;for(;e._sourceSegment;)e=e._sourceSegment,n+=e._segmentIndexShift?e._segmentIndexShift:0;return n-1}function bS(t,e,n,r,i){if(n.length>0&&function(t,e,n){return n.some(n=>wS(t,e,n)&&"primary"!==xS(n))}(t,n,r)){const i=new QC(e,function(t,e,n,r){const i={};i.primary=r,r._sourceSegment=t,r._segmentIndexShift=e.length;for(const o of n)if(""===o.path&&"primary"!==xS(o)){const n=new QC([],{});n._sourceSegment=t,n._segmentIndexShift=e.length,i[xS(o)]=n}return i}(t,e,r,new QC(n,t.children)));return i._sourceSegment=t,i._segmentIndexShift=e.length,{segmentGroup:i,slicedSegments:[]}}if(0===n.length&&function(t,e,n){return n.some(n=>wS(t,e,n))}(t,n,r)){const o=new QC(t.segments,function(t,e,n,r,i,o){const a={};for(const s of r)if(wS(t,n,s)&&!i[xS(s)]){const n=new QC([],{});n._sourceSegment=t,n._segmentIndexShift="legacy"===o?t.segments.length:e.length,a[xS(s)]=n}return Object.assign(Object.assign({},i),a)}(t,e,n,r,t.children,i));return o._sourceSegment=t,o._segmentIndexShift=e.length,{segmentGroup:o,slicedSegments:n}}const o=new QC(t.segments,t.children);return o._sourceSegment=t,o._segmentIndexShift=e.length,{segmentGroup:o,slicedSegments:n}}function wS(t,e,n){return(!(t.hasChildren()||e.length>0)||"full"!==n.pathMatch)&&""===n.path&&void 0===n.redirectTo}function xS(t){return t.outlet||"primary"}function _S(t){return t.data||{}}function CS(t){return t.resolve||{}}function kS(t){return function(e){return e.pipe($g(e=>{const n=t(e);return n?L(n).pipe(F(()=>e)):L([e])}))}}class SS{shouldDetach(t){return!1}store(t,e){}shouldAttach(t){return!1}retrieve(t){return null}shouldReuseRoute(t,e){return t.routeConfig===e.routeConfig}}let ES=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=pe({type:t,selectors:[["ng-component"]],decls:1,vars:0,template:function(t,e){1&t&&Ta(0,"router-outlet")},directives:function(){return[$S]},encapsulation:2}),t})();function OS(t,e=""){for(let n=0;n<t.length;n++){const r=t[n];AS(r,NS(e,r))}}function AS(t,e){if(!t)throw new Error(`\n      Invalid configuration of route '${e}': Encountered undefined route.\n      The reason might be an extra comma.\n\n      Example:\n      const routes: Routes = [\n        { path: '', redirectTo: '/dashboard', pathMatch: 'full' },\n        { path: 'dashboard',  component: DashboardComponent },, << two commas\n        { path: 'detail/:id', component: HeroDetailComponent }\n      ];\n    `);if(Array.isArray(t))throw new Error(`Invalid configuration of route '${e}': Array cannot be specified`);if(!t.component&&!t.children&&!t.loadChildren&&t.outlet&&"primary"!==t.outlet)throw new Error(`Invalid configuration of route '${e}': a componentless route without children or loadChildren cannot have a named outlet set`);if(t.redirectTo&&t.children)throw new Error(`Invalid configuration of route '${e}': redirectTo and children cannot be used together`);if(t.redirectTo&&t.loadChildren)throw new Error(`Invalid configuration of route '${e}': redirectTo and loadChildren cannot be used together`);if(t.children&&t.loadChildren)throw new Error(`Invalid configuration of route '${e}': children and loadChildren cannot be used together`);if(t.redirectTo&&t.component)throw new Error(`Invalid configuration of route '${e}': redirectTo and component cannot be used together`);if(t.path&&t.matcher)throw new Error(`Invalid configuration of route '${e}': path and matcher cannot be used together`);if(void 0===t.redirectTo&&!t.component&&!t.children&&!t.loadChildren)throw new Error(`Invalid configuration of route '${e}'. One of the following must be provided: component, redirectTo, children or loadChildren`);if(void 0===t.path&&void 0===t.matcher)throw new Error(`Invalid configuration of route '${e}': routes must have either a path or a matcher specified`);if("string"==typeof t.path&&"/"===t.path.charAt(0))throw new Error(`Invalid configuration of route '${e}': path cannot start with a slash`);if(""===t.path&&void 0!==t.redirectTo&&void 0===t.pathMatch)throw new Error(`Invalid configuration of route '{path: "${e}", redirectTo: "${t.redirectTo}"}': please provide 'pathMatch'. The default value of 'pathMatch' is 'prefix', but often the intent is to use 'full'.`);if(void 0!==t.pathMatch&&"full"!==t.pathMatch&&"prefix"!==t.pathMatch)throw new Error(`Invalid configuration of route '${e}': pathMatch can only be set to 'prefix' or 'full'`);t.children&&OS(t.children,e)}function NS(t,e){return e?t||e.path?t&&!e.path?t+"/":!t&&e.path?e.path:`${t}/${e.path}`:"":t}function TS(t){const e=t.children&&t.children.map(TS),n=e?Object.assign(Object.assign({},t),{children:e}):Object.assign({},t);return!n.component&&(e||n.loadChildren)&&n.outlet&&"primary"!==n.outlet&&(n.component=ES),n}const DS=new Lt("ROUTES");class RS{constructor(t,e,n,r){this.loader=t,this.compiler=e,this.onLoadStartListener=n,this.onLoadEndListener=r}load(t,e){return this.onLoadStartListener&&this.onLoadStartListener(e),this.loadModuleFactory(e.loadChildren).pipe(F(n=>{this.onLoadEndListener&&this.onLoadEndListener(e);const r=n.create(t);return new qk(HC(r.injector.get(DS)).map(TS),r)}))}loadModuleFactory(t){return"string"==typeof t?L(this.loader.load(t)):KC(t()).pipe(B(t=>t instanceof ee?Xp(t):L(this.compiler.compileModuleAsync(t))))}}class IS{constructor(){this.outlet=null,this.route=null,this.resolver=null,this.children=new MS,this.attachRef=null}}class MS{constructor(){this.contexts=new Map}onChildOutletCreated(t,e){const n=this.getOrCreateContext(t);n.outlet=e,this.contexts.set(t,n)}onChildOutletDestroyed(t){const e=this.getContext(t);e&&(e.outlet=null)}onOutletDeactivated(){const t=this.contexts;return this.contexts=new Map,t}onOutletReAttached(t){this.contexts=t}getOrCreateContext(t){let e=this.getContext(t);return e||(e=new IS,this.contexts.set(t,e)),e}getContext(t){return this.contexts.get(t)||null}}class FS{shouldProcessUrl(t){return!0}extract(t){return t}merge(t,e){return t}}function PS(t){throw t}function jS(t,e,n){return e.parse("/")}function zS(t,e){return Xp(null)}let LS=(()=>{class t{constructor(t,e,n,r,i,o,a,s){this.rootComponentType=t,this.urlSerializer=e,this.rootContexts=n,this.location=r,this.config=s,this.lastSuccessfulNavigation=null,this.currentNavigation=null,this.navigationId=0,this.isNgZoneEnabled=!1,this.events=new C,this.errorHandler=PS,this.malformedUriErrorHandler=jS,this.navigated=!1,this.lastSuccessfulId=-1,this.hooks={beforePreactivation:zS,afterPreactivation:zS},this.urlHandlingStrategy=new FS,this.routeReuseStrategy=new SS,this.onSameUrlNavigation="ignore",this.paramsInheritanceStrategy="emptyOnly",this.urlUpdateStrategy="deferred",this.relativeLinkResolution="legacy",this.ngModule=i.get(te),this.console=i.get(Xu);const u=i.get(sl);this.isNgZoneEnabled=u instanceof sl,this.resetConfig(s),this.currentUrlTree=new ZC(new QC([],{}),{},null),this.rawUrlTree=this.currentUrlTree,this.browserUrlTree=this.currentUrlTree,this.configLoader=new RS(o,a,t=>this.triggerEvent(new IC(t)),t=>this.triggerEvent(new MC(t))),this.routerState=Ck(this.currentUrlTree,this.rootComponentType),this.transitions=new ev({id:0,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,extractedUrl:this.urlHandlingStrategy.extract(this.currentUrlTree),urlAfterRedirects:this.urlHandlingStrategy.extract(this.currentUrlTree),rawUrl:this.currentUrlTree,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:"imperative",restoredState:null,currentSnapshot:this.routerState.snapshot,targetSnapshot:null,currentRouterState:this.routerState,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.navigations=this.setupNavigations(this.transitions),this.processNavigations()}setupNavigations(t){const e=this.events;return t.pipe(Yp(t=>0!==t.id),F(t=>Object.assign(Object.assign({},t),{extractedUrl:this.urlHandlingStrategy.extract(t.rawUrl)})),$g(t=>{let n=!1,r=!1;return Xp(t).pipe($m(t=>{this.currentNavigation={id:t.id,initialUrl:t.currentRawUrl,extractedUrl:t.extractedUrl,trigger:t.source,extras:t.extras,previousNavigation:this.lastSuccessfulNavigation?Object.assign(Object.assign({},this.lastSuccessfulNavigation),{previousNavigation:null}):null}}),$g(t=>{const n=!this.navigated||t.extractedUrl.toString()!==this.browserUrlTree.toString();if(("reload"===this.onSameUrlNavigation||n)&&this.urlHandlingStrategy.shouldProcessUrl(t.rawUrl))return Xp(t).pipe($g(t=>{const n=this.transitions.getValue();return e.next(new kC(t.id,this.serializeUrl(t.extractedUrl),t.source,t.restoredState)),n!==this.transitions.getValue()?tg:[t]}),$g(t=>Promise.resolve(t)),(r=this.ngModule.injector,i=this.configLoader,o=this.urlSerializer,a=this.config,function(t){return t.pipe($g(t=>function(t,e,n,r,i){return new Jk(t,e,n,r,i).apply()}(r,i,o,t.extractedUrl,a).pipe(F(e=>Object.assign(Object.assign({},t),{urlAfterRedirects:e})))))}),$m(t=>{this.currentNavigation=Object.assign(Object.assign({},this.currentNavigation),{finalUrl:t.urlAfterRedirects})}),function(t,e,n,r,i){return function(o){return o.pipe(B(o=>function(t,e,n,r,i="emptyOnly",o="legacy"){return new gS(t,e,n,r,i,o).recognize()}(t,e,o.urlAfterRedirects,n(o.urlAfterRedirects),r,i).pipe(F(t=>Object.assign(Object.assign({},o),{targetSnapshot:t})))))}}(this.rootComponentType,this.config,t=>this.serializeUrl(t),this.paramsInheritanceStrategy,this.relativeLinkResolution),$m(t=>{"eager"===this.urlUpdateStrategy&&(t.extras.skipLocationChange||this.setBrowserUrl(t.urlAfterRedirects,!!t.extras.replaceUrl,t.id,t.extras.state),this.browserUrlTree=t.urlAfterRedirects)}),$m(t=>{const n=new AC(t.id,this.serializeUrl(t.extractedUrl),this.serializeUrl(t.urlAfterRedirects),t.targetSnapshot);e.next(n)}));var r,i,o,a;if(n&&this.rawUrlTree&&this.urlHandlingStrategy.shouldProcessUrl(this.rawUrlTree)){const{id:n,extractedUrl:r,source:i,restoredState:o,extras:a}=t,s=new kC(n,this.serializeUrl(r),i,o);e.next(s);const u=Ck(r,this.rootComponentType).snapshot;return Xp(Object.assign(Object.assign({},t),{targetSnapshot:u,urlAfterRedirects:r,extras:Object.assign(Object.assign({},a),{skipLocationChange:!1,replaceUrl:!1})}))}return this.rawUrlTree=t.rawUrl,this.browserUrlTree=t.urlAfterRedirects,t.resolve(null),tg}),kS(t=>{const{targetSnapshot:e,id:n,extractedUrl:r,rawUrl:i,extras:{skipLocationChange:o,replaceUrl:a}}=t;return this.hooks.beforePreactivation(e,{navigationId:n,appliedUrlTree:r,rawUrlTree:i,skipLocationChange:!!o,replaceUrl:!!a})}),$m(t=>{const e=new NC(t.id,this.serializeUrl(t.extractedUrl),this.serializeUrl(t.urlAfterRedirects),t.targetSnapshot);this.triggerEvent(e)}),F(t=>Object.assign(Object.assign({},t),{guards:aS(t.targetSnapshot,t.currentSnapshot,this.rootContexts)})),function(t,e){return function(n){return n.pipe(B(n=>{const{targetSnapshot:r,currentSnapshot:i,guards:{canActivateChecks:o,canDeactivateChecks:a}}=n;return 0===a.length&&0===o.length?Xp(Object.assign(Object.assign({},n),{guardsResult:!0})):function(t,e,n,r){return L(t).pipe(B(t=>function(t,e,n,r,i){const o=e&&e.routeConfig?e.routeConfig.canDeactivate:null;return o&&0!==o.length?Xp(o.map(o=>{const a=sS(o,e,i);let s;if(function(t){return t&&Hk(t.canDeactivate)}(a))s=KC(a.canDeactivate(t,e,n,r));else{if(!Hk(a))throw new Error("Invalid CanDeactivate guard");s=KC(a(t,e,n,r))}return s.pipe(vC())})).pipe(cS()):Xp(!0)}(t.component,t.route,n,e,r)),vC(t=>!0!==t,!0))}(a,r,i,t).pipe(B(n=>n&&"boolean"==typeof n?function(t,e,n,r){return L(e).pipe(Kp(e=>L([dS(e.route.parent,r),hS(e.route,r),pS(t,e.path,n),fS(t,e.route,n)]).pipe(Lg(),vC(t=>!0!==t,!0))),vC(t=>!0!==t,!0))}(r,o,t,e):Xp(n)),F(t=>Object.assign(Object.assign({},n),{guardsResult:t})))}))}}(this.ngModule.injector,t=>this.triggerEvent(t)),$m(t=>{if(Gk(t.guardsResult)){const e=$C(`Redirecting to "${this.serializeUrl(t.guardsResult)}"`);throw e.url=t.guardsResult,e}}),$m(t=>{const e=new TC(t.id,this.serializeUrl(t.extractedUrl),this.serializeUrl(t.urlAfterRedirects),t.targetSnapshot,!!t.guardsResult);this.triggerEvent(e)}),Yp(t=>{if(!t.guardsResult){this.resetUrlToCurrentUrlTree();const n=new EC(t.id,this.serializeUrl(t.extractedUrl),"");return e.next(n),t.resolve(!1),!1}return!0}),kS(t=>{if(t.guards.canActivateChecks.length)return Xp(t).pipe($m(t=>{const e=new DC(t.id,this.serializeUrl(t.extractedUrl),this.serializeUrl(t.urlAfterRedirects),t.targetSnapshot);this.triggerEvent(e)}),$g(t=>{let n=!1;return Xp(t).pipe((r=this.paramsInheritanceStrategy,i=this.ngModule.injector,function(t){return t.pipe(B(t=>{const{targetSnapshot:e,guards:{canActivateChecks:n}}=t;if(!n.length)return Xp(t);let o=0;return L(n).pipe(Kp(t=>function(t,e,n,r){return function(t,e,n,r){const i=Object.keys(t);if(0===i.length)return Xp({});const o={};return L(i).pipe(B(i=>function(t,e,n,r){const i=sS(t,e,r);return KC(i.resolve?i.resolve(e,n):i(e,n))}(t[i],e,n,r).pipe($m(t=>{o[i]=t}))),uC(1),B(()=>Object.keys(o).length===i.length?Xp(o):tg))}(t._resolve,t,e,r).pipe(F(e=>(t._resolvedData=e,t.data=Object.assign(Object.assign({},t.data),Sk(t,n).resolve),null)))}(t.route,e,r,i)),$m(()=>o++),uC(1),B(e=>o===n.length?Xp(t):tg))}))}),$m({next:()=>n=!0,complete:()=>{if(!n){const n=new EC(t.id,this.serializeUrl(t.extractedUrl),"At least one route resolver didn't emit any value.");e.next(n),t.resolve(!1)}}}));var r,i}),$m(t=>{const e=new RC(t.id,this.serializeUrl(t.extractedUrl),this.serializeUrl(t.urlAfterRedirects),t.targetSnapshot);this.triggerEvent(e)}))}),kS(t=>{const{targetSnapshot:e,id:n,extractedUrl:r,rawUrl:i,extras:{skipLocationChange:o,replaceUrl:a}}=t;return this.hooks.afterPreactivation(e,{navigationId:n,appliedUrlTree:r,rawUrlTree:i,skipLocationChange:!!o,replaceUrl:!!a})}),F(t=>{const e=function(t,e,n){const r=function t(e,n,r){if(r&&e.shouldReuseRoute(n.value,r.value.snapshot)){const i=r.value;i._futureSnapshot=n.value;const o=function(e,n,r){return n.children.map(n=>{for(const i of r.children)if(e.shouldReuseRoute(i.value.snapshot,n.value))return t(e,n,i);return t(e,n)})}(e,n,r);return new wk(i,o)}{const r=e.retrieve(n.value);if(r){const t=r.route;return function t(e,n){if(e.value.routeConfig!==n.value.routeConfig)throw new Error("Cannot reattach ActivatedRouteSnapshot created from a different route");if(e.children.length!==n.children.length)throw new Error("Cannot reattach ActivatedRouteSnapshot with a different number of children");n.value._futureSnapshot=e.value;for(let r=0;r<e.children.length;++r)t(e.children[r],n.children[r])}(n,t),t}{const r=new kk(new ev((i=n.value).url),new ev(i.params),new ev(i.queryParams),new ev(i.fragment),new ev(i.data),i.outlet,i.component,i),o=n.children.map(n=>t(e,n));return new wk(r,o)}}var i}(t,e._root,n?n._root:void 0);return new _k(r,e)}(this.routeReuseStrategy,t.targetSnapshot,t.currentRouterState);return Object.assign(Object.assign({},t),{targetRouterState:e})}),$m(t=>{this.currentUrlTree=t.urlAfterRedirects,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,t.rawUrl),this.routerState=t.targetRouterState,"deferred"===this.urlUpdateStrategy&&(t.extras.skipLocationChange||this.setBrowserUrl(this.rawUrlTree,!!t.extras.replaceUrl,t.id,t.extras.state),this.browserUrlTree=t.urlAfterRedirects)}),(i=this.rootContexts,o=this.routeReuseStrategy,a=t=>this.triggerEvent(t),F(t=>(new Vk(o,t.targetRouterState,t.currentRouterState,a).activate(i),t))),$m({next(){n=!0},complete(){n=!0}}),jw(()=>{if(!n&&!r){this.resetUrlToCurrentUrlTree();const n=new EC(t.id,this.serializeUrl(t.extractedUrl),`Navigation ID ${t.id} is not equal to the current navigation id ${this.navigationId}`);e.next(n),t.resolve(!1)}this.currentNavigation=null}),Mw(n=>{if(r=!0,(i=n)&&i.ngNavigationCancelingError){const r=Gk(n.url);r||(this.navigated=!0,this.resetStateAndUrl(t.currentRouterState,t.currentUrlTree,t.rawUrl));const i=new EC(t.id,this.serializeUrl(t.extractedUrl),n.message);e.next(i),r?setTimeout(()=>{const e=this.urlHandlingStrategy.merge(n.url,this.rawUrlTree);return this.scheduleNavigation(e,"imperative",null,{skipLocationChange:t.extras.skipLocationChange,replaceUrl:"eager"===this.urlUpdateStrategy},{resolve:t.resolve,reject:t.reject,promise:t.promise})},0):t.resolve(!1)}else{this.resetStateAndUrl(t.currentRouterState,t.currentUrlTree,t.rawUrl);const r=new OC(t.id,this.serializeUrl(t.extractedUrl),n);e.next(r);try{t.resolve(this.errorHandler(n))}catch(o){t.reject(o)}}var i;return tg}));var i,o,a}))}resetRootComponentType(t){this.rootComponentType=t,this.routerState.root.component=this.rootComponentType}getTransition(){const t=this.transitions.value;return t.urlAfterRedirects=this.browserUrlTree,t}setTransition(t){this.transitions.next(Object.assign(Object.assign({},this.getTransition()),t))}initialNavigation(){this.setUpLocationChangeListener(),0===this.navigationId&&this.navigateByUrl(this.location.path(!0),{replaceUrl:!0})}setUpLocationChangeListener(){this.locationSubscription||(this.locationSubscription=this.location.subscribe(t=>{let e=this.parseUrl(t.url);const n="popstate"===t.type?"popstate":"hashchange",r=t.state&&t.state.navigationId?t.state:null;setTimeout(()=>{this.scheduleNavigation(e,n,r,{replaceUrl:!0})},0)}))}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.currentNavigation}triggerEvent(t){this.events.next(t)}resetConfig(t){OS(t),this.config=t.map(TS),this.navigated=!1,this.lastSuccessfulId=-1}ngOnDestroy(){this.dispose()}dispose(){this.locationSubscription&&(this.locationSubscription.unsubscribe(),this.locationSubscription=null)}createUrlTree(t,e={}){const{relativeTo:n,queryParams:r,fragment:i,preserveQueryParams:o,queryParamsHandling:a,preserveFragment:s}=e;Nr()&&o&&console&&console.warn&&console.warn("preserveQueryParams is deprecated, use queryParamsHandling instead.");const u=n||this.routerState.root,l=s?this.currentUrlTree.fragment:i;let c=null;if(a)switch(a){case"merge":c=Object.assign(Object.assign({},this.currentUrlTree.queryParams),r);break;case"preserve":c=this.currentUrlTree.queryParams;break;default:c=r||null}else c=o?this.currentUrlTree.queryParams:r||null;return null!==c&&(c=this.removeEmptyProps(c)),function(t,e,n,r,i){if(0===n.length)return Ik(e.root,e.root,e,r,i);const o=function(t){if("string"==typeof t[0]&&1===t.length&&"/"===t[0])return new Mk(!0,0,t);let e=0,n=!1;const r=t.reduce((t,r,i)=>{if("object"==typeof r&&null!=r){if(r.outlets){const e={};return XC(r.outlets,(t,n)=>{e[n]="string"==typeof t?t.split("/"):t}),[...t,{outlets:e}]}if(r.segmentPath)return[...t,r.segmentPath]}return"string"!=typeof r?[...t,r]:0===i?(r.split("/").forEach((r,i)=>{0==i&&"."===r||(0==i&&""===r?n=!0:".."===r?e++:""!=r&&t.push(r))}),t):[...t,r]},[]);return new Mk(n,e,r)}(n);if(o.toRoot())return Ik(e.root,new QC([],{}),e,r,i);const a=function(t,e,n){if(t.isAbsolute)return new Fk(e.root,!0,0);if(-1===n.snapshot._lastPathIndex){const t=n.snapshot._urlSegment;return new Fk(t,t===e.root,0)}const r=Rk(t.commands[0])?0:1;return function(t,e,n){let r=t,i=e,o=n;for(;o>i;){if(o-=i,r=r.parent,!r)throw new Error("Invalid number of '../'");i=r.segments.length}return new Fk(r,!1,i-o)}(n.snapshot._urlSegment,n.snapshot._lastPathIndex+r,t.numberOfDoubleDots)}(o,e,t),s=a.processChildren?zk(a.segmentGroup,a.index,o.commands):jk(a.segmentGroup,a.index,o.commands);return Ik(a.segmentGroup,s,e,r,i)}(u,this.currentUrlTree,t,c,l)}navigateByUrl(t,e={skipLocationChange:!1}){Nr()&&this.isNgZoneEnabled&&!sl.isInAngularZone()&&this.console.warn("Navigation triggered outside Angular zone, did you forget to call 'ngZone.run()'?");const n=Gk(t)?t:this.parseUrl(t),r=this.urlHandlingStrategy.merge(n,this.rawUrlTree);return this.scheduleNavigation(r,"imperative",null,e)}navigate(t,e={skipLocationChange:!1}){return function(t){for(let e=0;e<t.length;e++){const n=t[e];if(null==n)throw new Error(`The requested path contains ${n} segment at index ${e}`)}}(t),this.navigateByUrl(this.createUrlTree(t,e),e)}serializeUrl(t){return this.urlSerializer.serialize(t)}parseUrl(t){let e;try{e=this.urlSerializer.parse(t)}catch(n){e=this.malformedUriErrorHandler(n,this.urlSerializer,t)}return e}isActive(t,e){if(Gk(t))return YC(this.currentUrlTree,t,e);const n=this.parseUrl(t);return YC(this.currentUrlTree,n,e)}removeEmptyProps(t){return Object.keys(t).reduce((e,n)=>{const r=t[n];return null!=r&&(e[n]=r),e},{})}processNavigations(){this.navigations.subscribe(t=>{this.navigated=!0,this.lastSuccessfulId=t.id,this.events.next(new SC(t.id,this.serializeUrl(t.extractedUrl),this.serializeUrl(this.currentUrlTree))),this.lastSuccessfulNavigation=this.currentNavigation,this.currentNavigation=null,t.resolve(!0)},t=>{this.console.warn("Unhandled Navigation Error: ")})}scheduleNavigation(t,e,n,r,i){const o=this.getTransition();if(o&&"imperative"!==e&&"imperative"===o.source&&o.rawUrl.toString()===t.toString())return Promise.resolve(!0);if(o&&"hashchange"==e&&"popstate"===o.source&&o.rawUrl.toString()===t.toString())return Promise.resolve(!0);if(o&&"popstate"==e&&"hashchange"===o.source&&o.rawUrl.toString()===t.toString())return Promise.resolve(!0);let a,s,u;i?(a=i.resolve,s=i.reject,u=i.promise):u=new Promise((t,e)=>{a=t,s=e});const l=++this.navigationId;return this.setTransition({id:l,source:e,restoredState:n,currentUrlTree:this.currentUrlTree,currentRawUrl:this.rawUrlTree,rawUrl:t,extras:r,resolve:a,reject:s,promise:u,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),u.catch(t=>Promise.reject(t))}setBrowserUrl(t,e,n,r){const i=this.urlSerializer.serialize(t);r=r||{},this.location.isCurrentPathEqualTo(i)||e?this.location.replaceState(i,"",Object.assign(Object.assign({},r),{navigationId:n})):this.location.go(i,"",Object.assign(Object.assign({},r),{navigationId:n}))}resetStateAndUrl(t,e,n){this.routerState=t,this.currentUrlTree=e,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,n),this.resetUrlToCurrentUrlTree()}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",{navigationId:this.lastSuccessfulId})}}return t.\u0275fac=function(e){return new(e||t)(Kt(Ko),Kt(nk),Kt(MS),Kt(Jl),Kt(ca),Kt(Al),Kt(il),Kt(void 0))},t.\u0275prov=ht({token:t,factory:t.\u0275fac}),t})(),BS=(()=>{class t{constructor(t,e,n){this.router=t,this.route=e,this.locationStrategy=n,this.commands=[],this.subscription=t.events.subscribe(t=>{t instanceof SC&&this.updateTargetUrlAndHref()})}set routerLink(t){this.commands=null!=t?Array.isArray(t)?t:[t]:[]}set preserveQueryParams(t){Nr()&&console&&console.warn&&console.warn("preserveQueryParams is deprecated, use queryParamsHandling instead."),this.preserve=t}ngOnChanges(t){this.updateTargetUrlAndHref()}ngOnDestroy(){this.subscription.unsubscribe()}onClick(t,e,n,r){if(0!==t||e||n||r)return!0;if("string"==typeof this.target&&"_self"!=this.target)return!0;const i={skipLocationChange:US(this.skipLocationChange),replaceUrl:US(this.replaceUrl),state:this.state};return this.router.navigateByUrl(this.urlTree,i),!1}updateTargetUrlAndHref(){this.href=this.locationStrategy.prepareExternalUrl(this.router.serializeUrl(this.urlTree))}get urlTree(){return this.router.createUrlTree(this.commands,{relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,preserveQueryParams:US(this.preserve),queryParamsHandling:this.queryParamsHandling,preserveFragment:US(this.preserveFragment)})}}return t.\u0275fac=function(e){return new(e||t)(ka(LS),ka(kk),ka(Xl))},t.\u0275dir=we({type:t,selectors:[["a","routerLink",""],["area","routerLink",""]],hostVars:2,hostBindings:function(t,e){1&t&&Pa("click",(function(t){return e.onClick(t.button,t.ctrlKey,t.metaKey,t.shiftKey)})),2&t&&(os("href",e.href,Jr),wa("target",e.target))},inputs:{routerLink:"routerLink",preserveQueryParams:"preserveQueryParams",target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",preserveFragment:"preserveFragment",skipLocationChange:"skipLocationChange",replaceUrl:"replaceUrl",state:"state"},features:[Ie]}),t})();function US(t){return""===t||!!t}let $S=(()=>{class t{constructor(t,e,n,r,i){this.parentContexts=t,this.location=e,this.resolver=n,this.changeDetector=i,this.activated=null,this._activatedRoute=null,this.activateEvents=new vu,this.deactivateEvents=new vu,this.name=r||"primary",t.onChildOutletCreated(this.name,this)}ngOnDestroy(){this.parentContexts.onChildOutletDestroyed(this.name)}ngOnInit(){if(!this.activated){const t=this.parentContexts.getContext(this.name);t&&t.route&&(t.attachRef?this.attach(t.attachRef,t.route):this.activateWith(t.route,t.resolver||null))}}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new Error("Outlet is not activated");return this.activated.instance}get activatedRoute(){if(!this.activated)throw new Error("Outlet is not activated");return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new Error("Outlet is not activated");this.location.detach();const t=this.activated;return this.activated=null,this._activatedRoute=null,t}attach(t,e){this.activated=t,this._activatedRoute=e,this.location.insert(t.hostView)}deactivate(){if(this.activated){const t=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(t)}}activateWith(t,e){if(this.isActivated)throw new Error("Cannot activate an already activated outlet");this._activatedRoute=t;const n=(e=e||this.resolver).resolveComponentFactory(t._futureSnapshot.routeConfig.component),r=this.parentContexts.getOrCreateContext(this.name).children,i=new VS(t,r,this.location.injector);this.activated=this.location.createComponent(n,this.location.length,i),this.changeDetector.markForCheck(),this.activateEvents.emit(this.activated.instance)}}return t.\u0275fac=function(e){return new(e||t)(ka(MS),ka(Ys),ka(Cs),Sa("name"),ka(Go))},t.\u0275dir=we({type:t,selectors:[["router-outlet"]],outputs:{activateEvents:"activate",deactivateEvents:"deactivate"},exportAs:["outlet"]}),t})();class VS{constructor(t,e,n){this.route=t,this.childContexts=e,this.parent=n}get(t,e){return t===kk?this.route:t===MS?this.childContexts:this.parent.get(t,e)}}class WS{}class qS{preload(t,e){return Xp(null)}}let HS=(()=>{class t{constructor(t,e,n,r,i){this.router=t,this.injector=r,this.preloadingStrategy=i,this.loader=new RS(e,n,e=>t.triggerEvent(new IC(e)),e=>t.triggerEvent(new MC(e)))}setUpPreloading(){this.subscription=this.router.events.pipe(Yp(t=>t instanceof SC),Kp(()=>this.preload())).subscribe(()=>{})}preload(){const t=this.injector.get(te);return this.processRoutes(t,this.router.config)}ngOnDestroy(){this.subscription.unsubscribe()}processRoutes(t,e){const n=[];for(const r of e)if(r.loadChildren&&!r.canLoad&&r._loadedConfig){const t=r._loadedConfig;n.push(this.processRoutes(t.module,t.routes))}else r.loadChildren&&!r.canLoad?n.push(this.preloadConfig(t,r)):r.children&&n.push(this.processRoutes(t,r.children));return L(n).pipe(V(),F(t=>{}))}preloadConfig(t,e){return this.preloadingStrategy.preload(e,()=>this.loader.load(t.injector,e).pipe(B(t=>(e._loadedConfig=t,this.processRoutes(t.module,t.routes)))))}}return t.\u0275fac=function(e){return new(e||t)(Kt(LS),Kt(Al),Kt(il),Kt(ca),Kt(WS))},t.\u0275prov=ht({token:t,factory:t.\u0275fac}),t})(),GS=(()=>{class t{constructor(t,e,n={}){this.router=t,this.viewportScroller=e,this.options=n,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},n.scrollPositionRestoration=n.scrollPositionRestoration||"disabled",n.anchorScrolling=n.anchorScrolling||"disabled"}init(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.router.events.subscribe(t=>{t instanceof kC?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=t.navigationTrigger,this.restoredId=t.restoredState?t.restoredState.navigationId:0):t instanceof SC&&(this.lastId=t.id,this.scheduleScrollEvent(t,this.router.parseUrl(t.urlAfterRedirects).fragment))})}consumeScrollEvents(){return this.router.events.subscribe(t=>{t instanceof LC&&(t.position?"top"===this.options.scrollPositionRestoration?this.viewportScroller.scrollToPosition([0,0]):"enabled"===this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition(t.position):t.anchor&&"enabled"===this.options.anchorScrolling?this.viewportScroller.scrollToAnchor(t.anchor):"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(t,e){this.router.triggerEvent(new LC(t,"popstate"===this.lastSource?this.store[this.restoredId]:null,e))}ngOnDestroy(){this.routerEventsSubscription&&this.routerEventsSubscription.unsubscribe(),this.scrollEventsSubscription&&this.scrollEventsSubscription.unsubscribe()}}return t.\u0275fac=function(e){return new(e||t)(Kt(LS),Kt(Cc),Kt(void 0))},t.\u0275prov=ht({token:t,factory:t.\u0275fac}),t})();const XS=new Lt("ROUTER_CONFIGURATION"),KS=new Lt("ROUTER_FORROOT_GUARD"),YS=[Jl,{provide:nk,useClass:rk},{provide:LS,useFactory:function(t,e,n,r,i,o,a,s={},u,l){const c=new LS(null,t,e,n,r,i,o,HC(a));if(u&&(c.urlHandlingStrategy=u),l&&(c.routeReuseStrategy=l),s.errorHandler&&(c.errorHandler=s.errorHandler),s.malformedUriErrorHandler&&(c.malformedUriErrorHandler=s.malformedUriErrorHandler),s.enableTracing){const t=jl();c.events.subscribe(e=>{t.logGroup("Router Event: "+e.constructor.name),t.log(e.toString()),t.log(e),t.logGroupEnd()})}return s.onSameUrlNavigation&&(c.onSameUrlNavigation=s.onSameUrlNavigation),s.paramsInheritanceStrategy&&(c.paramsInheritanceStrategy=s.paramsInheritanceStrategy),s.urlUpdateStrategy&&(c.urlUpdateStrategy=s.urlUpdateStrategy),s.relativeLinkResolution&&(c.relativeLinkResolution=s.relativeLinkResolution),c},deps:[nk,MS,Jl,ca,Al,il,DS,XS,[class{},new ot],[class{},new ot]]},MS,{provide:kk,useFactory:function(t){return t.routerState.root},deps:[LS]},{provide:Al,useClass:Dl},HS,qS,class{preload(t,e){return e().pipe(Mw(()=>Xp(null)))}},{provide:XS,useValue:{enableTracing:!1}}];function ZS(){return new xl("Router",LS)}let QS=(()=>{class t{constructor(t,e){}static forRoot(e,n){return{ngModule:t,providers:[YS,nE(e),{provide:KS,useFactory:eE,deps:[[LS,new ot,new st]]},{provide:XS,useValue:n||{}},{provide:Xl,useFactory:tE,deps:[Ll,[new it(Yl),new ot],XS]},{provide:GS,useFactory:JS,deps:[LS,Cc,XS]},{provide:WS,useExisting:n&&n.preloadingStrategy?n.preloadingStrategy:qS},{provide:xl,multi:!0,useFactory:ZS},[rE,{provide:Bu,multi:!0,useFactory:iE,deps:[rE]},{provide:aE,useFactory:oE,deps:[rE]},{provide:Gu,multi:!0,useExisting:aE}]]}}static forChild(e){return{ngModule:t,providers:[nE(e)]}}}return t.\u0275mod=ve({type:t}),t.\u0275inj=dt({factory:function(e){return new(e||t)(Kt(KS,8),Kt(LS,8))}}),t})();function JS(t,e,n){return n.scrollOffset&&e.setOffset(n.scrollOffset),new GS(t,e,n)}function tE(t,e,n={}){return n.useHash?new Ql(t,e):new Zl(t,e)}function eE(t){if(t)throw new Error("RouterModule.forRoot() called twice. Lazy loaded modules should use RouterModule.forChild() instead.");return"guarded"}function nE(t){return[{provide:ha,multi:!0,useValue:t},{provide:DS,multi:!0,useValue:t}]}let rE=(()=>{class t{constructor(t){this.injector=t,this.initNavigation=!1,this.resultOfPreactivationDone=new C}appInitializer(){return this.injector.get(Ul,Promise.resolve(null)).then(()=>{let t=null;const e=new Promise(e=>t=e),n=this.injector.get(LS),r=this.injector.get(XS);if(this.isLegacyDisabled(r)||this.isLegacyEnabled(r))t(!0);else if("disabled"===r.initialNavigation)n.setUpLocationChangeListener(),t(!0);else{if("enabled"!==r.initialNavigation)throw new Error(`Invalid initialNavigation options: '${r.initialNavigation}'`);n.hooks.afterPreactivation=()=>this.initNavigation?Xp(null):(this.initNavigation=!0,t(!0),this.resultOfPreactivationDone),n.initialNavigation()}return e})}bootstrapListener(t){const e=this.injector.get(XS),n=this.injector.get(HS),r=this.injector.get(GS),i=this.injector.get(LS),o=this.injector.get(El);t===o.components[0]&&(this.isLegacyEnabled(e)?i.initialNavigation():this.isLegacyDisabled(e)&&i.setUpLocationChangeListener(),n.setUpPreloading(),r.init(),i.resetRootComponentType(o.componentTypes[0]),this.resultOfPreactivationDone.next(null),this.resultOfPreactivationDone.complete())}isLegacyEnabled(t){return"legacy_enabled"===t.initialNavigation||!0===t.initialNavigation||void 0===t.initialNavigation}isLegacyDisabled(t){return"legacy_disabled"===t.initialNavigation||!1===t.initialNavigation}}return t.\u0275fac=function(e){return new(e||t)(Kt(ca))},t.\u0275prov=ht({token:t,factory:t.\u0275fac}),t})();function iE(t){return t.appInitializer.bind(t)}function oE(t){return t.bootstrapListener.bind(t)}const aE=new Lt("Router Initializer");var sE=n("mrSG"),uE=n("tgWb"),lE=n("Re/O");function cE(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(a,s)}u((r=r.apply(t,e||[])).next())}))}function hE(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}var dE={0:"tench, Tinca tinca",1:"goldfish, Carassius auratus",2:"great white shark, white shark, man-eater, man-eating shark, Carcharodon carcharias",3:"tiger shark, Galeocerdo cuvieri",4:"hammerhead, hammerhead shark",5:"electric ray, crampfish, numbfish, torpedo",6:"stingray",7:"cock",8:"hen",9:"ostrich, Struthio camelus",10:"brambling, Fringilla montifringilla",11:"goldfinch, Carduelis carduelis",12:"house finch, linnet, Carpodacus mexicanus",13:"junco, snowbird",14:"indigo bunting, indigo finch, indigo bird, Passerina cyanea",15:"robin, American robin, Turdus migratorius",16:"bulbul",17:"jay",18:"magpie",19:"chickadee",20:"water ouzel, dipper",21:"kite",22:"bald eagle, American eagle, Haliaeetus leucocephalus",23:"vulture",24:"great grey owl, great gray owl, Strix nebulosa",25:"European fire salamander, Salamandra salamandra",26:"common newt, Triturus vulgaris",27:"eft",28:"spotted salamander, Ambystoma maculatum",29:"axolotl, mud puppy, Ambystoma mexicanum",30:"bullfrog, Rana catesbeiana",31:"tree frog, tree-frog",32:"tailed frog, bell toad, ribbed toad, tailed toad, Ascaphus trui",33:"loggerhead, loggerhead turtle, Caretta caretta",34:"leatherback turtle, leatherback, leathery turtle, Dermochelys coriacea",35:"mud turtle",36:"terrapin",37:"box turtle, box tortoise",38:"banded gecko",39:"common iguana, iguana, Iguana iguana",40:"American chameleon, anole, Anolis carolinensis",41:"whiptail, whiptail lizard",42:"agama",43:"frilled lizard, Chlamydosaurus kingi",44:"alligator lizard",45:"Gila monster, Heloderma suspectum",46:"green lizard, Lacerta viridis",47:"African chameleon, Chamaeleo chamaeleon",48:"Komodo dragon, Komodo lizard, dragon lizard, giant lizard, Varanus komodoensis",49:"African crocodile, Nile crocodile, Crocodylus niloticus",50:"American alligator, Alligator mississipiensis",51:"triceratops",52:"thunder snake, worm snake, Carphophis amoenus",53:"ringneck snake, ring-necked snake, ring snake",54:"hognose snake, puff adder, sand viper",55:"green snake, grass snake",56:"king snake, kingsnake",57:"garter snake, grass snake",58:"water snake",59:"vine snake",60:"night snake, Hypsiglena torquata",61:"boa constrictor, Constrictor constrictor",62:"rock python, rock snake, Python sebae",63:"Indian cobra, Naja naja",64:"green mamba",65:"sea snake",66:"horned viper, cerastes, sand viper, horned asp, Cerastes cornutus",67:"diamondback, diamondback rattlesnake, Crotalus adamanteus",68:"sidewinder, horned rattlesnake, Crotalus cerastes",69:"trilobite",70:"harvestman, daddy longlegs, Phalangium opilio",71:"scorpion",72:"black and gold garden spider, Argiope aurantia",73:"barn spider, Araneus cavaticus",74:"garden spider, Aranea diademata",75:"black widow, Latrodectus mactans",76:"tarantula",77:"wolf spider, hunting spider",78:"tick",79:"centipede",80:"black grouse",81:"ptarmigan",82:"ruffed grouse, partridge, Bonasa umbellus",83:"prairie chicken, prairie grouse, prairie fowl",84:"peacock",85:"quail",86:"partridge",87:"African grey, African gray, Psittacus erithacus",88:"macaw",89:"sulphur-crested cockatoo, Kakatoe galerita, Cacatua galerita",90:"lorikeet",91:"coucal",92:"bee eater",93:"hornbill",94:"hummingbird",95:"jacamar",96:"toucan",97:"drake",98:"red-breasted merganser, Mergus serrator",99:"goose",100:"black swan, Cygnus atratus",101:"tusker",102:"echidna, spiny anteater, anteater",103:"platypus, duckbill, duckbilled platypus, duck-billed platypus, Ornithorhynchus anatinus",104:"wallaby, brush kangaroo",105:"koala, koala bear, kangaroo bear, native bear, Phascolarctos cinereus",106:"wombat",107:"jelly fish",108:"sea anemone, anemone",109:"brain coral",110:"flatworm, platyhelminth",111:"nematode, nematode worm, roundworm",112:"conch",113:"snail",114:"slug",115:"sea slug, nudibranch",116:"chiton, coat-of-mail shell, sea cradle, polyplacophore",117:"chambered nautilus, pearly nautilus, nautilus",118:"Dungeness crab, Cancer magister",119:"rock crab, Cancer irroratus",120:"fiddler crab",121:"king crab, Alaska crab, Alaskan king crab, Alaska king crab, Paralithodes camtschatica",122:"American lobster, Northern lobster, Maine lobster, Homarus americanus",123:"spiny lobster, langouste, rock lobster, crawfish, crayfish, sea crawfish",124:"crayfish, crawfish, crawdad, crawdaddy",125:"hermit crab",126:"isopod",127:"white stork, Ciconia ciconia",128:"black stork, Ciconia nigra",129:"spoonbill",130:"flamingo",131:"little blue heron, Egretta caerulea",132:"American egret, great white heron, Egretta albus",133:"bittern",134:"crane",135:"limpkin, Aramus pictus",136:"European gallinule, Porphyrio porphyrio",137:"American coot, marsh hen, mud hen, water hen, Fulica americana",138:"bustard",139:"ruddy turnstone, Arenaria interpres",140:"red-backed sandpiper, dunlin, Erolia alpina",141:"redshank, Tringa totanus",142:"dowitcher",143:"oystercatcher, oyster catcher",144:"pelican",145:"king penguin, Aptenodytes patagonica",146:"albatross, mollymawk",147:"grey whale, gray whale, devilfish, Eschrichtius gibbosus, Eschrichtius robustus",148:"killer whale, killer, orca, grampus, sea wolf, Orcinus orca",149:"dugong, Dugong dugon",150:"sea lion",151:"Chihuahua",152:"Japanese spaniel",153:"Maltese dog, Maltese terrier, Maltese",154:"Pekinese, Pekingese, Peke",155:"Shih-Tzu",156:"Blenheim spaniel",157:"papillon",158:"toy terrier",159:"Rhodesian ridgeback",160:"Afghan hound, Afghan",161:"basset, basset hound",162:"beagle",163:"bloodhound, sleuthhound",164:"bluetick",165:"black-and-tan coonhound",166:"Walker hound, Walker foxhound",167:"English foxhound",168:"redbone",169:"borzoi, Russian wolfhound",170:"Irish wolfhound",171:"Italian greyhound",172:"whippet",173:"Ibizan hound, Ibizan Podenco",174:"Norwegian elkhound, elkhound",175:"otterhound, otter hound",176:"Saluki, gazelle hound",177:"Scottish deerhound, deerhound",178:"Weimaraner",179:"Staffordshire bullterrier, Staffordshire bull terrier",180:"American Staffordshire terrier, Staffordshire terrier, American pit bull terrier, pit bull terrier",181:"Bedlington terrier",182:"Border terrier",183:"Kerry blue terrier",184:"Irish terrier",185:"Norfolk terrier",186:"Norwich terrier",187:"Yorkshire terrier",188:"wire-haired fox terrier",189:"Lakeland terrier",190:"Sealyham terrier, Sealyham",191:"Airedale, Airedale terrier",192:"cairn, cairn terrier",193:"Australian terrier",194:"Dandie Dinmont, Dandie Dinmont terrier",195:"Boston bull, Boston terrier",196:"miniature schnauzer",197:"giant schnauzer",198:"standard schnauzer",199:"Scotch terrier, Scottish terrier, Scottie",200:"Tibetan terrier, chrysanthemum dog",201:"silky terrier, Sydney silky",202:"soft-coated wheaten terrier",203:"West Highland white terrier",204:"Lhasa, Lhasa apso",205:"flat-coated retriever",206:"curly-coated retriever",207:"golden retriever",208:"Labrador retriever",209:"Chesapeake Bay retriever",210:"German short-haired pointer",211:"vizsla, Hungarian pointer",212:"English setter",213:"Irish setter, red setter",214:"Gordon setter",215:"Brittany spaniel",216:"clumber, clumber spaniel",217:"English springer, English springer spaniel",218:"Welsh springer spaniel",219:"cocker spaniel, English cocker spaniel, cocker",220:"Sussex spaniel",221:"Irish water spaniel",222:"kuvasz",223:"schipperke",224:"groenendael",225:"malinois",226:"briard",227:"kelpie",228:"komondor",229:"Old English sheepdog, bobtail",230:"Shetland sheepdog, Shetland sheep dog, Shetland",231:"collie",232:"Border collie",233:"Bouvier des Flandres, Bouviers des Flandres",234:"Rottweiler",235:"German shepherd, German shepherd dog, German police dog, alsatian",236:"Doberman, Doberman pinscher",237:"miniature pinscher",238:"Greater Swiss Mountain dog",239:"Bernese mountain dog",240:"Appenzeller",241:"EntleBucher",242:"boxer",243:"bull mastiff",244:"Tibetan mastiff",245:"French bulldog",246:"Great Dane",247:"Saint Bernard, St Bernard",248:"Eskimo dog, husky",249:"malamute, malemute, Alaskan malamute",250:"Siberian husky",251:"dalmatian, coach dog, carriage dog",252:"affenpinscher, monkey pinscher, monkey dog",253:"basenji",254:"pug, pug-dog",255:"Leonberg",256:"Newfoundland, Newfoundland dog",257:"Great Pyrenees",258:"Samoyed, Samoyede",259:"Pomeranian",260:"chow, chow chow",261:"keeshond",262:"Brabancon griffon",263:"Pembroke, Pembroke Welsh corgi",264:"Cardigan, Cardigan Welsh corgi",265:"toy poodle",266:"miniature poodle",267:"standard poodle",268:"Mexican hairless",269:"timber wolf, grey wolf, gray wolf, Canis lupus",270:"white wolf, Arctic wolf, Canis lupus tundrarum",271:"red wolf, maned wolf, Canis rufus, Canis niger",272:"coyote, prairie wolf, brush wolf, Canis latrans",273:"dingo, warrigal, warragal, Canis dingo",274:"dhole, Cuon alpinus",275:"African hunting dog, hyena dog, Cape hunting dog, Lycaon pictus",276:"hyena, hyaena",277:"red fox, Vulpes vulpes",278:"kit fox, Vulpes macrotis",279:"Arctic fox, white fox, Alopex lagopus",280:"grey fox, gray fox, Urocyon cinereoargenteus",281:"tabby, tabby cat",282:"tiger cat",283:"Persian cat",284:"Siamese cat, Siamese",285:"Egyptian cat",286:"cougar, puma, catamount, mountain lion, painter, panther, Felis concolor",287:"lynx, catamount",288:"leopard, Panthera pardus",289:"snow leopard, ounce, Panthera uncia",290:"jaguar, panther, Panthera onca, Felis onca",291:"lion, king of beasts, Panthera leo",292:"tiger, Panthera tigris",293:"cheetah, chetah, Acinonyx jubatus",294:"brown bear, bruin, Ursus arctos",295:"American black bear, black bear, Ursus americanus, Euarctos americanus",296:"ice bear, polar bear, Ursus Maritimus, Thalarctos maritimus",297:"sloth bear, Melursus ursinus, Ursus ursinus",298:"mongoose",299:"meerkat, mierkat",300:"tiger beetle",301:"ladybug, ladybeetle, lady beetle, ladybird, ladybird beetle",302:"ground beetle, carabid beetle",303:"long-horned beetle, longicorn, longicorn beetle",304:"leaf beetle, chrysomelid",305:"dung beetle",306:"rhinoceros beetle",307:"weevil",308:"fly",309:"bee",310:"ant, emmet, pismire",311:"grasshopper, hopper",312:"cricket",313:"walking stick, walkingstick, stick insect",314:"cockroach, roach",315:"mantis, mantid",316:"cicada, cicala",317:"leafhopper",318:"lacewing, lacewing fly",319:"dragonfly, darning needle, devil's darning needle, sewing needle, snake feeder, snake doctor, mosquito hawk, skeeter hawk",320:"damselfly",321:"admiral",322:"ringlet, ringlet butterfly",323:"monarch, monarch butterfly, milkweed butterfly, Danaus plexippus",324:"cabbage butterfly",325:"sulphur butterfly, sulfur butterfly",326:"lycaenid, lycaenid butterfly",327:"starfish, sea star",328:"sea urchin",329:"sea cucumber, holothurian",330:"wood rabbit, cottontail, cottontail rabbit",331:"hare",332:"Angora, Angora rabbit",333:"hamster",334:"porcupine, hedgehog",335:"fox squirrel, eastern fox squirrel, Sciurus niger",336:"marmot",337:"beaver",338:"guinea pig, Cavia cobaya",339:"sorrel",340:"zebra",341:"hog, pig, grunter, squealer, Sus scrofa",342:"wild boar, boar, Sus scrofa",343:"warthog",344:"hippopotamus, hippo, river horse, Hippopotamus amphibius",345:"ox",346:"water buffalo, water ox, Asiatic buffalo, Bubalus bubalis",347:"bison",348:"ram, tup",349:"bighorn, bighorn sheep, cimarron, Rocky Mountain bighorn, Rocky Mountain sheep, Ovis canadensis",350:"ibex, Capra ibex",351:"hartebeest",352:"impala, Aepyceros melampus",353:"gazelle",354:"Arabian camel, dromedary, Camelus dromedarius",355:"llama",356:"weasel",357:"mink",358:"polecat, fitch, foulmart, foumart, Mustela putorius",359:"black-footed ferret, ferret, Mustela nigripes",360:"otter",361:"skunk, polecat, wood pussy",362:"badger",363:"armadillo",364:"three-toed sloth, ai, Bradypus tridactylus",365:"orangutan, orang, orangutang, Pongo pygmaeus",366:"gorilla, Gorilla gorilla",367:"chimpanzee, chimp, Pan troglodytes",368:"gibbon, Hylobates lar",369:"siamang, Hylobates syndactylus, Symphalangus syndactylus",370:"guenon, guenon monkey",371:"patas, hussar monkey, Erythrocebus patas",372:"baboon",373:"macaque",374:"langur",375:"colobus, colobus monkey",376:"proboscis monkey, Nasalis larvatus",377:"marmoset",378:"capuchin, ringtail, Cebus capucinus",379:"howler monkey, howler",380:"titi, titi monkey",381:"spider monkey, Ateles geoffroyi",382:"squirrel monkey, Saimiri sciureus",383:"Madagascar cat, ring-tailed lemur, Lemur catta",384:"indri, indris, Indri indri, Indri brevicaudatus",385:"Indian elephant, Elephas maximus",386:"African elephant, Loxodonta africana",387:"lesser panda, red panda, panda, bear cat, cat bear, Ailurus fulgens",388:"giant panda, panda, panda bear, coon bear, Ailuropoda melanoleuca",389:"barracouta, snoek",390:"eel",391:"coho, cohoe, coho salmon, blue jack, silver salmon, Oncorhynchus kisutch",392:"rock beauty, Holocanthus tricolor",393:"anemone fish",394:"sturgeon",395:"gar, garfish, garpike, billfish, Lepisosteus osseus",396:"lionfish",397:"puffer, pufferfish, blowfish, globefish",398:"abacus",399:"abaya",400:"academic gown, academic robe, judge's robe",401:"accordion, piano accordion, squeeze box",402:"acoustic guitar",403:"aircraft carrier, carrier, flattop, attack aircraft carrier",404:"airliner",405:"airship, dirigible",406:"altar",407:"ambulance",408:"amphibian, amphibious vehicle",409:"analog clock",410:"apiary, bee house",411:"apron",412:"ashcan, trash can, garbage can, wastebin, ash bin, ash-bin, ashbin, dustbin, trash barrel, trash bin",413:"assault rifle, assault gun",414:"backpack, back pack, knapsack, packsack, rucksack, haversack",415:"bakery, bakeshop, bakehouse",416:"balance beam, beam",417:"balloon",418:"ballpoint, ballpoint pen, ballpen, Biro",419:"Band Aid",420:"banjo",421:"bannister, banister, balustrade, balusters, handrail",422:"barbell",423:"barber chair",424:"barbershop",425:"barn",426:"barometer",427:"barrel, cask",428:"barrow, garden cart, lawn cart, wheelbarrow",429:"baseball",430:"basketball",431:"bassinet",432:"bassoon",433:"bathing cap, swimming cap",434:"bath towel",435:"bathtub, bathing tub, bath, tub",436:"beach wagon, station wagon, wagon, estate car, beach waggon, station waggon, waggon",437:"beacon, lighthouse, beacon light, pharos",438:"beaker",439:"bearskin, busby, shako",440:"beer bottle",441:"beer glass",442:"bell cote, bell cot",443:"bib",444:"bicycle-built-for-two, tandem bicycle, tandem",445:"bikini, two-piece",446:"binder, ring-binder",447:"binoculars, field glasses, opera glasses",448:"birdhouse",449:"boathouse",450:"bobsled, bobsleigh, bob",451:"bolo tie, bolo, bola tie, bola",452:"bonnet, poke bonnet",453:"bookcase",454:"bookshop, bookstore, bookstall",455:"bottlecap",456:"bow",457:"bow tie, bow-tie, bowtie",458:"brass, memorial tablet, plaque",459:"brassiere, bra, bandeau",460:"breakwater, groin, groyne, mole, bulwark, seawall, jetty",461:"breastplate, aegis, egis",462:"broom",463:"bucket, pail",464:"buckle",465:"bulletproof vest",466:"bullet train, bullet",467:"butcher shop, meat market",468:"cab, hack, taxi, taxicab",469:"caldron, cauldron",470:"candle, taper, wax light",471:"cannon",472:"canoe",473:"can opener, tin opener",474:"cardigan",475:"car mirror",476:"carousel, carrousel, merry-go-round, roundabout, whirligig",477:"carpenter's kit, tool kit",478:"carton",479:"car wheel",480:"cash machine, cash dispenser, automated teller machine, automatic teller machine, automated teller, automatic teller, ATM",481:"cassette",482:"cassette player",483:"castle",484:"catamaran",485:"CD player",486:"cello, violoncello",487:"cellular telephone, cellular phone, cellphone, cell, mobile phone",488:"chain",489:"chainlink fence",490:"chain mail, ring mail, mail, chain armor, chain armour, ring armor, ring armour",491:"chain saw, chainsaw",492:"chest",493:"chiffonier, commode",494:"chime, bell, gong",495:"china cabinet, china closet",496:"Christmas stocking",497:"church, church building",498:"cinema, movie theater, movie theatre, movie house, picture palace",499:"cleaver, meat cleaver, chopper",500:"cliff dwelling",501:"cloak",502:"clog, geta, patten, sabot",503:"cocktail shaker",504:"coffee mug",505:"coffeepot",506:"coil, spiral, volute, whorl, helix",507:"combination lock",508:"computer keyboard, keypad",509:"confectionery, confectionary, candy store",510:"container ship, containership, container vessel",511:"convertible",512:"corkscrew, bottle screw",513:"cornet, horn, trumpet, trump",514:"cowboy boot",515:"cowboy hat, ten-gallon hat",516:"cradle",517:"crane",518:"crash helmet",519:"crate",520:"crib, cot",521:"Crock Pot",522:"croquet ball",523:"crutch",524:"cuirass",525:"dam, dike, dyke",526:"desk",527:"desktop computer",528:"dial telephone, dial phone",529:"diaper, nappy, napkin",530:"digital clock",531:"digital watch",532:"dining table, board",533:"dishrag, dishcloth",534:"dishwasher, dish washer, dishwashing machine",535:"disk brake, disc brake",536:"dock, dockage, docking facility",537:"dogsled, dog sled, dog sleigh",538:"dome",539:"doormat, welcome mat",540:"drilling platform, offshore rig",541:"drum, membranophone, tympan",542:"drumstick",543:"dumbbell",544:"Dutch oven",545:"electric fan, blower",546:"electric guitar",547:"electric locomotive",548:"entertainment center",549:"envelope",550:"espresso maker",551:"face powder",552:"feather boa, boa",553:"file, file cabinet, filing cabinet",554:"fireboat",555:"fire engine, fire truck",556:"fire screen, fireguard",557:"flagpole, flagstaff",558:"flute, transverse flute",559:"folding chair",560:"football helmet",561:"forklift",562:"fountain",563:"fountain pen",564:"four-poster",565:"freight car",566:"French horn, horn",567:"frying pan, frypan, skillet",568:"fur coat",569:"garbage truck, dustcart",570:"gasmask, respirator, gas helmet",571:"gas pump, gasoline pump, petrol pump, island dispenser",572:"goblet",573:"go-kart",574:"golf ball",575:"golfcart, golf cart",576:"gondola",577:"gong, tam-tam",578:"gown",579:"grand piano, grand",580:"greenhouse, nursery, glasshouse",581:"grille, radiator grille",582:"grocery store, grocery, food market, market",583:"guillotine",584:"hair slide",585:"hair spray",586:"half track",587:"hammer",588:"hamper",589:"hand blower, blow dryer, blow drier, hair dryer, hair drier",590:"hand-held computer, hand-held microcomputer",591:"handkerchief, hankie, hanky, hankey",592:"hard disc, hard disk, fixed disk",593:"harmonica, mouth organ, harp, mouth harp",594:"harp",595:"harvester, reaper",596:"hatchet",597:"holster",598:"home theater, home theatre",599:"honeycomb",600:"hook, claw",601:"hoopskirt, crinoline",602:"horizontal bar, high bar",603:"horse cart, horse-cart",604:"hourglass",605:"iPod",606:"iron, smoothing iron",607:"jack-o'-lantern",608:"jean, blue jean, denim",609:"jeep, landrover",610:"jersey, T-shirt, tee shirt",611:"jigsaw puzzle",612:"jinrikisha, ricksha, rickshaw",613:"joystick",614:"kimono",615:"knee pad",616:"knot",617:"lab coat, laboratory coat",618:"ladle",619:"lampshade, lamp shade",620:"laptop, laptop computer",621:"lawn mower, mower",622:"lens cap, lens cover",623:"letter opener, paper knife, paperknife",624:"library",625:"lifeboat",626:"lighter, light, igniter, ignitor",627:"limousine, limo",628:"liner, ocean liner",629:"lipstick, lip rouge",630:"Loafer",631:"lotion",632:"loudspeaker, speaker, speaker unit, loudspeaker system, speaker system",633:"loupe, jeweler's loupe",634:"lumbermill, sawmill",635:"magnetic compass",636:"mailbag, postbag",637:"mailbox, letter box",638:"maillot",639:"maillot, tank suit",640:"manhole cover",641:"maraca",642:"marimba, xylophone",643:"mask",644:"matchstick",645:"maypole",646:"maze, labyrinth",647:"measuring cup",648:"medicine chest, medicine cabinet",649:"megalith, megalithic structure",650:"microphone, mike",651:"microwave, microwave oven",652:"military uniform",653:"milk can",654:"minibus",655:"miniskirt, mini",656:"minivan",657:"missile",658:"mitten",659:"mixing bowl",660:"mobile home, manufactured home",661:"Model T",662:"modem",663:"monastery",664:"monitor",665:"moped",666:"mortar",667:"mortarboard",668:"mosque",669:"mosquito net",670:"motor scooter, scooter",671:"mountain bike, all-terrain bike, off-roader",672:"mountain tent",673:"mouse, computer mouse",674:"mousetrap",675:"moving van",676:"muzzle",677:"nail",678:"neck brace",679:"necklace",680:"nipple",681:"notebook, notebook computer",682:"obelisk",683:"oboe, hautboy, hautbois",684:"ocarina, sweet potato",685:"odometer, hodometer, mileometer, milometer",686:"oil filter",687:"organ, pipe organ",688:"oscilloscope, scope, cathode-ray oscilloscope, CRO",689:"overskirt",690:"oxcart",691:"oxygen mask",692:"packet",693:"paddle, boat paddle",694:"paddlewheel, paddle wheel",695:"padlock",696:"paintbrush",697:"pajama, pyjama, pj's, jammies",698:"palace",699:"panpipe, pandean pipe, syrinx",700:"paper towel",701:"parachute, chute",702:"parallel bars, bars",703:"park bench",704:"parking meter",705:"passenger car, coach, carriage",706:"patio, terrace",707:"pay-phone, pay-station",708:"pedestal, plinth, footstall",709:"pencil box, pencil case",710:"pencil sharpener",711:"perfume, essence",712:"Petri dish",713:"photocopier",714:"pick, plectrum, plectron",715:"pickelhaube",716:"picket fence, paling",717:"pickup, pickup truck",718:"pier",719:"piggy bank, penny bank",720:"pill bottle",721:"pillow",722:"ping-pong ball",723:"pinwheel",724:"pirate, pirate ship",725:"pitcher, ewer",726:"plane, carpenter's plane, woodworking plane",727:"planetarium",728:"plastic bag",729:"plate rack",730:"plow, plough",731:"plunger, plumber's helper",732:"Polaroid camera, Polaroid Land camera",733:"pole",734:"police van, police wagon, paddy wagon, patrol wagon, wagon, black Maria",735:"poncho",736:"pool table, billiard table, snooker table",737:"pop bottle, soda bottle",738:"pot, flowerpot",739:"potter's wheel",740:"power drill",741:"prayer rug, prayer mat",742:"printer",743:"prison, prison house",744:"projectile, missile",745:"projector",746:"puck, hockey puck",747:"punching bag, punch bag, punching ball, punchball",748:"purse",749:"quill, quill pen",750:"quilt, comforter, comfort, puff",751:"racer, race car, racing car",752:"racket, racquet",753:"radiator",754:"radio, wireless",755:"radio telescope, radio reflector",756:"rain barrel",757:"recreational vehicle, RV, R.V.",758:"reel",759:"reflex camera",760:"refrigerator, icebox",761:"remote control, remote",762:"restaurant, eating house, eating place, eatery",763:"revolver, six-gun, six-shooter",764:"rifle",765:"rocking chair, rocker",766:"rotisserie",767:"rubber eraser, rubber, pencil eraser",768:"rugby ball",769:"rule, ruler",770:"running shoe",771:"safe",772:"safety pin",773:"saltshaker, salt shaker",774:"sandal",775:"sarong",776:"sax, saxophone",777:"scabbard",778:"scale, weighing machine",779:"school bus",780:"schooner",781:"scoreboard",782:"screen, CRT screen",783:"screw",784:"screwdriver",785:"seat belt, seatbelt",786:"sewing machine",787:"shield, buckler",788:"shoe shop, shoe-shop, shoe store",789:"shoji",790:"shopping basket",791:"shopping cart",792:"shovel",793:"shower cap",794:"shower curtain",795:"ski",796:"ski mask",797:"sleeping bag",798:"slide rule, slipstick",799:"sliding door",800:"slot, one-armed bandit",801:"snorkel",802:"snowmobile",803:"snowplow, snowplough",804:"soap dispenser",805:"soccer ball",806:"sock",807:"solar dish, solar collector, solar furnace",808:"sombrero",809:"soup bowl",810:"space bar",811:"space heater",812:"space shuttle",813:"spatula",814:"speedboat",815:"spider web, spider's web",816:"spindle",817:"sports car, sport car",818:"spotlight, spot",819:"stage",820:"steam locomotive",821:"steel arch bridge",822:"steel drum",823:"stethoscope",824:"stole",825:"stone wall",826:"stopwatch, stop watch",827:"stove",828:"strainer",829:"streetcar, tram, tramcar, trolley, trolley car",830:"stretcher",831:"studio couch, day bed",832:"stupa, tope",833:"submarine, pigboat, sub, U-boat",834:"suit, suit of clothes",835:"sundial",836:"sunglass",837:"sunglasses, dark glasses, shades",838:"sunscreen, sunblock, sun blocker",839:"suspension bridge",840:"swab, swob, mop",841:"sweatshirt",842:"swimming trunks, bathing trunks",843:"swing",844:"switch, electric switch, electrical switch",845:"syringe",846:"table lamp",847:"tank, army tank, armored combat vehicle, armoured combat vehicle",848:"tape player",849:"teapot",850:"teddy, teddy bear",851:"television, television system",852:"tennis ball",853:"thatch, thatched roof",854:"theater curtain, theatre curtain",855:"thimble",856:"thresher, thrasher, threshing machine",857:"throne",858:"tile roof",859:"toaster",860:"tobacco shop, tobacconist shop, tobacconist",861:"toilet seat",862:"torch",863:"totem pole",864:"tow truck, tow car, wrecker",865:"toyshop",866:"tractor",867:"trailer truck, tractor trailer, trucking rig, rig, articulated lorry, semi",868:"tray",869:"trench coat",870:"tricycle, trike, velocipede",871:"trimaran",872:"tripod",873:"triumphal arch",874:"trolleybus, trolley coach, trackless trolley",875:"trombone",876:"tub, vat",877:"turnstile",878:"typewriter keyboard",879:"umbrella",880:"unicycle, monocycle",881:"upright, upright piano",882:"vacuum, vacuum cleaner",883:"vase",884:"vault",885:"velvet",886:"vending machine",887:"vestment",888:"viaduct",889:"violin, fiddle",890:"volleyball",891:"waffle iron",892:"wall clock",893:"wallet, billfold, notecase, pocketbook",894:"wardrobe, closet, press",895:"warplane, military plane",896:"washbasin, handbasin, washbowl, lavabo, wash-hand basin",897:"washer, automatic washer, washing machine",898:"water bottle",899:"water jug",900:"water tower",901:"whiskey jug",902:"whistle",903:"wig",904:"window screen",905:"window shade",906:"Windsor tie",907:"wine bottle",908:"wing",909:"wok",910:"wooden spoon",911:"wool, woolen, woollen",912:"worm fence, snake fence, snake-rail fence, Virginia fence",913:"wreck",914:"yawl",915:"yurt",916:"web site, website, internet site, site",917:"comic book",918:"crossword puzzle, crossword",919:"street sign",920:"traffic light, traffic signal, stoplight",921:"book jacket, dust cover, dust jacket, dust wrapper",922:"menu",923:"plate",924:"guacamole",925:"consomme",926:"hot pot, hotpot",927:"trifle",928:"ice cream, icecream",929:"ice lolly, lolly, lollipop, popsicle",930:"French loaf",931:"bagel, beigel",932:"pretzel",933:"cheeseburger",934:"hotdog, hot dog, red hot",935:"mashed potato",936:"head cabbage",937:"broccoli",938:"cauliflower",939:"zucchini, courgette",940:"spaghetti squash",941:"acorn squash",942:"butternut squash",943:"cucumber, cuke",944:"artichoke, globe artichoke",945:"bell pepper",946:"cardoon",947:"mushroom",948:"Granny Smith",949:"strawberry",950:"orange",951:"lemon",952:"fig",953:"pineapple, ananas",954:"banana",955:"jackfruit, jak, jack",956:"custard apple",957:"pomegranate",958:"hay",959:"carbonara",960:"chocolate sauce, chocolate syrup",961:"dough",962:"meat loaf, meatloaf",963:"pizza, pizza pie",964:"potpie",965:"burrito",966:"red wine",967:"espresso",968:"cup",969:"eggnog",970:"alp",971:"bubble",972:"cliff, drop, drop-off",973:"coral reef",974:"geyser",975:"lakeside, lakeshore",976:"promontory, headland, head, foreland",977:"sandbar, sand bar",978:"seashore, coast, seacoast, sea-coast",979:"valley, vale",980:"volcano",981:"ballplayer, baseball player",982:"groom, bridegroom",983:"scuba diver",984:"rapeseed",985:"daisy",986:"yellow lady's slipper, yellow lady-slipper, Cypripedium calceolus, Cypripedium parviflorum",987:"corn",988:"acorn",989:"hip, rose hip, rosehip",990:"buckeye, horse chestnut, conker",991:"coral fungus",992:"agaric",993:"gyromitra",994:"stinkhorn, carrion fungus",995:"earthstar",996:"hen-of-the-woods, hen of the woods, Polyporus frondosus, Grifola frondosa",997:"bolete",998:"ear, spike, capitulum",999:"toilet tissue, toilet paper, bathroom tissue"},fE={"1.00":"module_apply_default/MobilenetV1/Logits/global_pool","2.00":"module_apply_default/MobilenetV2/Logits/AvgPool"},pE={"1.00":{.25:{url:"https://tfhub.dev/google/imagenet/mobilenet_v1_025_224/classification/1",inputRange:[0,1]},"0.50":{url:"https://tfhub.dev/google/imagenet/mobilenet_v1_050_224/classification/1",inputRange:[0,1]},.75:{url:"https://tfhub.dev/google/imagenet/mobilenet_v1_075_224/classification/1",inputRange:[0,1]},"1.00":{url:"https://tfhub.dev/google/imagenet/mobilenet_v1_100_224/classification/1",inputRange:[0,1]}},"2.00":{"0.50":{url:"https://tfhub.dev/google/imagenet/mobilenet_v2_050_224/classification/2",inputRange:[0,1]},.75:{url:"https://tfhub.dev/google/imagenet/mobilenet_v2_075_224/classification/2",inputRange:[0,1]},"1.00":{url:"https://tfhub.dev/google/imagenet/mobilenet_v2_100_224/classification/2",inputRange:[0,1]}}};function mE(t){return void 0===t&&(t={version:1,alpha:1}),cE(this,void 0,void 0,(function(){var e,n,r,i,o,a,s;return hE(this,(function(u){switch(u.label){case 0:if(null==lE)throw new Error("Cannot find TensorFlow.js. If you are using a <script> tag, please also include @tensorflow/tfjs on the page before using this model.");if(r=t.version.toFixed(2),i=t.alpha?t.alpha.toFixed(2):"",o=-1,a=1,null==t.modelUrl){if(!(r in pE))throw new Error("Invalid version of MobileNet. Valid versions are: "+Object.keys(pE));if(!(i in pE[r]))throw new Error("MobileNet constructed with invalid alpha "+t.alpha+". Valid multipliers for this version are: "+Object.keys(pE[r])+".");o=(e=pE[r][i].inputRange)[0],a=e[1]}return null!=t.inputRange&&(o=(n=t.inputRange)[0],a=n[1]),[4,(s=new gE(r,i,t.modelUrl,o,a)).load()];case 1:return u.sent(),[2,s]}}))}))}var gE=function(){function t(t,e,n,r,i){void 0===r&&(r=-1),void 0===i&&(i=1),this.version=t,this.alpha=e,this.modelUrl=n,this.inputMin=r,this.inputMax=i,this.normalizationConstant=(i-r)/255}return t.prototype.load=function(){return cE(this,void 0,void 0,(function(){var t,e,n,r,i=this;return hE(this,(function(o){switch(o.label){case 0:return this.modelUrl?(t=this,[4,Object(uE.c)(this.modelUrl)]):[3,2];case 1:return t.model=o.sent(),[3,4];case 2:return e=pE[this.version][this.alpha].url,n=this,[4,Object(uE.c)(e,{fromTFHub:!0})];case 3:n.model=o.sent(),o.label=4;case 4:return[4,(r=Object(lE.tidy)((function(){return i.model.predict(Object(lE.zeros)([1,224,224,3]))}))).data()];case 5:return o.sent(),r.dispose(),[2]}}))}))},t.prototype.infer=function(t,e){var n=this;return void 0===e&&(e=!1),Object(lE.tidy)((function(){t instanceof lE.Tensor||(t=lE.browser.fromPixels(t));var r=t.toFloat().mul(n.normalizationConstant).add(n.inputMin),i=r;224===t.shape[0]&&224===t.shape[1]||(i=lE.image.resizeBilinear(r,[224,224],!0));var o=i.reshape([-1,224,224,3]);return e?n.model.execute(o,fE[n.version]).squeeze([1,2]):n.model.predict(o).slice([0,1],[-1,1e3])}))},t.prototype.classify=function(t,e){return void 0===e&&(e=3),cE(this,void 0,void 0,(function(){var n,r;return hE(this,(function(i){switch(i.label){case 0:return[4,yE(n=this.infer(t),e)];case 1:return r=i.sent(),n.dispose(),[2,r]}}))}))},t}();function yE(t,e){return cE(this,void 0,void 0,(function(){var n,r,i,o,a,s,u;return hE(this,(function(l){switch(l.label){case 0:return[4,(n=t.softmax()).data()];case 1:for(r=l.sent(),n.dispose(),i=[],u=0;u<r.length;u++)i.push({value:r[u],index:u});for(i.sort((function(t,e){return e.value-t.value})),o=new Float32Array(e),a=new Int32Array(e),u=0;u<e;u++)o[u]=i[u].value,a[u]=i[u].index;for(s=[],u=0;u<a.length;u++)s.push({className:dE[a[u]],probability:o[u]});return[2,s]}}))}))}const vE=["img"];function bE(t,e){1&t&&(Aa(0,"div"),Ta(1,"img",9),Na())}function wE(t,e){if(1&t&&(Aa(0,"div",10),Ta(1,"img",11,12),Na()),2&t){const t=Ua();bi(1),qa("src",t.imgSrc,Jr)}}function xE(t,e){if(1&t&&(Aa(0,"div",13),es(1),gu(2,"percent"),Na()),2&t){const t=e.$implicit;bi(1),is(" ",t.className," - ",yu(2,2,t.probability)," ")}}let _E=(()=>{class t{constructor(){}ngOnInit(){return Object(sE.a)(this,void 0,void 0,(function*(){this.loading=!0,this.model=yield mE(),console.log("model : ",this.model),this.loading=!1}))}fileChange(t){return Object(sE.a)(this,void 0,void 0,(function*(){const e=t.target.files[0];if(console.log("file : ",e),e){const t=new FileReader;console.log("file reader : ",t),t.readAsDataURL(e),t.onload=t=>{this.imgSrc=t.target.result,console.log("image : ",this.imgSrc)},setTimeout(()=>Object(sE.a)(this,void 0,void 0,(function*(){console.log("image : ",this.img.nativeElement),this.predictions=yield this.model.classify(this.img.nativeElement),console.log("Predictions : ",this.predictions)})),5e3)}}))}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=pe({type:t,selectors:[["app-image"]],viewQuery:function(t,e){var n;1&t&&Du(vE,!0),2&t&&Nu(n=Pu())&&(e.img=n.first)},decls:10,vars:3,consts:[[1,"cont","d-flex","justify-content-center","align-items-center","flex-column"],[1,"wrap"],[1,"search"],["type","file",1,"searchTerm",3,"change"],[1,"searchButton"],["cdkDrag","",1,"wrap2"],[4,"ngIf"],["class","example-box",4,"ngIf"],["class","list-group-item",4,"ngFor","ngForOf"],["src","./assets/spinners/Spinner.gif"],[1,"example-box"],["width","300px","height","300px",3,"src"],["img",""],[1,"list-group-item"]],template:function(t,e){1&t&&(Aa(0,"div",0),Aa(1,"div",1),Aa(2,"div",2),Aa(3,"input",3),Pa("change",(function(t){return e.fileChange(t)})),Na(),Aa(4,"label",4),es(5,"Select File"),Na(),Aa(6,"div",5),_a(7,bE,2,0,"div",6),_a(8,wE,3,1,"div",7),_a(9,xE,3,4,"div",8),Na(),Na(),Na(),Na()),2&t&&(bi(7),Ea("ngIf",e.loading),bi(1),Ea("ngIf",e.imgSrc),bi(1),Ea("ngForOf",e.predictions))},directives:[$y,pc,dc],pipes:[wc],styles:["@import url(https://fonts.googleapis.com/css?family=Open+Sans);body[_ngcontent-%COMP%]{background:#f2f2f2;font-family:Open Sans,sans-serif}.search[_ngcontent-%COMP%]{width:100%;position:relative;display:flex}.searchTerm[_ngcontent-%COMP%]{width:100%;border:3px solid #00b4cc;border-right:none;padding:5px;height:20px;border-radius:5px 0 0 5px;outline:none;color:#9dbfaf}.searchTerm[_ngcontent-%COMP%]:focus{color:#00b4cc}.searchButton[_ngcontent-%COMP%]{border:1px solid #00b4cc;background:#00b4cc;text-align:center;color:#fff;border-radius:0 5px 5px 0}.example-box[_ngcontent-%COMP%]{width:300px;height:300px;border:1px solid #ccc;color:rgba(0,0,0,.87);cursor:move;display:flex;justify-content:center;align-items:center;text-align:center;background:#fff;border-radius:4px;position:relative;z-index:1;transition:box-shadow .2s cubic-bezier(0,0,.2,1);box-shadow:0 3px 1px -2px rgba(0,0,0,.2),0 2px 2px 0 rgba(0,0,0,.14),0 1px 5px 0 rgba(0,0,0,.12)}.example-box[_ngcontent-%COMP%]:active{box-shadow:0 5px 5px -3px rgba(0,0,0,.2),0 8px 10px 1px rgba(0,0,0,.14),0 3px 14px 2px rgba(0,0,0,.12)}.wrap[_ngcontent-%COMP%]{width:30%;top:18%;left:50%;transform:translate(-50%,-50%)}.wrap[_ngcontent-%COMP%], .wrap2[_ngcontent-%COMP%]{position:absolute}.wrap2[_ngcontent-%COMP%]{margin-top:14%;top:40%;left:19%}"]}),t})();var CE=n("dfBD"),kE=n("C1Pg");const SE=["video"];function EE(t,e){1&t&&(Aa(0,"div",5),Ta(1,"img",6),Na())}function OE(t,e){if(1&t&&(Aa(0,"div"),es(1),gu(2,"percent"),Na()),2&t){const t=e.$implicit;bi(1),is(" ",t.className," - ",yu(2,2,t.probability)," ")}}let AE=(()=>{class t{constructor(){}ngOnInit(){return Object(sE.a)(this,void 0,void 0,(function*(){this.loading=!0,this.model=yield mE(),console.log("model : ",this.model),this.loading=!1;const t=kE.tensor2d([4.4,2.9,1.4,.2],[1,4]);CE.show.valuesDistribution({name:"Values Distribution",tab:"Model Inspection"},t)}))}ngAfterViewInit(){return Object(sE.a)(this,void 0,void 0,(function*(){const t=this.video.nativeElement;navigator.mediaDevices.getUserMedia&&navigator.mediaDevices.getUserMedia({video:!0}).then(e=>{console.log("success : "),t.srcObject=e,setInterval(()=>Object(sE.a)(this,void 0,void 0,(function*(){this.predictions=yield this.model.classify(this.video.nativeElement),console.log("predictions : ",this.predictions)})),3e3)}).catch(t=>{console.log("Something went wrong!")})}))}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=pe({type:t,selectors:[["app-video"]],viewQuery:function(t,e){var n;1&t&&Du(SE,!0),2&t&&Nu(n=Pu())&&(e.video=n.first)},decls:5,vars:2,consts:[["cdkDrag","",1,"wrap2"],["autoplay","","muted","","width","400px","height","400px"],["video",""],["class","loading",4,"ngIf"],[4,"ngFor","ngForOf"],[1,"loading"],["src","./assets/spinners/Spinner.gif"]],template:function(t,e){1&t&&(Aa(0,"div",0),Ta(1,"video",1,2),_a(3,EE,2,0,"div",3),_a(4,OE,3,4,"div",4),Na()),2&t&&(bi(3),Ea("ngIf",e.loading),bi(1),Ea("ngForOf",e.predictions))},directives:[$y,pc,dc],pipes:[wc],styles:[".wrap2[_ngcontent-%COMP%]{top:10%;left:35%}.loading[_ngcontent-%COMP%], .wrap2[_ngcontent-%COMP%]{position:absolute}.loading[_ngcontent-%COMP%]{top:23%;left:30%}"]}),t})();function NE(t,e){if(1&t&&(Aa(0,"mat-form-field",6),Aa(1,"mat-label"),es(2),Na(),Ta(3,"input",7),Na()),2&t){const t=Ua().$implicit;bi(2),ns(t.label),bi(1),Ea("type",t.type)("formControlName",t.name)("value",t.value)}}function TE(t,e){if(1&t&&Ta(0,"textarea",8),2&t){const t=Ua().$implicit;Ea("formControlName",t.name)("value",t.value)}}function DE(t,e){if(1&t&&Ta(0,"mat-slide-toggle",9),2&t){const t=Ua().$implicit;Ea("formControlName",t.name)("checked",t.value)}}function RE(t,e){if(1&t&&Ta(0,"mat-radio-button",9),2&t){const t=Ua().$implicit;Ea("formControlName",t.name)("checked",t.value)}}const IE=function(){return["text","password","email","number","search","tel","url"]};function ME(t,e){if(1&t&&(Aa(0,"mat-list-item"),_a(1,NE,4,4,"mat-form-field",3),_a(2,TE,1,2,"textarea",4),_a(3,DE,1,2,"mat-slide-toggle",5),_a(4,RE,1,2,"mat-radio-button",5),Na()),2&t){const t=e.$implicit;bi(1),Ea("ngIf",mu(4,IE).includes(t.type)),bi(1),Ea("ngIf","textarea"===t.type),bi(1),Ea("ngIf","toggle"===t.type),bi(1),Ea("ngIf","radio"===t.type)}}let FE=(()=>{class t{constructor(t){this.fb=t,this.formValues=new vu,this.myForm=this.fb.group({})}ngOnChanges(t){console.log("Json Dynamic Data : ",this.jsonDynamicForm),t.jsonDynamicForm.firstChange||this.createForm(this.jsonDynamicForm.controls)}createForm(t){console.log("Controllers : ",t);for(let e of t)this.myForm.addControl(e.name,this.fb.control(e.value))}onSubmit(){this.myForm.valid&&(console.log("Form valid: ",this.myForm.valid),console.log("Form values: ",this.myForm.value),this.formValues.emit(this.myForm.value))}}return t.\u0275fac=function(e){return new(e||t)(ka(qp))},t.\u0275cmp=pe({type:t,selectors:[["app-json-forms"]],inputs:{jsonDynamicForm:"jsonDynamicForm"},outputs:{formValues:"formValues"},features:[Ie],decls:4,vars:2,consts:[[3,"formGroup","ngSubmit"],[4,"ngFor","ngForOf"],["type","Submit",3,"click"],["appearance","fill",4,"ngIf"],["matInput","",3,"formControlName","value",4,"ngIf"],[3,"formControlName","checked",4,"ngIf"],["appearance","fill"],["matInput","",3,"type","formControlName","value"],["matInput","",3,"formControlName","value"],[3,"formControlName","checked"]],template:function(t,e){1&t&&(Aa(0,"form",0),Pa("ngSubmit",(function(){return e.onSubmit})),_a(1,ME,5,5,"mat-list-item",1),Aa(2,"button",2),Pa("click",(function(){return e.onSubmit()})),es(3,"Submit"),Na(),Na()),2&t&&(Ea("formGroup",e.myForm),bi(1),Ea("ngForOf",null==e.jsonDynamicForm?null:e.jsonDynamicForm.controls))},directives:[Ip,zf,Pp,dc,Gx,pc,Zb,$b,Ox,Tf,jf,Vp,I_,v_],styles:[""],changeDetection:0}),t})();function PE(t,e){if(1&t){const t=Ia();Aa(0,"div",2),Aa(1,"div",3),Aa(2,"div",4),Aa(3,"input",5),Pa("change",(function(e){return rn(t),Ua().fileChange(e)})),Na(),Aa(4,"label",6),es(5,"Select IBM config file"),Na(),Aa(6,"div",7),Aa(7,"h5"),es(8,"Or"),Na(),Na(),Na(),Na(),Na()}}function jE(t,e){if(1&t){const t=Ia();Aa(0,"div",8),Aa(1,"mat-card",9),Aa(2,"mat-card-title-group"),Aa(3,"mat-card-title"),es(4,"Iot Dashboard"),Na(),Aa(5,"mat-card-subtitle"),es(6),Na(),Aa(7,"mat-slide-toggle",10),Pa("click",(function(){return rn(t),Ua().onPublish()})),Na(),Na(),Ta(8,"mat-card-content"),Na(),Na()}if(2&t){const t=Ua();bi(6),rs("Esp32 -- ",t.PotentiameterReading,""),bi(1),Ea("checked",t.isChecked)}}function zE(t,e){if(1&t){const t=Ia();Aa(0,"div",8),Aa(1,"mat-card",9),Aa(2,"mat-card-title-group"),Aa(3,"mat-card-title"),es(4,"IBM Wotson Iot Form"),Na(),Na(),Aa(5,"mat-card-content"),Aa(6,"app-json-forms",11),Pa("formValues",(function(e){return rn(t),Ua().connectMQTT(e)})),Na(),Na(),Na(),Na()}if(2&t){const t=Ua();bi(6),Ea("jsonDynamicForm",t.dynamicForm)}}const LE=[{path:"",redirectTo:"/image",pathMatch:"full"},{path:"image",component:_E},{path:"video",component:AE},{path:"iot_esp32",component:(()=>{class t{constructor(t,e){this.ngZone=t,this.http=e,this.switch=!0,this.isChecked=!1,this.configFile={},this.isConfigured=!1}ngOnInit(){}ngAfterViewInit(){this.http.get("./assets/iotIBMOrgForm.json").subscribe(t=>{this.dynamicForm=t},t=>console.log("Error : ",t))}connectMQTT(t){let e=this;for(const n in t)if(""===t[n])return void alert(n+" is missing please check");this.ORG=t.orgId,this.DEVICE_TYPE=t.device_type,this.DEVICE_ID=t.device_id,this.username=t.api_key,this.password=t.auth_token,this.monTopic=t.subscribe_mon,this.eventTopic=t.subscribe_evt,this.MQTT_CONFIG={host:this.ORG+".messaging.internetofthings.ibmcloud.com",port:1883,clientId:"a:"+this.ORG+":"+Math.random().toString(16).substr(2,8)},this.mqttClient=new Paho.MQTT.Client(this.MQTT_CONFIG.host,Number(this.MQTT_CONFIG.port),this.MQTT_CONFIG.clientId),this.mqttClient.onConnectionLost=function(t){0!==t.errorCode&&alert("onConnectionLost: "+t.errorMessage)},this.mqttClient.onMessageArrived=function(t){e.ngZone.run(()=>{let n=JSON.parse(t.payloadString);e.PotentiameterReading=parseInt(n)})},this.mqttClient.connect({userName:this.username,password:this.password,keepAliveInterval:3600,useSSL:!1,timeout:3,onSuccess:this.onConnect.bind(this),onFailure:this.onFailure.bind(this)})}onConnect(){this.isConfigured=!0,this.mqttClient.subscribe(this.monTopic),this.mqttClient.subscribe(this.eventTopic)}onFailure(t){console.log("MQTT connection failed at "+Date.now()+"\nerror: "+t.errorCode+" : "+t.errorMessage)}onPublish(){if(this.isConfigured&&this.mqttClient.isConnected()){if(this.isChecked){this.isChecked=!1;var t=new Paho.MQTT.Message("0")}else this.isChecked=!0,t=new Paho.MQTT.Message("1");t.destinationName="iot-2/type/esp32_Testing/id/esp32_testing2/evt/blink/fmt/string",this.mqttClient.send(t)}else alert("MQTT connection failed!")}fileChange(t){return Object(sE.a)(this,void 0,void 0,(function*(){const e=t.target.files[0];if(e){const t=new FileReader;t.readAsText(e,"UTF-8"),t.onload=t=>{this.configFile=JSON.parse(t.target.result.toString()),this.connectMQTT(this.configFile)},t.onerror=t=>{}}}))}}return t.\u0275fac=function(e){return new(e||t)(ka(sl),ka(mm))},t.\u0275cmp=pe({type:t,selectors:[["app-iot-esp32"]],decls:3,vars:3,consts:[["class","cont d-flex justify-content-center align-items-center flex-column",4,"ngIf"],["class","body",4,"ngIf"],[1,"cont","d-flex","justify-content-center","align-items-center","flex-column"],[1,"wrap"],[1,"search"],["type","file",1,"searchTerm",3,"change"],[1,"searchButton"],["cdkDrag","",1,"wrap2"],[1,"body"],[1,"wrap-dashboard"],[3,"checked","click"],[3,"jsonDynamicForm","formValues"]],template:function(t,e){1&t&&(_a(0,PE,9,0,"div",0),_a(1,jE,9,2,"div",1),_a(2,zE,7,1,"div",1)),2&t&&(Ea("ngIf",!e.isConfigured),bi(1),Ea("ngIf",e.isConfigured),bi(1),Ea("ngIf",!e.isConfigured))},directives:[pc,$y,Ew,Ow,kw,Sw,I_,Cw,FE],styles:["@import url(https://fonts.googleapis.com/css?family=Open+Sans);.wrap-dashboard[_ngcontent-%COMP%]{width:30%;position:absolute;top:65%;left:50%;transform:translate(-50%,-50%)}.wrap2-dashboard[_ngcontent-%COMP%]{margin-top:14%;position:absolute;top:40%;left:19%}body[_ngcontent-%COMP%]{background:#f2f2f2;font-family:Open Sans,sans-serif}.search[_ngcontent-%COMP%]{width:100%;position:relative;display:flex}.searchTerm[_ngcontent-%COMP%]{width:100%;border:3px solid #00b4cc;border-right:none;padding:5px;height:20px;border-radius:5px 0 0 5px;outline:none;color:#9dbfaf}.searchTerm[_ngcontent-%COMP%]:focus{color:#00b4cc}.searchButton[_ngcontent-%COMP%]{border:1px solid #00b4cc;background:#00b4cc;text-align:center;color:#fff;border-radius:0 5px 5px 0}.example-box[_ngcontent-%COMP%]{width:300px;height:300px;border:1px solid #ccc;color:rgba(0,0,0,.87);cursor:move;display:flex;justify-content:center;align-items:center;text-align:center;background:#fff;border-radius:4px;position:relative;z-index:1;transition:box-shadow .2s cubic-bezier(0,0,.2,1);box-shadow:0 3px 1px -2px rgba(0,0,0,.2),0 2px 2px 0 rgba(0,0,0,.14),0 1px 5px 0 rgba(0,0,0,.12)}.example-box[_ngcontent-%COMP%]:active{box-shadow:0 5px 5px -3px rgba(0,0,0,.2),0 8px 10px 1px rgba(0,0,0,.14),0 3px 14px 2px rgba(0,0,0,.12)}.wrap[_ngcontent-%COMP%]{width:30%;top:18%;transform:translate(-50%,-50%)}.wrap[_ngcontent-%COMP%], .wrap2[_ngcontent-%COMP%]{position:absolute;left:50%}.wrap2[_ngcontent-%COMP%]{margin-top:8%;top:40%;color:#2556da}"]}),t})()}];let BE=(()=>{class t{}return t.\u0275mod=ve({type:t}),t.\u0275inj=dt({factory:function(e){return new(e||t)},imports:[[QS.forRoot(LE)],QS]}),t})();const UE=new v(Um),$E="Service workers are disabled or not supported by this browser";class VE{constructor(t){if(this.serviceWorker=t,t){const e=Og(t,"controllerchange").pipe(F(()=>t.controller)),n=Bg(Vv(()=>Xp(t.controller)),e);this.worker=n.pipe(Yp(t=>!!t)),this.registration=this.worker.pipe($g(()=>t.getRegistration()));const r=Og(t,"message").pipe(F(t=>t.data)).pipe(Yp(t=>t&&t.type)).pipe(Q(new C));r.connect(),this.events=r}else this.worker=this.events=this.registration=Vv(()=>qg(new Error("Service workers are disabled or not supported by this browser")))}postMessage(t,e){return this.worker.pipe(ng(1),$m(n=>{n.postMessage(Object.assign({action:t},e))})).toPromise().then(()=>{})}postMessageWithStatus(t,e,n){const r=this.waitForStatus(n),i=this.postMessage(t,e);return Promise.all([r,i]).then(()=>{})}generateNonce(){return Math.round(1e7*Math.random())}eventsOfType(t){return this.events.pipe(Yp(e=>e.type===t))}nextEventOfType(t){return this.eventsOfType(t).pipe(ng(1))}waitForStatus(t){return this.eventsOfType("STATUS").pipe(Yp(e=>e.nonce===t),ng(1),F(t=>{if(!t.status)throw new Error(t.error)})).toPromise()}get isEnabled(){return!!this.serviceWorker}}let WE=(()=>{class t{constructor(t){if(this.sw=t,this.subscriptionChanges=new C,!t.isEnabled)return this.messages=UE,this.notificationClicks=UE,void(this.subscription=UE);this.messages=this.sw.eventsOfType("PUSH").pipe(F(t=>t.data)),this.notificationClicks=this.sw.eventsOfType("NOTIFICATION_CLICK").pipe(F(t=>t.data)),this.pushManager=this.sw.registration.pipe(F(t=>t.pushManager));const e=this.pushManager.pipe($g(t=>t.getSubscription()));this.subscription=q(e,this.subscriptionChanges)}get isEnabled(){return this.sw.isEnabled}requestSubscription(t){if(!this.sw.isEnabled)return Promise.reject(new Error($E));const e={userVisibleOnly:!0};let n=this.decodeBase64(t.serverPublicKey.replace(/_/g,"/").replace(/-/g,"+")),r=new Uint8Array(new ArrayBuffer(n.length));for(let i=0;i<n.length;i++)r[i]=n.charCodeAt(i);return e.applicationServerKey=r,this.pushManager.pipe($g(t=>t.subscribe(e)),ng(1)).toPromise().then(t=>(this.subscriptionChanges.next(t),t))}unsubscribe(){return this.sw.isEnabled?this.subscription.pipe(ng(1),$g(t=>{if(null===t)throw new Error("Not subscribed to push notifications.");return t.unsubscribe().then(t=>{if(!t)throw new Error("Unsubscribe failed!");this.subscriptionChanges.next(null)})})).toPromise():Promise.reject(new Error($E))}decodeBase64(t){return atob(t)}}return t.\u0275fac=function(e){return new(e||t)(Kt(VE))},t.\u0275prov=ht({token:t,factory:t.\u0275fac}),t})(),qE=(()=>{class t{constructor(t){if(this.sw=t,!t.isEnabled)return this.available=UE,void(this.activated=UE);this.available=this.sw.eventsOfType("UPDATE_AVAILABLE"),this.activated=this.sw.eventsOfType("UPDATE_ACTIVATED")}get isEnabled(){return this.sw.isEnabled}checkForUpdate(){if(!this.sw.isEnabled)return Promise.reject(new Error($E));const t=this.sw.generateNonce();return this.sw.postMessageWithStatus("CHECK_FOR_UPDATES",{statusNonce:t},t)}activateUpdate(){if(!this.sw.isEnabled)return Promise.reject(new Error($E));const t=this.sw.generateNonce();return this.sw.postMessageWithStatus("ACTIVATE_UPDATE",{statusNonce:t},t)}}return t.\u0275fac=function(e){return new(e||t)(Kt(VE))},t.\u0275prov=ht({token:t,factory:t.\u0275fac}),t})();class HE{}const GE=new Lt("NGSW_REGISTER_SCRIPT");function XE(t,e,n,r){return()=>{if(!_c(r)||!("serviceWorker"in navigator)||!1===n.enabled)return;let i;if(navigator.serviceWorker.addEventListener("controllerchange",()=>{null!==navigator.serviceWorker.controller&&navigator.serviceWorker.controller.postMessage({action:"INITIALIZE"})}),"function"==typeof n.registrationStrategy)i=n.registrationStrategy();else{const[e,...r]=(n.registrationStrategy||"registerWhenStable:30000").split(":");switch(e){case"registerImmediately":i=Xp(null);break;case"registerWithDelay":i=KE(+r[0]||0);break;case"registerWhenStable":i=r[0]?q(YE(t),KE(+r[0])):YE(t);break;default:throw new Error("Unknown ServiceWorker registration strategy: "+n.registrationStrategy)}}t.get(sl).runOutsideAngular(()=>i.pipe(ng(1)).subscribe(()=>navigator.serviceWorker.register(e,{scope:n.scope}).catch(t=>console.error("Service worker registration failed with:",t))))}}function KE(t){return Xp(null).pipe(function(t,e=Km){var n;const r=(n=t)instanceof Date&&!isNaN(+n)?+t-e.now():Math.abs(t);return t=>t.lift(new Jb(r,e))}(t))}function YE(t){return t.get(El).isStable.pipe(Yp(t=>t))}function ZE(t,e){return new VE(_c(e)&&!1!==t.enabled?navigator.serviceWorker:void 0)}let QE=(()=>{class t{static register(e,n={}){return{ngModule:t,providers:[{provide:GE,useValue:e},{provide:HE,useValue:n},{provide:VE,useFactory:ZE,deps:[HE,Hu]},{provide:Bu,useFactory:XE,deps:[ca,GE,HE,Hu],multi:!0}]}}}return t.\u0275mod=ve({type:t}),t.\u0275inj=dt({factory:function(e){return new(e||t)},providers:[WE,qE]}),t})(),JE=(()=>{class t{constructor(t){this.swUpdate=t,this.swUpdate.available.subscribe(t=>{window.location.reload(),window.addEventListener("beforeinstallprompt",t=>{this.promptEvent=t})})}}return t.\u0275fac=function(e){return new(e||t)(Kt(qE))},t.\u0275prov=ht({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();function tO(t,e){if(1&t){const t=Ia();Aa(0,"button",7),Pa("click",(function(){return rn(t),Ua().installPwa()})),es(1," Install\n"),Na()}}let eO=(()=>{class t{constructor(t){this.pwaService=t}ngOnInit(){}installPwa(){this.pwaService.promptEvent.prompt()}}return t.\u0275fac=function(e){return new(e||t)(ka(JE))},t.\u0275cmp=pe({type:t,selectors:[["app-header"]],decls:15,vars:1,consts:[[1,"toolbar"],["mat-icon-button","","aria-label","Example icon-button with menu icon",1,"example-icon"],[1,"example-spacer"],["mat-button","","routerLink","/image"],["mat-button","","routerLink","/video"],["mat-button","","routerLink","/iot_esp32"],[3,"click",4,"ngIf"],[3,"click"]],template:function(t,e){1&t&&(Aa(0,"p"),Aa(1,"mat-toolbar",0),Aa(2,"button",1),Aa(3,"mat-icon"),es(4,"menu"),Na(),Na(),Aa(5,"span"),es(6,"Welcome"),Na(),Ta(7,"span",2),Aa(8,"a",3),es(9," Upload Image"),Na(),Aa(10,"a",4),es(11," Live "),Na(),Aa(12,"a",5),es(13," IoT Dashboard "),Na(),_a(14,tO,2,0,"button",6),Na(),Na()),2&t&&(bi(14),Ea("ngIf",e.pwaService.promptEvent))},directives:[G_,mw,tx,gw,BS,pc],styles:[".example-spacer[_ngcontent-%COMP%]{flex:1 1 auto;color:#fff}.toolbar[_ngcontent-%COMP%]{margin:0;top:0;left:0;right:0;height:60px;display:flex;align-items:center;background-color:#1976d2;color:#fff;font-weight:600}.toolbar[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin:0 16px}"]}),t})(),nO=(()=>{class t{constructor(){this.title="tensorflow"}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=pe({type:t,selectors:[["app-root"]],decls:2,vars:0,consts:[[1,"body"]],template:function(t,e){1&t&&(Ta(0,"app-header"),Ta(1,"router-outlet",0))},directives:[eO,$S],styles:[".body[_ngcontent-%COMP%]{background:#817f7f}"]}),t})();n("77Dq");class rO{constructor(){this.dialStartAngle=135,this.dialEndAngle=45,this.dialRadius=40,this.min=0,this.max=100,this.showValue=!0,this.gaugeClass="gauge",this.dialClass="dial",this.valueDialClass="value",this.valueClass="value-text",this.animated=!1}}const iO=new Lt("gauge defaults");function oO(t){const e=new rO;return Object.assign(e,t),e}let aO=(()=>{class t{static forRoot(e={}){return{ngModule:t,providers:[{provide:iO,useValue:e},{provide:rO,useFactory:oO,deps:[iO]}]}}}return t.\u0275mod=ve({type:t}),t.\u0275inj=dt({factory:function(e){return new(e||t)}}),t})(),sO=(()=>{class t{}return t.\u0275mod=ve({type:t,bootstrap:[nO]}),t.\u0275inj=dt({factory:function(e){return new(e||t)},providers:[JE],imports:[[th,BE,_f,Dm,Sg,Eg,tv,nv,iv,Wy,rw,iw,uw,yw,vw,Aw,Tw,Iw,ix,Mx,vx,Fx,jx,zx,ex,Ax,Qb,Xx,Zx,Ev,i_,o_,a_,b_,Lv,Jx,w_,x_,F_,P_,L_,B_,U_,X_,e_,K_,bb,Jy,ey,aC,aO.forRoot(),QE.register("./ngsw-worker.js",{enabled:!0}),Hp,Gp]]}),t})();(function(){if(Ar)throw new Error("Cannot enable prod mode after platform setup.");Or=!1})(),Qc().bootstrapModule(sO).catch(t=>console.error(t))},zhpP:function(t,e,n){"use strict";var r=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(e){o(e)}}function s(t){try{u(r.throw(t))}catch(e){o(e)}}function u(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(a,s)}u((r=r.apply(t,e||[])).next())}))},i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const o=i(n("etOl")),a=n("Ewl0"),s=n("YYB2"),u=n("jke5");e.linechart=function(t,e,n={}){return r(this,void 0,void 0,(function*(){const r=Array.isArray(e.values[0])?e.values:[e.values],i=r[0].length,c=e.series?e.series:r.map((t,e)=>"Series "+(e+1));s.assert(c.length===r.length,"Must have an equal number of series labels as there are data series"),null!=n.seriesColors&&s.assert(n.seriesColors.length===r.length,"Must have an equal number of series colors as there are data series");const h=[];for(let t=0;t<i;t++){const e={x:t};c.forEach((n,i)=>{e[n]=r[i][t].y,e[n+"-name"]=n}),h.push(e)}const d=Object.assign({},l,n),f={x:{field:"x",type:d.xType,title:d.xLabel},tooltip:[{field:"x",type:"quantitative"},...c.map(t=>({field:t,type:"quantitative"}))]},p=c.map(t=>({data:void 0,mark:{type:"line",clip:!0},encoding:{y:{field:t,type:d.yType,title:d.yLabel,scale:d.zoomToFit?{zero:!1}:null!=d.yAxisDomain?{domain:d.yAxisDomain}:void 0},color:{field:t+"-name",type:"nominal",legend:{values:c,title:null},scale:{range:d.seriesColors}}}})),m=u.getDrawArea(t),g={width:d.width||a.getDefaultWidth(m),height:d.height||a.getDefaultHeight(m),padding:0,autosize:{type:"fit",contains:"padding",resize:!0},config:{axis:{labelFontSize:d.fontSize,titleFontSize:d.fontSize},text:{fontSize:d.fontSize},legend:{labelFontSize:d.fontSize,titleFontSize:d.fontSize}},data:{values:h},encoding:f,layer:[...p,{mark:"rule",selection:{hover:{type:"single",on:"mouseover",nearest:!0,clear:"mouseout"}},encoding:{color:{value:"grey",condition:{selection:{not:"hover"},value:"transparent"}}}}]};return yield o.default(m,g,{actions:!1,mode:"vega-lite",defaultStyle:!1}),Promise.resolve()}))};const l={xLabel:"x",yLabel:"y",xType:"quantitative",yType:"quantitative",zoomToFit:!1,fontSize:11}},zn8P:function(t,e){function n(t){return Promise.resolve().then((function(){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}))}n.keys=function(){return[]},n.resolve=n,t.exports=n,n.id="zn8P"},zv5s:function(t,e,n){const r=n("ex/Z");t.exports=(t,e)=>{try{return new r(t,e).range||"*"}catch(n){return null}}}},[[0,0]]]);